<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">71393</article-id><article-id pub-id-type="doi">10.7554/eLife.71393</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Binding affinity landscapes constrain the evolution of broadly neutralizing anti-influenza antibodies</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-206899"><name><surname>Phillips</surname><given-names>Angela M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9806-7574</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-212029"><name><surname>Lawrence</surname><given-names>Katherine R</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund9"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243886"><name><surname>Moulana</surname><given-names>Alief</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243887"><name><surname>Dupic</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243888"><name><surname>Chang</surname><given-names>Jeffrey</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-210728"><name><surname>Johnson</surname><given-names>Milo S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0169-2494</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243889"><name><surname>Cvijovic</surname><given-names>Ivana</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6272-2979</contrib-id><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-243890"><name><surname>Mora</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5456-9361</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-50904"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2686-5702</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-40694"><name><surname>Desai</surname><given-names>Michael M</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9581-1150</contrib-id><email>mdesai@oeb.harvard.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con10"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Organismic and Evolutionary Biology, Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>NSF-Simons Center for Mathematical and Statistical Analysis of Biology, Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Quantitative Biology Initiative, Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Physics, Massachusetts Institute of Technology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Department of Physics, Harvard University</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution>Department of Applied Physics, Stanford University</institution><addr-line><named-content content-type="city">Stanford</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution>Laboratoire de physique de ÍÉcole Normale Supérieure, CNRS, PSL University, Sorbonne Université, and Université de Paris</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Fleishman</surname><given-names>Sarel Jacob</given-names></name><role>Reviewing Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Rath</surname><given-names>Satyajit</given-names></name><role>Senior Editor</role><aff><institution>Indian Institute of Science Education and Research (IISER)</institution><country>India</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>07</day><month>09</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e71393</elocation-id><history><date date-type="received" iso-8601-date="2021-06-17"><day>17</day><month>06</month><year>2021</year></date><date date-type="accepted" iso-8601-date="2021-09-05"><day>05</day><month>09</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2021-05-25"><day>25</day><month>05</month><year>2021</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.05.25.445596"/></event></pub-history><permissions><copyright-statement>© 2021, Phillips et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Phillips et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-71393-v3.pdf"/><abstract><p>Over the past two decades, several broadly neutralizing antibodies (bnAbs) that confer protection against diverse influenza strains have been isolated. Structural and biochemical characterization of these bnAbs has provided molecular insight into how they bind distinct antigens. However, our understanding of the evolutionary pathways leading to bnAbs, and thus how best to elicit them, remains limited. Here, we measure equilibrium dissociation constants of combinatorially complete mutational libraries for two naturally isolated influenza bnAbs (CR9114, 16 heavy-chain mutations; CR6261, 11 heavy-chain mutations), reconstructing all possible evolutionary intermediates back to the unmutated germline sequences. We find that these two libraries exhibit strikingly different patterns of breadth: while many variants of CR6261 display moderate affinity to diverse antigens, those of CR9114 display appreciable affinity only in specific, nested combinations. By examining the extensive pairwise and higher order epistasis between mutations, we find key sites with strong synergistic interactions that are highly similar across antigens for CR6261 and different for CR9114. Together, these features of the binding affinity landscapes strongly favor sequential acquisition of affinity to diverse antigens for CR9114, while the acquisition of breadth to more similar antigens for CR6261 is less constrained. These results, if generalizable to other bnAbs, may explain the molecular basis for the widespread observation that sequential exposure favors greater breadth, and such mechanistic insight will be essential for predicting and eliciting broadly protective immune responses.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>influenza</kwd><kwd>antibody</kwd><kwd>landscape</kwd><kwd>evolution</kwd><kwd>epistasis</kwd><kwd>breadth</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>S. cerevisiae</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><award-id>Hanna H. Gray Postdoctoral Fellowship</award-id><principal-award-recipient><name><surname>Phillips</surname><given-names>Angela M</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005883</institution-id><institution>Hertz Foundation</institution></institution-wrap></funding-source><award-id>Graduate Fellowship Award</award-id><principal-award-recipient><name><surname>Lawrence</surname><given-names>Katherine R</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>Graduate Research Fellowship Program</award-id><principal-award-recipient><name><surname>Lawrence</surname><given-names>Katherine R</given-names></name><name><surname>Chang</surname><given-names>Jeffrey</given-names></name><name><surname>Johnson</surname><given-names>Milo S</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>COG 724208</award-id><principal-award-recipient><name><surname>Mora</surname><given-names>Thierry</given-names></name><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM104239</award-id><principal-award-recipient><name><surname>Desai</surname><given-names>Michael M</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-1914916</award-id><principal-award-recipient><name><surname>Desai</surname><given-names>Michael M</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005492</institution-id><institution>Stanford University</institution></institution-wrap></funding-source><award-id>Stanford Science Fellowship</award-id><principal-award-recipient><name><surname>Cvijovic</surname><given-names>Ivana</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004412</institution-id><institution>Human Frontier Science Program</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Dupic</surname><given-names>Thomas</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution>NSF-Simons Center for Mathematical and Statistical Analysis of Biology at Harvard</institution></institution-wrap></funding-source><award-id>1764269</award-id><principal-award-recipient><name><surname>Lawrence</surname><given-names>Katherine R</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>CR9114, one of the most broadly neutralizing anti-influenza antibodies characterized to date, acquires affinity to divergent HA subtypes sequentially, due to higher order interactions between the nested sets of mutations required for binding each distinct subtype.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Vaccination harnesses the adaptive immune system, which responds to new pathogens by mutating antibody-encoding genes and selecting for variants that bind the pathogen of interest. However, influenza remains a challenging target for immunization: most antibodies elicited by vaccines provide protection against only a subset of strains, largely due to the rapid evolution of the influenza surface protein hemagglutinin (HA) (<xref ref-type="bibr" rid="bib81">Wiley et al., 1981</xref>; <xref ref-type="bibr" rid="bib68">Smith et al., 2004</xref>). After nearly two decades of studies, numerous broadly neutralizing antibodies (bnAbs) have been isolated from humans, with varying degrees of cross-protection against diverse strains (<xref ref-type="bibr" rid="bib16">Corti et al., 2017</xref>; <xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Corti et al., 2011</xref>; <xref ref-type="bibr" rid="bib66">Schmidt et al., 2015</xref>). Still, we do not fully understand many factors affecting how and when bnAbs are produced. In particular, affinity is acquired through a complex process of mutation and selection (<xref ref-type="bibr" rid="bib75">Victora and Nussenzweig, 2012</xref>), but the effects of mutations on binding affinity to diverse antigens are not well characterized.</p><p>For example, consider two well-studied influenza bnAbs that display varying levels of breadth: CR9114 is one of the broadest anti-influenza antibodies ever found, neutralizing strains from both groups of influenza A and strains from influenza B, while CR6261 is limited to neutralizing strains from Group 1 of influenza A (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>; <xref ref-type="bibr" rid="bib41">Lingwood et al., 2012</xref>). Both antibodies were isolated from vaccinated donors, derive from very similar germline sequences (IGHV1 –69 and IGHJ6), and bind the conserved HA stem epitope (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>; <xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>). Each antibody heavy chain has many mutations (18 amino acid changes for CR9114, 14 for CR6261, <xref ref-type="fig" rid="fig1">Figure 1A</xref>), including seven positions that are mutated in both, yet the contributions of these mutations to affinity against different antigens remain unclear (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Avnir et al., 2014</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Binding landscapes.</title><p>(<bold>A</bold>) Sequence alignment comparing somatic heavy chains to reconstructed germline sequences. Mutations under study (purple, numbered) and excluded mutations (black) are indicated; residues are numbered by IMGT unique numbering. (<bold>B</bold>) Influenza hemagglutinin phylogenetic tree with selected antigens and breadth of CR9114 (black box) and CR6261 (gray box) indicated. (<bold>C, E</bold>), Scatterplots of the (<bold>C</bold>) CR9114 library binding affinities against three antigens, with 2D planes shown below, and (<bold>E</bold>) CR6261 library binding affinities against two antigens. (<bold>D, F</bold>) Distributions of library binding affinities for (<bold>D</bold>) CR9114 and (<bold>F</bold>) CR6261 for each antigen (gray histogram, right) separated by number of somatic mutations (boxplots, left). Numbers and percentages of variants with measurable binding are indicated at right. (<bold>G</bold>), Force-directed graph of CR9114 H1 –logK<sub>D</sub>. Each variant (node) is connected to its 16 single-mutation neighbors (edges not shown for clarity); edges are weighted such that variants with similar genotypes and –logK<sub>D</sub> tend to cluster. Nodes are colored by binding affinity to H1 (top; showing all 65,091 nodes), H3 (lower left inset; showing only the region containing nodes with –logK<sub>D </sub>&gt; 6), and Flu B (lower right inset; showing only the region containing nodes with –logK<sub>D</sub> &gt; 6).</p><p><supplementary-material id="fig1sdata1"><label>Figure 1—source data 1.</label><caption><title>CR9114 library -logK<sub>D</sub> to H1, H3, and influenza B.</title><p>Biological triplicates, mean, and standard error reported.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig1-data1-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig1sdata2"><label>Figure 1—source data 2.</label><caption><title>CR6261 library -logK<sub>D</sub> to H1 and H9.</title><p>Biological triplicates, mean, and standard error reported.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig1-data2-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig1sdata3"><label>Figure 1—source data 3.</label><caption><title>Isogenic flow cytometry measurements of –logK<sub>D</sub> for select CR9114 and CR6261 variants.</title><p>Inferred –logK<sub>D</sub> and standard deviation for each replicate of isogenic FACS, alongside inferred –logK<sub>D</sub> mean and SEM from Tite-Seq using the mean bin and maximum likelihood (ML, shown only for CR9114) inference methods.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71393-fig1-data3-v3.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-v3.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Experimental design and Tite-Seq workflow.</title><p>Experimental design and Tite-Seq workflow. (<bold>A</bold>) Experimental design. Amino acid sequence percent identity of the entire HA ectodomain and the stem epitope (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>) are shown between each pair of antigens tested for both antibodies. (<bold>B</bold>) Tite-Seq assay. Surface display single-chain variable fragment (scFv) libraries are transformed into yeast and labeled with fluorescent antigen, followed by FACS into bins and sequencing. Dissociation constants are inferred from changes in mean bin fluorescence across 12 antigen concentrations, see Materials and methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp1-v3.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Tite-Seq data quality.</title><p>(<bold>A, C</bold>) Correlation of (<bold>A</bold>) CR9114 and (<bold>C</bold>) CR6261 K<sub>D</sub> measurements between biological replicates. (<bold>B, D</bold>) Validation of (<bold>B</bold>) CR9114 and (<bold>D</bold>) CR6261 Tite-Seq K<sub>D</sub> measurements by isogenic flow cytometry measurements for a subset of variants and antigens.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp2-v3.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Antibody-antigen co-crystal structures.</title><p>(<bold>A</bold>) Alignment of co-crystal structure of CR9114 with H5 (light hues; PDB ID 4FQI) and CR9114 with H3 (dark hues; PDB ID 4FQY). Mutated residues shown as gray spheres. (<bold>B</bold>) Co-crystal structure of CR6261 with H1 (PDB ID 3GBN); mutated residues shown as gray spheres.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp3-v3.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Force-directed graph for CR6261.</title><p>Force-directed graph for CR6261. (<bold>A, B</bold>) Force-directed graph for CR6261 H1 –logK<sub>D</sub>, as in <xref ref-type="fig" rid="fig1">Figure 1G</xref>. Nodes are colored by binding affinity to (<bold>A</bold>) H1 and (<bold>B</bold>) H9.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp4-v3.tif"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 5.</label><caption><title>Expression of antibody libraries.</title><p>(<bold>A</bold>) Correlation of mean expression across Tite-Seq biological replicates for CR9114 library (left, red) and CR6261 library (right, blue). (<bold>B</bold>) Correlation between Tite-Seq mean expression and isogenic expression fluorescence for select CR9114 (left, red) and CR6261 (right, blue) variants. (<bold>C</bold>) Change in expression upon mutation for a given number of background somatic mutations. (<bold>D</bold>) Correlation between mean expression and –logK<sub>D</sub>. Average values across biological replicates (N logK<sub>D </sub>= 3) are plotted. (<bold>E</bold>) Change in expression upon mutation at a specific site. Violin plots (left) and residues in co-crystal structure (right) are colored by mean change in expression for each site. Asterisks above violins indicate p-values for two-sided t-test between the distribution means and zero (<inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> (*), &lt; 0.001 (**), &lt; 0.0001 (***); <inline-formula><mml:math id="inf2"><mml:mrow><mml:msub><mml:mtext>N</mml:mtext><mml:mtext>9114</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>32</mml:mn><mml:mo>,</mml:mo><mml:mn>768</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mtext>N</mml:mtext><mml:mtext>6261</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>024</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). (<bold>F</bold>) Correlation between mean change in expression and mean change in –logK<sub>D</sub> (summed across all antigens) by mutation position. Select mutations with large impacts on expression and –logK<sub>D</sub> are labeled; all points are colored by mean change in expression, as in (<bold>F</bold>). Dark gray line indicates best-fit linear regression (95% confidence intervals in light gray).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp5-v3.tif"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 6.</label><caption><title>Tite-Seq gating strategy.</title><p>First, single yeast cells were gated by forward scatter (FSC) and side scatter (SSC) (step 1). Single cells were then either gated by scFv expression or HA binding. For the expression sort (step 2B), single cells were gated into eight bins along the log(FITC-A) axis, each containing 12.5% of the population. For the binding sort (steps 2A and 3A), scFv-expressing (scFv+) single cells were sorted into four bins along the log(PE-A) axis, with bin one comprising all HA- cells, and bins 2–4 each comprising 33% of the HA+ population.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp6-v3.tif"/></fig><fig id="fig1s7" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 7.</label><caption><title>Reversions of excluded mutations.</title><p>(<bold>A</bold>) Reversion of A24S and E46D in CR9114 (somatic-16) does not substantially impact binding affinity compared to the fully somatic version of CR9114 (somatic-18) to either H1 (orange) or H3 (turquoise); these mutations are thus excluded from the CR9114 library. (<bold>B</bold>) Reversion of Q6E, L50P, and V101M in CR6261 (somatic-11) does not substantially impact binding affinity compared to the fully somatic version of CR6261 (somatic-14) to either H1 (orange) or H9 (purple); these mutations are thus excluded from the CR6261 library. Measurements made in biological duplicate; mean +/- standard error shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig1-figsupp7-v3.tif"/></fig></fig-group><p>Beyond single mutational effects, it remains unknown whether there are correlated effects or strong trade-offs between binding to different antigens (pleiotropy), or non-additive interactions between mutations (epistasis). Such epistatic and pleiotropic effects can constrain the mutational pathways accessible under selection, as has been observed for other proteins (<xref ref-type="bibr" rid="bib79">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib71">Starr et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Ortlund et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Podgornaia and Laub, 2015</xref>; <xref ref-type="bibr" rid="bib30">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>; <xref ref-type="bibr" rid="bib47">Miton and Tokuriki, 2016</xref>; <xref ref-type="bibr" rid="bib60">Poelwijk et al., 2019</xref>; <xref ref-type="bibr" rid="bib7">Bank et al., 2015</xref>). Epistasis in antibody-antigen interactions remains significantly understudied (<xref ref-type="bibr" rid="bib2">Adams et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Pappas et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Braden et al., 1998</xref>) and most deep mutational scanning studies have focused on antigens (<xref ref-type="bibr" rid="bib19">Doud et al., 2018</xref>; <xref ref-type="bibr" rid="bib83">Wu et al., 2020</xref>; <xref ref-type="bibr" rid="bib72">Starr et al., 2021</xref>). In contrast to typical protein evolution, antibody affinity maturation proceeds by discrete rounds of mutation and selection (<xref ref-type="bibr" rid="bib75">Victora and Nussenzweig, 2012</xref>), typically with more than one nucleotide mutation occurring between selective rounds (<xref ref-type="bibr" rid="bib74">Unniraman and Schatz, 2007</xref>). In addition, antibodies are inherently mutationally tolerant (<xref ref-type="bibr" rid="bib12">Braden et al., 1998</xref>; <xref ref-type="bibr" rid="bib14">Chen et al., 1999</xref>; <xref ref-type="bibr" rid="bib13">Burks et al., 1997</xref>; <xref ref-type="bibr" rid="bib17">Corti and Lanzavecchia, 2013</xref>; <xref ref-type="bibr" rid="bib37">Klein et al., 2013</xref>), generating opportunities for interactions that scale combinatorially. Thus, if epistatic and pleiotropic constraints exist for antibodies, they could affect the likelihood of producing bnAbs under different antigen selection regimes (<xref ref-type="bibr" rid="bib54">Pappas et al., 2014</xref>) and may account for the low frequencies of bnAbs in natural repertoires (<xref ref-type="bibr" rid="bib16">Corti et al., 2017</xref>). Characterizing the prevalence of these constraints on bnAb evolution may provide valuable insight for improving vaccination strategies (<xref ref-type="bibr" rid="bib87">Yewdell, 2013</xref>; <xref ref-type="bibr" rid="bib33">Henry et al., 2018</xref>).</p><p>To date, studies of antibody binding have been limited to small numbers of individual sequences, deep mutational scans of single mutations, and mutagenesis of small regions (<xref ref-type="bibr" rid="bib54">Pappas et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Braden et al., 1998</xref>; <xref ref-type="bibr" rid="bib13">Burks et al., 1997</xref>; <xref ref-type="bibr" rid="bib1">Adams et al., 2016</xref>; <xref ref-type="bibr" rid="bib38">Koenig et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Forsyth et al., 2013</xref>; <xref ref-type="bibr" rid="bib82">Wu et al., 2017</xref>; <xref ref-type="bibr" rid="bib84">Xu et al., 2015</xref>; <xref ref-type="bibr" rid="bib42">Madan et al., 2021</xref>; <xref ref-type="bibr" rid="bib66">Schmidt et al., 2015</xref>), due in part to practical constraints on library scale and the throughput of affinity assays. This has limited our ability to comprehensively characterize binding landscapes for naturally isolated bnAbs, which often involve many mutations spanning framework (FW) and complementarity-determining regions (CDR) (<xref ref-type="bibr" rid="bib16">Corti et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Corti and Lanzavecchia, 2013</xref>; <xref ref-type="bibr" rid="bib37">Klein et al., 2013</xref>).</p><p>We overcome these challenges by generating combinatorially complete libraries of up to ∼10<sup>5</sup> antibody sequences and assaying their binding affinities in a high-throughput yeast-display system (<xref ref-type="bibr" rid="bib1">Adams et al., 2016</xref>). This approach enables us to infer the contributions of individual mutations as well as hundreds of pairwise and higher order interactions between mutations, revealing that these interactions can restrict evolutionary pathways leading to greater breadth. In particular, we find that mutational effects on binding affinity to diverse antigens display a nested structure, where increasingly large groups of specific mutations are required to gain affinity to divergent antigens, resulting in highly constrained paths to broad affinity. This pattern is not observed for more similar antigens, where many mutational paths to broad affinity are accessible. Further, these nested patterns of mutational effects provide new molecular insight into why sequential exposure to diverse antigens often favors greater breadth (<xref ref-type="bibr" rid="bib76">Wang et al., 2010</xref>; <xref ref-type="bibr" rid="bib39">Krammer et al., 2012</xref>; <xref ref-type="bibr" rid="bib77">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Wang, 2017</xref>; <xref ref-type="bibr" rid="bib62">Sachdeva et al., 2020</xref>; <xref ref-type="bibr" rid="bib48">Molari et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">Sprenger et al., 2020</xref>). Together, this work provides the first comprehensive characterization of antibody affinity landscapes and advances our understanding of the molecular constraints on bnAb evolution.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Binding affinity landscapes of CR9114 and CR6261</title><p>Here, we characterize the binding affinity landscapes of the two well-studied bnAbs noted above: CR9114 and CR6261. Specifically, we made all combinations of a set of mutations separating the germline and somatic sequences for CR9114 (16 mutations totaling 65,536 variants) and CR6261 (11 mutations totaling 2048 variants). These libraries include all heavy-chain mutations in these antibodies, except a few select mutations distant from the paratope (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>, and see Materials and methods). Both antibodies engage antigens solely through their heavy-chain regions (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>), and thus are well-suited for yeast display as single-chain variable fragments (see Materials and methods) (<xref ref-type="bibr" rid="bib10">Boder and Wittrup, 1997</xref>).</p><p>We use the Tite-Seq method (<xref ref-type="bibr" rid="bib1">Adams et al., 2016</xref>), which integrates flow cytometry and sequencing (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), to assay equilibrium binding affinities of each scFv sequence in these libraries against select antigens that span the breadth of binding for each antibody (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). For CR6261, we chose two divergent group 1 HA subtypes (H1 and H9; see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), while for CR9114, we chose the three highly divergent subtypes present in the vaccine (H1 from group 1, H3 from group 2, and influenza B; see <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>, <xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>). Inferred affinities outside our titration boundaries (10<sup>−11</sup>–10<sup>−6</sup> M for H3 and influenza B, 10<sup>−12</sup>–10<sup>−7</sup> M for H1 and H9) are pinned to the boundary, as deviations beyond these boundaries are likely not physiologically relevant (<xref ref-type="bibr" rid="bib9">Batista and Neuberger, 1998</xref>). Antibody expression is not strongly impacted by sequence identity, although some mutations have modest effects that may be inversely correlated with their effect on affinity (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>). Affinities obtained by Tite-Seq are reproducible across biological triplicates (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>; average standard error of 0.047 -logK<sub>D</sub> units across antibody-antigen pairs) and are highly accurate as verified for select variants by isogenic flow cytometry (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) and by solution-based affinity measurements made by others (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib41">Lingwood et al., 2012</xref>; <xref ref-type="bibr" rid="bib54">Pappas et al., 2014</xref>).</p><p>We begin by examining the distribution of binding affinities across antigens for each antibody library (<xref ref-type="fig" rid="fig1">Figure 1</xref>). We observe that most CR9114 variants have measurable affinity to H1 (97%), fewer to H3 (11%), and still fewer to influenza B (0.3%) (<xref ref-type="fig" rid="fig1">Figure 1C,D</xref>). For H1, only a few mutations are needed to improve from the germline affinity. In contrast, variants are not able to bind H3 unless they have several more mutations, and many more for influenza B. This hierarchical structure is in striking contrast to the CR6261 library, in which most variants can bind both antigens (92% for H1, 81% for H9), variants have a similar K<sub>D</sub> distribution, and many variants display intermediate affinity to both antigens (<xref ref-type="fig" rid="fig1">Figure 1E,F</xref>). To visualize how genotypes give rise to the hierarchical structure of CR9114 binding affinities, we represent the binding affinities for H1 as a force-directed graph. Here, each variant is a node connected to its 16 single-mutation neighbors, with edge weights inversely proportional to the change in H1 binding affinity, such that variants with similar genotype and K<sub>D</sub> tend to form clusters (<xref ref-type="fig" rid="fig1">Figure 1G</xref>, <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). Coloring this genotype-to-phenotype map by the –logK<sub>D</sub> to each of the three antigens, we see that sequences that bind H3 and influenza B are highly localized and overlapping, meaning that they share specific mutations. Thus, while many CR9114 variants strongly bind H1, only a specific subset bind multiple antigens.</p></sec><sec id="s2-2"><title>Mutational effects on binding to diverse antigens</title><p>To dissect how mutations drive the structure of these binding landscapes, we next infer specific mutational effects. We first log-transform binding affinities such that they are proportional to free energy changes (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mtext>binding</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>), which should combine additively under the natural null expectation (<xref ref-type="bibr" rid="bib80">Wells, 1990</xref>; <xref ref-type="bibr" rid="bib50">Olson et al., 2014</xref>). We then define a linear model with single mutational effects and interaction terms up to a specified order (defined relative to the unmutated germline sequence, see Appendix 2 for alternatives), and fit coefficients by ordinary least squares regression. We use cross-validation to identify the maximal order of interaction for each antigen and report coefficients at each order from these best-fitting models (CR9114: fifth order for H1, fourth for H3, first for influenza B; CR6261: fourth order for H1 and H9; see Materials and methods). We note that the maximum order of interactions is affected by our inference power, particularly by the number of sequences with appreciable binding, and so we interpret these models as showing strong evidence of epistasis at least up to the order indicated. We explored the possibility of ‘global’ epistasis by inferring a nonlinear transformation of the -logK<sub>D</sub> values (<xref ref-type="bibr" rid="bib63">Sailer and Harms, 2017a</xref>; <xref ref-type="bibr" rid="bib53">Otwinowski et al., 2018</xref>), but found that this approach did not significantly reduce the order or number of specific interaction coefficients needed to explain the data (see Appendix 2). We also explored inferring epistasis up to full order using Walsh-Hadamard transformations; results are qualitatively similar but less conservative than cross-validated regression (see Appendix 2).</p><p>Examining the effect of individual mutations on the germline background (<xref ref-type="fig" rid="fig2">Figure 2A,B</xref>), we observe several mutations that enhance binding to all antigens (e.g. S83F for CR9114), and mutations that confer trade-offs for binding distinct antigens (e.g. F30S in CR9114 reduces affinity for H1 but enhances affinity for influenza B). Generally, large-effect mutations are at sites that contact HA (<xref ref-type="fig" rid="fig2">Figure 2C</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>). Consistent with prior biochemical and structural work, mutations essential for CR9114 breadth are spread throughout FW3 and the CDRs, forming hydrophobic contacts and hydrogen bonds with residues in the conserved HA stem epitope (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Avnir et al., 2014</xref>). We observe three specific mutations that are required for binding to H3 (present at over 90% frequency in the set of binding sequences), likely because they form hydrophobic contacts with HA (K82I and S83F) and reorient the CDR2 loop (I57S), which interacts with residues and a glycan in H3 that are distinct from those in H1 (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>). We also observe eight specific mutations that are required for binding to influenza B. Many of these breadth-conferring mutations are absent in CR6261, particularly those in CDR2 (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>). Notably, these sets of required mutations in CR9114 exhibit a nested structure: mutations beneficial for H1 are required for H3, and mutations required for H3 are required for influenza B, giving rise to the hierarchical structure of the binding landscape (<xref ref-type="fig" rid="fig1">Figure 1C</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>First- and second-order effects.</title><p>(<bold>A, B</bold>) First-order effects inferred in best-fitting epistatic interaction models for (<bold>A</bold>) CR9114 and (<bold>B</bold>) CR6261. Mutations required for binding (present at over 90% frequency in binding sequences) have effect sizes denoted as ‘R’ and are removed from inference. Error bars indicate standard error. (<bold>C</bold>) First order effects for each site plotted against the contact surface area between the corresponding somatic residue and HA (left, CR9114; right, CR6261). Sites with notable contact area or effect size are labeled. Cocrystal structures are also shown; mutations are colored by first-order effect size. (<bold>D</bold>) Significant second-order epistatic interaction coefficients for CR9114 mutations (bottom left, H3; top right, H1). Interactions involving required mutations are shown in dark red. (<bold>E</bold>) Significant second-order coefficients for CR6261 mutations (bottom left, H9; top right, H1). Significance in (<bold>D</bold>), (<bold>E</bold>) indicates Bonferroni-corrected p-value &lt; 0.05, see Materials and methods. (<bold>F</bold>) Second-order coefficients for H1 –logK<sub>D</sub> plotted against the distance between the respective <inline-formula><mml:math id="inf5"><mml:mi>α</mml:mi></mml:math></inline-formula>-carbons in the crystal structures.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Interaction model coefficients for CR9114.</title><p>Coefficients are reported with standard errors, p-values, and confidence intervals (95% with Bonferroni correction by the number of parameters).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig2-data1-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig2sdata2"><label>Figure 2—source data 2.</label><caption><title>Interaction model coefficients for CR6261.</title><p>Coefficients are reported with standard errors, p-values, and confidence intervals (95% with Bonferroni correction by the number of parameters).</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig2-data2-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig2sdata3"><label>Figure 2—source data 3.</label><caption><title>Tabulated contact surface area, number of HA contacts, and pairwise distances for mutations in CR9114 and CR6261.</title><p>For each mutated position, the contact surface area with HA (as plotted in <xref ref-type="fig" rid="fig2">Figure 2C</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) and the number of HA residues within six angstroms is tabulated for CR9114-H5 (4FQI), CR9114-H3 (4FQY), and CR6261-H1 (3GBN). Distances between alpha-carbons plotted in <xref ref-type="fig" rid="fig2">Figure 2F</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> are also tabulated here alongside the corresponding second order effects.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71393-fig2-data3-v3.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig2-v3.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Structural context of first and second order effects.</title><p>(<bold>A</bold>) Left: first-order effects for each site, colored by effect size and plotted against the contact surface area between the corresponding somatic residue and HA (top, CR9114 with H3; bottom, CR6261 with H9); Right: co-crystal structures with mutation sites colored by first-order effects, as in <xref ref-type="fig" rid="fig2">Figure 2C</xref>. (<bold>B</bold>) Second-order coefficients for CR9114 with H3 (top) and CR6261 with H9 (bottom) plotted against the distance between the respective <inline-formula><mml:math id="inf6"><mml:mi>α</mml:mi></mml:math></inline-formula>-carbons in the crystal structures, as in <xref ref-type="fig" rid="fig2">Figure 2F</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig2-figsupp1-v3.tif"/></fig></fig-group><p>Beyond these exceptionally synergistic interactions between required mutations, we find that epistasis is widespread, accounting for 18–33% of explained variance depending on the antibody-antigen pair (except influenza B, see Materials and methods, Appendix 2). Pairwise interactions are dominated by a few mutations (e.g. F30S for CR9114 and S35R for CR6261) that exhibit many interactions, both positive and negative, with other mutations (<xref ref-type="fig" rid="fig2">Figure 2D,E</xref>). Overall, mutations with strong pairwise interactions tend to be close in the crystal structure, although there are long-range pairwise interactions that are likely mediated by interactions with the antigen or conformational rearrangements (<xref ref-type="fig" rid="fig2">Figure 2F</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>; <xref ref-type="bibr" rid="bib4">Avnir et al., 2014</xref>).</p></sec><sec id="s2-3"><title>High-order epistasis is dominated by a subset of mutations</title><p>Our dataset also allows us to resolve higher order epistasis. In addition to the required mutations, our models identify numerous strong third to fifth order interactions, with a subset of mutations participating in many mutual interactions at all orders. For CR9114 binding to H1, this subset consists of five mutations, distributed across three different regions of the heavy chain (<xref ref-type="fig" rid="fig3">Figure 3A,B</xref>). Some of these mutations likely generate (K82I, S83F) or abrogate (F30S) contacts to HA, and others (I57S, A65T) may indirectly impact HA binding by reorienting contact residues in CDR2 (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib4">Avnir et al., 2014</xref>). Within this set of five residues, we first illustrate two examples of third-order epistasis by grouping sequences by their genotypes at these five sites (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Intriguingly, some mutations that are deleterious in the germline background ('–' annotations) are beneficial in doubly-mutated backgrounds ('+' annotations). For example, mutation F30S is significantly less deleterious in backgrounds with S83F than in the germline background, suggesting that new hydrophobic contacts in FW3 may be able to compensate for the potential loss of contacts in CDR1. Yet F30S unexpectedly becomes beneficial after an additional mutation I57S in CDR2, indicating more complex interactions between flexible CDR and FW loop regions (<xref ref-type="fig" rid="fig3">Figure 3B,C</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>High-order epistasis for CR9114.</title><p>(<bold>A</bold>) Total higher order epistatic contributions of CR9114 mutation pairs for binding H1. Color bar indicates the sum of absolute values of significant higher order interaction coefficients involving each pair of mutations; key epistatic residues indicated by arrows. Significance is given by Bonferroni-corrected p-value &lt; 0.05, see Materials and methods. (<bold>B</bold>) Location of key epistatic residues in the CR9114 –HA co-crystal structure colored by region. (<bold>C</bold>) –logK<sub>D</sub> distributions for genotypes grouped by their identity at the five residues indicated in (<bold>A</bold>), (<bold>B</bold>), with means indicated as white dots (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mn>192</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> genotypes per violin). Annotations indicate notable deleterious ('−') and beneficial ('+') mutational effects. (<bold>D</bold>) CR9114 force-directed graph from <xref ref-type="fig" rid="fig1">Figure 1G</xref>, colored as in (<bold>C</bold>) by the genotype at the five sites indicated in (<bold>A</bold>), (<bold>B</bold>). Genotypes not shown in (<bold>C</bold>) are shown in light gray. Data are also available in an interactive data browser at <ext-link ext-link-type="uri" xlink:href="https://yodabrowser.netlify.app/yoda_browser/">https://yodabrowser.netlify.app/yoda_browser/</ext-link>. (<bold>E</bold>), Third-order interaction involving site 64 accounts for distinct clusters (teal) corresponding to genotypes with mutations 57 and 65 in (<bold>D</bold>). Colors correspond to mutation groups in (<bold>C</bold>), (<bold>D</bold>) (<inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>096</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> genotypes per violin). (<bold>F</bold>), Epistatic interaction coefficients among the five key sites from (<bold>A</bold>), (<bold>B</bold>). Colors for certain groups as in (<bold>C</bold>), (<bold>D</bold>); other groups denoted in gray, with notable terms labeled.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig3-v3.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>CR9114: interactions between five key sites.</title><p>(<bold>A</bold>) CR9114 force-directed graph, as in <xref ref-type="fig" rid="fig3">Figure 3D</xref>, colored by mutation groups of sites 30, 57, 65, 82, and 83 (32 total groups). The dashed line emphasizes the observed separation of genotypes with S83F (upper right) from those without S83F (lower left). (<bold>B</bold>) Coefficients for terms in the epistatic interaction model corresponding to mutation groups of sites 30, 57, 65, 82, and 83 (31 total groups, excluding the germline), colored according to (<bold>A</bold>) and grouped by order. Error bars indicate standard error. (<bold>C</bold>) Distribution of the number of significant coefficients for mutation groups in every possible set of five sites chosen from the 16 sites (up to 31 terms for each group, for 4368 groups). Significance is given by Bonferroni-corrected p-value <italic>lt</italic><sub>0.05</sub>, see Materials and methods. The value for the group illustrated in (<bold>A</bold>), (<bold>B</bold>) is indicated in red (26 significant terms, empirical p-value <inline-formula><mml:math id="inf9"><mml:mrow><mml:mi/><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig3-figsupp1-v3.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>CR9114: interactions between other sets of five sites.</title><p>(<bold>A</bold>) CR9114 force-directed graph, as in <xref ref-type="fig" rid="fig3">Figure 3D</xref>, but colored by mutation groups of a different set of five sites with fewer strong epistatic interactions (35, 36, 64, 66, and 85). (<bold>B</bold>) CR9114 force-directed graph, colored by mutation groups of a different set of five sites with no strong linear contributions or epistatic interactions (79, 84, 92, 95, and 103).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig3-figsupp2-v3.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>High-order epistasis for CR9114 binding to H3.</title><p>(<bold>A</bold>) Higher order significant epistatic contributions of CR9114 mutation pairs, as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>, for binding H3. Light yellow columns indicate required mutations (sites 57, 82, and 83). Significance is given by Bonferroni-corrected p-value &lt; 0.05, see Methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig3-figsupp3-v3.tif"/></fig></fig-group><p>To see how these high-order interactions drive the overall structure of the binding affinity landscape, we return to the force-directed graph, now colored by genotype at these five key sites (<xref ref-type="fig" rid="fig3">Figure 3D</xref>; only points corresponding to genotypes shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref> are colored). We see that these five sites largely determine the overall structure of the map: points of the same color tend to cluster together, despite varying in their genotypes at the other 11 sites. However, we observe that interactions with other mutations do exist, as evidenced by separate clusters with the same color (e.g. the two clusters in teal for 57,65 are distinguished by a positive third-order interaction with site 64, <xref ref-type="fig" rid="fig3">Figure 3E</xref>). These patterns are not confined to the genotypes shown in <xref ref-type="fig" rid="fig3">Figure 3C</xref>; if we color all 32 possible genotypes at the five key sites, we observe the same general patterns (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>; an interactive data browser for exploring these patterns of epistasis in CR9114 is available at: <ext-link ext-link-type="uri" xlink:href="https://yodabrowser.netlify.app/yoda_browser/">https://yodabrowser.netlify.app/yoda_browser/</ext-link>). Interactions between these five sites are also enriched for significant epistatic coefficients (<inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; 26 of 31 possible terms are significant, compared to an average of 4 terms among all sets of five sites, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>), including the fifth order interaction between all five residues (<xref ref-type="fig" rid="fig3">Figure 3F</xref>). Remarkably, these five mutations underlie significant high-order epistasis for other antigens as well: all five are either required for binding or participate extensively in interactions for H3 and influenza B (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><p>Higher order epistasis in CR6261 is similarly dominated by a subset of mutations in CDR1 and FW3, at identical or neighboring positions as some key sites for CR9114 (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). These mutations exhibit strong diminishing returns epistasis at third and fourth order, counteracting their synergistic pairwise effects, in a similar manner across both antigens (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Many fourth-order combinations of these mutations display interaction coefficients of similar magnitude (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), though they may be signatures of even higher order interactions that we are underpowered to infer.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>High-order epistasis for CR6261.</title><p>(<bold>A</bold>) Total significant epistatic contributions of CR6261 mutation pairs for binding H1, as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. Significance is given by Bonferroni-corrected p-value &lt; 0.05, see Materials and methods. (<bold>B</bold>) Third-order interaction for CR6261 H1 binding between mutations T29P, S35R, and S83F (<inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>256</mml:mn></mml:mrow></mml:math></inline-formula> genotypes per violin).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig4-v3.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>CR6261: interactions between four sites.</title><p>(<bold>a</bold>) CR6261 force-directed graph, as in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, colored by mutation groups of sites 29, 35, 82, and 83 (16 total groups). (<bold>B</bold>) Top, coefficients for terms in the epistatic interaction model corresponding to the mutation groups illustrated in (<bold>a</bold>) (15 total groups, excluding the germline), colored according to (<bold>a</bold>) and grouped by order. Bottom, the largest fourth-order coefficients observed in the epistatic interaction model, with sites indicated. In both, error bars indicate standard error. (<bold>C</bold>) CR6261 force-directed graph, colored by a different set of four sites with the fewest strong linear effects and epistatic interactions (65, 66, 69, and 112.1).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig4-figsupp1-v3.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>High-order epistasis for CR6261 binding to H9.</title><p>(<bold>A</bold>) Higher order significant epistatic contributions of CR6261 mutation pairs, as in <xref ref-type="fig" rid="fig4">Figure 4A</xref>, for binding H9. (<bold>B</bold>) Scatterplot of significant epistatic interaction model coefficients for binding to H1 and H9. Terms at different orders are colored and sized as indicated. Selected coefficients are annotated. Significance in (<bold>A</bold>), (<bold>B</bold>) is given by Bonferroni-corrected p-value &lt; 0.05, see Methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig4-figsupp2-v3.tif"/></fig></fig-group><p>A common approach to quantify how epistasis constrains mutational trajectories is to count ‘uphill’ paths (i.e. where affinity improves at every mutational step from the germline to the somatic sequence). We find that only a small fraction of potential paths are uphill (0.00005% +/- 0.00004% for CR9114 binding H1, and 0.2% +/- 0.04% for CR6261 binding H1, as estimated by bootstrap, see Materials and methods). However, we note that for all antibody-antigen combinations, the somatic sequence is not the global maximum of the landscape (the best-binding sequence) and some mutations have deleterious effects on average. Hence, strictly uphill paths are only possible due to sign epistasis, where normally deleterious mutations have beneficial effects in specific genetic backgrounds.</p><p>Overall, we see that mutational effects and interactions between them explain the affinity landscapes we observe. For CR9114, binding affinity to H1 can be achieved through different sets of few mutations with complex interactions. In contrast, a specific set of many mutations with strong synergistic interactions is required to bind H3, and to an even greater extent, influenza B (<xref ref-type="fig" rid="fig2">Figure 2A</xref>), giving rise to the landscape's hierarchical structure (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). For CR6261, the higher order interactions are more similar between H1 and H9, which is consistent with the more correlated patterns of binding affinities between these two antigens (<xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p></sec><sec id="s2-4"><title>Affinity to diverse antigens was likely acquired sequentially</title><p>The hierarchical nature of the CR9114 landscape suggests that this lineage developed affinity to each antigen sequentially. Considering the maximum –logK<sub>D</sub> achieved by sequences with a given number of mutations (a proxy for time), we see that improvements in H1 binding can be realized early on, whereas improvements in H3 binding are not possible until later, and even later for influenza B (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). In fact, the nested structure of affinity-enhancing mutations forces improvements in binding affinity to occur sequentially. If selection pressures were also experienced in this sequence, mutations that improve binding to the current antigen would lead to the genotypes required to begin improving binding to the next. Indeed, we find that for CR9114, there are more uphill paths leading to the somatic sequence if selection acts first on binding to H1 and later to H3 and influenza B (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). In contrast, for CR6261, improvements in binding can occur early on for both antigens (<xref ref-type="fig" rid="fig5">Figure 5B</xref>) and the number of uphill paths is more similar across single-antigen and sequential selection pressures (<xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Antigen selection scenarios and likely mutational pathways.</title><p>(<bold>A, B</bold>) Maximum binding affinity achievable for sequences with a given number of mutations. For each antigen for (<bold>A</bold>) CR9114 and (<bold>B</bold>) CR6261, the maximum observed (circles) and model-predicted (triangles) affinity for each number of somatic mutations is shown. (<bold>C, D</bold>) Total number of 'uphill' paths for select antigen selection scenarios (colored bars) for (<bold>C</bold>) CR9114 and (<bold>D</bold>) CR6261. Error bars indicate standard error obtained through bootstrap, see Materials and methods. (<bold>E, F</bold>) Total log probability (in arbitrary units) of mutational trajectories from germline to somatic sequence for (<bold>E</bold>) CR9114 and (<bold>F</bold>) CR6261 under different antigen selection scenarios, in a moderate selection model. Error bars indicate standard error obtained through bootstrap, see Materials and methods. (<bold>G, H</bold>) 25 most likely paths for (<bold>G</bold>) CR9114 and (<bold>H</bold>) CR6261, from select scenarios in (<bold>E, F</bold>); –logK<sub>D</sub> plotted for each antigen. For the random mixed scenario ('R'), a representative case is shown. ’A’ indicates the average mixed scenario; ’O’ indicates the optimal scenario. (<bold>I, J</bold>) Probability of mutation order under optimal antigen selection scenario ‘O' for CR9114 (<bold>I</bold>) and H1 for CR6261 (<bold>J</bold>). Selection scenarios are as in (<bold>E, F</bold>) and shown in colored bar at top; the total probability (through all possible paths) for each mutation to occur at each mutational step is shown as stacked colored bars.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Total probability of mutational trajectories for CR9114 under different antigen selection scenarios.</title><p>Mean and standard error across 10 bootstrap samples are reported for moderate, weak, and strong selection strengths.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig5-data1-v3.csv"/></supplementary-material></p><p><supplementary-material id="fig5sdata2"><label>Figure 5—source data 2.</label><caption><title>Total probability of mutational trajectories for CR6261 under different antigen selection scenarios.</title><p>Mean and standard error across 10 bootstrap samples are reported for moderate, weak, and strong selection strengths.</p></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-fig5-data2-v3.csv"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig5-v3.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Selection models.</title><p>(<bold>A</bold>) Functional form of mutation step probability, illustrated for parameters chosen to represent strong, moderate, and weak selection models. (<bold>B, C</bold>) Total log probability of the mutational trajectories between germline and somatic sequences for (<bold>B</bold>) CR9114 and (<bold>C</bold>) CR6261 under different antigen selection scenarios, assuming strong (left) or weak (right) selection, as shown for moderate selection in <xref ref-type="fig" rid="fig5">Figure 5E,F</xref>. Strong selection scenarios are shown on a linear scale, as total probability is equal to the number of uphill paths. The ‘average’ mixed scenario is not evaluated for strong selection, as the quantitative effect of averaging is undone by the binarizing effect of the transition probability. Error bars indicate standard errors obtained through bootstrap, see Materials and methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig5-figsupp1-v3.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Variant probabilities for CR9114 under the optimal (’O’) selection model.</title><p>(<bold>A</bold>) Histogram of the total probability of all pathways passing through each variant in the optimal selection scenario, divided by the total probability in a model with no selection, transformed to log<sub>10</sub> scale (see Materials and methods). Dotted line indicates the 11% of variants favored in the selective model (log probability ratio greater than zero). (<bold>B</bold>) Favored variants are shown on the force-directed graph for CR9114 H1 –logK<sub>D</sub>, as in <xref ref-type="fig" rid="fig1">Figure 1G</xref>, with darker color according to the log probability ratio. Other variants with log probability ratio less than zero are shown in light yellow.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig5-figsupp2-v3.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Probability of mutation order assuming moderate selection, under other antigen selection scenarios.</title><p>H1 (<bold>A</bold>) and 'R' (<bold>B</bold>) for CR9114 and 'O' (<bold>C</bold>) and 'R' (<bold>D</bold>) for CR6261, as in <xref ref-type="fig" rid="fig5">Figure 5I,J</xref>. For the random mixed scenario 'R', the representative cases from <xref ref-type="fig" rid="fig5">Figure 5G,H</xref> are shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-fig5-figsupp3-v3.tif"/></fig></fig-group><p>To compare antigen selection scenarios more generally, we developed a framework that evaluates the total probability of all possible mutational pathways from germline to somatic, under an array of antigen selection scenarios (individual, sequential, and mixed). Our framework assumes that the probability of any mutational step is higher if –logK<sub>D</sub> increases, but does not necessarily forbid neutral or deleterious steps; we evaluate a variety of specific forms of this step probability and find that our major results are consistent (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>, see Materials and methods). We assume that each amino acid substitution occurs in a single mutational step; though there are amino acid substitutions that must proceed by multiple nucleotide mutations that may occur in a single round, or over multiple rounds, of somatic hypermutation (<xref ref-type="bibr" rid="bib69">Spisak et al., 2020</xref>; <xref ref-type="bibr" rid="bib74">Unniraman and Schatz, 2007</xref>). Mixed antigen regimes approximate exposure to a cocktail of antigens. We model these with two approaches: (1) ‘average’, using the average –logK<sub>D</sub> across all antigens, and (2) 'random', using –logK<sub>D</sub> for a randomly selected antigen at each step (note that using the maximum –logK<sub>D</sub> across antigens would always be trivially favored) (<xref ref-type="bibr" rid="bib77">Wang et al., 2015</xref>). While these models simplify the complexities of affinity maturation <italic>in vivo</italic> (<xref ref-type="bibr" rid="bib75">Victora and Nussenzweig, 2012</xref>), especially how affinity relates to B cell lineage dynamics and the mutational bias at the nucleotide level (<xref ref-type="bibr" rid="bib69">Spisak et al., 2020</xref>), they provide insight into the relative probabilities of mutational paths under distinct antigen selection scenarios.</p><p>Again we find that the vast majority of likely antigen selection scenarios for CR9114 involve first H1, followed by H3, followed by influenza B (<xref ref-type="fig" rid="fig5">Figure 5E</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>). These results are underscored by examining improvement in –logK<sub>D</sub> along the most likely mutational paths for each scenario (<xref ref-type="fig" rid="fig5">Figure 5G</xref>): in the optimal sequential scenario, –logK<sub>D</sub> can improve substantially for each antigen in turn, while in an H1-only scenario, the improvements in H1 binding at each step are much more gradual, reducing the likelihood. The average mixed scenario shows qualitatively similar paths to the optimal sequential scenario, although with lower overall probability. In the random mixed scenario, even the best pathways are often unable to improve affinity to the randomly selected antigen, and affinity to antigens not under selection often declines, making these scenarios much less likely.</p><p>Given the optimal sequential selection scenario, the vast majority of genotypes are unlikely evolutionary intermediates to the somatic sequence (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). We visualize the impact of epistasis on mutational order by considering the probability of each mutation to occur at each mutational step (<xref ref-type="fig" rid="fig5">Figure 5I</xref>; <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). The three antigen exposure epochs exhibit clear differences in favored mutations. Mutations I57S, K82I, and S83F must occur early, due to their strong synergistic interactions for all three antigens. In addition, we see that F30S is unlikely to happen very early (due to its sign epistasis under H1 selection) as well as unlikely to happen very late (due to its strong benefit under influenza B selection).</p><p>In contrast, for CR6261, all selection scenarios have relatively similar likelihood (<xref ref-type="fig" rid="fig5">Figure 5F</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>). Among sequential scenarios, however, those beginning with H1 are more likely than those beginning with H9, as the first two mutational steps can improve affinity to H1 more than H9, and mutations late in maturation can improve affinity to H9 more than H1 (<xref ref-type="fig" rid="fig1">Figure 1F</xref>, <xref ref-type="fig" rid="fig5">Figure 5B</xref>). Still, unlike CR9114, in both single antigen and mixed scenarios, there are many likely paths that continually improve in binding to both antigens (<xref ref-type="fig" rid="fig5">Figure 5H</xref>). Initially the order of mutations is highly constrained due to strong synergistic epistasis, and differences between selection scenarios reflect differences in mutational effects between antigens (<xref ref-type="fig" rid="fig5">Figure 5J</xref>, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). We note that T29P is highly likely to occur first in scenarios that begin with H1, as this is the only single mutation that can improve H1 affinity, albeit rather modestly.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Overall, we find that evolutionary pathways to bnAbs can be highly contingent on epistatic and pleiotropic effects of mutations. Specifically, the acquisition of breadth for CR9114 is extremely constrained and is likely to have occurred through exposure to diverse antigens in a specific order, due to the structure of correlations and interactions between mutational effects. In contrast, CR6261 could have acquired affinity to H1 and H9 in a continuous and simultaneous manner, perhaps because these antigens are more similar; since H9 is not a commonly circulating strain, this breadth was likely acquired by chance (<xref ref-type="bibr" rid="bib54">Pappas et al., 2014</xref>).</p><p>We note that we cannot conclusively determine how CR9114 and CR6261 evolved <italic>in vivo</italic>. The isolation of these specific antibodies from phage display libraries (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>) was likely biased by the HA subtypes used for screening, and although unlikely, may have introduced mutations during PCR amplification. Regardless, these antibody sequences occupy regions of sequence space that are useful for understanding the relationship between sequence, affinity, and breadth. By characterizing their binding landscapes, we find that epistasis and trade-offs constrain the mutational pathways to these specific somatic sequences and their associated breadth. Indeed, we find that not all of the observed mutations are required to confer broad affinity, and future work is needed to explore what alternative pathways to breadth might be accessible through other mutations. It is also worth noting that selection pressure to bind the HA stem epitope on virions may be different from pressure to bind soluble recombinant HA, although several studies have found anti-stem antibody affinity to recombinant HA to be indicative of viral neutralization (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Corti et al., 2011</xref>; <xref ref-type="bibr" rid="bib41">Lingwood et al., 2012</xref>). Further, stem-targeting bnAbs and their germline precursors have been characterized as polyreactive (<xref ref-type="bibr" rid="bib5">Bajic et al., 2019</xref>; <xref ref-type="bibr" rid="bib31">Guthmiller et al., 2020</xref>) and thus likely experience additional selection pressures that are not captured by our measurements and models, such as negative selection against autoreactivity. Although we cannot determine which specific antigens were involved in the selection of these antibodies <italic>in vivo</italic>, the diverse HA subtypes we employ capture variation representative of circulating influenza strains and thus serve as useful probes of varying levels of breadth (<xref ref-type="bibr" rid="bib16">Corti et al., 2017</xref>). Future work integrating these measurements of affinity and breadth with measurements of stability and polyreactivity will provide important insight into the molecular constraints of bnAb evolution.</p><p>Notably, the landscapes characterized here are among the largest combinatorially complete collections of mutations published to date. In some respects, our observations of high-order interactions are consistent with earlier work in other proteins. In particular, epistasis has been found to affect function and constrain evolutionarily accessible pathways across functionally and structurally distinct proteins (<xref ref-type="bibr" rid="bib79">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib71">Starr et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Ortlund et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Podgornaia and Laub, 2015</xref>; <xref ref-type="bibr" rid="bib30">Gong et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>; <xref ref-type="bibr" rid="bib47">Miton and Tokuriki, 2016</xref>; <xref ref-type="bibr" rid="bib60">Poelwijk et al., 2019</xref>; <xref ref-type="bibr" rid="bib7">Bank et al., 2015</xref>). Further, pairwise and high-order epistasis appear to be common features of binding interfaces, such as enzyme-substrate and receptor-ligand interactions (<xref ref-type="bibr" rid="bib79">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib71">Starr et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Ortlund et al., 2007</xref>; <xref ref-type="bibr" rid="bib58">Podgornaia and Laub, 2015</xref>; <xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>; <xref ref-type="bibr" rid="bib47">Miton and Tokuriki, 2016</xref>), and interacting mutations are often spaced in both sequence and structure, underscoring the complexity of protein-protein interfaces (<xref ref-type="bibr" rid="bib58">Podgornaia and Laub, 2015</xref>; <xref ref-type="bibr" rid="bib2">Adams et al., 2019</xref>; <xref ref-type="bibr" rid="bib12">Braden et al., 1998</xref>; <xref ref-type="bibr" rid="bib24">Esmaielbeiki et al., 2016</xref>; <xref ref-type="bibr" rid="bib61">Rotem et al., 2018</xref>). On the other hand, the strongly synergistic, nested mutations crucial for CR9114 breadth are unusual, perhaps due to the nature of antibody-antigen interfaces or to the unique dynamics of affinity maturation (<xref ref-type="bibr" rid="bib75">Victora and Nussenzweig, 2012</xref>). Together, these observations suggest that interactions between multiple mutations, such as those we characterize here, could play a substantial role in affinity maturation and may contribute to the rarity of bnAbs in natural repertoires.</p><p>Our findings provide molecular insight into the emerging picture of how selection can elicit broad affinity, illustrated by a substantial recent body of work ranging from <italic>in vivo</italic> experimental approaches (<xref ref-type="bibr" rid="bib39">Krammer et al., 2012</xref>; <xref ref-type="bibr" rid="bib76">Wang et al., 2010</xref>) to quantitative modeling of immune system dynamics (<xref ref-type="bibr" rid="bib77">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Wang, 2017</xref>; <xref ref-type="bibr" rid="bib62">Sachdeva et al., 2020</xref>; <xref ref-type="bibr" rid="bib48">Molari et al., 2020</xref>; <xref ref-type="bibr" rid="bib70">Sprenger et al., 2020</xref>). These diverse studies often find that mixed-antigen regimens are less effective than sequential regimens at eliciting bnAbs. Our results demonstrate that, at least in part, this may be due to the intrinsic structure of the mutational landscape, defined by the complex interactions of mutational effects across antigens. With more studies of binding landscapes for diverse antibodies, we could better understand how such features generalize between different germline sequences, somatic mutation profiles, and antigen molecules. These insights will be valuable for leveraging germline sequence data and antigen exposure information to predict, design, and elicit bnAbs for therapeutic and immunization applications.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type <break/>(species) or resource</th><th>Designation</th><th>Source or reference</th><th>Identifiers</th><th>Additional information</th></tr></thead><tbody><tr><td>Strain, strain background (<italic>Saccharomyces cerevisiae</italic>)</td><td>EBY100</td><td>ATCC</td><td>Cat#:MYA-4941</td><td/></tr><tr><td>Cell line (<italic>Spodoptera frugiperda</italic>)</td><td>Sf9</td><td>ThermoFisher</td><td>Cat#:B82501</td><td>Cell line for production of baculovirus</td></tr><tr><td>Cell line (<italic>Trichoplusia ni</italic>)</td><td>High-Five</td><td>ThermoFisher</td><td>Cat#:B85502</td><td>Cell line for HA expression</td></tr><tr><td>Antibody</td><td>Anti-cMyc-FITC (Mouse monoclonal)</td><td>Miltenyi Biotec</td><td>Cat#:130-116-485</td><td>FACS (1:50)</td></tr><tr><td>Recombinant DNA reagent</td><td>pCT302 (plasmid)</td><td>Addgene</td><td>Cat#:41845</td><td/></tr><tr><td>Recombinant DNA reagent</td><td>pCT302_CR9114 _germline (plasmid)</td><td>This paper</td><td/><td>Plasmid map in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>pCT302_CR9114 _somatic (plasmid)</td><td>This paper</td><td/><td>Plasmid map in<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>pCT302_CR6261 _germline (plasmid)</td><td>This paper</td><td/><td>Plasmid map in<xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>pCT302_CR6261 _somatic (plasmid)</td><td>This paper</td><td/><td>Plasmid map in<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref></td></tr><tr><td>Recombinant DNA reagent</td><td>pET21a-BirA (plasmid)</td><td>Addgene</td><td>Cat#:20857</td><td/></tr><tr><td>Sequence-based reagent</td><td>CR9114 golden gate dsDNA fragments</td><td>IDT</td><td/><td>Sequences listed in<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref></td></tr><tr><td>Sequence-based reagent</td><td>CR6261 Golden Gate primers</td><td>IDT</td><td/><td>Sequences listed in<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref></td></tr><tr><td>Sequence-based reagent</td><td>Illumina sequencing primers</td><td>IDT</td><td/><td>Sequences listed in<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref></td></tr><tr><td>Peptide, recombinant protein</td><td>Streptavidin-RPE</td><td>ThermoFisher</td><td>Cat#:S866</td><td>FACS (1:100)</td></tr><tr><td>Peptide, recombinant protein</td><td>Biotinylated A/New Caledonia/99 (H1) ectodomain</td><td>This paper</td><td/><td>Plasmid sequence in<xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref></td></tr><tr><td>Peptide, recombinant protein</td><td>Biotinylated A/Hong Kong/99 (H9) ectodomain</td><td>This paper</td><td/><td>Plasmid sequence in<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref></td></tr><tr><td>Peptide, recombinant protein</td><td>Biotinylated A/Wisconsin/05 (H3) ectodomain</td><td>This paper</td><td/><td>Plasmid sequence in<xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref></td></tr><tr><td>Peptide, recombinant protein</td><td>Biotinylated B/Ohio/05 (Flu B) ectodomain</td><td>This paper</td><td/><td>Plasmid sequence in<xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref></td></tr><tr><td>Commercial assay or kit</td><td>Bac-to-Bac Kit</td><td>ThermoFisher</td><td>Cat#:10359016</td><td/></tr><tr><td>Commercial assay or kit</td><td>Zymo Yeast Plasmid Miniprep II</td><td>Zymo Research</td><td>Cat#:D2004</td><td/></tr><tr><td>Software, algorithm</td><td>Custom code</td><td>This paper</td><td/><td><ext-link ext-link-type="uri" xlink:href="https://github.com/klawrence26/bnab-landscapes">https://github.com/klawrence26/bnab-landscapes</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:2b1db6b6b013543a2102e68e152eb125713ce50e;origin=https://github.com/klawrence26/bnab-landscapes;visit=swh:1:snp:102351fc5c431d8c9ba84961f57a0f1ef2c82733;anchor=swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90">swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90</ext-link>, <xref ref-type="bibr" rid="bib57">Phillips, 2021</xref>)</td></tr><tr><td>Software, algorithm</td><td>Interactive CR9114 data browser</td><td>This paper</td><td/><td><ext-link ext-link-type="uri" xlink:href="https://yodabrowser.netlify.app/yoda_browser/">https://yodabrowser.netlify.app/yoda_browser/</ext-link></td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Antibody library production</title><sec id="s4-1-1"><title>Germline sequence reconstructions</title><p>For CR9114, we obtained the somatic heavy chain nucleotide sequence from <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref> (GenBank JX213639.1) and reconstructed the germline nucleotide sequence using IMGT (<xref ref-type="bibr" rid="bib29">Giudicelli et al., 2006</xref>) and IgBLAST (<xref ref-type="bibr" rid="bib85">Ye et al., 2013</xref>). Both methods assigned the same V-gene and J-gene alleles (IGHV1-69*06 and IGHJ6*02), but there is ambiguity in the D-gene assignment and at the V-D junction, particularly at site 109. The preferred IMGT junction alignment assigns a mutation here, S109N, while a different junction alignment from IgBLAST does not. Because of the inherent difficulty of reconstructing mutations in the junction region, especially in antibodies with a short D region, we chose the alignment without the mutation at site 109. Our reconstructed germline nucleotide sequence is available in <xref ref-type="supplementary-material" rid="supp12">Supplementary file 12</xref>. We then took the resulting germline and somatic amino acid sequences, as shown in <xref ref-type="fig" rid="fig1">Figure 1A</xref>, and constructed new nucleotide sequences codon-optimized for yeast.</p><p>For CR6261, the somatic and reconstructed germline heavy chain amino acid sequences were published in <xref ref-type="bibr" rid="bib41">Lingwood et al., 2012</xref>. We used these sequences, similarly constructing codon-optimized nucleotide sequences for expression in yeast. The original somatic nucleotide sequence is also available (GenBank HI919029.1).</p><p>We note that all antibody libraries and clonal strains were constructed using somatic forms of the light chain, as these antibodies were isolated by combinatorial phage display (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>), and so it is not possible to infer the naturally paired germline light chain sequence. Additionally, the CR9114 and CR6261 light chains were previously determined not to impact binding (<xref ref-type="bibr" rid="bib41">Lingwood et al., 2012</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>). The somatic light chain sequence for CR9114 was obtained from <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref> (GenBank JX213640.1), and that for CR6261 was obtained from <xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref> (GenBank HI919031.1).</p></sec><sec id="s4-1-2"><title>Mutation selection</title><p>CR9114 contains a total of 18 amino acid substitutions between the somatic variant and the reconstructed germline sequence. However, a library of <inline-formula><mml:math id="inf12"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>18</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mn>262</mml:mn><mml:mo>,</mml:mo><mml:mn>144</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> variants would be costly and time-consuming to produce and assay via our methods. We therefore identified two mutations that were distant from antigen contacts in the crystal structure: A25S and E51D (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>). We measured binding affinities for somatic sequences with and without these two mutations, and found that these variants had comparable affinities for both H1 and H3 (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>). Although these mutations may have some small impact on binding, especially in combination with others, excluding them allowed for a simpler cloning strategy and a more manageable library size.</p><p>Similar to the CR9114 library design, we reduced the number of mutations present in the CR6261 library by excluding three mutations that were distant from antigen contacts in the crystal structure: 6QE, L50P, and V101M (<xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>). We validated the marginal contribution of these mutations to binding by measuring the binding affinities for the somatic sequence with and without these mutations reverted to the respective germline residue (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>).</p></sec><sec id="s4-1-3"><title>Yeast display plasmid and strains</title><p>To generate clonal yeast display strains and libraries for CR9114, we cloned scFv constructs (V<sub>L</sub> -Ser(Gly<sub>4</sub>Ser)<sub>5</sub>-V<sub>H</sub>-Myc) into the pCT302 plasmid (<xref ref-type="bibr" rid="bib46">Midelfort et al., 2004</xref>) (kind gift from Dane Wittrup; Addgene, Watertown, MA, #41845). For the clonal CR9114 somatic and germline strains, gene blocks corresponding to the somatic or inferred germline sequences were cloned into pCT302 by Gibson Assembly (<xref ref-type="bibr" rid="bib27">Gibson et al., 2009</xref>) (plasmid maps in <xref ref-type="supplementary-material" rid="supp4">Supplementary files 4</xref>–<xref ref-type="supplementary-material" rid="supp5">5</xref>). For producing the plasmid backbone required for Golden Gate library generation (described below), we removed an existing Bsa-I site from the pCT302 plasmid by site-directed mutagenesis (Agilent, Santa Clara, CA, #200521) and replaced the V<sub>H</sub> domain with the <italic>ccdB</italic> gene. To generate clonal yeast strains, Gibson Assembly products were transformed into electrocompetent DH10B <italic>E. coli</italic> cells, and the resulting plasmids were mini-prepped and Sanger sequenced. Following sequence confirmation, plasmids were transformed into EBY100 yeast cells (ATCC #MYA-4941) as described in the high-efficiency yeast transformation protocol (<xref ref-type="bibr" rid="bib28">Gietz and Schiestl, 2007</xref>). Transformants were plated on SDCAA-agar (1.71 g/L YNB without amino acids and ammonium sulfate [Sigma-Aldrich #Y1251], 5 g/L ammonium sulfate [Sigma-Aldrich #A4418], 2% dextrose [VWR #90000–904], 5 g/L Bacto casamino acids [VWR #223050], 100 g/L ampicillin [VWR #V0339], 2% Difco Noble Agar [VWR #90000–774]) and incubated at 30°C for 48 hr, single colonies were restruck on SDCAA-agar and again incubated at 30°C for 48 hr, and the resulting clonal yeast strains were verified to have the construct of interest by colony PCR. Construction of the yeast libraries is described below. All yeast strains were grown to saturation in SDCAA at 30°C, supplemented with 5% glycerol, and stored at −80°C.</p><p>CR6261 clonal yeast display strains and libraries were generated in an identical manner to that of CR9114, except where noted below (see <xref ref-type="supplementary-material" rid="supp6">Supplementary files 6</xref>–<xref ref-type="supplementary-material" rid="supp7">7</xref> for plasmid maps corresponding to the germline and somatic sequences).</p></sec><sec id="s4-1-4"><title>Golden gate assembly</title><p>For CR9114, due to the number of mutations required and their positions along the heavy chain coding sequence, we designed a library cloning strategy using Golden Gate combinatorial assembly (<xref ref-type="bibr" rid="bib23">Engler et al., 2008</xref>). We divided the heavy chain coding region into five roughly equal fragments, ranging from 79 to 85 bp and each containing between 1 and 5 mutations. We added BsaI sites and additional overhangs to both ends of each fragment sequence, with cut sites carefully chosen so that the five fragments will assemble uniquely in their proper order within the plasmid backbone. For each fragment with <inline-formula><mml:math id="inf13"><mml:mi>n</mml:mi></mml:math></inline-formula> mutations, we then ordered <inline-formula><mml:math id="inf14"><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> individual DNA duplexes with each possible combination of mutations (ranging from 2 to 32 versions for each fragment, a total of 66 fragments) from IDT (Coralville, IA) (see <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). By pooling the versions of each fragment in equal volumes, then pooling the five fragment pools in equimolar ratios, we obtained a randomized fragment mix containing all 2<sup>16</sup> sequences present at approximately equal frequencies.</p><p>In addition to the fragment mix, we prepared the plasmid backbone for the Golden Gate reaction. We created a version of the yeast display plasmid with the counter-selection marker <italic>ccdB</italic> in place of the heavy chain sequence, with flanking BsaI sites (see above). We performed Golden Gate cloning using BsaI-HFv2 (NEB, Ipswich, MA, #R3733) following the manufacturer recommended protocol, with a 5:1 molar ratio of the fragment insert pool to plasmid backbone.</p><p>We transformed the assembly mix into electrocompetent <italic>E. coli</italic> (DH10B) via electroporation in 10 x 50 μL cell aliquots. We recovered each transformation in 5 mL SOC (2% tryptone, 0.5% yeast extract, 10 mM NaCl, 2.5 mM KCl, 10 mM MgCl<sub>2</sub>, 10 mM MgSO<sub>4</sub>, 20 mM glucose) at 37°C for 1 hr, and then transferred each to 100 mL of molten LB (1% tryptone, 0.5% yeast extract, 1% NaCl) containing 0.3% SeaPrep agarose (VWR, Radnor, PA #12001–922) spread into a thin layer in a 1L baffled flask (about 1 cm deep). The mixture was allowed to set on ice for an hour, after which it was kept for 18 hr at 37C to allow for dispersed growth of colonies in 3D. We observed <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> colonies per aliquot, for a total of <inline-formula><mml:math id="inf16"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> million transformants. After mixing the flasks by shaking for 1 hr, we pelleted the cells and prepared plasmid by standard midiprep (Zymo Research, Irvine, CA, D4201), from which we obtained &gt;120 μg of purified plasmid.</p><p>For CR6261, we designed a library cloning strategy also using Golden Gate combinatorial assembly, but with fragments created by PCR instead of purchased. We divided the heavy chain coding region into three roughly equal fragments, each containing between 2 and 5 mutations. We designed these fragments such that the mutations they contain are close to the 3’ or 5’ ends and can thus be easily incorporated by PCR. PCR primers included mutations, BsaI sites, and unique overhangs chosen so that the three fragments would assemble uniquely in their proper order within the plasmid backbone. For each version of the three fragments, we generated dsDNA by PCR (52 PCR reactions in total; see <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref> for primer sequences). By pooling all versions of each fragment in equal volumes, then pooling the three fragment pools in equimolar ratios, we obtain a randomized fragment mix that, when ligated in the Golden Gate reaction, produces all of the 2<sup>11</sup> sequences present at approximately equal frequencies.</p><p>In addition to the fragment mix, we prepared the plasmid backbone for the Golden Gate reaction. We created a version of the yeast display plasmid with the counter-selection marker <italic>ccdB</italic> in place of the three-fragment sequence, with flanking BsaI sites. We performed Golden Gate cloning using BsaI-HFv2 (NEB #R3733) following the manufacturer recommended protocol, with a 7:1 molar ratio of fragment inserts to plasmid backbone.</p><p>The transformation of the CR6261 library into <italic>E. coli</italic> was conducted in a similar fashion to that of CR9114, except that 8x50 μL cell aliquots were transformed, and 600,000 colonies were pooled for plasmid midiprep.</p></sec><sec id="s4-1-5"><title>Yeast library production</title><p>We then transformed the CR9114 plasmid library into EBY100 cells by standard high-efficiency protocols (<xref ref-type="bibr" rid="bib28">Gietz and Schiestl, 2007</xref>). We recovered transformants in molten SDCAA (1.71 g/L YNB without amino acids and ammonium sulfate (Sigma-Aldrich #Y1251), 5 g/L ammonium sulfate (Sigma-Aldrich, St. Louis, MO, #A4418), 2% dextrose (VWR #90000–904), 5 g/L Bacto casamino acids (VWR #223050), 100 g/L ampicillin (VWR # V0339)) containing 0.35% SeaPrep agarose (VWR #12001–922) spread into a thin layer (about 1 cm deep). The mixture was allowed to set on ice for an hour, after which it was kept for 48 hr at 30°C to allow for dispersed growth of colonies in 3D. From five such flasks, we obtained ∼700,000 colonies (&gt;10 times the library diversity). After mixing the flasks thoroughly by shaking for 1 hr, we grew cells in 5 mL tubes of liquid SDCAA for five generations and froze the saturated culture in 1 mL aliquots with 5% glycerol.</p><p>The CR6261 yeast library was generated in a manner identical to that of CR9114, except that ∼60,000 colonies were pooled due to the smaller library size.</p></sec><sec id="s4-1-6"><title>Isogenic strain production</title><p>In addition to the full library, for both CR9114 and CR6261 we assayed a small number of variants by low-throughput flow cytometry for Tite-Seq validation. Any individual variant in the library can be produced in the same manner as described above: we simply selected the DNA duplex fragments corresponding to each desired variant and set up an individual Golden Gate reaction. The resulting assembled plasmid was transformed into <italic>E. coli</italic>, mini-prepped, and transformed into EBY100 in the same manner as described above. We verified the sequence identity of each variant by Sanger sequencing the entire scFv sequence.</p><p>We also constructed isogenic strains for validation experiments with genotypes that are not present in the full library. For CR9114, to test the impact of excluding mutations A24S and E46D, we constructed a strain containing the remaining 16 somatic mutations by cloning a gene block of the corresponding V<sub>H</sub> sequence into the germline CR9114 pCT302 plasmid via Gibson Assembly (<xref ref-type="fig" rid="fig1s7">Figure 1—figure supplement 7</xref>). For CR6261, we similarly constructed a strain with the Q6E, L50P, and V101M mutations reverted.</p></sec></sec><sec id="s4-2"><title>Antigen production</title><sec id="s4-2-1"><title>Choice of HA antigens</title><p>CR9114 was isolated from pooled PBMC from three donors who had received the trivalent 2006 influenza vaccine (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>), which contained A/New Caledonia/20/1999 (H1N1), A/Wisconsin/67/2005 (H3N2), and B/Malaysia/2506/2004 (Victoria lineage) (<xref ref-type="bibr" rid="bib22">Ekiert et al., 2011</xref>). CR6261 was isolated from pooled PBMC from the same three donors, plus an additional seven donors who did not receive the vaccine (<xref ref-type="bibr" rid="bib73">Throsby et al., 2008</xref>). Because PBMC were isolated only 7 days after vaccination, although it is possible that CR6261 and CR9114 matured in response to these specific antigens, it is more likely that the vaccine elicited memory recall of these antibodies (<xref ref-type="bibr" rid="bib75">Victora and Nussenzweig, 2012</xref>). Here, we chose to measure binding affinities to diverse antigens spanning the range of breadth for both CR9114 and CR6261. CR9114 neutralizes strains across influenza A (groups 1 and 2) and influenza B, so we measured affinities to one strain from each of these groups, and selected vaccine-like strains: A/New Caledonia/20/1999 (H1N1), A/Wisconsin/67/2005 (H3N2), and B/Ohio/1/2005 (Victoria lineage). CR6261 neutralizes strains across influenza A group 1, thus we measured affinities to two strains from distinct subtypes within group 1: A/New Caledonia/20/1999 (H1N1) and A/Hong Kong/1073/1999 (H9N2). We note that CR9114 indeed binds A/Hong Kong/1073/1999 (H9N2) (<xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>), but CR9114 variant affinities for this strain were not measured here, as we prioritized measurements to antigens that span the breadth of each antibody.</p></sec><sec id="s4-2-2"><title>HA cloning, expression, and purification</title><p>Trimeric hemagglutinin (HA) antigen was produced as previously described (<xref ref-type="bibr" rid="bib22">Ekiert et al., 2011</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; <xref ref-type="bibr" rid="bib43">Margine et al., 2013</xref>). Briefly, the HA ectodomain (Influenza A: residues 11–329 of HA1 and 1–176 of HA2 (H3 numbering); Influenza B: residues 1–523) of Influenza A/New Caledonia/1999 H1, Influenza A/Hong Kong/1999 H9, Influenza A/Wisconsin/2005 H3, and Influenza B/Ohio/2005, with N-terminal gp67 signal peptide and C-terminal biotinylation site (GGGLNDIFEAQKIEWHE), thrombin cleavage site, trimerization domain and His<sub>6</sub> tag, were cloned into pFastbac (plasmid maps in <xref ref-type="supplementary-material" rid="supp8">Supplementary files 8</xref>–<xref ref-type="supplementary-material" rid="supp11">11</xref>). Recombinant bacmid was generated using the ThermoFisher Bac-to-Bac kit (ThermoFisher, Waltham, MA, #10359016). Sf9 cells (ThermoFisher #B82501, not authenticated but verified to be mycoplasma-negative) were then transfected (ThermoFisher #A38915, not authenticated but verified to be mycoplasma-negative) with the resulting bacmids, and P0 HA-baculovirus was harvested 7 days post-transfection by clarifying viral supernatant at 1000 x g for 10 min. HA-baculovirus was then amplified twice by successively infecting 187 million Sf9 cells with 100 μL of viral supernatant and incubating in a humidified incubator at 28°C for 12 days. To induce HA expression, 105 million High-Five cells (ThermoFisher #B85502) were resuspended with 15 mL P2 HA-baculovirus, incubated for 20 min at room temperature, and then transferred to a 1 L non-baffled flask with 200 mL Corning Express-Five media (ThermoFisher #10486025) supplemented with 18 mM L-glutamine (VWR #45000–676). Expression cultures were incubated in a shaking incubator at 28C and 110 rpm for 48 hr, after which HA-containing media was clarified by spinning first at 1000 x g for 5 min at 4°C, and then by spinning the resulting supernatant again at 4000 x g for 20 min at 4C. The clarified media was then dialyzed into PBS (VWR #45000–448) by performing 4 x 2 hr 10-fold buffer exchanges to remove metal chelators from culture media. Dialyzed media was then combined with 10 mL equilibrated NiNTA resin (ThermoFisher #R90101), gently shaken for 3 hr at 4°C, and loaded onto a column. The resin was washed first with 15 column volumes Wash Buffer 1 (50 mM Tris pH 8 at 4C, 300 mM KCl, 10 mM imidazole) and subsequently with 15 column volumes Wash Buffer 2 (50 mM Tris pH 8 at 4C, 300 mM KCl, 20 mM imidazole). HA was eluted from the resin after 10 min incubation with Elution Buffer (50 mM Tris pH 8 at 4°C, 300 mM KCl, 250 mM imidazole). HA was then buffer exchanged into PBS using 10 KDa Amicon Ultra Centrifugal Filters (Millipore Sigma, Burlington, MA #UFC901008) and concentrated to at least 1 mg/mL for downstream biotinylation.</p></sec><sec id="s4-2-3"><title>BirA expression and purification</title><p>BirA was expressed and purified as previously described (<xref ref-type="bibr" rid="bib22">Ekiert et al., 2011</xref>). Briefly, pET21a-BirA expression plasmid (<xref ref-type="bibr" rid="bib34">Howarth et al., 2005</xref>) (kind gift from Alice Ting; Addgene #20857) was transformed into BL21 (DE3). Transformed BL21 cells were grown in 4 L baffled flasks with 1 L low-salt LB medium (5 g/L NaCl, 5 g/L yeast extract (VWR #90000–722), 10 g/L tryptone (VWR #90000–286)) at 37°C to an OD (600 nm) of ∼0.8. The culture was then moved into cold water to bring it to 23°C, IPTG was added to a final concentration of 1 mM, and the culture was incubated at 23C for ∼16 hr. The culture was then harvested by centrifugation (3000 x g, 10 min), resuspended in 30 mL lysis buffer (50 mM Tris pH 8 at 4C, 300 mM KCl, 10 mM imidazole, EDTA-free protease inhibitor cocktail tablet (Millipore Sigma #4693159001)), lysed by sonication (Branson Sonifier 450), and shaken at 4°C for 30 min. Lysate was clarified by spinning at 25,000 x g for 1 hr, and then the supernatant was incubated with 5 mL NiNTA resin at 4°C for 3 hr with gentle shaking. The resin was pelleted by spinning at 500 x g for 5 min and washed twice by gentle shaking with 35 mL lysis buffer at 4°C for 30 min. Protein was eluted with 20 mL Elution Buffer (50 mM Tris pH 8 at 4°C, 300 mM KCl, 250 mM imidazole), buffer exchanged into Storage Buffer (50 mM Tris pH 7.5 at 4°C, 200 mM KCl, 5% glycerol) using 10 KDa Amicon Ultra Centrifugal Filters (Millipore Sigma #UFC901008), flash frozen in liquid nitrogen, and stored in single-use aliquots at −80°C.</p></sec><sec id="s4-2-4"><title>Biotinylation and HA-biotin quality control</title><p>Purified hemagglutinin was biotinylated as previously described (<xref ref-type="bibr" rid="bib25">Fairhead and Howarth, 2015</xref>; <xref ref-type="bibr" rid="bib22">Ekiert et al., 2011</xref>). Briefly, 100 μL HA (&gt; 1 mg/mL) was incubated with 0.5 μL 1 M MgCl<sub>2</sub>, 2 μL 100 mM ATP, 0.5 μL 50 mM biotin, and 2.5 μL BirA (10 mg/mL). This was mixed by gentle pipetting and incubated at 30C with gentle rocking. After 1 hr incubation, equivalent amounts of ATP, BirA, and biotin were added to the reaction, which was incubated for an additional hour at 30°C. Following the 2 hr incubation, the 100 μL reaction was exchanged thrice into 15 mL PBS using a 50 KDa MWCO buffer exchange column (Millipore Sigma #UFC905008). The degree of biotinylation was then assessed by a streptavidin gel-shift assay, as previously described (<xref ref-type="bibr" rid="bib25">Fairhead and Howarth, 2015</xref>). Briefly, 10-fold molar excess streptavidin (Millipore Sigma #189730) was added to 4 μg biotinylated HA and incubated at room temperature for 5 min prior to running on SDS-PAGE. Gels were transferred to nitrocellulose membranes and probed with mouse anti-His monoclonal antibodies (ThermoFisher #R930-25) and Goat-anti-mouse secondary antibodies (LiCor, Lincoln, NE, Cat#925–32210). HA was verified to be &gt; 80% biotinylated by densitometry.</p></sec></sec><sec id="s4-3"><title>Tite-Seq assays</title><p>Tite-Seq was performed essentially as previously described (<xref ref-type="bibr" rid="bib1">Adams et al., 2016</xref>), with some modifications as detailed below. For each antibody-antigen pair, three replicate Tite-Seq assays were performed on different days.</p><sec id="s4-3-1"><title>Induction of antibody expression</title><p>On day 1, yeast scFv libraries, as well as germline and somatic clonal strains, were thawed by inoculating 5 mL SDCAA (1.71 g/L YNB without amino acids and ammonium sulfate (Sigma-Aldrich #Y1251), 5 g/L ammonium sulfate (Sigma-Aldrich #A4418), 2% dextrose (VWR #90000–904), 5 g/L Bacto casamino acids (VWR #223050), 100 g/L ampicillin (VWR # V0339)) with 150 μL glycerol stock (saturated culture with 5% glycerol) and rotated at 30°C for 20 hr. On day 2, yeast cultures were back-diluted to OD600 = 0.2 in 5 mL SDCAA and rotated at 30°C for approximately 4 hr, or until reaching log phase (OD600 = 0.4–0.8). 1.5 mL log-phase cells were then pelleted, resuspended in 4 mL SGDCAA (1.71 g/L YNB without amino acids and ammonium sulfate (Sigma-Aldrich #Y1251), 5 g/L ammonium sulfate (Sigma-Aldrich #A4418), 0.2% dextrose (VWR #90000–904), 1.8% galactose (Sigma-Aldrich #G0625), 5 g/L Bacto casamino acids (VWR #223050), 100 g/L ampicillin (VWR #V0339)), and rotated at room temperature for 20–22 hr.</p></sec><sec id="s4-3-2"><title>Primary antigen labeling</title><p>On day 3, 20–22 hr post-induction, yeast cultures were pelleted, washed twice with 0.1% PBSA (VWR #45001–130; GoldBio, St. Louis, MO, #A-420–50), and resuspended to an OD600 of 1. A total of 700 μL of OD1 yeast cells were labeled with biotinylated HA at each of eleven antigen concentrations (half-log increments spanning 1 pM – 100 nM for H1 and H9, and 10 pM – 1 μM for H3 and influenza B, as well as no HA), with volumes adjusted such that the number of antigen molecules was in 10-fold excess of antibody molecules (assuming 50,000 scFv/cell). Yeast-HA mixtures were rocked at 4°C for 24 hr.</p></sec><sec id="s4-3-3"><title>Secondary labeling</title><p>On day 4, yeast-HA complexes were pelleted by spinning at 3000 x g for 10 min at 4°C, washed twice with 5% PBSA + 2 mM EDTA, and simultaneously labeled with Streptavidin-RPE (1:100, Thermo Fisher #S866) and anti-cMyc-FITC (1:50, Miltenyi Biotec, Somerville, MA, #130-116-485) at 4°C for 45 min. Following secondary labeling, yeast were washed twice with 5% PBSA + 2 mM EDTA, and left on ice in the dark until sorting.</p></sec><sec id="s4-3-4"><title>Sorting and recovery</title><p>Yeast were sorted on a BD FACS Aria Illu, equipped with 405 nm, 440 nm, 488 nm, 561 nm, and 635 nm lasers, and an 85 micron fixed nozzle. Prior to sorting, single-color controls were used to compensate for the minimal FITC overlap with PE. Single cells were gated by FSC vs SSC, and then this population was sorted either by expression (FITC) or by expression and binding (PE). For all sorts, at least ten-fold excess of the library diversity was sorted (∼1.6 million cells for CR9114; ∼500,000 cells for CR6261). For the expression sorts, singlets were sorted into eight equivalent FITC log-spaced gates. For the binding sorts, FITC-positive cells were sorted into 4 PE bins (the PE-negative population comprised bin 1, and the PE-positive population was split into three equivalent log-spaced bins 2–4; see <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>). Polypropylene collection tubes were coated and filled with 1 mL YPD supplemented with 1% BSA and placed on ice until recovery. Sorted cells were pelleted by spinning at 3000 x g for 10 min, and supernatant was removed by pipette to avoid disturbing the pellets. Pellets were then resuspended in 4 mL SDCAA, a small amount was plated on SDCAA-agar to quantify recovery efficiency, and cultures were rocked at 30°C until reaching late-log phase (OD600 = 0.6–1.2).</p></sec><sec id="s4-3-5"><title>Sequencing library preparation</title><p>A total of 1.5 mL of late-log yeast cultures were pelleted and scFv plasmid was extracted using Zymo Yeast Plasmid Miniprep II (Zymo Research # D2004), per the manufacturer’s instructions, and eluted in 10 μL elution buffer. Heavy-chain amplicon sequencing libraries were prepared by a two-step PCR as previously described (<xref ref-type="bibr" rid="bib49">Nguyen Ba et al., 2019</xref>). In the first PCR, unique molecular identifiers (UMI), inline indices, and partial Illumina adapters were appended to the heavy chain through 3–5 amplification cycles to minimize PCR amplification bias. In the second PCR, the remainder of the Illumina adapter and sample-specific Illumina i5 and i7 indices were appended through 35 amplification cycles (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for primer sequences). The first PCR used 5 μL plasmid DNA as template in a 25 μL reaction volume, with Q5 polymerase according to the manufactuer’s instructions (NEB # M0491L), and was incubated in a thermocycler with the following program: 1. 60 s at 98°C, 2. 10 s at 98°C, 3. 30 s at 66°C, 4. 30 s at 72°C, 5. GOTO 2, 2-4x, 6. 60 s at 72°C. PCR products were then combined with carrier RNA and purified by 1.1X Aline beads (Aline Biosciences #C-1003–5), and eluted in 35 μL elution buffer. 33 μL of the elution was used as input for the second PCR, in a total volume of 50 μL using Kapa polymerase (Kapa Biosystems #KK2502) according to the manufacturer’s instructions, and incubated in a thermocycler with the following program: 1. 30 s at 98°C, 2. 20 s at 98°C, 3. 30 s at 62°C, 4. 30 s at 72°C, 5. GOTO 2, 34x, 6. 300 s at 72°C. The resulting sequencing libraries were purified by 0.85X Aline beads, amplicon size was verified to be ∼500 bp by running on a 1% agarose gel, and amplicon concentration was quantified by a fluorescent DNA-binding dye (Biotium, Fremont, CA, #31068, per manufacturer’s instructions). Amplicons were then pooled for each gate according to the number of sorted cells to ensure even sequencing coverage. The pool was further size-selected by a two-sided Aline bead cleanup (0.55–0.85X), and the final pool size was verified by Tapestation 5000 HS and 1000 HS. Final sequencing library concentration was determined by Qubit fluorometer and sequenced on an Illumina NovaSeq S2 or Miseq v3 (2x150) with 5% PhiX.</p></sec><sec id="s4-3-6"><title>Sequencing data processing</title><p>We first processed our raw sequencing reads to identify and extract the indexes and mutational sites, discarding priming regions and the constant regions between mutations. To do so, we developed custom Python scripts using the approximate regular expression library regex (<xref ref-type="bibr" rid="bib8">Barnett, 2013</xref>), which allowed us to handle complications in sequence parsing that arise from the irregular lengths of the indices and from sequencing errors. We accept sequences that match the entire read (with no restrictions on bases at mutational sites) within the following mismatch tolerances: two mismatches in the multiplexing index, two mismatches in the priming site, and 15 substitution mismatches within the 170 bases of constant antibody sequence.</p><p>We then examine the mutational sites to call germline or somatic alleles, producing binary genotypes (‘0’ for germline or ‘1’ for somatic at each position). We require the exact germline or somatic sequence at every site: if there are any substitution errors in any of the mutation sites, the entire read is rejected. While it is possible to perform error correction based on Hamming distance to rescue reads with a few substitution errors, we find that on average only &lt;8% of reads per sample contain any errors, and so we adopt the conservative approach of requiring perfect matching.</p><p>We next discarded sequencing reads with any mismatched indices (four total indices from the two PCR reactions), as well as reads with duplicate UMI sequences. Counts for each genotype were then tabulated, producing the final counts used for binding affinity inference (see below). On average, across all antigens and replicates, we obtain a mean coverage of ∼350 for CR9114 and ∼950 for CR6261, and a median coverage of ∼250 for CR9114 and ∼900 for CR6261.</p></sec><sec id="s4-3-7"><title>Isogenic validation</title><p>Induction of scFv surface display, primary labeling, and secondary labeling of isogenic strains were performed identically to the Tite-Seq assay, except yeast cell and antigen volumes were scaled down by a factor of 10. Yeast cell FITC (scFv expression) and R-PE (HA binding) fluorescence intensity was assayed on a BD LSR Fortessa equipped with four lasers (440, 488, 561, and 633 nm). The equilibrium binding affinities (<inline-formula><mml:math id="inf17"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula>) for each variant are inferred by fitting the log of a Hill function to the mean log R-PE fluorescence of scFv-expressing (FITC+) singlet yeast cells:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mi>c</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf18"><mml:mi>c</mml:mi></mml:math></inline-formula> is the antigen concentration in molar units, <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the increase in fluorescence due to saturation with antigen, <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the background fluorescence, and <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the equilibrium binding affinity. All isogenic measurements were performed in two to three biological replicates; see <xref ref-type="supplementary-material" rid="fig1sdata3">Figure 1—source data 3</xref> for isogenic <inline-formula><mml:math id="inf22"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec></sec><sec id="s4-4"><title>Tite-Seq binding affinity inference</title><sec id="s4-4-1"><title>Mean-bin approach</title><p>To infer binding affinities using a simple mean-bin approach (<xref ref-type="bibr" rid="bib55">Peterman and Levine, 2016</xref>), we incorporate sequencing data (the unique read counts of each genotype sequence <inline-formula><mml:math id="inf23"><mml:mi>s</mml:mi></mml:math></inline-formula> in bin <inline-formula><mml:math id="inf24"><mml:mi>b</mml:mi></mml:math></inline-formula> at concentration <inline-formula><mml:math id="inf25"><mml:mi>c</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) with flow cytometry data (the mean and standard deviation of log<sub>10</sub>-fluorescence of sorted cells in each bin <inline-formula><mml:math id="inf27"><mml:mi>b</mml:mi></mml:math></inline-formula> at concentration <inline-formula><mml:math id="inf28"><mml:mi>c</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:msub></mml:math></inline-formula> respectively, and cell counts for each bin <inline-formula><mml:math id="inf31"><mml:mi>b</mml:mi></mml:math></inline-formula> at each concentration <inline-formula><mml:math id="inf32"><mml:mi>c</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>).</p><p>The mean log-fluorescence of each genotype sequence at each of the 12 antigen concentrations is calculated as:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:mrow><mml:mpadded width="+5pt"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability a cell with sequence <inline-formula><mml:math id="inf35"><mml:mi>s</mml:mi></mml:math></inline-formula> would be sorted into bin b at concentration c is estimated from the sequencing read counts as:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⋅</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>in other words, the fraction of total reads in the bin corresponding to sequence <inline-formula><mml:math id="inf36"><mml:mi>s</mml:mi></mml:math></inline-formula>, scaled by the number of sorted cells in that bin, normalized over the four bins for each concentration.</p><p>The uncertainty in the mean bin inference was propagated as:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> represents the spread in log-fluorescence values of cells sorted into the same bin <inline-formula><mml:math id="inf38"><mml:mi>b</mml:mi></mml:math></inline-formula>. While we could estimate this value using the bin width, in practice we find that the distribution of cell log-fluorescence values in a bin is far from uniform across the bin width. The distribution is often not normal either, but we find that approximating <inline-formula><mml:math id="inf39"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:math></inline-formula>, or the standard deviation in log<sub>10</sub>-fluorescence of cells sorted into bin <inline-formula><mml:math id="inf40"><mml:mi>b</mml:mi></mml:math></inline-formula> at concentration <inline-formula><mml:math id="inf41"><mml:mi>c</mml:mi></mml:math></inline-formula>, adequately captures the typical variation. The error in <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> arises largely from the sampling process of sequencing, which can be approximated as a Poisson process when read counts are relatively high. This gives<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be written as<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>b</mml:mi></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mpadded width="+5pt"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mpadded><mml:mo>⁢</mml:mo><mml:mfrac><mml:msubsup><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The equilibrium binding affinities (<inline-formula><mml:math id="inf44"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula>) for each variant are inferred by fitting the logarithm of a Hill function to the resulting mean log<sub>10</sub>-fluorescence across the twelve antigen concentrations:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mi>c</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf45"><mml:mi>c</mml:mi></mml:math></inline-formula> is the antigen concentration in molar units, <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>A</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the increase in fluorescence due to saturation with antigen, <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></inline-formula> is the background fluorescence, and <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the binding affinity. Fitting was performed with the <italic>curve_fit</italic> function of the Python package <italic>scipy.optimize</italic>. Reasonable bounds on the values of A(10<sup>3</sup>-10<sup>5</sup>), B(10<sup>0</sup>-10<sup>3</sup>) and K<sub>D</sub>(10<sup>-14</sup>-10<sup>-5</sup>) were imposed. Sequences leading to a failed optimization were deemed ‘non-binding’.</p><p>Inferred <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula> outside of the titration boundaries were then pinned to the boundaries (<inline-formula><mml:math id="inf50"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for H1 and H9; <inline-formula><mml:math id="inf52"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for H3 and FluB). Inferred <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula> with high error (standard deviation of <inline-formula><mml:math id="inf55"><mml:mrow><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>) or resulting from a poor fit (<inline-formula><mml:math id="inf56"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>) were removed from the data set prior to averaging <inline-formula><mml:math id="inf57"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values across biological replicates.</p><p>We also explored an alternative maximum-likelihood framework for inferring binding affinities (see Appendix 1), but found it to be less accurate than the mean-bin approach when compared to isogenic flow cytometry measurements. Thus, we restricted our analysis to the simpler and more robust mean-bin inference presented here.</p></sec><sec id="s4-4-2"><title>Force-directed layouts</title><p>To represent the high-dimensional binding affinity landscape in two dimensions, we use a force-directed graph layout approach. Each sequence in the antibody library is a node, connected by edges to its single-mutation neighbors (sequences that can be reached by one additional somatic mutation). An edge between two sequences <inline-formula><mml:math id="inf58"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:mi>t</mml:mi></mml:math></inline-formula> is given the weight<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mtext>ag</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>log</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mtext>ag</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf60"><mml:msubsup><mml:mi>K</mml:mi><mml:mi>D</mml:mi><mml:mtext>ag</mml:mtext></mml:msubsup></mml:math></inline-formula> represent binding affinities to a particular antigen, ag. In the layouts shown in the main text, we use binding affinities to H1 for both CR6261 and CR9114. In force-directed layouts, edge weights correspond to the effective spring constant that tends to pull nodes closer together. Thus, a mutation from sequence <inline-formula><mml:math id="inf61"><mml:mi>s</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf62"><mml:mi>t</mml:mi></mml:math></inline-formula> that has little impact on binding will cause that edge weight to be large, and the nodes will be pulled strongly together. A mutation from sequence <inline-formula><mml:math id="inf63"><mml:mi>s</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf64"><mml:mi>t</mml:mi></mml:math></inline-formula> that causes a large difference in binding affinity (positive or negative) to the antigen will reduce the edge weight, moving those nodes further apart. After assigning all edge weights, we use the layout function <italic>layout_drl</italic> from the Python package <italic>iGraph</italic>, with default settings, to obtain the layout coordinates for each variant.</p></sec><sec id="s4-4-3"><title>Expression data</title><p>As noted above, antibody libraries were sorted into eight bins along the FITC-A fluorescence axis (where FITC-A fluorescence is proportional to expression), each comprising 12.5% of the total singlet population (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>). The mean expression log-fluorescence was computed for each variant using the corresponding variant counts and fluorescence data, as described above for the mean-bin <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula> inference. These expression values were then averaged across all biological replicates for each antibody (nine replicates for CR9114, six replicates for CR6261), and correlation between biological replicates, as well as with <inline-formula><mml:math id="inf66"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values, are illustrated in <xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>. For the isogenic flow cytometry measurements, variant expression was computed as the mean log FITC-A fluorescence.</p></sec></sec><sec id="s4-5"><title>Epistasis analysis</title><sec id="s4-5-1"><title>Linear interaction models</title><p>To infer specific mutational effects, we begin with simple linear models where the effects of mutations (and mutation combinations) add to produce phenotypes. Our log-transformed phenotypes for each variant <inline-formula><mml:math id="inf67"><mml:mi>s</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf68"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, are proportional to free-energy changes, and thus a natural null expectation is that they combine additively (<xref ref-type="bibr" rid="bib80">Wells, 1990</xref>; <xref ref-type="bibr" rid="bib50">Olson et al., 2014</xref>) (although we also consider nonadditive epistatic interactions between individual loci here, and analyze the effects of an overall nonlinear transformation of this data in Appendix 2). Our additive-only model is<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p> where <inline-formula><mml:math id="inf69"><mml:mi>L</mml:mi></mml:math></inline-formula> is the number of mutations for a given antibody, <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is an intercept term, <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the effect of the mutation at site <inline-formula><mml:math id="inf72"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the genotype of variant <inline-formula><mml:math id="inf74"><mml:mi>s</mml:mi></mml:math></inline-formula> at site <inline-formula><mml:math id="inf75"><mml:mi>i</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf76"><mml:mi>ε</mml:mi></mml:math></inline-formula> represents independently and identically distributed errors. Our general linear interaction models are<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent second-order interaction coefficients between distinct sites <inline-formula><mml:math id="inf78"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represent third-order interaction coefficients, and so on up to the desired maximum order of interaction.</p><p>There are multiple alternative coding systems for the binary genotypes <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that affect the values of inferred effects <inline-formula><mml:math id="inf82"><mml:mi>β</mml:mi></mml:math></inline-formula> as well as their interpretation. Two common choices are (1) <inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, often called ‘biochemical’ or ‘local’ epistasis, and (2) <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, often called ‘statistical’ or ‘ensemble’ epistasis (<xref ref-type="bibr" rid="bib59">Poelwijk et al., 2016</xref>). These frameworks are equivalent and related by a simple linear transformation, but the values of the coefficients vary between frameworks and have different interpretations. For ease of interpretation, in the Main Text and Figures we always show results obtained from inference in the biochemical epistasis framework. In Appendix 2, we discuss the differences between these two frameworks, and present results from inference in the statistical epistasis framework.</p><p>For an antibody with <inline-formula><mml:math id="inf85"><mml:mi>L</mml:mi></mml:math></inline-formula> mutations, there are <inline-formula><mml:math id="inf86"><mml:mi>L</mml:mi></mml:math></inline-formula> possible orders of interactions, with a total of <inline-formula><mml:math id="inf87"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> epistatic coefficients <inline-formula><mml:math id="inf88"><mml:mi>β</mml:mi></mml:math></inline-formula>. From a measurement of <inline-formula><mml:math id="inf89"><mml:mi>y</mml:mi></mml:math></inline-formula> for all <inline-formula><mml:math id="inf90"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> possible sequences, there is a simple linear transformation to calculate the resulting <inline-formula><mml:math id="inf91"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup><mml:mi>β</mml:mi></mml:math></inline-formula> parameters (<xref ref-type="bibr" rid="bib59">Poelwijk et al., 2016</xref>). This is a simple and fast approach to the calculation of epistasis that is widely used (<xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>; <xref ref-type="bibr" rid="bib60">Poelwijk et al., 2019</xref>), and we explore this approach in Appendix 2. However, we may instead wish to restrict our model to a lower order and examine whether it can explain the data with far fewer than <inline-formula><mml:math id="inf92"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> parameters, as a conservative approach to detecting high-order epistasis.</p><p>Specifically, we truncate the model above at a maximum order <inline-formula><mml:math id="inf93"><mml:mi>n</mml:mi></mml:math></inline-formula> and then fit and evaluate the resulting model. We begin with <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and continue to increase <inline-formula><mml:math id="inf95"><mml:mi>n</mml:mi></mml:math></inline-formula> until the optimal model has been identified. There are multiple strategies for selecting between models with different numbers of parameters, such as AIC and BIC; here we take a cross-validation approach. For each fold, we hold out 10% of the dataset, train models at each maximum order on the remaining 90%, and evaluate the prediction performance (<inline-formula><mml:math id="inf96"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) of the model on the held-out test set. After averaging the performances across all 10 folds for each truncated model, we choose the order that maximizes the test set performance as the optimal maximal order of interaction. We then re-train the model truncated at this order on the full dataset to obtain the final coefficients. We find that the optimal model identified by cross-validation for each antibody-antigen pair satisfies <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> by ∼1 order of magnitude, where <inline-formula><mml:math id="inf98"><mml:mi>p</mml:mi></mml:math></inline-formula> is the total number of model coefficients and <inline-formula><mml:math id="inf99"><mml:mi>N</mml:mi></mml:math></inline-formula> the number of data points with measurable binding affinity. This gives confidence that our parameter estimates are well constrained by the data, even in the absence of other regularization (such as Lasso or Ridge regularization approaches).</p><p>To train a model of given order on a set of sequences, we use ordinary least squares (OLS) regression with the Python package <italic>statsmodels</italic>. From this, we obtain the coefficient values <inline-formula><mml:math id="inf100"><mml:mi>β</mml:mi></mml:math></inline-formula> with their standard errors and p-values. To define significance of coefficients, we use a p-value cutoff of 0.05 with Bonferroni correction by the total number of model parameters. Coefficients, standard errors, p-values, and Bonferroni-corrected 95% confidence intervals are reported in <xref ref-type="supplementary-material" rid="fig1sdata1">Figure 1—source data 1</xref> and <xref ref-type="supplementary-material" rid="fig1sdata2">2</xref>. We also predict phenotypes <inline-formula><mml:math id="inf101"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula> for each sequence from the coefficients and use these values in <xref ref-type="fig" rid="fig5">Figure 5A,B</xref>.</p><p>For CR9114 binding to influenza B, the number of sequences used for inference is far fewer than other antibody-antigen pairs (<inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>256</mml:mn></mml:mrow></mml:math></inline-formula>), due to the large number of required mutations. We therefore use a fivefold rather than 10-fold split to reduce the test set noise. Nevertheless, the cross-validation procedure identifies a first-order (additive) model as optimal, due to the smaller sample size.</p></sec><sec id="s4-5-2"><title>Structural analysis of epistatic coefficients</title><p>To examine the structural context of linear and pairwise coefficients, we performed three simple analyses. (1) First, we used ChimeraX (<xref ref-type="bibr" rid="bib56">Pettersen et al., 2021</xref>) to calculate the buried surface area between HA and each mutated residue in CR9114 and CR6261, using the measure buriedarea function and the default probeRadius of 1.4 angstroms to approximate a water molecule. We plot this ‘contact surface area’ vs the linear effect of the corresponding mutation on HA binding (<xref ref-type="fig" rid="fig2">Figure 2C</xref>; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). (2) We used PyMol (<xref ref-type="bibr" rid="bib67">Schrodinger, LLC, 2015</xref>) to count the number of HA residues within six angstroms of each antibody mutation site. Six angstroms was chosen as an upper limit to capture potential antibody-antigen interactions (<xref ref-type="bibr" rid="bib11">Bondi, 1964</xref>; <xref ref-type="bibr" rid="bib6">Baker and Hubbard, 1984</xref>; <xref ref-type="bibr" rid="bib35">Israelachvili and Pashley, 1982</xref>; <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>; <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>), although we note that this analysis is robust to other distance thresholds. (3) We also used PyMol to measure the distances between <inline-formula><mml:math id="inf103"><mml:mi>α</mml:mi></mml:math></inline-formula>-carbons for all mutation pairs, and plotted these distances against the corresponding pairwise epistatic terms (<xref ref-type="fig" rid="fig2">Figure 2F</xref>; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). We note that each of these analyses were performed with co-crystal structures of the somatic antibodies with HA (PDB ID: 4FQI (CR9114 –H5; CR9114 –H1 crystal structure not available) <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; 4FQY (CR9114 –H3) <xref ref-type="bibr" rid="bib20">Dreyfus et al., 2012</xref>; 3GBN (CR6261 –H1) <xref ref-type="bibr" rid="bib21">Ekiert et al., 2009</xref>).</p></sec></sec><sec id="s4-6"><title>Pathway analysis</title><sec id="s4-6-1"><title>Selection models</title><p>To study the likelihood of various mutational pathways leading from the germline to the somatic sequence, we must assume a selection model. Selection in germinal centers is considerably more complex than in classical population genetics models, involving spatial structure, changing population sizes, and T-cell-mediated selection, among other factors (<xref ref-type="bibr" rid="bib45">Mesin et al., 2016</xref>). Capturing these aspects in quantitative models is an active field of research (<xref ref-type="bibr" rid="bib3">Amitai et al., 2017</xref>). However, here we wish to adopt an extremely simple model of selection as a first step in understanding the impacts of the binding affinity landscape on antibody selection, with the goal of understanding the implications of the expectation that mutational steps become more probable as their effect on binding affinity becomes more positive. Combining the more realistic models of immune selection with our detailed characterization of mutational effects on antigen binding affinity remains an interesting avenue for future work.</p><p>Here, we restrict to the weak-mutation regime where mutation fixation events occur independently of one another. Selection proceeds as a Markov process, where the population is characterized by a single sequence that acquires a single mutation at each discrete step (<xref ref-type="bibr" rid="bib44">McCandlish, 2011</xref>). We choose a simple form for the fixation probability of a mutation from sequence <inline-formula><mml:math id="inf104"><mml:mi>s</mml:mi></mml:math></inline-formula> to sequence <inline-formula><mml:math id="inf105"><mml:mi>t</mml:mi></mml:math></inline-formula>, as discussed below. This then determines the transition probability for the population to move from <inline-formula><mml:math id="inf106"><mml:mi>s</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf107"><mml:mi>t</mml:mi></mml:math></inline-formula>. We assume that sequences cannot back-mutate (i.e. a residue changing from the somatic allele to the germline allele), and do not acquire multiple mutations in the same step. The absence of back-mutation is justified by the relatively large number of possible mutation sites compared to the total number of mutation events.</p><p>We define the transition probability of a single mutational step from the classical fixation probability for a mutation with selection coefficient <inline-formula><mml:math id="inf108"><mml:mi>σ</mml:mi></mml:math></inline-formula> in a population of size <inline-formula><mml:math id="inf109"><mml:mi>N</mml:mi></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib36">Kimura, 1962</xref>):<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>step</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>σ</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mi>σ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Here, we define the selection coefficient <inline-formula><mml:math id="inf110"><mml:mi>σ</mml:mi></mml:math></inline-formula> to be proportional to the difference in log binding affinities to a particular antigen between the two sequences <inline-formula><mml:math id="inf111"><mml:mi>s</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mi>t</mml:mi></mml:math></inline-formula>:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This model has two tunable parameters: <inline-formula><mml:math id="inf113"><mml:mi>N</mml:mi></mml:math></inline-formula> represents the effective population size and <inline-formula><mml:math id="inf114"><mml:mi>γ</mml:mi></mml:math></inline-formula> represents how strongly differences in binding affinity impact fitness. We chose three parameter values to span a range of selection strengths (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>): moderate, with <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; weak, with <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>; and strong, with <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>N</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>p</mml:mi><mml:mtext>step</mml:mtext></mml:msub></mml:math></inline-formula> reduces to a step function (one if <inline-formula><mml:math id="inf122"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and 0 otherwise). These three models all show similar results, with differences between selection scenarios becoming more exaggerated with stronger selection and less exaggerated with weaker selection, as expected (see <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><p>From the fixation probabilities for a given parameter regime, we have the transition probability (up to a constant factor) for all sequences <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> over all antigens ag,<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mtext>step</mml:mtext></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mi>t</mml:mi> <mml:mtext>has one more somatic mutation than </mml:mtext><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>which we use for all the calculations described below for results presented in <xref ref-type="fig" rid="fig5">Figure 5</xref> and supplements.</p></sec><sec id="s4-6-2"><title>Scenario, mutation, and variant probabilities</title><p>It is particularly useful to store the probabilities <inline-formula><mml:math id="inf124"><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:math></inline-formula> as (sparse) transition matrices <inline-formula><mml:math id="inf125"><mml:msup><mml:mi>P</mml:mi><mml:mtext>ag</mml:mtext></mml:msup></mml:math></inline-formula> of dimension <inline-formula><mml:math id="inf126"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> for each antigen, where entries are nonzero only where sequence <inline-formula><mml:math id="inf127"><mml:mi>t</mml:mi></mml:math></inline-formula> has one more somatic mutation than <inline-formula><mml:math id="inf128"><mml:mi>s</mml:mi></mml:math></inline-formula>.</p><p>First, we wish to obtain a measure of total probability for a particular antigen scenario, as shown in <xref ref-type="fig" rid="fig5">Figure 5E,F</xref>. We calculate this by computing the matrix product over all mutational steps <inline-formula><mml:math id="inf129"><mml:mi>i</mml:mi></mml:math></inline-formula> for a particular sequence of antigen contexts <inline-formula><mml:math id="inf130"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mtext>ag</mml:mtext><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mtext>paths</mml:mtext></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mtext>steps</mml:mtext></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mtext>step</mml:mtext></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msup><mml:mi>P</mml:mi><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mtext>g</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf131"><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>⋅</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> corresponds to taking the matrix element in the row corresponding to variant <inline-formula><mml:math id="inf132"><mml:mi>s</mml:mi></mml:math></inline-formula> and column corresponding to variant <inline-formula><mml:math id="inf133"><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>. In the right-most term, the products are matrix operations and <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>s</mml:mi><mml:mtext>g</mml:mtext></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf135"><mml:msub><mml:mi>s</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:math></inline-formula> are respectively the indices of the germline and somatic variants.</p><p>We note that the transition probabilities <inline-formula><mml:math id="inf136"><mml:msup><mml:mi>P</mml:mi><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math></inline-formula> are not normalized at each step. In practice, this means that mutations are optional: many outcomes will not reach the somatic sequence and the likelihood encodes the probability of reaching the somatic state. This makes it possible to compare different scenarios, as some scenarios are more likely than others to reach the somatic state. However, because these values do not represent true probabilities — the units are arbitrary — they cannot be compared between antibodies or between selection models. The exception is for the strong scenario, where the total probability for each path is one if all steps are uphill (<inline-formula><mml:math id="inf137"><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and 0 otherwise. Thus, here <inline-formula><mml:math id="inf138"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> has a natural interpretation as the total number of uphill paths. When we present results from the strong model (<xref ref-type="fig" rid="fig5">Figure 5C,D</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, and numbers of uphill paths for H1-only scenarios as discussed in the text), we represent uphill path numbers on a linear scale without log-transforming.</p><p>Although there are many possible antigen exposure scenarios, we restrict our analysis to several classes. First, in single-antigen scenarios, all steps <inline-formula><mml:math id="inf139"><mml:mi>i</mml:mi></mml:math></inline-formula> use the same antigen. Second, for sequential scenarios, antigen exposures must occur in non-repeating segments (for example, H1 - H3 - H1 is not allowed), although we consider all possible lengths and orders of segments.</p><p>Mixed scenarios are more complicated, as we do not fully understand the nature of B cell interactions with multiple antigens in the same germinal center (<xref ref-type="bibr" rid="bib77">Wang et al., 2015</xref>; <xref ref-type="bibr" rid="bib78">Wang, 2017</xref>; <xref ref-type="bibr" rid="bib40">Kuraoka et al., 2016</xref>). One option is to assume that the B cell engages the antigen for which it has the highest affinity and define <inline-formula><mml:math id="inf140"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> by the maximum binding affinity across all possible antigens at each step, but this definition would trivially imply that the mixed scenario has the highest probability. Instead, we choose two alternatives: first, ‘average’ mixed, where we assume the B cell engages all antigens and use the average binding affinity change over all three (for CR9114) or two (for CR6261) antigens, <inline-formula><mml:math id="inf141"><mml:mrow><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mtext>mixed</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mtext>ag</mml:mtext></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mtext>ag</mml:mtext></mml:msub><mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mtext>ag</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>; and second, ‘random’ mixed, where we assume the B cell randomly engages a single antigen and hence the antigen at each mutational step is chosen randomly. For the latter definition, we calculate <inline-formula><mml:math id="inf142"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as described above for 1000 randomly drawn scenarios and average the resulting log probability. When we illustrate mutational paths and mutation orders, we choose a representative scenario (with close to median probability) from the 1000 random draws.</p><p>We estimate the error of these probabilities by bootstrapping. Specifically, for 10 bootstrap iterations, we resample each binding affinity <inline-formula><mml:math id="inf143"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> from a normal distribution according to its value and standard deviation. We then recalculate the total probability <inline-formula><mml:math id="inf144"><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, average over the 10 values to obtain mean and s.e.m. values, and transform by the natural log for plotting, as shown in <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. We note that for the strong selection scenario (where probabilities represent total numbers of uphill paths), values are not log-transformed, and many scenarios have total path numbers of exactly zero. We refrain from studying the ‘average’ mixed scenario for strong selection because it is essentially equivalent to choosing the antigen with maximum improvement: the quantitative effect of averaging is undone when the transition probability is binarized. For CR6261, all mutations at the first mutational step are neutral (with the exception of one mutation that improves affinity for H1 only), and so we allow all mutations with equal probability for the first step in the strong selection model.</p><p>Next, to identify the most likely paths under a given exposure scenario, we reframe this Markov process as a directed weighted graph. Each sequence <inline-formula><mml:math id="inf145"><mml:mi>s</mml:mi></mml:math></inline-formula> is a node, and a directed edge exists toward all sequences <inline-formula><mml:math id="inf146"><mml:mi>t</mml:mi></mml:math></inline-formula> that can be reached by one additional somatic mutation. The edge weight is calculated from the transition probability, <inline-formula><mml:math id="inf147"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf148"><mml:mi>ϵ</mml:mi></mml:math></inline-formula> is an extremely small value to ensure weights are finite. In this graph framework, we can use fast algorithms to obtain the ‘shortest’ paths from the germline to the somatic node (those for which the sum of weights is lowest, that is the total probability is highest). Specifically, we use the <italic>shortest_simple_paths</italic> function from the Python package <italic>networkx</italic> (<xref ref-type="bibr" rid="bib32">Hagberg et al., 2008</xref>) to compute the <inline-formula><mml:math id="inf149"><mml:mi>k</mml:mi></mml:math></inline-formula> shortest paths, as shown in <xref ref-type="fig" rid="fig5">Figure 5G,H</xref>. This method is exact and uses the algorithm described in <xref ref-type="bibr" rid="bib86">Yen, 1971</xref>.</p><p>Next, we wish to obtain the probability that a mutation at site <inline-formula><mml:math id="inf150"><mml:mi>m</mml:mi></mml:math></inline-formula> happened at a specific step <inline-formula><mml:math id="inf151"><mml:mi>j</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5I,J</xref>). As we are focusing on one antigen context, we can normalize the transition matrices and define:<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>t</mml:mi></mml:munder><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>if <inline-formula><mml:math id="inf152"><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mtext>ag</mml:mtext></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and 0 otherwise. We can further restrict the transition matrix at step <inline-formula><mml:math id="inf153"><mml:mi>j</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf154"><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:msup></mml:math></inline-formula>, to have nonzero the mutation that occurs is at a particular residue <inline-formula><mml:math id="inf155"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf156"><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>α</mml:mi><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:math></inline-formula>. The total relative probability for that site at that mutational step under an antigen exposure scenario is then<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">℘</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mtext>ag</mml:mtext><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mtext>ag</mml:mtext><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mtext>ag</mml:mtext><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext>g</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mtext>s</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where, again, products are matrix operations. Because a sequence of <inline-formula><mml:math id="inf157"><mml:mi>L</mml:mi></mml:math></inline-formula> steps starting from the germline can only lead to the somatic state, <inline-formula><mml:math id="inf158"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math></inline-formula> verifies <inline-formula><mml:math id="inf159"><mml:mrow><mml:mpadded width="-6.8pt"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mpadded><mml:mo rspace="0.8pt">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. With the relation <inline-formula><mml:math id="inf160"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msubsup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mi>α</mml:mi><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></inline-formula> this implies that these probabilities are already normalized: <inline-formula><mml:math id="inf161"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>α</mml:mi></mml:msub><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>Finally, we wish to determine the total probability of each variant (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>), that is the sum of probabilities of all paths passing through that variant, for a given selection scenario. For a variant <inline-formula><mml:math id="inf162"><mml:mi>s</mml:mi></mml:math></inline-formula> that contains <inline-formula><mml:math id="inf163"><mml:mi>j</mml:mi></mml:math></inline-formula> somatic mutations, we calculate<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:munderover><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mtext>g</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:msup><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:msub><mml:mtext>ag</mml:mtext><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mtext>s</mml:mtext></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the first term is the probability of reaching sequence <inline-formula><mml:math id="inf164"><mml:mi>s</mml:mi></mml:math></inline-formula> at mutational step <inline-formula><mml:math id="inf165"><mml:mi>j</mml:mi></mml:math></inline-formula>, and the second term is the probability of reaching the somatic sequence after passing through sequence <inline-formula><mml:math id="inf166"><mml:mi>s</mml:mi></mml:math></inline-formula>. When representing this number we add an additional normalisation factor, <inline-formula><mml:math id="inf167"><mml:mrow><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf168"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac linethickness="0pt"><mml:mi>L</mml:mi><mml:mi>j</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the number of sequences with <inline-formula><mml:math id="inf169"><mml:mi>j</mml:mi></mml:math></inline-formula> mutations, so that variants with different numbers of mutations have comparable values. <inline-formula><mml:math id="inf170"><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></inline-formula> thus represents the ratio of the probability in a selective model to the probability in a neutral model (which is <inline-formula><mml:math id="inf171"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, sequences with <inline-formula><mml:math id="inf172"><mml:mrow><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> are favored by the given selection scenario, and those with <inline-formula><mml:math id="inf173"><mml:mrow><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi class="ltx_font_mathcaligraphic">𝒫</mml:mi><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> are disfavored, as shown in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref> for moderate selection under the optimal sequential scenario.</p></sec></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Rhys Adams for helpful discussion of the Tite-Seq experiments, Zach Niziolek for assistance with flow cytometry, Kevin McCarthy for help with antigen production, Matt Melissa for help acquiring strains and protocols, and Tyler Starr and members of the Denic, Gaudet, and Wittrup labs for help with experimental protocols. We also thank Jesse Bloom, Andrew Murray, and Michael Laub for helpful discussion and members of the Desai lab for comments on the manuscript. The computations in this paper were run on the FASRC Cannon cluster supported by the FAS Division of Science Research Computing Group at Harvard University.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Senior editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Software, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Software, Formal analysis, Validation, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Software, Formal analysis, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Formal analysis, Validation, Investigation, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Software, Visualization, Writing - review and editing</p></fn><fn fn-type="con" id="con7"><p>Conceptualization, Investigation, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con8"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn><fn fn-type="con" id="con9"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn><fn fn-type="con" id="con10"><p>Conceptualization, Supervision, Funding acquisition, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Primer sequences for sequencing library preparation.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71393-supp1-v3.xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Fragment sequences for Golden Gate construction of the CR9114 library.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71393-supp2-v3.xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Primer sequences for Golden Gate construction of the CR6261 library.</title></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-71393-supp3-v3.xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Plasmid map of pCT302 with CR9114 germline sequence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp4-v3.dna"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Plasmid map of pCT302 with CR9114 somatic sequence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp5-v3.dna"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Plasmid map of pCT302 with CR6261 germline sequence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp6-v3.dna"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 7.</label><caption><title>Plasmid map of pCT302 with CR6261 somatic sequence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp7-v3.dna"/></supplementary-material><supplementary-material id="supp8"><label>Supplementary file 8.</label><caption><title>Plasmid map of pFastBac with influenza A/New Caldeonia/1999 H1 ectodomain.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp8-v3.seq"/></supplementary-material><supplementary-material id="supp9"><label>Supplementary file 9.</label><caption><title>Plasmid map of pFastBac with influenza A/Hong Kong/1999 H9 ectodomain.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp9-v3.seq"/></supplementary-material><supplementary-material id="supp10"><label>Supplementary file 10.</label><caption><title>Plasmid map of pFastBac with influenza A/Wisconsin/2005 H3 ectodomain.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp10-v3.seq"/></supplementary-material><supplementary-material id="supp11"><label>Supplementary file 11.</label><caption><title>Plasmid map of pFastBac with influenza B/Ohio/2005 HA ectodomain.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp11-v3.seq"/></supplementary-material><supplementary-material id="supp12"><label>Supplementary file 12.</label><caption><title>Inferred CR9114 VH germline nucleotide sequence.</title></caption><media mime-subtype="octet-stream" mimetype="application" xlink:href="elife-71393-supp12-v3.dna"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-71393-transrepform-v3.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Data and code used for this study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/klawrence26/bnab-landscapes">https://github.com/klawrence26/bnab-landscapes</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90">https://archive.softwareheritage.org/swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90</ext-link>). CR9114 data are also available in an interactive data browser at <ext-link ext-link-type="uri" xlink:href="https://yodabrowser.netlify.app/yoda_browser/">https://yodabrowser.netlify.app/yoda_browser/</ext-link>. FASTQ files from high-throughput sequencing have been deposited in the NCBI BioProject database with accession number PRJNA741613.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>AM</given-names></name><name><surname>Lawrence</surname><given-names>KR</given-names></name><name><surname>Moulana</surname><given-names>A</given-names></name><name><surname>Dupic</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>MS</given-names></name><name><surname>Cvijovic</surname><given-names>I</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Binding affinity landscapes constrain the evolution of broadly neutralizing anti-influenza antibodies</data-title><source>NCBI BioProject</source><pub-id assigning-authority="NCBI" pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA741613">PRJNA741613</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Phillips</surname><given-names>AM</given-names></name><name><surname>Lawrence</surname><given-names>KR</given-names></name><name><surname>Moulana</surname><given-names>A</given-names></name><name><surname>Dupic</surname><given-names>T</given-names></name><name><surname>Chang</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>MS</given-names></name><name><surname>Cvijovic</surname><given-names>I</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>CR9114 Tite-Seq KD Measurements</data-title><source>YODA online data browser</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://yodabrowser.netlify.app/yoda_browser/">CR9114</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname> <given-names>RM</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Measuring the sequence-affinity landscape of antibodies with massively parallel titration curves</article-title><source>eLife</source><volume>5</volume><elocation-id>e23156</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23156</pub-id><pub-id pub-id-type="pmid">28035901</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname> <given-names>RM</given-names></name><name><surname>Kinney</surname> <given-names>JB</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Epistasis in a fitness landscape defined by Antibody-Antigen binding free energy</article-title><source>Cell Systems</source><volume>8</volume><fpage>86</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2018.12.004</pub-id><pub-id pub-id-type="pmid">30611676</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amitai</surname> <given-names>A</given-names></name><name><surname>Mesin</surname> <given-names>L</given-names></name><name><surname>Victora</surname> <given-names>GD</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A population dynamics model for clonal diversity in a germinal center</article-title><source>Frontiers in Microbiology</source><volume>8</volume><elocation-id>1693</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2017.01693</pub-id><pub-id pub-id-type="pmid">28955307</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Avnir</surname> <given-names>Y</given-names></name><name><surname>Tallarico</surname> <given-names>AS</given-names></name><name><surname>Zhu</surname> <given-names>Q</given-names></name><name><surname>Bennett</surname> <given-names>AS</given-names></name><name><surname>Connelly</surname> <given-names>G</given-names></name><name><surname>Sheehan</surname> <given-names>J</given-names></name><name><surname>Sui</surname> <given-names>J</given-names></name><name><surname>Fahmy</surname> <given-names>A</given-names></name><name><surname>Huang</surname> <given-names>CY</given-names></name><name><surname>Cadwell</surname> <given-names>G</given-names></name><name><surname>Bankston</surname> <given-names>LA</given-names></name><name><surname>McGuire</surname> <given-names>AT</given-names></name><name><surname>Stamatatos</surname> <given-names>L</given-names></name><name><surname>Wagner</surname> <given-names>G</given-names></name><name><surname>Liddington</surname> <given-names>RC</given-names></name><name><surname>Marasco</surname> <given-names>WA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Molecular signatures of hemagglutinin stem-directed heterosubtypic human neutralizing antibodies against influenza A viruses</article-title><source>PLOS Pathogens</source><volume>10</volume><elocation-id>e1004103</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1004103</pub-id><pub-id pub-id-type="pmid">24788925</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bajic</surname> <given-names>G</given-names></name><name><surname>van der Poel</surname> <given-names>CE</given-names></name><name><surname>Kuraoka</surname> <given-names>M</given-names></name><name><surname>Schmidt</surname> <given-names>AG</given-names></name><name><surname>Carroll</surname> <given-names>MC</given-names></name><name><surname>Kelsoe</surname> <given-names>G</given-names></name><name><surname>Harrison</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Autoreactivity profiles of influenza hemagglutinin broadly neutralizing antibodies</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>3492</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-40175-8</pub-id><pub-id pub-id-type="pmid">30837606</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>EN</given-names></name><name><surname>Hubbard</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Hydrogen bonding in globular proteins</article-title><source>Progress in Biophysics and Molecular Biology</source><volume>44</volume><fpage>97</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1016/0079-6107(84)90007-5</pub-id><pub-id pub-id-type="pmid">6385134</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bank</surname> <given-names>C</given-names></name><name><surname>Hietpas</surname> <given-names>RT</given-names></name><name><surname>Jensen</surname> <given-names>JD</given-names></name><name><surname>Bolon</surname> <given-names>DN</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A systematic survey of an intragenic epistatic landscape</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>229</fpage><lpage>238</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu301</pub-id><pub-id pub-id-type="pmid">25371431</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Barnett</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Regex</source><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/regex/">https://pypi.org/project/regex/</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Batista</surname> <given-names>FD</given-names></name><name><surname>Neuberger</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Affinity dependence of the B cell response to antigen: a threshold, a ceiling, and the importance of off-rate</article-title><source>Immunity</source><volume>8</volume><fpage>751</fpage><lpage>759</lpage><pub-id pub-id-type="doi">10.1016/S1074-7613(00)80580-4</pub-id><pub-id pub-id-type="pmid">9655489</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boder</surname> <given-names>ET</given-names></name><name><surname>Wittrup</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Yeast surface display for screening combinatorial polypeptide libraries</article-title><source>Nature Biotechnology</source><volume>15</volume><fpage>553</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1038/nbt0697-553</pub-id><pub-id pub-id-type="pmid">9181578</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bondi</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1964">1964</year><article-title>van der Waals Volumes and Radii</article-title><source>The Journal of Physical Chemistry</source><volume>68</volume><fpage>441</fpage><lpage>451</lpage><pub-id pub-id-type="doi">10.1021/j100785a001</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Braden</surname> <given-names>BC</given-names></name><name><surname>Goldman</surname> <given-names>ER</given-names></name><name><surname>Mariuzza</surname> <given-names>RA</given-names></name><name><surname>Poljak</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Anatomy of an antibody molecule: structure, kinetics, thermodynamics and mutational studies of the antilysozyme antibody D1.3</article-title><source>Immunological Reviews</source><volume>163</volume><fpage>45</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1111/j.1600-065X.1998.tb01187.x</pub-id><pub-id pub-id-type="pmid">9700501</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burks</surname> <given-names>EA</given-names></name><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Georgiou</surname> <given-names>G</given-names></name><name><surname>Iverson</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>In vitro scanning saturation mutagenesis of an antibody binding pocket</article-title><source>PNAS</source><volume>94</volume><fpage>412</fpage><lpage>417</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.2.412</pub-id><pub-id pub-id-type="pmid">9012796</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname> <given-names>G</given-names></name><name><surname>Dubrawsky</surname> <given-names>I</given-names></name><name><surname>Mendez</surname> <given-names>P</given-names></name><name><surname>Georgiou</surname> <given-names>G</given-names></name><name><surname>Iverson</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>In vitro scanning saturation mutagenesis of all the specificity determining residues in an antibody binding site</article-title><source>Protein Engineering, Design and Selection</source><volume>12</volume><fpage>349</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1093/protein/12.4.349</pub-id><pub-id pub-id-type="pmid">10325406</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corti</surname> <given-names>D</given-names></name><name><surname>Voss</surname> <given-names>J</given-names></name><name><surname>Gamblin</surname> <given-names>SJ</given-names></name><name><surname>Codoni</surname> <given-names>G</given-names></name><name><surname>Macagno</surname> <given-names>A</given-names></name><name><surname>Jarrossay</surname> <given-names>D</given-names></name><name><surname>Vachieri</surname> <given-names>SG</given-names></name><name><surname>Pinna</surname> <given-names>D</given-names></name><name><surname>Minola</surname> <given-names>A</given-names></name><name><surname>Vanzetta</surname> <given-names>F</given-names></name><name><surname>Silacci</surname> <given-names>C</given-names></name><name><surname>Fernandez-Rodriguez</surname> <given-names>BM</given-names></name><name><surname>Agatic</surname> <given-names>G</given-names></name><name><surname>Bianchi</surname> <given-names>S</given-names></name><name><surname>Giacchetto-Sasselli</surname> <given-names>I</given-names></name><name><surname>Calder</surname> <given-names>L</given-names></name><name><surname>Sallusto</surname> <given-names>F</given-names></name><name><surname>Collins</surname> <given-names>P</given-names></name><name><surname>Haire</surname> <given-names>LF</given-names></name><name><surname>Temperton</surname> <given-names>N</given-names></name><name><surname>Langedijk</surname> <given-names>JP</given-names></name><name><surname>Skehel</surname> <given-names>JJ</given-names></name><name><surname>Lanzavecchia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A neutralizing antibody selected from plasma cells that binds to group 1 and group 2 influenza A hemagglutinins</article-title><source>Science</source><volume>333</volume><fpage>850</fpage><lpage>856</lpage><pub-id pub-id-type="doi">10.1126/science.1205669</pub-id><pub-id pub-id-type="pmid">21798894</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corti</surname> <given-names>D</given-names></name><name><surname>Cameroni</surname> <given-names>E</given-names></name><name><surname>Guarino</surname> <given-names>B</given-names></name><name><surname>Kallewaard</surname> <given-names>NL</given-names></name><name><surname>Zhu</surname> <given-names>Q</given-names></name><name><surname>Lanzavecchia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Tackling influenza with broadly neutralizing antibodies</article-title><source>Current Opinion in Virology</source><volume>24</volume><fpage>60</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1016/j.coviro.2017.03.002</pub-id><pub-id pub-id-type="pmid">28527859</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Corti</surname> <given-names>D</given-names></name><name><surname>Lanzavecchia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Broadly neutralizing antiviral antibodies</article-title><source>Annual Review of Immunology</source><volume>31</volume><fpage>705</fpage><lpage>742</lpage><pub-id pub-id-type="doi">10.1146/annurev-immunol-032712-095916</pub-id><pub-id pub-id-type="pmid">23330954</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domingo</surname> <given-names>J</given-names></name><name><surname>Baeza-Centurion</surname> <given-names>P</given-names></name><name><surname>Lehner</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The causes and consequences of genetic interactions (Epistasis)</article-title><source>Annual Review of Genomics and Human Genetics</source><volume>20</volume><fpage>433</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1146/annurev-genom-083118-014857</pub-id><pub-id pub-id-type="pmid">31082279</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doud</surname> <given-names>MB</given-names></name><name><surname>Lee</surname> <given-names>JM</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>How single mutations affect viral escape from broad and narrow antibodies to H1 influenza hemagglutinin</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>1386</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03665-3</pub-id><pub-id pub-id-type="pmid">29643370</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dreyfus</surname> <given-names>C</given-names></name><name><surname>Laursen</surname> <given-names>NS</given-names></name><name><surname>Kwaks</surname> <given-names>T</given-names></name><name><surname>Zuijdgeest</surname> <given-names>D</given-names></name><name><surname>Khayat</surname> <given-names>R</given-names></name><name><surname>Ekiert</surname> <given-names>DC</given-names></name><name><surname>Lee</surname> <given-names>JH</given-names></name><name><surname>Metlagel</surname> <given-names>Z</given-names></name><name><surname>Bujny</surname> <given-names>MV</given-names></name><name><surname>Jongeneelen</surname> <given-names>M</given-names></name><name><surname>van der Vlugt</surname> <given-names>R</given-names></name><name><surname>Lamrani</surname> <given-names>M</given-names></name><name><surname>Korse</surname> <given-names>HJ</given-names></name><name><surname>Geelen</surname> <given-names>E</given-names></name><name><surname>Sahin</surname> <given-names>Ö</given-names></name><name><surname>Sieuwerts</surname> <given-names>M</given-names></name><name><surname>Brakenhoff</surname> <given-names>JP</given-names></name><name><surname>Vogels</surname> <given-names>R</given-names></name><name><surname>Li</surname> <given-names>OT</given-names></name><name><surname>Poon</surname> <given-names>LL</given-names></name><name><surname>Peiris</surname> <given-names>M</given-names></name><name><surname>Koudstaal</surname> <given-names>W</given-names></name><name><surname>Ward</surname> <given-names>AB</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name><name><surname>Goudsmit</surname> <given-names>J</given-names></name><name><surname>Friesen</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Highly conserved protective epitopes on influenza B viruses</article-title><source>Science</source><volume>337</volume><fpage>1343</fpage><lpage>1348</lpage><pub-id pub-id-type="doi">10.1126/science.1222908</pub-id><pub-id pub-id-type="pmid">22878502</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekiert</surname> <given-names>DC</given-names></name><name><surname>Bhabha</surname> <given-names>G</given-names></name><name><surname>Elsliger</surname> <given-names>MA</given-names></name><name><surname>Friesen</surname> <given-names>RH</given-names></name><name><surname>Jongeneelen</surname> <given-names>M</given-names></name><name><surname>Throsby</surname> <given-names>M</given-names></name><name><surname>Goudsmit</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Antibody recognition of a highly conserved influenza virus epitope</article-title><source>Science</source><volume>324</volume><fpage>246</fpage><lpage>251</lpage><pub-id pub-id-type="doi">10.1126/science.1171491</pub-id><pub-id pub-id-type="pmid">19251591</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ekiert</surname> <given-names>DC</given-names></name><name><surname>Friesen</surname> <given-names>RH</given-names></name><name><surname>Bhabha</surname> <given-names>G</given-names></name><name><surname>Kwaks</surname> <given-names>T</given-names></name><name><surname>Jongeneelen</surname> <given-names>M</given-names></name><name><surname>Yu</surname> <given-names>W</given-names></name><name><surname>Ophorst</surname> <given-names>C</given-names></name><name><surname>Cox</surname> <given-names>F</given-names></name><name><surname>Korse</surname> <given-names>HJ</given-names></name><name><surname>Brandenburg</surname> <given-names>B</given-names></name><name><surname>Vogels</surname> <given-names>R</given-names></name><name><surname>Brakenhoff</surname> <given-names>JP</given-names></name><name><surname>Kompier</surname> <given-names>R</given-names></name><name><surname>Koldijk</surname> <given-names>MH</given-names></name><name><surname>Cornelissen</surname> <given-names>LA</given-names></name><name><surname>Poon</surname> <given-names>LL</given-names></name><name><surname>Peiris</surname> <given-names>M</given-names></name><name><surname>Koudstaal</surname> <given-names>W</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name><name><surname>Goudsmit</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A highly conserved neutralizing epitope on group 2 influenza A viruses</article-title><source>Science</source><volume>333</volume><fpage>843</fpage><lpage>850</lpage><pub-id pub-id-type="doi">10.1126/science.1204839</pub-id><pub-id pub-id-type="pmid">21737702</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engler</surname> <given-names>C</given-names></name><name><surname>Kandzia</surname> <given-names>R</given-names></name><name><surname>Marillonnet</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A one pot, one step, precision cloning method with high throughput capability</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e3647</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0003647</pub-id><pub-id pub-id-type="pmid">18985154</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Esmaielbeiki</surname> <given-names>R</given-names></name><name><surname>Krawczyk</surname> <given-names>K</given-names></name><name><surname>Knapp</surname> <given-names>B</given-names></name><name><surname>Nebel</surname> <given-names>JC</given-names></name><name><surname>Deane</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Progress and challenges in predicting protein interfaces</article-title><source>Briefings in Bioinformatics</source><volume>17</volume><fpage>117</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1093/bib/bbv027</pub-id><pub-id pub-id-type="pmid">25971595</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fairhead</surname> <given-names>M</given-names></name><name><surname>Howarth</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><chapter-title>Site-specific biotinylation of purified proteins using BirA</chapter-title><person-group person-group-type="editor"><name><surname>Howarth</surname> <given-names>M</given-names></name></person-group><source>Site-Specific Protein Labeling</source><publisher-loc>Germany</publisher-loc><publisher-name>Springer</publisher-name><fpage>171</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1007/978-1-4939-2272-7</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forsyth</surname> <given-names>CM</given-names></name><name><surname>Juan</surname> <given-names>V</given-names></name><name><surname>Akamatsu</surname> <given-names>Y</given-names></name><name><surname>DuBridge</surname> <given-names>RB</given-names></name><name><surname>Doan</surname> <given-names>M</given-names></name><name><surname>Ivanov</surname> <given-names>AV</given-names></name><name><surname>Ma</surname> <given-names>Z</given-names></name><name><surname>Polakoff</surname> <given-names>D</given-names></name><name><surname>Razo</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>K</given-names></name><name><surname>Powers</surname> <given-names>DB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Deep mutational scanning of an antibody against epidermal growth factor receptor using mammalian cell display and massively parallel pyrosequencing</article-title><source>mAbs</source><volume>5</volume><fpage>523</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.4161/mabs.24979</pub-id><pub-id pub-id-type="pmid">23765106</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname> <given-names>DG</given-names></name><name><surname>Young</surname> <given-names>L</given-names></name><name><surname>Chuang</surname> <given-names>RY</given-names></name><name><surname>Venter</surname> <given-names>JC</given-names></name><name><surname>Hutchison</surname> <given-names>CA</given-names></name><name><surname>Smith</surname> <given-names>HO</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Enzymatic assembly of DNA molecules up to several hundred kilobases</article-title><source>Nature Methods</source><volume>6</volume><fpage>343</fpage><lpage>345</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1318</pub-id><pub-id pub-id-type="pmid">19363495</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gietz</surname> <given-names>RD</given-names></name><name><surname>Schiestl</surname> <given-names>RH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>High-efficiency yeast transformation using the LiAc/SS carrier DNA/PEG method</article-title><source>Nature Protocols</source><volume>2</volume><fpage>31</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1038/nprot.2007.13</pub-id><pub-id pub-id-type="pmid">17401334</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giudicelli</surname> <given-names>V</given-names></name><name><surname>Duroux</surname> <given-names>P</given-names></name><name><surname>Ginestoux</surname> <given-names>C</given-names></name><name><surname>Folch</surname> <given-names>G</given-names></name><name><surname>Jabado-Michaloud</surname> <given-names>J</given-names></name><name><surname>Chaume</surname> <given-names>D</given-names></name><name><surname>Lefranc</surname> <given-names>MP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>IMGT/LIGM-DB, the IMGT comprehensive database of immunoglobulin and T cell receptor nucleotide sequences</article-title><source>Nucleic Acids Research</source><volume>34</volume><fpage>D781</fpage><lpage>D784</lpage><pub-id pub-id-type="doi">10.1093/nar/gkj088</pub-id><pub-id pub-id-type="pmid">16381979</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname> <given-names>LI</given-names></name><name><surname>Suchard</surname> <given-names>MA</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title><source>eLife</source><volume>2</volume><elocation-id>e00631</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id><pub-id pub-id-type="pmid">23682315</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guthmiller</surname> <given-names>JJ</given-names></name><name><surname>Lan</surname> <given-names>LY</given-names></name><name><surname>Fernández-Quintero</surname> <given-names>ML</given-names></name><name><surname>Han</surname> <given-names>J</given-names></name><name><surname>Utset</surname> <given-names>HA</given-names></name><name><surname>Bitar</surname> <given-names>DJ</given-names></name><name><surname>Hamel</surname> <given-names>NJ</given-names></name><name><surname>Stovicek</surname> <given-names>O</given-names></name><name><surname>Li</surname> <given-names>L</given-names></name><name><surname>Tepora</surname> <given-names>M</given-names></name><name><surname>Henry</surname> <given-names>C</given-names></name><name><surname>Neu</surname> <given-names>KE</given-names></name><name><surname>Dugan</surname> <given-names>HL</given-names></name><name><surname>Borowska</surname> <given-names>MT</given-names></name><name><surname>Chen</surname> <given-names>YQ</given-names></name><name><surname>Liu</surname> <given-names>STH</given-names></name><name><surname>Stamper</surname> <given-names>CT</given-names></name><name><surname>Zheng</surname> <given-names>NY</given-names></name><name><surname>Huang</surname> <given-names>M</given-names></name><name><surname>Palm</surname> <given-names>AE</given-names></name><name><surname>García-Sastre</surname> <given-names>A</given-names></name><name><surname>Nachbagauer</surname> <given-names>R</given-names></name><name><surname>Palese</surname> <given-names>P</given-names></name><name><surname>Coughlan</surname> <given-names>L</given-names></name><name><surname>Krammer</surname> <given-names>F</given-names></name><name><surname>Ward</surname> <given-names>AB</given-names></name><name><surname>Liedl</surname> <given-names>KR</given-names></name><name><surname>Wilson</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Polyreactive broadly neutralizing B cells are selected to provide defense against pandemic threat influenza viruses</article-title><source>Immunity</source><volume>53</volume><fpage>1230</fpage><lpage>1244</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2020.10.005</pub-id><pub-id pub-id-type="pmid">33096040</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hagberg</surname> <given-names>AA</given-names></name><name><surname>Schult</surname> <given-names>DA</given-names></name><name><surname>Swart</surname> <given-names>PJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Exploring network structure, dynamics, and function using NetworkX</article-title><conf-name>Proceedings of the 7th Python in Science Conference</conf-name><fpage>11</fpage><lpage>15</lpage><ext-link ext-link-type="uri" xlink:href="https://www.osti.gov/biblio/960616-exploring-network-structure-dynamics-function-using-networkx">https://www.osti.gov/biblio/960616-exploring-network-structure-dynamics-function-using-networkx</ext-link></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Henry</surname> <given-names>C</given-names></name><name><surname>Palm</surname> <given-names>AE</given-names></name><name><surname>Krammer</surname> <given-names>F</given-names></name><name><surname>Wilson</surname> <given-names>PC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>From original antigenic sin to the universal influenza virus vaccine</article-title><source>Trends in Immunology</source><volume>39</volume><fpage>70</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1016/j.it.2017.08.003</pub-id><pub-id pub-id-type="pmid">28867526</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howarth</surname> <given-names>M</given-names></name><name><surname>Takao</surname> <given-names>K</given-names></name><name><surname>Hayashi</surname> <given-names>Y</given-names></name><name><surname>Ting</surname> <given-names>AY</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Targeting quantum dots to surface proteins in living cells with biotin ligase</article-title><source>PNAS</source><volume>102</volume><fpage>7583</fpage><lpage>7588</lpage><pub-id pub-id-type="doi">10.1073/pnas.0503125102</pub-id><pub-id pub-id-type="pmid">15897449</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Israelachvili</surname> <given-names>J</given-names></name><name><surname>Pashley</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>The hydrophobic interaction is long range, decaying exponentially with distance</article-title><source>Nature</source><volume>300</volume><fpage>341</fpage><lpage>342</lpage><pub-id pub-id-type="doi">10.1038/300341a0</pub-id><pub-id pub-id-type="pmid">7144887</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>On the probability of fixation of mutant genes in a population</article-title><source>Genetics</source><volume>47</volume><fpage>713</fpage><lpage>719</lpage><pub-id pub-id-type="doi">10.1093/genetics/47.6.713</pub-id><pub-id pub-id-type="pmid">14456043</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname> <given-names>F</given-names></name><name><surname>Diskin</surname> <given-names>R</given-names></name><name><surname>Scheid</surname> <given-names>JF</given-names></name><name><surname>Gaebler</surname> <given-names>C</given-names></name><name><surname>Mouquet</surname> <given-names>H</given-names></name><name><surname>Georgiev</surname> <given-names>IS</given-names></name><name><surname>Pancera</surname> <given-names>M</given-names></name><name><surname>Zhou</surname> <given-names>T</given-names></name><name><surname>Incesu</surname> <given-names>RB</given-names></name><name><surname>Fu</surname> <given-names>BZ</given-names></name><name><surname>Gnanapragasam</surname> <given-names>PN</given-names></name><name><surname>Oliveira</surname> <given-names>TY</given-names></name><name><surname>Seaman</surname> <given-names>MS</given-names></name><name><surname>Kwong</surname> <given-names>PD</given-names></name><name><surname>Bjorkman</surname> <given-names>PJ</given-names></name><name><surname>Nussenzweig</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Somatic mutations of the immunoglobulin framework are generally required for broad and potent HIV-1 neutralization</article-title><source>Cell</source><volume>153</volume><fpage>126</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2013.03.018</pub-id><pub-id pub-id-type="pmid">23540694</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koenig</surname> <given-names>P</given-names></name><name><surname>Lee</surname> <given-names>CV</given-names></name><name><surname>Walters</surname> <given-names>BT</given-names></name><name><surname>Janakiraman</surname> <given-names>V</given-names></name><name><surname>Stinson</surname> <given-names>J</given-names></name><name><surname>Patapoff</surname> <given-names>TW</given-names></name><name><surname>Fuh</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Mutational landscape of antibody variable domains reveals a switch modulating the interdomain conformational dynamics and antigen binding</article-title><source>PNAS</source><volume>114</volume><fpage>E486</fpage><lpage>E495</lpage><pub-id pub-id-type="doi">10.1073/pnas.1613231114</pub-id><pub-id pub-id-type="pmid">28057863</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krammer</surname> <given-names>F</given-names></name><name><surname>Pica</surname> <given-names>N</given-names></name><name><surname>Hai</surname> <given-names>R</given-names></name><name><surname>Tan</surname> <given-names>GS</given-names></name><name><surname>Palese</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hemagglutinin Stalk-Reactive antibodies are boosted following sequential infection with seasonal and pandemic H1N1 influenza virus in mice</article-title><source>Journal of Virology</source><volume>86</volume><fpage>10302</fpage><lpage>10307</lpage><pub-id pub-id-type="doi">10.1128/JVI.01336-12</pub-id><pub-id pub-id-type="pmid">22787225</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuraoka</surname> <given-names>M</given-names></name><name><surname>Schmidt</surname> <given-names>AG</given-names></name><name><surname>Nojima</surname> <given-names>T</given-names></name><name><surname>Feng</surname> <given-names>F</given-names></name><name><surname>Watanabe</surname> <given-names>A</given-names></name><name><surname>Kitamura</surname> <given-names>D</given-names></name><name><surname>Harrison</surname> <given-names>SC</given-names></name><name><surname>Kepler</surname> <given-names>TB</given-names></name><name><surname>Kelsoe</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Complex antigens drive permissive clonal selection in germinal centers</article-title><source>Immunity</source><volume>44</volume><fpage>542</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2016.02.010</pub-id><pub-id pub-id-type="pmid">26948373</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lingwood</surname> <given-names>D</given-names></name><name><surname>McTamney</surname> <given-names>PM</given-names></name><name><surname>Yassine</surname> <given-names>HM</given-names></name><name><surname>Whittle</surname> <given-names>JR</given-names></name><name><surname>Guo</surname> <given-names>X</given-names></name><name><surname>Boyington</surname> <given-names>JC</given-names></name><name><surname>Wei</surname> <given-names>CJ</given-names></name><name><surname>Nabel</surname> <given-names>GJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Structural and genetic basis for development of broadly neutralizing influenza antibodies</article-title><source>Nature</source><volume>489</volume><fpage>566</fpage><lpage>570</lpage><pub-id pub-id-type="doi">10.1038/nature11371</pub-id><pub-id pub-id-type="pmid">22932267</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madan</surname> <given-names>B</given-names></name><name><surname>Zhang</surname> <given-names>B</given-names></name><name><surname>Xu</surname> <given-names>K</given-names></name><name><surname>Chao</surname> <given-names>CW</given-names></name><name><surname>O'Dell</surname> <given-names>S</given-names></name><name><surname>Wolfe</surname> <given-names>JR</given-names></name><name><surname>Chuang</surname> <given-names>GY</given-names></name><name><surname>Fahad</surname> <given-names>AS</given-names></name><name><surname>Geng</surname> <given-names>H</given-names></name><name><surname>Kong</surname> <given-names>R</given-names></name><name><surname>Louder</surname> <given-names>MK</given-names></name><name><surname>Nguyen</surname> <given-names>TD</given-names></name><name><surname>Rawi</surname> <given-names>R</given-names></name><name><surname>Schön</surname> <given-names>A</given-names></name><name><surname>Sheng</surname> <given-names>Z</given-names></name><name><surname>Nimrania</surname> <given-names>R</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Zhou</surname> <given-names>T</given-names></name><name><surname>Lin</surname> <given-names>BC</given-names></name><name><surname>Doria-Rose</surname> <given-names>NA</given-names></name><name><surname>Shapiro</surname> <given-names>L</given-names></name><name><surname>Kwong</surname> <given-names>PD</given-names></name><name><surname>DeKosky</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mutational fitness landscapes reveal genetic and structural improvement pathways for a vaccine-elicited HIV-1 broadly neutralizing antibody</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2011653118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2011653118</pub-id><pub-id pub-id-type="pmid">33649208</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Margine</surname> <given-names>I</given-names></name><name><surname>Palese</surname> <given-names>P</given-names></name><name><surname>Krammer</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Expression of functional recombinant hemagglutinin and neuraminidase proteins from the novel H7N9 influenza virus using the baculovirus expression system</article-title><source>Journal of Visualized Experiments</source><volume>81</volume><elocation-id>e51112</elocation-id><pub-id pub-id-type="doi">10.3791/51112</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCandlish</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Visualizing fitness landscapes</article-title><source>Evolution</source><volume>65</volume><fpage>1544</fpage><lpage>1558</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2011.01236.x</pub-id><pub-id pub-id-type="pmid">21644947</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mesin</surname> <given-names>L</given-names></name><name><surname>Ersching</surname> <given-names>J</given-names></name><name><surname>Victora</surname> <given-names>GD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Germinal Center B Cell Dynamics</article-title><source>Immunity</source><volume>45</volume><fpage>471</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2016.09.001</pub-id><pub-id pub-id-type="pmid">27653600</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Midelfort</surname> <given-names>KS</given-names></name><name><surname>Hernandez</surname> <given-names>HH</given-names></name><name><surname>Lippow</surname> <given-names>SM</given-names></name><name><surname>Tidor</surname> <given-names>B</given-names></name><name><surname>Drennan</surname> <given-names>CL</given-names></name><name><surname>Wittrup</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Substantial energetic improvement with minimal structural perturbation in a high affinity mutant antibody</article-title><source>Journal of Molecular Biology</source><volume>343</volume><fpage>685</fpage><lpage>701</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2004.08.019</pub-id><pub-id pub-id-type="pmid">15465055</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miton</surname> <given-names>CM</given-names></name><name><surname>Tokuriki</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>How mutational epistasis impairs predictability in protein evolution and design</article-title><source>Protein Science</source><volume>25</volume><fpage>1260</fpage><lpage>1272</lpage><pub-id pub-id-type="doi">10.1002/pro.2876</pub-id><pub-id pub-id-type="pmid">26757214</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molari</surname> <given-names>M</given-names></name><name><surname>Eyer</surname> <given-names>K</given-names></name><name><surname>Baudry</surname> <given-names>J</given-names></name><name><surname>Cocco</surname> <given-names>S</given-names></name><name><surname>Monasson</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Quantitative modeling of the effect of antigen dosage on B-cell affinity distributions in maturating germinal centers</article-title><source>eLife</source><volume>9</volume><elocation-id>e55678</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.55678</pub-id><pub-id pub-id-type="pmid">32538783</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen Ba</surname> <given-names>AN</given-names></name><name><surname>Cvijović</surname> <given-names>I</given-names></name><name><surname>Rojas Echenique</surname> <given-names>JI</given-names></name><name><surname>Lawrence</surname> <given-names>KR</given-names></name><name><surname>Rego-Costa</surname> <given-names>A</given-names></name><name><surname>Liu</surname> <given-names>X</given-names></name><name><surname>Levy</surname> <given-names>SF</given-names></name><name><surname>Desai</surname> <given-names>MM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>High-resolution lineage tracking reveals travelling wave of adaptation in laboratory yeast</article-title><source>Nature</source><volume>575</volume><fpage>494</fpage><lpage>499</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1749-3</pub-id><pub-id pub-id-type="pmid">31723263</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname> <given-names>CA</given-names></name><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Sun</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A comprehensive biophysical description of pairwise epistasis throughout an entire protein domain</article-title><source>Current Biology</source><volume>24</volume><fpage>2643</fpage><lpage>2651</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.09.072</pub-id><pub-id pub-id-type="pmid">25455030</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ortlund</surname> <given-names>EA</given-names></name><name><surname>Bridgham</surname> <given-names>JT</given-names></name><name><surname>Redinbo</surname> <given-names>MR</given-names></name><name><surname>Thornton</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Crystal structure of an ancient protein: evolution by conformational epistasis</article-title><source>Science</source><volume>317</volume><fpage>1544</fpage><lpage>1548</lpage><pub-id pub-id-type="doi">10.1126/science.1142819</pub-id><pub-id pub-id-type="pmid">17702911</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otwinowski</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Biophysical Inference of Epistasis and the Effects of Mutations on Protein Stability and Function</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2345</fpage><lpage>2354</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy141</pub-id><pub-id pub-id-type="pmid">30085303</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otwinowski</surname> <given-names>J</given-names></name><name><surname>McCandlish</surname> <given-names>DM</given-names></name><name><surname>Plotkin</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inferring the shape of global epistasis</article-title><source>PNAS</source><volume>115</volume><fpage>E7550</fpage><lpage>E7558</lpage><pub-id pub-id-type="doi">10.1073/pnas.1804015115</pub-id><pub-id pub-id-type="pmid">30037990</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pappas</surname> <given-names>L</given-names></name><name><surname>Foglierini</surname> <given-names>M</given-names></name><name><surname>Piccoli</surname> <given-names>L</given-names></name><name><surname>Kallewaard</surname> <given-names>NL</given-names></name><name><surname>Turrini</surname> <given-names>F</given-names></name><name><surname>Silacci</surname> <given-names>C</given-names></name><name><surname>Fernandez-Rodriguez</surname> <given-names>B</given-names></name><name><surname>Agatic</surname> <given-names>G</given-names></name><name><surname>Giacchetto-Sasselli</surname> <given-names>I</given-names></name><name><surname>Pellicciotta</surname> <given-names>G</given-names></name><name><surname>Sallusto</surname> <given-names>F</given-names></name><name><surname>Zhu</surname> <given-names>Q</given-names></name><name><surname>Vicenzi</surname> <given-names>E</given-names></name><name><surname>Corti</surname> <given-names>D</given-names></name><name><surname>Lanzavecchia</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Rapid development of broadly influenza neutralizing antibodies through redundant mutations</article-title><source>Nature</source><volume>516</volume><fpage>418</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1038/nature13764</pub-id><pub-id pub-id-type="pmid">25296253</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peterman</surname> <given-names>N</given-names></name><name><surname>Levine</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Sort-seq under the hood: implications of design choices on large-scale characterization of sequence-function relations</article-title><source>BMC Genomics</source><volume>17</volume><elocation-id>206</elocation-id><pub-id pub-id-type="doi">10.1186/s12864-016-2533-5</pub-id><pub-id pub-id-type="pmid">26956374</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettersen</surname> <given-names>EF</given-names></name><name><surname>Goddard</surname> <given-names>TD</given-names></name><name><surname>Huang</surname> <given-names>CC</given-names></name><name><surname>Meng</surname> <given-names>EC</given-names></name><name><surname>Couch</surname> <given-names>GS</given-names></name><name><surname>Croll</surname> <given-names>TI</given-names></name><name><surname>Morris</surname> <given-names>JH</given-names></name><name><surname>Ferrin</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>UCSF ChimeraX: Structure visualization for researchers, educators, and developers</article-title><source>Protein Science</source><volume>30</volume><fpage>70</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1002/pro.3943</pub-id><pub-id pub-id-type="pmid">32881101</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Phillips</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>bnab-landscapes</data-title><source>Software Heritage</source><version designator="swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90 https://archive.softwareheritage.org/swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90">swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90 https://archive.softwareheritage.org/swh:1:rev:61c1673a101ea739d5b7e9b282f6bcfad41d7e90</version></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Podgornaia</surname> <given-names>AI</given-names></name><name><surname>Laub</surname> <given-names>MT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Protein evolution Pervasive degeneracy and epistasis in a protein-protein interface</article-title><source>Science</source><volume>347</volume><fpage>673</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1126/science.1257360</pub-id><pub-id pub-id-type="pmid">25657251</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Krishna</surname> <given-names>V</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The Context-Dependence of mutations: a linkage of formalisms</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004771</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004771</pub-id><pub-id pub-id-type="pmid">27337695</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Socolich</surname> <given-names>M</given-names></name><name><surname>Ranganathan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning the pattern of epistasis linking genotype and phenotype in a protein</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4213</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12130-8</pub-id><pub-id pub-id-type="pmid">31527666</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rotem</surname> <given-names>A</given-names></name><name><surname>Serohijos</surname> <given-names>AWR</given-names></name><name><surname>Chang</surname> <given-names>CB</given-names></name><name><surname>Wolfe</surname> <given-names>JT</given-names></name><name><surname>Fischer</surname> <given-names>AE</given-names></name><name><surname>Mehoke</surname> <given-names>TS</given-names></name><name><surname>Zhang</surname> <given-names>H</given-names></name><name><surname>Tao</surname> <given-names>Y</given-names></name><name><surname>Lloyd Ung</surname> <given-names>W</given-names></name><name><surname>Choi</surname> <given-names>JM</given-names></name><name><surname>Rodrigues</surname> <given-names>JV</given-names></name><name><surname>Kolawole</surname> <given-names>AO</given-names></name><name><surname>Koehler</surname> <given-names>SA</given-names></name><name><surname>Wu</surname> <given-names>S</given-names></name><name><surname>Thielen</surname> <given-names>PM</given-names></name><name><surname>Cui</surname> <given-names>N</given-names></name><name><surname>Demirev</surname> <given-names>PA</given-names></name><name><surname>Giacobbi</surname> <given-names>NS</given-names></name><name><surname>Julian</surname> <given-names>TR</given-names></name><name><surname>Schwab</surname> <given-names>K</given-names></name><name><surname>Lin</surname> <given-names>JS</given-names></name><name><surname>Smith</surname> <given-names>TJ</given-names></name><name><surname>Pipas</surname> <given-names>JM</given-names></name><name><surname>Wobus</surname> <given-names>CE</given-names></name><name><surname>Feldman</surname> <given-names>AB</given-names></name><name><surname>Weitz</surname> <given-names>DA</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Evolution on the biophysical fitness landscape of an RNA virus</article-title><source>Molecular Biology and Evolution</source><volume>35</volume><fpage>2390</fpage><lpage>2400</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy131</pub-id><pub-id pub-id-type="pmid">29955873</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sachdeva</surname> <given-names>V</given-names></name><name><surname>Husain</surname> <given-names>K</given-names></name><name><surname>Sheng</surname> <given-names>J</given-names></name><name><surname>Wang</surname> <given-names>S</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Tuning environmental timescales to evolve and maintain generalists</article-title><source>PNAS</source><volume>117</volume><fpage>12693</fpage><lpage>12699</lpage><pub-id pub-id-type="doi">10.1073/pnas.1914586117</pub-id><pub-id pub-id-type="pmid">32457160</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sailer</surname> <given-names>ZR</given-names></name><name><surname>Harms</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Detecting High-Order epistasis in nonlinear Genotype-Phenotype maps</article-title><source>Genetics</source><volume>205</volume><fpage>1079</fpage><lpage>1088</lpage><pub-id pub-id-type="doi">10.1534/genetics.116.195214</pub-id><pub-id pub-id-type="pmid">28100592</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sailer</surname> <given-names>ZR</given-names></name><name><surname>Harms</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>High-order epistasis shapes evolutionary trajectories</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005541</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005541</pub-id><pub-id pub-id-type="pmid">28505183</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sarkisyan</surname> <given-names>KS</given-names></name><name><surname>Bolotin</surname> <given-names>DA</given-names></name><name><surname>Meer</surname> <given-names>MV</given-names></name><name><surname>Usmanova</surname> <given-names>DR</given-names></name><name><surname>Mishin</surname> <given-names>AS</given-names></name><name><surname>Sharonov</surname> <given-names>GV</given-names></name><name><surname>Ivankov</surname> <given-names>DN</given-names></name><name><surname>Bozhanova</surname> <given-names>NG</given-names></name><name><surname>Baranov</surname> <given-names>MS</given-names></name><name><surname>Soylemez</surname> <given-names>O</given-names></name><name><surname>Bogatyreva</surname> <given-names>NS</given-names></name><name><surname>Vlasov</surname> <given-names>PK</given-names></name><name><surname>Egorov</surname> <given-names>ES</given-names></name><name><surname>Logacheva</surname> <given-names>MD</given-names></name><name><surname>Kondrashov</surname> <given-names>AS</given-names></name><name><surname>Chudakov</surname> <given-names>DM</given-names></name><name><surname>Putintseva</surname> <given-names>EV</given-names></name><name><surname>Mamedov</surname> <given-names>IZ</given-names></name><name><surname>Tawfik</surname> <given-names>DS</given-names></name><name><surname>Lukyanov</surname> <given-names>KA</given-names></name><name><surname>Kondrashov</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Local fitness landscape of the green fluorescent protein</article-title><source>Nature</source><volume>533</volume><fpage>397</fpage><lpage>401</lpage><pub-id pub-id-type="doi">10.1038/nature17995</pub-id><pub-id pub-id-type="pmid">27193686</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname> <given-names>AG</given-names></name><name><surname>Do</surname> <given-names>KT</given-names></name><name><surname>McCarthy</surname> <given-names>KR</given-names></name><name><surname>Kepler</surname> <given-names>TB</given-names></name><name><surname>Liao</surname> <given-names>HX</given-names></name><name><surname>Moody</surname> <given-names>MA</given-names></name><name><surname>Haynes</surname> <given-names>BF</given-names></name><name><surname>Harrison</surname> <given-names>SC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Immunogenic stimulus for germline precursors of antibodies that engage the influenza hemagglutinin Receptor-Binding site</article-title><source>Cell Reports</source><volume>13</volume><fpage>2842</fpage><lpage>2850</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2015.11.063</pub-id><pub-id pub-id-type="pmid">26711348</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Schrodinger, LLC</collab></person-group><year iso-8601-date="2015">2015</year><source>The PyMOL Molecular Graphics System</source><version designator="1.8">1.8</version></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>DJ</given-names></name><name><surname>Lapedes</surname> <given-names>AS</given-names></name><name><surname>de Jong</surname> <given-names>JC</given-names></name><name><surname>Bestebroer</surname> <given-names>TM</given-names></name><name><surname>Rimmelzwaan</surname> <given-names>GF</given-names></name><name><surname>Osterhaus</surname> <given-names>AD</given-names></name><name><surname>Fouchier</surname> <given-names>RA</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mapping the antigenic and genetic evolution of influenza virus</article-title><source>Science</source><volume>305</volume><fpage>371</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1126/science.1097211</pub-id><pub-id pub-id-type="pmid">15218094</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spisak</surname> <given-names>N</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Learning the heterogeneous hypermutation landscape of immunoglobulins from high-throughput repertoire data</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>10702</fpage><lpage>10712</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa825</pub-id><pub-id pub-id-type="pmid">33035336</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sprenger</surname> <given-names>KG</given-names></name><name><surname>Louveau</surname> <given-names>JE</given-names></name><name><surname>Murugan</surname> <given-names>PM</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Optimizing immunization protocols to elicit broadly neutralizing antibodies</article-title><source>PNAS</source><volume>117</volume><fpage>20077</fpage><lpage>20087</lpage><pub-id pub-id-type="doi">10.1073/pnas.1919329117</pub-id><pub-id pub-id-type="pmid">32747563</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starr</surname> <given-names>TN</given-names></name><name><surname>Picton</surname> <given-names>LK</given-names></name><name><surname>Thornton</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Alternative evolutionary histories in the sequence space of an ancient protein</article-title><source>Nature</source><volume>549</volume><fpage>409</fpage><lpage>413</lpage><pub-id pub-id-type="doi">10.1038/nature23902</pub-id><pub-id pub-id-type="pmid">28902834</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Starr</surname> <given-names>TN</given-names></name><name><surname>Greaney</surname> <given-names>AJ</given-names></name><name><surname>Addetia</surname> <given-names>A</given-names></name><name><surname>Hannon</surname> <given-names>WW</given-names></name><name><surname>Choudhary</surname> <given-names>MC</given-names></name><name><surname>Dingens</surname> <given-names>AS</given-names></name><name><surname>Li</surname> <given-names>JZ</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Prospective mapping of viral mutations that escape antibodies used to treat COVID-19</article-title><source>Science</source><volume>371</volume><fpage>850</fpage><lpage>854</lpage><pub-id pub-id-type="doi">10.1126/science.abf9302</pub-id><pub-id pub-id-type="pmid">33495308</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Throsby</surname> <given-names>M</given-names></name><name><surname>van den Brink</surname> <given-names>E</given-names></name><name><surname>Jongeneelen</surname> <given-names>M</given-names></name><name><surname>Poon</surname> <given-names>LL</given-names></name><name><surname>Alard</surname> <given-names>P</given-names></name><name><surname>Cornelissen</surname> <given-names>L</given-names></name><name><surname>Bakker</surname> <given-names>A</given-names></name><name><surname>Cox</surname> <given-names>F</given-names></name><name><surname>van Deventer</surname> <given-names>E</given-names></name><name><surname>Guan</surname> <given-names>Y</given-names></name><name><surname>Cinatl</surname> <given-names>J</given-names></name><name><surname>ter Meulen</surname> <given-names>J</given-names></name><name><surname>Lasters</surname> <given-names>I</given-names></name><name><surname>Carsetti</surname> <given-names>R</given-names></name><name><surname>Peiris</surname> <given-names>M</given-names></name><name><surname>de Kruif</surname> <given-names>J</given-names></name><name><surname>Goudsmit</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Heterosubtypic neutralizing monoclonal antibodies cross-protective against H5N1 and H1N1 recovered from human IgM+ memory B cells</article-title><source>PLOS ONE</source><volume>3</volume><elocation-id>e3942</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0003942</pub-id><pub-id pub-id-type="pmid">19079604</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Unniraman</surname> <given-names>S</given-names></name><name><surname>Schatz</surname> <given-names>DG</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Strand-biased spreading of mutations during somatic hypermutation</article-title><source>Science</source><volume>317</volume><fpage>1227</fpage><lpage>1230</lpage><pub-id pub-id-type="doi">10.1126/science.1145065</pub-id><pub-id pub-id-type="pmid">17761884</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Victora</surname> <given-names>GD</given-names></name><name><surname>Nussenzweig</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Germinal centers</article-title><source>Annual Review of Immunology</source><volume>30</volume><fpage>429</fpage><lpage>457</lpage><pub-id pub-id-type="doi">10.1146/annurev-immunol-020711-075032</pub-id><pub-id pub-id-type="pmid">22224772</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>TT</given-names></name><name><surname>Tan</surname> <given-names>GS</given-names></name><name><surname>Hai</surname> <given-names>R</given-names></name><name><surname>Pica</surname> <given-names>N</given-names></name><name><surname>Petersen</surname> <given-names>E</given-names></name><name><surname>Moran</surname> <given-names>TM</given-names></name><name><surname>Palese</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Broadly protective monoclonal antibodies against H3 influenza viruses following sequential immunization with different hemagglutinins</article-title><source>PLOS Pathogens</source><volume>6</volume><elocation-id>e1000796</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1000796</pub-id><pub-id pub-id-type="pmid">20195520</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>S</given-names></name><name><surname>Mata-Fink</surname> <given-names>J</given-names></name><name><surname>Kriegsman</surname> <given-names>B</given-names></name><name><surname>Hanson</surname> <given-names>M</given-names></name><name><surname>Irvine</surname> <given-names>DJ</given-names></name><name><surname>Eisen</surname> <given-names>HN</given-names></name><name><surname>Burton</surname> <given-names>DR</given-names></name><name><surname>Wittrup</surname> <given-names>KD</given-names></name><name><surname>Kardar</surname> <given-names>M</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Manipulating the selection forces during affinity maturation to generate cross-reactive HIV antibodies</article-title><source>Cell</source><volume>160</volume><fpage>785</fpage><lpage>797</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.01.027</pub-id><pub-id pub-id-type="pmid">25662010</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Optimal sequential immunization can focus antibody responses against diversity loss and distraction</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005336</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005336</pub-id><pub-id pub-id-type="pmid">28135270</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Delaney</surname> <given-names>NF</given-names></name><name><surname>Depristo</surname> <given-names>MA</given-names></name><name><surname>Hartl</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1126/science.1123539</pub-id><pub-id pub-id-type="pmid">16601193</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wells</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Additivity of mutational effects in proteins</article-title><source>Biochemistry</source><volume>29</volume><fpage>8509</fpage><lpage>8517</lpage><pub-id pub-id-type="doi">10.1021/bi00489a001</pub-id><pub-id pub-id-type="pmid">2271534</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiley</surname> <given-names>DC</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name><name><surname>Skehel</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Structural identification of the antibody-binding sites of Hong Kong influenza haemagglutinin and their involvement in antigenic variation</article-title><source>Nature</source><volume>289</volume><fpage>373</fpage><lpage>378</lpage><pub-id pub-id-type="doi">10.1038/289373a0</pub-id><pub-id pub-id-type="pmid">6162101</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Grande</surname> <given-names>G</given-names></name><name><surname>Turner</surname> <given-names>HL</given-names></name><name><surname>Ward</surname> <given-names>AB</given-names></name><name><surname>Xie</surname> <given-names>J</given-names></name><name><surname>Lerner</surname> <given-names>RA</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>In vitro evolution of an influenza broadly neutralizing antibody is modulated by hemagglutinin receptor specificity</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15371</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15371</pub-id><pub-id pub-id-type="pmid">28504265</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Thompson</surname> <given-names>AJ</given-names></name><name><surname>Lee</surname> <given-names>JM</given-names></name><name><surname>Su</surname> <given-names>W</given-names></name><name><surname>Arlian</surname> <given-names>BM</given-names></name><name><surname>Xie</surname> <given-names>J</given-names></name><name><surname>Lerner</surname> <given-names>RA</given-names></name><name><surname>Yen</surname> <given-names>HL</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name><name><surname>Wilson</surname> <given-names>IA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Different genetic barriers for resistance to HA stem antibodies in influenza H3 and H1 viruses</article-title><source>Science</source><volume>368</volume><fpage>1335</fpage><lpage>1340</lpage><pub-id pub-id-type="doi">10.1126/science.aaz5143</pub-id><pub-id pub-id-type="pmid">32554590</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname> <given-names>H</given-names></name><name><surname>Schmidt</surname> <given-names>AG</given-names></name><name><surname>O'Donnell</surname> <given-names>T</given-names></name><name><surname>Therkelsen</surname> <given-names>MD</given-names></name><name><surname>Kepler</surname> <given-names>TB</given-names></name><name><surname>Moody</surname> <given-names>MA</given-names></name><name><surname>Haynes</surname> <given-names>BF</given-names></name><name><surname>Liao</surname> <given-names>HX</given-names></name><name><surname>Harrison</surname> <given-names>SC</given-names></name><name><surname>Shaw</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Key mutations stabilize antigen-binding conformation during affinity maturation of a broadly neutralizing influenza antibody lineage</article-title><source>Proteins: Structure, Function, and Bioinformatics</source><volume>83</volume><fpage>771</fpage><lpage>780</lpage><pub-id pub-id-type="doi">10.1002/prot.24745</pub-id><pub-id pub-id-type="pmid">25524709</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname> <given-names>J</given-names></name><name><surname>Ma</surname> <given-names>N</given-names></name><name><surname>Madden</surname> <given-names>TL</given-names></name><name><surname>Ostell</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title><source>Nucleic Acids Research</source><volume>41</volume><fpage>W34</fpage><lpage>W40</lpage><pub-id pub-id-type="doi">10.1093/nar/gkt382</pub-id><pub-id pub-id-type="pmid">23671333</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yen</surname> <given-names>JY</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>Finding the K shortest loopless paths in a network</article-title><source>Management Science</source><volume>17</volume><fpage>712</fpage><lpage>716</lpage><pub-id pub-id-type="doi">10.1287/mnsc.17.11.712</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yewdell</surname> <given-names>JW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>To dream the impossible dream: universal influenza vaccination</article-title><source>Current Opinion in Virology</source><volume>3</volume><fpage>316</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1016/j.coviro.2013.05.008</pub-id><pub-id pub-id-type="pmid">23835048</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Maximum likelihood approach to binding affinity inference</title><p>In this approach we make the assumption that the fluorescence emitted by cells of a specific genotype is distributed log-normally, with parameters <inline-formula><mml:math id="inf174"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (the mean and standard deviation of the associated normal distribution respectively). At concentration <inline-formula><mml:math id="inf176"><mml:mi>c</mml:mi></mml:math></inline-formula>, a cell with genotype <inline-formula><mml:math id="inf177"><mml:mi>s</mml:mi></mml:math></inline-formula> will fall into the bin <inline-formula><mml:math id="inf178"><mml:mi>b</mml:mi></mml:math></inline-formula> (log<sub>10</sub>-fluorescence values <inline-formula><mml:math id="inf179"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ranging from <italic>l</italic><sub><italic>b</italic></sub> to <italic>h</italic><sub><italic>b</italic></sub>) with probability:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mtext>d</mml:mtext><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>erf</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>erf</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Each cell sorted is an independent event, so the number of cells in each bin will be multinomially distributed, and thus the likelihood of sorting <inline-formula><mml:math id="inf180"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> cells of sequence <inline-formula><mml:math id="inf181"><mml:mi>s</mml:mi></mml:math></inline-formula> into bin <inline-formula><mml:math id="inf182"><mml:mi>b</mml:mi></mml:math></inline-formula> at concentration <inline-formula><mml:math id="inf183"><mml:mi>c</mml:mi></mml:math></inline-formula> is given by<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and the log-likelihood is<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mi>log</mml:mi><mml:mi class="ltx_font_mathcaligraphic">ℒ</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The probability <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> is estimated as in the mean-bin approach (see Methods) and the log-likelihood is then maximized as a function of <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (BFGS method). The values of <inline-formula><mml:math id="inf187"><mml:mi>A</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf189"><mml:mi>B</mml:mi></mml:math></inline-formula> are then estimated similarly as the mean-bin approach (see Methods), replacing <inline-formula><mml:math id="inf190"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by <inline-formula><mml:math id="inf191"><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p><p>The <inline-formula><mml:math id="inf192"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> inferred by this maximum likelihood (ML) approach correlate well with isogenic flow cytometry <inline-formula><mml:math id="inf193"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>), but not as well as those inferred by the mean-bin approach (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). The ML approach is predicated on the assumption that the fluorescence distribution for each variant is log-normal, which is often not the case (see <xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). For these reasons, in addition to favoring a simple approach, we performed all analyses with <inline-formula><mml:math id="inf194"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> inferred by the mean-bin approach.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Correlation between <inline-formula><mml:math id="inf195"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> from ML inference on Tite-Seq data vs. <inline-formula><mml:math id="inf196"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> from isogenic flow cytometry.</title><p><inline-formula><mml:math id="inf197"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to H1 (salmon), H3 (green), and Flu B (blue) shown for select variants, identical to those shown in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>. Pearson’s r = 0.97.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app1-fig1-v3.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Distributions of PE-A fluorescence (HA binding) for isogenic CR9114 strains incubated with H3.</title><p>PE-A fluorescence distributions from flow cytometry of isogenic CR9114 germline (left) and somatic (right) strains following incubation with 1 μM, 100 nM, and 10 nM H3, as described in Methods. Shape of distribution varies for different clones and is not strictly log-normal, hence deviating from assumptions made in the maximum-likelihood binding affinity inference.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app1-fig2-v3.tif"/></fig></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s9" sec-type="appendix"><title>Alternative approaches to epistasis inference</title><sec id="s9-1"><title>Statistical epistasis and variance partitioning</title><p>The contrast between biochemical and statistical frameworks for epistasis is well described in <xref ref-type="bibr" rid="bib59">Poelwijk et al., 2016</xref>. In particular, a biochemical epistasis approach highlights one particular sequence as the ‘‘wildtype’’ or reference sequence and measures effects relative to its phenotype, whereas a statistical epistasis approach measures effects relative to the average phenotype of all variants included. The biochemical approach benefits from easier interpretation of the coefficient values, particularly when there is a natural or relevant choice of reference sequence, but the coefficients at different orders are not statistically independent. The statistical approach allows for correct variance partitioning between interaction orders, but the interpretation of the coefficients can be sensitive to the set of sequences, particularly when not all possible sequences are represented or when a majority of sequences exhibit some uninteresting phenotype (e.g. lethal).</p><p>Here, we perform inference of statistical epistasis exactly as described above for biochemical epistasis (see Methods), except that genotypes <inline-formula><mml:math id="inf198"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are coded as <inline-formula><mml:math id="inf199"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> instead of <inline-formula><mml:math id="inf200"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. The results from this statistical epistasis inference are shown in <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> for CR9114 and <xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref> for CR6261, in plots analogous to those in <xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref> and supplements. We find that the patterns of site participation in interactions are similar (although the coefficient magnitudes and signs are of course scaled differently). The group of five key sites discussed in <xref ref-type="fig" rid="fig3">Figure 3</xref> (sites 30, 57, 65, 82, and 83 for CR9114 binding to H1) exhibit coefficients that are significant for all 31 mutation combinations, consistent with the result from biochemical epistasis. Overall, the numbers of significant coefficients inferred in statistical epistasis models tends to be somewhat higher than for biochemical epistasis models, perhaps due to the effect of background averaging in reducing coefficient standard errors, but neither framework is a substantially more compact representation of epistasis than the other.</p><p>In the statistical epistasis framework, we can also partition the variance explained by the model according to the interaction order. Here, we take the final inferred model at the optimal interaction order and evaluate the prediction performance (<inline-formula><mml:math id="inf201"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) of each order as a fraction of the total performance of the full model. As shown in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>, we find that epistasis explains a substantial fraction of variance (18%–33%, depending on antibody-antigen pair). Variance explained tends to decline with increasing order, as is also observed in some other protein epistasis datasets (<xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>). This indicates that interactions at higher order are more rare (compared to the total number of terms at each order, which scales combinatorially) and/or smaller in magnitude than those at lower order. However, this does not imply that rare, strong interactions of even higher order do not exist; for example, there may be some strong sixth-order interaction terms for CR9114 binding to H1, but not enough to compensate for the many nonsignificant sixth-order terms in our cross-validation framework.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Results from statistical epistasis models for CR9114.</title><p>(<bold>A</bold>) First-order effects, as in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. ‘R’ indicates required mutations. (<bold>B</bold>) Second-order effects for H1 (top right) and H3 (lower left), as in <xref ref-type="fig" rid="fig2">Figure 2D</xref>. Interactions with required mutations for H3 are noted in dark red. (<bold>C</bold>) Cumulative higher-order effects for CR9114 binding to H1, as in <xref ref-type="fig" rid="fig3">Figure 3A</xref>. (<bold>D</bold>) Cumulative higher-order effects for CR9114 binding to H3, as in <xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>. (<bold>E</bold>) Inferred interaction coefficients for the set of five key epistatic loci, as in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref> with corresponding colors. Note the different y-axis scales for the two subplots. Different interaction orders are separated by dotted lines. (<bold>F</bold>) Number of significant coefficients at all orders for the biochemical and statistical epistasis models. The maximal order of interaction for each model is indicated in parentheses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app2-fig1-v3.tif"/></fig><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Results from statistical epistasis models for CR6261.</title><p>(<bold>A</bold>) First-order effects, as in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. (<bold>B</bold>) Second-order effects for H1 (top right) and H9 (lower left), as in <xref ref-type="fig" rid="fig2">Figure 2E</xref>. (<bold>C</bold>) Cumulative higher-order effects for CR6261 binding to H1, as in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. (<bold>D</bold>) Cumulative higher-order effects for CR9114 binding to H9, as in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A</xref>. (<bold>E</bold>) Number of significant coefficients at all orders for the biochemical and statistical epistasis models. The maximal order of interaction for each model is indicated in parentheses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app2-fig2-v3.tif"/></fig><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Variance partitioning of statistical epistasis models.</title><p>(<bold>A</bold>) Variance partitioning for CR9114 binding to H1 (left) and H3 (right). (<bold>B</bold>) Variance partitioning for CR9114 binding to H1 and H9, denoted by colors as indicated.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app2-fig3-v3.tif"/></fig><p>In particular, another alternative approach to the inference of epistasis is to infer a full <inline-formula><mml:math id="inf202"><mml:msup><mml:mi>L</mml:mi><mml:mtext>th</mml:mtext></mml:msup></mml:math></inline-formula>-order model rather than truncating to lower order. This approach calculates <inline-formula><mml:math id="inf203"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula> epistatic coefficients, one for every datapoint, which allows for the detection of strong interactions at any order with the caveat that many coefficients may simply reflect experimental noise, especially for higher-order terms. We explore this approach by following <xref ref-type="bibr" rid="bib60">Poelwijk et al., 2019</xref>: we calculate epistatic coefficients using a Walsh-Hadamard transform of the <inline-formula><mml:math id="inf204"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values, and calculate standard errors on each coefficient via error propagation using the standard errors of the data. We define significant coefficients by a <inline-formula><mml:math id="inf205"><mml:mi>p</mml:mi></mml:math></inline-formula>-value cutoff of 0.05, with Bonferroni correction by the total number of parameters in the model (here <inline-formula><mml:math id="inf206"><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:math></inline-formula>). We find that for all antibody-antigen combinations, this approach finds more significant coefficients than the optimal truncated models, many of which are at higher interaction orders than allowed in the truncated model (<xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref>). This analysis requires a measurement of <inline-formula><mml:math id="inf207"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for every single variant, so we use data that has not been filtered for goodness-of-fit or error in the inference of binding affinity (see Methods), including some sequences that have substantial error. Therefore we prefer to use the more conservative regression approach for our in-depth analysis of epistasis; this inference at full order confirms the existence, strength, and identity of the high-order interactions we discuss from the regression approach, while also indicating that additional and even higher-order terms may yet exist.</p><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Epistasis inference at full order.</title><p>(<bold>A,B</bold>) Numbers of significant coefficients for the full-order inference compared to optimal truncated regression models for (<bold>A</bold>) CR9114 and (<bold>B</bold>) CR6261. Significance for both model types is determined by <inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula> with Bonferroni correction by the number of model parameters. (<bold>C,D</bold>) Distribution of interaction orders of significant coefficients for (<bold>C</bold>) CR9114 and (<bold>D</bold>) CR6261.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app2-fig4-v3.tif"/></fig></sec></sec><sec id="s10" sec-type="appendix"><title>Nonlinear models</title><p>An alternative approach to understanding epistasis is to view nonlinearities in observed phenotype data as arising from a simple nonlinear transformation applied to an underlying, unobserved additive phenotype. In this view, a simple nonlinear ‘‘global epistasis’’ function with few parameters may describe the landscape as well or better than models of the sort described above, with their large number of ‘‘idiosyncratic epistasis’’ parameters. Many studies in other proteins have attempted to disentangle such global epistasis from idiosyncratic effects (<xref ref-type="bibr" rid="bib63">Sailer and Harms, 2017a</xref>; <xref ref-type="bibr" rid="bib18">Domingo et al., 2019</xref>; <xref ref-type="bibr" rid="bib65">Sarkisyan et al., 2016</xref>; <xref ref-type="bibr" rid="bib53">Otwinowski et al., 2018</xref>; <xref ref-type="bibr" rid="bib52">Otwinowski, 2018</xref>; <xref ref-type="bibr" rid="bib2">Adams et al., 2019</xref>).</p><p>We already implement one global nonlinear transformation, by log-transforming our binding affinity measurements so that they are proportional to free energy changes, as described above. However, it is possible that another nonlinear transformation would capture the effects of many specific interaction coefficients, if there is a single underlying additive scale. In this section, we explore this possibility following the approach taken by <xref ref-type="bibr" rid="bib63">Sailer and Harms, 2017a</xref>: we infer a nonlinear transformation that fits the phenotype data, invert it to ‘‘linearize’’ the phenotypes, re-fit interaction models on the linearized phenotypes, and then compare those model coefficients to the original coefficients to evaluate the role of the nonlinear transformation.</p><p>Our new model is<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>add</mml:mtext></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>y</italic><sub><italic>s</italic></sub> are the observed phenotypes (<inline-formula><mml:math id="inf209"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> values), <inline-formula><mml:math id="inf210"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is a nonlinear function with a small number of associated parameters <italic>k</italic><sub><italic>m</italic></sub>, and <inline-formula><mml:math id="inf211"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>add</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> are the underlying additive-scale phenotypes, parametrized as before by additive coefficients <inline-formula><mml:math id="inf212"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>To specify <inline-formula><mml:math id="inf213"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, we must choose a family of nonlinear functions. Typical choices include splines (<xref ref-type="bibr" rid="bib53">Otwinowski et al., 2018</xref>) or power transforms (<xref ref-type="bibr" rid="bib64">Sailer and Harms, 2017b</xref>). We found that logistic (sigmoid) functions fit our data better than power transforms or splines, and they are monotonic and invertible. Specifically, our logistic function with four parameters is<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>B</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Logistic functions capture two features that we observe: first, there is a saturation effect at low values of <inline-formula><mml:math id="inf214"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, corresponding to nonspecific binding that our measurements are unable to distinguish (<xref ref-type="bibr" rid="bib9">Batista and Neuberger, 1998</xref>); and second, for most antibody-antigen combinations we observe a saturation effect at moderately high values of <inline-formula><mml:math id="inf215"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This latter effect is not due to limits on our measurement capabilities, as illustrated by higher values of <inline-formula><mml:math id="inf216"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> measured for the CR6261 library to H9 compared to values of <inline-formula><mml:math id="inf217"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>⁡</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> measured for the CR9114 library to H1, but instead due to widespread ‘‘diminishing returns’’ epistasis.</p><p>After specifying the functional form of <inline-formula><mml:math id="inf218"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, we must fit both the nonlinear parameters <italic>k</italic><sub><italic>m</italic></sub> and underlying linear parameters <inline-formula><mml:math id="inf219"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. In principle, one could fit all parameters jointly, using for example a maximum likelihood approach (<xref ref-type="bibr" rid="bib53">Otwinowski et al., 2018</xref>). However, we take the simpler approach as implemented in the software package from <xref ref-type="bibr" rid="bib63">Sailer and Harms, 2017a</xref>, which first infers the additive parameters <inline-formula><mml:math id="inf220"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> from the observed phenotypes and then infers the nonlinear function parameters <italic>k</italic><sub><italic>m</italic></sub>. We show the resulting fit of <inline-formula><mml:math id="inf221"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> in <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5a</xref> for two representative examples, by plotting our estimate of the additive phenotypes <inline-formula><mml:math id="inf222"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>add</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> on the x-axis and our observed phenotypes from data on the y-axis. We found that this simple procedure identified well-fitting <inline-formula><mml:math id="inf223"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> in a single step, and successive iterations did not significantly improve the fit.</p><p>After fitting the nonlinear transformation, we apply the inverse transformation to our observed phenotypes to obtain ‘‘linearized’’ phenotypes <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>:<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Because the fit of <inline-formula><mml:math id="inf225"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula> is not perfect, the linearized phenotypes <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> are not exactly equal to the estimated additive phenotypes <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>add</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula>, although linear regression on both quantities produces extremely similar values of <inline-formula><mml:math id="inf228"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. For values that lie above the domain of <inline-formula><mml:math id="inf229"><mml:msup><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, we pin them to the largest estimated additive phenotype.</p><p>Finally, we can take our linearized phenotypes <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> and infer interaction model coefficients <inline-formula><mml:math id="inf231"><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> of various orders, exactly as described above for the untransformed ‘‘raw’’ phenotypes:<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mtext>lin</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mn>0</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We again perform this analysis in both the biochemical and statistical epistasis frameworks. If the inverse transformation has removed most or all of the nonlinearity, then the resulting optimal interaction models should be smaller (lower maximum order of interaction and/or fewer significant interaction coefficients).</p><p>Instead, we find that in all cases, the optimal order of interaction is unchanged or only decreased by one when inferring on linearized vs raw phenotypes. Specifically, the new (vs old) optimal orders are: 4th (vs 5th) for CR9114 binding to H1, 4th (vs 4th) for CR9114 binding to H3, 3rd (vs 4th) for CR6261 binding to H1, 3rd (vs 4th) for CR6261 binding to H9 in the biochemical epistasis framework, and 4th (vs 4th) for CR6261 binding to H9 in the statistical epistasis framework. We can compare the numbers of significant coefficients in these optimal models inferred on linearized phenotypes to the models with the same maximum order inferred on raw phenotypes (<xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5d,e</xref>), where we see that the numbers are relatively comparable.</p><p>We next examine changes in the individual coefficients between these models. In <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5b</xref>, we show two representative scatterplots between the raw phenotype coefficients <inline-formula><mml:math id="inf232"><mml:mi>β</mml:mi></mml:math></inline-formula> and the linearized phenotype coefficients <inline-formula><mml:math id="inf233"><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, where only significant coefficients are shown for clarity. While some coefficients show dramatic changes, overall the two sets of coefficients are quite well correlated. To see which sites are involved in strong changes, we can also represent coefficient changes in a heatmap format (<xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5c</xref>). Here, diagonal cells show the change in coefficient for single sites (<inline-formula><mml:math id="inf234"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), while off-diagonal cells show the sum of coefficient changes over all pairwise and higher terms involving each pair of mutations. We observe that for some antibody-antigen pairs, such as CR9114 binding to H1, the strongest net changes are negative, though not negative enough to remove the many significant coefficients. For other antibody-antigen pairs such as CR6261 binding to H1, there are both positive and negative net changes, indicating that the nonlinear transformation is changing the epistatic landscape rather than correcting for it.</p><fig id="app2fig5" position="float"><label>Appendix 2—figure 5.</label><caption><title>Results from epistasis models with nonlinear transformations.</title><p>(A), Fitting logistic functions to additive predicted phenotypes. Red lines indicate the optimized logistic function <inline-formula><mml:math id="inf235"><mml:mi mathvariant="normal">Φ</mml:mi></mml:math></inline-formula>, with <inline-formula><mml:math id="inf236"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> as indicated. (B), Scatterplot of coefficients <inline-formula><mml:math id="inf237"><mml:msup><mml:mi>β</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> from the optimal order model inferred on linearized data (after inverting the best-fit nonlinear transformation) against original coefficients <inline-formula><mml:math id="inf238"><mml:mi>β</mml:mi></mml:math></inline-formula> for the model with the same maximum order. (C), Net changes of coefficients by site. Diagonal cells show changes in linear coefficients. Off-diagonal cells show the sum of changes over terms at all orders (2nd and above) in which the given pair of mutations is involved. For (A-C), we show two representative antibody-antigen combinations: CR9114 binding to H1, top, and CR6261 binding to H1, bottom. (D,E), Number of significant coefficients in optimal order models fit to phenotypes transformed by the inverse nonlinear function (light bars), compared to original coefficients from linear models with the same maximal order (dark bars), for (D) CR9114 and (E) CR6261. The epistasis type and model order are indicated on the x-axis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-71393-app2-fig5-v3.tif"/></fig><p>In summary, we find that nonlinear logistic transformations can account for a portion of the nonlinearities observed in our data, sometimes reducing the maximal order of interaction by one. However, all antigen-antibody pairs still exhibit strong idiosyncratic epistasis up to at least third order after correcting for global epistasis, and the resulting numbers and magnitudes of significant coefficients are not drastically changed. Thus, it does not appear that global epistasis can explain our data much more simply than models with individual interactions, and so we confine our main analysis to idiosyncratic epistasis models.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71393.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Fleishman</surname><given-names>Sarel Jacob</given-names></name><role>Reviewing Editor</role><aff><institution>Weizmann Institute of Science</institution><country>Israel</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Bloom</surname><given-names>Jesse D</given-names></name><role>Reviewer</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Wu</surname><given-names>Nicholas C</given-names></name><role>Reviewer</role><aff><institution>University of Illinois at Urbana-Champaign</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2021.05.25.445596">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.05.25.445596v1">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>CR6261 and CR9114 are two antibodies that bind to the conserved stem of influenza hemagglutinin (HA) through their VH regions and differ by 14-18 mutations from their inferred germline sequences. The authors constructed large combinatorial libraries containing combinations of 11 and 16 mutations for CR6261 and CR9114, respectively. These were used in yeast surface display titrations to infer individual and epistatic contributions to binding diverse HAs and to infer possible evolutionary trajectories going from germline to the mature antibodies. The study provides a wealth of knowledge on amino acid contributions to binding affinity. The study informs our understanding of biochemical epistasis, and could potentially serve as a starting point for a more detailed understanding of antibody affinity maturation more generally.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Binding affinity landscapes constrain the evolution of broadly neutralizing anti-influenza antibodies&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Satyajit Rath as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Jesse D Bloom (Reviewer #2); Nicholas C Wu (Reviewer #4).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1. Following are a number of factors that may confound or limit the interpretation of the results. The authors should mention these factors and the limits they place on the analysis of evolutionary paths during antibody selection. They should also tone down the language regarding the relevance to vaccine design.</p><p>– Unlike other studies where antibodies were isolated from single-cell sorting of memory B-cells, the present bNAbs were isolated from phage display libraries. These libraries (Throsby et al., 2008; Dreyfus et al., 2012) were constructed from pooled IgM+ from 10 (not 3 as incorrectly stated in manuscript) (CR6261) or 3 (CR9114) healthy donors and scFv fragments were cloned and screened using phage display against H5HA for CR6261 (Throsby et al., 2008) and against sequential panning against Has from H1, H3 and both B lineages for CR9114 (Dreyfus et al., 2012) respectively. Use of phage display methodology which involves multiple rounds of PCR as well as panning means that mutations can be introduced during library construction. Hence the resulting sequences isolated need not accurately reflect antibody gene sequences present in the donors. Further, the multi-round panning process with diverse HAs (especially for CR9114) biases the resulting sequences selected, altering the order of the panning steps might result in a different selected sequence.</p><p>– Additionally, it is unclear what the natural selection pressures are. It is likely that they would be for increased neutralization breadth and potency which is not straightforwardly related to improved breadth of binding to soluble HA where the stem accessibility is much higher than it is in the viral context.</p><p>– The known polyreactivity of many bNAbs including stem-directed bNAbs (PMID: 33049994) is another confounding factor.</p><p>– Unlike studies with bNAbs isolated from elite neutralizers in the case of HIV-1, there is no evidence that the individuals from whom the pooled phage libaries were made had significant breadth of serum neutralizing activity and so it remains possible that the breadth of the final isolated antibodies arose from mutations introduced during the PCR amplifications and enriched through the panning steps.</p><p>2. CR6261 was selected by panning against H5 HA whereas the vaccinated individuals presumably primarily had experienced H1. Since the antibody binds to the conserved stem of HA what is relevant to interpret the mutational landscapes is not the overall antigenic diversity of HA (Figure 1B) but the diversity of the stem epitopic region. If these regions are similar in H1 and H9 HA that would explain the observation that multiple mutations in the antibody are tolerated in both cases. In the case of CR9114, the mature antibody binds best to H1, less well to H3 and weakest to B HA. Unsurprisingly the same pattern is reflected in the mutational data. Given the greater diversity in HA stem epitope sequence between H1, H3 and B relative to that between H1 and H9 it is also unsurprising that there should be the sequential acquisition of breadth in the latter CR9114 case (see also 1 above).</p><p>3. In lines 69-70, &quot;bnAbs tend to have many more mutations than specific antibodies&quot;. This statement is mostly true for HIV bnAbs but not for influenza bnAbs. As described by Lingwood et al., (PMID: 22932267), &quot;Influenza IGHV1-69-based broadly neutralizing antibodies undergo a relatively low degree of somatic mutation (an average of 14 amino acids in the heavy chain, n = 9)&quot;. In fact, many influenza antibodies have similar number of somatic mutations as CR9114 and CR6261 (PMID: 30795982).</p><p>4. It is surprising to see significant second-order effects at relatively large distances (Figure 2F). What is the suggested explanation?</p><p>5. It is never clearly stated in results whether it's single chain (scFv) antibody, and if the HA is trimeric. If so, is there a potential for avidity so that the measurements are Kd,apparent for the multivalent interaction rather than monomeric Kd?</p><p>Other comments:</p><p>In both the abstract and beginning of results, it would be helpful to describe the libraries a bit more clearly: all combinations of mutations separating the germline and mature antibody in the VH domain among sites contacting the epitope.</p><p>Avnir et al., PLoS Pathog 2014 (PMID: 24788925) has analyzed the somatic mutation pattern in IGHV1-69 influenza bnAbs. The authors should cite Avnir et al., to further substantiate the findings in this study. For example, Arnir et al., identified several commonly occurring somatic mutations in IGHV1-69 influenza bnAbs, including T29P, S35R, and S83F (i.e. T28P, S30R, S74F, respectively, in Kabat numbering), which have strong additive effect in CR6261 (Figure 2B).</p><p>Since evolution proceeds through single-nucleotide rather than amino acid exchanges, the germline and mature antibody nucleotide sequences should be presented (if known). The authors may consider adding a comment that evolution may not move directly through amino acid exchanges if the DNA sequence does not permit such a change through a single-nucleotide mutation.</p><p>I personally was very curious how the specific epistasis models the authors used compare to global epistasis models. This is well explained in the appendix, but might be helpful to mention in another sentence or two in main text as well.</p><p>In the non-global-epistasis model, is anything done to handle the censoring of the data at the high and low end of the affinity scale? I was confused by this because line 115 says values outside the range are pinned to the boundaries, but then in Appendix (line 1282) it seems to suggest censoring isn't an issue.</p><p>The interactive browser is cool! Would be nice if mutations were either labeled by the amino acids, or there was clearer explanation which amino acid identity is 0 and which is 1 for the violin plots. Also, might be worth adding text explaining the browser is only available for CR9114.</p><p>Line 41: I think there are actually now a lot of broadly neutralizing antibodies, so I'm not sure how accurate &quot;a handful&quot; is here.</p><p>Line 70: &quot;less broad&quot; might be better than &quot;specific&quot; because even bNAbs are specific (for flu HA for instance) rather than &quot;sticky&quot; to everything.</p><p>I had a hard time understanding the numbers in Figure 1A.</p><p>I found Figure 1G confusing, mostly because I didn't (and still don't) really understand all the boxes with solid and dotted black lines labeled with various HAs.</p><p>Line 288-289: I think we can be virtually certain that the person wasn't infected with H9 since it's not a human virus subtype.</p><p>It would be useful to list the surface area each residue in the paratope for both antibodies contributes to binding where such information is available.</p><p>Is it possible to convert the effect scores into a free energy of binding contribution? Are there error estimates for the effect scores that would allow one to assess whether apparent differences in effect scores are statistically significant?</p><p>Larger epistatic effect scores occur between residues with the largest contributions to binding. Is this expected?</p><p>The authors may consider changing &quot;CR-9114&quot; and &quot;CR-6261&quot; to &quot;CR9114&quot; and &quot;CR6261&quot;, respectively, which are the more commonly used nomenclatures for these two antibodies in the field.</p><p>It is unclear to me which antibody numbering scheme (e.g. Kabat, Chothia, IMGT) is being used for numbering amino acid residues in this study. Also, naming a position as &quot;112.1&quot; in CR6261 seems a bit odd. Should that be &quot;112a&quot;?</p><p>In panel B of Figure 1—figure supplement 5, the correlation between Tite-Seq mean expression and isogenic expression fluorescence is quite high for CR9114 variants but low for CR6261 variants. Is there a reason for that discrepancy?</p><p>In lines 224-225, &quot;In contrast, a specific set of many mutations with strong synergistic interactions is required to bind H3, and to an even greater extent, influenza B&quot;. It is not very clear to me which analysis supports this claim. Can the authors clarify a bit?</p><p>In caption of Figure 5, while the meaning of &quot;R&quot; is described (random mixed scenario), the meaning of &quot;O&quot; and &quot;A&quot; should also be explained.</p><p>Among the somatic mutations in CR9114, I57S, K82I, and S83F are particularly important for binding to H3 (lines 182-183 and Figure 2D). Can the author provide a plausible structural explanation?</p><p>Similar to the comment above, it is interesting to see that T29P almost exclusively occurs as the first mutation under various selection scenarios (Figure 5J and Figure 5—figure supplement 3C-D). Can the author provide a plausible structural explanation?</p><p><italic>Reviewer #1 Recommendations for the authors:</italic></p><p>The interactive browser is cool! It would be nice if mutations were either labeled by the amino acids, or if there was a clearer explanation which amino acid identity is 0 and which is 1 for the violin plots. Also, might be worth adding text explaining the browser is only available for CR9114.</p><p>Line 41: I think there are actually now a lot of broadly neutralizing antibodies, so I'm not sure how accurate &quot;a handful&quot; is here.</p><p>Line 70: &quot;less broad&quot; might be better than &quot;specific&quot; because even bNAbs are specific (for flu HA for instance) rather than &quot;sticky&quot; to everything.</p><p>I had a hard time understanding the numbers in Figure 1A.</p><p>I found Figure 1G confusing, mostly because I didn't (and still don't) really understand all the boxes with solid and dotted black lines labeled with various HAs.</p><p>Line 288-289: I think we can be virtually certain that the person wasn't infected with H9 since it's not a human virus subtype.</p><p><italic>Reviewer #4 Recommendations for the authors:</italic></p><p>1. The authors may consider changing &quot;CR-9114&quot; and &quot;CR-6261&quot; to &quot;CR9114&quot; and &quot;CR6261&quot;, respectively, which are the more commonly used nomenclatures for these two antibodies in the field.</p><p>2. It is unclear to me which antibody numbering scheme (e.g. Kabat, Chothia, IMGT) is being used for numbering amino acid residues in this study. Also, naming a position as &quot;112.1&quot; in CR6261 seems a bit odd. Should that be &quot;112a&quot;?</p><p>3. In lines 69-70, &quot;bnAbs tend to have many more mutations than specific antibodies&quot;. This statement is mostly true for HIV bnAbs but not for influenza bnAbs. As described by Lingwood et al., (PMID: 22932267), &quot;Influenza IGHV1-69-based broadly neutralizing antibodies undergo a relatively low degree of somatic mutation (an average of 14 amino acids in the heavy chain, n = 9)&quot;. In fact, many influenza antibodies have similar number of somatic mutations as CR9114 and CR6261 (PMID: 30795982).</p><p>4. In panel B of Figure 1—figure supplement 5, the correlation between Tite-Seq mean expression and isogenic expression fluorescence is quite high for CR9114 variants but low for CR6261 variants. Is there a reason for that discrepancy?</p><p>5. In lines 224-225, &quot;In contrast, a specific set of many mutations with strong synergistic interactions is required to bind H3, and to an even greater extent, influenza B&quot;. It is not very clear to me which analysis supports this claim. Can the authors clarify a bit?</p><p>6. In caption of Figure 5, while the meaning of &quot;R&quot; is described (random mixed scenario), the meaning of &quot;O&quot; and &quot;A&quot; should also be explained.</p><p>7. Among the somatic mutations in CR9114, I57S, K82I, and S83F are particularly important for binding to H3 (lines 182-183 and Figure 2D). Can the author provide a plausible structural explanation?</p><p>8. Similar to the comment above, it is interesting to see that T29P almost exclusively occurs as the first mutation under various selection scenarios (Figure 5J and Figure 5—figure supplement 3C-D). Can the author provide a plausible structural explanation?</p><p>9. Avnir et al., PLoS Pathog 2014 (PMID: 24788925) has analyzed the somatic mutation pattern in IGHV1-69 influenza bnAbs. The authors should cite Avnir et al., to further substantiate the findings in this study. For example, Arnir et al., identified several commonly occurring somatic mutations in IGHV1-69 influenza bnAbs, including T29P, S35R, and S83F (i.e. T28P, S30R, S74F, respectively, in Kabat numbering), which have strong additive effect in CR6261 (Figure 2B).</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.71393.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. Following are a number of factors that may confound or limit the interpretation of the results. The authors should mention these factors and the limits they place on the analysis of evolutionary paths during antibody selection. They should also tone down the language regarding the relevance to vaccine design.</p></disp-quote><p>We have toned down the language regarding the relevance to vaccine design. We have also addressed each of the specific caveats:</p><disp-quote content-type="editor-comment"><p>– Unlike other studies where antibodies were isolated from single-cell sorting of memory B-cells, the present bNAbs were isolated from phage display libraries. These libraries (Throsby et al., 2008; Dreyfus et al., 2012) were constructed from pooled IgM+ from 10 (not 3 as incorrectly stated in manuscript) (CR6261) or 3 (CR9114) healthy donors and scFv fragments were cloned and screened using phage display against H5HA for CR6261 (Throsby et al., 2008) and against sequential panning against Has from H1, H3 and both B lineages for CR9114 (Dreyfus et al., 2012) respectively. Use of phage display methodology which involves multiple rounds of PCR as well as panning means that mutations can be introduced during library construction. Hence the resulting sequences isolated need not accurately reflect antibody gene sequences present in the donors. Further, the multi-round panning process with diverse HAs (especially for CR9114) biases the resulting sequences selected, altering the order of the panning steps might result in a different selected sequence.</p></disp-quote><p>We have commented on the potentially confounding factors associated with phage display in the Discussion. We note that however biased the discovery of these sequences may have been, these antibodies occupy uniquely interesting regions of sequence space because of their associated breadth and are thus useful for understanding the relationship between sequence, affinity, and breadth. We have also made the noted correction to the Methods section (i.e. that CR6261 was isolated from pooled PBMC from 10 donors rather than 3), and thank the reviewer for bringing this to our attention.</p><disp-quote content-type="editor-comment"><p>– Additionally, it is unclear what the natural selection pressures are. It is likely that they would be for increased neutralization breadth and potency which is not straightforwardly related to improved breadth of binding to soluble HA where the stem accessibility is much higher than it is in the viral context.</p></disp-quote><p>We have commented on this potential caveat in the Discussion and have referred to several studies that find affinity to soluble recombinant HA to be indicative of viral neutralization.</p><disp-quote content-type="editor-comment"><p>– The known polyreactivity of many bNAbs including stem-directed bNAbs (PMID: 33049994) is another confounding factor.</p></disp-quote><p>Selection against polyreactivity is likely an important factor shaping bnAb maturation that is not measured in this study and thus is not captured by our models. We have commented on this potential caveat in the Discussion, referring to studies examining the polyreactivity of stem-targeting bnAbs.</p><disp-quote content-type="editor-comment"><p>– Unlike studies with bNAbs isolated from elite neutralizers in the case of HIV-1, there is no evidence that the individuals from whom the pooled phage libaries were made had significant breadth of serum neutralizing activity and so it remains possible that the breadth of the final isolated antibodies arose from mutations introduced during the PCR amplifications and enriched through the panning steps.</p></disp-quote><p>We have added a comment on the potential caveats associated with phage display PCR and panning to the Discussion.</p><disp-quote content-type="editor-comment"><p>2. CR6261 was selected by panning against H5 HA whereas the vaccinated individuals presumably primarily had experienced H1. Since the antibody binds to the conserved stem of HA what is relevant to interpret the mutational landscapes is not the overall antigenic diversity of HA (Figure 1B) but the diversity of the stem epitopic region. If these regions are similar in H1 and H9 HA that would explain the observation that multiple mutations in the antibody are tolerated in both cases. In the case of CR9114, the mature antibody binds best to H1, less well to H3 and weakest to B HA. Unsurprisingly the same pattern is reflected in the mutational data. Given the greater diversity in HA stem epitope sequence between H1, H3 and B relative to that between H1 and H9 it is also unsurprising that there should be the sequential acquisition of breadth in the latter CR9114 case (see also 1 above).</p></disp-quote><p>We agree that the diversity of the stem epitope is important for comparing these antigens and have included this information in Figure 1—Figure supplement 1 and have referenced this in main text. In Figure 1B we retained the antigenic diversity of HA to illustrate the varying levels of breadth of the two antibodies, to motivate the choice of HA antigen for screening each antibody library, and to orient readers unfamiliar with influenza groups and HA subtypes. While we agree that retrospectively the nested sets of mutations required for CR9114 breadth may seem unsurprising given CR9114 affinity for each of these antigens and the diversity of the corresponding stem epitopes, this finding is novel and provides new molecular insight into the constraints on mutational pathways to antibodies with varying levels of breadth.</p><disp-quote content-type="editor-comment"><p>3. In lines 69-70, &quot;bnAbs tend to have many more mutations than specific antibodies&quot;. This statement is mostly true for HIV bnAbs but not for influenza bnAbs. As described by Lingwood et al., (PMID: 22932267), &quot;Influenza IGHV1-69-based broadly neutralizing antibodies undergo a relatively low degree of somatic mutation (an average of 14 amino acids in the heavy chain, n = 9)&quot;. In fact, many influenza antibodies have similar number of somatic mutations as CR9114 and CR6261 (PMID: 30795982).</p></disp-quote><p>We have removed this statement.</p><disp-quote content-type="editor-comment"><p>4. It is surprising to see significant second-order effects at relatively large distances (Figure 2F). What is the suggested explanation?</p></disp-quote><p>Second-order effects could be caused by direct interactions between neighboring residues but also by indirect interactions between residues, either through their interactions with antigen or through conformational rearrangements. The second-order effects we observe at relatively large distances likely result from indirect interactions, and we have clarified this in the text.</p><disp-quote content-type="editor-comment"><p>5. It is never clearly stated in results whether it's single chain (scFv) antibody, and if the HA is trimeric. If so, is there a potential for avidity so that the measurements are Kd,apparent for the multivalent interaction rather than monomeric Kd?</p></disp-quote><p>We have clarified that the constructs are scFv antibodies and that the HA is trimeric in the results. In regard to potential avidity, due to the density of scFv antibodies on the yeast cell (10<sup>4</sup>-10<sup>5</sup>, Bodor and Wittrup 1997) and the surface area of a budding yeast cell (60 mm<sup>2</sup>, Klis et al., 2014), it is unlikely that two scFv bind a single HA trimer (distance between stem epitopes on adjacent monomers &lt; 10 nm). This potential issue is further avoided by sorting single cells, such that scFv on different yeast cells that could potentially interact with a single HA trimer would be discarded during sorting. Thus, we expect that the K<sub>D</sub> measurements made here reflect monomeric binding interactions between trimeric HA and a single scFv. Additionally, the original development of the yeast display system used here established that this method enables measurement of equilibrium dissociation constants (K<sub>D</sub>) that are comparable to solution-based measurements (Bodor and Wittrup 1997; Bodor and Wittrup 2003).</p><disp-quote content-type="editor-comment"><p>Other comments:</p><p>In both the abstract and beginning of results, it would be helpful to describe the libraries a bit more clearly: all combinations of mutations separating the germline and mature antibody in the VH domain among sites contacting the epitope.</p></disp-quote><p>We have edited the abstract to specify that the mutations are located in the heavy-chain for both antibodies. In the results, we have clarified that we are examining mutations separating the germline and somatic sequences. Although we did exclude 2 (CR9114) and 3 (CR6261) distant framework mutations from our libraries, we did not limit our libraries to sites contacting the epitope.</p><disp-quote content-type="editor-comment"><p>Avnir et al., PLoS Pathog 2014 (PMID: 24788925) has analyzed the somatic mutation pattern in IGHV1-69 influenza bnAbs. The authors should cite Avnir et al., to further substantiate the findings in this study. For example, Arnir et al., identified several commonly occurring somatic mutations in IGHV1-69 influenza bnAbs, including T29P, S35R, and S83F (i.e. T28P, S30R, S74F, respectively, in Kabat numbering), which have strong additive effect in CR6261 (Figure 2B).</p></disp-quote><p>We thank reviewers for pointing out this study and have added this citation to our discussion of single mutational effects.</p><disp-quote content-type="editor-comment"><p>Since evolution proceeds through single-nucleotide rather than amino acid exchanges, the germline and mature antibody nucleotide sequences should be presented (if known). The authors may consider adding a comment that evolution may not move directly through amino acid exchanges if the DNA sequence does not permit such a change through a single-nucleotide mutation.</p></disp-quote><p>The mature nucleotide sequences are published and the associated GenBank IDs have been added to our Materials and methods section for additional clarity. The germline nucleotide sequences are not published but can be inferred from the mature sequences using tools such as IMGT or IgBlast (as we did here for CR9114; we have added a description of this process to our Materials and methods). We have included the inferred germline heavy chain nucleotide sequence for CR9114 as Supplementary file 12. For CR6261, we did not infer the germline nucleotide sequence but instead designed our libraries based on the published germline amino acid sequence (Lingwood et al., 2012). Further, all nucleotide sequences used here to generate the antibody libraries (available as plasmid maps in Supplementary files 4-7) were codon optimized for expression in yeast. Thus, the nucleotide sequences of our libraries are relevant for examining evolution at the amino acid level, not the nucleotide level. Still, based on the inferred germline sequence for CR9114, several (4/16) of the amino acid changes occurred via multiple nucleotide mutations, which may occur in a single round of somatic hypermutation (Spisak 2020, Unniraman 2007), or over two distinct rounds. A comment to reflect this point has been added to the ‘Affinity to diverse antigens was likely acquired sequentially’ section of the Results.</p><disp-quote content-type="editor-comment"><p>I personally was very curious how the specific epistasis models the authors used compare to global epistasis models. This is well explained in the appendix, but might be helpful to mention in another sentence or two in main text as well.</p></disp-quote><p>We have added a sentence summarizing the results from the global epistasis analysis, in the paragraph where we introduce the epistasis modeling approach.</p><disp-quote content-type="editor-comment"><p>In the non-global-epistasis model, is anything done to handle the censoring of the data at the high and low end of the affinity scale? I was confused by this because line 115 says values outside the range are pinned to the boundaries, but then in Appendix (line 1282) it seems to suggest censoring isn't an issue.</p></disp-quote><p>For all epistasis analysis approaches, we pin inferred –logK<sub>D</sub> values outside of the titration range to our titration boundaries, as other Tite-Seq experiments have done previously (Adams et al., 2016, 2019). For the high-affinity boundary (10<sup>-11</sup> or 10<sup>-12</sup> M), we never observe binding affinities within an order of magnitude of the boundary, so pinning does not occur. The Appendix sentence in question is referring to the “diminishing returns” pattern among high-affinity variants, which therefore is due to epistasis rather than data censoring. However, at the low-affinity boundary, we do observe many variants with no detectable binding, especially for CR9114 binding to H3 and influenza B. As these concentrations are high enough that nonspecific binding becomes appreciable (Batista 1998), we believe it is not meaningful to assign –logK<sub>D</sub> values lower than the boundary (6 or 7 depending on the antigen). Rather than discard these variants altogether, we choose to preserve some measure of their low binding affinity (albeit biased) by assigning them the boundary value and proceeding with inference as described.</p><disp-quote content-type="editor-comment"><p>The interactive browser is cool! Would be nice if mutations were either labeled by the amino acids, or there was clearer explanation which amino acid identity is 0 and which is 1 for the violin plots. Also, might be worth adding text explaining the browser is only available for CR9114.</p></disp-quote><p>We are clarifying the amino acid identity on the violin plots in the data browser (will be completed prior to publication). We have also referred to the data browser in the legend of Figure 3 and in the Data Availability statement we specify that the browser is only available for CR9114 (we find that the smaller size of the CR6261 dataset makes the data browser less helpful).</p><disp-quote content-type="editor-comment"><p>Line 41: I think there are actually now a lot of broadly neutralizing antibodies, so I'm not sure how accurate &quot;a handful&quot; is here.</p></disp-quote><p>This language was chosen to reflect the rare frequency of bnAbs in natural repertoires. Upon review we agree that this is confusing and have changed this to ‘numerous’.</p><disp-quote content-type="editor-comment"><p>Line 70: &quot;less broad&quot; might be better than &quot;specific&quot; because even bNAbs are specific (for flu HA for instance) rather than &quot;sticky&quot; to everything.</p></disp-quote><p>We have made this change.</p><disp-quote content-type="editor-comment"><p>I had a hard time understanding the numbers in Figure 1A.</p></disp-quote><p>To clarify the numbering in Figure 1A we added lines to connect the residue number to the corresponding amino acid. This numbering is IMGT unique numbering, which is defined such that different receptors and chains can be easily compared. We have added a note to the figure caption regarding the numbering system.</p><disp-quote content-type="editor-comment"><p>I found Figure 1G confusing, mostly because I didn't (and still don't) really understand all the boxes with solid and dotted black lines labeled with various HAs.</p></disp-quote><p>We agree that the caption does not clearly explain Figure 1G and have added more detail to explain the insets.</p><disp-quote content-type="editor-comment"><p>Line 288-289: I think we can be virtually certain that the person wasn't infected with H9 since it's not a human virus subtype.</p></disp-quote><p>Although we agree that infection with H9 is unlikely, we also don’t wish to imply that we can definitely rule it out. We have adjusted the language to 'this breadth was likely acquired by chance’.</p><disp-quote content-type="editor-comment"><p>It would be useful to list the surface area each residue in the paratope for both antibodies contributes to binding where such information is available.</p></disp-quote><p>This information is not available in the published structural characterizations of these antibodies (Ekiert et al., 2009, Dreyfus et al., 2012), but we have calculated this using ChimeraX (Pettersen 2021) and find that it correlates well with our previous analysis of the number of proximal HA residues (both metrics are now available in Figure 2–source data 3). Because it is a more standard calculation, we decided to plot this contact surface area in Figure 2C and Figure 2—figure supplement 1 instead of the number of proximal HA residues, and we thank reviewers for this suggestion.</p><disp-quote content-type="editor-comment"><p>Is it possible to convert the effect scores into a free energy of binding contribution? Are there error estimates for the effect scores that would allow one to assess whether apparent differences in effect scores are statistically significant?</p></disp-quote><p>The –logK<sub>D</sub> values are directly proportional to DG<sub>binding</sub>, as DG = –RTlnK, and mutation coefficients are inferred from linear regression on these values. Thus effect scores (additive and epistatic) are directly proportional to changes in free energy of binding upon mutation. We have clarified this relationship in the main text. For all effect scores, the standard error, p-value, and 95% confidence interval resulting from ordinary least squares regression (with Bonferroni correction by the number of parameters) is provided in Figure 2–source data 1 (CR9114) and Figure 2–source data 2 (CR6261). In all figures, we either display effect score standard errors as error bars where possible (eg Figure 2A,B, Figure 3F) or we display only statistically significant effect scores (assessed as a Bonferroni-corrected p-value &lt; 0.05, eg Figure 2D,E, Figure 3A), as indicated in the respective captions.</p><disp-quote content-type="editor-comment"><p>Larger epistatic effect scores occur between residues with the largest contributions to binding. Is this expected?</p></disp-quote><p>This is not necessarily expected. In our datasets, this is often true but is not always the case, as illustrated by the strong third-order interaction between CR9114 mutations 57, 64, and 65, which have only weak individual effects (Figure 3E). We also do not expect this effect to arise as an artifact of our statistical inference approach, as we jointly infer coefficients at all orders for all sites.</p><disp-quote content-type="editor-comment"><p>The authors may consider changing &quot;CR-9114&quot; and &quot;CR-6261&quot; to &quot;CR9114&quot; and &quot;CR6261&quot;, respectively, which are the more commonly used nomenclatures for these two antibodies in the field.</p></disp-quote><p>We have made this change.</p><disp-quote content-type="editor-comment"><p>It is unclear to me which antibody numbering scheme (e.g. Kabat, Chothia, IMGT) is being used for numbering amino acid residues in this study. Also, naming a position as &quot;112.1&quot; in CR6261 seems a bit odd. Should that be &quot;112a&quot;?</p></disp-quote><p>This numbering is IMGT unique numbering, which is defined such that different receptors and chains can be easily compared. We have added a note to the figure caption regarding the numbering system.</p><disp-quote content-type="editor-comment"><p>In panel B of Figure 1—figure supplement 5, the correlation between Tite-Seq mean expression and isogenic expression fluorescence is quite high for CR9114 variants but low for CR6261 variants. Is there a reason for that discrepancy?</p></disp-quote><p>These specific variants were selected to span a wide range of –logK<sub>D</sub> to validate the Tite-Seq measurements with isogenic measurements. Across both CR9114 and CR6261 libraries, the variation in expression is quite modest and thus has relatively low correlation between replicate Tite-Seq measurements (Figure 1—figure supplement 5A) and with isogenic fluorescence measurements (Figure 1—figure supplement 5B). For this reason, and because the antibody sequences are displayed on yeast in an scFv format, we do not draw major conclusions from the expression data. We suspect that the higher correlation for CR9114 variants is related to the specific variants chosen, rather than a general feature of the CR9114 library (e.g. CR9114 S83F was one of the isogenic variants and has the strongest impact on expression; CR6261 S83F also has the strongest impact on expression but was not reconstructed for isogenic measurements). Still, we present these data to demonstrate that (1) scFv expression was not strongly impacted by sequence identity and that (2) some mutations have modest effects on expression that may be inversely correlated their impact on binding affinity (Figure 1—figure supplement 5E). The second point is statistically significant when examining all sequences in a given library (Figure 1—figure supplement 5E), and although we refrain from equating yeast scFv expression with antibody stability, this finding may be of interest to others in the protein evolution community and is generally consistent with other studies of protein evolution (Tokuriki and Tawfik 2009).</p><disp-quote content-type="editor-comment"><p>In lines 224-225, &quot;In contrast, a specific set of many mutations with strong synergistic interactions is required to bind H3, and to an even greater extent, influenza B&quot;. It is not very clear to me which analysis supports this claim. Can the authors clarify a bit?</p></disp-quote><p>We have added a reference to Figure 2A, which shows the nested sets of required mutations for binding H3 and influenza B, to support this claim more clearly.</p><disp-quote content-type="editor-comment"><p>In caption of Figure 5, while the meaning of &quot;R&quot; is described (random mixed scenario), the meaning of &quot;O&quot; and &quot;A&quot; should also be explained.</p></disp-quote><p>This has been added to the caption of Figure 5.</p><disp-quote content-type="editor-comment"><p>Among the somatic mutations in CR9114, I57S, K82I, and S83F are particularly important for binding to H3 (lines 182-183 and Figure 2D). Can the author provide a plausible structural explanation?</p></disp-quote><p>CR9114 binds H3 through the flexibility of its combining site, which enables it to make favorable interactions with different conformations of Trp21 and accommodate Asn49 as well as the Asn38 glycan in group 2 HAs (Dreyfus et al., 2012). Here, we find that K82I and S83F are important for binding H1, H3 and influenza B HA, which is likely due to hydrophobic interactions between these mutated residues and a conserved hydrophobic patch in HA. Similarly, we find that I57S is important for binding each antigen, though for H1 it only improves affinity in specific sequence backgrounds. I57S is in CDR2 of CR9114, and although the contact surface area with H3 is quite modest (Figure 2—figure supplement 1), it may enhance binding of CR9114 to H3 by reorienting neighboring residues in the CDR2 loop, which interacts directly with Trp21 and Asn49, and likely accommodates the glycan at Asn38. Because we do not have the co-crystal structure with the germline antibody, we can only speculate on the impact of each mutation and thus have added a brief plausible structural explanation to the text.</p><disp-quote content-type="editor-comment"><p>Similar to the comment above, it is interesting to see that T29P almost exclusively occurs as the first mutation under various selection scenarios (Figure 5J and Figure 5—figure supplement 3C-D). Can the author provide a plausible structural explanation?</p></disp-quote><p>T29P is the only single mutation that confers any detectable H1 binding affinity and is thus the most likely mutation to occur first in all selection models that begin with H1. Importantly, the affinity of this single mutant is only modestly improved relative to the germline sequence (–logK<sub>D</sub> = 7.53 +/- 0.04, compared to 7.0 +/- 0.0 for the germline). Still, this improvement is significant and reflects prior structural characterization of CR6261, which demonstrates that CDR1 (where T29P is located) makes extensive hydrogen bonding interactions with the A helix of HA2 (Ekiert et al., 2009). The contact area between Pro29 and HA are annotated in Figure 2C, and in the pathways analysis section of the results, we have added a sentence to clarify the strong preference for this mutation to occur first.</p></body></sub-article></article>