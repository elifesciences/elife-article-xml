<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">96129</article-id><article-id pub-id-type="doi">10.7554/eLife.96129</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.96129.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Mapping spatial patterns to energetic benefits in groups of flow-coupled swimmers</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Heydari</surname><given-names>Sina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8907-5751</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Hang</surname><given-names>Haotian</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5217-8124</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Kanso</surname><given-names>Eva</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0336-585X</contrib-id><email>kanso@usc.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03taz7m60</institution-id><institution>Department of Aerospace and Mechanical Engineering, University of Southern California</institution></institution-wrap><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03taz7m60</institution-id><institution>Department of Physics and Astronomy, University of Southern California</institution></institution-wrap><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Seldin</surname><given-names>Marcus M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Rutz</surname><given-names>Christian</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02wn5qz54</institution-id><institution>University of St Andrews</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>19</day><month>12</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP96129</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-02-14"><day>14</day><month>02</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-02-19"><day>19</day><month>02</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.02.15.580536"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-21"><day>21</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.96129.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-08-02"><day>02</day><month>08</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.96129.2"/></event></pub-history><permissions><copyright-statement>© 2024, Heydari, Hang et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Heydari, Hang et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-96129-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-96129-figures-v1.pdf"/><abstract><p>The coordinated motion of animal groups through fluids is thought to reduce the cost of locomotion to individuals in the group. However, the connection between the spatial patterns observed in collectively moving animals and the energetic benefits at each position within the group remains unclear. To address this knowledge gap, we study the spontaneous emergence of cohesive formations in groups of fish, modeled as flapping foils, all heading in the same direction. We show in pairwise formations and with increasing group size that (1) in side-by-side arrangements, the reciprocal nature of flow coupling results in an equal distribution of energy requirements among all members, with reduction in cost of locomotion for swimmers flapping inphase but an increase in cost for swimmers flapping antiphase, and (2) in inline arrangements, flow coupling is non-reciprocal for all flapping phase, with energetic savings in favor of trailing swimmers, but only up to a finite number of swimmers, beyond which school cohesion and energetic benefits are lost at once. We explain these findings mechanistically and we provide efficient diagnostic tools for identifying locations in the wake of single and multiple swimmers that offer opportunities for hydrodynamic benefits to aspiring followers. Our results imply a connection between the resources generated by flow physics and social traits that influence greedy and cooperative group behavior.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fish model</kwd><kwd>collective behavior</kwd><kwd>hydrodynamic benefits</kwd><kwd>swimming energetics</kwd><kwd>flow coupling</kwd><kwd>fluid-structure interactions</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IOS-2034043</award-id><principal-award-recipient><name><surname>Kanso</surname><given-names>Eva</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>CBET-210020</award-id><principal-award-recipient><name><surname>Kanso</surname><given-names>Eva</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000006</institution-id><institution>Office of Naval Research</institution></institution-wrap></funding-source><award-id>N00014-22-1-2655</award-id><principal-award-recipient><name><surname>Kanso</surname><given-names>Eva</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000006</institution-id><institution>Office of Naval Research</institution></institution-wrap></funding-source><award-id>N00014-19-1-2035</award-id><principal-award-recipient><name><surname>Kanso</surname><given-names>Eva</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Fish swimming in groups can either conserve or expend energy during collective movement, depending on their spatial position within the school.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Flow interactions are thought to allow flying and swimming animals to derive energetic benefits when moving in groups (<xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>). However, direct assessment of such benefits is challenging, chiefly because animal groups do not generally conform to regular patterns – individuals in these groups dynamically change their position relative to their neighbors (<xref ref-type="bibr" rid="bib75">Partridge and Pitcher, 1979</xref>; <xref ref-type="bibr" rid="bib86">Svendsen et al., 2003</xref>; <xref ref-type="bibr" rid="bib65">Marras et al., 2015</xref>; <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>; <xref ref-type="bibr" rid="bib67">Mirzaeinia et al., 2020</xref>). Also, because direct energetic measurements in moving animals, flying or swimming, are notoriously difficult and often unreliable as proxy for hydrodynamic energy savings (<xref ref-type="bibr" rid="bib37">Herskin and Steffensen, 1998</xref>; <xref ref-type="bibr" rid="bib52">Killen et al., 2012</xref>; <xref ref-type="bibr" rid="bib65">Marras et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib109">Zhang and Lauder, 2023a</xref>; <xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>; <xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>; <xref ref-type="bibr" rid="bib64">Marras and Porfiri, 2012</xref>). These difficulties hinder a direct mapping from the spatial pattern of the group to the energetic benefits or costs incurred at each position within the group.</p><p>An understanding of how the spatial arrangement of individuals within a group influences their cost of locomotion can provide insights into the evolution of social structures, resource allocation, and overall fitness of each individual in cooperative activities such as foraging, mating, and evasion (<xref ref-type="bibr" rid="bib106">Whitehead, 1997</xref>; <xref ref-type="bibr" rid="bib15">Couzin et al., 2002</xref>; <xref ref-type="bibr" rid="bib16">Couzin and Krause, 2003</xref>; <xref ref-type="bibr" rid="bib17">Croft et al., 2008</xref>; <xref ref-type="bibr" rid="bib6">Bajec and Heppner, 2009</xref>; <xref ref-type="bibr" rid="bib23">Farine and Whitehead, 2015</xref>; <xref ref-type="bibr" rid="bib47">Jiao et al., 2023</xref>). It could also guide the design of bio-inspired engineering systems and algorithms that steer groups of entities, such as swarms of autonomous robotic vehicles, underwater or in flight, that collaborate to achieve a desired task while minimizing energy consumption and improving the overall system efficiency (<xref ref-type="bibr" rid="bib58">Leonard and Fiorelli, 2001</xref>; <xref ref-type="bibr" rid="bib112">Zhu et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Coppola et al., 2020</xref>; <xref ref-type="bibr" rid="bib60">Li et al., 2021</xref>; <xref ref-type="bibr" rid="bib8">Berlinger et al., 2021</xref>).</p><p>To understand the potential energetic benefits of group movement, various direct and indirect approaches have been employed. <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>, associated energy savings in pairs of flapping robotic swimmers with a linear relationship between their flapping phase lag and relative distance. Based on this, a strategy, called <italic>vortex phase matching</italic>, was extrapolated for how fish should behave to maximize hydrodynamic benefits: a follower fish should match its tailbeat phase with the local vorticity created by a leader fish. Pairs of freely swimming fish seemed to follow this linear phase-distance relationship even with impaired vision and lateral line sensing, i.e., in the absence of sensory cues about their relative position and neighbor-generated flows. Interestingly, the same linear phase-distance relationship was uncovered independently in flapping hydrofoils and accredited solely to flow interactions (<xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>). It is therefore unclear whether vortex phase matching is an active strategy, mediated by sensing and feedback control, that fish employ to minimize energy expenditure, or if it arises passively through flow interactions between flapping swimmers. Importantly, active or passive, it is unclear if this strategy scales to groups larger than two.</p><p>In an effort to directly gauge the energetic benefits of schooling, metabolic energetic measurements were recently performed in solitary and groups of eight fish, and impressive energetic savings were attributed to schooling compared to solitary swimming when the fish were challenged to swim at high speeds (<xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>). Lamentably, the study made no mention of the spatial patterns assumed by these physically thwarted individuals (<xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>). In an independent previous study (<xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>), changes in spatial patterns and tailbeat frequencies were reported in similar experiments, albeit with no energetic measurements. Specifically, <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>, showed that, when challenged to sustain higher swimming speeds, the fish in a group rearranged themselves in a side-by-side pattern as the speed increased, presumably to save energy.</p><p>Taking together the results of <xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>; <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>, are we to conclude that side-by-side formations are more energetically beneficial than, say, inline or diagonal formations? The answer is not simple! The metabolic measurements of <xref ref-type="bibr" rid="bib65">Marras et al., 2015</xref>, in a school of eight fish report that side-by-side formations, though beneficial, produce the least energetic savings compared to diagonal formations (<xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>). In an experimental study of a single fish interacting with a robotic flapping foil, the freely swimming fish positioned itself in an inline formation in the wake of the flapping foil, supporting the hypothesis that swimming in the wake of one another is an advantageous strategy to save energy in a school (<xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>). Why did the fish in the experiments of <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>, self-organize in a side-by-side formation when challenged to swim at higher swimming speeds?</p><p>The answer is not simple because ample hydrodynamic mechanisms for energy savings in fish schools have been stipulated for each possible configuration – side-by-side, inline, and diagonal (see, e.g., Figure 1 of <xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>) – but no assessment is provided of the relative advantage of these configurations. For example, side-by-side formations, where fish mirror each other by flapping antiphase, are thought to create a wall-like effect that reduces swimming cost (<xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>; <xref ref-type="bibr" rid="bib25">Fish and Hui, 1991</xref>). A fish swimming in the wake between two leading fish encounters a reduced oncoming velocity, leading to reduced drag and thrust production (<xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>). Inline formations, where fish swim in tandem, are thought to provide benefits to both leader and follower, by an added mass push from follower to leader (<xref ref-type="bibr" rid="bib25">Fish and Hui, 1991</xref>; <xref ref-type="bibr" rid="bib97">Usherwood et al., 2011</xref>) and a reduced pressure on the follower (<xref ref-type="bibr" rid="bib54">Kurt and Moored, 2018</xref>). All of these mechanisms can in principle be exploited by schooling fish as they dynamically change their relative spacing in the group. But are these mechanisms equally advantageous? Or is there a hierarchy of hydrodynamic benefits depending on the relative position within the school? The literature offers no comparative analysis of the energetic savings afforded by each of these configurations.</p><p>The study of <xref ref-type="bibr" rid="bib65">Marras et al., 2015</xref>, is arguably the closest to addressing this question, but, to map the energetic benefits for pairwise configurations, the authors employed statistical averages in a school of eight fish, thus inevitably combining the various hydrodynamic mechanisms at play and cross-polluting the estimated benefits of each configuration. A cleaner analysis in pairs of flapping foils shows that these relative positions – side-by-side, inline, and diagonal – all emerge spontaneously and stably due to flow interactions (<xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>), but provides no method for estimating the energetic requirements of these formations, let alone comparing them energetically. Even vortex phase matching makes no distinction between side-by-side, inline, or diagonal pairs of fish (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>). It simply postulates that an unknown amount of energetic benefit is acquired when the linear phase-distance relationship is satisfied. Thus, to date, despite the widespread notion that group movement saves energy, a direct comparison of the energetic savings afforded by different spatial formations remains lacking. Importantly, it is unknown whether and how the postulated benefits scale with increasing group size.</p><p>Here, to circumvent the challenges of addressing these questions in biological systems, we formulate computational models that capture the salient hydrodynamic features of single and pairs of swimming fish. Namely, we represent each fish as a freely swimming hydrofoil undergoing pitching oscillations about its leading edge. A single flapping hydrofoil shares many hydrodynamic aspects with its biological counterpart, including an alternating, long-lived pattern of vorticity in its wake (<xref ref-type="bibr" rid="bib90">Triantafyllou et al., 1993</xref>; <xref ref-type="bibr" rid="bib91">Triantafyllou et al., 2000</xref>; <xref ref-type="bibr" rid="bib56">Lauder et al., 2011</xref>; <xref ref-type="bibr" rid="bib100">Verma et al., 2017</xref>; <xref ref-type="bibr" rid="bib83">Smits, 2019</xref>). These similarities have been demonstrated repeatedly, within biologically relevant ranges of flapping parameters (<xref ref-type="bibr" rid="bib90">Triantafyllou et al., 1993</xref>; <xref ref-type="bibr" rid="bib88">Taylor et al., 2003</xref>), for different geometries (<xref ref-type="bibr" rid="bib103">Von Ellenrieder et al., 2003</xref>; <xref ref-type="bibr" rid="bib87">Taira and Colonius, 2009</xref>; <xref ref-type="bibr" rid="bib28">Green et al., 2011</xref>; <xref ref-type="bibr" rid="bib5">Ayancik et al., 2019</xref>), material properties (<xref ref-type="bibr" rid="bib69">Moored et al., 2014</xref>; <xref ref-type="bibr" rid="bib79">Quinn et al., 2014</xref>; <xref ref-type="bibr" rid="bib5">Ayancik et al., 2019</xref>), and flapping kinematics (<xref ref-type="bibr" rid="bib94">Tytell and Lauder, 2004</xref>; <xref ref-type="bibr" rid="bib51">Kern and Koumoutsakos, 2006</xref>; <xref ref-type="bibr" rid="bib44">Hultmark et al., 2007</xref>). In this study, we show, based on our own simulations and by conducting a thorough literature survey, that flow interactions, with no sensing and feedback control, lead to emergent formations that preserve the linear phase-distance relationship uncovered independently in live and robotic fish (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>) and in flapping hydrofoils (<xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>). This relationship is preserved irrespective of geometry (<xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>), material properties (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>; <xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref>; <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>; <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>), and flapping kinematics (<xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>; <xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>). The universality of this relationship serves as strong validation of our models and anchors our subsequent exploration of the opportunities for hydrodynamic benefits available in a given flow field.</p><p>Importantly, we go beyond two swimmers to investigate flow interactions in larger groups and find that inline formations <italic>differentially</italic> distribute hydrodynamic savings to members within the school, favoring trailing swimmers, but only up to a certain school size, while side-by-side formations <italic>equally</italic> distribute hydrodynamic savings and scale to arbitrary number of swimmers without loss of cohesion. Our findings provide a direct mapping from the school’s spatial pattern to the energetic savings experienced by its members. Importantly, our results raise an interesting hypothesis that the dynamic repositioning of members within a fish school could be driven by greed and competition to occupy hydrodynamically advantageous positions and open up opportunities for analyzing the role of flow physics in the evolution of cooperative versus greedy behavior in animal groups.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Mathematical models of flow-coupled flapping swimmers</title><p>Inspired by the experiments of <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>, we study self-organization in the context of flapping swimmers, coupled passively via the fluid medium, with no mechanisms for visual (<xref ref-type="bibr" rid="bib66">McKee et al., 2020</xref>; <xref ref-type="bibr" rid="bib33">Guthrie, 1986</xref>; <xref ref-type="bibr" rid="bib24">Fernald, 1989</xref>; <xref ref-type="bibr" rid="bib20">Douglas and Djamgoz, 2012</xref>; <xref ref-type="bibr" rid="bib62">Lombana and Porfiri, 2022</xref>), flow sensing (<xref ref-type="bibr" rid="bib21">Engelmann et al., 2000</xref>; <xref ref-type="bibr" rid="bib81">Ristroph et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Colvert and Kanso, 2016</xref>; <xref ref-type="bibr" rid="bib35">Hang et al., 2023</xref>), or feedback control (<xref ref-type="bibr" rid="bib101">Verma et al., 2018</xref>; <xref ref-type="bibr" rid="bib46">Jiao et al., 2021</xref>; <xref ref-type="bibr" rid="bib60">Li et al., 2021</xref>; <xref ref-type="fig" rid="fig1">Figure 1</xref>). The swimmers are rigid, of finite body length <inline-formula><mml:math id="inf1"><mml:mi>L</mml:mi></mml:math></inline-formula> and mass per unit depth <inline-formula><mml:math id="inf2"><mml:mi>m</mml:mi></mml:math></inline-formula>, and undergo pitching oscillations of identical amplitude <inline-formula><mml:math id="inf3"><mml:mi>A</mml:mi></mml:math></inline-formula> and frequency <inline-formula><mml:math id="inf4"><mml:mi>f</mml:mi></mml:math></inline-formula> in the <inline-formula><mml:math id="inf5"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-plane of motion, such that the pitching angle for swimmer <inline-formula><mml:math id="inf6"><mml:mi>j</mml:mi></mml:math></inline-formula> is given by <inline-formula><mml:math id="inf7"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mo>…</mml:mo><mml:mo separator="true">,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf9"><mml:mi>N</mml:mi></mml:math></inline-formula> is the total number of swimmers. In pairwise interaction, we set <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf12"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> being the phase lag between the oscillating pair. We fixed the lateral distance <inline-formula><mml:math id="inf13"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> between the swimmers to lie in the range <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mi>L</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>L</mml:mi><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, and allowed the swimmers to move freely in the <inline-formula><mml:math id="inf15"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction in an unbounded two-dimensional fluid domain of density <inline-formula><mml:math id="inf16"><mml:mi>ρ</mml:mi></mml:math></inline-formula> and viscosity <italic>μ</italic>.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Flow-coupled swimmers self-organize into stable pairwise formations.</title><p>(<bold>A</bold>) Inline (<inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>B</bold>) diagonal (<inline-formula><mml:math id="inf18"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>C</bold>) inphase side-by-side (<inline-formula><mml:math id="inf19"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and (<bold>D</bold>) antiphase side-by-side (<inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>) in computational fluid dynamics (CFD) (left) and vortex sheet (VS) (right) simulations. Power savings at steady state relative to respective solitary swimmers are reported in <xref ref-type="fig" rid="fig3">Figure 3</xref>. Parameter values are <inline-formula><mml:math id="inf21"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, Re = <inline-formula><mml:math id="inf22"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>1645</mml:mn></mml:mrow></mml:math></inline-formula> in CFD, and <inline-formula><mml:math id="inf23"><mml:mrow><mml:mi>f</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn></mml:mrow></mml:math></inline-formula> in VS simulations. Corresponding hydrodynamic moments are given in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>. Simulations at different Reynolds numbers and dissipation times are given in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref>–<xref ref-type="fig" rid="fig1s3">3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Computational fluid dynamics (CFD) simulations of pairwise formations.</title><p>Vorticity field (left column) and flow agreement parameter <inline-formula><mml:math id="inf24"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> (right column) in the wake of a pair of inline and inphase swimmers Reynolds number <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Re</mml:mtext><mml:mo>=</mml:mo><mml:mn>206</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<bold>A</bold>), 308 (<bold>B</bold>), 411 (<bold>C</bold>), 1645 (<bold>D</bold>), respectively. The pitching amplitude of leader and follower is set to <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, except in (<bold>A</bold>), where the follower is pitching at <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn><mml:mi>.</mml:mi><mml:msup><mml:mn>5</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Vortex sheet (VS) simulations of pairwise formations.</title><p>Snapshots of the swimmers (left column) and flow agreement parameter <inline-formula><mml:math id="inf28"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> (right column) in the wake of a pair of swimmers in the VS model for dissipation time <inline-formula><mml:math id="inf29"><mml:mrow><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<bold>A</bold>), <inline-formula><mml:math id="inf30"><mml:mrow><mml:mn>3.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<bold>B</bold>), <inline-formula><mml:math id="inf31"><mml:mrow><mml:mn>4.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<bold>C</bold>), and <inline-formula><mml:math id="inf32"><mml:mrow><mml:mn>9.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>(<bold>D</bold>), respectively. The pitching amplitude is set to <inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, and the pitching frequency to <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Computational fluid dynamics (CFD) and vortex sheet (VS) simulations at various flow properties.</title><p>(<bold>A</bold>) Separation distance versus time in a pair of swimmers in the CFD model for five values of Reynolds numbers <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mtext>Re</mml:mtext><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>206</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>308</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>411</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>822</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>1645</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). (<bold>B</bold>) Separation distance versus time in a pair of swimmers in the VS model for five values of dissipation time <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>3.45</mml:mn><mml:mi>T</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>4.45</mml:mn><mml:mi>T</mml:mi><mml:mo separator="true">,</mml:mo><mml:mn>9.45</mml:mn><mml:mi>T</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Separation distance <inline-formula><mml:math id="inf37"><mml:mi>d</mml:mi></mml:math></inline-formula> is normalized by swimming speed <inline-formula><mml:math id="inf38"><mml:mi>U</mml:mi></mml:math></inline-formula> for each cases, respectively. In (<bold>A</bold>, <bold>B</bold>), the swimmers stabilize near <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The pitching amplitude of leader and follower is set to <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, except in <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mtext>Re</mml:mtext><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>206</mml:mn></mml:mrow></mml:math></inline-formula> , where the follower is pitching at <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn><mml:mi>.</mml:mi><mml:msup><mml:mn>5</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to avoid collision.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>Hydrodynamic moment acting on pairs of flapping swimmers.</title><p>(<bold>A</bold>) Inline (<inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>B</bold>) diagonal (<inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), (<bold>C</bold>) inphase side-by-side (<inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and (<bold>D</bold>) antiphase side-by-side (<inline-formula><mml:math id="inf46"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo separator="true">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>) in computational fluid dynamics (CFD) (left) and vortex sheet (VS) (right) simulations. For each simulation, we show the active torque <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> exerted by the swimmers after a time <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, ensuring that steady state has been reached. The non-reciprocity in the effects of leader on follower in inline and diagonal configuration is apparent. In the side-by-side configurations, a simple shift of the data in the inphase flapping case and a simple mirror symmetry in the antiphase flapping case would show that flow coupling is reciprocal.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig1-figsupp4-v1.tif"/></fig></fig-group><p>When unconstrained, the swimmers may drift laterally relative to each other, as illustrated in dipole models (<xref ref-type="bibr" rid="bib92">Tsang and Kanso, 2013</xref>; <xref ref-type="bibr" rid="bib50">Kanso and Cheng Hou Tsang, 2014</xref>) and high-fidelity simulations of undulating swimmers (<xref ref-type="bibr" rid="bib27">Gazzola et al., 2014</xref>; <xref ref-type="bibr" rid="bib101">Verma et al., 2018</xref>). However, this drift occurs at a slower time scale than the swimming motion, and can, in principle, be corrected by separate feedback control mechanisms (<xref ref-type="bibr" rid="bib113">Zhu et al., 2022</xref>). Here, we focus on the dynamics in the swimming direction.</p><p>Hereafter, all parameters are scaled using the body length <inline-formula><mml:math id="inf49"><mml:mi>L</mml:mi></mml:math></inline-formula> as the characteristic length scale, flapping period <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> as the characteristic time scale, and <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>ρ</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> as the characteristic mass per unit depth. Accordingly, velocities are scaled by <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>L</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>, forces by <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>ρ</mml:mi><mml:msup><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>L</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, moments by <inline-formula><mml:math id="inf54"><mml:mrow><mml:mi>ρ</mml:mi><mml:msup><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>L</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, and power by <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>ρ</mml:mi><mml:msup><mml:mi>f</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>L</mml:mi><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The equations governing the free motion <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of swimmer <inline-formula><mml:math id="inf57"><mml:mi>j</mml:mi></mml:math></inline-formula> are given by Newton’s second law (here, the downstream direction is positive),<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The hydrodynamic forces on swimmer <inline-formula><mml:math id="inf58"><mml:mi>j</mml:mi></mml:math></inline-formula> are decomposed into a pressure force <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> acting in the direction normal to the swimmer and a viscous drag force <inline-formula><mml:math id="inf60"><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> acting tangentially to the swimmer. These forces depend on the fluid motion, which, in turn, depends on the time history of the states of the swimmers.</p><p>To maintain their pitching motions, swimmers exert an active moment <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> about the leading edge, whose value is obtained from the balance of angular momentum. The hydrodynamic power <inline-formula><mml:math id="inf62"><mml:mi>P</mml:mi></mml:math></inline-formula> expended by a flapping swimmer is given by <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false" class="tml-capshift" style="math-style:normal;math-depth:0;">˙</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p><p>To compute the hydrodynamic forces and swimmers’ motion, we used two fluid models (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref>–<xref ref-type="fig" rid="fig1s3">3</xref>). First, we employed a computational fluid dynamics (CFD) solver of the Navier-Stokes equations tailored to resolving fluid-structure interactions (FSI) based on an adaptive mesh implementation of the immersed boundary method (IBM) (<xref ref-type="bibr" rid="bib45">IBAMR, 2024</xref>; <xref ref-type="bibr" rid="bib30">Griffith et al., 2007</xref>; <xref ref-type="bibr" rid="bib9">Bhalla et al., 2013</xref>). Then, we solved the same FSI problem, in the limit of thin swimmers, using the more computationally efficient inviscid vortex sheet (VS) model (<xref ref-type="bibr" rid="bib72">Nitsche and Krasny, 1994</xref>; <xref ref-type="bibr" rid="bib42">Huang et al., 2016</xref>; <xref ref-type="bibr" rid="bib43">Huang et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>; <xref ref-type="bibr" rid="bib34">Hang et al., 2022</xref>). To emulate the effect of viscosity in the VS model, we allowed shed vorticity to decay after a dissipation time <inline-formula><mml:math id="inf64"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>; larger <inline-formula><mml:math id="inf65"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> correlates with larger Reynolds number Re in the Navier-Stokes model; see SI for a brief overview of the numerical implementation and validation of both methods.</p></sec><sec id="s2-2"><title>Flow coupling leads to stable emergent formations</title><p>We found, in both CFD and VS models, that pairs of swimmers self-organize into relative equilibria at a streamwise separation distance <inline-formula><mml:math id="inf66"><mml:mi>d</mml:mi></mml:math></inline-formula> that is constant on average, and swim together as a single formation at an average free-swimming speed <inline-formula><mml:math id="inf67"><mml:mi>U</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig2">2</xref>). We distinguished four types of relative equilibria: inline, diagonal, side-by-side inphase, and side-by-side antiphase (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="video" rid="video1">Video 1</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Emergent equilibria in pairwise formations.</title><p>(<bold>A</bold>) Time evolution of scaled streamwise separation distance <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> for a pair of inline swimmers at <inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Depending on initial conditions, the swimmers converge to one of two equilibria at distinct separation distance. (<bold>B</bold>) At <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> changes slightly compared to inline swimming in (A). Importantly, a new side-by-side inphase equilibrium is now possible where the swimmers flap together at a slight shift in the streamwise direction. (<bold>C</bold>) Starting from the first equilibrium in (A), <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> increases linearly as we increase the phase lag <inline-formula><mml:math id="inf73"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> between the swimmers.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig2-v1.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-96129-video1.mp4" id="video1"><label>Video 1.</label><caption><title>Pairs of flow-coupled swimmers self-organize into stable inline, staggered, or side-by-side formation.</title><p>Energetic benefits depend on the spatial pattern. Results based on flapping foils in computational fluid dynamics (CFD) simulations.</p></caption></media><p>Inline formations at <inline-formula><mml:math id="inf74"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> arise when the follower positions itself, depending on its initial distance from the leader, at one of many inline equilibria, each with its own basin of attraction (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). These inline equilibria occur at average spacing <inline-formula><mml:math id="inf75"><mml:mi>d</mml:mi></mml:math></inline-formula> that is approximately an integer multiple of <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, consistent with previous experimental (<xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>) and numerical (<xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref>; <xref ref-type="bibr" rid="bib74">Park and Sung, 2018</xref>; <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>; <xref ref-type="bibr" rid="bib18">Dai et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>; <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>) findings.</p><p>When offsetting the swimmers laterally at <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), the leader-follower equilibria that arise at <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> shift slightly but persist, giving rise to diagonal leader-follower equilibria (<xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>). Importantly, at a lateral offset <inline-formula><mml:math id="inf79"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, inphase swimmers (<inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) that are initially placed side-by-side reach a relative equilibrium where they travel together at a close, but non-zero, average spacing <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. That is, a perfect side-by-side configuration of inphase flapping swimmers is unstable but the more commonly observed configuration (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>) where the two swimmers are slightly shifted relative to each other is stable. This configuration is fundamentally distinct in terms of cost of transport from the mirror-symmetric side-by-side configuration that arises when flapping antiphase at <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Both side-by-side equilibria were observed experimentally in heaving hydrofoils (<xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>), albeit with no assessment of the associated hydrodynamic power and cost of transport.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Hydrodynamic benefits and linear phase-distance relationship in pairwise formations.</title><p>(<bold>A</bold>) Change in cost of transport compared to solitary swimmers for the inline, diagonal, side-by-side inphase, and side-by-side antiphase formations shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. (<bold>B</bold>) Emergent formations in pairs of swimmers in computational fluid dynamics (CFD) and vortex sheet (VS) models satisfy a linear phase-distance relationship, consistent with experimental (<xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>; <xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>) and numerical (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>; <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>; <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>) studies. With the exception of the antiphase side-by-side formation, swimmers in these formations have a reduced average cost of transport compared to solitary swimming.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig3-v1.tif"/></fig><p>We next examined the effect of varying the phase <inline-formula><mml:math id="inf83"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> on the emergent traveling formations. Starting from initial conditions so as to settle on the first equilibrium <inline-formula><mml:math id="inf84"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>≈</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> when <inline-formula><mml:math id="inf85"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and increasing <inline-formula><mml:math id="inf86"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, we found, in both CFD and VS simulations, that the spacing <inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> at equilibrium increased with increasing <inline-formula><mml:math id="inf88"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). This increase is linear, as evident when plotting <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf90"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Indeed, in <xref ref-type="fig" rid="fig3">Figure 3B</xref>, we plotted the emergent average separation distance <inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf92"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> for various values of <inline-formula><mml:math id="inf93"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>. Except for the antiphase side-by-side formation, the linear phase-distance relationship <inline-formula><mml:math id="inf94"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>∝</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> persisted for <inline-formula><mml:math id="inf95"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The key observation, that pairs of flapping swimmers passively self-organize into equilibrium formations, is independent of both scale and fluid model. In our CFD simulations (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s3">3</xref>), we tested a range of Reynolds number <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi>U</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> from 200 to 2000, which covers the entire range of existing CFD simulations (<xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>), where Re ∼<italic>O</italic>(10<sup>2</sup>), and experiments (<xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>), where Re ∼<italic>O</italic>(10<sup>3</sup>). In our VS simulations, we varied <inline-formula><mml:math id="inf97"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from <inline-formula><mml:math id="inf98"><mml:mrow><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf99"><mml:mi>∞</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplements 2</xref> and <xref ref-type="fig" rid="fig1s3">3</xref>). Note that the separation distance <inline-formula><mml:math id="inf100"><mml:mi>d</mml:mi></mml:math></inline-formula> is scale-specific and increases with Re; at low Re, a compact inline formation is reached where the two swimmers ‘tailgate’ each other, as observed in <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>. However, the scaled separation distance <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> remains nearly constant for all Re and <inline-formula><mml:math id="inf102"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>).</p><p>The fact that these equilibria emerge in time-forward simulations is indicative of stability (<xref ref-type="bibr" rid="bib85">Strogatz, 1994</xref>). A more quantitative measure of linear stability can be obtained numerically by perturbing each equilibrium, either by applying a small impulsive or step force after steady state is reached (<xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>) or by directly applying a small perturbation to the relative equilibrium distance between the two swimmers and examining the time evolution of <inline-formula><mml:math id="inf103"><mml:mi>d</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:mi>F</mml:mi></mml:math></inline-formula> to quantify variations in hydrodynamic force <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula> as a function of signed variations in distance <inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> from the equilibrium (<xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>). In either case, we found that the force-displacement response to small perturbations at each equilibrium exhibited the basic features of a linear spring-mass system, where <inline-formula><mml:math id="inf107"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mi>/</mml:mi><mml:mi>δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> is negative, indicating that the hydrodynamic force acts locally as a restoring spring force that causes the initial perturbation to decay and that stabilizes the two swimmers together at their equilibrium relative position. Larger values of <inline-formula><mml:math id="inf108"><mml:mrow><mml:mi>|</mml:mi><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mi>/</mml:mi><mml:mi>δ</mml:mi><mml:mi>d</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> imply faster linear convergence to the stable equilibrium and thus stronger cohesion of the pairwise formation. Results of this quantitative stability analysis are discussed in subsequent sections.</p></sec><sec id="s2-3"><title>Emergent formations save energy compared to solitary swimming</title><p>We evaluated the hydrodynamic advantages associated with these emergent formations by computing the hydrodynamic power <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>P</mml:mi><mml:mtext>single</mml:mtext></mml:msub></mml:math></inline-formula> of a solitary swimmer and <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> of swimmer <inline-formula><mml:math id="inf111"><mml:mi>j</mml:mi></mml:math></inline-formula> in a formation of <inline-formula><mml:math id="inf112"><mml:mi>N</mml:mi></mml:math></inline-formula> swimmers.</p><p>We calculated the cost of transport <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, of swimmer <inline-formula><mml:math id="inf114"><mml:mi>j</mml:mi></mml:math></inline-formula> and the change in COT compared to solitary swimming <inline-formula><mml:math id="inf115"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mtext>COT</mml:mtext><mml:mtext>j</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mtext>COT</mml:mtext><mml:mtext>single</mml:mtext></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mtext>COT</mml:mtext><mml:mtext>j</mml:mtext></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>/</mml:mi><mml:msub><mml:mtext>COT</mml:mtext><mml:mtext>single</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). We also calculated the average change in cost of transport <inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mtext>COT</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="true">∑</mml:mo><mml:mi>j</mml:mi><mml:mi>N</mml:mi></mml:munderover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mtext>COT</mml:mtext><mml:mi>j</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> for each formation (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). In all cases, except for the antiphase side-by-side formation, in both CFD and VS simulations, the swimmers traveling in equilibrium formations save power and cost of transport compared to solitary swimming. The savings are larger at tighter lateral spacing <inline-formula><mml:math id="inf117"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>.</p><p>For inline and diagonal formations, these hydrodynamic benefits are granted entirely to the follower, whose hydrodynamic savings can be as high as 60% compared to solitary swimming (<xref ref-type="fig" rid="fig3">Figure 3A</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>). Intuitively, because in 2D flows, vortex-induced forces decay with the inverse of the square of the distance from the vortex location, flow coupling between the two inline or diagonal swimmers is non-reciprocal; the follower positioned in or close to the leader’s wake interacts more strongly with that wake than the leader interaction with the follower’s wake (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1A, B</xref> and <xref ref-type="fig" rid="fig1s4">4A, B</xref>).</p><p>In side-by-side formations, by symmetry, flow coupling between the two swimmers is reciprocal, or nearly reciprocal in inphase flapping (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1C, D</xref> and <xref ref-type="fig" rid="fig1s4">4C, D</xref>). Thus, hydrodynamics benefits or costs are expected to be distributed equally between the two swimmers. Indeed, for inphase flapping, the hydrodynamic benefits are shared equally between both swimmers. For antiphase flapping the cost is also shared equally (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><p>The biased distribution of benefits in favor of the follower in inline and diagonal formations could be a contributing factor to the dynamic nature of fish schools (<xref ref-type="bibr" rid="bib86">Svendsen et al., 2003</xref>; <xref ref-type="bibr" rid="bib67">Mirzaeinia et al., 2020</xref>). The egalitarian distribution of benefits in the inphase side-by-side formation could explain the abundance of this pairwise configuration in natural fish populations (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>) and why groups of fish favor this configuration when challenged to swim at higher speeds (<xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>; <xref ref-type="bibr" rid="bib62">Lombana and Porfiri, 2022</xref>).</p></sec><sec id="s2-4"><title>Linear phase-distance relationship in emergent formations is universal</title><p>To probe the universality of the linear phase-distance relationship, we compiled, in addition to our CFD and VS results, a set of experimental (<xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>) and numerical (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>; <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>; <xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>; <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>) data from the literature (<xref ref-type="table" rid="table1">Table 1</xref>). Data including CFD simulations of deformable flapping flags (✩) (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>), (❏) (<xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref>) and flexible airfoil with low aspect ratio (<inline-formula><mml:math id="inf118"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:citesymbol;">▹</mml:mo></mml:mrow></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>), physical experiments with heaving (<inline-formula><mml:math id="inf119"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:citesymbol;">◯</mml:mo></mml:mrow></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>) and pitching (<inline-formula><mml:math id="inf120"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:citesymbol;">▽</mml:mo></mml:mrow></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>) rigid hydrofoils, fish-foil interactions (<inline-formula><mml:math id="inf121"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:citesymbol;">*</mml:mo></mml:mrow></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>), and fish-fish interactions (<inline-formula><mml:math id="inf122"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:citesymbol;">△</mml:mo></mml:mrow></mml:math></inline-formula>) measured in pairs of both intact and visually and/or lateral line-impaired live fish (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>) are superimposed on <xref ref-type="fig" rid="fig3">Figure 3B</xref>. All data collapsed onto the linear phase-distance relationship <inline-formula><mml:math id="inf123"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>∝</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, with the largest variability exhibited by live fish with close streamwise distance, where the interaction between fish bodies may play a role. The side-by-side inphase formations trivially satisfy this linearity because <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>≈</mml:mo><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, but the side-by-side antiphase formations don’t satisfy; in the latter, <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> while <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Data collection from published literature.</title><p>We calculated the Reynolds numbers based on swimming speed (<inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) and flapping velocity (<inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>ρ</mml:mi><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), where <inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is the flapping frequency. Missing values are either not applicable or not available.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reference</th><th align="left" valign="bottom">Study type</th><th align="left" valign="bottom">System</th><th align="left" valign="bottom">Distance</th><th align="left" valign="bottom">Phase</th><th align="left" valign="bottom">Re<sub>U</sub></th><th align="left" valign="bottom">Re<sub><italic>A</italic></sub></th></tr></thead><tbody><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Flapping flags</td><td align="left" valign="bottom">Head-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">200<break/> –400</td><td align="left" valign="bottom">–</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib111">Zhu et al., 2014</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Heaving flexible foils</td><td align="left" valign="bottom">–</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">500</td><td align="left" valign="bottom">200</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Heaving foils</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">10<sup>3</sup><break/>–10<sup>4</sup></td><td align="left" valign="bottom">10<sup>2</sup><break/>–10<sup>3</sup></td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Heaving flexible foils</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">509</td><td align="left" valign="bottom">200</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Heaving foils</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">10<sup>3</sup><break/> –10<sup>4</sup></td><td align="left" valign="bottom">10<sup>2</sup><break/> –10<sup>3</sup></td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib59">Li et al., 2020</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Goldfish</td><td align="left" valign="bottom">Head-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">10<sup>5</sup></td><td align="left" valign="bottom">10<sup>4</sup></td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Pitching foils</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf136"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">9950</td><td align="left" valign="bottom">18,850</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Heaving plates</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf137"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">–</td><td align="left" valign="bottom">–</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">Pitching plates</td><td align="left" valign="bottom">Head-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf138"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">–</td><td align="left" valign="bottom">–</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Heaving flexible foils (3D)</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf139"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">176</td><td align="left" valign="bottom">200</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Fish-foil interactions</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">20·10<sup>3</sup> (foil)</td><td align="left" valign="bottom">50·10<sup>3</sup> (foil)</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom">40·10<sup>3</sup> (fish)</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref><xref ref-type="table-fn" rid="table1fn1">*</xref></td><td align="left" valign="bottom">Experimental</td><td align="left" valign="bottom">Heaving foils</td><td align="left" valign="bottom">Tail-to-head</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula><break/>,<inline-formula><mml:math id="inf142"><mml:mi>π</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">–</td><td align="left" valign="bottom">10<sup>2</sup><break/> –10<sup>4</sup></td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib74">Park and Sung, 2018</xref><xref ref-type="table-fn" rid="table1fn1">*</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Heaving flexible foils</td><td align="left" valign="bottom">–</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="bottom">60<break/> –1100</td><td align="left" valign="bottom">100<break/> –1200</td></tr><tr><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib18">Dai et al., 2018</xref><xref ref-type="table-fn" rid="table1fn1">*</xref></td><td align="left" valign="bottom">Numerical</td><td align="left" valign="bottom">Pitching + heaving foils</td><td align="left" valign="bottom">–</td><td align="left" valign="bottom"><inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula><break/>,<inline-formula><mml:math id="inf145"><mml:mi>π</mml:mi></mml:math></inline-formula></td><td align="left" valign="bottom">440</td><td align="left" valign="bottom">600</td></tr></tbody></table><table-wrap-foot><fn id="table1fn1"><label>*</label><p>Data not included in <xref ref-type="fig" rid="fig3">Figure 3</xref>.</p></fn></table-wrap-foot></table-wrap><p>These findings strongly indicate that flow-coupled flapping swimmers passively organize into stable traveling equilibrium formations with linear phase-distance relationship. This relationship is independent of the geometric layout (inline versus laterally offset swimmers), flapping kinematics (heaving versus pitching), material properties (rigid versus flexible), tank geometry (rotational versus translational), fidelity of the fluid model (CFD versus VS versus particle model), and system (biological versus robotic, 2D versus 3D). Observations that are robust across such a broad range of systems are expected to have common physical and mechanistic roots that transcend the particular set-up or system realization.</p><p>Importantly, this universal relationship indicates that flow physics passively positions a swimmer at locations <inline-formula><mml:math id="inf146"><mml:mi>d</mml:mi></mml:math></inline-formula> where the swimmer’s flapping phase <inline-formula><mml:math id="inf147"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> matches the local phase of the wake <inline-formula><mml:math id="inf148"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>wake</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, such that the effective phase <inline-formula><mml:math id="inf149"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>eff</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>wake</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is zero. Importantly, because the quantity <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is nearly equal to the wavelength of the wake of a solitary swimmer, the phase <inline-formula><mml:math id="inf151"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>wake</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is practically equal to the phase of a solitary leader. These observations have two major implications. First, they are consistent with the vortex phase matching introduced in <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>, as a strategy by which fish maximize hydrodynamic benefits. However, they proffer that vortex phase matching is an outcome of passive flow interactions among flapping swimmers, and not necessarily an active strategy implemented by fish via sensing and feedback mechanisms. Second, they led us to hypothesize that emergent side-by-side formations can be predicted from symmetry arguments, while emergent inline and diagonal formations can be predicted entirely from kinematic considerations of the leader’s wake without considering two-way flow coupling between the two swimmers.</p></sec><sec id="s2-5"><title>Leader’s wake unveils opportunities for stable emergent formations</title><p>To challenge our hypothesis that the leader’s wake contains information about the emergent pairwise equilibria, we examined the wake of a solitary swimmer in CFD and VS simulations (<xref ref-type="fig" rid="fig4">Figure 4A and B</xref>). By analyzing the wake of a solitary swimmer, without consideration of two-way coupling with a trailing swimmer, we aimed to assess the opportunities available in that wake for a potential swimmer, undergoing flapping motions, to position itself passively in the oncoming wake and extract hydrodynamic benefit.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Prediction of relative equilibria in the wake of a solitary swimmer.</title><p>(A, B) Snapshots of vorticity and fluid velocity fields created by a solitary swimmer in computational fluid dynamics (CFD) and vortex sheet (VS) simulations and corresponding flow agreement parameter <inline-formula><mml:math id="inf152"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> fields for a virtual follower at <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Locations of maximum <inline-formula><mml:math id="inf154"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> values (i.e. peaks in the flow agreement parameter field) coincide with the emergent equilibria in inphase pairwise formations (indicated by black circles). Contour lines represent flow agreement parameter at ±0.25, ±0.5. Thrust parameter <inline-formula><mml:math id="inf155"><mml:mi>𝕋</mml:mi></mml:math></inline-formula> is shown at <inline-formula><mml:math id="inf156"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf157"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. A negative slope <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> indicates stability of the predicted equilibria. See also <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplements 1</xref> and <xref ref-type="fig" rid="fig1s2">2</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig4-v1.tif"/></fig><p>Therefore, in the following analysis, we treated the potential swimmer as a ‘virtual’ particle located at a point <inline-formula><mml:math id="inf159"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the oncoming wake and undergoing prescribed transverse oscillations <inline-formula><mml:math id="inf160"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the <inline-formula><mml:math id="inf161"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction, at velocity <inline-formula><mml:math id="inf162"><mml:mrow><mml:mi>𝐯</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>A</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf163"><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> is a unit vector in the <inline-formula><mml:math id="inf164"><mml:mi>y</mml:mi></mml:math></inline-formula>-direction. The oncoming wake is blind to the existence of the virtual particle. Guided by our previous findings that stable equilibrium formations in pairwise interactions occur at zero effective phase <inline-formula><mml:math id="inf165"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>eff</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mtext/><mml:mi>wake</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, where the net hydrodynamic force on the trailing swimmer is zero and where small perturbations lead to negative force gradients, we introduced two assessment tools: a <italic>flow agreement parameter</italic> field <inline-formula><mml:math id="inf166"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that measures the degree of alignment, or <italic>matching</italic>, between the flapping motion of the virtual particle and the transverse flow of the oncoming wake, and a <italic>thrust parameter</italic> field <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>𝕋</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> that estimates the potential thrust force required to undergo such flapping motions.</p><p>Specifically, inspired by <xref ref-type="bibr" rid="bib3">Arranz et al., 2022</xref>, and following <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>, we defined the <italic>flow agreement parameter</italic><inline-formula><mml:math id="inf168"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> using <inline-formula><mml:math id="inf169"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>𝐯</mml:mi><mml:mo>⋅</mml:mo><mml:mi>𝐮</mml:mi><mml:mspace width="0.1667em"/><mml:mtext>d</mml:mtext><mml:msup><mml:mi>t</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf170"><mml:mi>t</mml:mi></mml:math></inline-formula> is chosen after the oncoming wake has reached steady state, normalized by <inline-formula><mml:math id="inf171"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mi>𝐯</mml:mi><mml:mo>⋅</mml:mo><mml:mi>𝐯</mml:mi><mml:mspace width="0.1667em"/><mml:mtext>d</mml:mtext><mml:msup><mml:mi>t</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> (Appendix E). The normalized <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> describes how well the oscillatory motion <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>𝐯</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the virtual particle matches the local transverse velocity <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>𝐮</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the oncoming wake (<xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>). Positive (negative) values of <inline-formula><mml:math id="inf175"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> indicate that the flow at <inline-formula><mml:math id="inf176"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is favorable (unfavorable) to the flapping motion of the virtual follower.</p><p>In <xref ref-type="fig" rid="fig4">Figure 4A and B</xref>, we show <inline-formula><mml:math id="inf177"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a field over the physical space <inline-formula><mml:math id="inf178"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="inf179"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Blue regions indicate where the local flow favors the follower’s flapping motion. In both CFD and VS simulations, the locations with the maximum flow agreement parameter closely coincide with the stable equilibria (black circles) obtained from solving pairwise interactions. These findings imply that hydrodynamic coupling in pairs of flapping swimmers is primarily <italic>non-reciprocal</italic> – captured solely by consideration of the effects of the leader’s wake on the follower. This non-reciprocity allows one, in principle, to efficiently and quickly identify opportunities for hydrodynamic benefits in the leader’s wake, without the need to perform costly two-way coupled simulations and experiments.</p><p>Importantly, our findings suggest a simple rule for identifying the locations of stable equilibria in any oncoming wake from considerations of the flow field of the wake itself: a potential swimmer undergoing a flapping motion at phase <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> tends to position itself at locations <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> of maximum flow agreement <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> between its flapping motion and the oncoming wake.</p><p>To verify this proposition, we show in <xref ref-type="fig" rid="fig5">Figure 5A</xref>, as a function of phase <inline-formula><mml:math id="inf183"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, the streamwise locations of the local maxima of <inline-formula><mml:math id="inf184"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> computed based on the CFD and VS models, and scaled by <inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf186"><mml:mi>U</mml:mi></mml:math></inline-formula> is the speed of the solitary swimmer. We superimpose onto these results the equilibrium configurations obtained from pairwise interactions in the context of the CFD (<inline-formula><mml:math id="inf187"><mml:mrow><mml:mi style="color:CFDsymbol;">⧫</mml:mi></mml:mrow></mml:math></inline-formula>), VS (<inline-formula><mml:math id="inf188"><mml:mi>■</mml:mi></mml:math></inline-formula>), and time-delay particle (<inline-formula><mml:math id="inf189"><mml:mrow><mml:mo lspace="0em" rspace="0em" style="color:particalsymbol;">◯</mml:mo></mml:mrow></mml:math></inline-formula>) models, where we modified the latter to account for non-zero lateral offset <inline-formula><mml:math id="inf190"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> (Appendix D and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Predictions of the equilibrium configurations based on maximal flow agreement parameter agree remarkably well with actual equilibria based on pairwise interactions, and they all follow the universal linear phase-distance relationship shown in <xref ref-type="fig" rid="fig2">Figure 2B</xref>.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Prediction of energetically beneficial, stable equilibria in the wake of a solitary swimmer at various phase lags and lateral offsets.</title><p>(<bold>A</bold>) Location of maximum <inline-formula><mml:math id="inf191"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> as a function of phase lag <inline-formula><mml:math id="inf192"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> in the wake of solitary leaders in computational fluid dynamics (CFD) and vortex sheet (VS) simulations. For comparison, equilibrium distances of pairwise simulations in CFD, VS, and time-delay particle models (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) are superimposed. Agreement between <inline-formula><mml:math id="inf193"><mml:mi>𝕍</mml:mi></mml:math></inline-formula>-based predictions and actual pairwise equilibria is remarkable. (<bold>B</bold>) <inline-formula><mml:math id="inf194"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> values also indicate the potential benefits of these equilibria, here shown as a function of lateral distance <inline-formula><mml:math id="inf195"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> for a virtual inphase follower in the wake of a solitary leader in CFD and VS simulations. The power savings of an actual follower in pairwise formations in CFD and VS simulations are superimposed. (<bold>C</bold>) A negative slope <inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> of the thrust parameter <inline-formula><mml:math id="inf197"><mml:mi>𝕋</mml:mi></mml:math></inline-formula> indicates stability and <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>|</mml:mi><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> expresses the degree of cohesion of the predicted formations, here, shown as a function of <inline-formula><mml:math id="inf199"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> for an inphase virtual follower. <inline-formula><mml:math id="inf200"><mml:mrow><mml:mi>|</mml:mi><mml:mi>∂</mml:mi><mml:mi>F</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> obtained from pairwise formations in VS and time-delay particle models are superimposed (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Results in (<bold>B</bold> and <bold>C</bold>) are normalized by the corresponding maximum values to facilitate comparison.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Time-delay particle model.</title><p>(<bold>A</bold>) Schematics of time-delayed particle model (<xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>) and its extension to laterally offset swimmers. Each swimmer generates hydrodynamic thrust via oscillating vertically, which also leaves a wake behind it. The follower swimmer interacts with the wake of the leader. (<bold>B</bold>) For an inphase pair, starting at initial distance <inline-formula><mml:math id="inf201"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1.15</mml:mn></mml:mrow></mml:math></inline-formula>, we incrementally increase the lateral offset from <inline-formula><mml:math id="inf202"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf203"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. (inset) Lateral decay of flow speed in the wake of a solitary swimmer in the vortex sheet model (blue line) and the fitted exponential curve (red line). The lateral exponential decay in the time-delay particle model takes the form <inline-formula><mml:math id="inf204"><mml:mrow><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo fence="false" symmetric="true" minsize="1.2em" maxsize="1.2em">(</mml:mo><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mi>|</mml:mi><mml:mi>ℓ</mml:mi><mml:mi>/</mml:mi><mml:mn>1.6</mml:mn><mml:msup><mml:mi>|</mml:mi><mml:mn>2.73</mml:mn></mml:msup></mml:mrow><mml:mo fence="false" symmetric="true" minsize="1.2em" maxsize="1.2em">)</mml:mo></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) The hydrodynamic force <inline-formula><mml:math id="inf205"><mml:mrow><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> acting on the follower as a function of the corresponding distance from the equilibrium. Due to the decay of the leader’s wake in the lateral direction (see inset in A), the hydrodynamic force <inline-formula><mml:math id="inf206"><mml:mrow><mml:mo form="prefix" stretchy="false">⟨</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">⟩</mml:mo></mml:mrow></mml:math></inline-formula> experienced by the follower decreases in magnitude at increasing lateral offset <inline-formula><mml:math id="inf207"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>. Orange lines show the linear change in force at the corresponding equilibria. The slope <inline-formula><mml:math id="inf208"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mi>/</mml:mi><mml:mi>δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> is a measure of linear stability. Negative slopes imply stable formations for all <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, but these slopes become more shallow as we increase <inline-formula><mml:math id="inf210"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig5-figsupp1-v1.tif"/></fig></fig-group><p>The wake of a solitary swimmer contains additional information that allows us to evaluate the relative power savings of a potential follower and relative stability of the pairwise formation directly from the leader’s wake, without accounting for pairwise interactions. Assessment of the relative power savings follows directly from the maximal value of the flow agreement parameter: larger values imply more power savings and reduced cost of transport. To verify this, we calculated the maximal <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the wake of the solitary swimmer, where we expected the follower to position itself in pairwise interactions. In <xref ref-type="fig" rid="fig5">Figure 5B</xref>, we plotted these <inline-formula><mml:math id="inf212"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> values as a function of lateral distance <inline-formula><mml:math id="inf213"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf214"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We superimposed the power savings <inline-formula><mml:math id="inf215"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> based on pairwise interactions of inphase swimmers using the CFD and VS simulations and normalized all quantities by the maximal value of the corresponding model to highlight variations in these quantities as opposed to absolute values. Power savings are almost constant for <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, but decrease sharply as <inline-formula><mml:math id="inf217"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> increases. This trend is consistent across all models, with the most pronounced drop in the CFD-based simulations because the corresponding velocity field <inline-formula><mml:math id="inf218"><mml:mi>𝐮</mml:mi></mml:math></inline-formula> decays more sharply when moving laterally away from the swimmer.</p><p>Next, to assess the stability of the virtual particle based only on information in the oncoming wake of a solitary swimmer, we estimated the thrust force based on the fact that the thrust magnitude scales with the square of the swimmer’s lateral velocity relative to the surrounding fluid’s velocity (<xref ref-type="bibr" rid="bib90">Triantafyllou et al., 1993</xref>; <xref ref-type="bibr" rid="bib26">Floryan et al., 2017</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>). We defined the thrust parameter field <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>𝕋</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo fence="true" form="prefix">|</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>𝐯</mml:mi><mml:mo>−</mml:mo><mml:mi>𝐮</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>.</mml:mi><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo fence="true" form="postfix">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext>d</mml:mtext><mml:msup><mml:mi>t</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, normalized using <inline-formula><mml:math id="inf220"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msubsup><mml:mo movablelimits="false">∫</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo fence="true" form="prefix">|</mml:mo><mml:mi>𝐯</mml:mi><mml:mi>.</mml:mi><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo fence="true" form="postfix">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.1667em"/><mml:mtext>d</mml:mtext><mml:msup><mml:mi>t</mml:mi><mml:mo lspace="0em" rspace="0em" class="tml-prime">′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. At the locations of the maxima of <inline-formula><mml:math id="inf221"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, a negative slope <inline-formula><mml:math id="inf222"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> of the thrust parameter is an indicator of linear stability or cohesion of the potential equilibria, i.e., emergent pairwise formations are expected to be stable if a small perturbation in distance about the locations <inline-formula><mml:math id="inf223"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of maximal <inline-formula><mml:math id="inf224"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> is accompanied by an opposite, restorative change in <inline-formula><mml:math id="inf225"><mml:mi>𝕋</mml:mi></mml:math></inline-formula>. Indeed, in both CFD and VS wakes, <inline-formula><mml:math id="inf226"><mml:mrow><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> at <inline-formula><mml:math id="inf227"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo separator="true">,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">∗</mml:mo></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is negative (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>In <xref ref-type="fig" rid="fig5">Figure 5C</xref>, we plotted <inline-formula><mml:math id="inf228"><mml:mrow><mml:mi>|</mml:mi><mml:mi>∂</mml:mi><mml:mi>𝕋</mml:mi><mml:mi>/</mml:mi><mml:mi>∂</mml:mi><mml:mi>d</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> as a function of lateral distance <inline-formula><mml:math id="inf229"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> for <inline-formula><mml:math id="inf230"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We superimposed the magnitude of the eigenvalues <inline-formula><mml:math id="inf231"><mml:mrow><mml:mi>|</mml:mi><mml:mi>δ</mml:mi><mml:mi>F</mml:mi><mml:mi>/</mml:mi><mml:mi>δ</mml:mi><mml:mi>d</mml:mi><mml:mi>|</mml:mi></mml:mrow></mml:math></inline-formula> obtained from the linear stability analysis of pairwise interactions in inphase swimmers using the VS and time-delay particle models. As in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, all quantities are normalized by the maximal value of the corresponding model to highlight variations in these quantities as opposed to absolute values. Also, as in <xref ref-type="fig" rid="fig5">Figure 5B</xref>, all models produce consistent results: pairwise cohesion is strongest for <inline-formula><mml:math id="inf232"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, but weakens sharply as <inline-formula><mml:math id="inf233"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> increases, with the most pronounced drop in the CFD-based simulations.</p><p>A few comments on our virtual particle model and diagnostic tools in terms of the flow agreement and thrust parameters are in order. Our model differs from the minimal particle model used in <xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>, which treated both swimmers as particles with minimal ‘wakes’ and considered two-way coupling between them (see Appendix D).</p><p>In our analysis, the oncoming wake can be described to any desired degree of fidelity of the fluid model, including using experimentally constructed flows when available. Indeed, our flow agreement and thrust parameters are agnostic to how the flow field of the oncoming wake is constructed. Additionally, these diagnostic tools are equally applicable to any oncoming wake, not necessarily produced by a single swimmer, but say by multiple swimmers (as discussed later) or even non-swimming flow sources. Thus, the approach we developed here could be applied broadly to analyze, predict, and test opportunities for schooling and hydrodynamic benefits for live and robotic fish whenever measurements of an oncoming flow field are available.</p></sec><sec id="s2-6"><title>Parametric analysis over the entire space of phase lags and lateral offsets</title><p>Having demonstrated consistency in the emergence of flow-mediated equilibria in both CFD and VS simulations, we next exploited the computational efficiency of the VS model to systematically investigate emergent pairwise formations over the entire space of phase lag <inline-formula><mml:math id="inf234"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and lateral offset <inline-formula><mml:math id="inf235"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mi>L</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>L</mml:mi><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, excluding side-by-side antiphase formations. Equilibrium configurations are dense over the entire range of parameters: for any combination of phase lag <inline-formula><mml:math id="inf236"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and lateral offset <inline-formula><mml:math id="inf237"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, there exists an emergent equilibrium configuration where the pair of swimmers travel together at a separation distance <inline-formula><mml:math id="inf238"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). Perturbing one or both parameters, beyond the limits of linear stability, causes the swimmers to stably and smoothly transition to another equilibrium at different spacing <inline-formula><mml:math id="inf239"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Importantly, increasing the phase lag <inline-formula><mml:math id="inf240"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> shifts the equilibrium positions in the streamwise direction such that <inline-formula><mml:math id="inf241"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> depends linearly on <inline-formula><mml:math id="inf242"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, but the effect of lateral distance for <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> is nonlinear and nearly negligible for small <inline-formula><mml:math id="inf244"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>: increasing the lateral offset <inline-formula><mml:math id="inf245"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> by an entire body length <inline-formula><mml:math id="inf246"><mml:mi>L</mml:mi></mml:math></inline-formula> changes the pairwise distance <inline-formula><mml:math id="inf247"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> by about 15%. Our results explored emergent equilibria up to <inline-formula><mml:math id="inf248"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:mn>2.5</mml:mn></mml:mrow></mml:math></inline-formula> and are consistent with the experimental findings in <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>, which explored up to nine downstream equilibria.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Equilibria are dense over the parameter space of phase lags and lateral offsets.</title><p>For any given phase lag <inline-formula><mml:math id="inf249"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and at any lateral offset <inline-formula><mml:math id="inf250"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> inside the wake, the pair reach equilibrium formations that are stable and power saving relative to a solitary swimmer. (<bold>A</bold>) Equilibrium separation distances, (<bold>B</bold>) average power saving, and (<bold>C</bold>) stability as a function of phase lag and lateral distance in a pair of swimmers. Predictions of (<bold>D</bold>) equilibrium locations, (<bold>E</bold>) hydrodynamic benefits, and (<bold>F</bold>) cohesion based on the wake of a solitary swimmer following the approach in <xref ref-type="fig" rid="fig4">Figures 4</xref> and <xref ref-type="fig" rid="fig5">5</xref>. For comparison, the contour lines from (B and C) based on pairwise interactions are superimposed onto panels (E and F) (white lines). Simulations in (A–C) are based on pairwise interactions and simulations in (D–F) are based on the wake of a single swimmer, all in the context of the vortex sheet model with <inline-formula><mml:math id="inf251"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf252"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf253"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig6-v1.tif"/></fig><p>To assess the hydrodynamic advantages of these emergent formations, we calculated the average change in hydrodynamic power per swimmer. The pair saves power compared to solitary swimming (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Power savings vary depending on phase lag <inline-formula><mml:math id="inf254"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and lateral distance <inline-formula><mml:math id="inf255"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>: for the entire range of <inline-formula><mml:math id="inf256"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> from 0 to <inline-formula><mml:math id="inf257"><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>, the school consistently achieves over 20% power reduction, as long as the lateral offset is <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. However, increasing <inline-formula><mml:math id="inf259"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> from <inline-formula><mml:math id="inf260"><mml:mrow><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf261"><mml:mi>L</mml:mi></mml:math></inline-formula> reduces significantly the hydrodynamic benefit. That is, swimmers can take great liberty in changing their phase without compromising much the average energy savings of the school, as long as they maintain close lateral distance to their neighbor.</p><p>A calculation of the linear stability of each equilibrium in <xref ref-type="fig" rid="fig6">Figure 6A</xref> shows that these emergent formations are linearly stable (<xref ref-type="fig" rid="fig6">Figure 6C</xref>), and the degree of stability is largely insensitive to phase lag, with strongest cohesion achieved at lateral offset <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The results in <xref ref-type="fig" rid="fig6">Figure 6A–C</xref> are constructed using pairwise interactions in VS simulations, but can be inferred directly from the wake of a solitary leader, as discussed in the previous section and shown in <xref ref-type="fig" rid="fig6">Figure 6D–F</xref>.</p></sec><sec id="s2-7"><title>Analysis of larger groups of inline and side-by-side swimmers</title><p>How do these insights scale to larger groups? To address this question, we systematically increased the number of swimmers and computed the emergent behavior in larger groups based on flow-coupled VS simulations.</p><p>In a group of six swimmers, all free to move in the streamwise <inline-formula><mml:math id="inf263"><mml:mi>x</mml:mi></mml:math></inline-formula>-direction, we found that the last three swimmers split and form a separate subgroup (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). In each subgroup, swimmer 3 experiences the largest hydrodynamic advantage (up to 120% power saving!), swimmer 2 receives benefits comparable to those it received in pairwise formation (65% power saving), and swimmer 1 no benefit at all (<xref ref-type="fig" rid="fig7">Figure 7C</xref>).</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Larger inline and side-by-side formations.</title><p>(A) Inline formations lose cohesion and split into two subgroups as depicted here for a group of six swimmers. (<bold>B</bold>) Side-by-side formations remain cohesive. (<bold>C</bold>) Power saving of each swimmer in inline and side-by-side formations. Dissipation time <inline-formula><mml:math id="inf264"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>.</mml:mi><mml:mn>45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Simulations of inline formations and side-by-side formations ranging from two to six swimmers are shown in <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplements 1</xref> and <xref ref-type="fig" rid="fig7s2">2</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig7-v1.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Inline formations of multiple flapping swimmers.</title><p>Snapshots of inline formations composed of 2, 3, 4, 5, and 6 swimmers in vortex sheet (VS) simulations at steady state; time evolution of pairwise distances is shown on the right. (<bold>A</bold> and <bold>B</bold>) Formations composed of 2 or 3 swimmers are stable with at consecutive spacing <inline-formula><mml:math id="inf265"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>C</bold>) For a trail of 4 swimmers, the group splits into a leading subgroup of 3 swimmers while the fourth swimmer separates from the rest. (<bold>D</bold> and <bold>E</bold>) For formation of 5 or 6 swimmers, the group splits into a leading subgroup of 3 swimmers and another subgroup containing the remaining 2 or 3 swimmers. (<bold>F</bold>) reports recent savings in COT for each swimmer and the average of the whole group.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig7-figsupp1-v1.tif"/></fig><fig id="fig7s2" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 2.</label><caption><title>Side-by-side formations of multiple flapping swimmers.</title><p>Vortex sheet simulation of side-by-side formations with 2 (<bold>A</bold>), 3 (<bold>B</bold>), 4 (<bold>C</bold>), 5 (<bold>D</bold>), and 6 (<bold>E</bold>) swimmers, from top to bottom, respectively. On right-hand side, we report pairwise spacing between them. In all of the groups the formations are stable and the distances between every pair are close to zero. (<bold>F</bold>) reports recent savings in COT for each swimmer and the average of the whole group.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig7-figsupp2-v1.tif"/></fig></fig-group><p>We asked if loss of cohesion is dependent on the number of inline swimmers. To address this question, we gradually increased the number of swimmers from two to six (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). We found that in a school of three inline swimmers, flow interactions led to a stable emergent formation with hydrodynamic benefits similar to those experienced by the three swimmers in each subgroup of <xref ref-type="fig" rid="fig7">Figure 7A and C</xref>. When computing the motion of four inline swimmers (<xref ref-type="fig" rid="fig8">Figure 8A</xref>), we found that the leading three swimmers maintained cohesion, at hydrodynamic benefits similar to a formation of three, but swimmer 4 separated and lagged behind, receiving no advantage in terms of power savings because it split from the formation (<xref ref-type="fig" rid="fig8">Figure 8D</xref>, <xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>). In a group of five, the last two swimmers split and formed their own subgroup. That is, in all examples, swimmer 4 consistently lost hydrodynamic advantage and served as local leader of the trailing subgroup. These observations are consistent with <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>, and demonstrate that flow interactions alone are insufficient to maintain inline formations as the group size increases.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Loss of cohesion in larger groups of inline swimmers.</title><p>Number of swimmers that stay in cohesive formation depends on parameter values. (<bold>A–C</bold>) For dissipation time <inline-formula><mml:math id="inf266"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf267"><mml:mrow><mml:mn>3.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf268"><mml:mrow><mml:mn>4.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, the fourth, fifth, and sixth swimmers separate from the group, respectively. (<bold>D</bold>) Power savings per swimmer in (A–C), respectively. On average, all schools save equally in cost of transport, but the distribution of these savings vary significantly between swimmers. In all case, swimmer 3 receives the most hydrodynamic benefits.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig8-v1.tif"/></fig><p>We next explored the robustness of the side-by-side pattern to larger number of swimmers starting from side-by-side initial conditions (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). The swimmers reached stable side-by-side formations reminiscent of the configurations observed experimentally when fish were challenged to swim at higher swimming speeds (<xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>). The swimmers in this configuration saved power compared to solitary swimming (<xref ref-type="fig" rid="fig7">Figure 7C</xref>): swimmers gained equally in terms of hydrodynamic advantage (up to 55% power saving for the middle swimmers in a school of six), except the two edge swimmers which benefited less. We tested these results by gradually increasing the number of swimmers from two to six (<xref ref-type="fig" rid="fig7s2">Figure 7—figure supplement 2</xref>). The robustness and overall trend of power saving among group members is robust to the total number of swimmers in these side-by-side formations.</p></sec><sec id="s2-8"><title>Mechanisms leading to loss of cohesion in larger inline formations</title><p>To understand why three swimmers form a stable inline formation but four don’t, we extended the analysis in <xref ref-type="fig" rid="fig4">Figure 4</xref> to analyze the wake created behind two-swimmer (<xref ref-type="fig" rid="fig9">Figure 9A</xref>) and three-swimmer (<xref ref-type="fig" rid="fig9">Figure 9B</xref>) groups. Specifically, we computed pairwise interactions in a two-swimmer school and considered the combined wake of both swimmers after they had settled onto an equilibrium state. Similarly, we computed the behavior of a three-swimmer school and analyzed the combined wake at steady state. Compared to the single leader wake in <xref ref-type="fig" rid="fig4">Figure 4B</xref>, in the wake of a two-swimmer school, positive flow agreement in the (blue) region is enlarged and enhanced, corresponding to swimmer 3 receiving the largest power savings. On the other hand, behind three inline swimmers, the region of positive flow agreement is weakened and shrunk, indicating weaker potential for energy saving by a fourth swimmer.</p><fig-group><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Prediction of equilibrium locations in the wake of multiple upstream swimmers.</title><p>(A, <bold>B</bold>) Snapshots of vorticity fields created by two inline inphase swimmers, and three inline inphase swimmers. (<bold>C</bold>, <bold>D</bold>) show the corresponding flow agreement parameter <inline-formula><mml:math id="inf269"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> fields. Contour lines represent flow agreement parameter at ±0.25, ±0.5. (<bold>E</bold>, <bold>F</bold>) plot the corresponding period-averaged streamwise velocity. Separation distances <inline-formula><mml:math id="inf270"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> predicted by the locations of maximal <inline-formula><mml:math id="inf271"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> are marked by circles in the flow agreement field. In the left column, separation distances <inline-formula><mml:math id="inf272"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> based on freely swimming triplets are marked by black circles and coincide with the locations of maximal <inline-formula><mml:math id="inf273"><mml:mi>𝕍</mml:mi></mml:math></inline-formula>. In the right column, the orange marker shows the prediction of the location of a fourth swimmer based on the maximum flow agreement parameter. In two-way coupled simulation, swimmer 4 actually separates from the leading three swimmers as illustrated in <xref ref-type="fig" rid="fig8">Figure 8A</xref>. Computational fluid dynamics (CFD) simulation shows swimmer 4 will collide with swimmer 3 as in <xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>. (<bold>G, H</bold>) show the transverse flow velocity in a period at the location predicted by the maximum flow agreement parameter and with a lateral offset <inline-formula><mml:math id="inf274"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>0.5</mml:mn><mml:mi>L</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, in comparison to the follower’s tailbeat velocity.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig9-v1.tif"/></fig><fig id="fig9s1" position="float" specific-use="child-fig"><label>Figure 9—figure supplement 1.</label><caption><title>Inline formations of multiple flapping swimmers in computational fluid dynamics (CFD) simulations.</title><p>CFD simulation of inline formations with three (<bold>A</bold>) and four (<bold>B</bold>) swimmers at Re=1645. Vorticity field is shown on the left-hand side. On right-hand side, we report pairwise spacing between them. The pitching amplitude of leader and follower is set to <inline-formula><mml:math id="inf275"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>15</mml:mn><mml:mo lspace="0em" rspace="0em">∘</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig9-figsupp1-v1.tif"/></fig></fig-group><p>Importantly, in the wake of the pairwise formation, the downstream jet is modest at the location of maximum <inline-formula><mml:math id="inf276"><mml:mi>𝕍</mml:mi></mml:math></inline-formula>, where swimmer 3 is expected to position itself for hydrodynamic benefit, thus allowing swimmer 3 to reach this position and stay in formation (<xref ref-type="fig" rid="fig9">Figure 9E</xref>). Also, at this location, the wake has a substantial transverse velocity <inline-formula><mml:math id="inf277"><mml:mrow><mml:mi>𝐮</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig9">Figure 9G</xref>), which aids thrust production at a diminished cost. In contrast, three inline swimmers generate a much stronger downstream jet at the location of maximum <inline-formula><mml:math id="inf278"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> where swimmer 4 is expected to position itself (<xref ref-type="fig" rid="fig9">Figure 9F</xref>). This jet prevents swimmer 4 from stably staying in formation, and the transverse flow velocity <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>𝐮</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>𝐞</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is nearly zero for the entire flapping period (<xref ref-type="fig" rid="fig9">Figure 9H</xref>), indicating little opportunity for exploiting the flow generated by the three upstream swimmers for thrust generation. This limitation is fundamental; it results from the flow physics that govern the wake generated by the upstream swimmers. There is not much that a trailing swimmer can do to extract hydrodynamic benefits from an oncoming flow field that does not offer any.</p></sec><sec id="s2-9"><title>Critical size of inline formations beyond which cohesion is lost</title><p>We sought to understand what determines the critical group size, here three, beyond which inline formations lose cohesion and split into subgroups. Because we have established that the flow agreement parameter <inline-formula><mml:math id="inf280"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> plays an important role in predicting emergent formations, we first examined <inline-formula><mml:math id="inf281"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> in the wake of a pair of flapping swimmers in CFD (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) and VS (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>) simulations. These results show that at lower Re and smaller dissipation time <inline-formula><mml:math id="inf282"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the flow agreement parameter <inline-formula><mml:math id="inf283"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> decays rapidly downstream of the flapping swimmers, thus diminishing the opportunities for downstream swimmers to passively stay in cohesive formation and achieve hydrodynamic benefits. We thus hypothesized that the number of swimmers that passively maintain a cohesive inline formation is not a universal property of the flow physics, but depends on the flow regime.</p><p>We tested this hypothesis in VS simulations with increasing number of swimmers and increasing <inline-formula><mml:math id="inf284"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. As we increased <inline-formula><mml:math id="inf285"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the number of swimmers that stayed in cohesive inline formation increased (<xref ref-type="fig" rid="fig8">Figure 8B and C</xref>). These findings confirm that this aspect of schooling – the maximal number of swimmers that passively maintain a cohesive inline formation – is indeed scale-dependent. Interestingly, an analysis of the power savings in these formations shows that, although swimmers 4 and 5 stay in formation at increased <inline-formula><mml:math id="inf286"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext/><mml:mi>diss</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, swimmer 3 always receives the most hydrodynamic benefit (<xref ref-type="fig" rid="fig8">Figure 8D</xref>).</p><p>We additionally tested the stability of inline formations in CFD simulations at Re=1645 (<xref ref-type="fig" rid="fig9s1">Figure 9—figure supplement 1</xref>) and observed the same trend: an inline school of three swimmers remains cohesive, but a fourth swimmer collides with the upstream swimmer. These observations imply that the loss of cohesion does not depend on the specific fluid model. This is consistent qualitatively with existing results (<xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>). In <xref ref-type="bibr" rid="bib76">Peng et al., 2018</xref>, the authors employed flexible heaving foils at Re = 200 and observed stable inline formations with larger number of swimmers. The flexible foil model and smaller Re make the swimmer more adaptive to changes in the flow field, by passively modulating the amplitude and phase along its body, thus diverting some of the hydrodynamic energy into elastic energy and stabilizing the larger inline formation. This, again, emphasizes that the number of swimmers in a stable inline group is not a universal property of the formation, rather it is model and scale-dependent.</p></sec><sec id="s2-10"><title>Mapping emergent spatial patterns to energetic benefits</title><p>We next returned to the school of four swimmers, which, when positioned inline and flapped inphase, lost cohesion as the trailing swimmer separated from the school. We aimed to investigate strategies for stabilizing the emergent school formation and mapping the location of each member in the school to the potential benefit or cost it experiences compared to solitary swimming.</p><p>Inspired by vortex phase matching as an active strategy for schooling (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib60">Li et al., 2021</xref>), we tested whether phase control is a viable approach to maintain cohesion and gain hydrodynamic benefits. We devised an active feedback control strategy, where the swimmer senses the oncoming transverse flow velocity at its location and adjusts its flapping phase to maximize the agreement <inline-formula><mml:math id="inf287"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> between its flapping motion and the local flow (see Appendix F for more details). When applied to swimmer 4 (<xref ref-type="fig" rid="fig10">Figure 10A</xref>), this phase controller led to a stable formation, albeit at no benefit to swimmer 4; in fact, swimmer 4 spent 100% more power compared to solitary swimming, whereas the power savings of swimmers 2 and 3 remained robustly at the same values as in the formation without swimmer 4. The inability of swimmer 4 to extract hydrodynamic benefits from the oncoming flow is due to a fundamental physical limitations, as explained in <xref ref-type="fig" rid="fig9">Figure 9</xref>; by the non-reciprocal nature of flow interactions, changing the phase of the trailing swimmer has little effect on the oncoming flow field generated by the upstream swimmers. If the oncoming wake itself presents no opportunity for hydrodynamic benefit, phase control cannot generate such benefit.</p><fig-group><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Passive and active methods for stabilizing an emergent formation of four swimmers.</title><p>(<bold>A</bold>) In an inline school of four swimmers, the leading three swimmers flap inphase, but swimmer 4 actively controls its phase in response to the flow it perceives locally to match its phase to that of the local flow as proposed in <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>. The phase controller stabilizes swimmer 4 in formation but at no hydrodynamic benefit. (<bold>B</bold>) Sequentially increasing the phase lag by a fixed amount <inline-formula><mml:math id="inf288"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:msup><mml:mn>30</mml:mn><mml:mi>o</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> in an inline school of four swimmers stabilizes the trailing swimmer but at no hydrodynamic benefit. (<bold>C</bold>) Gradually tuning the phase lag <inline-formula><mml:math id="inf289"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula> in a school of four swimmers as done in (B). At moderate phase lags, the school stays cohesive (top plot) but swimmer 4 barely gets any power savings (bottom plot). (<bold>D</bold>) By laterally offsetting the swimmers, four swimmers, all flapping inphase, form cohesive schools with different patterns, e.g., with side-by-side pairing of two swimmers, staggered, and diamond patterns. The time evolution of separation distances is shown in <xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>. Individual in each pattern receive a different amount of hydrodynamic benefit. Diamond formation provides the most power saving for the school as anticipated in <xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>, for a school in a regular infinite lattice. In (<bold>A</bold>, <bold>B</bold>, and <bold>D</bold>), %values indicate the additional saving or expenditure in cost of transport relative to solitary swimming.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig10-v1.tif"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 1.</label><caption><title>Alternative formations of four flapping swimmers.</title><p>Vortex sheet simulation of four swimmers with alternative formations. On right hand side, we report pairwise spacing between them. The lateral distance is <inline-formula><mml:math id="inf290"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>A</bold>) Two leading swimmers swim side by side. The third and forth swimmer collide to each other. (<bold>B</bold>) The same configuration as in (<bold>A</bold>) with larger initial distance between the third and forth swimmer. They form a stable school. The forth swimmer stays at the second equilibrium behind the third swimmer. (<bold>C</bold>) An additional swimmer is placed side by side to the second swimmer in a school of three inline swimmers. The second and third swimmer stays at the second equilibrium from the first swimmer, and the forth swimmer stays at the second equilibrium from the second and third swimmer. (<bold>D</bold>) An additional swimmer is placed side by side to the third swimmer in a school of three inline swimmers. The last two swimmers stay at the second equilibrium from the second swimmer. (<bold>E</bold>) Four inline inphase swimmers when initially placed close to the second equilibrium. Power saving per swimmer is reported in <xref ref-type="fig" rid="fig10">Figure 10</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-fig10-figsupp1-v1.tif"/></fig></fig-group><p>We next investigated whether collaborative phase modulation could aid in maintaining school cohesion by imposing that each swimmer flaps at a phase lag <inline-formula><mml:math id="inf291"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula> relative to the swimmer ahead (<xref ref-type="fig" rid="fig10">Figure 10B and C</xref>). We found a range of values of <inline-formula><mml:math id="inf292"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula> at which the school became passively stable, but without providing much hydrodynamic benefit to the trailing swimmer; in fact, at certain <inline-formula><mml:math id="inf293"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula>, cohesion came at a hydrodynamic cost to swimmer 4, much like the active phase control strategy.</p><p>Lastly, we investigated whether lateral offset of some of the swimmers could passively stabilize the emergent formation. The choice of which swimmers to displace laterally and by how much is not unique. Thus, we probed different scenarios and obtained multiple stable formations (<xref ref-type="fig" rid="fig10">Figure 10D</xref> and <xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>, <xref ref-type="video" rid="video2">Video 2</xref>). For example, pairing any two of the four swimmers side-by-side, say at the leading, middle, or trailing end of the school, led to cohesive formations. The distribution of hydrodynamic cost or benefit varied depending on the spatial pattern of the school and the individual position within the school. Staggering the swimmers in a zigzag pattern also stabilized the school, but did not always allow the trailing swimmer to improve its cost of transport. Staggering the swimmers in a ‘diamond’ formation stabilized the school and, of all the stable formations we tested, led to the highest savings in cost of transport for the entire school (<xref ref-type="fig" rid="fig10">Figure 10D</xref>). These results are consistent with existing evidence that diamond formations are both stable (<xref ref-type="bibr" rid="bib92">Tsang and Kanso, 2013</xref>) and energetically optimal (<xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>; <xref ref-type="bibr" rid="bib18">Dai et al., 2018</xref>). But unlike individuals in an infinite diamond lattice (<xref ref-type="bibr" rid="bib105">Weihs, 1973</xref>), individuals in a finite diamond formation do not receive equal energetic benefits.</p><media mimetype="video" mime-subtype="mp4" xlink:href="elife-96129-video2.mp4" id="video2"><label>Video 2.</label><caption><title>Groups of flow-coupled swimmers self-organize into inline, side-by-side, or staggered patterns of distinct cohesion and energy-saving properties.</title><p>Results based on flapping plates in vortex sheet simulations.</p></caption></media><p>Our findings highlight the versatility and fluidity of the emergent spatial patterns in groups of flapping swimmers and emphasize that energetic benefits vary depending on the position of the individual within the school. Importantly, these findings imply that, although many emergent formations do not globally optimize the savings of the entire school, hydrodynamic interactions within these formations offer individuals numerous opportunities to achieve varying levels of energetic savings (<xref ref-type="bibr" rid="bib64">Marras and Porfiri, 2012</xref>), potentially creating competition among school members over advantageous positions in the school.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We analyzed how passive flow interactions mediate self-organization in groups of flapping swimmers, all heading in the same direction. Our approach relied on a hierarchy of FSI models and aimed to distill which aspects of self-organization are universal and those which are scale-dependent.</p><p>We found that a pair of flapping swimmers self-organize into inline, diagonal, or side-by-side formations (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The emergent formation depends on the swimmers’ flapping phase and initial conditions. In fact, the distinction between these types of formation is somewhat arbitrary because, as phase varies, the emergent equilibria are dense over the space of lateral offset and separation distance (<xref ref-type="fig" rid="fig6">Figure 6</xref>). These findings are consistent with experimental observations (<xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib89">Thandiackal and Lauder, 2023</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib71">Newbolt et al., 2022</xref>), but go beyond these observations to quantify the hydrodynamic benefits to each member in these formations. Two side-by-side swimmers flapping inphase save energy, compared to solitary swimming, and share the hydrodynamic benefits nearly equally. When flapping antiphase, the side-by-side swimmers exert extra effort compared to solitary swimming, contrary to a common misconception that this configuration saves hydrodynamic energy (<xref ref-type="bibr" rid="bib110">Zhang and Lauder, 2023b</xref>). In leader-follower formations, whether inline or diagonal, hydrodynamic benefits are bestowed entirely on the follower (<xref ref-type="fig" rid="fig3">Figure 3A</xref>).</p><p>Importantly, we showed that the wake of a solitary leader contains information that unveils opportunities for the emergence of stable and energetically favorable formations in pairs of swimmers. Equilibrium locations and trends in power savings and school cohesion can all be predicted entirely from kinematic considerations of the leader’s wake with no consideration of the two-way coupling between the two swimmers (<xref ref-type="fig" rid="fig5">Figure 5</xref>). These results are important because they highlight the non-reciprocal or asymmetric nature of flow coupling in leader-follower configurations, inline or diagonal, at finite Re and open new avenues for future studies of non-reciprocal flow-coupled oscillators. These oscillators have distinct properties from classic mechanical and biological oscillators, such as Huygens pendula or viscosity-dominant oscillators, where the coupling between the oscillators is reciprocal; see, e.g., <xref ref-type="bibr" rid="bib84">Strogatz and Stewart, 1993</xref>; <xref ref-type="bibr" rid="bib63">Lushi et al., 2014</xref>; <xref ref-type="bibr" rid="bib73">Oliveira and Melo, 2015</xref>; <xref ref-type="bibr" rid="bib104">Wan and Goldstein, 2016</xref>; <xref ref-type="bibr" rid="bib32">Guo et al., 2018</xref>.</p><p>Our analysis has practical importance in that it provides efficient diagnostics and predictive tools that are equally applicable to computational models and experimental data and could, therefore, be applied broadly to analyze, predict, and test opportunities for schooling and hydrodynamic benefits in live and robotic fish when flow measurements are available.</p><p>Case in point, we used these diagnostic tools to explain the mechanisms leading to scattering in larger groups of inline swimmers and to predict when the wake of a leading group of swimmers offers no opportunities for a follower to benefit from passive hydrodynamics (<xref ref-type="fig" rid="fig9">Figure 9</xref>). At an increasing number of flow-coupled swimmers, side-by-side formations remain robust, but inline formations become unstable beyond a critical number of swimmers (<xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig8">8</xref>). The critical number depends on the fluid properties and can be predicted by analyzing the wake of the leading group of swimmers. Future work will focus on testing these findings experimentally and in CFD simulations with increasing number of swimmers, together with accounting for body deformations (<xref ref-type="bibr" rid="bib34">Hang et al., 2022</xref>), lateral dynamics (<xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>; <xref ref-type="bibr" rid="bib19">Das et al., 2023</xref>), and variable flapping amplitudes and frequencies (<xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Hang et al., 2024</xref>).</p><p>Our findings could have far-reaching consequences on our understanding of biological fish schools. Field and laboratory experiments (<xref ref-type="bibr" rid="bib75">Partridge and Pitcher, 1979</xref>; <xref ref-type="bibr" rid="bib65">Marras et al., 2015</xref>; <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>; <xref ref-type="bibr" rid="bib62">Lombana and Porfiri, 2022</xref>) have shown that actual fish schools do not generally conform to highly regularized patterns, and schooling fish dynamically change their position in the school. Neighboring fish vary from side-by-side to inline and diagonal configurations. Importantly, in laboratory experiments that challenged groups of fish to sustain high swimming speeds, the fish rearranged themselves in a side-by-side pattern as the speed increased, much like the pattern in <xref ref-type="fig" rid="fig7">Figure 7B</xref>, presumably to save energy (<xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>). These empirical observations, together with our findings that side-by-side formations provide the fairest distribution of efforts among school members (<xref ref-type="fig" rid="fig7">Figure 7B and C</xref>), offer intriguing interpretations of the results in <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>; <xref ref-type="bibr" rid="bib62">Lombana and Porfiri, 2022</xref>: when the fish are not challenged by a strong background current to sustain high swimming speeds, they position themselves as they please spatially, without much consideration to equal sharing of hydrodynamic benefits. But when challenged to swim at much higher speeds than their average swimming speed, fish are forced to cooperate.</p><p>To expand on this, our results suggest a connection between flow physics and what is traditionally thought of as social traits: greed versus cooperation. We posit that there is a connection between the resources that arise from flow physics – in the form of energetic content of the wake of other swimmers – and greedy versus cooperative group behavior. In cohesive inline formations, the leader is always disadvantaged and hydrodynamic benefits are accorded entirely to trailing swimmers (<xref ref-type="fig" rid="fig3">Figures 3A</xref> and <xref ref-type="fig" rid="fig7">7C</xref>). Importantly, flows generated by these inline formations present serious impediments for additional swimmers to join the line downstream (<xref ref-type="fig" rid="fig7">Figures 7</xref> and <xref ref-type="fig" rid="fig8">8</xref>). Thus, we could call these formations greedy, leaving no resources in the environment for trailing swimmers. This thought, together with our interpretation of the observations in <xref ref-type="bibr" rid="bib4">Ashraf et al., 2017</xref>, that cooperation to achieve an egalitarian distribution of hydrodynamic benefits is forced, not innate, raise an interesting hypothesis. The dynamic repositioning of members within the school (e.g. <xref ref-type="fig" rid="fig10">Figure 10</xref>) could be driven by greed and competition to occupy hydrodynamically advantageous positions, much like in peloton of racing cyclists (<xref ref-type="bibr" rid="bib12">Blocken et al., 2018</xref>). On a behavioral time scale, these ideas, besides their relevance to schooling fish, open up opportunities for analyzing and comparing the collective flow physics in cooperative versus greedy behavior in animal groups from formations of swimming ducklings (<xref ref-type="bibr" rid="bib108">Yuan et al., 2021</xref>) and flying birds (<xref ref-type="bibr" rid="bib11">Bialek et al., 2012</xref>; <xref ref-type="bibr" rid="bib78">Portugal et al., 2014</xref>) to peloton of racing cyclists (<xref ref-type="bibr" rid="bib12">Blocken et al., 2018</xref>). From an evolutionary perspective, it is particularly exciting to explore the prospect that flow physics could have acted as a selective pressure in the evolution of social traits such as cooperation and greed in aquatic animal groups.</p></sec></body><back><sec sec-type="additional-information" id="s4"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Investigation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation, Software, Investigation, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Investigation, Writing - original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s5"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-96129-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s6"><title>Data availability</title><p>All data is included in the main manuscript and figure supplements. Time evolution data of swimmers obtained from CFD and vortex-sheet simulations are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.hqbzkh1s5">https://doi.org/10.5061/dryad.hqbzkh1s5</ext-link>.</p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Hang</surname><given-names>H</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Mapping Spatial Patterns to Energetic Benefits in Groups of Flow-coupled Swimmers</data-title><source>Dryad Digital Repository</source><pub-id pub-id-type="doi">10.5061/dryad.hqbzkh1s5</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>Many thanks to members of the McHenry Laboratory at UC Irvine and Kanso Laboratory at USC for numerous discussions about fish schooling behavior and for comments on the manuscript.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alben</surname><given-names>S</given-names></name><name><surname>Shelley</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Flapping states of a flag in an inviscid fluid: bistability and the transition to chaos</article-title><source>Physical Review Letters</source><volume>100</volume><elocation-id>074301</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.100.074301</pub-id><pub-id pub-id-type="pmid">18352554</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alben</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Wake-mediated synchronization and drafting in coupled flags</article-title><source>Journal of Fluid Mechanics</source><volume>641</volume><fpage>489</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1017/S0022112009992138</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arranz</surname><given-names>G</given-names></name><name><surname>Flores</surname><given-names>O</given-names></name><name><surname>García-Villalba</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Flow interaction of three-dimensional self-propelled flexible plates in tandem</article-title><source>Journal of Fluid Mechanics</source><volume>931</volume><elocation-id>918</elocation-id><pub-id pub-id-type="doi">10.1017/jfm.2021.918</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashraf</surname><given-names>I</given-names></name><name><surname>Bradshaw</surname><given-names>H</given-names></name><name><surname>Ha</surname><given-names>TT</given-names></name><name><surname>Halloy</surname><given-names>J</given-names></name><name><surname>Godoy-Diana</surname><given-names>R</given-names></name><name><surname>Thiria</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Simple phalanx pattern leads to energy saving in cohesive fish schooling</article-title><source>PNAS</source><volume>114</volume><fpage>9599</fpage><lpage>9604</lpage><pub-id pub-id-type="doi">10.1073/pnas.1706503114</pub-id><pub-id pub-id-type="pmid">28839092</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ayancik</surname><given-names>F</given-names></name><name><surname>Zhong</surname><given-names>Q</given-names></name><name><surname>Quinn</surname><given-names>DB</given-names></name><name><surname>Brandes</surname><given-names>A</given-names></name><name><surname>Bart-Smith</surname><given-names>H</given-names></name><name><surname>Moored</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Scaling laws for the propulsive performance of three-dimensional pitching propulsors</article-title><source>Journal of Fluid Mechanics</source><volume>871</volume><fpage>1117</fpage><lpage>1138</lpage><pub-id pub-id-type="doi">10.1017/jfm.2019.334</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bajec</surname><given-names>IL</given-names></name><name><surname>Heppner</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Organized flight in birds</article-title><source>Animal Behaviour</source><volume>78</volume><fpage>777</fpage><lpage>789</lpage><pub-id pub-id-type="doi">10.1016/j.anbehav.2009.07.007</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname><given-names>AD</given-names></name><name><surname>Masoud</surname><given-names>H</given-names></name><name><surname>Newbolt</surname><given-names>JW</given-names></name><name><surname>Shelley</surname><given-names>MJ</given-names></name><name><surname>Ristroph</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Hydrodynamic schooling of flapping swimmers</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>8514</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms9514</pub-id><pub-id pub-id-type="pmid">26439509</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berlinger</surname><given-names>F</given-names></name><name><surname>Gauci</surname><given-names>M</given-names></name><name><surname>Nagpal</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Implicit coordination for 3D underwater collective behaviors in a fish-inspired robot swarm</article-title><source>Science Robotics</source><volume>6</volume><elocation-id>eabd8668</elocation-id><pub-id pub-id-type="doi">10.1126/scirobotics.abd8668</pub-id><pub-id pub-id-type="pmid">34043581</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>APS</given-names></name><name><surname>Bale</surname><given-names>R</given-names></name><name><surname>Griffith</surname><given-names>BE</given-names></name><name><surname>Patankar</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A unified mathematical framework and an adaptive numerical method for fluid–structure interaction with rigid, deforming, and elastic bodies</article-title><source>Journal of Computational Physics</source><volume>250</volume><fpage>446</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2013.04.033</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhalla</surname><given-names>APS</given-names></name><name><surname>Nangia</surname><given-names>N</given-names></name><name><surname>Dafnakis</surname><given-names>P</given-names></name><name><surname>Bracco</surname><given-names>G</given-names></name><name><surname>Mattiazzo</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Simulating water-entry/exit problems using Eulerian–Lagrangian and fully-Eulerian fictitious domain methods within the open-source IBAMR library</article-title><source>Applied Ocean Research</source><volume>94</volume><elocation-id>101932</elocation-id><pub-id pub-id-type="doi">10.1016/j.apor.2019.101932</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname><given-names>W</given-names></name><name><surname>Cavagna</surname><given-names>A</given-names></name><name><surname>Giardina</surname><given-names>I</given-names></name><name><surname>Mora</surname><given-names>T</given-names></name><name><surname>Silvestri</surname><given-names>E</given-names></name><name><surname>Viale</surname><given-names>M</given-names></name><name><surname>Walczak</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Statistical mechanics for natural flocks of birds</article-title><source>PNAS</source><volume>109</volume><fpage>4786</fpage><lpage>4791</lpage><pub-id pub-id-type="doi">10.1073/pnas.1118633109</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blocken</surname><given-names>B</given-names></name><name><surname>van Druenen</surname><given-names>T</given-names></name><name><surname>Toparlar</surname><given-names>Y</given-names></name><name><surname>Malizia</surname><given-names>F</given-names></name><name><surname>Mannion</surname><given-names>P</given-names></name><name><surname>Andrianne</surname><given-names>T</given-names></name><name><surname>Marchal</surname><given-names>T</given-names></name><name><surname>Maas</surname><given-names>G-J</given-names></name><name><surname>Diepens</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Aerodynamic drag in cycling pelotons: New insights by CFD simulation and wind tunnel testing</article-title><source>Journal of Wind Engineering and Industrial Aerodynamics</source><volume>179</volume><fpage>319</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1016/j.jweia.2018.06.011</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Colvert</surname><given-names>B</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fishlike rheotaxis</article-title><source>Journal of Fluid Mechanics</source><volume>793</volume><fpage>656</fpage><lpage>666</lpage><pub-id pub-id-type="doi">10.1017/jfm.2016.141</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coppola</surname><given-names>M</given-names></name><name><surname>McGuire</surname><given-names>KN</given-names></name><name><surname>De Wagter</surname><given-names>C</given-names></name><name><surname>de Croon</surname><given-names>GCHE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A survey on swarming with micro air vehicles: fundamental challenges and constraints</article-title><source>Frontiers in Robotics and AI</source><volume>7</volume><elocation-id>18</elocation-id><pub-id pub-id-type="doi">10.3389/frobt.2020.00018</pub-id><pub-id pub-id-type="pmid">33501187</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name><name><surname>James</surname><given-names>R</given-names></name><name><surname>Ruxton</surname><given-names>GD</given-names></name><name><surname>Franks</surname><given-names>NR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Collective memory and spatial sorting in animal groups</article-title><source>Journal of Theoretical Biology</source><volume>218</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2002.3065</pub-id><pub-id pub-id-type="pmid">12297066</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin</surname><given-names>ID</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Self-organization and collective behavior in vertebrates</article-title><source>Advances in the Study of Behavior</source><volume>32</volume><fpage>10</fpage><lpage>1016</lpage><pub-id pub-id-type="doi">10.1016/S0065-3454(03)01001-5</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Croft</surname><given-names>DP</given-names></name><name><surname>James</surname><given-names>R</given-names></name><name><surname>Krause</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Exploring Animal Social Networks</source><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dai</surname><given-names>L</given-names></name><name><surname>He</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Stable formations of self-propelled fish-like swimmers induced by hydrodynamic interactions</article-title><source>Journal of the Royal Society, Interface</source><volume>15</volume><elocation-id>20180490</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2018.0490</pub-id><pub-id pub-id-type="pmid">30333246</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>R</given-names></name><name><surname>Peterson</surname><given-names>SD</given-names></name><name><surname>Porfiri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Stability of schooling patterns of a fish pair swimming against a flow</article-title><source>Flow</source><volume>3</volume><elocation-id>E31</elocation-id><pub-id pub-id-type="doi">10.1017/flo.2023.25</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Douglas</surname><given-names>R</given-names></name><name><surname>Djamgoz</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>The Visual System of Fish</source><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="doi">10.1007/978-94-009-0411-8</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelmann</surname><given-names>J</given-names></name><name><surname>Hanke</surname><given-names>W</given-names></name><name><surname>Mogdans</surname><given-names>J</given-names></name><name><surname>Bleckmann</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Hydrodynamic stimuli and the fish lateral line</article-title><source>Nature</source><volume>408</volume><fpage>51</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1038/35040706</pub-id><pub-id pub-id-type="pmid">11081502</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Hydrodynamic Interactions between Self-Propelled Flapping Wings</source><publisher-name>New York University</publisher-name></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farine</surname><given-names>DR</given-names></name><name><surname>Whitehead</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Constructing, conducting and interpreting animal social network analysis</article-title><source>The Journal of Animal Ecology</source><volume>84</volume><fpage>1144</fpage><lpage>1163</lpage><pub-id pub-id-type="doi">10.1111/1365-2656.12418</pub-id><pub-id pub-id-type="pmid">26172345</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fernald</surname><given-names>RD</given-names></name></person-group><year iso-8601-date="1989">1989</year><chapter-title>Fish vision</chapter-title><person-group person-group-type="editor"><name><surname>Finlay</surname><given-names>BL</given-names></name><name><surname>Sengelaub</surname><given-names>DR</given-names></name></person-group><source>Development of the Vertebrate Retina</source><publisher-name>Springer</publisher-name><fpage>247</fpage><lpage>265</lpage><pub-id pub-id-type="doi">10.1007/978-1-4684-5592-2_11</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fish</surname><given-names>FE</given-names></name><name><surname>Hui</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Dolphin swimming–a review</article-title><source>Mammal Review</source><volume>21</volume><fpage>181</fpage><lpage>195</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2907.1991.tb00292.x</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Floryan</surname><given-names>D</given-names></name><name><surname>Van Buren</surname><given-names>T</given-names></name><name><surname>Rowley</surname><given-names>CW</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Scaling the propulsive performance of heaving and pitching foils</article-title><source>Journal of Fluid Mechanics</source><volume>822</volume><fpage>386</fpage><lpage>397</lpage><pub-id pub-id-type="doi">10.1017/jfm.2017.302</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gazzola</surname><given-names>M</given-names></name><name><surname>Hejazialhosseini</surname><given-names>B</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Reinforcement learning and wavelet adapted vortex methods for simulations of self-propelled swimmers</article-title><source>SIAM Journal on Scientific Computing</source><volume>36</volume><fpage>B622</fpage><lpage>B639</lpage><pub-id pub-id-type="doi">10.1137/130943078</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>MA</given-names></name><name><surname>Rowley</surname><given-names>CW</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The unsteady three-dimensional wake produced by a trapezoidal pitching panel</article-title><source>Journal of Fluid Mechanics</source><volume>685</volume><fpage>117</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1017/jfm.2011.286</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffith</surname><given-names>BE</given-names></name><name><surname>Peskin</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>On the order of accuracy of the immersed boundary method: Higher order convergence rates for sufficiently smooth problems</article-title><source>Journal of Computational Physics</source><volume>208</volume><fpage>75</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2005.02.011</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffith</surname><given-names>BE</given-names></name><name><surname>Hornung</surname><given-names>RD</given-names></name><name><surname>McQueen</surname><given-names>DM</given-names></name><name><surname>Peskin</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>An adaptive, formally second order accurate version of the immersed boundary method</article-title><source>Journal of Computational Physics</source><volume>223</volume><fpage>10</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2006.08.019</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffith</surname><given-names>BE</given-names></name><name><surname>Patankar</surname><given-names>NA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Immersed methods for fluid-structure interaction</article-title><source>Annual Review of Fluid Mechanics</source><volume>52</volume><fpage>421</fpage><lpage>448</lpage><pub-id pub-id-type="doi">10.1146/annurev-fluid-010719-060228</pub-id><pub-id pub-id-type="pmid">33012877</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>H</given-names></name><name><surname>Fauci</surname><given-names>L</given-names></name><name><surname>Shelley</surname><given-names>M</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bistability in the synchronization of actuated microfilaments</article-title><source>Journal of Fluid Mechanics</source><volume>836</volume><fpage>304</fpage><lpage>323</lpage><pub-id pub-id-type="doi">10.1017/jfm.2017.816</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Guthrie</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1986">1986</year><chapter-title>Role of vision in fish behaviour</chapter-title><person-group person-group-type="editor"><name><surname>Guthrie</surname><given-names>D</given-names></name></person-group><source>The behaviour of teleost fishes</source><publisher-name>Springer</publisher-name><fpage>75</fpage><lpage>113</lpage><pub-id pub-id-type="doi">10.1007/978-1-4684-8261-4_4</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hang</surname><given-names>H</given-names></name><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Costello</surname><given-names>JH</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Active tail flexion in concert with passive hydrodynamic forces improves swimming speed and efficiency</article-title><source>Journal of Fluid Mechanics</source><volume>932</volume><elocation-id>984</elocation-id><pub-id pub-id-type="doi">10.1017/jfm.2021.984</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Hang</surname><given-names>H</given-names></name><name><surname>Jiao</surname><given-names>Y</given-names></name><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Ling</surname><given-names>F</given-names></name><name><surname>Merel</surname><given-names>J</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Interpretable and Generalizable Strategies for Stably Following Hydrodynamic Trails</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.12.15.571932</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Hang</surname><given-names>H</given-names></name><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Feedback control of uncoordinated flapping swimmers to maintain school cohesion</article-title><conf-name>ACC Conference</conf-name></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Herskin</surname><given-names>J</given-names></name><name><surname>Steffensen</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Energy savings in sea bass swimming in a school: measurements of tail beat frequency and oxygen consumption at different swimming speeds</article-title><source>Journal of Fish Biology</source><volume>53</volume><fpage>366</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1111/j.1095-8649.1998.tb00986.x</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>School cohesion, speed and efficiency are modulated by the swimmers flapping motion</article-title><source>Journal of Fluid Mechanics</source><volume>922</volume><elocation-id>A27</elocation-id><pub-id pub-id-type="doi">10.1017/jfm.2021.551</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoover</surname><given-names>AP</given-names></name><name><surname>Cortez</surname><given-names>R</given-names></name><name><surname>Tytell</surname><given-names>ED</given-names></name><name><surname>Fauci</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Swimming performance, resonance and shape evolution in heaving flexible panels</article-title><source>Journal of Fluid Mechanics</source><volume>847</volume><fpage>386</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1017/jfm.2018.305</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoover</surname><given-names>AP</given-names></name><name><surname>Tytell</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Decoding the relationships between body shape, tail beat frequency, and stability for swimming fish</article-title><source>Fluids</source><volume>5</volume><elocation-id>215</elocation-id><pub-id pub-id-type="doi">10.3390/fluids5040215</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoover</surname><given-names>AP</given-names></name><name><surname>Daniels</surname><given-names>J</given-names></name><name><surname>Nawroth</surname><given-names>JC</given-names></name><name><surname>Katija</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A computational model for tail undulation and fluid transport in the giant larvacean</article-title><source>Fluids</source><volume>6</volume><elocation-id>88</elocation-id><pub-id pub-id-type="doi">10.3390/fluids6020088</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Nitsche</surname><given-names>M</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Hovering in oscillatory flows</article-title><source>Journal of Fluid Mechanics</source><volume>804</volume><fpage>531</fpage><lpage>549</lpage><pub-id pub-id-type="doi">10.1017/jfm.2016.535</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Ristroph</surname><given-names>L</given-names></name><name><surname>Luhar</surname><given-names>M</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bistability in the rotational motion of rigid and flexible flyers</article-title><source>Journal of Fluid Mechanics</source><volume>849</volume><fpage>1043</fpage><lpage>1067</lpage><pub-id pub-id-type="doi">10.1017/jfm.2018.446</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hultmark</surname><given-names>M</given-names></name><name><surname>Leftwich</surname><given-names>M</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Flowfield measurements in the wake of a robotic lamprey</article-title><source>Experiments in Fluids</source><volume>43</volume><fpage>683</fpage><lpage>690</lpage><pub-id pub-id-type="doi">10.1007/s00348-007-0412-1</pub-id><pub-id pub-id-type="pmid">19946623</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="software"><person-group person-group-type="author"><collab>IBAMR</collab></person-group><year iso-8601-date="2024">2024</year><data-title>IBAMR:an adaptive and distributed-memory parallel implementation of the immersed boundary (IB) method</data-title><version designator="0.1">0.1</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://ibamr.github.io/">https://ibamr.github.io/</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiao</surname><given-names>Y</given-names></name><name><surname>Ling</surname><given-names>F</given-names></name><name><surname>Heydari</surname><given-names>S</given-names></name><name><surname>Heess</surname><given-names>N</given-names></name><name><surname>Merel</surname><given-names>J</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Learning to swim in potential flow</article-title><source>Physical Review Fluids</source><volume>6</volume><elocation-id>050505</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevFluids.6.050505</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiao</surname><given-names>Y</given-names></name><name><surname>Colvert</surname><given-names>B</given-names></name><name><surname>Man</surname><given-names>Y</given-names></name><name><surname>McHenry</surname><given-names>MJ</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Evaluating evasion strategies in zebrafish larvae</article-title><source>PNAS</source><volume>120</volume><elocation-id>e2218909120</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2218909120</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The separated flow of an inviscid fluid around a moving flat plate</article-title><source>Journal of Fluid Mechanics</source><volume>496</volume><fpage>405</fpage><lpage>441</lpage><pub-id pub-id-type="doi">10.1017/S0022112003006645</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>MA</given-names></name><name><surname>Shelley</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Falling cards</article-title><source>Journal of Fluid Mechanics</source><volume>540</volume><elocation-id>393</elocation-id><pub-id pub-id-type="doi">10.1017/S0022112005005859</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanso</surname><given-names>E</given-names></name><name><surname>Cheng Hou Tsang</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Dipole models of self-propelled bodies</article-title><source>Fluid Dynamics Research</source><volume>46</volume><elocation-id>061407</elocation-id><pub-id pub-id-type="doi">10.1088/0169-5983/46/6/061407</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kern</surname><given-names>S</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Simulations of optimized anguilliform swimming</article-title><source>The Journal of Experimental Biology</source><volume>209</volume><fpage>4841</fpage><lpage>4857</lpage><pub-id pub-id-type="doi">10.1242/jeb.02526</pub-id><pub-id pub-id-type="pmid">17142673</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Killen</surname><given-names>SS</given-names></name><name><surname>Marras</surname><given-names>S</given-names></name><name><surname>Steffensen</surname><given-names>JF</given-names></name><name><surname>McKenzie</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Aerobic capacity influences the spatial position of individuals within fish schools</article-title><source>Proceedings of the Royal Society B</source><volume>279</volume><fpage>357</fpage><lpage>364</lpage><pub-id pub-id-type="doi">10.1098/rspb.2011.1006</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Huang</surname><given-names>WX</given-names></name><name><surname>Sung</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Constructive and destructive interaction modes between two tandem flexible flags in viscous flow</article-title><source>Journal of Fluid Mechanics</source><volume>661</volume><fpage>511</fpage><lpage>521</lpage><pub-id pub-id-type="doi">10.1017/S0022112010003514</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurt</surname><given-names>M</given-names></name><name><surname>Moored</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Flow interactions of two- and three-dimensional networked bio-inspired control elements in an in-line arrangement</article-title><source>Bioinspiration &amp; Biomimetics</source><volume>13</volume><elocation-id>045002</elocation-id><pub-id pub-id-type="doi">10.1088/1748-3190/aabf4c</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kurt</surname><given-names>M</given-names></name><name><surname>Mivehchi</surname><given-names>A</given-names></name><name><surname>Moored</surname><given-names>KW</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Two-dimensionally stable self-organization arises in simple schooling swimmers through hydrodynamic interactions</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/2102.03571v3">https://arxiv.org/pdf/2102.03571v3</ext-link></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lauder</surname><given-names>GV</given-names></name><name><surname>Lim</surname><given-names>J</given-names></name><name><surname>Shelton</surname><given-names>R</given-names></name><name><surname>Witt</surname><given-names>C</given-names></name><name><surname>Anderson</surname><given-names>E</given-names></name><name><surname>Tangorra</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Robotic models for studying undulatory locomotion in fishes</article-title><source>Marine Technology Society Journal</source><volume>45</volume><fpage>41</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.4031/MTSJ.45.4.8</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>JH</given-names></name><name><surname>Rygg</surname><given-names>AD</given-names></name><name><surname>Kolahdouz</surname><given-names>EM</given-names></name><name><surname>Rossi</surname><given-names>S</given-names></name><name><surname>Retta</surname><given-names>SM</given-names></name><name><surname>Duraiswamy</surname><given-names>N</given-names></name><name><surname>Scotten</surname><given-names>LN</given-names></name><name><surname>Craven</surname><given-names>BA</given-names></name><name><surname>Griffith</surname><given-names>BE</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Fluid-structure interaction models of bioprosthetic heart valve dynamics in an experimental pulse duplicator</article-title><source>Annals of Biomedical Engineering</source><volume>48</volume><fpage>1475</fpage><lpage>1490</lpage><pub-id pub-id-type="doi">10.1007/s10439-020-02466-4</pub-id><pub-id pub-id-type="pmid">32034607</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Leonard</surname><given-names>NE</given-names></name><name><surname>Fiorelli</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Virtual leaders, artificial potentials and coordinated control of groups</article-title><conf-name>40th Conference on Decision and Control</conf-name><conf-loc>Orlando, FL, USA</conf-loc><fpage>2968</fpage><lpage>2973</lpage><pub-id pub-id-type="doi">10.1109/CDC.2001.980728</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Nagy</surname><given-names>M</given-names></name><name><surname>Graving</surname><given-names>JM</given-names></name><name><surname>Bak-Coleman</surname><given-names>J</given-names></name><name><surname>Xie</surname><given-names>G</given-names></name><name><surname>Couzin</surname><given-names>ID</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Vortex phase matching as a strategy for schooling in robots and in fish</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>5408</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-19086-0</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Liu</surname><given-names>D</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Lutz</surname><given-names>MJ</given-names></name><name><surname>Xie</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Fish can save energy via proprioceptive sensing</article-title><source>Bioinspiration &amp; Biomimetics</source><volume>16</volume><elocation-id>056013</elocation-id><pub-id pub-id-type="doi">10.1088/1748-3190/ac165e</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>Z</given-names></name><name><surname>Bhalla</surname><given-names>APS</given-names></name><name><surname>Griffith</surname><given-names>B</given-names></name><name><surname>Sheng</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Liang</surname><given-names>D</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>How Swimming Style Affects Schooling of Two Fish-like Wavy Hydrofoils</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2209.01590">https://arxiv.org/abs/2209.01590</ext-link></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lombana</surname><given-names>DAB</given-names></name><name><surname>Porfiri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Collective response of fish to combined manipulations of illumination and flow</article-title><source>Behavioural Processes</source><volume>203</volume><elocation-id>104767</elocation-id><pub-id pub-id-type="doi">10.1016/j.beproc.2022.104767</pub-id><pub-id pub-id-type="pmid">36252852</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lushi</surname><given-names>E</given-names></name><name><surname>Wioland</surname><given-names>H</given-names></name><name><surname>Goldstein</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fluid flows created by swimming bacteria drive self-organization in confined suspensions</article-title><source>PNAS</source><volume>111</volume><fpage>9733</fpage><lpage>9738</lpage><pub-id pub-id-type="doi">10.1073/pnas.1405698111</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marras</surname><given-names>S</given-names></name><name><surname>Porfiri</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fish and robots swimming together: attraction towards the robot demands biomimetic locomotion</article-title><source>Journal of the Royal Society, Interface</source><volume>9</volume><fpage>1856</fpage><lpage>1868</lpage><pub-id pub-id-type="doi">10.1098/rsif.2012.0084</pub-id><pub-id pub-id-type="pmid">22356819</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marras</surname><given-names>S</given-names></name><name><surname>Killen</surname><given-names>SS</given-names></name><name><surname>Lindström</surname><given-names>J</given-names></name><name><surname>McKenzie</surname><given-names>DJ</given-names></name><name><surname>Steffensen</surname><given-names>JF</given-names></name><name><surname>Domenici</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Fish swimming in schools save energy regardless of their spatial position</article-title><source>Behavioral Ecology and Sociobiology</source><volume>69</volume><fpage>219</fpage><lpage>226</lpage><pub-id pub-id-type="doi">10.1007/s00265-014-1834-4</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKee</surname><given-names>A</given-names></name><name><surname>Soto</surname><given-names>AP</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><name><surname>McHenry</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The sensory basis of schooling by intermittent swimming in the rummy-nose tetra (<italic>Hemigrammus rhodostomus</italic>)</article-title><source>Proceedings of the Royal Society B</source><volume>287</volume><elocation-id>20200568</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2020.0568</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirzaeinia</surname><given-names>A</given-names></name><name><surname>Heppner</surname><given-names>F</given-names></name><name><surname>Hassanalian</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>An analytical study on leader and follower switching in V-shaped Canada Goose flocks for energy management purposes</article-title><source>Swarm Intelligence</source><volume>14</volume><fpage>117</fpage><lpage>141</lpage><pub-id pub-id-type="doi">10.1007/s11721-020-00179-x</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mittal</surname><given-names>R</given-names></name><name><surname>Dong</surname><given-names>H</given-names></name><name><surname>Bozkurttas</surname><given-names>M</given-names></name><name><surname>Najjar</surname><given-names>FM</given-names></name><name><surname>Vargas</surname><given-names>A</given-names></name><name><surname>von Loebbecke</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A versatile sharp interface immersed boundary method for incompressible flows with complex boundaries</article-title><source>Journal of Computational Physics</source><volume>227</volume><fpage>4825</fpage><lpage>4852</lpage><pub-id pub-id-type="doi">10.1016/j.jcp.2008.01.028</pub-id><pub-id pub-id-type="pmid">20216919</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moored</surname><given-names>KW</given-names></name><name><surname>Dewey</surname><given-names>PA</given-names></name><name><surname>Boschitsch</surname><given-names>BM</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name><name><surname>Haj-Hariri</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Linear instability mechanisms leading to optimally efficient locomotion with flexible propulsors</article-title><source>Physics of Fluids</source><volume>26</volume><elocation-id>4</elocation-id><pub-id pub-id-type="doi">10.1063/1.4872221</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newbolt</surname><given-names>JW</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Ristroph</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Flow interactions between uncoordinated flapping swimmers give rise to group cohesion</article-title><source>PNAS</source><volume>116</volume><fpage>2419</fpage><lpage>2424</lpage><pub-id pub-id-type="doi">10.1073/pnas.1816098116</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newbolt</surname><given-names>JW</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Ristroph</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Lateral flow interactions enhance speed and stabilize formations of flapping swimmers</article-title><source>Physical Review Fluids</source><volume>7</volume><elocation-id>L061101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevFluids.7.L061101</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nitsche</surname><given-names>M</given-names></name><name><surname>Krasny</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>A numerical study of vortex ring formation at the edge of A circular tube</article-title><source>Journal of Fluid Mechanics</source><volume>276</volume><fpage>139</fpage><lpage>161</lpage><pub-id pub-id-type="doi">10.1017/S0022112094002508</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliveira</surname><given-names>HM</given-names></name><name><surname>Melo</surname><given-names>LV</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Huygens synchronization of two clocks</article-title><source>Scientific Reports</source><volume>5</volume><elocation-id>11548</elocation-id><pub-id pub-id-type="doi">10.1038/srep11548</pub-id><pub-id pub-id-type="pmid">26204557</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>SG</given-names></name><name><surname>Sung</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hydrodynamics of flexible fins propelled in tandem, diagonal, triangular and diamond configurations</article-title><source>Journal of Fluid Mechanics</source><volume>840</volume><fpage>154</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1017/jfm.2018.64</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Partridge</surname><given-names>BL</given-names></name><name><surname>Pitcher</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Evidence against a hydrodynamic function for fish schools</article-title><source>Nature</source><volume>279</volume><fpage>418</fpage><lpage>419</lpage><pub-id pub-id-type="doi">10.1038/279418a0</pub-id><pub-id pub-id-type="pmid">16068174</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>ZR</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Lu</surname><given-names>XY</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Hydrodynamic schooling of multiple self-propelled flapping plates</article-title><source>Journal of Fluid Mechanics</source><volume>853</volume><fpage>587</fpage><lpage>600</lpage><pub-id pub-id-type="doi">10.1017/jfm.2018.634</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peskin</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Numerical analysis of blood flow in the heart</article-title><source>Journal of Computational Physics</source><volume>25</volume><fpage>220</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1016/0021-9991(77)90100-0</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Portugal</surname><given-names>SJ</given-names></name><name><surname>Hubel</surname><given-names>TY</given-names></name><name><surname>Fritz</surname><given-names>J</given-names></name><name><surname>Heese</surname><given-names>S</given-names></name><name><surname>Trobe</surname><given-names>D</given-names></name><name><surname>Voelkl</surname><given-names>B</given-names></name><name><surname>Hailes</surname><given-names>S</given-names></name><name><surname>Wilson</surname><given-names>AM</given-names></name><name><surname>Usherwood</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Upwash exploitation and downwash avoidance by flap phasing in ibis formation flight</article-title><source>Nature</source><volume>505</volume><fpage>399</fpage><lpage>402</lpage><pub-id pub-id-type="doi">10.1038/nature12939</pub-id><pub-id pub-id-type="pmid">24429637</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>DB</given-names></name><name><surname>Lauder</surname><given-names>GV</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Scaling the propulsive performance of heaving flexible panels</article-title><source>Journal of Fluid Mechanics</source><volume>738</volume><fpage>250</fpage><lpage>267</lpage><pub-id pub-id-type="doi">10.1017/jfm.2013.597</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramananarivo</surname><given-names>S</given-names></name><name><surname>Fang</surname><given-names>F</given-names></name><name><surname>Oza</surname><given-names>A</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Ristroph</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Flow interactions lead to orderly formations of flapping wings in forward flight</article-title><source>Physical Review Fluids</source><volume>1</volume><elocation-id>071201</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevFluids.1.071201</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ristroph</surname><given-names>L</given-names></name><name><surname>Liao</surname><given-names>JC</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Lateral line layout correlates with the differential hydrodynamic pressure on swimming fish</article-title><source>Physical Review Letters</source><volume>114</volume><elocation-id>018102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.114.018102</pub-id><pub-id pub-id-type="pmid">25615505</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sheng</surname><given-names>JX</given-names></name><name><surname>Ysasi</surname><given-names>A</given-names></name><name><surname>Kolomenskiy</surname><given-names>D</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name><name><surname>Nitsche</surname><given-names>M</given-names></name><name><surname>Schneider</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Simulating vortex wakes of flapping plates</chapter-title><person-group person-group-type="editor"><name><surname>Childress</surname><given-names>S</given-names></name><name><surname>Hosoi</surname><given-names>A</given-names></name><name><surname>Schultz</surname><given-names>WW</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><source>Natural Locomotion in Fluids and on Surfaces</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name><fpage>255</fpage><lpage>262</lpage><pub-id pub-id-type="doi">10.1007/978-1-4614-3997-4_21</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Undulatory and oscillatory swimming</article-title><source>Journal of Fluid Mechanics</source><volume>874</volume><elocation-id>284</elocation-id><pub-id pub-id-type="doi">10.1017/jfm.2019.284</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strogatz</surname><given-names>SH</given-names></name><name><surname>Stewart</surname><given-names>I</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Coupled oscillators and biological synchronization</article-title><source>Scientific American</source><volume>269</volume><fpage>102</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1038/scientificamerican1293-102</pub-id><pub-id pub-id-type="pmid">8266056</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Strogatz</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="1994">1994</year><source>Nonlinear Dynamics and Chaos with Student Solutions Manual: With Applications to Physics, Biology, Chemistry, and Engineering</source><publisher-name>CRC press</publisher-name></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svendsen</surname><given-names>JC</given-names></name><name><surname>Skov</surname><given-names>J</given-names></name><name><surname>Bildsoe</surname><given-names>M</given-names></name><name><surname>Steffensen</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Intra‐school positional preference and reduced tail beat frequency in trailing positions in schooling roach under experimental conditions</article-title><source>Journal of Fish Biology</source><volume>62</volume><fpage>834</fpage><lpage>846</lpage><pub-id pub-id-type="doi">10.1046/j.1095-8649.2003.00068.x</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taira</surname><given-names>K</given-names></name><name><surname>Colonius</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Three-dimensional flows around low-aspect-ratio flat-plate wings at low Reynolds numbers</article-title><source>Journal of Fluid Mechanics</source><volume>623</volume><fpage>187</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1017/S0022112008005314</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>GK</given-names></name><name><surname>Nudds</surname><given-names>RL</given-names></name><name><surname>Thomas</surname><given-names>ALR</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Flying and swimming animals cruise at a Strouhal number tuned for high power efficiency</article-title><source>Nature</source><volume>425</volume><fpage>707</fpage><lpage>711</lpage><pub-id pub-id-type="doi">10.1038/nature02000</pub-id><pub-id pub-id-type="pmid">14562101</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thandiackal</surname><given-names>R</given-names></name><name><surname>Lauder</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>In-line swimming dynamics revealed by fish interacting with a robotic mechanism</article-title><source>eLife</source><volume>12</volume><elocation-id>e81392</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.81392</pub-id><pub-id pub-id-type="pmid">36744863</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Triantafyllou</surname><given-names>GS</given-names></name><name><surname>Triantafyllou</surname><given-names>MS</given-names></name><name><surname>Grosenbaugh</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Optimal thrust development in oscillating foils with application to fish propulsion</article-title><source>Journal of Fluids and Structures</source><volume>7</volume><fpage>205</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1006/jfls.1993.1012</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Triantafyllou</surname><given-names>MS</given-names></name><name><surname>Triantafyllou</surname><given-names>GS</given-names></name><name><surname>Yue</surname><given-names>DKP</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Hydrodynamics of fishlike swimming</article-title><source>Annual Review of Fluid Mechanics</source><volume>32</volume><fpage>33</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1146/annurev.fluid.32.1.33</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsang</surname><given-names>ACH</given-names></name><name><surname>Kanso</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Dipole interactions in doubly periodic domains</article-title><source>Journal of Nonlinear Science</source><volume>23</volume><fpage>971</fpage><lpage>991</lpage><pub-id pub-id-type="doi">10.1007/s00332-013-9174-5</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsien</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="1943">1943</year><article-title>Symmetrical Joukowsky airfoils in shear flow</article-title><source>Quarterly of Applied Mathematics</source><volume>1</volume><fpage>130</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1090/qam/8537</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname><given-names>ED</given-names></name><name><surname>Lauder</surname><given-names>GV</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The hydrodynamics of eel swimming: I. Wake structure</article-title><source>The Journal of Experimental Biology</source><volume>207</volume><fpage>1825</fpage><lpage>1841</lpage><pub-id pub-id-type="doi">10.1242/jeb.00968</pub-id><pub-id pub-id-type="pmid">15107438</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname><given-names>ED</given-names></name><name><surname>Hsu</surname><given-names>CY</given-names></name><name><surname>Fauci</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The role of mechanical resonance in the neural control of swimming in fishes</article-title><source>Zoology</source><volume>117</volume><fpage>48</fpage><lpage>56</lpage><pub-id pub-id-type="doi">10.1016/j.zool.2013.10.011</pub-id><pub-id pub-id-type="pmid">24433627</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tytell</surname><given-names>ED</given-names></name><name><surname>Leftwich</surname><given-names>MC</given-names></name><name><surname>Hsu</surname><given-names>CY</given-names></name><name><surname>Griffith</surname><given-names>BE</given-names></name><name><surname>Cohen</surname><given-names>AH</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name><name><surname>Hamlet</surname><given-names>C</given-names></name><name><surname>Fauci</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Role of body stiffness in undulatory swimming: Insights from robotic and computational models</article-title><source>Physical Review Fluids</source><volume>1</volume><elocation-id>073202</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevFluids.1.073202</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Usherwood</surname><given-names>JR</given-names></name><name><surname>Stavrou</surname><given-names>M</given-names></name><name><surname>Lowe</surname><given-names>JC</given-names></name><name><surname>Roskilly</surname><given-names>K</given-names></name><name><surname>Wilson</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Flying in a flock comes at a cost in pigeons</article-title><source>Nature</source><volume>474</volume><fpage>494</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1038/nature10164</pub-id><pub-id pub-id-type="pmid">21697946</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Buren</surname><given-names>T</given-names></name><name><surname>Floryan</surname><given-names>D</given-names></name><name><surname>Smits</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Scaling and performance of simultaneously heaving and pitching foils</article-title><source>AIAA Journal</source><volume>57</volume><fpage>3666</fpage><lpage>3677</lpage><pub-id pub-id-type="doi">10.2514/1.J056635</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Veen</surname><given-names>WG</given-names></name><name><surname>van Leeuwen</surname><given-names>JL</given-names></name><name><surname>Muijres</surname><given-names>FT</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Malaria mosquitoes use leg push-off forces to control body pitch during take-off</article-title><source>Journal of Experimental Zoology. Part A, Ecological and Integrative Physiology</source><volume>333</volume><fpage>38</fpage><lpage>49</lpage><pub-id pub-id-type="doi">10.1002/jez.2308</pub-id><pub-id pub-id-type="pmid">31403265</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Verma</surname><given-names>S</given-names></name><name><surname>Novati</surname><given-names>G</given-names></name><name><surname>Noca</surname><given-names>F</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><source>Fast Motion of Heaving Airfoils</source><publisher-name>Elsevier</publisher-name><pub-id pub-id-type="doi">10.1016/j.procs.2017.05.166</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verma</surname><given-names>S</given-names></name><name><surname>Novati</surname><given-names>G</given-names></name><name><surname>Koumoutsakos</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Efficient collective swimming by harnessing vortices through deep reinforcement learning</article-title><source>PNAS</source><volume>115</volume><fpage>5849</fpage><lpage>5854</lpage><pub-id pub-id-type="doi">10.1073/pnas.1800923115</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voesenek</surname><given-names>CJ</given-names></name><name><surname>Li</surname><given-names>G</given-names></name><name><surname>Muijres</surname><given-names>FT</given-names></name><name><surname>van Leeuwen</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Experimental-numerical method for calculating bending moments in swimming fish shows that fish larvae control undulatory swimming with simple actuation</article-title><source>PLOS Biology</source><volume>18</volume><elocation-id>e3000462</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000462</pub-id><pub-id pub-id-type="pmid">32697779</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Von Ellenrieder</surname><given-names>KD</given-names></name><name><surname>Parker</surname><given-names>K</given-names></name><name><surname>Soria</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Flow structures behind a heaving and pitching finite-span wing</article-title><source>Journal of Fluid Mechanics</source><volume>490</volume><fpage>129</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1017/S0022112003005408</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wan</surname><given-names>KY</given-names></name><name><surname>Goldstein</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Coordinated beating of algal flagella is mediated by basal coupling</article-title><source>PNAS</source><volume>113</volume><fpage>E2784</fpage><lpage>E2793</lpage><pub-id pub-id-type="doi">10.1073/pnas.1518527113</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weihs</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Hydromechanics of Fish Schooling</article-title><source>Nature</source><volume>241</volume><fpage>290</fpage><lpage>291</lpage><pub-id pub-id-type="doi">10.1038/241290a0</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whitehead</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Analysing animal social structure</article-title><source>Animal Behaviour</source><volume>53</volume><fpage>1053</fpage><lpage>1067</lpage><pub-id pub-id-type="doi">10.1006/anbe.1996.0358</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>D</given-names></name><name><surname>Wu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Hydrodynamic interaction of two self-propelled fish swimming in a tandem arrangement</article-title><source>Fluids</source><volume>7</volume><elocation-id>208</elocation-id><pub-id pub-id-type="doi">10.3390/fluids7060208</pub-id></element-citation></ref><ref id="bib108"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>ZM</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Jia</surname><given-names>L</given-names></name><name><surname>Ji</surname><given-names>C</given-names></name><name><surname>Incecik</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Wave-riding and wave-passing by ducklings in formation swimming</article-title><source>Journal of Fluid Mechanics</source><volume>928</volume><elocation-id>R2</elocation-id><pub-id pub-id-type="doi">10.1017/jfm.2021.820</pub-id></element-citation></ref><ref id="bib109"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Lauder</surname><given-names>GV</given-names></name></person-group><year iso-8601-date="2023">2023a</year><article-title>Energetics of collective movement in vertebrates</article-title><source>The Journal of Experimental Biology</source><volume>226</volume><elocation-id>jeb245617</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.245617</pub-id><pub-id pub-id-type="pmid">37905670</pub-id></element-citation></ref><ref id="bib110"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Lauder</surname><given-names>GV</given-names></name></person-group><year iso-8601-date="2023">2023b</year><article-title>Energy conservation by group dynamics in schooling fish</article-title><source>eLife</source><volume>01</volume><elocation-id>02138</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.90352.1</pub-id></element-citation></ref><ref id="bib111"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>He</surname><given-names>G</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Flow-mediated interactions between two self-propelled flapping filaments in tandem configuration</article-title><source>Physical Review Letters</source><volume>113</volume><elocation-id>238105. 10.1103/physrevlett.113.238105</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.238105</pub-id></element-citation></ref><ref id="bib112"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>White</surname><given-names>C</given-names></name><name><surname>Wainwright</surname><given-names>DK</given-names></name><name><surname>Di Santo</surname><given-names>V</given-names></name><name><surname>Lauder</surname><given-names>GV</given-names></name><name><surname>Bart-Smith</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Tuna robotics: a high-frequency experimental platform exploring the performance space of swimming fishes</article-title><source>Science Robotics</source><volume>4</volume><elocation-id>eaax4615</elocation-id><pub-id pub-id-type="doi">10.1126/scirobotics.aax4615</pub-id><pub-id pub-id-type="pmid">33137777</pub-id></element-citation></ref><ref id="bib113"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Y</given-names></name><name><surname>Pang</surname><given-names>JH</given-names></name><name><surname>Tian</surname><given-names>FB</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Stable schooling formations emerge from the combined effect of the active control and passive self-organization</article-title><source>Fluids</source><volume>7</volume><elocation-id>41</elocation-id><pub-id pub-id-type="doi">10.3390/fluids7010041</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s7"><title>Computational Fluid Dynamics (CFD) model</title><p>In our CFD simulations, a swimmer is modeled as a symmetric 2D Joukowsky airfoil (<xref ref-type="bibr" rid="bib93">Tsien, 1943</xref>). The chord length of the airfoil is the characteristic length <inline-formula><mml:math id="inf294"><mml:mi>L</mml:mi></mml:math></inline-formula>, and the maximum thickness is <inline-formula><mml:math id="inf295"><mml:mrow><mml:mn>0.12</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The airfoil undergoes pitching motion around its leading edge. FSI are governed by the incompressible Navier-Stokes equations,<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∇</mml:mi><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Re</mml:mi></mml:mfrac><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi mathvariant="normal">∇</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf296"><mml:mrow><mml:mi>𝐮</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>p</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the velocity and pressure field, respectively. We solved for these fields numerically using IBM that handles the two-way coupled fluid structure interaction (<xref ref-type="bibr" rid="bib77">Peskin, 1977</xref>; <xref ref-type="bibr" rid="bib30">Griffith et al., 2007</xref>; <xref ref-type="bibr" rid="bib29">Griffith and Peskin, 2005</xref>; <xref ref-type="bibr" rid="bib9">Bhalla et al., 2013</xref>; <xref ref-type="bibr" rid="bib31">Griffith and Patankar, 2020</xref>; <xref ref-type="bibr" rid="bib68">Mittal et al., 2008</xref>).</p><p>The immersed boundary formulation involves an Eulerian descriptions of the flow field and a Lagrangian description of the immersed swimmers, modeled as Joukowsky airfoils. The boundary condition is mapped to a body force exerted on the fluid. The Lagrangian and Eulerian variables are correlated by the Dirac delta function, which is smoothed during discretization. Here, we used the implementation developed by the group of Prof. Boyce Griffith, <xref ref-type="bibr" rid="bib45">IBAMR, 2024</xref>, which has long been used to solve problems such as blood flow in heart (<xref ref-type="bibr" rid="bib77">Peskin, 1977</xref>; <xref ref-type="bibr" rid="bib57">Lee et al., 2020</xref>), water entry/exit problems (<xref ref-type="bibr" rid="bib10">Bhalla et al., 2020</xref>), fish’s swimming (<xref ref-type="bibr" rid="bib40">Hoover and Tytell, 2020</xref>; <xref ref-type="bibr" rid="bib95">Tytell et al., 2014</xref>; <xref ref-type="bibr" rid="bib102">Voesenek et al., 2020</xref>), insect’s flight (<xref ref-type="bibr" rid="bib98">Van Buren et al., 2019</xref>; <xref ref-type="bibr" rid="bib99">van Veen et al., 2020</xref>), flexible propulsors (<xref ref-type="bibr" rid="bib41">Hoover et al., 2021</xref>; <xref ref-type="bibr" rid="bib96">Tytell et al., 2016</xref>; <xref ref-type="bibr" rid="bib39">Hoover et al., 2018</xref>), self propulsion of pitching/heaving airfoil (<xref ref-type="bibr" rid="bib39">Hoover et al., 2018</xref>; <xref ref-type="bibr" rid="bib107">Yang and Wu, 2022</xref>), and fish schooling (<xref ref-type="bibr" rid="bib107">Yang and Wu, 2022</xref>; <xref ref-type="bibr" rid="bib61">Lin et al., 2022</xref>). This implementation is based on an adaptive mesh, which enables us to accurately simulate self propulsion and reach steady state in a large computational domain with a reasonable computational cost. The computational domain is a rectangle of dimensions <inline-formula><mml:math id="inf298"><mml:mrow><mml:mn>80</mml:mn><mml:mi>L</mml:mi><mml:mo>×</mml:mo><mml:mn>20</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>, with periodic boundary conditions on the computational domain and no-slip boundary condition on the surface of airfoils. The initial location of the first swimmer is <inline-formula><mml:math id="inf299"><mml:mrow><mml:mn>12</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> away from the right boundary in streamwise direction. The initial distance between the two swimmers <inline-formula><mml:math id="inf300"><mml:mrow><mml:mi>d</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> ranges from <inline-formula><mml:math id="inf301"><mml:mrow><mml:mn>1.5</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf302"><mml:mrow><mml:mn>4</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> to ensure we access different equilibria that emerge in these pairwise formations. The coarsest Eulerian mesh is a uniform 500×125 Cartesian grid. The computational domain close to the airfoils and their wake are refined. There are three layers of refinement mesh, and the refinement ratio for each layer is 4. The simulation timestep is adaptive, with the maximum timestep <inline-formula><mml:math id="inf303"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo lspace="0em" rspace="0em">−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p><p>The hydrodynamic forces <inline-formula><mml:math id="inf304"><mml:msub><mml:mi>F</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf305"><mml:msub><mml:mi>F</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula>, and moment <inline-formula><mml:math id="inf306"><mml:mi>M</mml:mi></mml:math></inline-formula> acting on each swimmer are calculated by integrating over the surface of that swimmer, the traction force <inline-formula><mml:math id="inf307"><mml:mrow><mml:mi>𝝈</mml:mi><mml:mo>⋅</mml:mo><mml:mi>𝐧</mml:mi></mml:mrow></mml:math></inline-formula> and moment <inline-formula><mml:math id="inf308"><mml:mrow><mml:mi>𝐱</mml:mi><mml:mo>×</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>𝝈</mml:mi><mml:mo>⋅</mml:mo><mml:mi>𝐧</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf309"><mml:mrow><mml:mi>𝝈</mml:mi><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mi>p</mml:mi><mml:mi>𝐈</mml:mi><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mo form="prefix" stretchy="false">∇</mml:mo><mml:mi>𝐮</mml:mi><mml:mo>+</mml:mo><mml:mo form="prefix" stretchy="false">∇</mml:mo><mml:msup><mml:mi>𝐮</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the fluid stress tensor, <inline-formula><mml:math id="inf310"><mml:mi>𝐱</mml:mi></mml:math></inline-formula> denotes positions on the surface of that swimmer, and <inline-formula><mml:math id="inf311"><mml:mi>𝐧</mml:mi></mml:math></inline-formula> the unit normal to that airfoil into the fluid. The hydrodynamic forces and moment are used to solve the equations of motion (<xref ref-type="disp-formula" rid="equ1">Equation 1</xref>) for each swimmer and obtain the active moment <inline-formula><mml:math id="inf312"><mml:msub><mml:mi>M</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> needed to evaluate the hydrodynamic power in <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> that is expended by each swimmer.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s8"><title>Vortex sheet (VS) model</title><p>In the VS model, each swimmer is modeled as a rigid plate of length <inline-formula><mml:math id="inf313"><mml:mi>L</mml:mi></mml:math></inline-formula>, and it is approximated by a bound vortex sheet, denoted by <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></inline-formula>, whose strength ensures that no fluid flows through the rigid plate, and the separated shear layer is approximated by a free regularized vortex sheet <inline-formula><mml:math id="inf315"><mml:msub><mml:mi>l</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:math></inline-formula> at the trailing edge of the swimmer. The total shed circulation <inline-formula><mml:math id="inf316"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:math></inline-formula> in the vortex sheet is determined so as to satisfy the Kutta condition at the trailing edge, which is given in terms of the tangential velocity components above and below the bound sheet and ensures that the pressure jump across the sheet vanishes at the trailing edge. To express these concepts mathematically, it is convenient to introduce the complex notation, such that <inline-formula><mml:math id="inf317"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf318"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo form="prefix" stretchy="false" lspace="0em" rspace="0em">−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>. For more details on the VS model and our implementation of it, we refer the readers to appendix A of <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>, as well as to <xref ref-type="bibr" rid="bib72">Nitsche and Krasny, 1994</xref>; <xref ref-type="bibr" rid="bib48">Jones, 2003</xref>; <xref ref-type="bibr" rid="bib82">Sheng et al., 2012</xref>; <xref ref-type="bibr" rid="bib49">Jones and Shelley, 2005</xref>; <xref ref-type="bibr" rid="bib1">Alben and Shelley, 2008</xref>; <xref ref-type="bibr" rid="bib2">Alben, 2009</xref>; <xref ref-type="bibr" rid="bib42">Huang et al., 2016</xref>; <xref ref-type="bibr" rid="bib43">Huang et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Hang et al., 2022</xref>.</p><p>The pressure difference across the infinitely thin swimmers <inline-formula><mml:math id="inf319"><mml:mrow><mml:mi>n</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo lspace="0em" rspace="0em">∓</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is given by integrating the balance of momentum equation for inviscid planar flow along a closed contour containing the vortex sheet and trailing edge. Here, <inline-formula><mml:math id="inf320"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unit normal, in complex notation, and <inline-formula><mml:math id="inf321"><mml:mrow><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo lspace="0em" rspace="0em">∓</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is the jump in pressure across the swimmer. The hydrodynamic force <inline-formula><mml:math id="inf322"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="false">∫</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:msub><mml:mi>n</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo lspace="0em" rspace="0em">∓</mml:mo></mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> acting on the swimmer is given by<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>n</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>∓</mml:mo></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:mi>F</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The hydrodynamic moment <inline-formula><mml:math id="inf323"><mml:mi>M</mml:mi></mml:math></inline-formula> acting on the swimmer about its leading edge is given by<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>∓</mml:mo></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf324"><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>.</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is position of the leading edge <inline-formula><mml:math id="inf325"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We introduce a drag force <inline-formula><mml:math id="inf326"><mml:mi>D</mml:mi></mml:math></inline-formula> that emulates the effect of skin friction due to fluid viscosity in the context of the VS model (<xref ref-type="bibr" rid="bib22">Fang, 2016</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>). Namely, following <xref ref-type="bibr" rid="bib22">Fang, 2016</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>, we write the drag force for a swimming plate<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover><mml:mi>U</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>+</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mover><mml:mi>U</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>C</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> is a drag coefficient and <inline-formula><mml:math id="inf328"><mml:msub><mml:menclose notation="top" class="tml-overline"><mml:mi>U</mml:mi></mml:menclose><mml:mo lspace="0em" rspace="0em">±</mml:mo></mml:msub></mml:math></inline-formula> are the spatially averaged tangential fluid velocities on the upper and lower side of the plate, respectively, relative to the swimming velocity <inline-formula><mml:math id="inf329"><mml:mi>U</mml:mi></mml:math></inline-formula>,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mover><mml:mi>U</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf330"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mo lspace="0em" rspace="0em">∓</mml:mo></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the tangential slip velocities on both sides of the plate. We estimate <inline-formula><mml:math id="inf331"><mml:msub><mml:mi>C</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></inline-formula> to be approximately 0.05 in the experiments of <xref ref-type="bibr" rid="bib80">Ramananarivo et al., 2016</xref>. Additionally, following <xref ref-type="bibr" rid="bib42">Huang et al., 2016</xref>; <xref ref-type="bibr" rid="bib43">Huang et al., 2018</xref>; <xref ref-type="bibr" rid="bib34">Hang et al., 2022</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>, we emulate the effect of viscosity on the wake itself by allowing the shed vortex sheets to decay gradually by dissipating each incremental point vortex after a finite time <inline-formula><mml:math id="inf332"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub></mml:math></inline-formula> from the time it is shed into the fluid. Larger <inline-formula><mml:math id="inf333"><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub></mml:math></inline-formula> implies that the incrementally shed vorticity along the vortex sheet stays in the fluid for longer times, mimicking the effect of lower fluid viscosity. We studied the effect of dissipation time in <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplements 2</xref> and <xref ref-type="fig" rid="fig1s3">3</xref>, and used <inline-formula><mml:math id="inf334"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mn>2.45</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> in the rest of this paper for the sake of computational cost. Pitching motions are produced by an active moment <inline-formula><mml:math id="inf335"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> imposed by the swimmer on the surrounding fluid about the leading edge. The value of <inline-formula><mml:math id="inf336"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is obtained from the balance of angular momentum about the swimmer’s leading edge (l.e.),<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mspace width="1em"/><mml:mi>I</mml:mi><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the VS model, <inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> is the swimmer’s moment of inertia about the leading edge, <inline-formula><mml:math id="inf338"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mi>.</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the swimmer’s velocity at the leading edge (in complex form), and <inline-formula><mml:math id="inf339"><mml:mi>M</mml:mi></mml:math></inline-formula> is the hydrodynamic moment about the leading edge given in <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. The hydrodynamic power <inline-formula><mml:math id="inf340"><mml:mi>P</mml:mi></mml:math></inline-formula> expended by the flapping swimmer to maintain its pitching motion is given by<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s9"><title>Time-delay particle model</title><p>We supplemented these CFD and VS models by studying pairwise interactions in the context of the minimal particle model used in <xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>. This particle model was designed for inline swimmers. Here, we modify it slightly to account for lateral offset <inline-formula><mml:math id="inf341"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> between the swimmers as shown in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>. In a nutshell, the model assumes that the leader leaves behind a vertical wake speed equal to the leader’s flapping speed at the tail. The speed of the ‘wake’ that is left behind decays exponentially in time, as an approximation for viscous dissipation. Details of the model can be found in the Supplementary Information of <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>.</p><p>In this model, each swimmer is a particle of mass per unit depth <inline-formula><mml:math id="inf342"><mml:mi>m</mml:mi></mml:math></inline-formula> undergoing vertical oscillations such that <inline-formula><mml:math id="inf343"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf344"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf345"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mspace width="0.1667em"/><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mspace width="0.1667em"/></mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> is the tailbeat amplitude of the pitching airfoil. In this model, each particle is assumed to experience a thrust force <inline-formula><mml:math id="inf346"><mml:msub><mml:mi>F</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> that is proportional to the square of its vertical velocity relative to the surrounding fluid, and a drag force <inline-formula><mml:math id="inf347"><mml:msub><mml:mi>D</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> relative to its relative horizontal speed. Namely,<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mi>L</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf349"><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:math></inline-formula> are the <inline-formula><mml:math id="inf350"><mml:mi>x</mml:mi></mml:math></inline-formula>- and <inline-formula><mml:math id="inf351"><mml:mi>y</mml:mi></mml:math></inline-formula>-components of the fluid velocity, <inline-formula><mml:math id="inf352"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are constant thrust and drag coefficients. Since the leader swims into quiescent fluid, we assume that <inline-formula><mml:math id="inf353"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo separator="true">,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The follower swims into the wake of the leader, which we assume to have zero horizontal velocity (<inline-formula><mml:math id="inf354"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and vertical velocity that decays exponentially both in time and in the lateral direction,<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>h</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf355"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> is the delay time between the leader and follower, i.e., the time past since the leader passed by the follower’s current location: <inline-formula><mml:math id="inf356"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We added the last term in <xref ref-type="disp-formula" rid="equ11">Equation 11</xref> to consider decay in the lateral direction <inline-formula><mml:math id="inf357"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>; to estimate the parameters <inline-formula><mml:math id="inf358"><mml:mi>p</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf359"><mml:mi>h</mml:mi></mml:math></inline-formula>, we used a best curve fit to the data of period-average velocity magnitude versus lateral distance in the wake of a single swimmer in the VS model (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). We numerically integrated (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>) and solved for the motion of the follower. At steady state, we computed the separation distance <inline-formula><mml:math id="inf360"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> between the pair acting on the follower for a range of <inline-formula><mml:math id="inf361"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo separator="true">,</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf362"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>∈</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mo form="prefix" stretchy="false">−</mml:mo><mml:mi>L</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>L</mml:mi><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). The parameter values are chosen to be consistent with the experiments of Newbolt et al. (provided in Table S1 of SI in <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>). Specifically, <inline-formula><mml:math id="inf363"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.1667em"/><mml:msup><mml:mtext>g/cm </mml:mtext><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.1667em"/><mml:mtext>cm</mml:mtext></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf365"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>5.3</mml:mn><mml:mspace width="0.1667em"/><mml:mtext>g/cm</mml:mtext></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf366"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.25</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf367"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.96</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf368"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec></app><app id="appendix-4"><title>Appendix 4</title><sec sec-type="appendix" id="s10"><title>Flow agreement and thrust parameters</title><p>The flow agreement parameter field is defined<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf369"><mml:mrow><mml:mi>𝐮</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the flow field of an oncoming wake and <inline-formula><mml:math id="inf370"><mml:mrow><mml:mi>𝐯</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is flapping velocity of a virtual particle located at a location <inline-formula><mml:math id="inf371"><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo separator="true">,</mml:mo><mml:mi>y</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the oncoming wake. The thrust parameter field is defined as<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To further illustrate the meaning of these parameters, we considered an ideal scenario, where the flow velocity is simply of the form of<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>U</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf372"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the transverse fluid velocity. We placed a virtual or ‘ghost’ swimmer heaving at a velocity <inline-formula><mml:math id="inf373"><mml:mrow><mml:mi>v</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo separator="true">;</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Under this scenario, flow agreement parameter is<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and thrust parameter is<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let’s now consider a balance of forces on the ‘ghost swimmer’. The ghost swimmer is in relative equilibrium if the sum of drag forces <inline-formula><mml:math id="inf374"><mml:mi>D</mml:mi></mml:math></inline-formula> and thrust forces <inline-formula><mml:math id="inf375"><mml:mi>𝕋</mml:mi></mml:math></inline-formula> are zero,<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mo stretchy="false">⇒</mml:mo><mml:mspace width="1em"/><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mo stretchy="false">⇒</mml:mo><mml:mspace width="1em"/><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msup><mml:mi>cos</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Substituting back into <xref ref-type="disp-formula" rid="equ1">Equation 15</xref>, we get<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>According to our prediction based on the flow agreement parameter, equilibria are located at maximal flow agreement parameter, for which <inline-formula><mml:math id="inf376"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf377"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This is close to the calculated values of <inline-formula><mml:math id="inf378"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf379"><mml:mi>𝕍</mml:mi></mml:math></inline-formula> when <inline-formula><mml:math id="inf380"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf381"><mml:mrow><mml:mi>D</mml:mi><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, i.e., assuming the ghost swimmer is getting a free ride with the local flow at zero thrust and drag.</p><p>To consider stability at the calculated equilibria in <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>, we calculate the derivative of thrust parameter in <xref ref-type="disp-formula" rid="equ16">Equation 16</xref> with respect to phase <inline-formula><mml:math id="inf382"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and evaluate it at the equilibrium points<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo>∓</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Thus, there is always a stable equilibrium and an unstable equilibrium, both of them are close to the local maximum of flow agreement parameter <inline-formula><mml:math id="inf383"><mml:mrow><mml:mi>𝕍</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mi>/</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which is consistent with <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text.</p></sec></app><app id="appendix-5"><title>Appendix 5</title><sec sec-type="appendix" id="s11"><title>Phase control</title><p>Consider a swimmer flapping at a phase <inline-formula><mml:math id="inf384"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> can ‘sense’ or measure the agreement of its flapping motion with the local fluid velocity <inline-formula><mml:math id="inf385"><mml:mi>𝐮</mml:mi></mml:math></inline-formula> (generated by sources other than itself) at its location (say at its midpoint), over a time span of <inline-formula><mml:math id="inf386"><mml:mi>m</mml:mi></mml:math></inline-formula> flapping periods. The goal of the swimmer would be to adjust its current flapping phase <inline-formula><mml:math id="inf387"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> to a desired phase <inline-formula><mml:math id="inf388"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow></mml:math></inline-formula> that maximizes its agreement with the local velocity<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mi>ϕ</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo movablelimits="true" form="prefix">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mi mathvariant="bold">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="thinmathspace"/><mml:mrow><mml:mtext>d</mml:mtext></mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>using a proportional phase controller inspired from <xref ref-type="bibr" rid="bib60">Li et al., 2021</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>,<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>;</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf389"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the desired phase and <inline-formula><mml:math id="inf390"><mml:mi>γ</mml:mi></mml:math></inline-formula> is a constant that determines the speed of convergence. We chose the parameters as follows: we set the number of periods <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> that describes the memory of the swimmer of the ambient fluid <inline-formula><mml:math id="inf392"><mml:mi>𝐮</mml:mi></mml:math></inline-formula>, such that the time history is two times the pitching period <inline-formula><mml:math id="inf393"><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. We set the control gain <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> to ensure that the actual phase <inline-formula><mml:math id="inf395"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can reach the desired phase <inline-formula><mml:math id="inf396"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi></mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at 1% of relative error within <inline-formula><mml:math id="inf397"><mml:mrow><mml:mn>1.5</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>By implementing this phase controller in swimmer 4 in a group of four inline swimmers, the swimmer is able to stabilize itself in the formation as shown in <xref ref-type="fig" rid="fig10">Figure 10</xref>. However, this stabilization is expensive: by actively controlling its phase to stay in formation, swimmer 4 spends 100% more hydrodynamic power than swimming alone.</p></sec></app><app id="appendix-6"><title>Appendix 6</title><sec sec-type="appendix" id="s12"><title>Data collection from published literature</title><p>To probe the relationship between the scaled separation distance <inline-formula><mml:math id="inf398"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> in pairs of swimmers and their flapping phase lag <inline-formula><mml:math id="inf399"><mml:mi>ϕ</mml:mi></mml:math></inline-formula>, we collected data from published literature on pairs of interacting swimmers (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>; <xref ref-type="bibr" rid="bib70">Newbolt et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Li et al., 2020</xref>; <xref ref-type="bibr" rid="bib55">Kurt et al., 2021</xref>; <xref ref-type="bibr" rid="bib38">Heydari and Kanso, 2021</xref>); see <xref ref-type="table" rid="table1">Table 1</xref> and the Supplemental Excel Sheet. We excluded a few studies from this literature survey (<xref ref-type="bibr" rid="bib74">Park and Sung, 2018</xref>; <xref ref-type="bibr" rid="bib18">Dai et al., 2018</xref>), because we were unable to extract <inline-formula><mml:math id="inf400"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> from the data they provided. We also excluded (<xref ref-type="bibr" rid="bib7">Becker et al., 2015</xref>) because their study involved fixed inter-swimmer distances. We found that the relationship between phase lag <inline-formula><mml:math id="inf401"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and separation distance <inline-formula><mml:math id="inf402"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> is approximately linear <inline-formula><mml:math id="inf403"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>. The value of <inline-formula><mml:math id="inf404"><mml:mi>β</mml:mi></mml:math></inline-formula> depends on how one defines the inter-swimmer separation distance. The two definitions that are commonly used in the literature are tail-to-tail or tail-to-head (gap) distance. These definitions do not change the linear scaling between <inline-formula><mml:math id="inf405"><mml:mrow><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf406"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>; they only change the value of <inline-formula><mml:math id="inf407"><mml:mi>β</mml:mi></mml:math></inline-formula>. For the data provided in <xref ref-type="fig" rid="fig3">Figure 3</xref> of the main text, we used the definition of separation distance <inline-formula><mml:math id="inf408"><mml:mi>d</mml:mi></mml:math></inline-formula> that results in <inline-formula><mml:math id="inf409"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Not all literature provided values for <inline-formula><mml:math id="inf410"><mml:mi>U</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf411"><mml:mi>T</mml:mi></mml:math></inline-formula>. In the very few cases when this information were missing, we estimated <inline-formula><mml:math id="inf412"><mml:mrow><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> from the linear relationship <inline-formula><mml:math id="inf413"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>/</mml:mi><mml:mi>U</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib53">Kim et al., 2010</xref>).</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.96129.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Seldin</surname><given-names>Marcus M</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>University of California, Irvine</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Fundamental</kwd></kwd-group></front-stub><body><p>This <bold>fundamental</bold> study provides a modeling regime that provides new insight into the energy-preservation parameters among schooling fish. The strength of the evidence supporting observations such as distilled dynamics between leading and lagging schooling fish which are derived from emergent properties is <bold>compelling</bold>. Overall, the study provides exciting insights into energetic coupling with respect to group swimming dynamics.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.96129.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The study seeks to establish accurate computational models to explore the role of hydrodynamic interactions on energy savings and spatial patterns in fish schools. Specifically, the authors consider a system of (one degree-of-freedom) flapping airfoils that passively position themselves with respect to the streamwise direction, while oscillating at the same frequency and amplitude, with a given phase lag and at a constant cross-stream distance. By parametrically varying the phase lag and the cross-stream distance, they systematically explore the stability and energy costs of emergent configurations. Computational findings are leveraged to distill insights into universal relationships and clarify the role of the wake of the leading foil.</p><p>Strengths:</p><p>(1) The use of multiple computational models (computational fluid dynamics, CFD, for full Navier-Stokes equations and computationally-efficient inviscid vortex sheet, VS, model) offers an extra degree of reliability of the observed findings and backing to the use of simplified models for future research in more complex settings.</p><p>(2) The systematic assessment of the stability and energy savings in multiple configurations of pairs and larger ensembles of flapping foils is an important addition to the literature.</p><p>(3) The discovery of a linear phase-distance relationship in the formation attained by pairs of flapping foils is a significant contribution, which helps compare different experimental observations in the literature.</p><p>(4) The observation of a critical size effect for in-line formations, above which cohesion and energetic benefits are lost at once, is a new discovery to the field.</p><p>Weaknesses:</p><p>(1) The extent to which observations on one-degree-of-freedom flapping foils could translate to real fish schools is presently unclear, so that some of the conclusions on live fish schools are likely to be overstated and would benefit from some more biological framing.</p><p>(2) The analysis of non-reciprocal coupling is not as novel as the rest of the study and potentially not as convincing due to the chosen linear metric of interaction (that is, the flow agreement).</p><p>Overall, this is a rigorous effort on a critical topic: findings of the research can offer important insight into the hydrodynamics of fish schooling, stimulating interdisciplinary research at the interface of computational fluid mechanics and biology.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.96129.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>This work makes substantial progress towards understanding physical aspects of formation locomotion, notably the hydrodynamic stability of groups of flappers and the modifications to energy costs associated with flow interactions.</p><p>Major strengths pertain to the fact that this topic is timely, interesting and complex, and the authors have advanced the understanding through their characterizations.</p><p>The weaknesses may relate to the many idealizations employed in the simulations and models, which may raise questions about how to interpret their results and whether the outcomes hold generally. But given the complexity of the problem, simplifications are necessary. The authors have certainly provided a clear presentation with appropriate details and caveats that will help the reader extract the main messages and form their own conclusions.</p><p>Overall, the work is a positive addition to the growing set of studies into schooling, flocking and related problems where unsteady flow interactions lead to interesting collective effects.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.96129.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Heydari</surname><given-names>Sina</given-names></name><role specific-use="author">Author</role><aff><institution>Santa Clara University</institution><addr-line><named-content content-type="city">Sunnyvale</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Hang</surname><given-names>Haotian</given-names></name><role specific-use="author">Author</role><aff><institution>University of Southern California</institution><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff></contrib><contrib contrib-type="author"><name><surname>Kanso</surname><given-names>Eva</given-names></name><role specific-use="author">Author</role><aff><institution>University of Southern California</institution><addr-line><named-content content-type="city">Los Angeles</named-content></addr-line><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews:</bold></p><p><bold>Reviewer #1 (Public Review):</bold></p><p>Summary:</p><p>The study seeks to establish accurate computational models to explore the role of hydrodynamic interactions on energy savings and spatial patterns in fish schools. Specifically, the authors consider a system of (one degree-of-freedom) flapping airfoils that passively position themselves with respect to the streamwise direction, while oscillating at the same frequency and amplitude, with a given phase lag and at a constant cross-stream distance. By parametrically varying the phase lag and the cross-stream distance, they systematically explore the stability and energy costs of emergent configurations. Computational findings are leveraged to distill insights into universal relationships and clarify the role of the wake of the leading foil.</p></disp-quote><p>We would like to thank the referee for their careful read of the manuscript and for their constructive feedback. We appreciate it.</p><disp-quote content-type="editor-comment"><p>Strengths:</p><p>(1) The use of multiple computational models (computational fluid dynamics, CFD, for full Navier-Stokes equations and computationally efficient inviscid vortex sheet, VS, model) offers an extra degree of reliability of the observed findings and backing to the use of simplified models for future research in more complex settings.</p><p>(2) The systematic assessment of the stability and energy savings in multiple configurations of pairs and larger ensembles of flapping foils is an important addition to the literature.</p><p>(3) The discovery of a linear phase-distance relationship in the formation attained by pairs of flapping foils is a significant contribution, which helps compare different experimental observations in the literature.</p><p>(4) The observation of a critical size effect for in-line formations of larger, above which cohesion and energetic benefits are lost at once, is a new discovery in the field.</p></disp-quote><p>Thank you for this list of strength – we are delighted that these ideas were clearly communicated in our manuscript.</p><p>Note that Newbolt <italic>et al</italic>. PNAS, 2019 reported distance as a function of phase for pairs of flapping hydrofoils, and Li <italic>et al</italic>, Nat. Comm., 2020 also reported phase-distance relationship in robotic and biological fish (calling it Vortex Phase Matching). We compiled their results, together with our and other numerical and experimental results, showing that the linear distance-phase relationship is universal.</p><p>Weaknesses:</p><p>(1) The extent to which observations on one-degree-of-freedom flapping foils could translate to real fish schools is presently unclear so some of the conclusions on live fish schools are likely to be overstated and would benefit from some more biological framing.</p><p>Thank you for bringing up this point. Indeed, flapping foils that are free to translate in both the x- and y-directions and rotate in the x-y plane could drift apart in the y-direction. However, this drift occurs at a longer time scale than the forward swimming motion; it is much slower. For this reason, we feel justified to ignore it for the purpose of this study, especially that the pairwise equilibria in the swimming x-direction are reached at a faster time scale.</p><p>Below, we include two snapshots taken from published work from the group of Petros Koumoutsakos (Gazzola <italic>et al</italic>, SIAM 2014). The figures show, respectively, a pair and a group of five undulating swimmers, free to move and rotate in the x-y plane. The evolution of the two and five swimmers is computed in the absence of any control. The lateral drift is clearly sub-dominant to the forward motion. Similar results were reported in Verma <italic>et al</italic>, PNAS 2018.</p><p>These results are independent on the details of the flow interactions model. For example, similar lateral drift is observed using the dipole model dipole model (Kanso &amp; Tsang, FDR 2014, Tsang &amp; Kanso, JNLS 2023).</p><p>Another reason why we feel justified to ignore these additional degrees of freedom is the following: we assume a live fish or robotic vehicle would have feedback control mechanisms that correct for such drift. Given that it is a slowly-growing drift, we hypothesize that the organism or robot would have sufficient time to respond and correct its course.</p><p>Indeed, in Zhu <italic>et al</italic>. 2022, an RL controller, which drives an individual fish-like swimmer to swim at a given speed and direction, when applied to pairs of swimmers, resulted in the pair &quot;passively&quot; forming a stable school without any additional information about each other.</p><p>We edited the main manuscript in page 4 of the manuscript to include reference to the work cited here and to explain the reasons for ignoring the lateral drift.</p><p>Citations:</p><p>Gazzola, M., Hejazialhosseini, B., &amp; Koumoutsakos, P. (2014). Reinforcement learning and wavelet adapted vortex methods for simulations of self-propelled swimmers. <italic>SIAM Journal on Scientific Computing</italic>, <italic>36</italic>(3), B622-B639. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1137/130943078">https://doi.org/10.1137/130943078</ext-link></p><p>Verma, S., Novati, G., &amp; Koumoutsakos, P. (2018). Efficient collective swimming by harnessing vortices through deep reinforcement learning. <italic>Proceedings of the National Academy of Sciences</italic>, <italic>115</italic>(23), 5849-5854. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1800923115">https://doi.org/10.1073/pnas.1800923115</ext-link></p><p>Tsang, A. C. H. &amp; Kanso, E., (2013). Dipole Interactions in Doubly Periodic Domains. <italic>Journal of Nonlinear Science</italic> 23 (2013): 971-991. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00332-013-9174-5">https://doi.org/10.1007/s00332-013-9174-5</ext-link></p><p>Kanso, E., &amp; Tsang, A. C. H. (2014). Dipole models of self-propelled bodies. <italic>Fluid Dynamics Research</italic>, <italic>46</italic>(6), 061407. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0169-5983/46/6/061407">https://doi.org/10.1088/0169-5983/46/6/061407</ext-link></p><p>Zhu, Y., Pang, J. H., &amp; Tian, F. B. (2022). Stable schooling formations emerge from the combined effect of the active control and passive self-organization. <italic>Fluids</italic>, <italic>7</italic>(1), 41. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/fluids7010041">https://doi.org/10.3390/fluids7010041</ext-link></p><fig id="sa3fig1" position="float"><label>Author response image 1.</label><caption><title>Antiphase self-propelled anguilliform swimmers.</title><p>(a) – (d) Wavelet adapted vorticity fields at, respectively, t = T, t = 4T, t = 10T. (e) Absolute normalized velocities |U|/L. (f) Swimmers’ centre of mass trajectories.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-sa3-fig1-v1.tif"/></fig><fig id="sa3fig2" position="float"><label>Author response image 2.</label><caption><title>Parallel schooling formation.</title><p>(a) – (d) wavelet adapted vorticity fields at, respectively, t = T, t = 4T, t = 7T, t = 10T. (e) Absolute normalized velocities |U|/L. (f) Swimmers’ center of mass trajectories.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-sa3-fig2-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>(2) The analysis of non-reciprocal coupling is not as novel as the rest of the study and potentially not as convincing due to the chosen linear metric of interaction (that is, the flow agreement).</p></disp-quote><p>We thank the referee for this candid and constructive feedback. In fact, we view this aspect of the study as most “revolutionary” because it provides a novel approach to pre-computing the locations of stable equilibria even without doing expensive all-to-all coupled simulations or experiments.</p><p>Basically, the idea is the following: you give me a flow field, it doesn’t matter how you obtained it, whether from simulations or experimentally, and I can tell you at what locations in this flow field a virtual flapping swimmer would be stable and save hydrodynamic energy!</p><p>In the revised version, we changed page 3 and 7 in main text, and added a new section “Diagnostic tools” in SI to better illustrate this.</p><disp-quote content-type="editor-comment"><p>Overall, this is a rigorous effort on a critical topic: findings of the research can offer important insight into the hydrodynamics of fish schooling, stimulating interdisciplinary research at the interface of computational fluid mechanics and biology.</p></disp-quote><p>We thank the referee again for their careful read of the manuscript and their constructive feedback.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review):</bold></p><p>The document &quot;Mapping spatial patterns to energetic benefits in groups of flow-coupled swimmers&quot; by Heydari et al. uses several types of simulations and models to address aspects of stability of position and power consumption in few-body groups of pitching foils. I think the work has the potential to be a valuable and timely contribution to an important subject area. The supporting evidence is largely quite convincing, though some details could raise questions, and there is room for improvement in the presentation. My recommendations are focused on clarifying the presentation and perhaps spurring the authors to assess additional aspects:</p></disp-quote><p>We would like to thank the referee for their careful read of the manuscript and for their constructive feedback. We appreciate it.</p><disp-quote content-type="editor-comment"><p>(1) Why do the authors choose to set the swimmers free only in the propulsion direction? I can understand constraining all the positions/orientations for investigating the resulting forces and power, and I can also understand the value of allowing the bodies to be fully free in x, y, and their orientation angle to see if possible configurations spontaneously emerge from the flow interactions. But why constrain some degrees of freedom and not others? What's the motivation, and what's the relevance to animals, which are fully free?</p></disp-quote><p>We would like to thank the referee for raising this point. It is similar to the point raised above by the first referee. As explained above the reason is the following: in freely-swimming, hydrodynamically-interacting “fish,” the lateral drift is sub-dominant to the forward swimming motion. Therefore, we ignore it in the model. Please see our detailed response above for further clarification, and see changes in page 4 in the main manuscript.</p><disp-quote content-type="editor-comment"><p>(2) The model description in Eq. (1) and the surrounding text is confusing. Aren't the authors computing forces via CFD or the VS method and then simply driving the propulsive dynamics according to the net horizontal force? It seems then irrelevant to decompose things into thrust and drag, and it seems irrelevant to claim that the thrust comes from pressure and the drag from viscous effects. The latter claim may in fact be incorrect since the body has a shape and the normal and tangential components of the surface stress along the body may be complex.</p></disp-quote><p>Thank you for pointing this out! It is indeed confusing.</p><p>In the CFD simulations, we are computing the net force in the swimming x-direction direction by integrating using the definition of force density in relation to the stress tensor. There is no ambiguity here.</p><p>In the VS simulations, however, we are computing the net force in the swimming x-direction by integrating the pressure jump across a plate of zero thickness. There is no viscous drag. Viscous drag is added by hand, so-to-speak. This method for adding viscous drag in the context of the VS model is not new, it has been used before in the literature as explained in the SI section “Vortex sheet (VS) model” (pages 30 and 31).</p><p>.</p><disp-quote content-type="editor-comment"><p>(3) The parameter taudiss in the VS simulations takes on unusual values such as 2.45T, making it seem like this value is somehow very special, and perhaps 2.44 or 2.46 would lead to significantly different results. If the value is special, the authors should discuss and assess it. Otherwise, I recommend picking a round value, like 2 or 3, which would avoid distraction.</p></disp-quote><p>Response: The choice of dissipation time is both to model viscous effect and reduce computational complexity. Introducing it is indeed introduces forcing to the simulation. Round value, like 2 or 3, is equal to an integer multiple of the flapping period, which is normalized to T = 1, Therefore, an integer value of <inline-formula><mml:math id="sa3m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mtext>diss </mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> would cause forcing at the resonant frequency and lead to computational blow up. To avoid this effect, a parameter choice of <inline-formula><mml:math id="sa3m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mtext>diss </mml:mtext></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 2.45, 2.44 or 2.46 would be fine and would lead to small perturbation to the overall simulation, compared to no dissipation at all. This effect is studied in detail in the following published work from our group:</p><p>Huang, Y., Ristroph, L., Luhar, M., &amp; Kanso, E. (2018). Bistability in the rotational motion of rigid and flexible flyers. <italic>Journal of Fluid Mechanics</italic>, <italic>849</italic>, 1043-1067. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/jfm.2018.446">https://doi.org/10.1017/jfm.2018.446</ext-link></p><disp-quote content-type="editor-comment"><p>(4) Some of the COT plots/information were difficult to interpret because the correspondence of beneficial with the mathematical sign was changing. For example, DeltaCOT as introduced on p. 5 is such that negative indicates bad energetics as compared to a solo swimmer. But elsewhere, lower or more negative COT is good in terms of savings. Given the many plots, large amounts of data, and many quantities being assessed, the paper needs a highly uniform presentation to aid the reader.</p></disp-quote><p>Thank you for pointing this out! We updated Figures 3,6 as suggested.</p><disp-quote content-type="editor-comment"><p>(5) I didn't understand the value of the &quot;flow agreement parameter,&quot; and I didn't understand the authors' interpretation of its significance. Firstly, it would help if this and all other quantities were given explicit definitions as complete equations (including normalization). As I understand it, the quantity indicates the match of the flow velocity at some location with the flapping velocity of a &quot;ghost swimmer&quot; at that location. This does not seem to be exactly relevant to the equilibrium locations. In particular, if the match were perfect, then the swimmer would generate no relative flow and thus no thrust, meaning such a location could not be an equilibrium. So, some degree of mismatch seems necessary. I believe such a mismatch is indeed present, but the plots such as those in Figure 4 may disguise the effect. The color bar is saturated to the point of essentially being three tones (blue, white, red), so we cannot see that the observed equilibria are likely between the max and min values of this parameter.</p></disp-quote><p>Thank you for pointing this out! You are correct in your understanding of the flow agreement parameter, but not in your interpretation.</p><p>Basically, “if the match were perfect, then the swimmer would generate no relative flow and thus no thrust,” means that “such a location could not be is an equilibrium.” Let me elaborate. An equilibrium is one at which the net thrust force is zero. The equilibrium is stable if the slope of the thrust force is negative. Ideally, this is what maximizing the flow agreement parameter would produce.</p><p>For example, consider an ideal fluid where the flow velocity is form <inline-formula><mml:math id="sa3m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> in vertical direction. Consider a “ghost swimmer” heaving at a velocity <inline-formula><mml:math id="sa3m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> . Under this scenario, flow agreement and thrust parameters are<disp-formula id="sa3equ1"><mml:math id="sa3m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Let’s now consider a balance of forces on the “ghost swimmer.” The ghost swimmer is in relative equilibrium if and only if:<disp-formula id="sa3equ2"><mml:math id="sa3m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:msup><mml:mi>cos</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>It gives us<disp-formula id="sa3equ3"><mml:math id="sa3m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="double-struck">V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We then consider stability at this equilibrium by calculating the derivative of thrust parameter over phase<disp-formula id="sa3equ4"><mml:math id="sa3m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>ϕ</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The corresponding values at equilibria are<disp-formula id="sa3equ5"><mml:math id="sa3m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>∓</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:msqrt></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Thus, when taking the positive <inline-formula><mml:math id="sa3m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> which means the equilibria is a stable fixed point. We included this analysis in a new section in the SI page 32.</p><disp-quote content-type="editor-comment"><p>(6) More generally, and related to the above, I am favorable towards the authors' attempts to find approximate flow metrics that could be used to predict the equilibrium positions and their stability, but I think the reasoning needs to be more solid. It seems the authors are seeking a parameter that can indicate equilibrium and another that can indicate stability. Can they clearly lay out the motivation behind any proposed metrics, and clearly present complete equations for their definitions? Further, is there a related power metric that can be appropriately defined and which proves to be useful?</p></disp-quote><p>Thank you – these are excellent suggestions. Indeed, we needed to better explain the motivation and equations. Perhaps the main idea for these metrics can be best understood when explained in the context of the simpler particle model, which we now do in the SI and explain the main text.</p><disp-quote content-type="editor-comment"><p>(7) Why do the authors not carry out CFD simulations on the larger groups? Some explanations should be given, or some corresponding CFD simulations should be carried out. It would be interesting if CFD simulations were done and included, especially for the in-line case of many swimmers. This is because the results seem to be quite nuanced and dependent on many-body effects beyond nearest-neighbor interactions. It would certainly be comforting to see something similar happen in CFD.</p></disp-quote><p>We are using a open-source version of the Immersed Boundary Method that is not specifically optimized for many interacting swimmers. Therefore, the computational cost of performing CFD simulations for more swimmers is high. Therefore, we used the CFD simulations sporadically with fewer simmers (2 or 3) and we performed systematic simulations in the context of the VS model.</p><p>For the same Reynolds number in Figure 1, we simulated three and four swimmers in CFD: three swimmers forms a stable formation, four swimmers don’t, consistent with the VS model, with the forth swimmer colliding with the third one. Results are included in the SI figure 8 of the main text.</p><disp-quote content-type="editor-comment"><p>(8) Related to the above, the authors should discuss seemingly significant differences in their results for long in-line formations as compared to the CFD work of Peng et al. [48]. That work showed apparently stable groups for numbers of swimmers quite larger than that studied here. Why such a qualitatively different result, and how should we interpret these differences regarding the more general issue of the stability of tandem groups?</p></disp-quote><p>Thank you for bringing up this important comparison. Peng et al. [48] (Hydrodynamic schooling of multiple self-propelled flapping plates) studied inline configuration of flapping airfoils at Reynolds number = 200. There are several differences between their work and ours. The most important one is that they used a flexible plate, which makes the swimmer more adaptive to changes in the flow field, e.g. changes in tailbeat amplitude and changes in phase along its body and diverts some of the hydrodynamic energy to elastic energy. We edited the main text page 10 at the end of section “Critical size of inline formations beyond which cohesion is lost” to explain this distinction.</p><disp-quote content-type="editor-comment"><p>(9) The authors seem to have all the tools needed to address the general question about how dynamically stable configurations relate to those that are energetically optimal. Are stable solutions optimal, or not? This would seem to have very important implications for animal groups, and the work addresses closely related topics but seems to miss the opportunity to give a definitive answer to this big question.</p></disp-quote><p>Indeed, that is exactly the point – in pairwise formations, stable configurations are also energetically optimal! In larger groups, there is no unique stable configuration – each stable configuration is associated with a different degree of energy savings. Interestingly, when exploring various equilibrium configurations in a school of four, we found the diamond formation of D. Weihs, Nature, 1972 to be both stable and most optimal among the configurations we tested. However, claiming this as a global optimum may be misleading – our standpoint is that fish schools are always dynamic and that there are opportunities for energy savings in more than one stable configuration.</p><p>We added a section in new text “Mapping emergent spatial patterns to energetic benefits”, and added a new figure in the maintext (Fig. 10) and a new figure in the SI (Fig. S. 8)</p><disp-quote content-type="editor-comment"><p>(10) Time-delay particle model: This model seems to construct a simplified wake flow. But does the constructed flow satisfy basic properties that we demand of any flow, such as being divergence-free? If not, then the formulation may be troublesome.</p></disp-quote><p>The simplified wake flow captures the hydrodynamic trail left by the swimmer in a very simplified manner. In the limit of small amplitude, it should be consistent with the inviscid vortex sheet shed of T. Wu’s waving swimmer model (Wu TY. 1961).</p><p>The model was compared to experiments and used in several recent publications from the Courant Institute (Newbolt <italic>et al</italic>. 2019, 2022, 2024).</p><p>Citations:</p><p>Wu, T. Y. T. (1961). Swimming of a waving plate. <italic>Journal of Fluid Mechanics</italic>, <italic>10</italic>(3), 321-344. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0022112061000949">https://doi.org/10.1017/S0022112061000949</ext-link></p><p>Newbolt, J. W., Lewis, N., Bleu, M., Wu, J., Mavroyiakoumou, C., Ramananarivo, S., &amp; Ristroph, L. (2024). Flow interactions lead to self-organized flight formations disrupted by self-amplifying waves. <italic>Nature Communications</italic>, <italic>15</italic>(1), 3462. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41467-024-47525-9">https://doi.org/10.1038/s41467-024-47525-9</ext-link></p><p>Newbolt, J. W., Zhang, J., &amp; Ristroph, L. (2022). Lateral flow interactions enhance speed and stabilize formations of flapping swimmers. <italic>Physical Review Fluids</italic>, <italic>7</italic>(6), L061101. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevFluids.7.L061101">https://doi.org/10.1103/PhysRevFluids.7.L061101</ext-link></p><p>Newbolt, J. W., Zhang, J., &amp; Ristroph, L. (2019). Flow interactions between uncoordinated flapping swimmers give rise to group cohesion. <italic>Proceedings of the National Academy of Sciences</italic>, <italic>116</italic>(7), 2419-2424. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1816098116">https://doi.org/10.1073/pnas.1816098116</ext-link></p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the authors:</bold></p><p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p><p>Congratulations on such a comprehensive and well-thought-out study; I truly enjoyed reading it and have only a couple of suggestions that I believe will help further strengthen the paper. I am including a bunch of references here that are very familiar to me without the expectation of you to include them all, just to point at areas that I feel you might consider useful.</p></disp-quote><p>We thank the referee again for their careful read of the manuscript and for their constructive feedback. We appreciate it.</p><disp-quote content-type="editor-comment"><p>First, I believe that some more rationale is needed to justify the chosen modeling framework. I am fully aware of how difficult is to run these simulations, but I see some critical assumptions that need to be at least spelled out for the reader to appreciate the limitations of the study: (1) Constraining the cross-stream coordinate (a stability analysis should include perturbations on the cross-stream coordinate as well, see, for example, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/flo.2023.25">https://doi.org/10.1017/flo.2023.25</ext-link> -- I know this is much simpler as it discards any vortex shedding) and (2) Assuming equal frequency and amplitude (there are studies showing variation of tail beat frequency in animals depending on their position in the school, see, for example, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00265-014-1834-4">https://doi.org/10.1007/s00265-014-1834-4</ext-link>).</p></disp-quote><p>Thank you for these suggestions. These are indeed important and interesting points to discuss in the manuscript. See response above regarding point 1. Regarding point 2, this is of course important and will be pursued in future extensions of this work. We edited the intro and discussion of the main text to explain this.</p><p>In the paper “Stability of schooling patterns of a fish pair swimming against a flow”, The authors considered a pair of swimmers swimming in a channel. They analyzed stability of the system and find multiple equilibria of the system, including inline and staggered formation, and a special formation of perpendicular to the wall. Studying fish school in confined domain and analyzing their stability is very interesting. We added citation to this paper in the discussion section at the end of page 10.</p><p>In the paper “Fish swimming in schools save energy regardless of their spatial position”, the authors measured the reduction in power of fish by measuring tail beat frequency and oxygen consumption and compared them to measurements in solitary fish. They found that in a school of fish, individuals always save power comparing to swimming alone. However, there is one important caveat in this study: they considered a larger school of fish and expressed the results in terms of pairwise configurations (see schematics we draw below). This is misleading because it may suggest that formations with only two fish provide benefits each other, while in fact, the data is obtained from a larger school with many neighbors. They only consider a fish’s relationship to its nearest neighbor. But in a large school, other neighbors will also have influence on their energy consumption. In the schematics below, we emphasized on several focal fishes, marking them as red, green, and blue. We also marked their nearest neighbors using the same color, but lighter. The nearest neighbors are what the authors are considering to show its neighbor relationship. For example, a problematic one is the red fish, for which its nearest neighbor is behind it, but indeed, its power saving may come from the other neighbors, which are around or ahead it.</p><fig id="sa3fig3" position="float"><label>Author response image 3.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-sa3-fig3-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>Second, I would like to see more biology context with respect to limitations that are inherent to a purely mechanical model, including, neglecting vision that we know plays a synergistic role in determining schooling patterns. For example, a recent study <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.beproc.2022.104767">https://doi.org/10.1016/j.beproc.2022.104767</ext-link> has presented experiments on fish swimming in the dark and in bright conditions, showing that it is unlikely that hydrodynamics alone could explain typically observed swimming patterns in the literature.</p></disp-quote><p>Thank you for this suggestion and for sharing us with the paper “Collective response of fish to combined manipulations of illumination and flow”. This is a great study, and we are sorry to have missed it.</p><p>In this paper, the authors found that when having illumination, fish swim more cohesively, which is in consistent with another paper we already cited “The sensory basis of schooling by intermittent swimming in the rummy-nose tetra (Hemigrammus rhodostomus)”. Another important conclusion in this paper is that when having brighter illumination and with flow, fish school spend more time side by side. This connects well to the conclusion in another paper we cited “Simple phalanx pattern leads to energy saving in cohesive fish schooling,” where at lower flow speed in a water channel, fish tended to form a dynamic school while at higher flow speed, they organized in a side-by-side/ phalanx configuration. This conclusion is consistent with our study that in side-by-side formation, fish share power saving.</p><p>Importantly, it is well known that both vision and flow sensing play important roles in fish schooling. This study aimed to merely explore what is possible through passive hydrodynamic interactions, without visual and flow sensing and response. We clarify this in the revised version of the manuscript.</p><disp-quote content-type="editor-comment"><p>Third, I am not too convinced about the flow agreement metric, which only accounts for linear interactions between the foils. More sophisticated approaches could be utilized as the one proposed here <ext-link ext-link-type="uri" xlink:href="https://doi.org/101.1017/jfm.2018.369">https://doi.org/101.1017/jfm.2018.369</ext-link>, based on a truly model-agnostic view of the interaction - therein, the authors show non-reciprocal (in strength and time-scale) coupling between two in-line flapping foils using information theory. I also would like to mention this older paper <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2012.0084">https://doi.org/10.1098/rsif.2012.0084</ext-link>, where an equivalent argument about the positioning of a trailing fish with respect to a leading robotic fish is made from experimental observations.</p></disp-quote><p>Thank you for these remarks and for sharing these two interesting papers.</p><p>The flow agreement metric is not specific to two fish, as we show in Fig. 6 of the manuscript. We edited the manuscript and SI to better explain the motivation and implementation of the flow agreement parameter. We edited the main text, see revisions on page 7, and added a new section call “diagnostic tools.”.</p><p>In the paper “An information-theoretic approach to study fluid–structure interactions”, the authors calculate the transfer entropy between two oscillating airfoils when they are hydrodynamically coupled. This is an interesting study! We will apply this approach to analyzing larger schools in the future. We cited this paper in the introduction.</p><p>In the paper “Fish and robots swimming together: attraction towards the robot demands biomimetic locomotion”, the authors found that fish will swim behind an artificial fish robot, especially when the fish robot is beating its tail instead of static. At specific conditions, the fish hold station behind the robot, which may be due to the hydrodynamic advantage obtained by swimming in the robot’s wake. DPIV resolved the wake behind a static/ beating fish robot, but did not visualize the flow field when the fish is there. This study is similar to a paper we already cited “In-line swimming dynamics revealed by fish interacting with a robotic mechanism”, in which, they considered fish-foil interaction. In the revised manuscript, we cite both papers.</p><p>For the reviewer’s comments about flow agreement only accounts for linear interactions between the foils, we want to explain more to clarify this. The flow agreement parameter is a nonlinear metric, which considered the interaction between a virtual swimmer and an arbitrary unsteady flow field. Although the metric is a linear function of swimmer’s speed, it is indeed a nonlinear function of spacing and phase, which are the quantities we care about. Moreover, the flow field can by generated by either experiment or CFD simulation, and behind one or more swimmers. It is true that it is a one way coupled system since the virtual swimmer does not perturb the flow field.</p><disp-quote content-type="editor-comment"><p>Again, this is great work and I hope these suggestions are of help.</p></disp-quote><p>Thank you again! We are delighted to receive such a positive and constructive feedback.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p><p>(1) About Figure 1: Panel C should be made to match between CFD and VS with regard to the swimmer positions. Also, if the general goal of the figure is to compare CFD and VS, then how about showing a difference map of the velocity fields as a third column of panels across A-D?</p></disp-quote><p>Thank you for pointing this out. Figure 1 C is updated accordingly.</p><p>The general goal is to show the CFD and VS simulations produce qualitatively similar results. Some quantities are not the same across models, e.g. the swimming speed of swimmers are different, but the scaled distance is the same.</p><disp-quote content-type="editor-comment"><p>(2) Figure 3: In A, it would be nice to keep the y-axis the same across all plots, which would aid quick visual comparison. In B, the legend labels for CFD and VS should be filled in with color so that the reader can more easily connect to the markers in the plot.</p></disp-quote><p>Thank you for pointing this out, we’ve updated figure 3 and 6.</p><disp-quote content-type="editor-comment"><p>(3) Figures 4, 9, and Supplementary Figures too: As mentioned previously, the agreement parameter plots are saturated in the color map, possibly obscuring more detailed information.</p></disp-quote><p>Thank you for pointing this out. The goal is to show that there is a large region with positive flow agreement parameter.</p><p>We picked up the flow agreement behind a single swimmer in VS simulation (Fig.4B) and added the counter lines to it (represents 0.25 and 0.5). Not many details are hidden by the saturated colormap.</p><fig id="sa3fig4" position="float"><label>Author response image 4.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-96129-sa3-fig4-v1.tif"/></fig><p>We also updated Fig 4 and Fig 9 accordingly.</p><disp-quote content-type="editor-comment"><p>(4) Figure 6: Is this CFD or VS? Why show one or the other and not both? In B, it seems that there are only savings available and no energetically costly positions. This seems odd. In C, it seems the absolute value on dF/dd is suppressing some important information about stability - the sign of this seems important. In E, the color bar seems to be reflected from what is standard, i.e. 0 on the left and 100 on the right, as in F.</p></disp-quote><p>Thank you for asking. Fig. 6 is based only on VS simulations. There are hundreds of simulations in this figure, we are not running CFD simulations to save computational effort. Representative CFD simulations are shown in Figure 1,2,3, for comparison. We added a sentence in the figure caption for clarification.</p><p>In C, since <inline-formula><mml:math id="sa3m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> is always negative for emergent formations (only stable equilibria can appear during forward time simulation), we are showing its absolute value for comparison.</p><p>In E, we are flipping this because larger flow agreement parameter corresponds to more power saving, in the other word, negative changes in COT.</p><disp-quote content-type="editor-comment"><p>(5) Fig. 8: For cases such as in D that have &gt;100% power savings, does this mean that the swimmer has work done by the flow? How to interpret this physically for a flapping foil and biologically for a fish?</p></disp-quote><p>Yes, it means the hydrofoil/fish gets a free ride, and even able to harvest energy from the incoming flow. Actually, similar phenomenon has been reported in the biology and engineering literature. For example, Liao <italic>et al</italic>. 2003, Beal <italic>et al</italic>. 2006 found that live or dead fish can harvest energy from incoming vortical flow by modulating their body curvature.</p><p>In engineering, Chen <italic>et al</italic>. 2018, Ribeiro <italic>et al</italic>. 2021 have found that the following airfoil in a tandem/ inline formation can harvest energy from the wake of leading swimmer in both simulation and experiemnts.</p><p>Citations:</p><p>Liao, J. C., Beal, D. N., Lauder, G. V., &amp; Triantafyllou, M. S. (2003). Fish exploiting vortices decrease muscle activity. <italic>Science</italic>, <italic>302</italic>(5650), 1566-1569. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1088295">https://doi.org/10.1126/science.1088295</ext-link></p><p>Beal, D. N., Hover, F. S., Triantafyllou, M. S., Liao, J. C., &amp; Lauder, G. V. (2006). Passive propulsion in vortex wakes. <italic>Journal of fluid mechanics</italic>, <italic>549</italic>, 385-402. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S0022112005007925">https://doi.org/10.1017/S0022112005007925</ext-link></p><p>Chen, Y., Nan, J., &amp; Wu, J. (2018). Wake effect on a semi-active flapping foil based energy harvester by a rotating foil. <italic>Computers &amp; Fluids</italic>, <italic>160</italic>, 51-63. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.compfluid.2017.10.024">https://doi.org/10.1016/j.compfluid.2017.10.024</ext-link></p><p>Ribeiro, B. L. R., Su, Y., Guillaumin, Q., Breuer, K. S., &amp; Franck, J. A. (2021). Wake-foil interactions and energy harvesting efficiency in tandem oscillating foils. <italic>Physical Review Fluids</italic>, <italic>6</italic>(7), 074703. DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevFluids.6.074703">https://doi.org/10.1103/PhysRevFluids.6.074703</ext-link></p></body></sub-article></article>