<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">77599</article-id><article-id pub-id-type="doi">10.7554/eLife.77599</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Improving the accuracy of single-trial fMRI response estimates using GLMsingle</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-269073"><name><surname>Prince</surname><given-names>Jacob S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6169-9503</contrib-id><email>jacob.samuel.prince@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-270005"><name><surname>Charest</surname><given-names>Ian</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3939-3003</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-270006"><name><surname>Kurzawski</surname><given-names>Jan W</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2781-1236</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-270007"><name><surname>Pyles</surname><given-names>John A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7627-0504</contrib-id><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-30329"><name><surname>Tarr</surname><given-names>Michael J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4724-1744</contrib-id><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-71138"><name><surname>Kay</surname><given-names>Kendrick N</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6604-9155</contrib-id><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03vek6s52</institution-id><institution>Department of Psychology, Harvard University</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03angcq70</institution-id><institution>Center for Human Brain Health, School of Psychology, University of Birmingham</institution></institution-wrap><addr-line><named-content content-type="city">Birmingham</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0161xgx34</institution-id><institution>cerebrUM, Département de Psychologie, Université de Montréal</institution></institution-wrap><addr-line><named-content content-type="city">Montréal</named-content></addr-line><country>Canada</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0190ak572</institution-id><institution>Department of Psychology, New York University</institution></institution-wrap><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cvxb145</institution-id><institution>Center for Human Neuroscience, Department of Psychology, University of Washington</institution></institution-wrap><addr-line><named-content content-type="city">Seattle</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05x2bcf33</institution-id><institution>Department of Psychology, Neuroscience Institute, Carnegie Mellon University</institution></institution-wrap><addr-line><named-content content-type="city">Pittsburgh</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/017zqws13</institution-id><institution>Center for Magnetic Resonance Research (CMRR), Department of Radiology, University of Minnesota</institution></institution-wrap><addr-line><named-content content-type="city">Minneapolis</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kok</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>de Lange</surname><given-names>Floris P</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/016xsfp80</institution-id><institution>Radboud University</institution></institution-wrap><country>Netherlands</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>29</day><month>11</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e77599</elocation-id><history><date date-type="received" iso-8601-date="2022-02-04"><day>04</day><month>02</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2022-10-15"><day>15</day><month>10</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2022-02-02"><day>02</day><month>02</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.01.31.478431"/></event></pub-history><permissions><copyright-statement>© 2022, Prince et al</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Prince et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-77599-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-77599-figures-v1.pdf"/><abstract><p>Advances in artificial intelligence have inspired a paradigm shift in human neuroscience, yielding large-scale functional magnetic resonance imaging (fMRI) datasets that provide high-resolution brain responses to thousands of naturalistic visual stimuli. Because such experiments necessarily involve brief stimulus durations and few repetitions of each stimulus, achieving sufficient signal-to-noise ratio can be a major challenge. We address this challenge by introducing <italic>GLMsingle</italic>, a scalable, user-friendly toolbox available in MATLAB and Python that enables accurate estimation of single-trial fMRI responses (<ext-link ext-link-type="uri" xlink:href="https://glmsingle.org/">glmsingle.org</ext-link>). Requiring only fMRI time-series data and a design matrix as inputs, GLMsingle integrates three techniques for improving the accuracy of trial-wise general linear model (GLM) beta estimates. First, for each voxel, a custom hemodynamic response function (HRF) is identified from a library of candidate functions. Second, cross-validation is used to derive a set of noise regressors from voxels unrelated to the experiment. Third, to improve the stability of beta estimates for closely spaced trials, betas are regularized on a voxel-wise basis using ridge regression. Applying GLMsingle to the Natural Scenes Dataset and BOLD5000, we find that GLMsingle substantially improves the reliability of beta estimates across visually-responsive cortex in all subjects. Comparable improvements in reliability are also observed in a smaller-scale auditory dataset from the StudyForrest experiment. These improvements translate into tangible benefits for higher-level analyses relevant to systems and cognitive neuroscience. We demonstrate that GLMsingle: (i) helps decorrelate response estimates between trials nearby in time; (ii) enhances representational similarity between subjects within and across datasets; and (iii) boosts one-versus-many decoding of visual stimuli. GLMsingle is a publicly available tool that can significantly improve the quality of past, present, and future neuroimaging datasets sampling brain activity across many experimental conditions.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fMRI pre-processing</kwd><kwd>GLM</kwd><kwd>large-scale datasets</kwd><kwd>denoising</kwd><kwd>voxel reliability</kwd><kwd>RSA</kwd><kwd>MVPA</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IIS-1822683</award-id><principal-award-recipient><name><surname>Kay</surname><given-names>Kendrick N</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>GLMsingle is a publicly available toolbox for analyzing fMRI time-series data that leverages data-driven optimization techniques to improve the accuracy of single-trial BOLD response estimates.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Across many scientific disciplines, datasets are rapidly increasing in size and scope. These resources have kickstarted a new era of data-driven scientific discovery (<xref ref-type="bibr" rid="bib53">Richards et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Jumper et al., 2021</xref>; <xref ref-type="bibr" rid="bib24">Iten et al., 2020</xref>; <xref ref-type="bibr" rid="bib52">Ravuri et al., 2021</xref>; <xref ref-type="bibr" rid="bib55">Schawinski et al., 2018</xref>; <xref ref-type="bibr" rid="bib13">D’Isanto and Polsterer, 2018</xref>). In visual neuroscience, recent efforts to sample individual brains at unprecedented scale and depth have yielded high-resolution functional magnetic resonance imaging (fMRI) datasets in which subjects view thousands of distinct images over several dozen hours of scanning (see <xref ref-type="bibr" rid="bib46">Naselaris et al., 2021</xref> for a review). These exciting “condition-rich” datasets are large enough to propel the development of computational models of how humans process complex naturalistic stimuli. For example, resources such as the Natural Scenes Dataset (NSD, <xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>), BOLD5000 (<xref ref-type="bibr" rid="bib7">Chang et al., 2019</xref>), and THINGS (<xref ref-type="bibr" rid="bib21">Hebart et al., 2019</xref>) may be useful for advancing our ability to characterize the tuning (<xref ref-type="bibr" rid="bib4">Bao et al., 2020</xref>; <xref ref-type="bibr" rid="bib36">Li and Bonner, 2022</xref>; <xref ref-type="bibr" rid="bib40">Long et al., 2018</xref>; <xref ref-type="bibr" rid="bib33">Kriegeskorte and Wei, 2021</xref>; <xref ref-type="bibr" rid="bib51">Popham et al., 2021</xref>), topography (<xref ref-type="bibr" rid="bib5">Blauch et al., 2022</xref>; <xref ref-type="bibr" rid="bib14">Doshi and Konkle, 2021</xref>; <xref ref-type="bibr" rid="bib62">Zhang et al., 2021</xref>; <xref ref-type="bibr" rid="bib35">Lee et al., 2020</xref>), and computations (<xref ref-type="bibr" rid="bib61">Yamins et al., 2014</xref>; <xref ref-type="bibr" rid="bib11">DiCarlo et al., 2012</xref>; <xref ref-type="bibr" rid="bib16">Freeman et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Marques et al., 2021</xref>; <xref ref-type="bibr" rid="bib23">Horikawa and Kamitani, 2017</xref>) performed in visual cortex.</p><p>The potential of large-scale datasets to reveal general principles of neural function depends critically on signal-to-noise ratio (SNR), which refers to one’s ability to reliably measure distinct neural signatures associated with different stimuli or experimental conditions. Diverse sources of noise affect fMRI data, and these noise sources limit the robustness and interpretability of data analyses (<xref ref-type="bibr" rid="bib39">Liu, 2016</xref>; <xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>). For example, subject head motion, scanner instabilities, physiological noise, and thermal noise all contribute unwanted variability to fMRI data. Noise is especially problematic in studies that sample a large number of conditions, since the number of repetitions of each condition is typically limited, resulting in noisy responses even after trial-averaging.</p><p>The approach we have developed to mitigate the effects of noise comes in the context of general linear model (GLM) analysis of fMRI time-series data (<xref ref-type="bibr" rid="bib9">Dale, 1999</xref>; <xref ref-type="bibr" rid="bib42">Monti, 2011</xref>). We assume that the goal of the GLM analysis is to estimate beta weights representing the blood oxygenation level dependent (BOLD) response amplitude evoked by different experimental conditions. In this context, we define <italic>noise</italic> as variability observed across repeated instances of a given condition. Therefore, methods that decrease such variability are desirable. Our approach seeks to maximize data quality at the level of individual voxels in individual subjects (as opposed to data quality assessed only at the region or group level), and seeks to obtain response estimates for single trials. These desiderata are powerful; if achieved, they can flexibly support a wide range of subsequent analyses including relating brain responses to trial-wise behavioral measures and pooling data across trials, brain regions, and/or subjects.</p><p>To realize these goals, we introduce <italic>GLMsingle</italic>, a user-friendly software toolbox (with both MATLAB and Python implementations) that performs single-trial BOLD response estimation. Given fMRI time-series data and a design matrix indicating the onsets of experimental conditions, GLMsingle implements a set of optimizations that target three aspects of the GLM framework (<xref ref-type="fig" rid="fig1">Figure 1</xref>):</p><list list-type="order"><list-item><p>The choice of hemodynamic response function (HRF) to convolve with the design matrix</p></list-item><list-item><p>The inclusion of nuisance regressors that account for components of the data that are thought to be noise</p></list-item><list-item><p>The use of regularization to improve the accuracy of the final beta estimates</p></list-item></list><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of GLMsingle.</title><p>GLMsingle takes as input a design matrix (where each column indicates the onset times for a given condition) and fMRI time-series in either volumetric or surface space, and returns as output an estimate of single-trial BOLD response amplitudes (beta weights). GLMsingle incorporates three techniques designed to optimize the quality of beta estimates: first, the use of a library of hemodynamic response functions (HRFs), where the best-fitting HRF from the library is chosen for each voxel; second, an adaptation of GLMdenoise (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>) to the single-trial GLM framework, where data-derived nuisance regressors are identified and used to remove noise from beta estimates; and third, an efficient re-parameterization of ridge regression (<xref ref-type="bibr" rid="bib54">Rokem and Kay, 2020</xref>) as a method for dampening the noise inflation caused by correlated single-trial GLM predictors.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig1-v1.tif"/></fig><p>Importantly, to enable fluid application to even the largest fMRI datasets, GLMsingle is fully automated (no manual setting of parameters) and can be executed efficiently even when gigabytes of fMRI data are passed as input.</p><p>We previously used the GLMsingle algorithm to estimate BOLD responses in the NSD dataset (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>). While the optimizations implemented in GLMsingle had a positive impact on data quality, it was not apparent whether the improvements would generalize to other datasets. The goal of this paper is to provide a standalone description of GLMsingle and to rigorously assess performance not only on NSD, but also on BOLD5000 (<xref ref-type="bibr" rid="bib7">Chang et al., 2019</xref>), a distinct large-scale fMRI dataset acquired with different subjects, at different field strength, and with a different experimental design (see Materials and methods). In both datasets, we show that the optimizations implemented in GLMsingle dramatically improve the reliability of GLM beta estimates. We provide further evidence of the general utility of GLMsingle by also evaluating its performance on the music-listening experiment from StudyForrest (<xref ref-type="bibr" rid="bib19">Hanke et al., 2015</xref>). This dataset differs in a number of respects from NSD and BOLD5000: it reflects a non-visual modality, and contains fewer experimental conditions, longer condition durations, a greater number of repetitions per condition, and a jittered inter-stimulus interval. The performance improvements found in this third dataset suggest that GLMsingle may be applicable to a wide range of fMRI tasks and study designs.</p><p>We also study the effect of these optimizations on downstream analyses that are of particular relevance to systems and cognitive neuroscience, including representational similarity analysis (RSA; <xref ref-type="bibr" rid="bib31">Kriegeskorte et al., 2008</xref>) and multivoxel pattern analysis (MVPA; <xref ref-type="bibr" rid="bib20">Haxby et al., 2001</xref>; <xref ref-type="bibr" rid="bib48">Norman et al., 2006</xref>; <xref ref-type="bibr" rid="bib50">Poldrack et al., 2011</xref>). In all analyses, we observe improvements in key outcome metrics, suggesting that GLMsingle meaningfully improves the ability of researchers to gain insight into neural representation and computation. Our findings demonstrate that GLMsingle affords the neuroimaging community a clear opportunity for improved data quality. Online materials (code, documentation, example scripts) pertaining to GLMsingle are available at <ext-link ext-link-type="uri" xlink:href="https://glmsingle.org/">glmsingle.org</ext-link>.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>To assess the impact of GLMsingle, we evaluate four different types of single-trial response estimates (henceforth, <italic>beta versions</italic>). The first arises from a baseline procedure that reflects a typical GLM approach for fMRI analysis (beta version <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), and each subsequent beta version (<inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) incorporates an additional strategy for optimizing model fits and mitigating the effects of noise. The final beta version (<inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) contains the complete set of optimizations provided by the GLMsingle toolbox. The GLMsingle algorithm consists of the following steps:</p><list list-type="order"><list-item><p>A baseline single-trial GLM is used to model each stimulus trial separately using a canonical HRF. This provides a useful baseline for comparison (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>: AssumeHRF).</p></list-item><list-item><p>An optimal HRF is identified for each voxel (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>) by iteratively fitting a set of GLMs, each time using a different HRF from a library of 20 HRFs. For each voxel, we identify the HRF that provides the best fit to the data (highest variance explained), and inherit the single-trial betas associated with that HRF (<inline-formula><mml:math id="inf6"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>: FitHRF).</p></list-item><list-item><p>GLMdenoise (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>; <xref ref-type="bibr" rid="bib8">Charest et al., 2018</xref>) is used to determine nuisance regressors to include in the model. Principal components analysis is applied to time-series data from a pool of noise voxels (see Materials and methods for details), and the top principal components are added one at a time to the GLM until cross-validated variance explained is maximized on-average across voxels (<inline-formula><mml:math id="inf7"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>: FitHRF + GLMdenoise).</p></list-item><list-item><p>With the nuisance regressors determined, fractional ridge regression (<xref ref-type="bibr" rid="bib54">Rokem and Kay, 2020</xref>) is used to regularize the single-trial betas, using a custom amount of regularization for each voxel, determined via cross-validation (<inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>: FitHRF + GLMdenoise + RR).</p></list-item></list><sec id="s2-1"><title>GLMsingle improves the reliability of beta estimates</title><p>We first examined the effect of GLMsingle on the test-retest reliability of voxels across relevant regions of visual cortex in NSD and BOLD5000 (<xref ref-type="fig" rid="fig2">Figure 2</xref>). For NSD, we analyzed the first 10 scan sessions of data from each of the first 4 subjects (each scan session consisted of 12 x 5.0 min runs). Each scan session was analyzed separately, and each scan session contained, on average, 35 conditions with 3 trials each, 107 conditions with 2 trials each, and 431 conditions with 1 trial each. For BOLD5000, we analyzed the complete dataset, consisting of subjects CSI1-4. These data were collected over 15 scan sessions (each scan session consisted of either 9 or 10 runs lasting 6 min and 28 s each). Groups of 5 scan sessions were analyzed jointly, and each group resulted in, on average, 0 conditions with 4 trials each, 9 conditions with 3 trials each, 40 conditions with 2 trials each, and 1642 conditions with 1 trial each. Subject CSI4 completed only 9 of 15 experimental sessions, and their data were analyzed in two partitions of 5 and 4 sessions each. Our reliability procedure measures the consistency of a voxel’s response profile (using Pearson <inline-formula><mml:math id="inf9"><mml:mi>r</mml:mi></mml:math></inline-formula>) over repeated presentations of the same stimuli, revealing areas of the brain containing stable BOLD responses. This straightforward approach enables direct comparison of data quality between different beta versions.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Impact of GLMsingle on voxel test-retest reliability. To compute reliability for a given voxel, we measure the test-retest Pearson correlation of GLM beta profiles over repeated presentations of the same stimuli (see Materials and methods).</title><p>(<bold>A</bold>) Differences in reliability between <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (derived from a baseline GLM) and <inline-formula><mml:math id="inf11"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> (the final output of GLMsingle) are plotted within a liberal mask of visual cortex (nsdgeneral ROI). Scatter plots show reliability values for individual voxels. (<bold>B</bold>) Relative differences in mean reliability within the nsdgeneral ROI. For each voxel, we computed the mean reliability value over all beta versions being considered (<inline-formula><mml:math id="inf12"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf13"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), and then used this as the basis for thresholding voxels (from Pearson <inline-formula><mml:math id="inf14"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow><mml:mo>-</mml:mo></mml:math></inline-formula> –0.2 – 0.6). At each threshold level, for each beta version, we compute the voxel-wise difference between the reliability of that specific beta version and the mean reliability value, and then average these difference values across voxels within the nsdgeneral ROI. The traces in the first column indicate the mean (+/- SEM) across subjects within each dataset (N = 4 for both NSD and BOLD5000). The bars in the second column indicate subject-averaged differences in reliability at threshold <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> 0.2. The relative improvement in reliability due to GLMsingle (<inline-formula><mml:math id="inf16"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf17"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) tends to increase when examining voxels with higher reliability, and each optimization stage within GLMsingle (HRF fitting, GLMdenoise, ridge regression) confers added benefit to voxel reliability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Inspection of HRF structure across space and time. Here we examine the optimal HRF indices chosen by GLMsingle within a liberal mask of visual cortex (nsdgeneral ROI) from an example subject (NSD subj01).</title><p>(<bold>A</bold>) Maps of <inline-formula><mml:math id="inf18"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values from an ON-OFF GLM, where all conditions are collapsed into a single predictor (see Materials and methods). ON-OFF <inline-formula><mml:math id="inf19"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values are output by GLMsingle for each of the subject’s 10 experimental sessions, and plotted here are the average <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values. Voxels are thresholded at three different levels: <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (top row), reflecting relatively inactive voxels, including those outside of gray matter; <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (middle row), reflecting voxels that are active in response to experimental stimuli; and <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (bottom row), reflecting voxels that are highly active in response to experimental stimuli. (<bold>B</bold>) Chosen HRF indices from the first scan session. In active voxels (middle and bottom rows), optimal HRF indices exhibit structure in the form of a low-frequency spatial gradient. (<bold>C</bold>) Stability of chosen HRF indices across sessions at different ON-OFF <inline-formula><mml:math id="inf24"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> thresholds. The optimal HRF indices within the nsdgeneral ROI are extracted for each session, thresholded at different ON-OFF <inline-formula><mml:math id="inf25"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> levels, and correlated between each pair of sessions. The inset indicates the average <inline-formula><mml:math id="inf26"><mml:mi>r</mml:mi></mml:math></inline-formula> over the lower triangular portion of each matrix. Optimal HRF indices identified using GLMsingle are stable over different experimental sessions in voxels that are active in response to experimental stimuli.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig2-figsupp1-v1.tif"/></fig></fig-group><p>We directly compared the <inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> beta versions for each subject within a liberal mask of visual cortex (nsdgeneral ROI), finding widespread increases in reliability when comparing GLMsingle to baseline (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). The positive effect is nearly uniform across voxels in NSD. In BOLD5000, as in NSD, we see aggregate benefits when comparing <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, though results for individual voxels are more variable. A likely explanation for this is that reliability metrics are inherently noisier due to the smaller number of repeated stimuli in BOLD5000. In addition, the magnitude of the benefits of <italic>b</italic>4 over <italic>b</italic>1 are somewhat smaller in BOLD5000 compared to NSD. This is likely true for a number of reasons, including the generally lower SNR in BOLD5000 (as a data-driven technique, GLMsingle is more effective at higher levels of SNR) and the relatively long inter-stimulus interval in BOLD5000 (ridge regression is expected to have smaller impact when there is less overlap of the BOLD response across successive trials).</p><p>To summarize the impact of GLMsingle in NSD and BOLD5000, we compared the performance of <italic>b</italic>1-<italic>b</italic>4 for individual subjects, across different voxel reliability thresholds (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). We find that all subjects show clear improvement from <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> and that the improvement in reliability due to GLMsingle tends to increase when examining voxels that respond more reliably to experimental stimuli. Furthermore, examining reliability in intermediate beta versions (<inline-formula><mml:math id="inf33"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>) – which implement HRF optimization and GLMdenoise, respectively – reveals that each successive stage of processing in GLMsingle tends to confer added benefit to voxel reliability compared to baseline (<inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p>To better understand the nature of the HRF fitting procedure, we examined selected HRFs across visually-responsive cortex of a representative subject (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). In active voxels, we observe a structured, low-frequency spatial gradient in HRF indices (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref>). Moreover, identified HRF indices are highly consistent from session to session (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1c</xref>). This provides evidence that, beyond merely capturing subject-specific deviation from the assumed HRF, the FitHRF procedure confers benefit by capturing voxel-wise differences in HRF shapes. We note that there are strong biophysical reasons to expect voxel-wise differences in HRF shapes, related to variation in the brain’s vasculature (<xref ref-type="bibr" rid="bib29">Kay et al., 2020</xref>).</p><p>We next compared GLMsingle to Least-Squares Separate (LSS), a popular technique for robust signal estimation in rapid event-related designs (<xref ref-type="bibr" rid="bib43">Mumford et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Mumford et al., 2014</xref>; <xref ref-type="bibr" rid="bib1">Abdulrahman and Henson, 2016</xref>). The LSS procedure fits a separate GLM for each stimulus, where the trial of interest is modeled as one regressor, and all other (non-target) trials are collapsed into a second regressor. LSS provides a useful point of comparison for ridge regression, as both strategies seek to mitigate the instabilities in GLM estimation that can arise from having correlated single-trial predictors. To directly compare GLMsingle to LSS, we computed auxiliary GLMsingle beta versions that do not incorporate GLMdenoise. This allows us to isolate the effect of the GLM estimation procedure (i.e. LSS vs. fractional ridge regression).</p><p>For both the case of an assumed HRF and the case of voxel-wise tailored HRFs, we find that fractional ridge regression yields more reliable signal estimates than LSS (<xref ref-type="fig" rid="fig3">Figure 3</xref>). These improvements are most pronounced in the most reliable voxels (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). LSS can be viewed as applying heavy regularization uniformly across voxels, while our ridge regression approach is more flexible, tailoring the degree of regularization to the SNR of each voxel. Heavy regularization may actually degrade the quality of signal estimates in reliable voxels, and our approach avoids this possibility.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Relative quality of GLMsingle and LSS beta versions. (<bold>A</bold>) Left panel: relative differences in mean reliability between beta versions.</title><p>8 beta versions are compared: <inline-formula><mml:math id="inf36"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, and the 4 auxiliary beta versions used to compare GLMsingle and Least-Squares Separate (LSS). LSS betas (dashed traces) are compared to those estimated using fractional ridge regression (RR, solid traces), when using a canonical HRF (LSS, light gray vs. RR, dark gray) and when performing HRF optimization (LSS, light purple vs. RR, dark purple). Right panel: summary of performance at threshold level <inline-formula><mml:math id="inf38"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> 0.2. Error bars reflect the standard error of the mean, computed over the 8 subjects analyzed from NSD and BOLD5000. Fractional ridge regression yields more reliable signal estimates than LSS across voxel reliability levels. (<bold>B</bold>) Same as Panel (<bold>A</bold>), except that reliability computations occur only between image repetitions processed in independent partitions of fMRI data. Qualitative patterns are unchanged. (<bold>C</bold>) Scatter plots comparing voxel reliability between corresponding LSS and GLMsingle beta versions (top: AssumeHRF; bottom: FitHRF). Plotted are results for an example subject (NSD subj01, nsdgeneral ROI). The advantage of ridge regression over LSS is most apparent in the most reliable voxels.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig3-v1.tif"/></fig><p>We then performed a complete assessment of all auxiliary beta versions and the primary versions (<inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), in order to determine whether any other analysis strategy could achieve parity with <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> in the quality of GLM outputs. Reassuringly, when summarizing the relative quality of all 8 beta versions over a range of reliability thresholds, we observe superior performance from <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, the default output of GLMsingle (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). For these and subsequent findings, it is important to note that differences between beta versions should be interpreted with caution at very high reliability thresholds, as voxel counts may be quite low for certain subjects.</p><p>GLMsingle relies on an internal cross-validation procedure through which key hyperparameters (the number of noise regressors and the voxel-wise levels of ridge regression regularization) are optimized to maximize the consistency of responses across condition repetitions. This raises a possible concern that our reliability estimates (e.g. <xref ref-type="fig" rid="fig2">Figure 2</xref>) are somewhat optimistic. As a strict assessment of reliability, we repeated the reliability quantification for each of the 8 beta versions, this time computing test-retest correlation values using only beta responses obtained from completely separate data partitions. We find that results are broadly unchanged using this more stringent evaluation procedure (<xref ref-type="fig" rid="fig3">Figure 3b</xref>).</p><p>As a further test of the general applicability of GLMsingle, we repeated the above procedures using data from the music-listening component of StudyForrest (<xref ref-type="bibr" rid="bib19">Hanke et al., 2015</xref>). This dataset measures brain responses as subjects listen to 25 distinct 6-s musical clips from 5 genres, with 8 trials per condition for each of 16 subjects. Each condition occurred once per functional run, and each subject completed one session of data consisting of 8 runs. This dataset differs from NSD and BOLD5000 in several key respects: the scale (there are far fewer trials), the task modality (auditory, as opposed to visual), and the use of a jittered inter-stimulus interval (the delay between trials is variable between 4 and 8 s). As in NSD and BOLD5000, we observe substantial improvements in reliability through the application of GLMsingle (<xref ref-type="fig" rid="fig4">Figure 4a–c</xref>), these improvements are consistent across subjects (<xref ref-type="fig" rid="fig4">Figure 4d</xref>), and each individual component of GLMsingle confers added benefit in reliability compared to the baseline GLM. These findings, arising from a smaller scale dataset that may more closely resemble a typical fMRI study, suggest the general applicability of GLMsingle to a wide range of datasets.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Impact of GLMsingle on reliability in the <italic>StudyForrest</italic> music-listening task. (<bold>A</bold>) Differences in voxel test-retest reliability (Pearson <inline-formula><mml:math id="inf43"><mml:mi>r</mml:mi></mml:math></inline-formula>) between <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (a baseline GLM) and <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> (the final output of GLMsingle) are plotted for individual voxels.</title><p>Only voxels that are active in response to experimental stimuli (ON-OFF <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) are plotted. (<bold>B</bold>) Estimated beta values (% BOLD change) for <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> in a hand-selected auditory cortex voxel from 6 representative subjects. Chosen voxels are indicated with pink stars in panel A. Each column represents one of 25 experimental conditions, with each condition presented 8 times. Test-retest reliability values reflect the split-half correlation between groups of 4 trial repetitions, averaged over all possible splits of the available repetitions (70 unique splits). (<bold>C</bold>) Relative differences in mean reliability between beta versions <inline-formula><mml:math id="inf49"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> - <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, computed using the same procedure as used for NSD and BOLD5000 (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Traces indicate the mean (+/- SEM) across subjects (N = 16). The bar graph (right) indicates the subject-averaged differences in reliability at threshold <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>D</bold>) Relative differences in mean reliability over different reliability inclusion thresholds are plotted for each subject.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig4-v1.tif"/></fig></sec><sec id="s2-2"><title>GLMsingle helps disentangle neural responses to neighboring trials</title><p>Thus far, we have established that GLMsingle provides BOLD response estimates that have substantially improved reliability compared to a baseline GLM. In the remainder of this paper, we explore whether these improvements have tangible consequences for downstream analyses relevant to cognitive and systems neuroscience. We first examine whether GLMsingle is able to more effectively disentangle neural responses to proximal stimuli, as inaccurate single-trial GLM estimation may manifest as high similarity (temporal autocorrelation) between beta maps from nearby trials. We computed dataset-averaged temporal similarity matrices, revealing the degree of temporal autocorrelation in each beta version (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Temporal autocorrelation manifests as non-zero correlation values off the diagonal of the temporal similarity matrices, and is presumably undesirable.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Impact of GLMsingle on temporal autocorrelation. For each dataset, we compute the degree of temporal autocorrelation in each beta version by averaging session-wise representational similarity matrices over subjects.</title><p>We plot results arising from analysis of voxels at two different reliability thresholds (<inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> 0 and <inline-formula><mml:math id="inf53"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mi/></mml:mrow></mml:math></inline-formula> 0.3) for NSD (<bold>A</bold>) and BOLD5000 (<bold>B</bold>). Assuming that ground-truth neural responses to consecutive trials should be uncorrelated on average, positive (or negative) Pearson <inline-formula><mml:math id="inf54"><mml:mi>r</mml:mi></mml:math></inline-formula> values off the diagonal imply suboptimal estimation of BOLD responses. In the right-most column, we plot mean autocorrelation between all pairs of timepoints. Applying GLMsingle (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) results in a substantial decrease in temporal autocorrelation compared to a baseline GLM approach (<inline-formula><mml:math id="inf56"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig5-v1.tif"/></fig><p>In a baseline GLM that uses a canonical HRF and ordinary least-squares (OLS) fitting (<inline-formula><mml:math id="inf57"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), we observe striking patterns of temporal autocorrelation extending several dozen trials forward in time. This is true in both NSD, which has a rapid event-related design (a new stimulus presented every 4 s), as well as in BOLD5000, where stimuli are spaced 10 s apart to alleviate issues relating to signal overlap. To quantify these effects, we compute mean temporal autocorrelation as a function of time post-stimulus for each beta version. In NSD, for the baseline GLM (<inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), positive correlations are as high as <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> for consecutive trials, and gradually reduce to around <inline-formula><mml:math id="inf60"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> after around 100 s (<xref ref-type="fig" rid="fig5">Figure 5a</xref>). In BOLD5000, <inline-formula><mml:math id="inf61"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> autocorrelation peaks as high as around <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula> for consecutive trials, requiring nearly 160 s to reduce to <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). We speculate that the relatively long timescale of the correlations reflects the long timescale of hemodynamic responses (the post-undershoot can extend for 30 s or longer) and/or the slow nature of (low-frequency) physiological noise related to cardiac and respiratory variation. Notably, mean beta maps from successive trials in NSD are <italic>anticorrelated</italic> for <inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, a known artifact of OLS fitting in the case of high multicollinearity between GLM predictors (<xref ref-type="bibr" rid="bib44">Mumford et al., 2014</xref>; <xref ref-type="bibr" rid="bib57">Soch et al., 2020</xref>).</p><p>When applying GLMsingle, these patterns of temporal autocorrelation change dramatically. In NSD <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, autocorrelation drops to <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> much more rapidly than in <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and in BOLD5000, beta maps from successive trials in <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> are now nearly uncorrelated on average. This is an expected outcome, since the stimuli in NSD and BOLD5000 are ordered pseudorandomly. In both datasets, an intermediate beta version (<inline-formula><mml:math id="inf69"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) containing only HRF optimization confers marginal benefit over <inline-formula><mml:math id="inf70"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, but the most dramatic improvements come from the addition of both GLMdenoise and fractional ridge regression (<inline-formula><mml:math id="inf71"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>). Overall, these results demonstrate the utility of GLMsingle for disentangling neural responses to nearby stimuli in event-related designs, even when events are presented relatively slowly (as in BOLD5000).</p></sec><sec id="s2-3"><title>GLMsingle improves between-subject representational similarity across datasets</title><p>Large-scale datasets such as NSD and BOLD5000 are well-suited for representational analyses (e.g. RSA) that compare evoked neural response patterns between individual subjects, across different experimental modalities, and against computational models (e.g. deep neural networks, see <xref ref-type="bibr" rid="bib32">Kriegeskorte, 2015</xref>; <xref ref-type="bibr" rid="bib56">Serre, 2019</xref> for review.) In almost all such studies, representational analyses presume that the same set of stimuli will evoke reasonably similar responses across subjects. As such, given the ubiquity of noise in fMRI, it is reasonable to expect that improving the accuracy of single-trial response estimates should yield representations that are more similar across individuals.</p><p>To compare representations between subjects, we used the approach of RSA (<xref ref-type="bibr" rid="bib31">Kriegeskorte et al., 2008</xref>). First, we isolated stimuli that overlap between BOLD5000 and the subset of NSD analyzed for this manuscript (the first 10 sessions from each subject). Using these 241 stimuli, we constructed representational dissimilarity matrices (RDMs) using repetition-averaged betas from each individual, and then correlated all pairs of subject RDMs within and between datasets. Note that GLMsingle is not designed to enhance or optimize cross-subject representational similarity; as such, it is informative to examine RSA correlations between subjects as a way of assessing methods for denoising (<xref ref-type="bibr" rid="bib8">Charest et al., 2018</xref>). Strikingly, in comparing beta versions <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, we observe a consistent strengthening of RDM correspondence (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). This trend held within NSD, within BOLD5000, and when comparing the RDMs of subject pairs between the two datasets. The latter result is especially notable given the many methodological differences between NSD and BOLD5000: fMRI data were collected at different sites on different scanners, at different field strengths (7T vs. 3T), with different behavioral tasks, and with different inter-stimulus intervals (4 s vs. 10 s).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Impact of GLMsingle on inter-subject RDM correlations.</title><p>(<bold>A</bold>) Correlations of RDMs across all pairs of subjects and beta versions, at 3 different voxel reliability thresholds. We compute RDMs for each subject and beta version using Pearson dissimilarity (1 - <inline-formula><mml:math id="inf74"><mml:mi>r</mml:mi></mml:math></inline-formula>) over repetition-averaged betas within the nsdgeneral ROI. Grid lines separate beta versions from one another, an individual cell reflects the RDM correlation between one pair of subjects, and cross-dataset comparisons occupy the top-right and bottom-left quadrants of the matrices. (<bold>B</bold>) Mean inter-subject RDMs correlations within NSD (N = 4; left), within BOLD5000 (N = 4; center), and between the two datasets (N = 16 subject pairs; right). GLMsingle (<inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) yields a considerable strengthening of RDM correspondence for each subject pair being considered, within and between datasets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig6-v1.tif"/></fig><p>These results indicate that GLMsingle, through its multifaceted approach to mitigating the effects of noise, helps reveal meaningful shared variance in neural responses across individuals who viewed the same stimuli. The GLMsingle toolbox may therefore be a key resource for future fMRI studies seeking to stitch together data across subjects from different sites or cohorts.</p></sec><sec id="s2-4"><title>GLMsingle enables fine-grained image-level MVPA decoding</title><p>As a final analysis, we assessed the effect of GLMsingle on the results of multivoxel pattern analysis (MVPA). In a “one-vs.-many” classification paradigm, we trained linear SVM models for each subject to predict image identity from neural response patterns. The baseline GLM (<inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) classification accuracy was slightly above chance on average for the subjects in NSD and BOLD5000 when including all visual cortex voxels (<xref ref-type="fig" rid="fig7">Figure 7a</xref>, blue traces). Performing the same MVPA procedure using GLMsingle betas (<inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), we observe that mean accuracy approximately triples in NSD and doubles in BOLD5000 (<xref ref-type="fig" rid="fig7">Figure 7a</xref>, red traces). Moreover, in both datasets, we observe a substantial increase in classification accuracies with increasing voxel reliability threshold, with the most dramatic improvements achieved using <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> in NSD (<xref ref-type="fig" rid="fig7">Figure 7a</xref>, left panel, right-most bins).</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Impact of GLMsingle on image-level MVPA decoding accuracy.</title><p>(<bold>A</bold>) Image-level linear SVM decoding accuracy by beta version. At each reliability threshold, we compute the mean decoding accuracy over subjects within each dataset, as well as the standard error of the mean (N = 4 for NSD; N = 3 for BOLD5000). Classifiers are trained on <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> available image repetitions, and tested on the held-out repetition, with accuracy averaged over cross-validation folds. Applying GLMsingle (<inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) yields dramatic increases in image decodability compared to a baseline GLM (<inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>B</bold>) The effect of GLMsingle on animacy representation is shown in an example NSD subject (subj01) using multidimensional scaling. GLMsingle clarifies the division in representational space between stimuli containing animate and inanimate objects.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-77599-fig7-v1.tif"/></fig><p>The level of performance that GLMsingle facilitates on this challenging multi-way decoding task highlights the ability of the technique to accurately identify and model the stable structure contained in noisy fMRI time-series. To illustrate this point, we performed 2D multidimensional scaling (MDS, <xref ref-type="bibr" rid="bib6">Borg and Groenen, 2005</xref>) using the NSD betas that were included in MVPA. Comparing results between beta versions <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, we observe improved clarity of an animacy division in the representational space of an example subject (<xref ref-type="fig" rid="fig7">Figure 7b</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>As scientific datasets grow in scale and scope, new techniques for data processing will help to unlock their potential. This is especially true in human neuroscience where data remain both expensive and time-consuming to collect (<xref ref-type="bibr" rid="bib46">Naselaris et al., 2021</xref>). This paper has introduced GLMsingle, a publicly available toolbox for analyzing fMRI time-series data that leverages data-driven techniques to improve the accuracy of single-trial fMRI response estimates. We have tested GLMsingle extensively using NSD and BOLD5000, two of the largest fMRI datasets that densely sample responses within individuals. For both datasets, analyses of the response estimates provided by GLMsingle indicate substantial improvements in several key metrics of interest to neuroscientists: (i) enhanced test-retest reliability of voxel response profiles, a straightforward metric of data quality; (ii) reduced temporal autocorrelation, a common fMRI effect that is presumably undesirable and especially prominent in rapid event-related designs; (iii) increased representational similarity across subjects both within and across datasets; and (iv) improved multivariate pattern classification performance when discriminating responses evoked by individual images.</p><sec id="s3-1"><title>Principles underlying GLMsingle</title><p>GLMsingle incorporates three optimization procedures to improve the estimation of fMRI responses:</p><list list-type="order"><list-item><p><italic>HRF fitting. </italic>GLMsingle uses a “library of HRFs” technique to select the most appropriate HRF to use for each voxel in a given dataset (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>). This library consists of a set of 20 HRFs that were derived from experimental data (specifically, the first NSD scan session acquired in each of the eight NSD subjects). It is well known that variations in HRFs exist across voxels, brain areas, and subjects, and that mismodeling the timecourse of a voxel may lead to suboptimal analysis outcomes (<xref ref-type="bibr" rid="bib17">Handwerker et al., 2004</xref>; <xref ref-type="bibr" rid="bib18">Handwerker et al., 2012</xref>). Imposing constraints on HRF selection by choosing from a fixed set of HRFs avoids the instability (high variance) associated with more flexible timecourse modeling approaches, such as finite impulse response modeling (<xref ref-type="bibr" rid="bib27">Kay et al., 2008</xref>; <xref ref-type="bibr" rid="bib3">Bai and Kantor, 2007</xref>). Variations in timecourse shapes in the HRF library reflect a continuum between short-delay, narrow-width timecourses to long-delay, broad-width timecourses, and are likely caused by variations in the contribution of large vessels to the BOLD response observed in a voxel (<xref ref-type="bibr" rid="bib29">Kay et al., 2020</xref>).</p></list-item><list-item><p><italic>Data-driven denoising.</italic> Incorporating an adaptation of the GLMdenoise technique (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>), GLMsingle uses principal components analysis to calculate potential nuisance regressors from fMRI time-series data observed in voxels that are deemed unrelated to the experimental paradigm. These regressors are incorporated into the GLM using a cross-validation procedure to determine the optimal number of nuisance regressors to add. A key aspect of our approach is the acknowledgement that including increasing numbers of nuisance regressors will, at some point, cause overfitting and degradation of results (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>); this motivates the use of cross-validation to determine the optimal level of model complexity.</p></list-item><list-item><p><italic>Regularization of GLM weights.</italic> To improve the accuracy of single-trial GLM response estimates, GLMsingle uses fractional ridge regression (<xref ref-type="bibr" rid="bib54">Rokem and Kay, 2020</xref>), with an optimal degree of regularization identified for each voxel, again using cross-validation. The improvements afforded by this procedure are due to the substantial amount of overlap of the fMRI response across successive trials, unless very long (&gt;30 s) inter-stimulus intervals are used. It is well known that, in the context of ordinary least-squares estimation, two predictors that are correlated (or anti-correlated) will have reduced estimation precision compared to the scenario in which the predictors are uncorrelated (<xref ref-type="bibr" rid="bib43">Mumford et al., 2012</xref>; <xref ref-type="bibr" rid="bib57">Soch et al., 2020</xref>). For rapid event-related designs, predictors for consecutive trials are typically correlated, and ordinary least-squares estimates will suffer from high levels of instability. Ridge regression imposes a shrinkage prior (penalizing the sum of the squares of the beta estimates), which can, in principle, dampen the effects of noise and improve out-of-sample generalizability of the beta estimates.</p></list-item></list></sec><sec id="s3-2"><title>Ideal use-cases for GLMsingle</title><p>GLMsingle is designed to be general in its application. It uses data-driven procedures that automatically adapt to the signal-to-noise characteristics of a given dataset. For example, in datasets where structured noise is prevalent, appropriate nuisance regressors will automatically be included, whereas in datasets with very little structured noise (e.g. low head motion), fewer (or no) nuisance regressors will be included. As another example, for experimental designs with high temporal overlap between consecutive trials or high levels of noise, relatively strong levels of shrinkage regularization will likely be selected.</p><p>GLMsingle is a general technique that can be fruitfully applied to nearly <italic>any</italic> fMRI experiment involving discrete events (including block designs). However, we recognize that integrating a new tool into an analysis workflow requires effort. Therefore, we anticipate that the most consequential impact of GLMsingle will be observed for study designs with low sensitivity (such as condition-rich designs).</p></sec><sec id="s3-3"><title>Implementation guidelines</title><p>Datasets can have complex features that may complicate the way in which one applies GLMsingle. In this section, we comment on major implementation-related choices that the user may face when deciding how to apply GLMsingle to their own experimental paradigms. Additional discussion of more minor issues can be found in the online toolbox documentation.</p><sec id="s3-3-1"><title>Experimental design</title><sec id="s3-3-1-1"><title>Requirement of repeated conditions</title><p>In order to determine appropriate hyperparameter settings, it is necessary for some number of repeated trials to exist in the data that are input to GLMsingle. It is not critical that the conditions be balanced in their number of repetitions, and even a handful of repeats appears to be sufficient to robustly guide the estimation of hyperparameters. For example, for the groups of sessions from BOLD5000 that were analyzed in this paper, typically only about 3% of the conditions were repeated (i.e. had more than a single trial).</p></sec><sec id="s3-3-1-2"><title>Minimum trial separation</title><p>The degree to which GLMsingle can effectively separate response amplitudes to closely spaced trials is an empirical question that depends, in part, on the temporal characteristics of the hemodynamic response function. As shown in this paper, effective results were obtained in the Natural Scenes Dataset where the trial separation is 4 s (images are shown for 3 s and the inter-stimulus interval is 1 s). More rapid experimental designs will generally incur greater overlap in the BOLD responses to neighboring trials, making response estimation more challenging. However, in these scenarios a greater number of trials can be run, which may counteract the loss of power arising from the response overlap. Future work could seek to systematically manipulate inter-trial intervals to assess the effectiveness of GLMsingle under more rapid designs.</p></sec><sec id="s3-3-1-3"><title>Coding of blank trials</title><p>GLMsingle expects that blank trials are not coded in the design matrix. The GLM uses a set of polynomials per run to model the baseline signal, which is associated with sections of the experiment that are not explicitly coded as events. Single-trial betas therefore reflect evoked BOLD responses above and beyond the baseline signal. Coding blank trials as events would interfere with this important component of the GLM estimation procedure.</p></sec><sec id="s3-3-1-4"><title>Modeling trial subcomponents</title><p>In some experiments, there may be multiple stages of a given trial (e.g. cue, preparatory period, stimulus presentation). GLMsingle does not distinguish between these subcomponents, and the particular modeling strategy is at the discretion of the experimenter. One approach is to treat all subcomponents of a trial as contributing to a single response amplitude. Alternatively, each subcomponent can be treated as a distinct condition (e.g. the cue for condition A coded as “condition A1” and the stimulus for condition A coded as “condition A2”, and so on). In such an approach, the goal is to estimate a separate response amplitude for each subcomponent of each trial.</p></sec></sec></sec><sec id="s3-4"><title>fMRI data preparation</title><sec id="s3-4-1"><title>Handling data from multiple scan sessions</title><p>BOLD responses and noise characteristics can change substantially across scan sessions (days) for an individual. For this reason, it is generally recommended to apply GLMsingle to individual scan sessions, if possible. However, if it is necessary to apply GLMsingle to data concatenated across days, one potential problem is that gross amplitude differences across sessions will be treated as noise, leading to suboptimal estimation performance. Users may avoid this issue by taking advantage of the <italic>sessionindicator</italic> option, which allows users to specify how different input runs are grouped into sessions. GLMsingle uses this information internally to <inline-formula><mml:math id="inf84"><mml:mi>z</mml:mi></mml:math></inline-formula>-score responses within sessions to better estimate cross-validated model performance. This normalization step does not propagate to final outputs. In the processing of BOLD5000 data for this manuscript, we indeed took advantage of the <italic>sessionindicator</italic> option (see Materials and methods).</p></sec><sec id="s3-4-2"><title>Compatible pre-processing steps</title><p>Beyond the expectation that the fMRI data provided to GLMsingle are minimally pre-processed (e.g. motion corrected and ideally slice-time corrected), there are several other common pre-processing steps that are fully compatible with GLMsingle. First, the pipeline works in a straightforward manner with data that have been masked, skull-stripped, or projected into surface space (where voxels falling outside of gray matter may have already been excluded). Second, spatial changes (such as the registration of fMRI data to an atlas space, or to a subject’s anatomy) do not interfere with the operation of GLMsingle. Third, it is acceptable to perform grand intensity scaling to normalize units across subjects and/or sessions. However, users should be wary of scaling procedures that are applied differently across brain regions or voxels, or across different runs in a session. Finally, since GLMsingle requires the design matrix and fMRI data to be temporally synchronized, users may need to resample one or both objects in order to match their temporal resolution.</p></sec><sec id="s3-4-3"><title>Incompatible pre-processing steps</title><p>Several common fMRI pre-processing steps are unnecessary in conjunction with GLMsingle. For example, high-pass filtering of fMRI data is not recommended, as GLMsingle automatically includes a set of polynomials to model low-frequency drifts in the baseline signal that may occur over the course of each run. Neither is low-pass filtering necessary, since the use of well-regularized hemodynamic response functions to model evoked responses automatically discounts high-frequency temporal noise. In addition, it is not recommended to project out putative nuisance components of fMRI data (e.g. motion regressors, nuisance regressors derived from white matter or cerebrospinal fluid) prior to running GLMsingle, as these pre-filtering approaches pose a risk of biasing signal estimates. GLMsingle’s approach is to learn nuisance components from the data and to respect the potential overlap of these components with signal components of interest.</p></sec></sec><sec id="s3-5"><title>HRF estimation</title><sec id="s3-5-1"><title>HRF selection does not require cross-validation</title><p>The components of GLMsingle beyond HRF selection each have natural, unregularized states: for GLMdenoise, this entails including no additional nuisance regressors, and for ridge regression, this entails performing ordinary least-squares estimation and adding no shrinkage bias. The selection of the HRF, however, is different. At least in its current formulation, GLMsingle views each of the HRFs from the library as an equally valid HRF, which is justifiable given the diversity of HRF shapes across voxels and subjects. Thus, there is no notion of regularization inherent to the procedure, and GLMsingle needs only to select the HRF that maximizes fit to the data.</p></sec></sec><sec id="s3-6"><title>GLMdenoise</title><sec id="s3-6-1"><title>Control over the noise pool</title><p>The default behavior of GLMsingle is to automatically select noise pool voxels as those that both exceed a simple signal intensity threshold (which excludes out-of-brain voxels) and have negligible amounts of BOLD variance related to the experiment (using an <inline-formula><mml:math id="inf85"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> threshold). If desired, users of GLMsingle can control the noise pool voxels via the <italic>brainthresh</italic> argument (determining which voxels pass the intensity threshold), the <italic>brainR2</italic> argument (determining which voxels pass the <inline-formula><mml:math id="inf86"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> threshold), and the <italic>brainexclude</italic> argument (allowing for a custom mask of voxels to be considered for the noise pool). Users may also limit the number of noise PCs that may be added to the GLM (or hard-code the quantity ahead of time) via the <italic>pcstop</italic> argument.</p></sec><sec id="s3-6-2"><title>Constraints on denoising</title><p>Could denoising remove signals of interest? GLMsingle guards against improper use of nuisance regressors through cross-validation. If, for any reason, there are valid experimental signals being derived from the noise pool, GLMsingle will tend to avoid including these regressors since they will likely degrade the cross-validation performance of the model. In fact, even if the noise pool is deliberately expanded to include signal-carrying voxels, some improvement in beta estimates is still possible, since the GLM estimation can theoretically separate the variance contributions from signal and nuisance regressors (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>).</p></sec></sec><sec id="s3-7"><title>Fractional ridge regression</title><sec id="s3-7-1"><title>Scale and offset following regularization</title><p>By default, after the application of ridge regression, GLMsingle applies a post-hoc scale and offset to the single-trial betas obtained for a given voxel to best match the response distribution of the unregularized case. The reason for this is that due to shrinkage, the betas for voxels with poor signals are shrunken close to 0 – they have a bias to be small in magnitude. The simple scale and offset step is intended to undo this bias. Users may omit the scale and offset (via appropriate setting of the <italic>wantautoscale</italic> argument) and/or avoid ridge regression altogether (via <italic>wantfracridge</italic>).</p></sec><sec id="s3-7-2"><title>Scenarios where key hypotheses depend on neighboring trials</title><p>Studies seeking to analyze responses to trials that are close together in time (e.g. repetition suppression tasks, or preparation-execution in motor tasks) pose fundamental challenges with respect to signal estimation, due to the substantial overlap in BOLD responses when events occur within seconds of one another. Users should be mindful of how they analyze data using GLMsingle in these contexts. Of particular relevance is the fact that ridge regression, through its shrinkage bias, encourages some amount of temporal smoothing of beta estimates for nearby trials (in the sense that beta weights from temporally adjacent trials are biased to be more similar in magnitude). When the critical hypotheses depend on responses to nearby trials, users may consider disabling the ridge regression component of GLMsingle (to avoid any effects of temporal smoothing). However, note that there is no guarantee that doing so will improve the accuracy of signal estimation – single-trial predictors associated with neighboring events will still be highly correlated, and ordinary least-squares (OLS) estimates will exhibit structured, correlated errors as a result. In fact, our empirical results suggest that ridge regression reduces unwanted temporal autocorrelation (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p></sec><sec id="s3-7-3"><title>Ridge regression enables interpretation of GLM <italic>R</italic>²</title><p>In the case of a single-trial design matrix, the quantity and flexibility of the predictors enables a regression model fit using OLS to capture almost all the variance in the time-series data from a voxel, even if that voxel contains no actual signal. Thus, for all GLMsingle beta versions that do not include ridge regression (<inline-formula><mml:math id="inf87"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> - <inline-formula><mml:math id="inf88"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">3</mml:mn></mml:mrow></mml:math></inline-formula>), users should avoid interpreting the GLM <inline-formula><mml:math id="inf89"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> values, as they will be inflated across the brain and not provide a reliable index of signal-to-noise ratio (SNR). However, the ridge regression technique (as a direct consequence of its goal of optimizing cross-validated generalizability of the single-trial beta estimates) will tend to leave unperturbed the voxels that have good SNR and aggressively regularize the voxels with little or no SNR. As a consequence, the GLM <inline-formula><mml:math id="inf90"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> values produced by ridge regression (<inline-formula><mml:math id="inf91"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">4</mml:mn></mml:mrow></mml:math></inline-formula>) will be directly indicative of SNR, and therefore can be informative to the user.</p></sec></sec><sec id="s3-8"><title>Potential limitations to consider when applying GLMsingle</title><p>GLMsingle relies on cross-validation to determine two key hyperparameters: (i) the number of nuisance regressors to use in the GLM as derived by applying PCA to data from the noise pool voxels; and (ii) the amount of ridge-regression shrinkage to apply for each voxel. Although the data-driven nature of the technique is one of its strengths (since it adapts to the characteristics of each dataset), it is also a potential limitation. First, a prerequisite for application of GLMsingle is the existence of at least some repeated trials in a given dataset. A dataset consisting only of experimental conditions with a single occurrence each cannot be used in conjunction with the cross-validated procedures for determining the optimal number of nuisance regressors and the voxel shrinkage fractions. Second, since data are invariably noisy, the determination of hyperparameters is subject to noise, and it is not guaranteed that hyperparameter estimates will be accurate in all possible data situations. It remains an open question for further investigation what the minimum data requirements are for reasonably accurate hyperparameter estimation.</p><p>Given the requirement of repeated discrete events, GLMsingle is not applicable to resting-state data, since they contain no explicit task structure. Similarly, GLMsingle is not suitable for experiments that involve continuous event structures – for example, movie watching, storytelling, dynamic exploration, game-playing – unless certain events within the task are coded as discrete, repeated instances. For example, the appearance on-screen of a particular character could be treated as a repeated “event” in constructing a design matrix. Or, as another example, certain words or parts of speech could be treated as “events” within a continuous auditory or linguistic experiment.</p><p>It is important to consider whether denoising comes at the potential cost of introducing bias (<xref ref-type="bibr" rid="bib30">Kay, 2022</xref>). Considering each component of GLMsingle, we believe that the risk of bias is minimal for most use cases. First, considering the library-of-HRFs approach, we note that the conventional approach of using a fixed canonical HRF actually incurs more risk of biasing response estimates than does an approach that attempts to flexibly capture variations in HRFs. Nonetheless, we acknowledge that the library may not necessarily capture all HRF shapes, and this represents one possible source of bias (note that it is possible to derive a new HRF library tailored to a given dataset of interest). Second, considering the GLMdenoise procedure, we note that data-derived nuisance regressors are not blindly removed from the time-series data prior to modeling, as this would pose a clear risk of removing experimentally-driven signals, thereby leading to bias (<xref ref-type="bibr" rid="bib38">Liu et al., 2001</xref>). Rather, by including both task-related regressors and nuisance regressors in the GLM, the model can appropriately partition variance between signal and noise sources. Third, considering ridge regression, we note that shrinkage can be viewed as a form of temporal smoothing (as explained above). While shrinkage is indeed a source of bias, this should be concerning only for investigations where relative responses to nearby trials are of specific interest (e.g. studies of repetition suppression). For other investigations, and especially for experiments where condition ordering is pseudorandom, it is unlikely that this form of temporal regularization and its associated bias would lead to incorrect scientific inferences.</p><p>More generally, it is important to realize that GLMsingle uses limited and principled signal processing methods to improve the quality of BOLD signal estimates. It is not meant to – nor is able to – arbitrarily remove variability from a set of data, variability that may in fact be of interest to the researcher (e.g. trial-to-trial variations in response due to changes in behavioral state). Rather, GLMsingle is capable of modifying the data in only relatively constrained ways, for example, by dampening temporal instabilities in beta estimates (ridge regression) and by removing variance attributable to nuisance regressors (GLMdenoise). As we have demonstrated, applying GLMsingle to empirical data provides major substantive benefits with respect to downstream analytical outcomes.</p></sec><sec id="s3-9"><title>Online example scripts and tutorials</title><p>To enable easy adoption of GLMsingle, we provide extensive documentation and example scripts for common neuroimaging use-cases (<ext-link ext-link-type="uri" xlink:href="https://glmsingle.org/">glmsingle.org</ext-link>). Publicly available online resources include code implementation of GLMsingle in both MATLAB and Python, example scripts and notebooks, technical documentation, and answers to frequently asked questions. The GLMsingle pipeline is designed to be easy to implement in different neuroimaging pipelines. The example scripts we provide illustrate typical GLMsingle usage for both event-related and block designs. These scripts guide the user through basic calls to GLMsingle, using representative, small-scale example datasets. In addition, they provide helpful visualizations related to inspection and interpretation of intermediate outputs from the pipeline (e.g. optimal HRF indices and ridge regression shrinkage fractions). We hope these practical resources facilitate the application of GLMsingle to existing and future neuroimaging datasets.</p></sec><sec id="s3-10"><title>Conclusion</title><p>Our results suggest that GLMsingle represents a methodological advancement that will help improve data quality across different fMRI designs. While improvements in MR hardware (e.g. magnetic field strength, RF coil, pulse sequences) and experimental design (e.g. optimized study design and trial distributions) may contribute to improved data quality, the benefits of GLMsingle demonstrated in this paper make clear that data processing techniques are another critical factor that can profoundly impact SNR and overall experimental power. As an analogy, we observe that the rapid (and annual) improvement in cell phone cameras has been driven in large part by advances in image analysis algorithms. As summarized by an Apple executive, “[while sensor quality has improved], increasingly, what makes incredible photos possible aren’t just the sensor and the lens but the chip and the software that runs on it” (<xref ref-type="bibr" rid="bib58">Wilson, 2018</xref>). We suggest that GLMsingle represents a similar advance in signal processing for fMRI.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Description of GLMsingle</title><sec id="s4-1-1"><title>Inputs to GLMsingle</title><p>GLMsingle expects that input fMRI data have been pre-processed with motion correction at minimum, and ideally slice time correction as well. Additional common pre-processing steps such as compensation for spatial distortion, spatial smoothing, or registration to an anatomical space (or atlas space) are all compatible with GLMsingle without any complications. Detrending or high-pass filtering the time-series data is not necessary, as low-frequency fluctuations are modeled as part of the GLM fitting procedure. The input fMRI data can be supplied in either volumetric or surface format. Besides fMRI data, the other user-provided input to GLMsingle is an array of design matrices corresponding to each run of the time-series data, indicating the sequence of events that occurred during the runs. GLMsingle expects that these are matrices with dimensions (time x conditions), where each column corresponds to a single condition and consists of zeros except for ones indicating the onset times for that condition. Further details about data formats are provided in the online code repository.</p></sec><sec id="s4-1-2"><title>GLMsingle overview</title><p>GLMsingle consists of three main analysis components. The first component is the use of a library of hemodynamic response functions (HRFs) to identify the best-fitting HRF for each voxel. This simple approach for compensating for differences in hemodynamic timecourses across voxels (<xref ref-type="bibr" rid="bib17">Handwerker et al., 2004</xref>) has several appealing features: it invariably provides well-regularized HRF estimates, and it is efficient and can be executed with reasonable computational cost. The second component is an adaptation of GLMdenoise to a single-trial GLM framework. GLMdenoise is a previously introduced technique (<xref ref-type="bibr" rid="bib28">Kay et al., 2013</xref>) in which data-derived nuisance regressors are identified and used to remove noise from – and therefore improve the accuracy of – beta estimates. The third analysis component is an application of ridge regression (<xref ref-type="bibr" rid="bib22">Hoerl and Kennard, 1970</xref>) as a method for dampening the noise inflation caused by correlated single-trial GLM predictors. To determine the optimal level of regularization for each voxel, we make use of a recently developed efficient re-parameterization of ridge regression called “fractional ridge regression” (<xref ref-type="bibr" rid="bib54">Rokem and Kay, 2020</xref>).</p></sec><sec id="s4-1-3"><title>Derivation of the library of HRFs</title><p>The HRF library incorporated into GLMsingle was previously used for signal estimation in analyzing the Natural Scenes Dataset. Complete details on the derivation procedure for the HRF library can be found in the NSD dataset paper (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>). In brief, empirically observed BOLD timecourses were subject to principal components analysis, projected onto the unit sphere, and parameterized using a path consisting of 20 regularly-spaced points through the area of greatest data density. The timecourses corresponding to the resulting set of 20 points were fit using a double-gamma function as implemented in SPM’s spm_hrf.m, yielding a fixed library of 20 HRFs. This library is the default in GLMsingle, and was used for all analyses of the NSD, BOLD5000, and StudyForrest datasets described here. Future studies may seek to refine or expand the HRF library (e.g. by deriving it from a larger pool of subjects, or by restricting estimation to individual subjects).</p></sec><sec id="s4-1-4"><title>Cross-validation framework for single-trial GLMs</title><p>The GLMdenoise and ridge regression analysis components of GLMsingle both require tuning of hyperparameters (specifically, the number of nuisance regressors to include in GLM fitting and the regularization level to use for each voxel). To determine the optimal setting of hyperparameters, we use a cross-validation approach in which out-of-sample predictions are generated for single-trial beta estimates. Performing cross-validation on single-trial betas, as opposed to time-series data, simplifies and reduces the computational requirements of the cross-validation procedure. Note that because of cross-validation, although GLMsingle produces estimates of responses to single trials, it does require the existence of and information regarding repeated trials (that is, trials for which the experimental manipulation is the same and expected to produce similar brain responses). This requirement is fairly minimal, as most fMRI experiments are designed in this manner.</p><p>The first step of the cross-validation procedure is to analyze all of the available data using a generic GLM. In the case of GLMdenoise, this amounts to the inclusion of zero nuisance regressors; in the case of ridge regression, this amounts to the use of a shrinkage fraction of 1, which corresponds to ordinary least-squares regression. In both cases, the generic analysis produces a full set of unregularized single-trial betas (e.g. in one NSD session, there are 750 single-trial betas distributed across 12 runs, and in one BOLD5000 session, there are either 370 or 333 single-trial betas distributed across either 10 or 9 runs). The second step of the procedure is to perform a grid search over values of the hyperparameter (e.g., number of GLMdenoise nuisance regressors; ridge regression shrinkage fraction). For each value, we assess how well the resulting beta estimates generalize to left-out runs. By default, for all cross-validation procedures, GLMsingle implements the following leave-one-run-out routine: (1) one run is held out as the validation run, and experimental conditions that occur in both the training runs and the validation run are identified; (2) squared errors between the regularized beta estimates from the training runs and the unregularized beta estimates from the validation run are computed; (3) this procedure is repeated iteratively, with each run serving as the validation run, and errors are summed across iterations.</p></sec><sec id="s4-1-5"><title>GLMsingle algorithm</title><p>Having described the essential aspects of the estimation framework above, we now turn to the steps in the GLMsingle algorithm. GLMsingle involves fitting several different GLM variants. Each variant includes polynomial regressors to characterize the baseline signal level: for each run, we include polynomials of degrees 0 through <inline-formula><mml:math id="inf92"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf93"><mml:mi>L</mml:mi></mml:math></inline-formula> is the duration in minutes of the run.</p><list list-type="order"><list-item><p><italic>Fit a simple ON-OFF GLM</italic>. In this model, all trials are treated as instances of a single experimental condition, and a canonical HRF is used. Thus, there is a single “ON-OFF” predictor that attempts to capture signals driven by the experiment. The utility of this simple model is to provide variance explained (<inline-formula><mml:math id="inf94"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) values that help indicate which voxels carry experimentally-driven signals.</p></list-item><list-item><p><italic>Fit a baseline single-trial GLM</italic>. In this model, each stimulus trial is modeled separately using a canonical HRF. This model provides a useful baseline that can be used for comparison against models that incorporate more advanced features (as described below).</p></list-item><list-item><p><italic>Identify an HRF for each voxel</italic>. We fit the data multiple times with a single-trial GLM, each time using a different HRF from the library of HRFs. For each voxel, we identify which HRF provides the best fit to the data (highest variance explained), and inherit the single-trial betas associated with that HRF. Note that the final model for each voxel involves a single chosen HRF from the library.</p></list-item><list-item><p><italic>Use GLMdenoise to determine nuisance regressors to include in the model</italic>. We define a pool of noise voxels (brain voxels that have low ON-OFF <inline-formula><mml:math id="inf95"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>, according to an automatically determined threshold) and then perform principal components analysis on the time-series data associated with these voxels (separately for each run). The top principal components (each of which is a timecourse) are added one at a time to the GLM until cross-validation performance is maximized on-average across voxels. The inclusion of these nuisance regressors is intended to capture diverse sources of noise that may contribute to the time-series data in each voxel.</p></list-item><list-item><p><italic>Use fractional ridge regression to regularize single-trial betas</italic>. With the nuisance regressors determined, we use fractional ridge regression to determine the final estimated single-trial betas. This is done by systematically evaluating different shrinkage fractions. The shrinkage fraction for a given voxel is simply the ratio between the vector length of the set of betas estimated by ridge regression and the vector length of the set of betas returned by ordinary least-squares estimation, and ranges from 0 (maximal regularization) to 1 (no regularization). For each voxel, in the context of a GLM that incorporates the specific HRF chosen for that voxel as well as the identified nuisance regressors, cross-validation is used to select the optimal shrinkage fraction.</p></list-item></list><p>The default behavior of GLMsingle is to return beta weights in units of percent signal change by dividing by the mean signal intensity observed at each voxel and multiplying by 100. To preserve the interpretability of GLM betas as percent signal change even after applying shrinkage via ridge regression, we apply a post-hoc scaling and offset on the betas obtained for each voxel in order to match, in a least-squares sense, the unregularized betas (shrinkage fraction equal to 1) obtained for that voxel.</p><p>To give a sense of the computational requirements of GLMsingle, we report here results for an example scenario. We ran the MATLAB version of GLMsingle with default parameters on the first NSD scan session for subj01 (1.8-mm standard-resolution version of the data). The scan session involved 750 trials and a data dimensionality of (81 voxels × 104 voxels × 83 voxels) = 699,192 voxels and (12 runs × 226 volumes) = 2712 time points. The code was run on an 32-core Intel Xeon E5-2670 2.60 GHz Linux workstation with 128 GB of RAM and MATLAB 9.7 (R2019b). The data were loaded in single-precision format, resulting in a base memory usage of 8.4 GB of RAM (the data alone occupied 7.6 GB). Code execution (including figure generation and saving results to disk) took 4.8 hr (average of 2 trials). The maximum and mean memory usage over the course of code execution was 38.0 GB and 18.5 GB of RAM, respectively.</p></sec><sec id="s4-1-6"><title>GLMsingle outputs</title><p>The default output from GLMsingle includes the different GLM beta estimates that are progressively obtained in the course of the algorithm (e.g. the single-trial betas with voxel-wise tailored HRFs; the single-trial betas incorporating GLMdenoise, etc.). The pipeline also outputs several metrics of interest, such as a map of the HRF indices chosen for different voxels, the <inline-formula><mml:math id="inf96"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values from the ON-OFF GLM, a map of the voxels identified as “noise”, a summary plot of the cross-validation procedure used to select the number of noise regressors, and a map of the amount of ridge regression shrinkage applied at each voxel. These outputs are displayed in a set of convenient figures.</p></sec><sec id="s4-1-7"><title>Flexibility of GLMsingle</title><p>Although GLMsingle provides default settings for the parameters that control its operation, the toolbox is flexible and allows the user to adjust the parameters if desired. Modifying the parameters allows the user to achieve a range of different behaviors, such as expanding the HRF library to include additional candidate HRFs; changing the maximum number of nuisance regressors tested during GLMdenoise (default is 10); modifying the range of shrinkage fractions evaluated for ridge regression (default is 0.05 to 1 in increments of 0.05); and running different flavors of GLM models that omit HRF fitting, GLMdenoise, and/or ridge regression. For complete documentation, please refer to the GLMsingle function descriptions and example scripts available at <ext-link ext-link-type="uri" xlink:href="https://glmsingle.org/">glmsingle.org</ext-link>.</p></sec><sec id="s4-1-8"><title>Application of GLMsingle to NSD and BOLD5000</title><p>In order to assess the efficacy of GLMsingle for large-scale fMRI datasets, we tested GLMsingle on the NSD (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>) and BOLD5000 (<xref ref-type="bibr" rid="bib7">Chang et al., 2019</xref>) datasets. Both datasets involve presentation of many thousands of natural images. NSD and BOLD5000 share an overlapping subset of stimuli from the Microsoft Common Objects in Context (COCO) database (<xref ref-type="bibr" rid="bib37">Lin et al., 2014</xref>), enabling direct comparison between the brain responses observed in the two datasets. However, there are a number of differences between the datasets: they were collected at different field strengths, with different event timings, and at different spatial and temporal resolution. In addition, while NSD contains many repeated stimuli within each scan session, BOLD5000 contains very few. As such, processing BOLD5000 required grouping of input data across scan sessions to facilitate the cross-validation procedures used in GLMsingle. This challenging processing scheme with respect to image repetitions provides a strong test of the robustness of the GLMsingle technique.</p><sec id="s4-1-8-1"><title>NSD dataset</title><p>For complete details of the NSD study, including scanning parameters, stimulus presentation, and experimental setup, refer to the <italic>Methods</italic> section of the corresponding dataset paper (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>). In brief, a total of eight subjects participated in the NSD experiment, each completing between 30 and 40 functional scanning sessions. For the full experiment, 10,000 distinct images from the Microsoft COCO dataset were presented three times each over the course of 40 sessions. For computational convenience and to make comparisons across subjects easier, only the first 10 NSD sessions from subjects 1-4 were used for the analyses contained in this manuscript. Functional data were collected at 7T, with 1.8-mm isotropic resolution, and with a TR of 1.6 s. Each trial lasted 4 s, and consisted of the presentation of an image for 3 s, followed by a 1-s gap. A total of 12 NSD runs were collected in one session, containing either 62 or 63 stimulus trials each, for a total of 750 trials per session.</p><p>The fMRI data from NSD were pre-processed by performing one temporal resampling to correct for slice time differences and one spatial resampling to correct for head motion within and across scan sessions, EPI distortion, and gradient nonlinearities. This procedure yielded volumetric fMRI time-series data in subject-native space for each NSD subject. For the present study, we analyzed the standard-resolution pre-processed data from NSD which has 1.8-mm spatial resolution and 1.333-s temporal resolution (the time-series data are upsampled during pre-processing).</p></sec><sec id="s4-1-8-2"><title>BOLD5000 dataset</title><p>For complete details of the BOLD5000 study and methodology, refer to the corresponding dataset paper (<xref ref-type="bibr" rid="bib7">Chang et al., 2019</xref>). A total of four subjects participated in the BOLD5000 dataset (CSI1-4). A full dataset contained 15 functional scanning sessions; subject CSI4 completed only nine sessions before withdrawing from the study. BOLD5000 involved presentation of scene images from the Scene UNderstanding (SUN; <xref ref-type="bibr" rid="bib60">Xiao et al., 2010</xref>), COCO (<xref ref-type="bibr" rid="bib37">Lin et al., 2014</xref>), and ImageNet (<xref ref-type="bibr" rid="bib10">Deng et al., 2009</xref>) datasets. A total of 5254 images, of which 4916 images were unique, were used as the experimental stimuli. Of the 4916 distinct images, 112 were shown four times and one image was shown three times to each subject. Functional data were collected at 3T, with 2-mm isotropic resolution, and with a TR of 2 s. Each trial lasted 10 s, and consisted of the presentation of an image for 1 s, followed by a 9-s gap. A total of either 9 or 10 runs were collected in one session, containing 37 stimulus trials each, for a total of either 333 or 370 trials per session.</p><p>The fMRI data from BOLD5000 were pre-processed using fMRIPrep (<xref ref-type="bibr" rid="bib15">Esteban et al., 2019</xref>). Data pre-processing included motion correction, distortion correction, and co-registration to anatomy (for further details, please refer to the BOLD5000 dataset paper <xref ref-type="bibr" rid="bib7">Chang et al., 2019</xref>). This yielded volumetric fMRI time-series data in subject-native space for each BOLD5000 subject.</p><p>Because GLMsingle requires condition repetitions in order to perform internal cross-validation procedures, and because BOLD5000 contains a limited number of within-session repetitions, we concatenated data from groups of 5 sessions together before processing using GLMsingle. To account for differences in BOLD signal intensity across different sessions, we applied a global rescaling operation to the data within each session to roughly equate the time-series mean and variance across the five sessions comprising one batch of data. Specifically, we first computed the global mean fMRI volume across all five sessions, and then, for each session, computed a linear fit between the mean volume from a single session and the global mean volume. This yielded a multiplicative scaling factor to apply to each session in order to roughly equate signal intensities across sessions.</p></sec><sec id="s4-1-8-3"><title>Applying GLMsingle to NSD and BOLD5000</title><p>We used GLMsingle to estimate single-trial BOLD responses in the NSD and BOLD5000 datasets. For NSD, GLMsingle was applied independently to each scan session. For BOLD5000, groups of five sessions were processed together, following the rescaling procedure described above. The default GLMsingle parameters were used for processing both NSD and BOLD5000, except that we evaluated up to 12 nuisance regressors in GLMdenoise (default: 10).</p><p>Four different versions of single-trial GLM betas were computed and saved. The first beta version (<inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, AssumeHRF) is the result of Step 2 of the GLMsingle algorithm, and reflects the use of a canonical HRF with no extra optimizations. We treat these generic GLM outputs as a baseline against which beta versions are compared; estimating BOLD responses using a canonical HRF and ordinary least-squares (OLS) regression reflects an approach that has been commonly applied in the field of human neuroimaging. The second beta version (<inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, FitHRF) is the result of Step 3, and reflects the result of voxel-wise HRF estimation. The third beta version (<inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, FitHRF + GLMdenoise) is the result of Step 4, incorporating GLMdenoise, and the final beta version (<inline-formula><mml:math id="inf100"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, FitHRF + GLMdenoise + RR) arises from Step 5, and reflects the additional use of ridge regression. For comparisons between GLMsingle and Least-Squares Separate (LSS) signal estimation (<xref ref-type="fig" rid="fig3">Figure 3</xref>), four auxiliary beta versions were computed. LSS betas were compared to those estimated using fractional ridge regression in the scenario of using the canonical HRF (AssumeHRF + LSS vs. AssumeHRF + RR) and in the scenario of performing HRF optimization using the GLMsingle library (FitHRF + LSS vs. FitHRF + RR). Our validation analyses involved comparing optimized GLMsingle betas (<inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>) against those estimated using the baseline GLM approach (<inline-formula><mml:math id="inf104"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), and performing an eight-way comparison incorporating both <inline-formula><mml:math id="inf105"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf106"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> and the four auxiliary beta versions used for comparisons with LSS. Prior to all analyses, the responses of each voxel were <italic>z</italic>-scored within each experimental session in order to eliminate potential nonstationarities arising over time, and to equalize units across voxels.</p></sec><sec id="s4-1-8-4"><title>Applying GLMsingle to the StudyForrest music-listening dataset</title><p>As a further test of the general applicability of GLMsingle, we repeated the above procedures using data from the music-listening component of StudyForrest (<xref ref-type="bibr" rid="bib19">Hanke et al., 2015</xref>). This dataset measures brain responses as subjects listen to 25 total musical clips from 5 genres, with 8 repetitions per condition per subject. We analyzed the group of 16 subjects from this dataset for whom all functional data files were available within the online data repository. Each stimulus was a 6-s excerpt from the middle of a distinct musical piece, for each of five different musical genres: Ambient, Country, Heavy Metal, 50s Rock’n’Roll, and Symphonic. All trials had 4, 6, or 8 s of delay (no audio, white fixation cross) after each musical stimulus, with the order of delays randomized within a run. The 25 stimuli were identical across runs and presented exactly once per run. Each subject completed 1 session of the experiment, which consisted of 8 runs. BOLD data were distortion-corrected and anatomically aligned to a per-subject BOLD template image prior to analysis (see <xref ref-type="bibr" rid="bib19">Hanke et al., 2015</xref> for acquisition and pre-processing details). GLMsingle was applied to the data from each subject using default hyperparameter settings.</p></sec></sec></sec><sec id="s4-2"><title>Assessing the impact of GLMsingle</title><sec id="s4-2-1"><title>Analysis of optimal HRF indices</title><p>We sought to analyze the structure of HRF indices across visually-responsive cortex of a representative subject (NSD subj01). To identify voxels that were responsive to experimental stimuli, we examined the <inline-formula><mml:math id="inf107"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> output from the ON-OFF GLM that is computed in the course of deriving signal estimates for each session – this value reflects the variance explained in the observed BOLD time series by a single predictor containing all experimental events coded jointly. To derive a single metric of signal quality, we computed the session-averaged ON-OFF <inline-formula><mml:math id="inf108"><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value for all voxels within the nsdgeneral mask. These values are plotted across three different threshold levels in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1a</xref>. <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1b</xref> shows the optimal HRF indices derived from the first scan session from NSD subj01. To estimate the consistency of optimal HRF indices in this subject, we identified the group of nsdgeneral ROI voxels corresponding to each threshold level (rows, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>) and computed the Pearson correlation between the pattern of HRF indices identified for each of the 10 sessions that were analyzed (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1c</xref>).</p></sec><sec id="s4-2-2"><title>Computing voxel test-retest reliability</title><p>To compute reliability in NSD and BOLD5000, we repeated the following procedure for each beta version. We first extracted the betas from trials that correspond to repetitions of the same stimuli (NSD: 3 instances per stimulus; BOLD5000: 4 instances for subjects CSI1-3, and 3 for CSI4). For each voxel, this yielded a matrix of dimensions (repetitions x images). To compute reliability, Pearson correlation was computed between the average voxel response profiles for each possible unique split-half of the data. Therefore, in the case of 4 available repetitions, the reliability for a voxel was the average of 3 correlation values, with image repetitions grouped as follows: <italic>corr</italic>(<italic>mean</italic>(1,2) vs. <italic>mean</italic>(3,4)); <italic>corr</italic>(<italic>mean</italic>(1,3) vs. <italic>mean</italic>(2,4)); <italic>corr</italic>(<italic>mean</italic>(1,4) vs. <italic>mean</italic>(2,3)). In the case of three repetitions, the reliability was the average of: <italic>corr</italic>(<italic>mean</italic>(1,2) vs. (3)); <italic>corr</italic>(<italic>mean</italic>(1,3) vs. (2)). In the StudyForrest data, the reliability of response estimates in each voxel was computed using the following test-retest reliability procedure: the available repetitions (8) were divided into all possible unique split-halves (70 possibilities); for each split, the 25-valued response profiles for each group of 4 repetitions were averaged; the Pearson correlation between the response profiles from the two groups was computed; and correlation values were averaged across the 70 possible splits, yielding a single reliability value per voxel. Although Pearson correlation makes certain distributional assumptions, we suspect that the basic trends in our results would be unchanged were we to use other metrics for quantifying reliability (e.g. Spearman rank correlation).</p></sec><sec id="s4-2-3"><title>ROI analysis within visual cortex</title><p>To summarize reliability outcomes for each beta version, we used a liberal mask containing voxels in visual cortex. Specifically, we used the nsdgeneral ROI from the NSD study, which was manually drawn on fsaverage to cover voxels responsive to the NSD experiment in the posterior aspect of cortex (<xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>). To achieve a common reference ROI in volumetric space for each subject, we first transformed the nsdgeneral ROI to MNI space, and then mapped this ROI from MNI space to the space of each subject in NSD and each subject in BOLD5000.</p></sec><sec id="s4-2-4"><title>Composite voxel reliability scores</title><p>In comparing different beta versions output by GLMsingle, we sought to understand whether the optimizations tended to affect all voxels equally, or whether the impact was mediated by voxel reliability. We therefore measured how different beta versions differed in our key outcome metrics (e.g. mean voxel reliability) as a function of the reliability of included voxels. To achieve fair comparisons, we ensured that the same groups of voxels were compared at each reliability threshold across beta versions. We achieved this by computing composite voxel reliability scores: the mean reliability value in each voxel over beta versions <inline-formula><mml:math id="inf109"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>-<inline-formula><mml:math id="inf110"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>. We then subselected groups of voxels by applying varying threshold levels to the composite reliability scores. For analyses incorporating the 4 auxiliary beta versions, composite reliability scores were computed as the mean across all 8 beta versions.</p></sec><sec id="s4-2-5"><title>Beta version comparisons as a function of voxel reliability</title><p>To quantify the performance of different beta versions as a function of voxel reliability, composite scores were thresholded at increasing values (from Pearson  <inline-formula><mml:math id="inf111"><mml:mi>r</mml:mi></mml:math></inline-formula> = –0.2 to 0.6, in steps of 0.05) to determine the included voxels at each reliability level. At each threshold, we computed the difference between the reliability achieved by a given beta version and the composite reliability (i.e. the average across beta versions). This difference was averaged across voxels, producing traces that reflect the relative quality of data from each beta version compared to the group average, across different levels of voxel reliability (<xref ref-type="fig" rid="fig2">Figure 2b</xref>).</p></sec><sec id="s4-2-6"><title>Out-of-sample reliability analysis</title><p>GLMsingle makes use of all of the data that it is presented with, via a series of internal cross-validation operations. As such, there is some degree of dependence between runs. Note that this does not pose a significant “circularity” problem with respect to downstream analyses, as GLMsingle has no access to any scientific hypotheses and it is unlikely that GLMsingle could bias the single-trial beta estimates in favor of one hypothesis over another. However, when the primary analysis outcome is to establish that responses to the same condition are reliable across trials (e.g. <xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>), then that outcome is exactly what the GLMsingle algorithm is trying to achieve during hyperparameter selection. For a stringent quantification of reliability, we performed additional analyses in which quantification of reliability was restricted to responses estimated in completely independent calls to GLMsingle (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). Specifically, we identified all instances where a condition was repeated within the same partition of data processed by GLMsingle (partition size: 1 session for NSD, 5 sessions for BOLD5000), and removed these instances from the calculation of reliability. The results show that even with strict separation, the patterns of results are essentially the same.</p></sec><sec id="s4-2-7"><title>Comparison to LSS</title><p>Least-Squares Separate (LSS) is a popular technique for robust signal estimation in rapid event-related designs (<xref ref-type="bibr" rid="bib43">Mumford et al., 2012</xref>; <xref ref-type="bibr" rid="bib44">Mumford et al., 2014</xref>; <xref ref-type="bibr" rid="bib1">Abdulrahman and Henson, 2016</xref>). The LSS procedure fits a separate GLM for each stimulus, where the trial of interest is modeled as one regressor, and all other (non-target) trials are collapsed into a second regressor. An implementation of LSS is included in the GLMsingle toolbox.</p></sec><sec id="s4-2-8"><title>Analysis of reliability in StudyForrest</title><p><xref ref-type="fig" rid="fig4">Figure 4</xref> shows the results of analyses that seek to validate the efficacy of GLMsingle using data from the music-listening task in StudyForrest. We examine differences in the test-retest reliability (Pearson <inline-formula><mml:math id="inf112"><mml:mi>r</mml:mi></mml:math></inline-formula>) of active voxels between <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">4</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig4">Figure 4a</xref>. Active voxels are identified using a thresholding procedure applied to the ON-OFF <inline-formula><mml:math id="inf115"><mml:msup><mml:mi>R</mml:mi><mml:mn mathvariant="normal">2</mml:mn></mml:msup></mml:math></inline-formula> values, and only voxels that are active in response to experimental stimuli (ON-OFF <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) are plotted. To compute relative differences in mean reliability between beta versions <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> - <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>b</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">4</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4c–d</xref>), we used an identical procedure to that used for NSD and BOLD5000 (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). Traces in <xref ref-type="fig" rid="fig4">Figure 4c</xref> indicate the mean (+/- SEM) across the 16 available subjects, whose data are plotted individually in <xref ref-type="fig" rid="fig4">Figure 4d</xref>.</p></sec><sec id="s4-2-9"><title>Analysis of temporal autocorrelation</title><p>A commonly used strategy to increase fMRI statistical power is to increase the number of experimental trials by allowing them to be presented close together in time. However, given the sluggish nature of BOLD responses and the existence of temporal noise correlations, this strategy tends to yield correlations in GLM beta estimates for nearby trials (<xref ref-type="bibr" rid="bib44">Mumford et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Olszowy et al., 2019</xref>; <xref ref-type="bibr" rid="bib59">Woolrich et al., 2001</xref>; <xref ref-type="bibr" rid="bib34">Kumar and Feng, 2014</xref>). In general, we expect that such correlations are largely artifactual and unwanted. Given that GLMsingle attempts to reduce noise levels, we sought to explore whether GLMsingle has a noticeable impact on temporal autocorrelation.</p><p>For each beta version, the following procedure was used to assess the degree of temporal autocorrelation in the data. For visual cortex data from each experimental session (nsdgeneral ROI, <xref ref-type="bibr" rid="bib2">Allen et al., 2022</xref>), we computed the Pearson correlation between the spatial response patterns from each pair of trials in the session, yielding a representational similarity matrix (RSM) where the temporal ordering of trials is preserved. This process was repeated for all sessions, yielding a total of 10 RSMs for each NSD subject and 15 RSMs for each BOLD5000 subject (9 for subject CSI4, who did not complete the full study). To assess autocorrelation in the data – relationships arising due to temporal proximity of different trials – we then took the average of all RSMs within each dataset. Note that in both NSD and BOLD5000, the order of stimulus presentation was essentially unstructured (pseudorandom). Thus, in terms of signal content (stimulus-driven responses in the absence of noise), we expect that trials should be uncorrelated, on average, and that any non-zero correlations are indicative of the effects of noise that persist following GLM fitting. The extent to which non-zero <inline-formula><mml:math id="inf119"><mml:mi>r</mml:mi></mml:math></inline-formula> values extend forward in time from the RSM diagonal indicates the timescale of the noise effects in a given beta version.</p></sec><sec id="s4-2-10"><title>Computing the autocorrelation function</title><p>To quantify the degree of temporal autocorrelation, we computed a mean autocorrelation function using the dataset-averaged RSM for each beta version (<xref ref-type="fig" rid="fig5">Figure 5</xref>). For a given RSM, we computed the average similarity value between all trials <inline-formula><mml:math id="inf120"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf121"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf122"><mml:mi>x</mml:mi></mml:math></inline-formula> varies from 1 to <inline-formula><mml:math id="inf123"><mml:mi>n</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf124"><mml:mi>n</mml:mi></mml:math></inline-formula> is the dimensionality of the RSM. Intuitively, at <inline-formula><mml:math id="inf125"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf126"><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> equals the average of all values falling 1 index below the diagonal of the RSM; at <inline-formula><mml:math id="inf127"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, it equals the average of all values falling 5 indices below the diagonal, etc. This procedure outputs a succinct summary of the average correlation in neural response between all pairs of time-points within a session, allowing for easy comparison between the beta versions in a single plot (<xref ref-type="fig" rid="fig5">Figure 5</xref>, right-most column). The theoretical desired outcome is <inline-formula><mml:math id="inf128"><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; thus, beta versions whose autocorrelation functions are “flatter” (e.g. less area under the curve) presumably contain more accurate GLM estimates. Because the temporal interval between trials differed between NSD (4 s) and BOLD5000 (10 s), we express the autocorrelation functions in terms of seconds post-stimulus for plotting, to allow for straightforward comparison between the datasets.</p></sec><sec id="s4-2-11"><title>Effect of voxel reliability on temporal autocorrelation</title><p>The effect of temporal autocorrelation in GLM betas may vary depending on the relative responsiveness of different voxels to the experimental stimuli. As such, we repeated the autocorrelation analyses several times, varying the expanse of voxels that were included. We again relied on the aggregate reliability scores (computed previously) as a measure of voxel quality, which are the average voxel reliabilities taken across all the beta versions under consideration. This avoids biasing the voxel selection procedure. In <xref ref-type="fig" rid="fig5">Figure 5</xref>, we compare temporal autocorrelation trends arising from analysis of voxels at two different reliability thresholds (<inline-formula><mml:math id="inf129"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>).</p></sec><sec id="s4-2-12"><title>Analysis of between-subject representational similarity</title><p>Another way to assess the quality of beta estimates is to examine the similarity of BOLD response estimates across subjects. The underlying logic is that noise is expected to be stochastic in the data acquisition for each subject, and thus, should on average increase the dissimilarities of BOLD response estimates across subjects. A method that accurately removes noise would then be expected to increase the similarity of BOLD responses across subjects. To quantify response similarity, we use representational similarity analysis (RSA), a commonly used approach in systems and cognitive neuroscience (<xref ref-type="bibr" rid="bib31">Kriegeskorte et al., 2008</xref>; <xref ref-type="bibr" rid="bib47">Nili et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Diedrichsen and Kriegeskorte, 2017</xref>; <xref ref-type="bibr" rid="bib26">Kaniuth and Hebart, 2022</xref>).</p></sec><sec id="s4-2-13"><title>Analysis of image-level MVPA decoding accuracy</title><p>Multivoxel pattern analysis (MVPA) investigates the information contained in distributed patterns of neural activity to infer the functional role of brain areas and networks. Pattern decoding tools such as MVPA have been deployed extensively in systems and cognitive neuroscience to study the function of neural ROIs (<xref ref-type="bibr" rid="bib20">Haxby et al., 2001</xref>; <xref ref-type="bibr" rid="bib48">Norman et al., 2006</xref>; <xref ref-type="bibr" rid="bib45">Naselaris et al., 2011</xref>; <xref ref-type="bibr" rid="bib8">Charest et al., 2018</xref>). To further assess the practical impact of GLMsingle, we tested the efficacy of MVPA decoding using the different beta versions output by the toolbox.</p><p>We implemented a challenging “one-vs.-many” decoding task to assess whether data quality was sufficiently high to characterize the distinct neural patterns associated with individual naturalistic images in the NSD and BOLD5000 datasets. Within each dataset, we identified the set of images that all subjects viewed at least three times, and then performed multiclass linear support vector machine (SVM) decoding via leave-one-repetition-out cross-validation. In NSD, a total of 82 classes were used, representing the images that overlapped across the 10 available sessions from subj01-04. In BOLD5000, the subset of these 82 stimuli overlapping between all subjects of both datasets were used (a total of 20 classes). We then assessed the degree to which relative differences in decoding accuracy between <inline-formula><mml:math id="inf131"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> changed depending on the reliability of the included voxels. We conducted the above decoding procedure iteratively, each time increasing the voxel reliability inclusion threshold for data within the nsdgeneral ROI (range  <inline-formula><mml:math id="inf133"><mml:mi>r</mml:mi></mml:math></inline-formula> = 0 to 0.35). BOLD5000 subject CSI4, having completed only 9 of 15 experimental sessions, was excluded from MVPA procedures due to insufficient stimulus repetitions.</p></sec><sec id="s4-2-14"><title>Multidimensional scaling</title><p>To gain insight into the representational changes due to GLMsingle that may support improvements in MVPA decoding, we performed multidimensional scaling (MDS) over repetition-averaged NSD betas from a baseline GLM (<inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) and the final betas from GLMsingle (<inline-formula><mml:math id="inf135"><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>), within the nsdgeneral ROI of an example subject (NSD subj01). In <xref ref-type="fig" rid="fig7">Figure 7b</xref>, we compare the 2-dimensional MDS embeddings between these beta versions, coloring COCO stimuli based on whether they contain animate or inanimate objects according to the image annotations.</p></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Software, Validation, Methodology</p></fn><fn fn-type="con" id="con3"><p>Resources, Software, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Data curation, Supervision</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Data curation, Supervision, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Supervision, Funding acquisition, Validation, Investigation, Visualization, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>This paper uses previously published data from human subjects. For the Natural Scenes Dataset, informed written consent was obtained from all participants, and the experimental protocol was approved by the University of Minnesota institutional review board. For BOLD5000, participants all provided written informed consent and were financially compensated for their participation; all procedures followed the principles in the Declaration of Helsinki and were approved by the Institutional Review Board of Carnegie Mellon University. For the StudyForrest dataset, all data acquisitions were jointly approved by the ethics committee of the Otto-von-Guericke University of Magdeburg, Germany. Subjects were fully instructed about the nature of the study and provided informed consent beforehand.</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media xlink:href="elife-77599-transrepform1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The experimental data used in this paper are all previously published and available online at <ext-link ext-link-type="uri" xlink:href="https://naturalscenesdataset.org">https://naturalscenesdataset.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18112/openneuro.ds001499.v1.3.1">https://doi.org/10.18112/openneuro.ds001499.v1.3.1</ext-link>, and <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18112/openneuro.ds000113.v1.3.0">https://doi.org/10.18112/openneuro.ds000113.v1.3.0</ext-link>. The GLMsingle toolbox is available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/cvnlab/GLMsingle">https://github.com/cvnlab/GLMsingle</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:f557de105cb4d54dbac187d46c660a27f4f99a67;origin=https://github.com/cvnlab/GLMsingle;visit=swh:1:snp:43b3f6999b4b9c2a504c732edd32f171117d4eb5;anchor=swh:1:rev:3a1a580eae6bc7e221cbe01101be3c669687dc6a">swh:1:rev:3a1a580eae6bc7e221cbe01101be3c669687dc6a</ext-link>). Code used for the analyses demonstrated in this paper is publicly available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/jacob-prince/GLMsingle_paper">https://github.com/jacob-prince/GLMsingle_paper</ext-link>, (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:6120ef21524277971c73a90fd8bf5ffe5a6f9bc1;origin=https://github.com/jacob-prince/GLMsingle_paper;visit=swh:1:snp:d20620bba15ca59d668cb04faf2fd9f872999962;anchor=swh:1:rev:08cdd25e4fd96f545056e516ec1910ab749e1887">swh:1:rev:08cdd25e4fd96f545056e516ec1910ab749e1887</ext-link>). Source data files linked to the results plotted in Figures 2-7 and Figure 2—figure supplement 1 are available in an OSF repository at <ext-link ext-link-type="uri" xlink:href="https://osf.io/d4p98">https://osf.io/d4p98</ext-link>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>K</given-names></name><name><surname>Kurzawski</surname><given-names>J</given-names></name><name><surname>Charest</surname><given-names>I</given-names></name><name><surname>Prince</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>GLMsingle</data-title><source>Open Science Framework</source><pub-id pub-id-type="doi">10.17605/OSF.IO/D4P98</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Hanke</surname><given-names>M</given-names></name><name><surname>Baumgartner</surname><given-names>FJ</given-names></name><name><surname>Ibe</surname><given-names>P</given-names></name><name><surname>Kaule</surname><given-names>FR</given-names></name><name><surname>Pollmann</surname><given-names>S</given-names></name><name><surname>Speck</surname><given-names>O</given-names></name><name><surname>Zinke</surname><given-names>W</given-names></name><name><surname>Stadler</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Forrest Gump</data-title><source>OpenNeuro</source><pub-id pub-id-type="doi">10.18112/openneuro.ds000113.v1.3.0</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>N</given-names></name><name><surname>Pyles</surname><given-names>J</given-names></name><name><surname>Prince</surname><given-names>J</given-names></name><name><surname>Marcus</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Tarr</surname><given-names>M</given-names></name><name><surname>Aminoff</surname><given-names>E</given-names></name></person-group><source>OpenNeuro</source><pub-id pub-id-type="doi">10.18112/openneuro.ds001499.v1.3.1</pub-id><year iso-8601-date="2019">2019</year><data-title>BOLD5000</data-title></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>EJ</given-names></name><name><surname>St-Yves</surname><given-names>G</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Breedlove</surname><given-names>JL</given-names></name><name><surname>Prince</surname><given-names>JS</given-names></name><name><surname>Dowdle</surname><given-names>LT</given-names></name><name><surname>Nau</surname><given-names>M</given-names></name><name><surname>Caron</surname><given-names>B</given-names></name><name><surname>Pestilli</surname><given-names>F</given-names></name><name><surname>Charest</surname><given-names>I</given-names></name><name><surname>Hutchinson</surname><given-names>JB</given-names></name><name><surname>Naselaris</surname><given-names>T</given-names></name><name><surname>Kay</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Natural Scenes Dataset</data-title><source>University of Minnesota</source><pub-id pub-id-type="accession" xlink:href="https://naturalscenesdataset.org/">naturalscenesdataset</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>Collection of the NSD dataset was supported by NSF CRCNS grants IIS-1822683 (to KK) and IIS-1822929 (to Thomas Naselaris). We thank N Blauch, A Wang, E Aminoff, and R River for helpful discussions. We thank R Gau for help with the online GLMsingle code repository.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abdulrahman</surname><given-names>H</given-names></name><name><surname>Henson</surname><given-names>RN</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Effect of trial-to-trial variability on optimal event-related fmri design: implications for beta-series correlation and multi-voxel pattern analysis</article-title><source>NeuroImage</source><volume>125</volume><fpage>756</fpage><lpage>766</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.11.009</pub-id><pub-id pub-id-type="pmid">26549299</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allen</surname><given-names>EJ</given-names></name><name><surname>St-Yves</surname><given-names>G</given-names></name><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Breedlove</surname><given-names>JL</given-names></name><name><surname>Prince</surname><given-names>JS</given-names></name><name><surname>Dowdle</surname><given-names>LT</given-names></name><name><surname>Nau</surname><given-names>M</given-names></name><name><surname>Caron</surname><given-names>B</given-names></name><name><surname>Pestilli</surname><given-names>F</given-names></name><name><surname>Charest</surname><given-names>I</given-names></name><name><surname>Hutchinson</surname><given-names>JB</given-names></name><name><surname>Naselaris</surname><given-names>T</given-names></name><name><surname>Kay</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A massive 7T fMRI dataset to bridge cognitive neuroscience and artificial intelligence</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>116</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00962-x</pub-id><pub-id pub-id-type="pmid">34916659</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>B</given-names></name><name><surname>Kantor</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A shape-based finite impulse response model for functional brain images</article-title><conf-name>2007 4th IEEE International Symposium on Biomedical Imaging: From Nano to Macro</conf-name><fpage>440</fpage><lpage>443</lpage><pub-id pub-id-type="doi">10.1109/ISBI.2007.356883</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bao</surname><given-names>P</given-names></name><name><surname>She</surname><given-names>L</given-names></name><name><surname>McGill</surname><given-names>M</given-names></name><name><surname>Tsao</surname><given-names>DY</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A map of object space in primate inferotemporal cortex</article-title><source>Nature</source><volume>583</volume><fpage>103</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2350-5</pub-id><pub-id pub-id-type="pmid">32494012</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blauch</surname><given-names>NM</given-names></name><name><surname>Behrmann</surname><given-names>M</given-names></name><name><surname>Plaut</surname><given-names>DC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A connectivity-constrained computational account of topographic organization in primate high-level visual cortex</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2112566119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2112566119</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Borg</surname><given-names>I</given-names></name><name><surname>Groenen</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Modern Multidimensional Scaling: Theory and Applications</source><publisher-name>Springer Science &amp; Business Media</publisher-name><pub-id pub-id-type="doi">10.18637/jss.v014.b04</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>N</given-names></name><name><surname>Pyles</surname><given-names>JA</given-names></name><name><surname>Marcus</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>A</given-names></name><name><surname>Tarr</surname><given-names>MJ</given-names></name><name><surname>Aminoff</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>BOLD5000, a public fmri dataset while viewing 5000 visual images</article-title><source>Scientific Data</source><volume>6</volume><elocation-id>49</elocation-id><pub-id pub-id-type="doi">10.1038/s41597-019-0052-3</pub-id><pub-id pub-id-type="pmid">31061383</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Charest</surname><given-names>I</given-names></name><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Kay</surname><given-names>KN</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>GLMdenoise improves multivariate pattern analysis of fMRI data</article-title><source>NeuroImage</source><volume>183</volume><fpage>606</fpage><lpage>616</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.08.064</pub-id><pub-id pub-id-type="pmid">30170148</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dale</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Optimal experimental design for event-related fmri</article-title><source>Human Brain Mapping</source><volume>8</volume><fpage>109</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0193(1999)8:2/3</pub-id><pub-id pub-id-type="pmid">10524601</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Dong</surname><given-names>W</given-names></name><name><surname>Socher</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>LJ</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Fei-Fei</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Imagenet: A large-scale hierarchical image database</article-title><conf-name>2009 IEEE conference on computer vision and pattern recognition</conf-name><fpage>248</fpage><lpage>255</lpage><pub-id pub-id-type="doi">10.1109/CVPR.2009.5206848</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DiCarlo</surname><given-names>JJ</given-names></name><name><surname>Zoccolan</surname><given-names>D</given-names></name><name><surname>Rust</surname><given-names>NC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>How does the brain solve visual object recognition?</article-title><source>Neuron</source><volume>73</volume><fpage>415</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.01.010</pub-id><pub-id pub-id-type="pmid">22325196</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diedrichsen</surname><given-names>J</given-names></name><name><surname>Kriegeskorte</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Representational models: a common framework for understanding encoding, pattern-component, and representational-similarity analysis</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005508</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005508</pub-id><pub-id pub-id-type="pmid">28437426</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D’Isanto</surname><given-names>A</given-names></name><name><surname>Polsterer</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Photometric redshift estimation via deep learning-generalized and pre-classification-less, image based, fully probabilistic redshifts</article-title><source>Astronomy &amp; Astrophysics</source><volume>609</volume><elocation-id>A111</elocation-id><pub-id pub-id-type="doi">10.1051/0004-6361/201731326</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doshi</surname><given-names>F</given-names></name><name><surname>Konkle</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Organizational motifs of cortical responses to objects emerge in topographic projections of deep neural networks</article-title><source>Journal of Vision</source><volume>21</volume><elocation-id>2226</elocation-id><pub-id pub-id-type="doi">10.1167/jov.21.9.2226</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Esteban</surname><given-names>O</given-names></name><name><surname>Markiewicz</surname><given-names>CJ</given-names></name><name><surname>Blair</surname><given-names>RW</given-names></name><name><surname>Moodie</surname><given-names>CA</given-names></name><name><surname>Isik</surname><given-names>AI</given-names></name><name><surname>Erramuzpe</surname><given-names>A</given-names></name><name><surname>Kent</surname><given-names>JD</given-names></name><name><surname>Goncalves</surname><given-names>M</given-names></name><name><surname>DuPre</surname><given-names>E</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><name><surname>Oya</surname><given-names>H</given-names></name><name><surname>Ghosh</surname><given-names>SS</given-names></name><name><surname>Wright</surname><given-names>J</given-names></name><name><surname>Durnez</surname><given-names>J</given-names></name><name><surname>Poldrack</surname><given-names>RA</given-names></name><name><surname>Gorgolewski</surname><given-names>KJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>FMRIPrep: a robust preprocessing pipeline for functional MRI</article-title><source>Nature Methods</source><volume>16</volume><fpage>111</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1038/s41592-018-0235-4</pub-id><pub-id pub-id-type="pmid">30532080</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Freeman</surname><given-names>J</given-names></name><name><surname>Ziemba</surname><given-names>CM</given-names></name><name><surname>Heeger</surname><given-names>DJ</given-names></name><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Movshon</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A functional and perceptual signature of the second visual area in primates</article-title><source>Nature Neuroscience</source><volume>16</volume><fpage>974</fpage><lpage>981</lpage><pub-id pub-id-type="doi">10.1038/nn.3402</pub-id><pub-id pub-id-type="pmid">23685719</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handwerker</surname><given-names>DA</given-names></name><name><surname>Ollinger</surname><given-names>JM</given-names></name><name><surname>D’Esposito</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Variation of BOLD hemodynamic responses across subjects and brain regions and their effects on statistical analyses</article-title><source>NeuroImage</source><volume>21</volume><fpage>1639</fpage><lpage>1651</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2003.11.029</pub-id><pub-id pub-id-type="pmid">15050587</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handwerker</surname><given-names>DA</given-names></name><name><surname>Gonzalez-Castillo</surname><given-names>J</given-names></name><name><surname>D’Esposito</surname><given-names>M</given-names></name><name><surname>Bandettini</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The continuing challenge of understanding and modeling hemodynamic variation in fMRI</article-title><source>NeuroImage</source><volume>62</volume><fpage>1017</fpage><lpage>1023</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.02.015</pub-id><pub-id pub-id-type="pmid">22366081</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hanke</surname><given-names>M</given-names></name><name><surname>Dinga</surname><given-names>R</given-names></name><name><surname>Häusler</surname><given-names>C</given-names></name><name><surname>Guntupalli</surname><given-names>JS</given-names></name><name><surname>Casey</surname><given-names>M</given-names></name><name><surname>Kaule</surname><given-names>FR</given-names></name><name><surname>Stadler</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>High-resolution 7-tesla fmri data on the perception of musical genres – an extension to the studyforrest dataset</article-title><source>F1000Research</source><volume>4</volume><elocation-id>174</elocation-id><pub-id pub-id-type="doi">10.12688/f1000research.6679.1</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haxby</surname><given-names>JV</given-names></name><name><surname>Gobbini</surname><given-names>MI</given-names></name><name><surname>Furey</surname><given-names>ML</given-names></name><name><surname>Ishai</surname><given-names>A</given-names></name><name><surname>Schouten</surname><given-names>JL</given-names></name><name><surname>Pietrini</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Distributed and overlapping representations of faces and objects in ventral temporal cortex</article-title><source>Science</source><volume>293</volume><fpage>2425</fpage><lpage>2430</lpage><pub-id pub-id-type="doi">10.1126/science.1063736</pub-id><pub-id pub-id-type="pmid">11577229</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hebart</surname><given-names>MN</given-names></name><name><surname>Dickter</surname><given-names>AH</given-names></name><name><surname>Kidder</surname><given-names>A</given-names></name><name><surname>Kwok</surname><given-names>WY</given-names></name><name><surname>Corriveau</surname><given-names>A</given-names></name><name><surname>Van Wicklin</surname><given-names>C</given-names></name><name><surname>Baker</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Things: a database of 1,854 object concepts and more than 26,000 naturalistic object images</article-title><source>PLOS ONE</source><volume>14</volume><elocation-id>e0223792</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0223792</pub-id><pub-id pub-id-type="pmid">31613926</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoerl</surname><given-names>AE</given-names></name><name><surname>Kennard</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Ridge regression: biased estimation for nonorthogonal problems</article-title><source>Technometrics</source><volume>12</volume><fpage>55</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1080/00401706.1970.10488634</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horikawa</surname><given-names>T</given-names></name><name><surname>Kamitani</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Generic decoding of seen and imagined objects using hierarchical visual features</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15037</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15037</pub-id><pub-id pub-id-type="pmid">28530228</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iten</surname><given-names>R</given-names></name><name><surname>Metger</surname><given-names>T</given-names></name><name><surname>Wilming</surname><given-names>H</given-names></name><name><surname>Del Rio</surname><given-names>L</given-names></name><name><surname>Renner</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Discovering physical concepts with neural networks</article-title><source>Physical Review Letters</source><volume>124</volume><elocation-id>010508</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.124.010508</pub-id><pub-id pub-id-type="pmid">31976717</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jumper</surname><given-names>J</given-names></name><name><surname>Evans</surname><given-names>R</given-names></name><name><surname>Pritzel</surname><given-names>A</given-names></name><name><surname>Green</surname><given-names>T</given-names></name><name><surname>Figurnov</surname><given-names>M</given-names></name><name><surname>Ronneberger</surname><given-names>O</given-names></name><name><surname>Tunyasuvunakool</surname><given-names>K</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Žídek</surname><given-names>A</given-names></name><name><surname>Potapenko</surname><given-names>A</given-names></name><name><surname>Bridgland</surname><given-names>A</given-names></name><name><surname>Meyer</surname><given-names>C</given-names></name><name><surname>Kohl</surname><given-names>SAA</given-names></name><name><surname>Ballard</surname><given-names>AJ</given-names></name><name><surname>Cowie</surname><given-names>A</given-names></name><name><surname>Romera-Paredes</surname><given-names>B</given-names></name><name><surname>Nikolov</surname><given-names>S</given-names></name><name><surname>Jain</surname><given-names>R</given-names></name><name><surname>Adler</surname><given-names>J</given-names></name><name><surname>Back</surname><given-names>T</given-names></name><name><surname>Petersen</surname><given-names>S</given-names></name><name><surname>Reiman</surname><given-names>D</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Zielinski</surname><given-names>M</given-names></name><name><surname>Steinegger</surname><given-names>M</given-names></name><name><surname>Pacholska</surname><given-names>M</given-names></name><name><surname>Berghammer</surname><given-names>T</given-names></name><name><surname>Bodenstein</surname><given-names>S</given-names></name><name><surname>Silver</surname><given-names>D</given-names></name><name><surname>Vinyals</surname><given-names>O</given-names></name><name><surname>Senior</surname><given-names>AW</given-names></name><name><surname>Kavukcuoglu</surname><given-names>K</given-names></name><name><surname>Kohli</surname><given-names>P</given-names></name><name><surname>Hassabis</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Highly accurate protein structure prediction with alphafold</article-title><source>Nature</source><volume>596</volume><fpage>583</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><pub-id pub-id-type="pmid">34265844</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaniuth</surname><given-names>P</given-names></name><name><surname>Hebart</surname><given-names>MN</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Feature-reweighted representational similarity analysis: A method for improving the fit between computational models, brains, and behavior</article-title><source>NeuroImage</source><volume>257</volume><elocation-id>119294</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2022.119294</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>KN</given-names></name><name><surname>David</surname><given-names>SV</given-names></name><name><surname>Prenger</surname><given-names>RJ</given-names></name><name><surname>Hansen</surname><given-names>KA</given-names></name><name><surname>Gallant</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2008">2008</year><source>Modeling low-frequency fluctuation and hemodynamic response timecourse in event-related fmri Technical report</source><publisher-name>Wiley Online Library</publisher-name></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>KN</given-names></name><name><surname>Rokem</surname><given-names>A</given-names></name><name><surname>Winawer</surname><given-names>J</given-names></name><name><surname>Dougherty</surname><given-names>RF</given-names></name><name><surname>Wandell</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>GLMdenoise: a fast, automated technique for denoising task-based fmri data</article-title><source>Frontiers in Neuroscience</source><volume>7</volume><elocation-id>247</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2013.00247</pub-id><pub-id pub-id-type="pmid">24381539</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>K</given-names></name><name><surname>Jamison</surname><given-names>KW</given-names></name><name><surname>Zhang</surname><given-names>RY</given-names></name><name><surname>Uğurbil</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A temporal decomposition method for identifying venous effects in task-based fMRI</article-title><source>Nature Methods</source><volume>17</volume><fpage>1033</fpage><lpage>1039</lpage><pub-id pub-id-type="doi">10.1038/s41592-020-0941-6</pub-id><pub-id pub-id-type="pmid">32895538</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kay</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The risk of bias in denoising methods: examples from neuroimaging</article-title><source>PLOS ONE</source><volume>17</volume><elocation-id>e0270895</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0270895</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Mur</surname><given-names>M</given-names></name><name><surname>Bandettini</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Representational similarity analysis-connecting the branches of systems neuroscience</article-title><source>Frontiers in Systems Neuroscience</source><volume>2</volume><elocation-id>4</elocation-id><pub-id pub-id-type="doi">10.3389/neuro.06.004.2008</pub-id><pub-id pub-id-type="pmid">19104670</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Deep neural networks: a new framework for modeling biological vision and brain information processing</article-title><source>Annual Review of Vision Science</source><volume>1</volume><fpage>417</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-082114-035447</pub-id><pub-id pub-id-type="pmid">28532370</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Wei</surname><given-names>XX</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Neural tuning and representational geometry</article-title><source>Nature Reviews Neuroscience</source><volume>22</volume><fpage>703</fpage><lpage>718</lpage><pub-id pub-id-type="doi">10.1038/s41583-021-00502-3</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kumar</surname><given-names>A</given-names></name><name><surname>Feng</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Efficient regularization of temporal autocorrelation estimates in fmri data</article-title><conf-name>In The 15th International Conference on Biomedical Engineering</conf-name><fpage>88</fpage><lpage>91</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>H</given-names></name><name><surname>Margalit</surname><given-names>E</given-names></name><name><surname>Jozwik</surname><given-names>KM</given-names></name><name><surname>Cohen</surname><given-names>MA</given-names></name><name><surname>Kanwisher</surname><given-names>N</given-names></name><name><surname>Yamins</surname><given-names>DL</given-names></name><name><surname>DiCarlo</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Topographic Deep Artificial Neural Networks Reproduce the Hallmarks of the Primate Inferior Temporal Cortex Face Processing Network</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.07.09.185116</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>DSP</given-names></name><name><surname>Bonner</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Emergent Selectivity for Scenes, Object Properties, and Contour Statistics in Feedforward Models of Scene-Preferring Cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.09.24.461733</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>TY</given-names></name><name><surname>Maire</surname><given-names>M</given-names></name><name><surname>Belongie</surname><given-names>S</given-names></name><name><surname>Hays</surname><given-names>J</given-names></name><name><surname>Perona</surname><given-names>P</given-names></name><name><surname>Ramanan</surname><given-names>D</given-names></name><name><surname>Dollár</surname><given-names>P</given-names></name><name><surname>Zitnick</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Microsoft coco: Common objects in context</article-title><conf-name>In European conference on computer vision</conf-name><fpage>740</fpage><lpage>755</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>TT</given-names></name><name><surname>Frank</surname><given-names>LR</given-names></name><name><surname>Wong</surname><given-names>EC</given-names></name><name><surname>Buxton</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Detection power, estimation efficiency, and predictability in event-related fMRI</article-title><source>NeuroImage</source><volume>13</volume><fpage>759</fpage><lpage>773</lpage><pub-id pub-id-type="doi">10.1006/nimg.2000.0728</pub-id><pub-id pub-id-type="pmid">11305903</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>TT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Noise contributions to the fMRI signal: an overview</article-title><source>NeuroImage</source><volume>143</volume><fpage>141</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.09.008</pub-id><pub-id pub-id-type="pmid">27612646</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>B</given-names></name><name><surname>Yu</surname><given-names>CP</given-names></name><name><surname>Konkle</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Mid-level visual features underlie the high-level categorical organization of the ventral stream</article-title><source>PNAS</source><volume>115</volume><fpage>E9015</fpage><lpage>E9024</lpage><pub-id pub-id-type="doi">10.1073/pnas.1719616115</pub-id><pub-id pub-id-type="pmid">30171168</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Marques</surname><given-names>T</given-names></name><name><surname>Schrimpf</surname><given-names>M</given-names></name><name><surname>DiCarlo</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Multi-Scale Hierarchical Neural Network Models That Bridge from Single Neurons in the Primate Primary Visual Cortex to Object Recognition Behavior</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.03.01.433495</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monti</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Statistical analysis of fMRI time-series: a critical review of the GLM approach</article-title><source>Frontiers in Human Neuroscience</source><volume>5</volume><elocation-id>28</elocation-id><pub-id pub-id-type="doi">10.3389/fnhum.2011.00028</pub-id><pub-id pub-id-type="pmid">21442013</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mumford</surname><given-names>JA</given-names></name><name><surname>Turner</surname><given-names>BO</given-names></name><name><surname>Ashby</surname><given-names>FG</given-names></name><name><surname>Poldrack</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Deconvolving BOLD activation in event-related designs for multivoxel pattern classification analyses</article-title><source>NeuroImage</source><volume>59</volume><fpage>2636</fpage><lpage>2643</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.08.076</pub-id><pub-id pub-id-type="pmid">21924359</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mumford</surname><given-names>JA</given-names></name><name><surname>Davis</surname><given-names>T</given-names></name><name><surname>Poldrack</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The impact of study design on pattern estimation for single-trial multivariate pattern analysis</article-title><source>NeuroImage</source><volume>103</volume><fpage>130</fpage><lpage>138</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2014.09.026</pub-id><pub-id pub-id-type="pmid">25241907</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naselaris</surname><given-names>T</given-names></name><name><surname>Kay</surname><given-names>KN</given-names></name><name><surname>Nishimoto</surname><given-names>S</given-names></name><name><surname>Gallant</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Encoding and decoding in fMRI</article-title><source>NeuroImage</source><volume>56</volume><fpage>400</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1016/j.neuroimage.2010.07.073</pub-id><pub-id pub-id-type="pmid">20691790</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Naselaris</surname><given-names>T</given-names></name><name><surname>Allen</surname><given-names>E</given-names></name><name><surname>Kay</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Extensive sampling for complete models of individual brains</article-title><source>Current Opinion in Behavioral Sciences</source><volume>40</volume><fpage>45</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1016/j.cobeha.2020.12.008</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nili</surname><given-names>H</given-names></name><name><surname>Wingfield</surname><given-names>C</given-names></name><name><surname>Walther</surname><given-names>A</given-names></name><name><surname>Su</surname><given-names>L</given-names></name><name><surname>Marslen-Wilson</surname><given-names>W</given-names></name><name><surname>Kriegeskorte</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A toolbox for representational similarity analysis</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003553</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003553</pub-id><pub-id pub-id-type="pmid">24743308</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Norman</surname><given-names>KA</given-names></name><name><surname>Polyn</surname><given-names>SM</given-names></name><name><surname>Detre</surname><given-names>GJ</given-names></name><name><surname>Haxby</surname><given-names>JV</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Beyond mind-reading: multi-voxel pattern analysis of fMRI data</article-title><source>Trends in Cognitive Sciences</source><volume>10</volume><fpage>424</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1016/j.tics.2006.07.005</pub-id><pub-id pub-id-type="pmid">16899397</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olszowy</surname><given-names>W</given-names></name><name><surname>Aston</surname><given-names>J</given-names></name><name><surname>Rua</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>GB</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Accurate autocorrelation modeling substantially improves fMRI reliability</article-title><source>Nature Communications</source><volume>10</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-09230-w</pub-id><pub-id pub-id-type="pmid">30899012</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Poldrack</surname><given-names>RA</given-names></name><name><surname>Mumford</surname><given-names>JA</given-names></name><name><surname>Nichols</surname><given-names>TE</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Handbook of Functional MRI Data Analysis</source><publisher-name>Cambridge University Press</publisher-name><pub-id pub-id-type="doi">10.1017/CBO9780511895029</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Popham</surname><given-names>SF</given-names></name><name><surname>Huth</surname><given-names>AG</given-names></name><name><surname>Bilenko</surname><given-names>NY</given-names></name><name><surname>Deniz</surname><given-names>F</given-names></name><name><surname>Gao</surname><given-names>JS</given-names></name><name><surname>Nunez-Elizalde</surname><given-names>AO</given-names></name><name><surname>Gallant</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Visual and linguistic semantic representations are aligned at the border of human visual cortex</article-title><source>Nature Neuroscience</source><volume>24</volume><fpage>1628</fpage><lpage>1636</lpage><pub-id pub-id-type="doi">10.1038/s41593-021-00921-6</pub-id><pub-id pub-id-type="pmid">34711960</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravuri</surname><given-names>S</given-names></name><name><surname>Lenc</surname><given-names>K</given-names></name><name><surname>Willson</surname><given-names>M</given-names></name><name><surname>Kangin</surname><given-names>D</given-names></name><name><surname>Lam</surname><given-names>R</given-names></name><name><surname>Mirowski</surname><given-names>P</given-names></name><name><surname>Fitzsimons</surname><given-names>M</given-names></name><name><surname>Athanassiadou</surname><given-names>M</given-names></name><name><surname>Kashem</surname><given-names>S</given-names></name><name><surname>Madge</surname><given-names>S</given-names></name><name><surname>Prudden</surname><given-names>R</given-names></name><name><surname>Mandhane</surname><given-names>A</given-names></name><name><surname>Clark</surname><given-names>A</given-names></name><name><surname>Brock</surname><given-names>A</given-names></name><name><surname>Simonyan</surname><given-names>K</given-names></name><name><surname>Hadsell</surname><given-names>R</given-names></name><name><surname>Robinson</surname><given-names>N</given-names></name><name><surname>Clancy</surname><given-names>E</given-names></name><name><surname>Arribas</surname><given-names>A</given-names></name><name><surname>Mohamed</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Skilful precipitation nowcasting using deep generative models of radar</article-title><source>Nature</source><volume>597</volume><fpage>672</fpage><lpage>677</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-03854-z</pub-id><pub-id pub-id-type="pmid">34588668</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richards</surname><given-names>BA</given-names></name><name><surname>Lillicrap</surname><given-names>TP</given-names></name><name><surname>Beaudoin</surname><given-names>P</given-names></name><name><surname>Bengio</surname><given-names>Y</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name><name><surname>Christensen</surname><given-names>A</given-names></name><name><surname>Clopath</surname><given-names>C</given-names></name><name><surname>Costa</surname><given-names>RP</given-names></name><name><surname>de Berker</surname><given-names>A</given-names></name><name><surname>Ganguli</surname><given-names>S</given-names></name><name><surname>Gillon</surname><given-names>CJ</given-names></name><name><surname>Hafner</surname><given-names>D</given-names></name><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Latham</surname><given-names>P</given-names></name><name><surname>Lindsay</surname><given-names>GW</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name><name><surname>Naud</surname><given-names>R</given-names></name><name><surname>Pack</surname><given-names>CC</given-names></name><name><surname>Poirazi</surname><given-names>P</given-names></name><name><surname>Roelfsema</surname><given-names>P</given-names></name><name><surname>Sacramento</surname><given-names>J</given-names></name><name><surname>Saxe</surname><given-names>A</given-names></name><name><surname>Scellier</surname><given-names>B</given-names></name><name><surname>Schapiro</surname><given-names>AC</given-names></name><name><surname>Senn</surname><given-names>W</given-names></name><name><surname>Wayne</surname><given-names>G</given-names></name><name><surname>Yamins</surname><given-names>D</given-names></name><name><surname>Zenke</surname><given-names>F</given-names></name><name><surname>Zylberberg</surname><given-names>J</given-names></name><name><surname>Therien</surname><given-names>D</given-names></name><name><surname>Kording</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A deep learning framework for neuroscience</article-title><source>Nature Neuroscience</source><volume>22</volume><fpage>1761</fpage><lpage>1770</lpage><pub-id pub-id-type="doi">10.1038/s41593-019-0520-2</pub-id><pub-id pub-id-type="pmid">31659335</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rokem</surname><given-names>A</given-names></name><name><surname>Kay</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Fractional ridge regression: a fast, interpretable reparameterization of ridge regression</article-title><source>GigaScience</source><volume>9</volume><elocation-id>giaa133</elocation-id><pub-id pub-id-type="doi">10.1093/gigascience/giaa133</pub-id><pub-id pub-id-type="pmid">33252656</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schawinski</surname><given-names>K</given-names></name><name><surname>Turp</surname><given-names>MD</given-names></name><name><surname>Zhang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Exploring galaxy evolution with generative models</article-title><source>Astronomy &amp; Astrophysics</source><volume>616</volume><elocation-id>L16</elocation-id><pub-id pub-id-type="doi">10.1051/0004-6361/201833800</pub-id><pub-id pub-id-type="pmid">30405225</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Serre</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Deep learning: the good, the bad, and the ugly</article-title><source>Annual Review of Vision Science</source><volume>5</volume><fpage>399</fpage><lpage>426</lpage><pub-id pub-id-type="doi">10.1146/annurev-vision-091718-014951</pub-id><pub-id pub-id-type="pmid">31394043</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soch</surname><given-names>J</given-names></name><name><surname>Allefeld</surname><given-names>C</given-names></name><name><surname>Haynes</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Inverse transformed encoding models-a solution to the problem of correlated trial-by-trial parameter estimates in fmri decoding</article-title><source>NeuroImage</source><volume>209</volume><elocation-id>116449</elocation-id><pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.116449</pub-id><pub-id pub-id-type="pmid">31866165</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>What is smart HDRhdr? explaining Aapple’s new camera tech | trusted reviews</article-title><ext-link ext-link-type="uri" xlink:href="https://www.trustedreviews.com/news/what-is-smart-hdr-3565603">https://www.trustedreviews.com/news/what-is-smart-hdr-3565603</ext-link><date-in-citation iso-8601-date="2021-03-30">March 30, 2021</date-in-citation></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woolrich</surname><given-names>MW</given-names></name><name><surname>Ripley</surname><given-names>BD</given-names></name><name><surname>Brady</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Temporal autocorrelation in univariate linear modeling of fMRI data</article-title><source>NeuroImage</source><volume>14</volume><fpage>1370</fpage><lpage>1386</lpage><pub-id pub-id-type="doi">10.1006/nimg.2001.0931</pub-id><pub-id pub-id-type="pmid">11707093</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Xiao</surname><given-names>J</given-names></name><name><surname>Hays</surname><given-names>J</given-names></name><name><surname>Ehinger</surname><given-names>KA</given-names></name><name><surname>Oliva</surname><given-names>A</given-names></name><name><surname>Torralba</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>SUNSun database: Large-scale scene recognition from abbey to zoo</article-title><conf-name>IEEE computer society conference on computer vision and pattern recognition</conf-name><pub-id pub-id-type="doi">10.1109/CVPR.2010.5539970</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yamins</surname><given-names>DLK</given-names></name><name><surname>Hong</surname><given-names>H</given-names></name><name><surname>Cadieu</surname><given-names>CF</given-names></name><name><surname>Solomon</surname><given-names>EA</given-names></name><name><surname>Seibert</surname><given-names>D</given-names></name><name><surname>DiCarlo</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Performance-optimized hierarchical models predict neural responses in higher visual cortex</article-title><source>PNAS</source><volume>111</volume><fpage>8619</fpage><lpage>8624</lpage><pub-id pub-id-type="doi">10.1073/pnas.1403112111</pub-id><pub-id pub-id-type="pmid">24812127</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>K</given-names></name><name><surname>Bao</surname><given-names>P</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Principles Governing the Topological Organization of Object Selectivities in Ventral Temporal Cortex</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.09.15.460220</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77599.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kok</surname><given-names>Peter</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.01.31.478431" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.01.31.478431"/></front-stub><body><p>This important work provides the field of human neuroimaging with a new method to estimate single-trial fMRI responses. The authors provide compelling evidence that their GLMsingle method goes beyond the current state of the art and leads to more reliable estimates. Therefore, this tool will be of interest to researchers using human neuroimaging to study neural responses in condition-rich designs, as is increasingly common in cognitive neuroscience experiments.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77599.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Kok</surname><given-names>Peter</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Kok</surname><given-names>Peter</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>University College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Turner</surname><given-names>Benjamin</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02e7b5302</institution-id><institution>Nanyang Technological University</institution></institution-wrap><country>Singapore</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.01.31.478431">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.01.31.478431v1">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;GLMsingle: a toolbox for improving single-trial fMRI response estimates&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Peter Kok as Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Floris de Lange as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Benjamin Turner (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Including more practical guidelines on implementation would strengthen the manuscript and ease the implementation for users. This especially pertains to the features the user needs to flag when running the toolbox (HRF estimation, noise regressors, ridge regression). The specific implementation is left up to the users and the authors mention that this should depend on one's experimental goals, but do not provide more concrete guidelines. From the manuscript it seems that including all of the features works best, but this is based on two condition-rich experiments that may differ a lot from a user's dataset. Therefore it would be useful to walk the user through potential considerations for each of those features, or consider the most common uses of the toolbox (e.g. condition-rich designs, repetition-suppression studies, looking at within-session learning effects etc.).</p><p>2) There are some examples where the authors provide guidelines, but this could be strengthened. For instance, they discuss that the use of ridge regression could bias temporally adjacent trials to be more similar in magnitude – so they caution against using this feature for studies specifically interested in the relative responses of neighbouring trials (e.g. looking into preparation-execution in motor studies, repetition suppression-type of designs, etc.). But from Figure 4 there seems an advantage when including ridge regression in addition to denoising and fitting HRF, leading to a further reduction of the temporal autocorrelation between nearby trials. So, a reader might take-away that this is the least biased estimate of neighbouring trials. But mightn't it also destroy 'real' (neural) autocorrelation between trials, due to e.g. stimulus-specific adaptation and serial dependence? What exactly would the authors suggest then for designs where estimation of subsequent trials (e.g. repetition suppression or serial dependence) is of primary interest?</p><p>3) The authors use cross validation to determine the number of nuisance regressors to add in the model. Thus, any variability in responses to a single condition is considered to be 'noise'. How might this influence a potential use of single-trial estimates to assess brain-behaviour correlations (e.g., differences in behavioural responses to a single condition), or within-session learning conditions? For such uses, would the authors suggest instead using LSS or a subset of their features in GLMsingle (i.e. not using GLMdenoise)?</p><p>4) More generally, it would be ideal to see somewhere addressed the idea that variability is not always noise. You do mention repetition-suppression at one point, which is a clear example of this, but non-ergodicity as well as individual differences are further examples. There is no need to change the aims of the toolbox, which are clear and reasonable, but this somewhat tangential issue should at least be alluded to.</p><p>5) In the results, using a fixed HRF leads to drastically lower performance on a variety of subsequent measures compared to fitting an HRF to each voxel, especially as regards to β map test-retest reliability (Figure 2-3). Have the authors ensured that the HRF chosen is the most appropriate one for the region of interest? In other words, is the chosen HRF also the one that most voxels are fitted in the flexible option? It should be possible to quantify whether there is substantial dissimilarity in the chosen HRF from voxel to voxel. Since the HRFs span an equidistant arc, it would be expected that HRFs at opposite ends of the set are maximally dissimilar. Since the HRF has a biological interpretation, if it were frequently the case that neighboring voxels had dissimilar HRFs, this would be concerning.</p><p>6) It is a very small effect, but it would be interesting if the authors could speculate on the cost imposed by GLMdenoise in the very most-reliable voxels. Is this an artifact of the relatively small number of voxels that surpass this threshold? Or is there a chance the GLMdenoise step is removing signal? This refers to the rightmost point in the left plot of 3A (solid purple vs red; green vs orange). This is evident again in Figure 5B intra-NSD plot in the non-monotonicity from b2 to b3 for higher thresholds, and again when the b2 and b3 lines in Figure 6A (NSD) cross at r=0.25. Given that this does not seem to happen at all for BOLD5000, it is probably just an artifact, but seems nonetheless interesting enough for the authors to double-check whether there is any other explanation apparent in the data.</p><p>7) The benefit of b4 vs. b1 seems much larger in the NSD dataset than in the BOLD5000 dataset (Figure 2A). Is this because GLMsingle was initially optimised for the NSD dataset, or is there a different reason for this? The authors mention the fact that were fewer stimulus repetitions in BOLD5000 – but isn't that exactly the scenario for which GLMsingle was intended? Could it be due to the longer ITIs in BOLD5000?</p><p>8) The two datasets GLMsingle was tested on did not have a jittered intertrial interval (although the second one had a quite long (9s) intertrial interval). So, it remains to be seen whether there are also such large improvements when applying this method to a design with jittered intervals.</p><p>9) It would also be useful to include some intermediate results for the interested reader. As an example for the two chosen dataset, it could be instructional to know how many different hrf functions were obtained using FitHRF, how the ridge regression affects shrinkage of betas etc. The provided example in the toolbox (Python / Matlab) serves well to explore some of these intermediary steps, but some of these could also be explained in further detail as supplementary material. This would have a didactic purpose, informing the reader more about the process under the hood rather than just how the choices influence final estimates of betas.</p><p>10) Some relevant information on the amount of data from the two datasets could be explained in their Results section, specifically including number of conditions, repetitions per condition, and functional runs. It is not so straightforward to figure out this from the methods section given that the authors provide information on the datasets themselves, and then also the amount of the data used. Having some metrics in the main text would help to orient the reader and more easily allow a comparison of the results to the types of designs readers may be considering.</p><p>11) Researchers who study reliability often will complain about the use of Pearson correlation in that context. For completeness, the authors might want to at least look into this debate and decide whether it is worth addressing in the manuscript.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.77599.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Including more practical guidelines on implementation would strengthen the manuscript and ease the implementation for users. This especially pertains to the features the user needs to flag when running the toolbox (HRF estimation, noise regressors, ridge regression). The specific implementation is left up to the users and the authors mention that this should depend on one's experimental goals, but do not provide more concrete guidelines.</p></disp-quote><p>We agree that the manuscript would benefit from more extensive guidelines regarding the implementation of GLMsingle.</p><p>We have added a substantial “Implementation Guidelines” section to the Discussion. This section comments on major implementational choices that users may face when deciding how to apply GLMsingle to their own experimental paradigms. We include guidelines for the setup of design matrices and fMRI data for input to GLMsingle, and description of several input parameters that can enable, disable, or modify particular routines within GLMsingle (e.g. whether HRF fitting is enabled, the extent of the noise pool, the range of regularization levels tested during ridge regression). Beyond the concrete implementation tips, we also provide higher-level discussion to address key concerns or curiosities that users may have (these are designed based on our own personal interactions with many different researchers with whom we have communicated regarding GLMsingle). These additions to the manuscript should strengthen users’ understanding of the subroutines within GLMsingle and their rationales.</p><disp-quote content-type="editor-comment"><p>From the manuscript it seems that including all of the features works best, but this is based on two condition-rich experiments that may differ a lot from a user's dataset.</p></disp-quote><p>Our results indeed suggest that including all subroutines within GLMsingle yields the best outcomes in NSD and BOLD5000. We feel this to be reasonably strong evidence that each component of GLMsingle may contribute unique added benefit to the quality of signal estimates across a range of datasets, given the diversity of characteristics between the two datasets (e.g., different field strength, spatial and temporal resolution, behavioral tasks, event structure, stimuli). Still, we do acknowledge that, as large-scale, condition-rich datasets, NSD and BOLD5000 do differ from typical fMRI datasets. Thus, we agree that it would be additionally informative to demonstrate results on a new dataset that is further distinct from NSD and BOLD5000.</p><p>In the revised manuscript, we have conducted a further test of the generality of GLMsingle, using a third dataset consisting of 16 subjects performing an auditory task with 25 conditions (StudyForrest music-listening task). This dataset differs from NSD and BOLD5000 in three key ways: the task modality (auditory), the more “block” nature of the stimulus duration (6-s of auditory stimulation compared to 3-s and 1-s of visual stimulation in NSD and BOLD5000, respectively), and the use of a jittered inter-stimulus interval (see Essential Revision 8 below). As in NSD and BOLD5000, we observe substantial improvements in reliability via GLMsingle, and again, each individual component of GLMsingle confers added benefit in reliability compared to the baseline GLM (see Figure 4). These findings, arising from a smaller-scale dataset that may more closely reflect typical studies conducted by fMRI users, strengthen the evidence for the general applicability of GLMsingle.</p><p>(In addition, the example scripts provided on the GitHub repository show the effectiveness of GLMsingle on yet an additional dataset consisting of a conventional 10-condition category functional localizer. Of course, this is outside of the manuscript proper due to space reasons, but we just wanted to mention this to the reviewers and editors.)</p><p>Changes to the revised manuscript regarding the inclusion of the StudyForrest dataset can be found in the Introduction (paragraph 6); the Results section (under &quot;GLMsingle improves the reliability of beta estimates&quot; – see paragraph 9 of that subsection and Figure 4); and, in the Materials and methods section (under &quot;Applying GLMsingle to the StudyForrest music-listening dataset&quot;).</p><disp-quote content-type="editor-comment"><p>Therefore it would be useful to walk the user through potential considerations for each of those features, or consider the most common uses of the toolbox (e.g. condition-rich designs, repetition-suppression studies, looking at within-session learning effects etc.).</p></disp-quote><p>We agree that adding further implementation guidelines regarding the main subroutines within GLMsingle (HRF fitting, GLMdenoise, and ridge regression) would be helpful to users, as well as recommendations regarding common use cases.</p><p>We have substantially expanded the Discussion section to provide additional detail on these topics.</p><disp-quote content-type="editor-comment"><p>2) There are some examples where the authors provide guidelines, but this could be strengthened. For instance, they discuss that the use of ridge regression could bias temporally adjacent trials to be more similar in magnitude – so they caution against using this feature for studies specifically interested in the relative responses of neighbouring trials (e.g. looking into preparation-execution in motor studies, repetition suppression-type of designs, etc.). But from Figure 4 there seems an advantage when including ridge regression in addition to denoising and fitting HRF, leading to a further reduction of the temporal autocorrelation between nearby trials. So, a reader might take-away that this is the least biased estimate of neighbouring trials. But mightn't it also destroy 'real' (neural) autocorrelation between trials, due to e.g. stimulus-specific adaptation and serial dependence? What exactly would the authors suggest then for designs where estimation of subsequent trials (e.g. repetition suppression or serial dependence) is of primary interest?</p></disp-quote><p>We acknowledge that studies seeking to analyze responses to trials that are close together in time pose challenges with respect to signal estimation, and users should indeed be mindful of how they analyze data using GLMsingle in these contexts. Furthermore, we point out that signal estimation for nearby trials is a general challenge that is not specific to GLMsingle: for example, ordinary least-squares estimates also suffer from statistical issues (e.g., high negative correlation in the estimation error associated with nearby trial estimates).</p><p>As the reviewers note, GLMsingle (perhaps surprisingly) can mitigate temporal autocorrelation in the spatial β maps between neighboring trials, which is presumably beneficial for most use cases that seek to disentangle the underlying brain responses to nearby trials. As noted in the manuscript, users should be aware that the use of ridge regression will lead to some amount of temporal smoothing of β estimates for nearby trials. When the critical hypotheses depend on the neural responses to trials that are directly after one another in time, users may choose to disable the ridge regression component of GLMsingle (to avoid any effects of temporal smoothing). But there is no guarantee that doing so will improve the accuracy of signal estimation – the trial-wise estimates associated with neighboring events will still have high levels of noise and exhibit statistical dependencies (correlations).</p><p>We think that there is no “silver bullet” for resolving the tricky issues associated with signal estimation when neighboring trials are of interest. The optimizations within GLMsingle are conservative by design (e.g., a single, constant, cross-validated ridge regression hyperparameter is applied per voxel over the entire set of trials passed to the function), and it is possible that the best outcomes may still be achieved with all components of GLMsingle enabled, even when close-by responses are of interest. This is an interesting issue that could be the subject of future, focused investigations.</p><p>We have added text to the Discussion addressing the issue of scenarios where estimates to neighboring trials are of particular interest. As an additional resource to users, we elaborate on these issues at length in the GLMsingle FAQ (<ext-link ext-link-type="uri" xlink:href="https://glmsingle.readthedocs.io/en/latest/wiki.html#faq">https://glmsingle.readthedocs.io/en/latest/wiki.html#faq</ext-link>).</p><disp-quote content-type="editor-comment"><p>3) The authors use cross validation to determine the number of nuisance regressors to add in the model. Thus, any variability in responses to a single condition is considered to be 'noise'. How might this influence a potential use of single-trial estimates to assess brain-behaviour correlations (e.g., differences in behavioural responses to a single condition), or within-session learning conditions? For such uses, would the authors suggest instead using LSS or a subset of their features in GLMsingle (i.e. not using GLMdenoise)?</p></disp-quote><p>The reviewers are correct that implicit in computing cross-validated variance explained is the assumption that the same stimulus should generate the same brain response over repetitions. GLMsingle seeks to find the set of hyperparameters that results in the most replicable β estimates to repeated conditions within the chunk of data being processed. It is therefore reasonable to be concerned about the way the cross-validated components of GLMsingle would interact with analyses where different brain (and/or behavioral) responses are expected in response to condition repetitions.</p><p>Users who want to be extremely cautious may indeed want to disable the GLMdenoise and ridge regression components of the pipeline. But for most applications it seems unlikely that the nature of these regularizations would have undesirable effects on downstream analyses. For example, the purpose of cross-validation in GLMdenoise is merely to select a single scalar value dictating the number of PC noise regressors to include in the model – these PCs are derived from a pool of voxels that are not responsive to experimental stimuli, and it is unlikely that the inclusion (or exclusion) of particular PC regressors capturing global sources of noise would have the potential to destroy “true” signal that relates to fine-grained differences in neural responses to repeated conditions. As another example, GLMsingle uses ridge regression to select a single fractional regularization level for a given voxel – it is difficult to see how this could fundamentally influence a hypothesis pertaining to the full diversity of trial-wise responses obtained from a voxel. Thus, in short, there are strong theoretical reasons to believe that the outputs of GLMsingle are suitable for cases where one seeks to establish results that pertain to single trials (e.g. brain-behavioral correlations).</p><p>(Regarding the reviewers’ mention of LSS, we would not suggest substituting in least-squares separate (LSS) as an alternative to the ridge regression component of GLMsingle. LSS imposes more heavy-handed regularization on β estimates, and will corrupt β estimates when signal strength is high.)</p><p>The specifics of the cross-validation procedure and the general philosophy of GLMsingle with respect to variability and noise are discussed in the new Discussion section that has been added to the manuscript.</p><disp-quote content-type="editor-comment"><p>4) More generally, it would be ideal to see somewhere addressed the idea that variability is not always noise. You do mention repetition-suppression at one point, which is a clear example of this, but non-ergodicity as well as individual differences are further examples. There is no need to change the aims of the toolbox, which are clear and reasonable, but this somewhat tangential issue should at least be alluded to.</p></disp-quote><p>Here the reviewers raise the important point that variability is not always noise. As discussed in Essential Revision 3, we emphasize that GLMsingle is only capable of modifying the data in relatively constrained ways, for example by dampening temporal instabilities in β estimates (ridge regression), or removing bits of the signal that are contained in the GLMdenoise nuisance regressors. GLMsingle is not meant to – nor is able to – delete substantial amounts of “real” variability from the data. (In more intuitive terms: the cross-validation procedures are not bluntly taking all repetitions of a given condition and setting their betas to the mean across trials.) The goal of GLMsingle is to use limited and principled signal processing methods to improve the quality of BOLD signal estimates. And, as we have shown in the manuscript, doing so induces major benefits on downstream analytical outcomes.</p><p>Same as for Essential Revision 3, above.</p><disp-quote content-type="editor-comment"><p>5) In the results, using a fixed HRF leads to drastically lower performance on a variety of subsequent measures compared to fitting an HRF to each voxel, especially as regards to β map test-retest reliability (Figure 2-3). Have the authors ensured that the HRF chosen is the most appropriate one for the region of interest? In other words, is the chosen HRF also the one that most voxels are fitted in the flexible option?</p></disp-quote><p>As the reviewers note, we observe substantial improvement in the quality of signal estimates arising from the use of a custom HRF tailored by voxel. We interpret the reviewers’ query as referring to the issue of whether an assumed canonical HRF used in a given analysis is roughly matched to the general “true HRFs” associated with the voxels in a given region. This is an interesting issue. We point out that the vast majority of fMRI analyses being conducted in cognitive neuroscience use “off-the-shelf” HRFs that are not tailored at all to any given subject or region of interest. The assume-HRF analysis that we demonstrate in the paper is in line with this spirit.</p><p>The reviewers’ point leads us towards an interesting new question, namely, whether the HRF tailoring provided by GLMsingle might be simply due to choosing a better HRF that broadly describes the responses from a given subject (or region), or whether there is actually substantial benefit associated with voxel-wise variability in HRF shape within a given subject (or region).</p><p>To provide further insight into HRF variation, the revised manuscript now includes analysis of the stability of optimal HRF indices (see Figure 2—figure supplement 1; Results section; Methods section). We show that in active voxels, there is a clear structuring of optimal HRF indices in the form of a low-frequency spatial gradient. Moreover, the optimal indices are consistent from session to session (see panel c). This provides evidence that, beyond identifying subject-specific deviation from the assumed HRF, the FitHRF procedure may confer benefit by identifying voxel-to-voxel differences in HRF shape.</p><p>(Note: Getting into vascular issues is beyond the scope of the manuscript, but we would like to point out that spatial variation in HRF shape has a strong biophysical basis in terms of properties of the vasculature (e.g., see Kay et al., <italic>Nature Methods</italic>, 2020). This is mentioned in the Results section under &quot;GLMsingle improves the reliability of beta estimates&quot;.)</p><disp-quote content-type="editor-comment"><p>It should be possible to quantify whether there is substantial dissimilarity in the chosen HRF from voxel to voxel. Since the HRFs span an equidistant arc, it would be expected that HRFs at opposite ends of the set are maximally dissimilar. Since the HRF has a biological interpretation, if it were frequently the case that neighboring voxels had dissimilar HRFs, this would be concerning.</p></disp-quote><p>We agree that it would be concerning if the optimal HRF indices were highly variable between neighboring voxels.</p><p>The analysis we conducted in response to Essential Revision 5.1 addresses the issue raised by the reviewers. In this analysis, we assess (quantitatively and qualitatively) the stability of the optimal HRFs in space and in time. In active voxels from a representative subject, we find that neighboring voxels rarely differ by more than a few indices, and that the optimal HRFs generally follow a low-frequency gradient over cortex (see Figure 2—figure supplement 1b). Moreover, the pattern of optimal HRFs is highly stable over the 10 experimental sessions analyzed from this subject (mean <italic>r =</italic> 0.78 between sessions in the most active voxels, see Figure 2—figure supplement 1c). All together, these results add evidence that the optimal HRF indices estimated using GLMsingle are far from random (though, as expected, in voxels with little or no fMRI signal, HRF indices are essentially random; see ON-OFF R2 &lt; 10, Figure 2—figure supplement 1, top row).</p><disp-quote content-type="editor-comment"><p>6) It is a very small effect, but it would be interesting if the authors could speculate on the cost imposed by GLMdenoise in the very most-reliable voxels. Is this an artifact of the relatively small number of voxels that surpass this threshold? Or is there a chance the GLMdenoise step is removing signal? This refers to the rightmost point in the left plot of 3A (solid purple vs red; green vs orange). This is evident again in Figure 5B intra-NSD plot in the non-monotonicity from b2 to b3 for higher thresholds, and again when the b2 and b3 lines in Figure 6A (NSD) cross at r=0.25. Given that this does not seem to happen at all for BOLD5000, it is probably just an artifact, but seems nonetheless interesting enough for the authors to double-check whether there is any other explanation apparent in the data.</p></disp-quote><p>We thank the reviewers for pointing out this observation. Inspection of the counts of voxels included at each reliability threshold suggests that such effects are indeed an artifact of low voxel count and should not be interpreted as a loss of signal arising from the use of GLMdenoise. For example, in Figure 3A, at reliability threshold <italic>r</italic> = 0.5, the four NSD subjects show 318, 217, 95, and 76 voxels exceeding threshold within the nsdgeneral mask, and the four BOLD5000 subjects show 3, 1, 2, and 0 voxels respectively. (In general, there are very few voxels in BOLD5000 for which the aggregate reliability scores (averaged across β versions) reach levels that are comparable to the most reliable voxels in NSD.) As a result, plotted traces at the highest reliability levels likely contain inconsistent numbers of subjects. For all plotted results, any differences between β versions that fall within the shaded SEM regions should be interpreted with extreme caution for this reason.</p><p>As discussed above (see Essential Revisions 2–4), GLMdenoise is designed to be conservative – both in the selection of the noise pool voxels and in the choice of the number of PC regressors to include. The procedure is constrained in a manner that seeks to directly avoid the removal of valid signal from the data. Moreover, GLMdenoise as a standalone technique has been extensively validated in other work (see references to Kay et al., 2013, Charest et al., 2018).</p><p>The revised manuscript now discusses this issue and informs readers that trends in the right-most bins should be interpreted with the caveat that relatively few voxels exceed the reliability threshold at those levels. Notably, our new analyses of the auditory data from the StudyForrest dataset (see Figure 4) provide the opportunity to examine results in cases where there are very robust measures of voxel-wise reliability (given the large number of repeated trials per condition in that dataset). These results confirm that GLMsingle provides benefits even for the most reliable voxels.</p><disp-quote content-type="editor-comment"><p>7) The benefit of b4 vs. b1 seems much larger in the NSD dataset than in the BOLD5000 dataset (Figure 2A). Is this because GLMsingle was initially optimised for the NSD dataset, or is there a different reason for this? The authors mention the fact that were fewer stimulus repetitions in BOLD5000 – but isn't that exactly the scenario for which GLMsingle was intended? Could it be due to the longer ITIs in BOLD5000?</p></disp-quote><p>As the reviewers note, the voxel-level summary of reliability comparing b1 vs. b4 (Figure 2A) shows a more clear and consistent improvement in the NSD dataset compared to BOLD5000. There are several possible reasons for this:</p><p>1) First, a somewhat mundane reason is that BOLD5000 has many fewer instances of repeats, and this scarcity of repeats limits the robustness of the measures of reliability that we can quantify in the data. Thus, the reliability results obtained for any single voxel in BOLD5000 should be treated with caution, and we should make inferences primarily with respect to overall trends in the data.</p><p>2) Second, BOLD5000 has, in general, substantially weaker signal-to-noise than NSD. This is likely due to being collected at 3T (as opposed to NSD’s 7T) and involving a somewhat less potent experimental paradigm (brief 1-s stimulus presentation with a valence task vs. NSD’s 3-s stimulus presentation with a continuous recognition task). We suggest that, somewhat ironically, the benefits of denoising via GLMsingle are likely maximized at moderate levels of signal-to-noise. With limited signal-to-noise, it is difficult to estimate signal characteristics (e.g. HRF indices) and noise characteristics (e.g. optimal number of noise PCs), and so benefits of denoising may be modest. On the other hand, at very high signal-to-noise levels, signal quality and reliability are already high, and so there is little denoising left to be done. One way to think about it is that GLMsingle is a <italic>data-driven</italic> technique, and hence, the benefit of denoising may increase as signal quality increases. In fact, the results from the StudyForrest dataset directly bear this out in terms of greatest benefits being obtained for voxels with moderate signal-to-noise levels (see Figure 4c, left panel).</p><p>3) Finally, the reviewers are correct in pointing out that the longer ITIs in BOLD5000 provides yet another point of contrast with respect to NSD. The longer the ITI, the less overlap there will be in the BOLD response to successive trials, and hence the benefits of the ridge regression component of GLMsingle will be more modest compared to cases with shorter ITIs.</p><p>We have added several sentences to the Results section where Figure 2 is discussed to provide added context to aid in readers’ interpretation of the results.</p><disp-quote content-type="editor-comment"><p>8) The two datasets GLMsingle was tested on did not have a jittered intertrial interval (although the second one had a quite long (9s) intertrial interval). So, it remains to be seen whether there are also such large improvements when applying this method to a design with jittered intervals.</p></disp-quote><p>This is a useful observation. Many fMRI studies employ jittered intertrial intervals, and it makes sense that readers would be curious to know whether GLMsingle would confer similar benefit in such datasets compared to that observed in NSD and BOLD5000. We point out that from the perspective of statistical theory, there is no reason to think that the GLMsingle procedures are somehow specific to fixed-ITI designs. Nonetheless, it does provide value to demonstrate empirical results on additional diverse datasets.</p><p>To address the specific concern about jittered ITIs, as well as to test the general applicability of GLMsingle more broadly, we applied the GLMsingle pipeline to a third validation dataset, the music-listening component of the StudyForrest experiment. The revised manuscript provides specific details regarding the characteristics of this dataset and our analyses (see Figure 4; Results section; Methods section). In brief, the dataset measures brain responses as subjects listen to 25 musical clips of duration 6 s from 5 genres, with 8 repetitions per condition per subject. We analyze the group of 16 subjects from this dataset for whom all functional data files are available on the online data repository. The results are summarized in Figure 4. As in NSD and BOLD5000, we find that each optimization stage within GLMsingle confers added benefit to voxel reliability in the StudyForrest dataset, in a reasonably consistent manner across subjects.</p><disp-quote content-type="editor-comment"><p>9) It would also be useful to include some intermediate results for the interested reader. As an example for the two chosen dataset, it could be instructional to know how many different hrf functions were obtained using FitHRF, how the ridge regression affects shrinkage of betas etc. The provided example in the toolbox (Python / Matlab) serves well to explore some of these intermediary steps, but some of these could also be explained in further detail as supplementary material. This would have a didactic purpose, informing the reader more about the process under the hood rather than just how the choices influence final estimates of betas.</p></disp-quote><p>We agree that readers and users would benefit from clearer implementational guidelines and additional discussion to make the inner workings of GLMsingle more transparent.</p><p>As covered in Essential Revisions 1–2, we have extended the manuscript’s Discussion section to include more detail about the intermediate steps in the pipeline. In addition, as covered in Essential Revision 5, we have conducted new analyses that provide insight into the distribution of HRFs that are chosen in a representative subject (see Figure 2—figure supplement 1b). Due to space constraints, we suggest that the additional content related to inspection of other intermediate results is best conveyed through the example scripts on the GitHub repository.</p><disp-quote content-type="editor-comment"><p>10) Some relevant information on the amount of data from the two datasets could be explained in their Results section, specifically including number of conditions, repetitions per condition, and functional runs. It is not so straightforward to figure out this from the methods section given that the authors provide information on the datasets themselves, and then also the amount of the data used. Having some metrics in the main text would help to orient the reader and more easily allow a comparison of the results to the types of designs readers may be considering.</p></disp-quote><p>We thank the reviewers for pointing out that we could enhance the clarity of the Results section by providing these details.</p><p>Relevant metrics for each dataset have been added.</p><disp-quote content-type="editor-comment"><p>11) Researchers who study reliability often will complain about the use of Pearson correlation in that context. For completeness, the authors might want to at least look into this debate and decide whether it is worth addressing in the manuscript.</p></disp-quote><p>We recognize that there are other metrics (e.g. Spearman rank correlation) for quantifying the test-retest reliability of signal estimates (or signal-noise ratio more broadly). In the manuscript, we apply in a straightforward manner the approach of Tarhan and Konkle (<italic>Neuroimage</italic>, 2020), which involves correlating each voxel’s response profile over conditions between different splits of the data. We believe this approach to be well validated and reasonably standard across the field of cognitive neuroimaging. In addition, it is related closely to the metric of noise-ceiling SNR (“ncsnr”) described in detail in the NSD dataset paper (Allen et al., 2022). We anticipate that the basic trends in our results would be unchanged were we to use other metrics for the reliability of signal estimates.</p><p>We have added a sentence to the Methods section where the test-retest reliability computation is discussed to provide added context.</p></body></sub-article></article>