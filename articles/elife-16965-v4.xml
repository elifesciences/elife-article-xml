<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">16965</article-id><article-id pub-id-type="doi">10.7554/eLife.16965</article-id><article-categories><subj-group subj-group-type="heading"><subject>Genomics and Evolutionary Biology</subject></subj-group><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Adaptation in protein fitness landscapes is facilitated by indirect paths</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-8335"><name><surname>Wu</surname><given-names>Nicholas C</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9078-6697</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-5"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/><xref ref-type="fn" rid="pa1">‡</xref></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-56448"><name><surname>Dai</surname><given-names>Lei</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib">†</xref><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-11983"><name><surname>Olson</surname><given-names>C Anders</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-16022"><name><surname>Lloyd-Smith</surname><given-names>James O</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7941-502X</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-6518"><name><surname>Sun</surname><given-names>Ren</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-3"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Molecular and Medical Pharmacology</institution>, <institution>University of California, Los Angeles</institution>, <addr-line><named-content content-type="city">Los Angeles</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Molecular Biology Institute</institution>, <institution>University of California, Los Angeles</institution>, <addr-line><named-content content-type="city">Los Angeles</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Department of Ecology and Evolutionary Biology</institution>, <institution>University of California, Los Angeles</institution>, <addr-line><named-content content-type="city">Los Angeles</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing editor</role><aff id="aff4"><institution>Max Planck Institute for Developmental Biology</institution>, <country>Germany</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>rsun@mednet.ucla.edu</email></corresp><fn fn-type="present-address" id="pa1"><label>‡</label><p>Department of Integrative Structural and Computational Biology, The Scripps Research Institute, La Jolla, United States</p></fn><fn fn-type="con" id="equal-contrib"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="pub" publication-format="electronic"><day>08</day><month>07</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>5</volume><elocation-id>e16965</elocation-id><history><date date-type="received"><day>18</day><month>04</month><year>2016</year></date><date date-type="accepted"><day>07</day><month>07</month><year>2016</year></date></history><permissions><copyright-statement>© 2016, Wu et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Wu et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-16965-v4.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.16965.001</object-id><p>The structure of fitness landscapes is critical for understanding adaptive protein evolution. Previous empirical studies on fitness landscapes were confined to either the neighborhood around the wild type sequence, involving mostly single and double mutants, or a combinatorially complete subgraph involving only two amino acids at each site. In reality, the dimensionality of protein sequence space is higher (20<sup><italic>L</italic></sup>) and there may be higher-order interactions among more than two sites. Here we experimentally characterized the fitness landscape of four sites in protein GB1, containing 20<sup>4</sup> = 160,000 variants. We found that while reciprocal sign epistasis blocked many direct paths of adaptation, such evolutionary traps could be circumvented by indirect paths through genotype space involving gain and subsequent loss of mutations. These indirect paths alleviate the constraint on adaptive protein evolution, suggesting that the heretofore neglected dimensions of sequence space may change our views on how proteins evolve.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.001">http://dx.doi.org/10.7554/eLife.16965.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.16965.002</object-id><title>eLife digest</title><p>Proteins can evolve over time by changing their component parts, which are called amino acids. These changes usually happen one at a time and natural selection tends to preserve those changes that make the protein more efficient at its specific tasks, while discarding those that impair the protein’s activity. However the effect of each change depends on the protein as a whole, and so two changes that separately make the protein worse can make it much better if they occur together. This phenomenon is called epistasis and in some cases it can trap proteins in a sub-optimal form and prevent them from improving further.</p><p>Proteins are made from twenty different kinds of amino acid, and there are millions of different combinations of amino acids that could, in theory, make a protein of a given length. Studying protein evolution involves making variants of the same protein, each with just a few changes, and comparing how efficient, or “fit”, they are. Previous studies only measured the fitness of a few variants and showed that epistasis could block protein evolution by requiring the protein to lose some fitness before it could improve further. However, new techniques have now made it easier to study protein evolution by testing many more protein variants.</p><p>Wu, Dai et al. focused on four amino acids in part of a protein called GB1 and tested the efficiency of every possible combination of these four amino acids, a total of 160,000 (20<sup>4</sup>) variants. Contrary to expectations, the results suggested that the protein could evolve quickly to maximise fitness despite there being epistasis between the four amino acids. Overcoming epistasis typically involved making a change to one amino acid that paved the way for further changes while avoiding the need to lose fitness. The original change could then be reversed once the epistasis was overcome. The complexity of this solution means it can only be seen by studying a large number of protein variants that represent many alternative sequences of protein changes.</p><p>Wu, Dai et al. conclude that proteins are able to achieve a higher level of fitness through evolution by exploring a large number of changes. There are many possible changes for each protein and it is this variety that, despite epistasis, allows proteins to become naturally optimised for the tasks that they perform. While the full complexity of protein evolution cannot be explored at the moment, as technology advances it will become possible to study more protein variants. Such advances would therefore hopefully allow researchers to discover even more about the natural mechanisms of protein evolution.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.002">http://dx.doi.org/10.7554/eLife.16965.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>saturation mutagenesis</kwd><kwd>deep sequencing</kwd><kwd>fitness landscape</kwd><kwd>epistasis</kwd><kwd>adaptive evolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007185</institution-id><institution>University of California, Los Angeles</institution></institution-wrap></funding-source><award-id>Philip Whitcome Pre-Doctoral Fellowship</award-id><principal-award-recipient><name><surname>Wu</surname><given-names>Nicholas C</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001033</institution-id><institution>Jane Coffin Childs Memorial Fund for Medical Research</institution></institution-wrap></funding-source><award-id>HHMI Postdoctoral Fellowship from Jane Coffin Childs Memorial Fund for Medical Research</award-id><principal-award-recipient><name><surname>Dai</surname><given-names>Lei</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 DE023591</award-id><principal-award-recipient><name><surname>Sun</surname><given-names>Ren</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007185</institution-id><institution>University of California, Los Angeles</institution></institution-wrap></funding-source><award-id>Audree Fowler Fellowship in Protein Science</award-id><principal-award-recipient><name><surname>Wu</surname><given-names>Nicholas C</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007185</institution-id><institution>University of California, Los Angeles</institution></institution-wrap></funding-source><award-id>Dissertation Year Fellowship</award-id><principal-award-recipient><name><surname>Wu</surname><given-names>Nicholas C</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The extra dimensions in protein sequence space open up indirect paths of adaptation and alleviate the constraint on the selective accessibility to high fitness genotypes.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The fitness landscape is a fundamental concept in evolutionary biology (<xref ref-type="bibr" rid="bib23">Kauffman and Levin, 1987</xref>; <xref ref-type="bibr" rid="bib48">Poelwijk et al., 2007</xref>; <xref ref-type="bibr" rid="bib51">Romero and Arnold, 2009</xref>; <xref ref-type="bibr" rid="bib17">Hartl, 2014</xref>; <xref ref-type="bibr" rid="bib26">Kondrashov and Kondrashov, 2015</xref>; <xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>). Large-scale datasets combined with quantitative analysis have successfully unraveled important features of empirical fitness landscapes (<xref ref-type="bibr" rid="bib27">Kouyos et al., 2012</xref>; <xref ref-type="bibr" rid="bib1">Barton et al., 2015</xref>; <xref ref-type="bibr" rid="bib57">Szendro et al., 2013</xref>). Nevertheless, there is a huge gap between the limited throughput of fitness measurements (usually on the order of 10<sup>2</sup> variants) and the vast size of sequence space. Recently, the bottleneck in experimental throughput has been improved substantially by coupling saturation mutagenesis with deep sequencing (<xref ref-type="bibr" rid="bib10">Fowler et al., 2010</xref>; <xref ref-type="bibr" rid="bib18">Hietpas et al., 2011</xref>; <xref ref-type="bibr" rid="bib21">Jacquier et al., 2013</xref>; <xref ref-type="bibr" rid="bib69">Wu et al., 2014</xref>; <xref ref-type="bibr" rid="bib59">Thyagarajan and Bloom, 2014</xref>; <xref ref-type="bibr" rid="bib49">Qi et al., 2014</xref>; <xref ref-type="bibr" rid="bib56">Stiffler et al., 2015</xref>), which opens up unprecedented opportunities to understand the structure of high-dimensional fitness landscapes (<xref ref-type="bibr" rid="bib22">Jiménez et al., 2013</xref>; <xref ref-type="bibr" rid="bib47">Pitt and Ferré-D'Amaré, 2010</xref>; <xref ref-type="bibr" rid="bib45">Payne and Wagner, 2014</xref>).</p><p>Previous empirical studies on combinatorially complete fitness landscapes have been limited to subgraphs of the sequence space consisting of only two amino acids at each site (2<sup><italic>L</italic></sup> genotypes) (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib32">Lunzer et al., 2005</xref>; <xref ref-type="bibr" rid="bib42">O’Maille et al., 2008</xref>; <xref ref-type="bibr" rid="bib31">Lozovsky et al., 2009</xref>; <xref ref-type="bibr" rid="bib11">Franke et al., 2011</xref>; <xref ref-type="bibr" rid="bib58">Tan et al., 2011</xref>). Most studies of adaptive walks in these diallelic sequence spaces focused on “direct paths” where each mutational step reduces the Hamming distance from the starting point to the destination. However, it has also been shown that mutational reversions can occur during adaptive walks in diallelic sequence spaces such that adaptation proceeds via “indirect paths” (<xref ref-type="bibr" rid="bib7">DePristo et al., 2007</xref>; <xref ref-type="bibr" rid="bib2">Berestycki et al., 2014</xref>; <xref ref-type="bibr" rid="bib33">Martinsson, 2015</xref>; <xref ref-type="bibr" rid="bib29">Li, 2015</xref>; <xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>). In sequence space with higher dimensionality (20<italic><sup>L</sup></italic>, for a protein sequence with <italic>L</italic> amino acid residues), the extra dimensions may further provide additional routes for adaptation (<xref ref-type="bibr" rid="bib13">Gavrilets, 1997</xref>; <xref ref-type="bibr" rid="bib3">Cariani, 2002</xref>). Although the existence of indirect paths has been implied in different contexts, it has not been studied systematically and its influence on protein adaptation remains unclear. Another underappreciated property of fitness landscapes is the influence of higher-order interactions. Empirical evidence suggests that pairwise epistasis is prevalent in fitness landscapes (<xref ref-type="bibr" rid="bib28">Kvitek and Sherlock, 2011</xref>; <xref ref-type="bibr" rid="bib27">Kouyos et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">O’Maille et al., 2008</xref>; <xref ref-type="bibr" rid="bib31">Lozovsky et al., 2009</xref>). Specifically, sign epistasis between two loci is known to constrain adaptation by limiting the number of selectively accessible paths (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>). Higher-order epistasis (i.e. interactions among more than two loci) has received much less attention and its role in adaptation is yet to be elucidated (<xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>).</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Empirical determination of a four-site fitness landscape</title><p>In this study, we investigated the fitness landscape of all variants (20<sup>4</sup> = 160,000) at four amino acid sites (V39, D40, G41 and V54) in an epistatic region of protein G domain B1 (GB1, 56 amino acids in total) (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>), an immunoglobulin-binding protein expressed in Streptococcal bacteria (<xref ref-type="bibr" rid="bib53">Sjöbring et al., 1991</xref>; <xref ref-type="bibr" rid="bib52">Sauer-Eriksson et al., 1995</xref>). The four chosen sites contain 12 of the top 20 positively epistatic interactions among all pairwise interactions in protein GB1, as we previously characterized (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>) (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Thus the sequence space is expected to cover highly beneficial variants, which presents an ideal scenario for studying adaptive evolution. Moreover, this empirical fitness landscape is expected to provide us insights on how high dimensionality and epistasis would influence evolutionary accessibility. Briefly, a mutant library containing all amino acid combinations at these four sites was generated by codon randomization. The “fitness” of protein GB1 variants, as determined by both stability (i.e. the fraction of folded proteins) and function (i.e. binding affinity to IgG-Fc), was measured in a high-throughput manner by coupling mRNA display with Illumina sequencing (see Materials and methods, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>) (<xref ref-type="bibr" rid="bib50">Roberts and Szostak, 1997</xref>; <xref ref-type="bibr" rid="bib36">Olson et al., 2012</xref>). The relative frequency of mutant sequences before and after selection allowed us to compute the fitness of each variant relative to the wild type protein (WT). While most mutants had a lower fitness compared to WT (fitness &lt; 1), 2.4% of mutants were beneficial (fitness &gt; 1). (<xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>). We note that this study does not aim to extrapolate protein fitness to organismal fitness. Although there are examples showing that protein fitness in vitro correlates with organismal fitness in vivo (<xref ref-type="bibr" rid="bib34">Natarajan et al., 2013</xref>; <xref ref-type="bibr" rid="bib68">Wu et al., 2012</xref>), this relation may not be linear and is likely to be system-specific due to the difference in selection pressures in vitro and in vivo (<xref ref-type="bibr" rid="bib43">Pál et al., 2006</xref>; <xref ref-type="bibr" rid="bib19">Hingorani and Gierasch, 2014</xref>).</p></sec><sec id="s2-2"><title>Direct paths of adaptation are constrained by pairwise epistasis</title><p>To understand the impact of epistasis on protein adaptation, we first analyzed subgraphs of sequence space including only two amino acids at each site (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Each subgraph represented a classical adaptive landscape connecting WT to a beneficial quadruple mutant, analogous to previously studied protein fitness landscapes (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib57">Szendro et al., 2013</xref>). Each variant is denoted by the single letter code of amino acids across sites 39, 40, 41 and 54 (for example, WT sequence is VDGV). Each subgraph is combinatorially complete with 2<sup>4</sup> = 16 variants, including WT, the quadruple mutant, and all intermediate variants. We identified a total of 29 subgraphs in which the quadruple mutant was the only fitness peak. By focusing on these subgraphs, we essentially limited the analysis to direct paths of adaptation, where each step would reduce the Hamming distance from the starting point (WT) to the destination (quadruple mutant). Out of 24 possible direct paths, the number of selectively accessible paths (i.e. with monotonically increasing fitness) varied from 12 to 1 among the 29 subgraphs (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). In the most extreme case, only one path was accessible from WT to the quadruple mutant WLFA (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). We also observed a substantial skew in the computed probability of realization among accessible direct paths (<xref ref-type="fig" rid="fig1s5">Figure 1—figure supplement 5</xref>), suggesting that most of the realizations in adaptation were captured by a small fraction of possible trajectories (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>). These results indicated the existence of sign epistasis and reciprocal sign epistasis, both of which may constrain the accessibility of direct paths (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib60">Tufts et al., 2015</xref>). Indeed, we found that these two types of epistasis were prevalent in our fitness landscape (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Furthermore, we classified the types of all 24 pairwise epistasis in each subgraph and computed the level of ruggedness as <inline-formula><mml:math id="inf1"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was the fraction of each type of pairwise epistasis. As expected, the number of selectively inaccessible direct paths, i.e. paths that involve fitness declines, was found to be positively correlated with the ruggedness induced by pairwise epistasis (<xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>, Pearson correlation = 0.66, p=1.0 × 10<sup>−4</sup>) (<xref ref-type="bibr" rid="bib48">Poelwijk et al., 2007</xref>).<fig-group><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.16965.003</object-id><label>Figure 1.</label><caption><title>Direct paths of adaptation are constrained by pairwise epistasis.</title><p>(<bold>A</bold>) An example of subgraph that contains VDGV (wild type, WT), the quadruple mutant WLFA and all intermediates between them. Each variant in the subgraph is represented by a node. Edges are drawn between nearest neighbors. The arrows in bold represent the only accessible direct path of adaptation from VDGV to WLFA. HD: Hamming distance. (<bold>B</bold>) We identified a total of 29 subgraphs in which the quadruple mutant was the only fitness peak. The number of accessible direct paths from WT to the quadruple mutant is shown for each subgraph. The maximum number of direct paths is 24. (<bold>C</bold>) The fraction of three types of pairwise epistasis around WT (2091 out of 2166), randomly sampled from the entire sequence space (10<sup>5</sup> in total), or in the neighborhood of the top 100 fitness variants and 100 lethal variants. We note that this analysis is different from previous studies on how epistasis changes along adaptive walks, where the quadruples are chosen such that the fitness values of genotype 00, 01 and 11 are in increasing order (<xref ref-type="bibr" rid="bib15">Greene and Crona, 2014</xref>). Sign epistasis and reciprocal sign epistasis, both of which can block adaptive paths, are prevalent in the fitness landscape. Classification scheme of epistasis is shown at the top. Each node represents a genotype, which is within a sequence space of two loci and two alleles. Green arrows represent the accessible paths from genotype “00” to a beneficial double mutant “11” (colored in red).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.003">http://dx.doi.org/10.7554/eLife.16965.003</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-v4"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.004</object-id><label>Figure 1—figure supplement 1.</label><caption><title>The four-site sequence space of protein G.</title><p>(<bold>A</bold>) The locations of sites 39, 40, 41, and 54 of protein GB1 are shown on the protein structure. PDB: 1PGA (<xref ref-type="bibr" rid="bib12">Gallagher et al., 1994</xref>). (<bold>B</bold>) The WT sequence of the nucleotide template (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). T7 promoter is highlighted in magenta. Randomized sites (39, 40, 41, and 54) are highlighted in red. Poly-GS linkers are highlighted in green. FLAG-tag is highlighted in blue.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.004">http://dx.doi.org/10.7554/eLife.16965.004</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp1-v4"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.005</object-id><label>Figure 1—figure supplement 2.</label><caption><title>Positive epistasis is enriched in the four-site sequence space.</title><p>The distribution of pairwise epistasis measured by Olson et al. (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). The pairwise epistatic values among sites 39, 40, 41, and 54 are ranked and represented by the red line. The pairwise epistatic values among other sites (all but 39, 40, 41, and 54) are ranked and represented by the black line.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.005">http://dx.doi.org/10.7554/eLife.16965.005</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp2-v4"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.006</object-id><label>Figure 1—figure supplement 3.</label><caption><title>Workflow of mRNA display and data validation.</title><p>(<bold>A</bold>) The workflow of mRNA display is shown. This is adapted from (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). (<bold>B</bold>) The fitness values for all single substitution variants and double substitution variants in this study and in our previous study (based on an independently constructed library) (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>) are compared. The high correlation (Pearson correlation = 0.97, p&lt;2.2× 10<sup>−16</sup>) validates the fitness data obtained in this study.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.006">http://dx.doi.org/10.7554/eLife.16965.006</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp3-v4"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.007</object-id><label>Figure 1—figure supplement 4.</label><caption><title>Comparison of the wild type to the ensemble of possible genotypes.</title><p>(<bold>A</bold>) The distribution of fitness values of all non-lethal genotypes. The fitness rank of the wild type genotype is 2.4% in the distribution of all fitness measurements. 19.7% of the measured genotypes are lethal (fitness=0).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.007">http://dx.doi.org/10.7554/eLife.16965.007</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp4-v4"/></fig><fig id="fig1s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.008</object-id><label>Figure 1—figure supplement 5.</label><caption><title>Subgraph analysis.</title><p>We calculated the relative probabilities to realize each accessible path (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>) (see Materials and methods). In all the subgraphs analyzed, we found that most of the realizations were captured by a few accessible paths, as demonstrated by the skew in the cumulative probability of realization among different paths. (<bold>A</bold>) Cumulative probability of realization for mutational trajectories from WT (VDGV) to beneficial variants that have a Hamming distance (HD) of 4 from WT. This analysis only included those subgraphs with a reachable quadruple mutation variant (HD = 4 from WT) as the only fitness peak. Correlated Fixation Model is used. The diagonal line indicates the cumulative probability of a subgraph with equal probability of realization for all 24 possible trajectories. The bias of probability of realization in each subgraph was quantified using the Gini index (see Materials and methods) and is shown as a histogram in the inset. (<bold>B</bold>) Same as panel <bold>A</bold>, except Equal Fixation Model is used instead. (<bold>C</bold> and <bold>D</bold>) Cumulative probability for mutational trajectories from a deleterious variants that have a Hamming distance (HD) of 4 from WT (VDGV) to WT. This analysis only included those subgraphs with WT being the only fitness peak and the quadruple variant has a fitness between 0.01 to 1. The diagonal line indicates the cumulative probability of a subgraph with equal probability of realization for all 24 possible trajectories. The bias of probability of realization in each subgraph was quantified using the Gini index and is shown as a histogram in the inset. A total of 526 subgraphs were analyzed. (<bold>C</bold>) Correlated Fixation Model is used. (<bold>D</bold>) Equal Fixation Model is used. (<bold>E</bold>) Number of accessible trajectory from a deleterious variants that have a Hamming distance (HD) of 4 from WT (VDGV) to WT in each subgraph is shown as a barplot. The maximum possible number of accessible trajectory is 24. (<bold>F</bold>) The distribution of number of accessible trajectory is shown as a box plot. “Adaptation from WT” indicates those subgraphs based on the adaptation from WT to a beneficial variant that has a Hamming distance of 4 from WT. “Adaptation to WT” indicates those subgraphs based on the adaptation from a deleterious variant that has a Hamming distance of 4 from WT to WT.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.008">http://dx.doi.org/10.7554/eLife.16965.008</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp5-v4"/></fig><fig id="fig1s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.009</object-id><label>Figure 1—figure supplement 6.</label><caption><title>Correlation between the number of selectively inaccessible direct paths and ruggedness.</title><p>The number of inaccessible direct paths is positively correlated (Pearson correlation = 0.66, p=1.0 × 10<sup>−4</sup>) with the ruggedness induced by sign and reciprocal sign epistasis. The level of ruggedness is quantified as <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the fraction of each type of pairwise epistasis. The number inside a symbol indicates the number of subgraphs with identical properties.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.009">http://dx.doi.org/10.7554/eLife.16965.009</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig1-figsupp6-v4"/></fig></fig-group></p></sec><sec id="s2-3"><title>Two distinct mechanisms of extra-dimensional bypass</title><p>Our findings support the view that direct paths of protein adaptation are often constrained by pairwise epistasis on a rugged fitness landscape (<xref ref-type="bibr" rid="bib65">Weinreich et al., 2005</xref>; <xref ref-type="bibr" rid="bib26">Kondrashov and Kondrashov, 2015</xref>). In particular, adaptation can be trapped when direct paths are blocked by reciprocal sign epistasis. However, crucially, this analysis was limited to mutational trajectories within a subgraph of the sequence space. In reality, the dimensionality of protein sequence space is higher. Intuitively, when an extra dimension is introduced, a local maximum may become a saddle point and allow for further adaptation – a phenomenon that is also known as “extra-dimensional bypass” (<xref ref-type="bibr" rid="bib13">Gavrilets, 1997</xref>; <xref ref-type="bibr" rid="bib3">Cariani, 2002</xref>; <xref ref-type="bibr" rid="bib16">Gutiérrez and Maere, 2014</xref>). With our experimental data, we observed two distinct mechanisms of bypass, either using an extra amino acid at the same site or using an additional site, that allow proteins to continue adaptation when no direct paths were accessible due to reciprocal sign epistasis (<xref ref-type="fig" rid="fig2">Figure 2</xref>). The first mechanism of bypass, which we termed “conversion bypass”, works by converting to an extra amino acid at one of the interacting sites (<xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>). Consider a simple scenario with only two interacting sites. If the sequence space is limited to 2 amino acids at each site, as in past analyses of adaptive trajectories, the number of neighbors is 2; however, if all 20 possible amino acids were considered, the total number of neighbors would be 38. Some of these 36 extra neighbors may lead to potential routes that circumvent the reciprocal sign epistasis (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). In this case, a successful bypass would require a conversion step that substitutes one of the two interacting sites with an extra amino acid (<inline-formula><mml:math id="inf5"><mml:mrow><mml:mn>00</mml:mn><mml:mo>→</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>), followed by the loss of this mutation (<inline-formula><mml:math id="inf6"><mml:mrow><mml:mn>21</mml:mn><mml:mo>→</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math></inline-formula>). This bypass is feasible only if the original reciprocal sign epistasis is changed to sign epistasis after the conversion. To test whether such bypasses were present in our system, we randomly sampled <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> pairwise interactions from the sequence space and analyzed the ~20,000 reciprocal sign epistasis among them (see Materials and methods). More than 40% of the time there was at least one successful conversion bypass and in many cases multiple bypasses were available (<xref ref-type="fig" rid="fig2">Figure 2B</xref>).</p><p>The second mechanism of bypass, which we termed “detour bypass”, involves an additional site (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). In this case, adaptation can proceed by taking a detour step to gain a mutation at the third site (<inline-formula><mml:math id="inf8"><mml:mrow><mml:mn>000</mml:mn><mml:mo>→</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>), followed by the later loss of this mutation (<inline-formula><mml:math id="inf9"><mml:mrow><mml:mn>111</mml:mn><mml:mo>→</mml:mo><mml:mn>011</mml:mn></mml:mrow></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib7">DePristo et al., 2007</xref>; <xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>). Detour bypass was observed in our system (<xref ref-type="fig" rid="fig2">Figure 2D</xref>), but was not as prevalent and had a lower probability of success than conversion bypass. Out of 38 possible detour bypasses for a chosen reciprocal sign epistasis, we found that there were on average 1.2 conversion bypasses and 0.27 detour bypasses available. We note, however, that the lower prevalence of detour bypass in our fitness landscape (<italic>L</italic>=4) does not necessarily mean that it should be expected to be less frequent than conversion bypass in other systems. While the maximum number of possible conversion bypasses is always fixed (<inline-formula><mml:math id="inf10"><mml:mrow><mml:mrow><mml:mrow><mml:mn>19</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>36</mml:mn></mml:mrow></mml:math></inline-formula>), the maximum number of possible detour bypasses (19 × (<italic>L − 2)</italic>) is proportional to the sequence length <italic>L</italic> of the entire protein (whereas our study uses a subset <italic>L</italic> = 4). The pervasiveness of extra-dimensional bypasses in our system contrasts with the prevailing view that adaptive evolution is often blocked by reciprocal sign epistasis, when only direct paths of adaptation are considered. The two distinct mechanisms of bypass both require the use of indirect paths, where the Hamming distance to the destination is either unchanged (conversion) or increased (detour).<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.16965.010</object-id><label>Figure 2.</label><caption><title>Two distinct mechanisms of extra-dimensional bypass.</title><p>(<bold>A</bold>) Extra amino acids at one of the two interacting sites may open up potential paths that circumvent the reciprocal sign epistasis. The starting point is 00 and the destination is 11 (in red). Green arrows indicate the accessible path. A successful bypass would require a “conversion” step that substitutes one of the two interacting sites with an extra amino acid (<inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>00</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), followed by the loss of this mutation later (<inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>21</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The original reciprocal sign epistasis is changed to sign epistasis on the new genetic background after conversion. (<bold>B</bold>) Among ~20,000 randomly sampled reciprocal sign epistasis, &gt;40% of them can be circumvented by at least one conversion bypass (i.e. success, inset). The number of available bypass for the success cases is shown as histogram. (<bold>C</bold>) The second mechanism of bypass involves an additional site. In this case, adaptation involves a “detour” step to gain mutation at the third site (<inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>000</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), followed by the loss of this mutation (<inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>111</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>011</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The original reciprocal sign epistasis is changed to either magnitude epistasis or sign epistasis on the new genetic background after detour (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). (<bold>D</bold>) In comparison to conversion bypass, detour bypass has a lower probability of success (&lt;20%, inset) and is less prevalent.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.010">http://dx.doi.org/10.7554/eLife.16965.010</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig2-v4"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.011</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Three scenarios of extra-dimensional bypass via an extra site.</title><p>(<bold>A</bold>) Reciprocal sign epistasis may be bypassed via the involvement of a third site. (<bold>B</bold>–<bold>D</bold>) There are three possible scenarios. With a mutation at the third site, reciprocal sign epistasis between the first two sites can be changed to magnitude epistasis in (<bold>B</bold>) or sign epistasis in (<bold>C</bold>–<sc><bold>D</bold></sc>). It can be proven that higher-order epistasis is required for the scenarios in (<bold>B</bold>) and (<bold>C</bold>) (see Materials and methods).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.011">http://dx.doi.org/10.7554/eLife.16965.011</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig2-figsupp1-v4"/></fig></fig-group></p></sec><sec id="s2-4"><title>Evidence and impacts of higher-order epistasis</title><p>In order to circumvent the inaccessible direct paths via extra dimensions, reciprocal sign epistasis must be changed into other types of pairwise epistasis. For detour bypass, this means that the original reciprocal sign epistasis is changed to either magnitude epistasis or sign epistasis in the presence of a third mutation (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). There are three possible scenarios where detour bypass can occur (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B–D</xref>). We proved that higher-order epistasis is necessary for the scenario that reciprocal sign epistasis is changed to magnitude epistasis, as well as for one of the two scenarios that reciprocal sign epistasis is changed to sign epistasis (see Materials and methods). This suggests a critical role of higher-order epistasis in mediating detour bypass.</p><p>To confirm the presence of higher-order epistasis, we decomposed the fitness landscape by Fourier analysis (see Materials and methods, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>) (<xref ref-type="bibr" rid="bib57">Szendro et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib35">Neidhart et al., 2013</xref>). The Fourier coefficients can be interpreted as epistatic interactions of different orders (<xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>), including the main effects of single mutations (the first order), pairwise epistasis (the second order), and higher-order epistasis (the third and the fourth order). The fitness of variants can be reconstructed by expansion of Fourier coefficients up to a certain order (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). In our system with four sites, the fourth order Fourier expansion will always reproduce the measured fitness (i.e. the fraction of variance in fitness explained equals 1). When the second order Fourier expansion does not reproduce the measured fitness, it indicates the presence of higher-order epistasis. In this way, we identified the 0.1% of subgraphs with greatest fitness contribution from higher-order epistasis (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, red lines) and visualized the corresponding quadruple mutants by the sequence logo plot (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). The skewed composition of amino acids in these subgraphs indicates that higher-order interactions are enriched among specific amino acid combinations of site 39, 41 and 54. This interaction among 3 sites is consistent with our knowledge of the protein structure, where the side chains of sites 39, 41, and 54 can physically interact with each other at the core (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>) and destabilize the protein due to steric effects (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>).</p><p>In the presence of higher-order epistasis, epistasis between any two sites would vary across different genetic backgrounds. We computed the magnitude of pairwise epistasis (<inline-formula><mml:math id="inf15"><mml:mi>ε</mml:mi></mml:math></inline-formula>) between each pair of amino acid substitutions (see Materials and methods) (<xref ref-type="bibr" rid="bib25">Khan et al., 2011</xref>), and observed numerous instances where the sign of pairwise epistasis depended on genetic background. For example, G41L and V54H were positively epistatic when site 39 was isoleucine [I], but the interaction changed to negative epistasis when site 39 carried a tyrosine [Y] or a tryptophan [W] (<xref ref-type="fig" rid="fig3">Figure 3C–D</xref>). Similar patterns were observed in other pairwise interactions among site 39, 41 and 54, such as G41F/V54A and V39W/V54H (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplement 4</xref>). The observed pattern of higher-order epistasis was consistent with the results of the Fourier analysis (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). For example, site 40 was mostly excluded from higher-order epistasis; tyrosine [Y] or tryptophan [W] at site 39 were involved in the most significant higher-order interactions, as they often changed the sign of pairwise epistasis. Higher-order epistasis can also switch the type of pairwise epistasis, such as shifting from reciprocal sign epistasis to magnitude or sign epistasis (<xref ref-type="fig" rid="fig3s5">Figure 3—figure supplement 5</xref>), which in turn is important for the existence of detour bypass.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.16965.012</object-id><label>Figure 3.</label><caption><title>Evidence of higher-order epistasis.</title><p>(<bold>A</bold>) The fitness decomposition was performed on all subgraphs without missing variants. The fitness of variants can be reconstructed using Fourier coefficients truncated to a certain order. The fraction of variance in fitness explained by expansion of Fourier coefficients truncated to different orders (from first to fourth) is shown for each subgraph. The blue line corresponds to the median. The top 0.1% subgraphs with fitness contributions from higher-order epistasis (the bottom 0.1% subgraphs ranked by fraction of variance explained at second order expansion) are shown in red lines. (<bold>B</bold>) A sequence logo was generated for the quadruple mutants corresponding to the top 0.1% subgraphs with higher-order epistasis. The skewed composition of amino acids indicates that higher-order interactions are enriched among specific amino acid combinations of site 39, 41 and 54. (<bold>C</bold>) The magnitude of pairwise epistasis between G41L and V54H across different genetic backgrounds (i.e. all combinations of amino acids at site 39 and 40) is shown as a heat map. The amino acids of WT are boxed. Epistasis that cannot be determined due to missing variant is colored in grey. (<bold>D</bold>) Altering the genetic background at site 39 changed the positive epistasis (<inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) between G41L and V54H to negative epistasis (<inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The fitness of each variant is indicated in the parentheses.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.012">http://dx.doi.org/10.7554/eLife.16965.012</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-v4"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.013</object-id><label>Figure 3—figure supplement 1.</label><caption><title>The fraction of variance explained by Fourier coefficients at each order.</title><p>For the 109,235 complete subgraphs that we analyzed, the fraction of the variance in fitness explained by each order is shown. Although the first order (main effects) and the second order Fourier coefficients (pairwise epistasis) can explain most of the variance in fitness, higher-order epistasis is present in certain combination of mutations.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.013">http://dx.doi.org/10.7554/eLife.16965.013</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp1-v4"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.014</object-id><label>Figure 3—figure supplement 2.</label><caption><title>Fourier analysis decomposes the fitness landscape into epistatic interactions of different orders.</title><p>Here we show two examples where the fitness contribution from higher-order epistasis is small (bottom 0.1%, from VDGV to CSPA) in (<bold>A</bold>) and large (top 0.1%, from VDGV to WLLH) in (<bold>B</bold>). The fitness of variants can be reconstructed using Fourier coefficients truncated to a certain order. The Fourier coefficients can be interpreted as epistatic interactions of different orders, including the main effects of single mutations (the first order), pairwise epistasis (the second order), and higher-order epistasis (the third and the fourth order). (<bold>C</bold>) In our system with four sites, the reconstructed fitness by expansion to the fourth order Fourier coefficients will always reproduce the measured fitness (i.e. Pearson correlation equals 1). If expansion to the second order Fourier coefficients did not reproduce the measured fitness (i.e. Pearson correlation less than 1), it would indicate the presence of higher-order epistasis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.014">http://dx.doi.org/10.7554/eLife.16965.014</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp2-v4"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.015</object-id><label>Figure 3—figure supplement 3.</label><caption><title>Relationship between fitness, size of the protein core, and predicted ΔΔG.</title><p>(<bold>A</bold> and <bold>B</bold>) The relationship between fitness and the total volume of residue 39, 41, and 54 is shown as a scatter plot for (<bold>A</bold>) all variants, and (<bold>B</bold>) variants with HD of 4 from WT. The blue line indicates the volume of WT (VDGV). The red line indicates the fraction of beneficial variants within a sliding window of <inline-formula><mml:math id="inf18"> <mml:mo>± </mml:mo></mml:math></inline-formula>20 Å<sup>3</sup>. We postulated that the observed higher-order epistasis was, at least partially, due to the steric effect among site 39, 41, and 54. This was evidenced by the enrichment of beneficial variants when the total volume of these three interacting residues was between ~200 Å<sup>3</sup> and ~300 Å<sup>3</sup>. As the total volume further increased, proportion of beneficial variants dropped. (<bold>C</bold> and <bold>D</bold>) The relationship between the predicted <inline-formula><mml:math id="inf19"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math></inline-formula>G and the total size of residue 39, 41, and 54 for all variants is shown as a scatter plot for (<bold>C</bold>) all variants (Pearson correlation = 0.41), and (<bold>D</bold>) variants with HD of 4 from WT (Pearson correlation = 0.34). The purple line represents the linear regression. The predicted <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math></inline-formula>G increased as the total volume of core residues increased, indicating that the protein would be destabilized (i.e. decrease in fitness) when the core was overpacked. Therefore, the higher-order epistasis observed in this study could be partially attributed to steric effect. Nonetheless, we acknowledged that entropic effect and conformational effect in IgG-FC binding may also contribute to higher-order epistasis.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.015">http://dx.doi.org/10.7554/eLife.16965.015</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp3-v4"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.016</object-id><label>Figure 3—figure supplement 4.</label><caption><title>Alteration of pairwise epistatic effect under different genetic backgrounds.</title><p>(<bold>A</bold>) Pairwise epistatic effect of each substitution pair under each genetic background (total possible genetic backgrounds for each substitution pair = 20 × 20 = 400) was quantified. For each substitution pair, the range of epistasis across different genetic backgrounds is shown in the top panel (brown). For each substitution pair, the standard deviation of epistasis across different genetic backgrounds is shown in the middle panel (green). For each substitution pair, the maximum epistatic value across different genetic backgrounds (magenta), the minimum epistatic value across different genetic backgrounds (cyan), and the epistatic value under WT background (grey) are shown. Substitution pair is ranked by the range of epistasis (maximum epistatic value minus minimum epistatic value). (<bold>B</bold>) Epistasis between G41F and V54A across different genetic backgrounds (different combination of amino acids in sites 39 and 40) is shown. The epistasis value is color coded. Amino acids of WT are boxed. Epistasis that cannot be determined due to missing variant is colored in grey. (<bold>C</bold>) Epistasis between V39W and V54H across different genetic backgrounds (different combination of amino acids in sites 40 and 41) is shown. The epistasis value is color coded. Amino acids of WT are boxed. Epistasis that cannot be determined due to missing variant is colored in grey.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.016">http://dx.doi.org/10.7554/eLife.16965.016</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp4-v4"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.017</object-id><label>Figure 3—figure supplement 5.</label><caption><title>Higher-order epistasis can change the type of pairwise epistasis.</title><p>The type of pairwise interaction could be changed in the presence of higher-order epistasis. (<bold>A</bold>) Reciprocal sign epistasis between G41L-V54G is changed to magnitude epistasis given the mutation at site 39 (K39W). (<bold>B</bold>) Reciprocal sign epistasis between G41L-V54G is changed to sign epistasis given the mutation at site 39 (Q39Y).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.017">http://dx.doi.org/10.7554/eLife.16965.017</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp5-v4"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.018</object-id><label>Figure 3—figure supplement 6.</label><caption><title>Higher-order epistasis increases the ruggedness of fitness landscapes.</title><p>To further study the effect of higher-order epistasis on landscape ruggedness, we performed additional analyses on the subgraphs identified in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. We applied Fourier decomposition and set all higher-order coefficients to 0. (<bold>A</bold>) Among the subgraphs in which the quadruple mutant was still the only fitness peak, we found that the ruggedness score did not show a systematic trend after removal of higher-order epistasis. (<bold>B</bold>) In the meantime, on average the number of accessible direct paths seemed to decrease. Each data point is color-coded so that individual subgraphs can be matched between panel <bold>A</bold> and <bold>B</bold>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.018">http://dx.doi.org/10.7554/eLife.16965.018</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig3-figsupp6-v4"/></fig></fig-group></p></sec><sec id="s2-5"><title>Indirect paths promote evolutionary accessibility</title><p>Our analysis on circumventing reciprocal sign epistasis revealed how indirect paths could open up new avenues of adaptation. To study the impact of indirect paths at a global scale, we performed simulated adaptation in the entire sequence space of 160,000 variants. The fitness landscape was completed by imputing fitness values of the 10,639 missing variants (i.e. 6.6% of the sequence space) that had fewer than 10 sequencing read counts in the input library. Our model of protein fitness incorporated main effects of single mutations, pairwise interactions, and three-way interactions among site 39, 41 and 54 (see Materials and methods, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We used predictor selection based on biological knowledge, followed by regularized regression, which has been demonstrated to ameliorate possible bias in the inferred fitness landscape (<xref ref-type="bibr" rid="bib41">Otwinowski and Plotkin, 2014</xref>). In the complete sequence space, we identified a total of 30 fitness peaks (i.e. local maxima); among them 15 peaks had fitness larger than WT and their combined basins of attraction covered 99% of the sequence space (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.16965.019</object-id><label>Figure 4.</label><caption><title>Indirect paths promote evolutionary accessibility.</title><p>(<bold>A</bold>) 15 peaks had fitness larger than WT and their combined basins of attraction accounted for 99% of the entire sequence space. The size of each basin of attraction is identified by the Greedy Model (see Materials and methods). The area of each node is in proportion to the size of the basin of attraction of the corresponding fitness peak. An edge is drawn between fitness peaks that are separated by a Hamming distance of 2. (<bold>B</bold>) A possible adaptive path starting from WT (VDGV) to the fitness peak LYGV. (<bold>C</bold>) The frequency of different types of mutational step are shown. Three models, including the Greedy Model (green), Correlated Fixation Model (blue) and Equal Fixation Model (red), are used to simulate 1000 adaptive paths starting from each variant in the sequence space. All the adaptive paths end at a fitness peak. (<bold>D</bold>) The distribution of the length of the adaptive path initiated at different starting points. For Correlated Fixation Model and Equal Fixation Model, the length was computed by averaging over 1000 simulated paths for each starting point. The scale on the left is for Greedy Model. The scale on the right is for Correlated Fixation Model and Equal Fixation Model. (<bold>E</bold>) Indirect paths increased the number of genotypes accessible to each fitness peak. The 15 peaks are ordered by increasing fitness (from left to right). (<bold>F</bold>) A large fraction of beneficial variants in the sequence space (fitness &gt; 1) were accessible from WT only via indirect paths. Beneficial variants were classified by their Hamming distance (HD) from WT.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.019">http://dx.doi.org/10.7554/eLife.16965.019</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig4-v4"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.020</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Lasso regression.</title><p>Coefficients of the statistical model were fit by lasso regression on the measured fitness values of 119,884 non-lethal variants (see Materials and methods). (<bold>A</bold>) 10-fold CV (cross-validation) MSE (mean squared errors) of lasso regression with varying penalty parameter <inline-formula><mml:math id="inf21"><mml:mi>λ</mml:mi></mml:math></inline-formula>. The black line indicates the 10-fold CV MSE of ordinary least squares regression (i.e. penalty parameter is zero). The red lines indicate the standard deviation. <inline-formula><mml:math id="inf22"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is chosen for imputing the fitness values of missing variants. (<bold>B</bold>) The number of nonzero coefficients in the model with varying penalty parameter <inline-formula><mml:math id="inf23"><mml:mi>λ</mml:mi></mml:math></inline-formula>. The line indicates the number of nonzero coefficients given by ordinary least squares regression. (<bold>C</bold>) Comparison between the predicted fitness values and the measured fitness values (Pearson correlation=0.93).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.020">http://dx.doi.org/10.7554/eLife.16965.020</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig4-figsupp1-v4"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.021</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Indirect paths in adaptation.</title><p>(<bold>A</bold>) A mutational trajectory initiated from PIWI under Greedy Model, which ended at the fitness peak, FWLG. (<bold>B</bold>) One of the shortest mutational trajectories from WT (VDGV) to a beneficial mutation (VHGL). (<bold>C</bold>) Histogram of the number of fitness accessible from a given genotype. The fraction of genotypes accessible to 15 fitness peaks increased substantially when indirect paths are allowed in adaptation.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.021">http://dx.doi.org/10.7554/eLife.16965.021</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig4-figsupp2-v4"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.022</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Evolutionary accessibility under constraints imposed by the standard genetic code.</title><p>(<bold>A</bold>) To study evolutionary accessibility under constraints imposed by the standard genetic code, we restricted amino acid substitutions to those that were differed by a single nucleotide. This constraint is shown as a symmetric matrix, where red represents substitution that is allowed and white represents substitution that is not allowed. (<bold>B</bold>) Beneficial variants (fitness &gt; 1) were classified by their Hamming distance (HD) from WT at the amino acid level. Accessibility to these beneficial variants from WT was determined under the constraints imposed by the standard genetic code.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.022">http://dx.doi.org/10.7554/eLife.16965.022</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig4-figsupp3-v4"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.16965.023</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Delay of commitment in mutational trajectories involving extra-dimensional bypass.</title><p>An entropy of evolutionary outcome was calculated for each of the 160,000 variants. Given a variant <inline-formula><mml:math id="inf24"><mml:mi>v</mml:mi></mml:math></inline-formula> with <inline-formula><mml:math id="inf25"><mml:mi>n</mml:mi></mml:math></inline-formula> accessible fitness peaks, the entropy of evolutionary outcome was then computed as follow:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:mtext>E</mml:mtext><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi id="XM113">ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM114"><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> represented the frequency of reaching the fitness peak <inline-formula><mml:math id="inf27"><mml:mi>i</mml:mi></mml:math></inline-formula> among 1000 simulated mutational trajectories from variant <inline-formula><mml:math id="inf28"><mml:mi>v</mml:mi></mml:math></inline-formula> following Correlated Fixation Model.</p><p>The entropy of evolutionary fates at each step along an adaptive path is shown. Adaptive paths with the same number of steps are grouped together. We observed that many mutational trajectories that involved extra-dimensional bypass did not fully commit to a fitness peak (entropy = 0) until the last two steps. Each grey line represents a mutational trajectory in each category. Only 100 randomly sampled trajectories are shown due to the difficulty in visualizing a large number of lines on the graph. The median entropy at each step in each category is represented by the red line.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.023">http://dx.doi.org/10.7554/eLife.16965.023</ext-link></p></caption><graphic mime-subtype="x-tiff" mimetype="image" xlink:href="elife-16965-fig4-figsupp4-v4"/></fig></fig-group></p><p>We then simulated adaptation on the fitness landscape using three different models of adaptive walks (see Materials and methods), namely the Greedy Model (<xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>), Correlated Fixation Model (<xref ref-type="bibr" rid="bib14">Gillespie, 1984</xref>), and Equal Fixation Model (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>). In the Greedy Model, adaptation proceeds by sequential fixation of mutations that render the largest fitness gain at each step. The other two models assign a nonzero fixation probability to all beneficial mutations, either weighted by (Correlated Fixation Model) or independent of (Equal Fixation Model) the relative fitness gain. The Greedy Model represents adaptive evolution of a large population with pervasive clonal interference (<xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>). The Correlated Fixation Model represents adaptive evolution of a population under the scheme of strong-selection/weak-mutation (SSWM) (<xref ref-type="bibr" rid="bib14">Gillespie, 1984</xref>), which assumes that the time to fixation is much shorter than the time between mutations and the fixation probability of a given mutation is proportional to the improvement in fitness. The Equal Fixation Model represents a simplified scenario of adaptation where all beneficial mutations fix with equal probability (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>).</p><p>Among all the possible adaptive paths to fitness peaks, many of them involved indirect paths, i.e. they employed mechanisms of extra-dimensional bypass (<xref ref-type="fig" rid="fig4">Figure 4B</xref>, <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). We classified each step on the adaptive paths into three categories based on the change of Hamming distance to the destination (a fitness peak, in this case): “towards (-1)”, “conversion (0)”, and “detour (+1)” (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Conversion was found to be pervasive during adaptation in our fitness landscape (17% of mutational steps for Greedy Model, 41% for Correlated Fixation Model, 59% for Equal Fixation Model). The use of detour was less frequent (0.1% of mutational steps for Greedy Model, 1.3% for Correlated Fixation Model, 3.7% for Equal Fixation Model), in accordance with the previous observation that detour bypass was less available than conversion bypass in our fitness landscape with <inline-formula><mml:math id="inf29"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>. A conversion step would increase the length of an adaptive path by 1, while a detour step would increase the length by 2. As a result, an indirect path can be substantially longer than a direct path consisting of only “towards” steps. We found that many of the adaptive paths required more than 4 steps, which was the maximal length of a direct path between any variants in this landscape (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Interestingly, because indirect adaptive paths involved more variants of intermediate fitness, the use of conversion and detour steps depended on the strength of selection. Consistent with previous studies (<xref ref-type="bibr" rid="bib38">Orr, 2002</xref>, <xref ref-type="bibr" rid="bib39">2003</xref>), when mutations conferring larger fitness gains were more likely to fix (e.g. Greedy Model and Correlated Fixation Model), adaptation favored direct moves toward the destination, thus leading to a shorter adaptive paths (<xref ref-type="fig" rid="fig4">Figure 4C–D</xref>). This suggests that the strength of selection interacts with the topological structure of fitness landscapes to determine the length and directness of evolutionary trajectories.</p><p>Given that extra-dimensional bypasses can help proteins avoid evolutionary traps, we expect that their existence would facilitate adaptation in rugged fitness landscapes. Indeed, we found that indirect paths increased the number of genotypes with access to each fitness peak (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). In addition, the fraction of genotypes with accessible paths to all 15 fitness peaks increased from from 34% to 93% when indirect adaptive paths were allowed (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref>). We also found that a substantial fraction of beneficial variants (fitness &gt; 1) in the sequence space were accessible from WT only if indirect paths were used (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). We repeated the analysis in <xref ref-type="fig" rid="fig4">Figure 4F</xref> with the consideration of the constraints imposed by the standard genetic code (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>). The constraints from the genetic code decreased the number of accessible variants due to the reduction in connectivity. However, this reduction in connectivity did not alter our core finding that indirect paths substantially increase evolutionary accessibility (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3B</xref>). Taken together, these results suggest that indirect paths promote evolutionary accessibility in rugged fitness landscapes. This enhanced accessibility would allow proteins to explore more sequence space and lead to delayed commitment to evolutionary fates (i.e. fitness peaks) (<xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>). Consistent with this expectation, our simulations showed that many mutational trajectories involving extra-dimensional bypass did not fully commit to a fitness peak until the last two steps (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In our analysis, we have limited adaptation to the regime where fitness is monotonically increasing via sequential fixation of one-step beneficial mutants. When this assumption is relaxed, adaptation can sometimes proceed by crossing fitness valleys, such as via genetic drift or recombination (<xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>; <xref ref-type="bibr" rid="bib66">Weissman et al., 2009</xref>; <xref ref-type="bibr" rid="bib40">Ostman et al., 2012</xref>; <xref ref-type="bibr" rid="bib48">Poelwijk et al., 2007</xref>; <xref ref-type="bibr" rid="bib67">Weissman et al., 2010</xref>). Another simplification in most of our analyses is to treat all sequences in a “protein space” (<xref ref-type="bibr" rid="bib54">Smith, 1970</xref>), where two sequences are considered as neighbors if they differ by a single amino-acid substitution. In practice, amino acid substitutions occurring via a single nucleotide mutation are limited by the genetic code, so the total number of one-step neighbors would be reduced from 19<italic>L</italic> to approximately 6<italic>L</italic> (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). We also expect fitness landscapes of different systems to have different topological structure. Even in our system (with &gt;93% coverage of the genotype space), the global structure of the fitness landscape is influenced by the imputed fitness values of missing variants, which can vary when different fitness models or fitting methods are used. Our analysis also ignored measurement errors, but the measurement errors are expected to be very small due to the high reproducibility in the data (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B</xref>). Both imputation of missing variants and measurement errors can lead to slight mis-specification of the topological structure of the fitness landscape. Finally, we note that the four amino acids chosen in our study are in physical proximity and have strong epistatic interactions. While the availability of conversion bypass only depends on the dimensionality at each site, the degree of higher-order epistasis and the availability of detour bypasses can be quite different in other fitness landscapes. Although the details of a particular fitness landscape can influence the quantitative role of different bypass mechanisms, this does not undermine the generality of our conceptual findings on extra-dimensional bypass, higher-order epistasis, and their roles in protein evolution.</p><p>Higher-order epistasis has been reported in a few biological systems (<xref ref-type="bibr" rid="bib61">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Pettersson et al., 2011</xref>; <xref ref-type="bibr" rid="bib44">Palmer et al., 2015</xref>), and is likely to be common in nature (<xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>). In this study, we observed the presence of higher-order epistasis and systematically quantified its contribution to protein fitness. Our results suggest that higher-order epistasis can either increase or decrease the ruggedness induced by pairwise epistasis, which in turn determines the accessibility of direct paths in a rugged fitness landscape (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). We also revealed the important role of higher-order epistasis in mediating detour bypass, which could promote evolutionary accessibility via indirect paths. Our work demonstrates that even in the most rugged regions of a protein fitness landscape, most of the sequence space can remain highly accessible owing to the indirect paths opened up by high dimensionality. The enhanced accessibility mediated by indirect paths may provide a partial explanation for some observations in viral evolution. For example, throughout the course of infection HIV always seems to find a way to revert to the global consensus sequence, a putatively “optimal” HIV-1 sequence after immune invasion (<xref ref-type="bibr" rid="bib70">Zanini et al., 2015</xref>). As we pointed out, the possible number of detour bypasses scales up with sequence length, so it will be interesting to study how extra-dimensional bypass influences adaptation in sequence space of even higher dimensionality. For example, it is plausible that the sequence of a large protein may never be trapped in adaptation (<xref ref-type="bibr" rid="bib13">Gavrilets, 1997</xref>), so that adaptive accessibility becomes a quantitative rather than qualitative problem.</p><p>Given the continuing development of sequencing technology, we anticipate that the scale of experimentally determined fitness landscapes will further increase, yet the full protein sequence space is too huge to be mapped exhaustively. Does this mean that we will never be able to understand the full complexity of fitness landscapes? Or perhaps big data from high-throughput measurements will guide us to find general rules? By coupling state-of-the-art experimental techniques with novel quantitative analysis of fitness landscapes, this work takes the optimistic view that we can push the boundary further and discover new mechanisms underlying evolution (<xref ref-type="bibr" rid="bib9">Fisher et al., 2013</xref>; <xref ref-type="bibr" rid="bib8">Desai, 2013</xref>; <xref ref-type="bibr" rid="bib57">Szendro et al., 2013]</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Mutant library construction</title><p>Two oligonucleotides (Integrated DNA Technologies, Coralville, IA), 5’-AGT CTA GTA TCC AAC GGC NNS NNS NNK GAA TGG ACC TAC GAC GAC GCT ACC AAA ACC TT-3’ and 5’-TTG TAA TCG GAT CCT CCG GAT TCG GTM NNC GTG AAG GTT TTG GTA GCG TCG TCG T-3’ were annealed by heating to 95°C for 5 min and cooling to room temperature over 1 hr. The annealed nucleotide was extended in a reaction containing 0.5 µM of each oligonucleotide, 50 mM NaCl, 10 mM Tris-HCl pH 7.9, 10 mM MgCl<sub>2</sub>, 1 mM DTT, 250 µM each dNTP, and 50 units Klenow exo- (New England Biolabs, Ipswich, MA) for 30 mins at 37°C. The product (cassette I) was purified by PureLink PCR Purification Kit (Life Technologies, Carlsbad, CA) according to manufacturer’s instructions.</p><p>A constant region was generated by PCR amplification using KOD DNA polymerase (EMD Millipore, Billerica, MA) with 1.5 mM MgSO<sub>4</sub>, 0.2 mM of each dNTP (dATP, dCTP, dGTP, and dTTP), 0.05 ng protein GB1 wild type (WT) template, and 0.5 µM each of 5’-TTC TAA TAC GAC TCA CTA TAG GGA CAA TTA CTA TTT ACA TAT CCA CCA TG-3’ and 5’-AGT CTA GTA TCC TCG ACG CCG TTG TCG TTA GCG TAC TGC-3’. The sequence of the WT template consisted of a T7 promoter, 5’ UTR, the coding sequence of Protein GB1, 3’ poly-GS linkers, and a FLAG-tag (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>) ([<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). The thermocycler was set as follows: 2 min at 95°C, then 18 three-step cycles of 20 s at 95°C, 15 s at 58°C, and 20 s at 68°C, and 1 min final extension at 68°C. The product (constant region) was purified by PureLink PCR Purification Kit (Life Technologies) according to manufacturer’s instructions. Both the purified constant region and cassette I were digested with BciVI (New England Biolabs) and purified by PureLink PCR Purification Kit (Life Technologies) according to manufacturer’s instructions.</p><p>Ligation between the constant region and cassette I (molar ratio of 1:1) was performed using T4 DNA ligase (New England Biolabs). Agarose gel electrophoresis was performed to separate the ligated product from the reactants. The ligated product was purified from the agarose gel using Zymoclean Gel DNA Recovery Kit (Zymo Research, Irvine, CA) according to manufacturer’s instructions. PCR amplification was then performed using KOD DNA polymerase (EMD Millipore) with 1.5 mM MgSO<sub>4</sub>, 0.2 mM of each dNTP (dATP, dCTP, dGTP, and dTTP), 4 ng of the ligated product, and 0.5 µM each of 5’-TTC TAA TAC GAC TCA CTA TAG GGA CAA TTA CTA TTT ACA TAT CCA CCA TG-3’ and 5’-GGA GCC GCT ACC CTT ATC GTC GTC ATC CTT GTA ATC GGA TCC TCC GGA TTC-3’. The thermocycler was set as follows: 2 min at 95°C, then 10 three-step cycles of 20 s at 95°C, 15 s at 56°C, and 20 s at 68°C, and 1 min final extension at 68°C. The product, which is referred as “DNA library”, was purified by PureLink PCR Purification Kit (Life Technologies) according to manufacturer’s instructions.</p></sec><sec id="s4-2"><title>Affinity selection by mRNA display</title><p>Affinity selection by mRNA display (<xref ref-type="bibr" rid="bib50">Roberts and Szostak, 1997</xref>; <xref ref-type="bibr" rid="bib36">Olson et al., 2012</xref>) was performed as described (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A</xref>) (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). Briefly, The DNA library was transcribed by T7 RNA polymerase (Life Technologies) according to manufacturer’s instructions. Ligation was performed using 1 nmol of mRNA, 1.1 nmol of 5’-TTT TTT TTT TTT GGA GCC GCT ACC-3’, and 1.2 nmol of 5’-/5Phos/-d(A)21-(C<sub>9</sub>)3-d(ACC)-Puromycin by T4 DNA ligase (New England Biolabs) in a 100 µL reaction. The ligated product was purified by urea PAGE and translated in a 100 µL reaction volume using Retic Lysate IVT Kit (Life Technologies) according to manufacturer’s instructions followed by incubation with 500 mM final concentration of KCl and 60 mM final concentration of MgCl<inline-formula><mml:math id="inf30"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> for at least 30 min at room temperature to increase the efficiency for fusion formation (<xref ref-type="bibr" rid="bib30">Liu et al., 2000</xref>). The mRNA-protein fusion was then purified using ANTI-FLAG M2 Affinity Gel (Sigma-Aldrich, St. Louis, MO). Elution was performed using 3X FLAG peptide (Sigma-Aldrich). The purified mRNA-protein fusion was reverse transcribed using SuperScript III Reverse Transcriptase (Life Technologies). This reverse transcribed product, which was referred as “input library”, was incubated with Pierce streptavidin agarose (SA) beads (Life Technologies) that were conjugated with biotinylated human IgG-FC (Rockland Immunochemicals, Limerick, PA). After washing, the immobilized mRNA-protein fusion was eluted by heating to 95°C. The eluted sample was referred as “selected library”.</p></sec><sec id="s4-3"><title>Sequencing library preparation</title><p>PCR amplification was performed using KOD DNA polymerase (EMD Millipore) with 1.5 mM MgSO<sub>4</sub>, 0.2 mM of each dNTP (dATP, dCTP, dGTP, and dTTP), the selected library, and 0.5 µM each of 5’-CTA CAC GAC GCT CTT CCG ATC T<underline>NN N</underline>AG CAG TAC GCT AAC GAC AAC G-3’ and 5’-TGC TGA ACC GCT CTT CCG ATC T<underline>NN N</underline>TA ATC GGA TCC TCC GGA TTC G-3’. The underlined “NNN” indicated the position of the multiplex identifier, GTG for input library and TGT for post-selection library. The thermocycler was set as follows: 2 min at 95°C, then 10 to 12 three-step cycles of 20 s at 95°C, 15 s at 56°C, and 20 s at 68°C, and 1 min final extension at 68°C. The product was then PCR amplified again using KOD DNA polymerase (EMD Millipore) with 1.5 mM MgSO<sub>4</sub>, 0.2 mM of each dNTP (dATP, dCTP, dGTP, and dTTP), the eluted product from mRNA display, and 0.5 µM each of 5’-AAT GAT ACG GCG ACC ACC GAG ATC TA CAC TCT TTC CCT ACA CGA CGC TCT TCC G-3’ and 5’-CAA GCA GAA GAC GGC ATA CGA GAT CGG TCT CGG CAT TCC TGC TGA ACC GCT CTT CCG-3’. The thermocycler was set as follows: 2 min at 95°C, then 10 to 12 three-step cycles of 20 s at 95°C, 15 s at 56°C, and 20 s at 68°C, and 1 min final extension at 68°C. The PCR product was then subjected to 2 × 100 bp paired-end sequencing using Illumina HiSeq 2500 platform. We aimed to obtain at least 20 million paired-end reads for each input library and post-selection library such that the average coverage for each variant would be more than 100 paired-end reads. There were 89,075,246 paired-end reads obtained for the input library and 45,587,128 paired-end reads obtained for the post-selection library. Raw sequencing data have been submitted to the NIH Short Read Archive under accession number: BioProject PRJNA278685.</p><p>We were able to compute the fitness for 93.4% of all variants from the sequencing data. The fitness measurements in this study were highly consistent with our previous study on the fitness of single and double mutants in protein GB1 (Pearson correlation = 0.97, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B</xref>) (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>).</p></sec><sec id="s4-4"><title>Sequencing data analysis</title><p>The first three nucleotides of both forward read and reverse read were used for demultiplexing. If the first three nucleotides of the forward read were different from that of the reverse read, the given paired-end read would be discarded. For both forward read and reverse read, the nucleotides that were corresponding to the codons of protein GB1 sites 39, 40, 41, and 54 were extracted. If coding sequence of sites 39, 40, 41, and 54 in the forward read and that in the reverse read did not reverse-complement each other, the paired-end read would be discarded. Subsequently, the occurrence of individual variants at the amino acid level for site 39, 40, 41, and 54 in both input library and selected library were counted, with each paired-end read represented 1 count. Custom python scripts and bash scripts were used for sequencing data processing. All scripts have been deposited to <ext-link ext-link-type="uri" xlink:href="https://github.com/wchnicholas/ProteinGFourMutants">https://github.com/wchnicholas/ProteinGFourMutants</ext-link>.</p></sec><sec id="s4-5"><title>Calculation of fitness</title><p>The fitness (<italic>w</italic>) for a given variant <italic>i</italic> was computed as:<disp-formula id="equ2"><label>(1)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi id="XM18">i</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM19"><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi id="XM20">i</mml:mi><mml:mo>,</mml:mo><mml:mrow id="XM21"><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow id="XM22"><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM23"><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mrow id="XM24"><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM25"><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> represented the count of variant <italic>i</italic> in the selected library, <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> represented the count of variant <italic>i</italic> in the input library, <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> represented the count of WT (VDGV) in the selected library, and <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> represented the count of WT (VDGV) in the input library.</p><p>Therefore, the fitness of each variant, <italic>w<sub>i</sub></italic>, could be viewed as the fitness relative to WT (VDGV), such that = 1. Variants with <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> were filtered to reduce noise. The fraction of all possible variants that passed this filter was 93.4% (149,361 out of 160,000 all possible variants).</p><p>The fitness of each single substitution variant was referenced to our previous study (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>), because the sequencing coverage of single substitution variants in our previous study was much higher than in this study (~100 fold higher). Hence, our confidence in computing fitness for a single substitution variant should also be much higher in our previous study than this study. Subsequently, the fitness of each single substitution in this study was calculated by multiplying a factor of 1.159 by the fitness of that single substitution computed from our previous study (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). This is based on the linear regression analysis between the single substitution fitness as measured in our previous study and in this study, which had a slope of 1.159 and a y-intercept of ~0. The fitness of each profiled variant is shown in <xref ref-type="supplementary-material" rid="SD1-data">Supplementary file 1</xref>.</p></sec><sec id="s4-6"><title>Magnitude and type of pairwise epistasis</title><p>The three types of pairwise epistasis (magnitude, sign and reciprocal sign) were classified by ranking the fitness of the four variants involved (<xref ref-type="bibr" rid="bib15">Greene and Crona, 2014</xref>).</p><p>To quantify the magnitude of epistasis (<inline-formula><mml:math id="inf36"><mml:mi>ε</mml:mi></mml:math></inline-formula>) between substitutions <italic>a</italic> and <italic>b</italic> on a given background variant <italic>BG</italic>, the relative epistasis model (<xref ref-type="bibr" rid="bib25">Khan et al., 2011</xref>) was employed as follows:<disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM34"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM35"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi id="XM36">ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac id="XM37"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi id="XM38">ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac id="XM39"><mml:msub><mml:mi>w</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi id="XM40">ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac id="XM41"><mml:msub><mml:mi>w</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <italic>w</italic><sub>ab</sub> represents the fitness of the double substitution, ln(<italic>w<sub>a</sub></italic>) and ln(<italic>w<sub>b</sub></italic>) represents the fitness of each of the single substitution respectively, and <italic>w<sub>BG</sub></italic> represents the fitness of the background variant.</p><p>As described previously (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>), there exists a limitation in determining the exact fitness for very low-fitness variants in this system. To account for this limitation, several rules were adapted from our previous study to minimize potential artifacts in determining <inline-formula><mml:math id="inf37"><mml:mi>ε</mml:mi></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>). We previously determined that the detection limit of fitness (<italic>w</italic>) in this system is ~0.01 (<xref ref-type="bibr" rid="bib37">Olson et al., 2014</xref>).</p><p>Rule 1) if max(<inline-formula><mml:math id="inf38"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="inf39"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="inf40"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>) <inline-formula><mml:math id="inf41"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.01, <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM42"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM43"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM44"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> = 0</p><p>Rule 2) if min(<italic>w<sub>a</sub></italic>, <italic>w<sub>b</sub></italic>, <inline-formula><mml:math id="inf43"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>, <inline-formula><mml:math id="inf44"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>) <inline-formula><mml:math id="inf45"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.01, <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM45"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM46"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM47"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> = max(0, <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM48"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM49"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>)</p><p>Rule 3) if min(<italic>w<sub>ab</sub></italic>, <inline-formula><mml:math id="inf48"><mml:mfrac><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math></inline-formula>) <inline-formula><mml:math id="inf49"><mml:mo>&lt;</mml:mo></mml:math></inline-formula> 0.01, <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM50"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM51"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM52"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> = min(0, <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM53"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM54"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>)</p><p>Rule 1 prevents epistasis being artificially estimated from low-fitness variants. Rule 2 prevents overestimation of epistasis due to low fitness of one of the two single substitutions. Rule 3 prevents underestimation of epistasis due to low fitness of the double substitution. Of note, <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM55"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM56"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM57"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> was set to 0 if both Rule 2 and Rule 3 were satisfied. To compute the epistasis between two substitutions, <italic>a</italic> and <italic>b</italic>, on a given background variant <italic>BG</italic>, <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM58"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM59"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM60"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> would be used if any one of the above three rules was satisfied. Otherwise, <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>ε</mml:mi><mml:mrow><mml:mrow id="XM61"><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM62"><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> would be used.</p></sec><sec id="s4-7"><title>Fourier analysis</title><p>Fitness decomposition was performed on all subgraphs without missing variants (109,235 subgraphs in total). We decomposed the fitness landscape into epistatic interactions of different orders by Fourier analysis (<xref ref-type="bibr" rid="bib55">Stadler, 1996</xref>; <xref ref-type="bibr" rid="bib57">Szendro et al., 2013</xref>; <xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib35">Neidhart et al., 2013</xref>). The Fourier coefficients given by the transform can be interpreted as epistasis of different orders (<xref ref-type="bibr" rid="bib64">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>).</p><p>For a binary sequence <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> with dimension <inline-formula><mml:math id="inf56"><mml:mi>L</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf57"><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> equals 1 if mutation is present at position <inline-formula><mml:math id="inf58"><mml:mi>i</mml:mi></mml:math></inline-formula>, or 0 otherwise), the Fourier decomposition theorem states that the fitness function <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true" id="XM63"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be expressed as (<xref ref-type="bibr" rid="bib62">Weinberger, 1991</xref>):<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true" id="XM64"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM65"><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The formula for the Fourier coefficients <inline-formula><mml:math id="inf60"><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:msub></mml:math></inline-formula> is then:<disp-formula id="equ5"><label>(4)</label><mml:math id="m5"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:munder><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:munder><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true" id="XM66"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM67"><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mi>k</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>For example, we can expand the fitness landscape up to the second order, i.e. with linear and quadratic terms<disp-formula id="equ6"><label>(5)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≡</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow id="XM69"><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow id="XM72"><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow id="XM73"><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf62"><mml:mover accent="true"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mover></mml:math></inline-formula> is a unit vector along the <inline-formula><mml:math id="inf63"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> direction. In our analysis of subgraphs, there are a total of <inline-formula><mml:math id="inf64"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math></inline-formula> terms in the Fourier decomposition, with <inline-formula><mml:math id="inf65"><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="+1"><mml:mtable columnspacing="0.4em" rowspacing="0.2ex"><mml:mtr><mml:mtd><mml:mn id="S1.SSx17.p1.m11.xm1">4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi id="S1.SSx17.p1.m11.xm2">i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> terms for the <inline-formula><mml:math id="inf66"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> order (<inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn id="XM75">0</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM76">1</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM77">2</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM78">3</mml:mn><mml:mo>,</mml:mo><mml:mn id="XM79">4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). We can expand the fitness landscape up to a given order by ignoring all higher-order terms in <xref ref-type="disp-formula" rid="equ4">Equation 3</xref>. In this paper, we refer to higher-order epistasis as non-zero contribution to fitness from the third order terms and beyond.</p></sec><sec id="s4-8"><title>Imputing the fitness of missing variants</title><p>The fitness values for 10,639 variants (6.6% of the entire sequence space) were not directly measured (read count in the input pool = 0) or were filtered out because of low read counts in the input pool (see section “Calculation of fitness”). To impute the fitness of these missing variants, we performed regularized regression on fitness values of observed variants using the following model (<xref ref-type="bibr" rid="bib20">Hinkley et al., 2011</xref>; <xref ref-type="bibr" rid="bib41">Otwinowski and Plotkin, 2014</xref>):<disp-formula id="equ7"><label>(6)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi id="XM80">f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf68"><mml:mi>f</mml:mi></mml:math></inline-formula> is the protein fitness. <inline-formula><mml:math id="inf69"><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is the intercept that represents the log fitness of WT; <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> represents the main effect of a single mutation, <italic>i; M<sub>i</sub></italic> is a dummy variable that equals 1 if the single mutation <inline-formula><mml:math id="inf71"><mml:mi>i</mml:mi></mml:math></inline-formula> is present in the sequence, or 0 if the single mutation is absent; and <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>19</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="+1"><mml:mtable columnspacing="0.4em" rowspacing="0.2ex"><mml:mtr><mml:mtd><mml:mn id="S1.SSx18.p1.m7.xm1">4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn id="S1.SSx18.p1.m7.xm2">1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>76</mml:mn></mml:mrow></mml:math></inline-formula> is the total number of single mutations. Similarly, <inline-formula><mml:math id="inf73"><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> represents the effect of interaction between a pair of mutations; <inline-formula><mml:math id="inf74"><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> is the dummy variable that equals either 1 or 0 depending on the presence of that those two mutations; and <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mn>19</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle scriptlevel="+1"><mml:mtable columnspacing="0.4em" rowspacing="0.2ex"><mml:mtr><mml:mtd><mml:mn id="S1.SSx18.p1.m10.xm1">4</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn id="S1.SSx18.p1.m10.xm2">2</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>2166</mml:mn></mml:mrow></mml:math></inline-formula> is the total number of possible pairwise interactions. In addition to the main effects of single mutations and pairwise interactions, the three-way interactions among sites 39, 41 and 54 are included in the model, based on our knowledge of higher-order epistasis (<xref ref-type="fig" rid="fig3">Figure 3</xref>). <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>δ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> represents the effect of three-way interactions among sites 39, 41 and 54; <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> is the dummy variable that equals either 1 or 0 depending on the presence of that three-way interaction; and <inline-formula><mml:math id="inf78"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>19</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>6859</mml:mn></mml:mrow></mml:math></inline-formula> is the total number of three-way interactions. Thus, the total number of coefficients in this model is 9102, including main effects of each site (i.e. additive effects), interactions between pairs of sites (i.e. pairwise epistasis), and a subset of three-way interactions (i.e. higher-order epistasis).</p><p>Out of the 149,361 variants with experimentally measured fitness values, 119,884 variants were non-lethal (<inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and were used to fit the model coefficients using lasso regression (Matlab R2014b). Lasso regression adds a penalty term <inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mi id="XM83">θ</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf81"><mml:mi>θ</mml:mi></mml:math></inline-formula> stands for any coefficient in the model) when minimizing the least squares, thus it favors sparse solutions of coefficients (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>). We calculated the 10-fold cross-validation MSE (mean squared errors) of the lasso regression for a wide range of penalty parameter <inline-formula><mml:math id="inf82"><mml:mi>λ</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>). <inline-formula><mml:math id="inf83"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is chosen. For measured variants, the model-predicted fitness values were highly correlated with the actual fitness values (Pearson correlation=0.93, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). We then used the fitted model to impute the fitness of the 10,639 missing variants and complete the entire fitness landscape. Imputed fitness values for missing variants are listed in <xref ref-type="supplementary-material" rid="SD2-data">Supplementary file 2</xref>.</p></sec><sec id="s4-9"><title>Simulating adaptation using three models for fixation</title><p>Python package “networkx” was employed to construct a directed graph that represented the entire fitness landscape for sites 39, 40, 41, and 54. A total of 20<sup>4</sup> = 160,000 nodes were present in the directed graph, where each node represented a 4-site variant. For all pairs of variants separated by a Hamming distance of 1, a directed edge was generated from the variant with a lower fitness to the variant with a higher fitness. Therefore, all successors of a given node had a higher fitness than the given node. A fitness peak was defined as a node that had 0 out-degree. Three models, namely the Greedy Model (<xref ref-type="bibr" rid="bib6">de Visser and Krug, 2014</xref>), the Correlated Fixation Model (<xref ref-type="bibr" rid="bib14">Gillespie, 1984</xref>), and the Equal Fixation Model (<xref ref-type="bibr" rid="bib63">Weinreich et al., 2006</xref>), were employed in this study to simulate the mutational steps in adaptive trajectories. Under all three models, the probability of fixation of a deleterious or neutral mutation is 0. Considering a mutational trajectory initiated at a node, n<italic><sub>i</sub></italic> with a fitness value of w<italic><sub>i</sub></italic>, where n<italic><sub>i</sub></italic> has M successors, (n<sub>1</sub>, n<sub>2</sub>, … n<sub>M</sub>) with fitness values of (<italic>w</italic><sub>1</sub>, <italic>w</italic><sub>2</sub>, … <italic>w</italic><sub>M</sub>). Then the probability that the next mutational step is from n<italic><sub>i</sub></italic> to n<italic><sub>k</sub></italic>, where <italic>k</italic> <inline-formula><mml:math id="inf84"><mml:mo>∈</mml:mo></mml:math></inline-formula> (1, 2, … M), is denoted P<italic><sub>i→k</sub></italic> and called the probability of fixation, and can be computed for each model as follows.</p><p>For the Greedy Model (deterministic model),<disp-formula id="equ8"><label>(7)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>if</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub id="XM84"><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub id="XM85"><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow id="XM86"><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mtext>M</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mpadded width="+5pt"><mml:mtext>,</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></disp-formula><disp-formula id="equ9"><label>(8)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mpadded width="+5pt"><mml:mtext>otherwise,</mml:mtext></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>For the Correlated Fixation Model (non-deterministic model),<disp-formula id="equ10"><label>(9)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>M</mml:mtext></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the Equal Fixation Model (non-deterministic model),<disp-formula id="equ11"><label>(10)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mtext>M</mml:mtext></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To compute the shortest path from a given variant to all reachable variants, the function “single<inline-formula><mml:math id="inf85"><mml:mi mathvariant="normal">_</mml:mi></mml:math></inline-formula>source<inline-formula><mml:math id="inf86"><mml:mi mathvariant="normal">_</mml:mi></mml:math></inline-formula>shortest<inline-formula><mml:math id="inf87"><mml:mi mathvariant="normal">_</mml:mi></mml:math></inline-formula>path” in “networkx” was used. If the shortest path between a low-fitness variant and a high-fitness variant does not exist, it means that the high-fitness variant is inaccessible. If the length of the shortest path is larger than the Hamming distance between two variants, it means that adaptation requires indirect paths.</p><p>Under constraints imposed by the standard genetic code, the connectivity of the directed graph that represented the fitness landscape was restricted according to the matrix shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>. The genetic distance between two variants was calculated according to the matrix shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>. If the length of the shortest path is larger than the genetic distance between two variants, it means that adaptation requires indirect paths.</p></sec><sec id="s4-10"><title>Analysis of direct paths within a subgraph</title><p>In the subgraph analysis shown in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>, the fitness landscape was restricted to 2 amino acids at each of the 4 sites (the WT and adapted alleles). There was a total of 2<sup>4</sup> variants, hence nodes, in a given subgraph. Only those subgraphs where the fitness of all variants was measured directly were used (i.e. any subgraph with missing variants was excluded from this analysis). Mutational trajectories were generated in the same manner as in the analysis of the entire fitness landscape (see subsection “Simulating adaptation using three models for fixation”). In a subgraph with only one fitness peak, the probability of a mutational trajectory from node <italic>i</italic> to node <italic>j</italic> via intermediate <italic>a</italic>, <italic>b</italic>, and <italic>c</italic> was as follows:<disp-formula id="equ12"><label>(11)</label><mml:math id="m12"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:mi>b</mml:mi><mml:mo>→</mml:mo><mml:mi>c</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>→</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>→</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>→</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>→</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>To compute the Gini index for a given set of mutational trajectories from node <italic>i</italic> to node <italic>j</italic>, the probabilities of all possible mutational trajectories were sorted from large to small. Inaccessible trajectories were also included in this sorted list with a probability of 0. This sorted list with <italic>t</italic> trajectories was denoted as (<inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, … <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), where <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> was the largest and <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> was the smallest. This sorted list was converted into a list of cumulative probabilities, which is denoted as (<inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, … <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), where <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>The Gini index for the given subgraph was then computed as follows:<disp-formula id="equ13"><label>(12)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext>Gini</mml:mtext><mml:mtext> </mml:mtext><mml:mtext>index</mml:mtext><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s4-11"><title>Visualization</title><p>Sequence logo was generated by WebLogo (<ext-link ext-link-type="uri" xlink:href="http://weblogo.berkeley.edu/logo.cgi">http://weblogo.berkeley.edu/logo.cgi</ext-link>) (<xref ref-type="bibr" rid="bib4">Crooks et al., 2004</xref>). The visualization of basins of attraction (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) was generated using Graphviz with “fdp” as the option for layout.</p></sec><sec id="s4-12"><title><inline-formula><mml:math id="inf98"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math></inline-formula>G prediction</title><p>The <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:math></inline-formula>G prediction was performed by the ddg<inline-formula><mml:math id="inf100"><mml:mi mathvariant="normal">_</mml:mi></mml:math></inline-formula>monomer application in Rosetta software (<xref ref-type="bibr" rid="bib5">Das and Baker, 2008</xref>) using the parameters from row 16 of Table I in Kellogg et al. (<xref ref-type="bibr" rid="bib24">Kellogg et al., 2011</xref>).</p></sec><sec id="s4-13"><title>Extra-dimensional bypass is mediated by higher-order epistasis</title><p>Here we prove that higher-order epistasis is required for two possible scenarios of extra-dimensional bypass via an additional site (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). For a fitness landscape defined on a Boolean hypercube, we can expand the fitness as Taylor series (<xref ref-type="bibr" rid="bib62">Weinberger, 1991</xref>).<disp-formula id="equ14"><label>(13)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>011</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>101</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>110</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mn>111</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>123</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To prove that higher-order epistasis is present is equivalent to prove that <inline-formula><mml:math id="inf101"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>123</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. The fitness difference between neighbors is visualized by the directed edges that go from low-fitness variant to high-fitness variant, thus each edge represents an inequality. No cyclic paths are allowed in this directed graph.</p><p>The reciprocal sign epistasis (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) gives,<disp-formula id="equ15"><label>(14)</label><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>000</mml:mn><mml:mo stretchy="false">←</mml:mo><mml:mn>001</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ16"><label>(15)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>000</mml:mn><mml:mo stretchy="false">←</mml:mo><mml:mn>010</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ17"><label>(16)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>001</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>011</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><label>(17)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>010</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>011</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The detour step (<inline-formula><mml:math id="inf102"><mml:mrow><mml:mn>000</mml:mn><mml:mo>→</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula>) and the loss step (<inline-formula><mml:math id="inf103"><mml:mrow><mml:mn>111</mml:mn><mml:mo>→</mml:mo><mml:mn>011</mml:mn></mml:mrow></mml:math></inline-formula>) are required for extra-dimensional bypass,<disp-formula id="equ19"><label>(18)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>000</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>100</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(19)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>011</mml:mn><mml:mo stretchy="false">←</mml:mo><mml:mn>111</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>123</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the remaining 6 edges, there are 3 possible configurations (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B–D</xref>). For the scenario illustrated in (<bold>B</bold>), we have<disp-formula id="equ21"><label>(20)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>101</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ22"><label>(21)</label><mml:math id="m22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>100</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>110</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining inequality (14) and (20) gives<disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining inequality (15) and (21) gives<disp-formula id="equ24"><label>(23)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining the above two inequalities with (18) and (19), we arrive at<disp-formula id="equ25"><label>(24)</label><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>123</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the scenario in (<bold>C</bold>), the proof of higher-order epistasis is similar. We have (the yellow edge)<disp-formula id="equ26"><label>(25)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>001</mml:mn><mml:mo stretchy="false">→</mml:mo><mml:mn>101</mml:mn><mml:mo>:</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Combining the above inequality with (15), (19) and (21), we arrive at<disp-formula id="equ27"><label>(26)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>123</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For the scenario in (<bold>D</bold>), when <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, all the inequalities can be satisfied with <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>123</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. So higher-order epistasis is not necessary in this case.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Jesse Bloom and Joshua Plotkin for helpful comments on early versions of the manuscript. NCW was supported by Philip Whitcome Pre-Doctoral Fellowship, Audree Fowler Fellowship in Protein Science, and UCLA Dissertation Year Fellowship. LD was supported by HHMI Postdoctoral Fellowship from Jane Coffin Childs Memorial Fund for Medical Research. RS was supported by NIH R01 DE023591. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>NCW, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>LD, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con3"><p>CAO, Conception and design, Acquisition of data</p></fn><fn fn-type="con" id="con4"><p>JOL-S, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con5"><p>RS, Conception and design, Drafting or revising the article</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.16965.024</object-id><label>Supplementary file 1.</label><caption><title>The fitness of each profiled variant.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.024">http://dx.doi.org/10.7554/eLife.16965.024</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-16965-supp1-v4.xlsx"/></supplementary-material><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.16965.025</object-id><label>Supplementary file 2.</label><caption><title>Imputed fitness values for missing variants.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.16965.025">http://dx.doi.org/10.7554/eLife.16965.025</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-16965-supp2-v4.xlsx"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following dataset was generated:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA278685/" source-id-type="uri"><collab>Wu NC</collab><x>,</x> <collab>Dai L</collab><x>,</x> <collab>Olson CA</collab><x>,</x> <collab>Lloyd-Smith JO</collab><x>,</x> <collab>Sun R</collab><x>,</x> <year>2015</year><x>,</x><source>Streptococcus dysgalactiae strain:GB1_AO</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA278685/">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA278685/</ext-link><x>,</x> <comment>Publicly available at the NCBI Gene Expression Omnibus (Accession no: PRJNA278685)</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>JP</given-names></name><name><surname>Kardar</surname><given-names>M</given-names></name><name><surname>Chakraborty</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Scaling laws describe memories of host–pathogen riposte in the HIV population</article-title><source>PNAS</source><volume>112</volume><fpage>1965</fpage><lpage>1970</lpage><pub-id pub-id-type="doi">10.1073/pnas.1415386112</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berestycki</surname><given-names>J</given-names></name><name><surname>Brunet</surname><given-names>É</given-names></name><name><surname>Shi</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Accessibility percolation with backsteps</article-title><source>arXiv</source><elocation-id>1401.6894</elocation-id><uri xlink:href="http://arxiv.org/abs/1401.6894">http://arxiv.org/abs/1401.6894</uri></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cariani</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Extradimensional bypass</article-title><source>Biosystems</source><volume>64</volume><fpage>47</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1016/S0303-2647(01)00174-5</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crooks</surname><given-names>GE</given-names></name><name><surname>Hon</surname><given-names>G</given-names></name><name><surname>Chandonia</surname><given-names>JM</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>WebLogo: a sequence logo generator</article-title><source>Genome Research</source><volume>14</volume><fpage>1188</fpage><lpage>1190</lpage><pub-id pub-id-type="doi">10.1101/gr.849004</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>R</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Macromolecular modeling with rosetta</article-title><source>Annual Review of Biochemistry</source><volume>77</volume><fpage>363</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1146/annurev.biochem.77.062906.171838</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname><given-names>JA</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nrg3744</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>MA</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name><name><surname>Weinreich</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Mutational reversions during adaptive protein evolution</article-title><source>Molecular Biology and Evolution</source><volume>24</volume><fpage>1608</fpage><lpage>1610</lpage><pub-id pub-id-type="doi">10.1093/molbev/msm118</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desai</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Statistical questions in experimental evolution</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2013</volume><elocation-id>P01003</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2013/01/P01003</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>D</given-names></name><name><surname>Lässig</surname><given-names>M</given-names></name><name><surname>Shraiman</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Evolutionary dynamics and statistical physics</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2013</volume><elocation-id>N01001</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2013/01/N01001</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fowler</surname><given-names>DM</given-names></name><name><surname>Araya</surname><given-names>CL</given-names></name><name><surname>Fleishman</surname><given-names>SJ</given-names></name><name><surname>Kellogg</surname><given-names>EH</given-names></name><name><surname>Stephany</surname><given-names>JJ</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name><name><surname>Fields</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>High-resolution mapping of protein sequence-function relationships</article-title><source>Nature Methods</source><volume>7</volume><fpage>741</fpage><lpage>746</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1492</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franke</surname><given-names>J</given-names></name><name><surname>Klözer</surname><given-names>A</given-names></name><name><surname>de Visser</surname><given-names>JA</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Evolutionary accessibility of mutational pathways</article-title><source>PLOS Computational Biology</source><volume>7</volume><elocation-id>e1002134</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002134</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallagher</surname><given-names>T</given-names></name><name><surname>Alexander</surname><given-names>P</given-names></name><name><surname>Bryan</surname><given-names>P</given-names></name><name><surname>Gilliland</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Two crystal structures of the B1 immunoglobulin-binding domain of streptococcal protein G and comparison with NMR</article-title><source>Biochemistry</source><volume>33</volume><fpage>4721</fpage><lpage>4729</lpage><pub-id pub-id-type="doi">10.1021/bi00181a032</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gavrilets</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Evolution and speciation on holey adaptive landscapes</article-title><source>Trends in Ecology &amp; Evolution</source><volume>12</volume><fpage>307</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1016/S0169-5347(97)01098-7</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Molecular evolution over the mutational landscape</article-title><source>Evolution</source><volume>38</volume><fpage>1116</fpage><lpage>1129</lpage><pub-id pub-id-type="doi">10.2307/2408444</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greene</surname><given-names>D</given-names></name><name><surname>Crona</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The changing geometry of a fitness landscape along an adaptive walk</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003520</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003520</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutiérrez</surname><given-names>J</given-names></name><name><surname>Maere</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Modeling the evolution of molecular systems from a mechanistic perspective</article-title><source>Trends in Plant Science</source><volume>19</volume><fpage>292</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1016/j.tplants.2014.03.004</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>What can we learn from fitness landscapes?</article-title><source>Current Opinion in Microbiology</source><volume>21</volume><fpage>51</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1016/j.mib.2014.08.001</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hietpas</surname><given-names>RT</given-names></name><name><surname>Jensen</surname><given-names>JD</given-names></name><name><surname>Bolon</surname><given-names>DNA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Experimental illumination of a fitness landscape</article-title><source>PNAS</source><volume>108</volume><fpage>7896</fpage><lpage>7901</lpage><pub-id pub-id-type="doi">10.1073/pnas.1016024108</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hingorani</surname><given-names>KS</given-names></name><name><surname>Gierasch</surname><given-names>LM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Comparing protein folding in vitro and in vivo: foldability meets the fitness challenge</article-title><source>Current Opinion in Structural Biology</source><volume>24</volume><fpage>81</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/j.sbi.2013.11.007</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinkley</surname><given-names>T</given-names></name><name><surname>Martins</surname><given-names>J</given-names></name><name><surname>Chappey</surname><given-names>C</given-names></name><name><surname>Haddad</surname><given-names>M</given-names></name><name><surname>Stawiski</surname><given-names>E</given-names></name><name><surname>Whitcomb</surname><given-names>JM</given-names></name><name><surname>Petropoulos</surname><given-names>CJ</given-names></name><name><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A systems analysis of mutational effects in HIV-1 protease and reverse transcriptase</article-title><source>Nature Genetics</source><volume>43</volume><fpage>487</fpage><lpage>489</lpage><pub-id pub-id-type="doi">10.1038/ng.795</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquier</surname><given-names>H</given-names></name><name><surname>Birgy</surname><given-names>A</given-names></name><name><surname>Le Nagard</surname><given-names>H</given-names></name><name><surname>Mechulam</surname><given-names>Y</given-names></name><name><surname>Schmitt</surname><given-names>E</given-names></name><name><surname>Glodt</surname><given-names>J</given-names></name><name><surname>Bercot</surname><given-names>B</given-names></name><name><surname>Petit</surname><given-names>E</given-names></name><name><surname>Poulain</surname><given-names>J</given-names></name><name><surname>Barnaud</surname><given-names>G</given-names></name><name><surname>Gros</surname><given-names>P-A</given-names></name><name><surname>Tenaillon</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Capturing the mutational landscape of the beta-lactamase TEM-1</article-title><source>PNAS</source><volume>110</volume><fpage>13067</fpage><lpage>13072</lpage><pub-id pub-id-type="doi">10.1073/pnas.1215206110</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiménez</surname><given-names>JI</given-names></name><name><surname>Xulvi-Brunet</surname><given-names>R</given-names></name><name><surname>Campbell</surname><given-names>GW</given-names></name><name><surname>Turk-MacLeod</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>IA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Comprehensive experimental fitness landscape and evolutionary network for small RNA</article-title><source>PNAS</source><volume>110</volume><fpage>14984</fpage><lpage>14989</lpage><pub-id pub-id-type="doi">10.1073/pnas.1307604110</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kauffman</surname><given-names>S</given-names></name><name><surname>Levin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Towards a general theory of adaptive walks on rugged landscapes</article-title><source>Journal of Theoretical Biology</source><volume>128</volume><fpage>11</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1016/S0022-5193(87)80029-2</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kellogg</surname><given-names>EH</given-names></name><name><surname>Leaver-Fay</surname><given-names>A</given-names></name><name><surname>Baker</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Role of conformational sampling in computing mutation-induced changes in protein structure and stability</article-title><source>Proteins: Structure, Function, and Bioinformatics</source><volume>79</volume><fpage>830</fpage><lpage>838</lpage><pub-id pub-id-type="doi">10.1002/prot.22921</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>AI</given-names></name><name><surname>Dinh</surname><given-names>DM</given-names></name><name><surname>Schneider</surname><given-names>D</given-names></name><name><surname>Lenski</surname><given-names>RE</given-names></name><name><surname>Cooper</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title><source>Science</source><volume>332</volume><fpage>1193</fpage><lpage>1196</lpage><pub-id pub-id-type="doi">10.1126/science.1203801</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kondrashov</surname><given-names>DA</given-names></name><name><surname>Kondrashov</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Topological features of rugged fitness landscapes in sequence space</article-title><source>Trends in Genetics</source><volume>31</volume><fpage>24</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2014.09.009</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kouyos</surname><given-names>RD</given-names></name><name><surname>Leventhal</surname><given-names>GE</given-names></name><name><surname>Hinkley</surname><given-names>T</given-names></name><name><surname>Haddad</surname><given-names>M</given-names></name><name><surname>Whitcomb</surname><given-names>JM</given-names></name><name><surname>Petropoulos</surname><given-names>CJ</given-names></name><name><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Exploring the complexity of the HIV-1 fitness landscape</article-title><source>PLOS Genetics</source><volume>8</volume><elocation-id>e1002551</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002551</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kvitek</surname><given-names>DJ</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reciprocal sign epistasis between frequently experimentally evolved adaptive mutations causes a rugged fitness landscape</article-title><source>PLOS Genetics</source><volume>7</volume><elocation-id>e1002056</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002056</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Phase transition for accessibility percolation on hypercubes</article-title><source>arXiv</source><elocation-id>1502.07642</elocation-id><uri xlink:href="https://arxiv.org/abs/1502.07642">https://arxiv.org/abs/1502.07642</uri></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>R</given-names></name><name><surname>Barrick</surname><given-names>JE</given-names></name><name><surname>Szostak</surname><given-names>JW</given-names></name><name><surname>Roberts</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Optimized synthesis of RNA-protein fusions for in vitro protein selection</article-title><source>Methods in Enzymology</source><volume>318</volume><fpage>268</fpage><lpage>293</lpage><pub-id pub-id-type="doi">10.1016/s0076-6879(00)18058-9</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozovsky</surname><given-names>ER</given-names></name><name><surname>Chookajorn</surname><given-names>T</given-names></name><name><surname>Brown</surname><given-names>KM</given-names></name><name><surname>Imwong</surname><given-names>M</given-names></name><name><surname>Shaw</surname><given-names>PJ</given-names></name><name><surname>Kamchonwongpaisan</surname><given-names>S</given-names></name><name><surname>Neafsey</surname><given-names>DE</given-names></name><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Stepwise acquisition of pyrimethamine resistance in the malaria parasite</article-title><source>PNAS</source><volume>106</volume><fpage>12025</fpage><lpage>12030</lpage><pub-id pub-id-type="doi">10.1073/pnas.0905922106</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lunzer</surname><given-names>M</given-names></name><name><surname>Miller</surname><given-names>SP</given-names></name><name><surname>Felsheim</surname><given-names>R</given-names></name><name><surname>Dean</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>The biochemical architecture of an ancient adaptive landscape</article-title><source>Science</source><volume>310</volume><fpage>499</fpage><lpage>501</lpage><pub-id pub-id-type="doi">10.1126/science.1115649</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martinsson</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Accessibility percolation and first-passage site percolation on the unoriented binary hypercube</article-title><source>arXiv</source><elocation-id>1501.02206</elocation-id><uri xlink:href="http://arxiv.org/abs/1501.02206">http://arxiv.org/abs/1501.02206</uri></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Natarajan</surname><given-names>C</given-names></name><name><surname>Inoguchi</surname><given-names>N</given-names></name><name><surname>Weber</surname><given-names>RE</given-names></name><name><surname>Fago</surname><given-names>A</given-names></name><name><surname>Moriyama</surname><given-names>H</given-names></name><name><surname>Storz</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Epistasis among adaptive mutations in deer mouse hemoglobin</article-title><source>Science</source><volume>340</volume><fpage>1324</fpage><lpage>1327</lpage><pub-id pub-id-type="doi">10.1126/science.1236862</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neidhart</surname><given-names>J</given-names></name><name><surname>Szendro</surname><given-names>IG</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Exact results for amplitude spectra of fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>332</volume><fpage>218</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2013.05.002</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>CA</given-names></name><name><surname>Nie</surname><given-names>J</given-names></name><name><surname>Diep</surname><given-names>J</given-names></name><name><surname>Al-Shyoukh</surname><given-names>I</given-names></name><name><surname>Takahashi</surname><given-names>TT</given-names></name><name><surname>Al-Mawsawi</surname><given-names>LQ</given-names></name><name><surname>Bolin</surname><given-names>JM</given-names></name><name><surname>Elwell</surname><given-names>AL</given-names></name><name><surname>Swanson</surname><given-names>S</given-names></name><name><surname>Stewart</surname><given-names>R</given-names></name><name><surname>Thomson</surname><given-names>JA</given-names></name><name><surname>Soh</surname><given-names>HT</given-names></name><name><surname>Roberts</surname><given-names>RW</given-names></name><name><surname>Sun</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Single-round, multiplexed antibody mimetic design through mRNA display</article-title><source>Angewandte Chemie International Edition</source><volume>51</volume><fpage>12449</fpage><lpage>12453</lpage><pub-id pub-id-type="doi">10.1002/anie.201207005</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>CA</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Sun</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A comprehensive biophysical description of pairwise epistasis throughout an entire protein domain</article-title><source>Current Biology</source><volume>24</volume><fpage>2643</fpage><lpage>2651</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2014.09.072</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orr</surname><given-names>HA</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The population genetics of adaptation: the adaptation of DNA sequences</article-title><source>Evolution</source><volume>56</volume><fpage>1317</fpage><lpage>1330</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2002.tb01446.x</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orr</surname><given-names>HA</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A minimum on the mean number of steps taken in adaptive walks</article-title><source>Journal of Theoretical Biology</source><volume>220</volume><fpage>241</fpage><lpage>247</lpage><pub-id pub-id-type="doi">10.1006/jtbi.2003.3161</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ostman</surname><given-names>B</given-names></name><name><surname>Hintze</surname><given-names>A</given-names></name><name><surname>Adami</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Impact of epistasis and pleiotropy on evolutionary adaptation</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>279</volume><fpage>247</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1098/rspb.2011.0870</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otwinowski</surname><given-names>J</given-names></name><name><surname>Plotkin</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Inferring fitness landscapes by regression produces biased estimates of epistasis</article-title><source>PNAS</source><volume>111</volume><fpage>E2301</fpage><lpage>E2309</lpage><pub-id pub-id-type="doi">10.1073/pnas.1400849111</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Maille</surname><given-names>PE</given-names></name><name><surname>Malone</surname><given-names>A</given-names></name><name><surname>Dellas</surname><given-names>N</given-names></name><name><surname>Andes Hess</surname><given-names>B</given-names></name><name><surname>Smentek</surname><given-names>L</given-names></name><name><surname>Sheehan</surname><given-names>I</given-names></name><name><surname>Greenhagen</surname><given-names>BT</given-names></name><name><surname>Chappell</surname><given-names>J</given-names></name><name><surname>Manning</surname><given-names>G</given-names></name><name><surname>Noel</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Quantitative exploration of the catalytic landscape separating divergent plant sesquiterpene synthases</article-title><source>Nature Chemical Biology</source><volume>4</volume><fpage>617</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1038/nchembio.113</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pál</surname><given-names>G</given-names></name><name><surname>Kouadio</surname><given-names>JL</given-names></name><name><surname>Artis</surname><given-names>DR</given-names></name><name><surname>Kossiakoff</surname><given-names>AA</given-names></name><name><surname>Sidhu</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Comprehensive and quantitative mapping of energy landscapes for protein-protein interactions by rapid combinatorial scanning</article-title><source>Journal of Biological Chemistry</source><volume>281</volume><fpage>22378</fpage><lpage>22385</lpage><pub-id pub-id-type="doi">10.1074/jbc.M603826200</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palmer</surname><given-names>AC</given-names></name><name><surname>Toprak</surname><given-names>E</given-names></name><name><surname>Baym</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Veres</surname><given-names>A</given-names></name><name><surname>Bershtein</surname><given-names>S</given-names></name><name><surname>Kishony</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Delayed commitment to evolutionary fate in antibiotic resistance fitness landscapes</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>7385</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms8385</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payne</surname><given-names>JL</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The robustness and evolvability of transcription factor binding sites</article-title><source>Science</source><volume>343</volume><fpage>875</fpage><lpage>877</lpage><pub-id pub-id-type="doi">10.1126/science.1249046</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pettersson</surname><given-names>M</given-names></name><name><surname>Besnier</surname><given-names>F</given-names></name><name><surname>Siegel</surname><given-names>PB</given-names></name><name><surname>Carlborg</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Replication and explorations of high-order epistasis using a large advanced intercross line pedigree</article-title><source>PLOS Genetics</source><volume>7</volume><elocation-id>e1002180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1002180</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pitt</surname><given-names>JN</given-names></name><name><surname>Ferré-D'Amaré</surname><given-names>AR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Rapid construction of empirical RNA fitness landscapes</article-title><source>Science</source><volume>330</volume><fpage>376</fpage><lpage>379</lpage><pub-id pub-id-type="doi">10.1126/science.1192001</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname><given-names>FJ</given-names></name><name><surname>Kiviet</surname><given-names>DJ</given-names></name><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Tans</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Empirical fitness landscapes reveal accessible evolutionary paths</article-title><source>Nature</source><volume>445</volume><fpage>383</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nature05451</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>H</given-names></name><name><surname>Olson</surname><given-names>CA</given-names></name><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Ke</surname><given-names>R</given-names></name><name><surname>Loverdo</surname><given-names>C</given-names></name><name><surname>Chu</surname><given-names>V</given-names></name><name><surname>Truong</surname><given-names>S</given-names></name><name><surname>Remenyi</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>Z</given-names></name><name><surname>Du</surname><given-names>Y</given-names></name><name><surname>Su</surname><given-names>SY</given-names></name><name><surname>Al-Mawsawi</surname><given-names>LQ</given-names></name><name><surname>Wu</surname><given-names>TT</given-names></name><name><surname>Chen</surname><given-names>SH</given-names></name><name><surname>Lin</surname><given-names>CY</given-names></name><name><surname>Zhong</surname><given-names>W</given-names></name><name><surname>Lloyd-Smith</surname><given-names>JO</given-names></name><name><surname>Sun</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Tang</surname><given-names>N</given-names></name><name><surname>Zhu</surname><given-names>P</given-names></name><name><surname>Ma</surname><given-names>L</given-names></name><name><surname>Cheng</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Lu</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>H</given-names></name><name><surname>Ding</surname><given-names>SW</given-names></name><name><surname>Li</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A quantitative high-resolution genetic profile rapidly identifies sequence determinants of hepatitis C viral fitness and drug sensitivity</article-title><source>PLOS Pathogens</source><volume>10</volume><elocation-id>e1004064</elocation-id><pub-id pub-id-type="doi">10.1371/journal.ppat.1004064</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>RW</given-names></name><name><surname>Szostak</surname><given-names>JW</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>RNA-peptide fusions for the in vitro selection of peptides and proteins</article-title><source>PNAS</source><volume>94</volume><fpage>12297</fpage><lpage>12302</lpage><pub-id pub-id-type="doi">10.1073/pnas.94.23.12297</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Romero</surname><given-names>PA</given-names></name><name><surname>Arnold</surname><given-names>FH</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Exploring protein fitness landscapes by directed evolution</article-title><source>Nature Reviews Molecular Cell Biology</source><volume>10</volume><fpage>866</fpage><lpage>876</lpage><pub-id pub-id-type="doi">10.1038/nrm2805</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sauer-Eriksson</surname><given-names>AE</given-names></name><name><surname>Kleywegt</surname><given-names>GJ</given-names></name><name><surname>Uhlén</surname><given-names>M</given-names></name><name><surname>Jones</surname><given-names>TA</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Crystal structure of the C2 fragment of streptococcal protein G in complex with the Fc domain of human IgG</article-title><source>Structure</source><volume>3</volume><fpage>265</fpage><lpage>278</lpage><pub-id pub-id-type="doi">10.1016/S0969-2126(01)00157-5</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sjöbring</surname><given-names>U</given-names></name><name><surname>Björck</surname><given-names>L</given-names></name><name><surname>Kastern</surname><given-names>W</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Streptococcal protein G. Gene structure and protein binding properties</article-title><source>The Journal of Biological Chemistry</source><volume>266</volume><fpage>399</fpage><lpage>405</lpage></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Natural selection and the concept of a protein space</article-title><source>Nature</source><volume>225</volume><fpage>563</fpage><lpage>564</lpage><pub-id pub-id-type="doi">10.1038/225563a0</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stadler</surname><given-names>PF</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Landscapes and their correlation functions</article-title><source>Journal of Mathematical Chemistry</source><volume>20</volume><fpage>1</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1007/BF01165154</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stiffler</surname><given-names>MA</given-names></name><name><surname>Hekstra</surname><given-names>DR</given-names></name><name><surname>Ranganathan</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Evolvability as a function of purifying selection in TEM-1 β-lactamase</article-title><source>Cell</source><volume>160</volume><fpage>882</fpage><lpage>892</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2015.01.035</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szendro</surname><given-names>IG</given-names></name><name><surname>Schenk</surname><given-names>MF</given-names></name><name><surname>Franke</surname><given-names>J</given-names></name><name><surname>Krug</surname><given-names>J</given-names></name><name><surname>de Visser</surname><given-names>JAGM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantitative analyses of empirical fitness landscapes</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2013</volume><elocation-id>P01005</elocation-id><pub-id pub-id-type="doi">10.1088/1742-5468/2013/01/P01005</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>L</given-names></name><name><surname>Serene</surname><given-names>S</given-names></name><name><surname>Chao</surname><given-names>HX</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Hidden Randomness between Fitness Landscapes Limits Reverse Evolution</article-title><source>Physical Review Letters</source><volume>106</volume><elocation-id>198102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.106.198102</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thyagarajan</surname><given-names>B</given-names></name><name><surname>Bloom</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The inherent mutational tolerance and antigenic evolvability of influenza hemagglutinin</article-title><source>eLife</source><volume>3</volume><elocation-id>e03300</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.03300</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tufts</surname><given-names>DM</given-names></name><name><surname>Natarajan</surname><given-names>C</given-names></name><name><surname>Revsbech</surname><given-names>IG</given-names></name><name><surname>Projecto-Garcia</surname><given-names>J</given-names></name><name><surname>Hoffmann</surname><given-names>FG</given-names></name><name><surname>Weber</surname><given-names>RE</given-names></name><name><surname>Fago</surname><given-names>A</given-names></name><name><surname>Moriyama</surname><given-names>H</given-names></name><name><surname>Storz</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Epistasis constrains mutational pathways of hemoglobin adaptation in high-altitude pikas</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>287</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu311</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Arenas</surname><given-names>CD</given-names></name><name><surname>Stoebel</surname><given-names>DM</given-names></name><name><surname>Cooper</surname><given-names>TF</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Genetic background affects epistatic interactions between two beneficial mutations</article-title><source>Biology Letters</source><volume>9</volume><elocation-id>20120328</elocation-id><pub-id pub-id-type="doi">10.1098/rsbl.2012.0328</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinberger</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Fourier and Taylor series on fitness landscapes</article-title><source>Biological Cybernetics</source><volume>65</volume><fpage>321</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1007/BF00216965</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Delaney</surname><given-names>NF</given-names></name><name><surname>Depristo</surname><given-names>MA</given-names></name><name><surname>Hartl</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1126/science.1123539</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Lan</surname><given-names>Y</given-names></name><name><surname>Wylie</surname><given-names>CS</given-names></name><name><surname>Heckendorn</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Should evolutionary geneticists worry about higher-order epistasis?</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>23</volume><fpage>700</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2013.10.007</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname><given-names>DM</given-names></name><name><surname>Watson</surname><given-names>RA</given-names></name><name><surname>Chao</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Perspective: sign epistasis and genetic costraint on evolutionary trajectories</article-title><source>Evolution</source><volume>59</volume><fpage>1165</fpage><lpage>1174</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb01768.x</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>DB</given-names></name><name><surname>Desai</surname><given-names>MM</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The rate at which asexual populations cross fitness valleys</article-title><source>Theoretical Population Biology</source><volume>75</volume><fpage>286</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2009.02.006</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>DB</given-names></name><name><surname>Feldman</surname><given-names>MW</given-names></name><name><surname>Fisher</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The rate of fitness-valley crossing in sexual populations</article-title><source>Genetics</source><volume>186</volume><fpage>1389</fpage><lpage>1410</lpage><pub-id pub-id-type="doi">10.1534/genetics.110.123240</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>K</given-names></name><name><surname>Peng</surname><given-names>G</given-names></name><name><surname>Wilken</surname><given-names>M</given-names></name><name><surname>Geraghty</surname><given-names>RJ</given-names></name><name><surname>Li</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Mechanisms of host receptor adaptation by severe acute respiratory syndrome coronavirus</article-title><source>Journal of Biological Chemistry</source><volume>287</volume><fpage>8904</fpage><lpage>8911</lpage><pub-id pub-id-type="doi">10.1074/jbc.M111.325803</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>NC</given-names></name><name><surname>Young</surname><given-names>AP</given-names></name><name><surname>Al-Mawsawi</surname><given-names>LQ</given-names></name><name><surname>Olson</surname><given-names>CA</given-names></name><name><surname>Feng</surname><given-names>J</given-names></name><name><surname>Qi</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>SH</given-names></name><name><surname>Lu</surname><given-names>IH</given-names></name><name><surname>Lin</surname><given-names>CY</given-names></name><name><surname>Chin</surname><given-names>RG</given-names></name><name><surname>Luan</surname><given-names>HH</given-names></name><name><surname>Nguyen</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>SF</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Wu</surname><given-names>TT</given-names></name><name><surname>Sun</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>High-throughput profiling of influenza A virus hemagglutinin gene at single-nucleotide resolution</article-title><source>Scientific Reports</source><volume>4</volume><elocation-id>4942</elocation-id><pub-id pub-id-type="doi">10.1038/srep04942</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zanini</surname><given-names>F</given-names></name><name><surname>Brodin</surname><given-names>J</given-names></name><name><surname>Thebo</surname><given-names>L</given-names></name><name><surname>Lanz</surname><given-names>C</given-names></name><name><surname>Bratt</surname><given-names>G</given-names></name><name><surname>Albert</surname><given-names>J</given-names></name><name><surname>Neher</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Population genomics of intrapatient HIV-1 evolution</article-title><source>eLife</source><volume>4</volume><elocation-id>e11282</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11282</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16965.028</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Neher</surname><given-names>Richard A</given-names></name><role>Reviewing editor</role><aff id="aff5"><institution>Max Planck Institute for Developmental Biology</institution>, <country>Germany</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Adaptation in protein fitness landscapes is facilitated by indirect paths&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Diethard Tautz as the Senior editor and three reviewers, including Joachim Krug (Reviewer #2) and a member of our Board of Reviewing Editors.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Wu et al. report fitness measurements of all possible of combinations of amino acid substitutions at 4 positions in the protein GB1. Properties of fitness or folding landscapes of proteins are fundamental determinants of evolution since they determine which mutations are permissible on which genetic background. The major contribution of this manuscript is that it for the first time measures all combinations of all amino acids at multiple (four) sites. Using this data, the authors demonstrate that indirect path often enable ascend to the global fitness maximum, even when direct path a blocked by fitness valleys.</p><p>Essential revisions:</p><p>All reviews agreed that the results reported are a significant step forward in understanding the landscapes governing evolution of proteins. Before we can recommend publication, we would like to see the following points addressed.</p><p>1) A more thorough discussion of the generality of the results. The sites were chosen to be as epistatic as possible. Hence it is not clear how representative the properties of the 4 site landscape are. Along the same lines, we would like know how the wild type genotype compares to the ensemble of possible genotypes. Where does the wild type fall in the distribution of all fitness measurements? It would be informative to have <xref ref-type="fig" rid="fig1">Figure 1C</xref> not only for WT and the average sequence, but also the top and bottom 5% or similar.</p><p>2) Quantification of ruggedness and the importance of higher order coefficients. <xref ref-type="fig" rid="fig3">Figure 3A</xref> quantifies the accuracy of the approximation of the fitness landscapes (2 allele subspaces) after inclusion of 1st, 2nd, and 3rd order effects. This is important and useful, but can be improved. Instead of plotting the correlation coefficient, plot the fraction of variance explained by each order (that is the power spectrum of the Fourier decomposition, see Neher and Shraiman, RMP, 2011 or Neidhart et al., JTB 2013). Furthermore, a distribution of the 1st, 2nd, and 3rd order variance would be easier to parse than the current overlay of many lines. Along similar lines, can one quantify whether higher-order epistasis makes the landscape more or less rugged on average? If all higher order coefficients are set to 0, does the number of accessible path go up or down?</p><p>3) Your simulations allow transitions from every amino acid to any other amino acid and hence ignore the constraints imposed by the encoding as codons. It does not seem to be a big complication to restrict transitions to those that can be achieved by single nucleotide substitutions. Does this reduction in connectivity reduce the effects of indirect path substantially?</p><p>4) Missing literature and inaccurate statements. Even if there are only two amino acids (or more generally two alleles) per site, there can still be indirect paths with mutational reversions. The statements in the second paragraph of the Main text are not accurate. The mechanisms of bypass and conversion have been discussed previously (and have not been &quot;discovered&quot; by the authors; Main text, fifth paragraph). Gavrilets (1997) discusses extra-dimensional bypass. Several recent papers have theoretically studied the effect of reversions on evolutionary accessibility in diallelic sequence spaces:</p><p>Julien Berestycki, Eric Brunet, Zhan Shi. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1401.6894">http://arxiv.org/abs/1401.6894</ext-link></p><p>Anders Martinsson. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1501.0220">http://arxiv.org/abs/1501.0220</ext-link></p><p>Li Li. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1502.07642">http://arxiv.org/abs/1502.07642</ext-link></p><p>The adaptation schemes referred to by the authors as 'Greedy model', 'Correlated Fixation Model' and 'Equal Fixation Model' should be placed into their proper population-genetic context. Key references are:</p><p>H. Allen Orr. Evolution, 56(7), 2002, pp. 1317-1330</p><p>H. Allen Orr. J. theor. Biol. (2003) 220, 241-247</p><p>which discuss the performance of the three types of 'adaptive walks' in the uncorrelated random 'mutational landscape' model and show, in particular, that greedy walks are much shorter than 'correlated fixation' walks which in turn are shorter than 'equal fixation' walks. This is expected to be a fairly general pattern that also appears in the results shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>.</p><p>5) One take home message of the manuscript is that even in the most rugged place of a protein fitness landscape, the multitude of possible mutations makes most places accessible (via detours at times). This could be a way to reconcile the seemingly contradictory observations that (i) there is a lot of epistasis/ruggedness and (ii) that amino acid preferences are preserved (work by Bloom et al) and that viruses like HIV extensively revert to a putatively optimal fitness peak after immune evasion. In high dimensions, fitness landscapes seem to be locally rugged and accessible at the same time. A more thorough discussion of the potentially wider implications of indirect path could place these results into a broader context.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.16965.029</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>All reviews agreed that the results reported are a significant step forward in understanding the landscapes governing evolution of proteins. Before we can recommend publication, we would like to see the following points addressed.</italic> </p><p><italic>1) A more thorough discussion of the generality of the results. The sites were chosen to be as epistatic as possible. Hence it is not clear how representative the properties of the 4 site landscape are. Along the same lines, we would like know how the wild type genotype compares to the ensemble of possible genotypes. Where does the wild type fall in the distribution of all fitness measurements? It would be informative to have <xref ref-type="fig" rid="fig1">Figure 1C</xref> not only for WT and the average sequence, but also the top and bottom 5% or similar.</italic></p><p>We appreciate the reviewers’ comment on these issues. In the revised manuscript, we have expanded the discussion on the generality of our results. In particular, we have pointed out that strong epistasis among the four sites we investigated would not influence our major findings on the indirect paths: “Finally, we note that the four amino acids chosen in our study are in physical proximity and have strong epistatic interactions. (…) Although the details of a particular fitness landscape can influence the quantitative role of different bypass mechanisms, this does not undermine the generality of our conceptual findings on extra-dimensional bypass, higher-order epistasis, and their roles in protein evolution.”</p><p>Based on the reviewers’ comments, we have performed additional analyses to compare the wild type to the ensemble of possible genotypes. The fitness rank of the wild type genotype is 2.4% in the distribution of all fitness measurements. The distributions of fitness values of all non-lethal genotypes are shown in <xref ref-type="fig" rid="fig1s4">Figure 1—figure supplement 4</xref>. Also, as suggested, we have also modified <xref ref-type="fig" rid="fig1">Figure 1C</xref> to include analyses on pairwise epistasis in the neighborhood of sequences with fitness values at the top and the bottom of the distribution. Although we used the wild type genotype in illustrations of adaptive pathways (<xref ref-type="fig" rid="fig1">Figures 1</xref> and <xref ref-type="fig" rid="fig4">4</xref>), we want to emphasize that there is nothing unique about the wild type genotype in our analyses of the fitness landscape.</p><p><italic>2) Quantification of ruggedness and the importance of higher order coefficients. <xref ref-type="fig" rid="fig3">Figure 3A</xref> quantifies the accuracy of the approximation of the fitness landscapes (2 allele subspaces) after inclusion of 1st, 2nd, and 3rd order effects. This is important and useful, but can be improved. Instead of plotting the correlation coefficient, plot the fraction of variance explained by each order (that is the power spectrum of the Fourier decomposition, see Neher and Shraiman, RMP, 2011 or Neidhart et al., JTB 2013). Furthermore, a distribution of the 1st, 2nd, and 3rd order variance would be easier to parse than the current overlay of many lines. Along similar lines, can one quantify whether higher-order epistasis makes the landscape more or less rugged on average? If all higher order coefficients are set to 0, does the number of accessible path go up or down?</italic></p><p>We appreciate these suggestions on how to improve the presentation of Fourier coefficients, and we have implemented them in the revised manuscript. Instead of plotting the Pearson correlation, we have updated <xref ref-type="fig" rid="fig3">Figure 3A</xref> to show the fraction of variance explained by expanding the Fourier coefficients to 1st, 2nd, 3rd, and 4th order. In addition, we have shown the distribution of the variance in fitness at each order in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>.</p><p>We have altered the text accordingly: “For the 109,235 complete subgraphs that we analyzed, the fraction of the variance in fitness explained by each order is shown. Although the first order (main effects) and the second order Fourier coefficients (pairwise epistasis) can explain most of the variance in fitness, higher-order epistasis is present in certain combination of mutations.”</p><p>To further study the effect of higher-order epistasis on landscape ruggedness, we performed additional analyses on the subgraphs identified in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. We applied Fourier decomposition and set all higher-order coefficients to 0. Because removing higher-order coefficients will change the topography of the fitness landscape, such as the number and the location of peaks, we have limited our analysis to the subgraphs in which the quadruple mutant remained the only fitness peak when the higher-order coefficients were removed. Among these subgraphs, we found that the ruggedness score (as determined by the fraction of sign and reciprocal sign epistasis) does not show a systematic trend after removal of higher-order epistasis, and that the number of accessible direct paths can either increase or decrease in the presence of higher-order epistasis (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>).</p><p>Although it is known that higher-order epistasis increases the variance in fitness, the relation between the degree of higher-order epistasis and the number of accessible direct paths is an open question. In our data, we have shown that the number of accessible direct paths depends on the ruggedness induced by pairwise epistasis (sign and reciprocal sign epistasis, <xref ref-type="fig" rid="fig1s6">Figure 1—figure supplement 6</xref>), which can either go up or down due to the influence of higher-order epistasis. Moreover, we need to consider that higher-order epistasis can mediate indirect paths to increase evolutionary accessibility (<xref ref-type="fig" rid="fig4">Figure 4</xref>).</p><p>Overall, we conclude that the relation between higher-order epistasis and evolutionary accessibility is an interesting question that warrants future studies, both in theoretical models and in empirical fitness landscapes. We have incorporated our additionalanalyses as figure supplements and expanded our discussion on the role of high-order epistasis in evolutionary accessibility.</p><p>“In this study, we observed the presence of higher-order epistasis and systematically quantified its contribution to protein fitness. Our results suggest that higher-order epistasis can either increase or decrease the ruggedness induced by pairwise epistasis, which in turn determines the accessibility of direct paths in a rugged fitness landscape (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>). We also revealed the important role of higher-order epistasis in mediating detour bypass, which could promote evolutionary accessibility via indirect paths.”</p><p><italic>3) Your simulations allow transitions from every amino acid to any other amino acid and hence ignore the constraints imposed by the encoding as codons. It does not seem to be a big complication to restrict transitions to those that can be achieved by single nucleotide substitutions. Does this reduction in connectivity reduce the effects of indirect path substantially?</italic></p><p>We appreciate the question. In the revised manuscript, we have included an analysis that examines the importance of indirect paths in promoting evolutionary accessibility under the constraints imposed by the standard genetic code. Interestingly, this reduction in connectivity did not alter the qualitative finding that indirect paths promote evolutionary accessibility. The result is shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref> and is described in the text: “We repeated the analysis in <xref ref-type="fig" rid="fig4">Figure 4F</xref> with the consideration of the constraints imposed by the standard genetic code (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>). The constraints from the genetic code decreased the number of accessible variants due to the reduction in connectivity. However, this reduction in connectivity did not alter our core finding that indirect paths substantially increase evolutionary accessibility (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3B</xref>).”</p><p>The methodology of identifying indirect paths under the constraints imposed by the standard genetic code is added to the Materials and methods section: “Under constraints imposed by the standard genetic code, the connectivity of the directed graph that represented the fitness landscape was restricted according to the matrix shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>. The genetic distance between two variants was calculated according to the matrix shown in <xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3A</xref>. If the length of the shortest path is larger than the genetic distance between two variants, it means that adaptation requires indirect paths.”</p><p><italic>4) Missing literature and inaccurate statements. Even if there are only two amino acids (or more generally two alleles) per site, there can still be indirect paths with mutational reversions. The statements in the second paragraph of the Main text are not accurate. The mechanisms of bypass and conversion have been discussed previously (and have not been &quot;discovered&quot; by the authors; Main text, fifth paragraph). Gavrilets (1997) discusses extra-dimensional bypass. Several recent papers have theoretically studied the effect of reversions on evolutionary accessibility in diallelic sequence spaces:</italic> </p><p><italic>Julien Berestycki, Eric Brunet, Zhan Shi. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1401.6894">http://arxiv.org/abs/1401.6894</ext-link> </italic></p><p><italic>Anders Martinsson. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1501.0220">http://arxiv.org/abs/1501.0220</ext-link> </italic></p><p><italic>Li Li. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1502.07642">http://arxiv.org/abs/1502.07642</ext-link> </italic></p><p><italic>The adaptation schemes referred to by the authors as 'Greedy model', 'Correlated Fixation Model' and 'Equal Fixation Model' should be placed into their proper population-genetic context. Key references are:</italic> </p><p><italic>H. Allen Orr. Evolution, 56(7), 2002, pp. 1317-1330</italic> </p><p><italic>H. Allen Orr. J. theor. Biol. (2003) 220, 241-247</italic> </p><p><italic>which discuss the performance of the three types of 'adaptive walks' in the uncorrelated random 'mutational landscape' model and show, in particular, that greedy walks are much shorter than 'correlated fixation' walks which in turn are shorter than 'equal fixation' walks. This is expected to be a fairly general pattern that also appears in the results shown in <xref ref-type="fig" rid="fig4">Figure 4D</xref>.</italic></p><p>We have followed the reviewers' suggestions and revised our statements and included the suggested references.</p><p>The description of reversion-mediated indirect paths in diallelic sequence spaces is added to the revised manuscript: “Most studies of adaptive walks in these diallelic sequence spaces focused on “direct paths” where each mutational step reduces the Hamming distance from the starting point to the destination. However, it has also been shown that mutational reversions can occur during adaptive walks in diallelic sequence spaces such that adaptation proceeds via “indirect paths” (DePristo, Hartl and Weinreich, 2007; Berestycki, Brunet and Shi, 2014; Martinsson, 2015; Li, 2015; Palmer et al., 2015).”</p><p>For describing the mechanisms of bypass and conversion, the phrase “we discovered” is replaced with “we observed”, and the appropriate references are included in the revised manuscript: “In sequence space with higher dimensionality (20<italic><sup>L</sup></italic>, for a protein sequence with <italic>L</italic> amino acid residues), the extra dimensions may further provide additional routes for adaptation (Gavrilets, 1997; Cariani, 2002). (…) With our experimental data, we observed two distinct mechanisms of bypass, either using an extra amino acid at the same site or using an additional site that allow proteins to continue adaptation when no direct paths were accessible due to reciprocal sign epistasis (<xref ref-type="fig" rid="fig2">Figure 2</xref>).”</p><p>In the main text of the revised manuscript, the adaptation schemes are described in their population-genetic context: “The Greedy Model represents adaptive evolution of a large population with pervasive clonal interference (de Visser and Krug, 2014). (…) The Equal Fixation Model represents a simplified scenario of adaptation where all beneficial mutations fix with equal probability (Weinreich et al., 2006).”</p><p>The suggested references were also included during the discussion of the performance of different types of “adaptive walks”: “Consistent with previous studies (Orr, 2002; Orr, 2003), when mutations conferring larger fitness gains were more likely to fix (e.g. Greedy Model and Correlated Fixation Model), adaptation favored direct moves toward the destination, thus leading to a shorter adaptive paths (<xref ref-type="fig" rid="fig4">Figure 4C–D</xref>).”</p><p><italic>5) One take home message of the manuscript is that even in the most rugged place of a protein fitness landscape, the multitude of possible mutations makes most places accessible (via detours at times). This could be a way to reconcile the seemingly contradictory observations that (i) there is a lot of epistasis/ruggedness and (ii) that amino acid preferences are preserved (work by Bloom et al) and that viruses like HIV extensively revert to a putatively optimal fitness peak after immune evasion. In high dimensions, fitness landscapes seem to be locally rugged and accessible at the same time. A more thorough discussion of the potentially wider implications of indirect path could place these results into a broader context.</italic> </p><p>Since the fitness landscape described by our work focuses on a small sequence space, we are cautious in extrapolating our results to evolution in a much larger sequence space, such as that of protein homologs. Nonetheless, we agree with the reviewer that the extensive reversion to the putatively optimal fitness peak is consistent with our results here. Therefore, we have extended our Discussion accordingly: “Our work demonstrates that even in the most rugged regions of a protein fitness landscape, most of the sequence space can remain highly accessible owing to the indirect paths opened up by high dimensionality. The enhanced accessibility mediated by indirect paths may provide a partial explanation for some observations in viral evolution. For example, throughout the course of infection HIV always seems to find a way to revert to the global consensus sequence, a putatively “optimal” HIV-1 sequence after immune invasion (Zanini et al., 2015).”</p></body></sub-article></article>