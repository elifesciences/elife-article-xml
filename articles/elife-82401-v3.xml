<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">82401</article-id><article-id pub-id-type="doi">10.7554/eLife.82401</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Biochemistry and Chemical Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>SIMMER employs similarity algorithms to accurately identify human gut microbiome species and enzymes capable of known chemical transformations</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-288316"><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7380-3619</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-313026"><name><surname>Nayak</surname><given-names>Renuka R</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="pa1">†</xref><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="other" rid="fund12"/><xref ref-type="other" rid="fund11"/><xref ref-type="other" rid="fund13"/><xref ref-type="other" rid="fund14"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-289168"><name><surname>Agrawal</surname><given-names>Ayushi</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2940-8926</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-21327"><name><surname>Turnbaugh</surname><given-names>Peter J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0888-2875</contrib-id><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund8"/><xref ref-type="other" rid="fund9"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" corresp="yes" id="author-153883"><name><surname>Pollard</surname><given-names>Katherine S</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9870-6196</contrib-id><email>kpollard@gladstone.ucsf.edu</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf3"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Pharmaceutical Sciences and Pharmacogenomics Graduate Program, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/038321296</institution-id><institution>Institute of Data Science and Biotechnology, Gladstone Institutes</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Rheumatology Division, Department of Medicine, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Department of Microbiology &amp; Immunology, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff5"><label>5</label><institution>Chan Zuckerberg Biohub-San Francisco</institution><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Department of Epidemiology &amp; Biostatistics, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Institute for Human Genetics, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff><aff id="aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/043mz5j54</institution-id><institution>Bakar Computational Health Sciences Institute, University of California, San Francisco</institution></institution-wrap><addr-line><named-content content-type="city">San Francisco</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Redinbo</surname><given-names>Matthew</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0130frc33</institution-id><institution>The University of North Carolina - Chapel Hill</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Garrett</surname><given-names>Wendy S</given-names></name><role>Senior Editor</role><aff><institution>Harvard T.H. Chan School of Public Health</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="present-address" id="pa1"><label>†</label><p>Veterans Affairs Medical Center, San Francisco, United States</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>12</day><month>06</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e82401</elocation-id><history><date date-type="received" iso-8601-date="2022-08-03"><day>03</day><month>08</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-06-11"><day>11</day><month>06</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-08-04"><day>04</day><month>08</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.02.502504"/></event></pub-history><permissions><copyright-statement>© 2023, Bustion et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Bustion et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-82401-v3.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-82401-figures-v3.pdf"/><abstract><p>Bacteria within the gut microbiota possess the ability to metabolize a wide array of human drugs, foods, and toxins, but the responsible enzymes for these chemical events remain largely uncharacterized due to the time-consuming nature of current experimental approaches. Attempts have been made in the past to computationally predict which bacterial species and enzymes are responsible for chemical transformations in the gut environment, but with low accuracy due to minimal chemical representation and sequence similarity search schemes. Here, we present an in silico approach that employs chemical and protein <underline>S</underline>imilarity algorithms that <underline>I</underline>dentify <underline>M</underline>icrobio<underline>M</underline>e <underline>E</underline>nzymatic <underline>R</underline>eactions (SIMMER). We show that SIMMER accurately predicts the responsible species and enzymes for a queried reaction, unlike previous methods. We demonstrate SIMMER use cases in the context of drug metabolism by predicting previously uncharacterized enzymes for 88 drug transformations known to occur in the human gut. We validate these predictions on external datasets and provide an in vitro validation of SIMMER’s predictions for metabolism of methotrexate, an anti-arthritic drug. After demonstrating its utility and accuracy, we made SIMMER available as both a command-line and web tool, with flexible input and output options for determining chemical transformations within the human gut. We present SIMMER as a computational addition to the microbiome researcher’s toolbox, enabling them to make informed hypotheses before embarking on the lengthy laboratory experiments required to characterize novel bacterial enzymes that can alter human ingested compounds.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>microbiome metabolism</kwd><kwd>enzyme prediction</kwd><kwd>methotrexate</kwd><kwd><italic>Clostridium scindens</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100001797</institution-id><institution>PhRMA Foundation</institution></institution-wrap></funding-source><award-id>Predoctoral Fellowship</award-id><principal-award-recipient><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008227</institution-id><institution>ARCS Foundation</institution></institution-wrap></funding-source><award-id>Graduate Student Scholarship</award-id><principal-award-recipient><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution>UCSF Benioff Center for Microbiome Medicine</institution></institution-wrap></funding-source><award-id>Trainee Pilot Award</award-id><principal-award-recipient><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008072</institution-id><institution>Gladstone Institutes</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Pollard</surname><given-names>Katherine S</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution>Chan Zuckerberg Biohub San Francisco</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Pollard</surname><given-names>Katherine S</given-names></name><name><surname>Turnbaugh</surname><given-names>Peter J</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>5T32GM007175-42</award-id><principal-award-recipient><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>2T32GM007175-41</award-id><principal-award-recipient><name><surname>Bustion</surname><given-names>Annamarie E</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000050</institution-id><institution>National Heart, Lung, and Blood Institute</institution></institution-wrap></funding-source><award-id>R01HL122593</award-id><principal-award-recipient><name><surname>Turnbaugh</surname><given-names>Peter J</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000069</institution-id><institution>National Institute of Arthritis and Musculoskeletal and Skin Diseases</institution></institution-wrap></funding-source><award-id>R01AR074500</award-id><principal-award-recipient><name><surname>Turnbaugh</surname><given-names>Peter J</given-names></name><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000069</institution-id><institution>National Institute of Arthritis and Musculoskeletal and Skin Diseases</institution></institution-wrap></funding-source><award-id>K08AR073930</award-id><principal-award-recipient><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><award-group id="fund11"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000964</institution-id><institution>Arthritis National Research Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><award-group id="fund12"><funding-source><institution-wrap><institution>Russell Engelman Rheumatology Research Center</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><award-group id="fund13"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008069</institution-id><institution>University of California, San Francisco</institution></institution-wrap></funding-source><award-id>Perstein Award</award-id><principal-award-recipient><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><award-group id="fund14"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008069</institution-id><institution>University of California, San Francisco</institution></institution-wrap></funding-source><award-id>Bechtel Award</award-id><principal-award-recipient><name><surname>Nayak</surname><given-names>Renuka R</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational reaction representations and profile hidden Markov model searches of metagenomics databases can be harnessed to accurately predict bacterial species and enzyme sequences responsible for biotransformations in the human gut microbiome.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Humans consume a large array of foods, therapeutics, and other xenobiotics that are processed, in part, by enzymes of bacteria residing within the gut. While some bacterial enzymes are orthologous to the human metabolism repertoire, many bacteria possess metabolic capabilities distinct from our own (<xref ref-type="bibr" rid="bib65">Zimmermann et al., 2019a</xref>). It is important to ascertain the extent of microbial capacity for chemical transformation because it has implications for the bioavailability, toxicity, and efficacy of the compounds humans ingest (<xref ref-type="bibr" rid="bib33">Koppel et al., 2017</xref>; <xref ref-type="bibr" rid="bib57">Spanogiannopoulos et al., 2016</xref>). Additionally, because the human gut microbiome differs from individual to individual, knowledge of the prevalence and abundance of bacterial enzymes must be determined before beneficial clinical and dietary decisions can be made (<xref ref-type="bibr" rid="bib29">Javdan et al., 2020</xref>).</p><p>While experimental methods can be employed to expand what we know of bacterial enzymatic capabilities in the gut, the scientific community lacks genetic tools for nearly all bacterial species of the human microbiota, and heterologous expression in model organisms can fail for a plethora of reasons (<xref ref-type="bibr" rid="bib8">Bisanz et al., 2020</xref>; <xref ref-type="bibr" rid="bib47">Patel et al., 2022</xref>). When experimental methods are tractable, the time required is often so extended that knowledge is gained in a low-throughput manner. For these reasons, attention should turn to the employment of in silico computational methods that can guide experimentalists in their hypothesis-building process by aiding in the prioritization of substrates, species, and genes worth studying (<xref ref-type="bibr" rid="bib6">Aziz et al., 2018</xref>).</p><p>Recent attempts have been made to create computational descriptions of chemical transformation by human gut bacteria, but none can be expanded to predict the metabolic capabilities of bacterial proteins with unknown function or to explore the capacity of microbial enzymes to degrade novel substrates. Two previously published methods aimed to predict known drug metabolism events within the human gut microbiome, but the accuracy of their species and enzyme predictions was limited due to the fact that both tools only consider substrates, rather than a full chemical description of substrate(s), cofactor(s), and product(s) formed in a reaction (<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>; <xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>). Both tools were also limited by the use of small databases that do not fully capture the diversity of the human gut microbiome (<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>; <xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>).</p><p>To address these gaps in accurate predictive software, we present SIMMER, a tool that combines chemoinformatics and metagenomics approaches to accurately predict bacterial species and enzymes capable of known biotransformations in the human gut. Given an input reaction, SIMMER predicts specific bacterial enzyme sequences responsible for the transformation. Each predicted sequence is annotated with taxonomy, potential function, and prevalence/abundance in human metagenomic samples.</p><p>Our key innovations are the use of full chemical representations that include cofactors employed and products produced in a reaction, the use of statistically informed sequence searches of a comprehensive human gut microbiome gene catalog, and the development of an enzyme class predictor based on reaction rather than gene sequence. As a use-case, we present evidence that SIMMER provides accurate predictions of bacterial enzymes responsible for known drug metabolism events, and we identify the likely bacterial enzyme for 88 drugs known to be metabolized by the gut microbiome for which the enzyme was previously unknown. We evaluated these predictions on external datasets, and for one reaction, methotrexate (MTX) hydrolysis, we characterized human gut microbiome bacterial metabolism in vitro across 42 strains.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>SIMMER pipeline to predict xenobiotic metabolizing enzymes</title><p>There are many desiderata for a bacterial drug metabolism predictor (<xref ref-type="bibr" rid="bib6">Aziz et al., 2018</xref>). Such a tool must be able to, based on chemical analogy to known bacterial chemistry, predict bacterial species, specific enzyme sequences, and the prevalence and abundance across human samples of those predicted species and sequences. We developed SIMMER, a tool that leverages chemical and protein similarity to identify enzymes in the human microbiome that could perform a queried chemical reaction (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Given input substrate(s), metabolite(s), and any known cofactors, SIMMER predicts bacterial enzymes capable of performing the reaction and quantifies their prevalence and abundance in the human gut. SIMMER accomplishes this by chemically fingerprinting an input reaction, and then comparing it to all reactions in MetaCyc (<xref ref-type="bibr" rid="bib13">Caspi et al., 2020</xref>). Enzyme annotations from the most similar MetaCyc reactions are then used as queries for a protein similarity search to find homologs in the genomes of gut bacteria. To decrease the runtime of a SIMMER query, we precomputed chemical descriptions and protein similarity searches for all reactions in MetaCyc.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>SIMMER architecture.</title><p>(<bold>A</bold>) Precomputation on 8914 gene-annotated bacterial reactions downloaded from MetaCyc. Chemical fingerprints representing each MetaCyc reaction were created from SMILES descriptors. A latent chemical space was then created via a pairwise reaction similarity matrix based on Tanimoto coefficients. For each reaction, relevant gene sequences were retrieved from UniProt and Entrez database linkouts and used to create multiple sequence alignments and subsequent profile hidden Markov models (pHMMs) using ClustalO and HMMER3, respectively. pHMMs were used to retrieve homologs in a catalog of human gut microbiome genes. (<bold>B</bold>) Running a SIMMER query. After receiving a reaction query (input compound, cofactors, and products), SIMMER fingerprints the reaction and compares it to the precomputed chemical space from (A). MetaCyc reactions are sorted by similarity to the query. From the most similar reaction(s), human gut microbiome enzymes are reported along with their abundance and prevalence in gut microbiomes. As an auxiliary output, Enzyme Commission (EC) numbers are predicted based on enrichment in the ranked reaction list.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig1-v3.tif"/></fig><p>SIMMER’s underlying data were drawn from the MetaCyc reaction database because its small-molecule reaction descriptions each possess at least one experimentally validated enzyme annotation and because it is currently the most comprehensive database of its kind (<xref ref-type="bibr" rid="bib2">Altman et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Caspi et al., 2020</xref>). To build a precomputed chemical search space for SIMMER queries (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), we created two-dimensional fingerprint representations for 8914 enzyme-driven reactions in MetaCyc (<xref ref-type="bibr" rid="bib12">Caspi et al., 2008</xref>; <xref ref-type="bibr" rid="bib53">Schneider et al., 2015</xref>). Using these fingerprints, we estimated the similarity between all pairs of reactions based on Tanimoto coefficients. To build the enzyme backbone of SIMMER, we compiled the Uniprot and/or Entrez gene identifiers linked to each MetaCyc transformation into a profile hidden Markov model (pHMM) that represents the diversity of the enzyme family for a respective reaction. The resulting pHMMs were then used to query the Unified Human Gastrointestinal Genome (UHGG) collection of 286,997 isolate genomes and metagenome assembled genomes from the human gut environment (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>). Additionally, prevalence and abundance of all pHMM search hits were assessed in stool metagenomes from the PREDICT human cohort using MIDAS2, an implementation of Metagenomic Intra-Species Diversity Analysis System (MIDAS) designed for use with the UHGG catalog (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>; <xref ref-type="bibr" rid="bib45">Nayfach et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">Zhao et al., 2022</xref>).</p><p>After creating SIMMER’s precomputed chemical and pHMM search space, we next made SIMMER queryable (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). When queried with a chemical transformation, SIMMER computes the chemical similarity of the input to all precomputed MetaCyc reactions, and sorts all MetaCyc reaction fingerprints according to their ascending Euclidean distance from the query. From this sorted list, SIMMER outputs enzymes (i.e., the precomputed pHMM search hits for the closest reactions) responsible for the query reaction. As an auxiliary function to enzyme sequence prediction, SIMMER additionally predicts an Enzyme Commission (EC) code that describes the chemical nature of the query. EC codes are four-digit identifiers of enzyme-driven reactions, where each digit describes the reaction with increasing chemical granularity (<xref ref-type="bibr" rid="bib40">McDonald et al., 2009</xref>). The first digit, the EC class, describes broad chemistry such as whether the reaction is an oxidoreduction, hydrolysis, etc. event. The second and third digits, the EC sub-class and sub-sub-class, describe more detailed chemical information such as electron donor or transfer group identity. The fourth and final digit, the EC serial designation, often describes a reaction’s specific substrate(s). We implemented and validated a novel method to predict EC codes by extending a common approach to gene set enrichment analysis (GSEA) (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib58">Subramanian et al., 2005</xref>). With this enrichment method, SIMMER predicted reaction types for queries with high recall and accuracy for EC classes, sub-classes, and sub-sub-classes (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>SIMMER’s chemical representations capture information relevant to enzymatic reactions.</title><p>(<bold>A</bold>) SIMMER clusters similar reactions together in chemical space. To analyze SIMMER’s ability to group chemically similar reactions, we examined reaction similarity within versus without Enzyme Commission (EC) classes using the precomputed MetaCyc reaction dataset (<italic>N</italic> = 8914 reactions). A silhouette-like euclidean distance score was created by determining for each reaction its euclidean distance to all reactions within its EC class versus outside its EC class. For all EC classes, scores were smaller within versus without EC classes using SIMMER’s chemical representation, indicating that SIMMER can detect reaction similarity within EC classes. From the pairs of distributions, we computed a Kolmogorov statistic to determine if the distributions significantly (p &lt; 0.05) differed. (<bold>B</bold>) The <italic>F</italic>1-score, or harmonic mean of SIMMER’s precision and recall, when predicting EC numbers on a subset of the MetaCyc database (<italic>N</italic> = 576 reactions total; 96 per EC class). The score is high for EC classes, and it generally decreases as an EC number’s resolution increases.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Euclidean distances for reactions in the same versus other EC classes across reaction representations, and performance statistics for SIMMER's EC class predictor.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig2-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig2-v3.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>SIMMER predicts an Enzyme Commission (EC) code (i.e., reaction type) for a query reaction if there is an enrichment of a particular EC at the top of the reaction list.</title><p>(<bold>A</bold>) For each EC code associated with MetaCyc reactions, an enrichment score (ES) was calculated by walking down the ranked list of reactions. Starting with a score of zero, each time the given EC is encountered the score increases by one, and each time a different EC is encountered the score decreases by one. Panel A is an example of such a walk with MetaCyc reaction RXN-6763. (<bold>B</bold>) Significance is established by comparing the true ES to the ES achieved from 1000 permutations of a shuffled reaction list. Panel B is an example of how RXN-6763 loses its EC enrichment structure after shuffling. (<bold>C</bold>) Because the MetaCyc database of reactions is unbalanced in its EC code representation, ES scores for a given EC type are divided by the number of times the EC in question occurs in the database. This yields a normalized ES (NES) for SIMMER reporting. This is also performed for the shuffled distributions. (<bold>D</bold>) For the serial designation of an EC code (the most granular description of an EC code), SIMMER’s performance diminished (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), because enrichment calculations suffer from increased uniqueness in the ranked list and therefore reduced power to determine a match. This is proven here, as when the database is subsampled to ensure at least three of each unique serial designation, <italic>F</italic>1-scores (the harmonic mean of precision and recall) and accuracy remain high despite the increased EC resolution.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig2-figsupp1-v3.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Confusion matrices for SIMMER Enzyme Commission (EC) class predictions.</title><p>The confusion matrices describe the same data as <xref ref-type="fig" rid="fig2">Figure 2B</xref>, but expanded out to describe the absolute number of true positives, false positives, false negatives, and true negatives for each EC class.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig2-figsupp2-v3.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Euclidean distance distributions and silhouette scores for top-level Enzyme Commission (EC) codes are resilient to fingerprint type.</title><p>Distributions are computed as described in <xref ref-type="fig" rid="fig2">Figure 2A</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig2-figsupp3-v3.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Euclidean distance distributions and silhouette scores for top-level Enzyme Commission (EC) codes are sensitive to chemical representation type.</title><p>Distributions are computed as described in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. The resulting score distributions were used to compare SIMMER’s resilience to different chemical representations, such as removal of products and cofactors (the representation methods employed by DrugBug [<xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>] and MicrobeFDT [<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>]) or the inclusion of exactly one substrate and exactly one product (the Mallory et al. method [<xref ref-type="bibr" rid="bib39">Mallory et al., 2018</xref>]). For all EC classes, scores were smaller within versus without EC classes using SIMMER’s chemical representation, indicating that SIMMER can detect reaction similarity within EC classes. However, this was not consistently true when using only the input compound without cofactors or products (substrate), or when using only one substrate and product (one_substrate_one_product). From the pairs of distributions, we computed a Kolmogorov statistic to determine if the distributions significantly (p &lt; 0.05) differed. This showed that the differences were statistically significant for SIMMER chemical representations and reduced, or in the wrong direction, when using a reduced representation. X’s in the KS test heatmap indicate an incorrect direction of difference (without grouping closer than within).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig2-figsupp4-v3.tif"/></fig></fig-group><p>We hypothesized that SIMMER accurately predicted the bacterial players responsible for chemical transformations due to the tool’s use of a full reaction that includes reactants, cofactors, and products, rather than just substrates. We assessed this hypothesis by demonstrating that SIMMER groups similar reactions together in chemical space. MetaCyc reactions possess EC annotations that describe the chemical class of a reaction (e.g., oxidoreduction, hydrolysis, intramolecular rearrangement, etc). We queried SIMMER with all EC annotated MetaCyc reactions and demonstrated that queries group significantly closer to other reactions within their EC class than they do to reactions of a different class (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We determined that SIMMER’s ability to group similar reactions in chemical space is resilient to different fingerprinting methods (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>), but not to loss of products created and cofactors consumed in a reaction (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Thus, we showed that similar reactions only cluster together in chemical space when a full reaction description (i.e., SIMMER’s representation method) is employed.</p><p>Because SIMMER was created with the assumption that chemically similar reactions are mediated by sequence similar enzymes, we next ensured that similarity within SIMMER’s chemical space could be used to find shared, responsible enzymes. For all MetaCyc enzymes associated with multiple reactions, one reaction was used as a SIMMER query, and the second reaction searched for in the ordered reaction list output. As a negative control, these reaction similarity results were then compared to all possible pairwise combinations of reactions not conducted by the same enzyme. SIMMER predicted high similarity between reactions conducted by a shared enzyme, and low similarity for those reactions without a shared enzyme (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). We also found a negative association between chemical reaction distance and global sequence similarity of MetaCyc enzyme annotations, though there is much variation in this relationship (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). This reflects the known association between sequence similarity and similarity in chemical function, as well as reports that this relationship can often be overestimated (<xref ref-type="bibr" rid="bib60">Tian and Skolnick, 2003</xref>). Indeed, MetaCyc reactions with identical chemical representations could be conducted by proteins with only ~20% global percent identity all the way to 100% (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). This relationship informed our decision to use pHMM searches rather than BLAST to find sequence similar proteins from the human gut microbiome, as pHMM searches rely on matches of conserved sites rather than global percent identity between sequences. Together, these analyses informed the manner in which we combined chemical and protein similarity to create a microbiome enzyme prediction tool.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>SIMMER’s chemical representations can be used to find shared, responsible enzymes.</title><p>(<bold>A</bold>) When SIMMER was queried with a MetaCyc reaction, other reactions driven by the same enzyme are returned as the most similar. As a contrast, reactions driven by a different enzyme yield a more uniform rank distribution. Solid lines of the violin plots depict median reaction similarity rank and dashed lines represent lower and upper quartile ranges. (<bold>B</bold>) There is a negative association between pairwise reaction euclidean distance and pairwise protein global percent identity, but it is highly variable, demonstrating the need for protein searches that do not rely on high global percent identity to capture shared function.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Pairwise similarities for SIMMER's underlying chemical and protein data.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig3-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig3-v3.tif"/></fig></sec><sec id="s2-2"><title>An expanded list of gut bacterial enzymes relevant to known cases of drug metabolism</title><p>To assess SIMMER’s prediction accuracy for previously characterized reactions and to mount a comparison to existing methods, we used drug metabolism as a use-case. First, we curated 300 drug metabolism events associated with the human gut microbiome from the literature (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). For 33 of these reactions the responsible bacterial enzyme, characterized metabolite(s), and associated EC annotation are known (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). These 33 reactions are conducted by 18 enzymes. Due to orthology and proclivity for genetic transfer between even distantly related bacteria, however, there are likely many as yet undiscovered homologs of these drug-metabolizing enzymes that can catalyze identical drug metabolism events (<xref ref-type="bibr" rid="bib48">Pollet et al., 2017</xref>). To account for this, we created an expanded database (<xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>) of the 18 characterized enzymes from pHMM and phmmer searches of the UHGG database (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>), yielding 52,849 total candidate homologs (a median of 1087 candidates per enzyme). After filtering enzymes by hmmer significance, alignment length, presence in data from the human jejunum (<xref ref-type="bibr" rid="bib67">Zmora et al., 2018</xref>) and RNA-sequencing studies (<xref ref-type="bibr" rid="bib28">Integrative HMP (iHMP) Research Network Consortium, 2019</xref>), and predicted affinity for the substrate in question using the Similarity Ensemble Approach (<xref ref-type="bibr" rid="bib31">Keiser et al., 2007</xref>), our database contained a median of 2 high-confidence homologous sequences per enzyme (range = 0–460 across the 18 enzyme families, <xref ref-type="fig" rid="fig4">Figure 4</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="fig4sdata1">Figure 4—source data 1</xref>). These 741 additional enzyme sequences for 33 reactions formed an expanded testing set of known gut bacterial enzymes.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>An expanded list of gut bacterial enzymes relevant to known cases of drug metabolism.</title><p>Eleven of the 18 enzymes responsible for positive control drug metabolism events have high-confidence homologs that we gathered by filtering for biological significance.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>UHGG database identifiers for all putative homologs of the 18 previously characterized drug metabolizing enzymes.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig4-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig4-v3.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>An expanded list of gut bacterial enzymes relevant to known cases of drug metabolism.</title><p>52,849 total candidate homologs (a median of 1087 candidates per enzyme) were obtained via profile hidden Markov model (pHMM) searches with sequences from the literature. These putative homologs were filtered for presence in the human jejunum/ileum, presence in RNA-sequencing studies, and predicted affinity for the substrate in question using SEA. This resulted in 741 additional enzyme sequences for 33 positive control reactions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig4-figsupp1-v3.tif"/></fig></fig-group></sec><sec id="s2-3"><title>SIMMER captures known gut bacterial enzymes involved in drug metabolism</title><p>With our expanded database of drug-metabolizing enzymes from the human gut microbiome in hand, we next verified that SIMMER can accurately predict responsible enzymes and reaction types for the 33 known chemical transformations. Only 3 of these 33 reactions are themselves MetaCyc entries (5-ASA, dopamine, and levodopa degradation); if enzymes of reactions not described in MetaCyc were also accurately predicted, it would show that SIMMER can discover non-identical yet chemically similar reactions.</p><p>SIMMER accurately predicted the specific enzymes from the human gut microbiome that conduct the 33 query reactions (<xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>). This enzyme list was populated by the results of the precomputed pHMM searches of human microbiome catalogs with annotated gene sequences from MetaCyc reactions (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). In 29 cases (88%), the characterized (i.e., positive control) enzyme(s) for a reaction was found in the output enzyme list for the top 20 of the ranked MetaCyc reactions (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). We chose the top 20 out of ~9000 reactions as an accuracy cutoff, because this was the median rank of a true positive reaction in our analysis of MetaCyc reactions conducted by the same enzyme (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). Since the positive controls span four EC classes (EC1 oxidoreductases, EC2 transferases, EC3 hydrolases, and EC4 lyases), this result demonstrates SIMMER’s ability to accurately predict microbiome-based enzymes for a diversity of reaction types. Also, despite inaccurate EC predictions for nicardipine reduction and brivudine transformation, SIMMER was able to, respectively, predict AzoR and BT_4554 enzymes as responsible for the reactions, because enzyme and EC predictions are separately computed by SIMMER (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>SIMMER captures known gut bacterial enzymes involved in drug metabolism.</title><p>(<bold>A</bold>) SIMMER accurately predicted Enzyme Commission (EC) classes for 28 previously characterized reactions that possess EC annotations. As with the MetaCyc database (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), accuracy dropped off as EC resolution increased. (<bold>B</bold>) SIMMER predicted bacterial sequences previously shown to drive 33 drug metabolism events in the gut microbiome. Depicted is the rank (out of <italic>N</italic> = 8914 reactions) of the MetaCyc reaction that yielded a gut microbiome homolog matching the known positive control sequence. Reported accuracy is based on such a reaction being within the top 20 ranked reactions (dashed blue line).</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Performance analysis of 33 known chemical transformations (positive controls) using SIMMER's full representation or only a substrate.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig5-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig5-v3.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Distributions of all MetaCyc reactions’ euclidean distances to the positive control list queries.</title><p>For this analysis, 31 of the positive control reactions was queried to SIMMER. Distributions were created based on all (<italic>N</italic> = 8914) MetaCyc reactions’ distance to a given input metabolism event, and colored by their Enzyme Commission (EC) class annotation in MetaCyc (oxidoreductases, transferases, etc.). The dashed blue line depicts the MetaCyc reaction that yielded a gut microbiome homolog matching the known positive control sequence. For example, when queried with 5-ASA acetylation, SIMMER outputs a most-similar MetaCyc reaction (RXN-13871) that SIMMER linked (via sequence similarity) to an <italic>N</italic>-acetyltransferase known from previous literature to drive 5-ASA metabolism in the human gut.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig5-figsupp1-v3.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>The relationship between accuracy and false positives as a user explores more reactions from SIMMER’s prediction output.</title><p>Accuracy is defined as whether or not the enzymes responsible for 33 positive control reactions are found in SIMMER’s sequence results for the closest N MetaCyc reactions. The dashed gray line represents our cutoff (<italic>N</italic> = 20 reactions) chosen for the accuracy measures in <xref ref-type="fig" rid="fig5">Figure 5</xref> and <xref ref-type="table" rid="table1">Table 1</xref>. We defined the false positive rate as all output reactions preceding that which yields the positive control enzyme sequence within a given reaction number cutoff.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig5-figsupp2-v3.tif"/></fig></fig-group><p>SIMMER often predicts hundreds of sequences potentially responsible for an input reaction, meaning that the possibility of false positives is high. Because biotransformations of the microbiome are understudied, however, there does not exist in the literature a definitive list of <italic>all</italic> the bacterial enzymes that do <italic>not</italic> conduct a given reaction. For this reason, we were unable to directly assess an enzyme prediction false positive rate. Instead, we took a conservative approach and defined all output reactions preceding that which yielded the positive control enzyme sequence as false positives (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>).</p><p>Of the 33 drug metabolism events known to occur via human gut bacterial enzymes, EC annotations exist for 30. For five queries SIMMER predicted more than one significant EC class, but for 28 out of the 30 reactions (including these five), SIMMER’s top EC class prediction was correct (<xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>, <xref ref-type="supplementary-material" rid="fig5sdata1">Figure 5—source data 1</xref>). The two failed EC predictions were for nicardipine reduction (inappropriately predicted as an isomerase reaction) and for brivudine transformation (for which SIMMER made no significant prediction).</p></sec><sec id="s2-4"><title>SIMMER outperforms existing methods</title><p>To mount a comparison to the other in silico methods that, in part, aimed to describe microbiome drug metabolism, we next queried the 33 positive control reactions using MicrobeFDT and DrugBug (<xref ref-type="table" rid="table1">Table 1</xref>) both of which rely solely on substrate chemical similarity rather than information from a whole reaction (<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>; <xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Comparison to existing methods.</title><p><supplementary-material id="table1sdata1"><label>Table 1—source data 1.</label><caption><title>All data relevant to the comparison of SIMMER, DrugBug, and MicrobeFDT methods.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-table1-data1-v3.xlsx"/></supplementary-material></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top"/><th align="left" valign="top">DrugBug (<xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>)</th><th align="left" valign="top">MicrobeFDT (<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>)</th><th align="left" valign="top">SIMMER</th></tr></thead><tbody><tr><td align="left" valign="top" rowspan="2">Underlying databases</td><td align="left" valign="top">Number of chemicals</td><td align="char" char="." valign="top">2324<break/>compounds</td><td align="char" char="." valign="top">10,822<break/>compounds</td><td align="left" valign="top">8914 reactions<break/>(12,439 unique compounds)</td></tr><tr><td align="left" valign="top">Number of bacterial genomes</td><td align="left" valign="top">491 (custom database)</td><td align="char" char="." valign="top">3008 (IMG)</td><td align="char" char="." valign="top">286,997 (UHGG)</td></tr><tr><td align="left" valign="top" rowspan="2">Input types</td><td align="left" valign="top">Accepts novel SMILES</td><td align="left" valign="top"/><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">User options for different chemical fingerprints</td><td align="left" valign="top">✓</td><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top" rowspan="6">Output types</td><td align="left" valign="top">Reaction similarity measure</td><td align="left" valign="top"/><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">EC predictions</td><td align="left" valign="top">✓</td><td align="left" valign="top">✓</td><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Enzyme and species predictions</td><td align="left" valign="top">✓</td><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Function predictions</td><td align="left" valign="top"/><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Prevalence/abundance</td><td align="left" valign="top"/><td align="left" valign="top">✓</td><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Network relationships</td><td align="left" valign="top"/><td align="left" valign="top">✓</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top" rowspan="3">Usability</td><td align="left" valign="top">Web server</td><td align="left" valign="top">✓</td><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Command-line tool</td><td align="left" valign="top"/><td align="left" valign="top"/><td align="left" valign="top">✓</td></tr><tr><td align="left" valign="top">Docker container</td><td align="left" valign="top"/><td align="left" valign="top">✓</td><td align="left" valign="top"/></tr><tr><td align="left" valign="top" rowspan="2">Accuracy</td><td align="left" valign="top">Prediction of previously characterized enzymes</td><td align="char" char="." valign="top">3%</td><td align="left" valign="top">NA</td><td align="char" char="." valign="top">88%</td></tr><tr><td align="left" valign="top">Prediction of previously characterized EC numbers</td><td align="char" char="." valign="top">37%</td><td align="char" char="." valign="top">29%</td><td align="char" char="." valign="top">93%</td></tr></tbody></table></table-wrap><p>For the 30 EC annotated positive control reactions, DrugBug had 37% accuracy in predicting EC classes (in comparison to SIMMER’s 93%) and predicted the correct enzyme for only a single reaction, SN38 glucuronide deconjugation, despite the presence of chemically similar reactions metabolized by the same enzyme amongst the positive controls (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>). We additionally queried SIMMER with the four positive controls (ginsenoside Rb1, quercetin-3-glucoside, cycasin, and sorivudine) associated with characterized bacterial enzymes from the original DrugBug publication (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>). Both DrugBug and SIMMER were able to predict EC classes for sorivudine, but only SIMMER was able to accurately predict the specific enzyme (BT_4554) responsible for the drug’s degradation. For ginsenoside Rb1 (3.2.1.192), quercetin-3-glucoside (3.2.1.21), and cycasin (3.2.1.21), SIMMER accurately predicted EC codes out to sub-sub-class (3.2.1.-), serial designation (3.2.1.21), and sub-sub-class (3.2.1.-), respectively, which was a resolution improvement over DrugBug (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>).</p><p>We next queried the 30 EC annotated drug metabolism positive controls against MicrobeFDT, a chemical graph tool that only predicts EC codes, not enzyme sequences. MicrobeFDT produced EC predictions for 14 of the 30 positive controls, four of which were correct (29% accuracy). We finished the comparison between SIMMER and MicrobeFDT by querying SIMMER with the metabolism use-case described in the MicrobeFDT publication, altretamine demethylation. In our hands, there was no Cypher query against the MicrobeFDT database that resulted in a demethylase EC code (we determined possible demethylase EC codes by running a query in the Swiss Institute for Bioinformatics Enzyme Nomenclature Database) (<xref ref-type="bibr" rid="bib7">Bairoch, 2000</xref>). We performed queries of direct EC annotation for melamine and altretamine, as well as EC annotation queries for any compound with either substructure or toxicity overlap with altretamine or melamine. The closest result to a demethylase enzyme was a cypher query of toxicity overlap with altretamine that yielded a nitric oxide synthase (EC 1.14.13.39) acting on <sc>L</sc>-arginine among its results (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>). For its significant EC (reaction type) prediction, SIMMER identified altretamine demethylation appropriately as an oxidoreductase reaction acting on a CH-NH group of donors (EC 1.5.-), but not significantly as a demethylation event (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>).</p><p>Neither DrugBug nor MicrobeFDT computed predictions for all 33 positive control reactions. MicrobeFDT made so few EC predictions (14/30) because it is reliant on a fixed chemical database that cannot be modified by the user, meaning that a compound cannot be queried if it is not already present in MicrobeFDT’s graph. While DrugBug does allow for novel chemical input, its protein database only contains information from 491 bacterial genomes (in comparison to SIMMER’s 286,997 genomes), affecting its ability to make enzyme-specific predictions.</p><p>In instances when DrugBug and MicrobeFDT did make predictions, they suffered from low accuracy (<xref ref-type="table" rid="table1">Table 1</xref>), which we hypothesized was due to both methods’ reliance on substrate rather than reaction chemistry. Biotransformations involve the relationship between substrate(s), cofactor(s), and an enzyme to yield a particular product(s). As one substrate can exhibit affinity for multiple enzymes, resulting in multiple unique products, sole employment of substrates in a chemical fingerprint does not achieve the resolution necessary to make relevant predictions. To test if SIMMER’s better performance could be attributed to including cofactors and products, we modified our code to run with a chemical representation that includes only the substrate of each positive control reaction. Enzyme prediction accuracy dropped from 88% down to 33%, and EC prediction accuracy dropped from 93% down to 48% (<xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>), supporting the hypothesis that SIMMER’s better performance when compared to DrugBug and MicrobeFDT is due in large part to our use of chemical representations that include the full reaction. These results are in line with our previous demonstration that SIMMER clusters enzymatic reaction chemistry only when a full reaction is employed (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>).</p><p>Altogether, these findings illustrate SIMMER’s enhanced accuracy over other methods for the use-case of characterized drug metabolism events by gut bacteria, and also illustrate SIMMER’s novel ability to predict species and enzymes responsible for chemical transformations not previously described in literature or databases.</p></sec><sec id="s2-5"><title>SIMMER predicts novel drug-metabolizing enzymes</title><p>After establishing SIMMER’s accuracy in predicting drug-metabolizing enzymes in the human gut environment, we predicted EC codes, functional annotations, and enzyme sequences for novel microbiome drug metabolism reactions that do not yet possess a responsible, characterized enzyme (<xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>). From our literature curation of 300 non-antibiotic therapeutics affected by the microbiome (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>), we were confident that 88 are directly metabolized by gut bacteria due to their association with an identified bacterial metabolite in the literature. We formatted these 88 reactions in SMILES format and input them as queries to SIMMER.</p><p>Of the 88 reactions queried, SIMMER determined significant EC predictions for 75 reactions (86.2%), and 61 (70.1%) of these were out to the serial designation (i.e., highest resolution) EC code (<xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>). This list of 61 transformations presents reactions for which we believe enzyme characterization is worth pursuing as our predictions are significantly similar to enzymes already explored in the literature. SIMMER’s EC predictions resulted in expanded and diversified EC class membership for drug transformations known to occur in the microbiome (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). Of interest, this analysis resulted in a large expansion of putative hydrolysis, reduction, and isomerization reactions in the human gut microbiome. The number of SIMMER predictions varies widely by reaction, with median output of 372 genes, 286 genomes, and 10 phyla predicted as responsible across the 88 reactions (<xref ref-type="supplementary-material" rid="fig6sdata1">Figure 6—source data 1</xref>, <xref ref-type="fig" rid="fig6">Figure 6A</xref>). Unsurprisingly, many of these reactions are predicted to occur due to enzymes found in Firmicutes, Bacteroidetes, Actinobacteria, and Proteobacteria, but there are also SIMMER enzyme predictions in phyla not previously associated with drug metabolism (<xref ref-type="fig" rid="fig6">Figure 6B</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>SIMMER predicts novel drug metabolizing enzymes.</title><p>(<bold>A</bold>) Distributions depict the unique number of genes, strains, and phyla predicted to be responsible for 88 reported drug transformation reactions, as well as predicted gene functions. (<bold>B</bold>) A heatmap illustrating, for a given phylum, the number of unique drug-metabolizing enzymes predicted to conduct 88 different drug metabolism events. (<bold>C</bold>) Enzyme Commission Class representation for bacterial transformations of therapeutics before and after the employment of SIMMER. Our predictions greatly expand the number of characterized reduction (EC1), hydrolysis (EC2), and isomerization (EC5) events and modestly increase the number of transferase (EC2) and lyase (EC4) events.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>SIMMER's enzyme predictions (with phyogenetic annotations) and EC predictions for 88 previously uncharacterized reactions.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig6-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig6-v3.tif"/></fig></sec><sec id="s2-6"><title>Experimental validation of SIMMER predictions: MTX case study</title><p>Among the 88 uncharacterized reactions, we assessed SIMMER’s ability to predict strains and enzymes for the hydrolysis of MTX. Oral MTX is an anti-folate immunosuppressant, and the first-line therapy for individuals with rheumatoid arthritis (RA). About half of RA patients, however, show inadequate response to MTX (<xref ref-type="bibr" rid="bib52">Scher et al., 2020</xref>), and the reasons for this remain incompletely understood. This lack of efficacy may be due to altered pharmacokinetics, as oral bioavailability of MTX is subject to large inter-individual variation with values ranging from 32% to 70% (<xref ref-type="bibr" rid="bib51">Roon and Laar, 2006</xref>). MTX is estimated to undergo extensive enterohepatic circulation, which results in increased exposure to gut bacteria in the small intestine (<xref ref-type="bibr" rid="bib51">Roon and Laar, 2006</xref>). This exposure may result in MTX depletion, as it is known that MTX degrades to inactive metabolites 2,4-diamino-<italic>N</italic><sup>10</sup>-methylpteroic acid (DAMPA) and glutamate in mice with intact gut microbiomes, but not in their antibiotic treated counterparts (<xref ref-type="bibr" rid="bib63">Zaharko et al., 1969</xref>). In a recent human study, ex vivo stool samples from MTX non-responders depleted MTX to a higher degree, though the relevant strains and enzymes were not determined (<xref ref-type="bibr" rid="bib4">Artacho et al., 2021</xref>).</p><p>When queried with MTX and its gut bacteria associated metabolites DAMPA and glutamate, SIMMER calculated a most similar MetaCyc reaction (3.4.17.11-RXN) and a significant EC prediction (3.4.17.11, p-value &lt;0.001). This MetaCyc reaction describes the hydrolysis of folate into pteroate and glutamate, driven by a glutamate carboxypeptidase (Cpg2) found in environmental <italic>Pseudomonas aeruginosa</italic>. Hydrolysis of MTX is chemically similar to hydrolysis of folate (<xref ref-type="fig" rid="fig7">Figure 7A</xref>) with a Tanimoto coefficient = 0.6, and normalized euclidean distance = 0.05 in SIMMER’s precomputed chemical space. SIMMER made 2286 human gut microbiome enzyme predictions for degrading MTX into DAMPA and glutamate (<xref ref-type="supplementary-material" rid="fig7sdata1">Figure 7—source data 1</xref>). The most common Prokka annotation for these enzymes is Carboxypeptidase G2s (<xref ref-type="fig" rid="fig7">Figure 7B</xref>) due to their sequence similarity to MetaCyc’s environmental Cpg2. Furthermore, SIMMER’s predicted enzymes had a median global identity of 33% to <italic>Pseudomonas</italic> sp. RS-16 (an environmental bacterium) Cpg2, an enzyme known to conduct hydrolysis of MTX (<xref ref-type="bibr" rid="bib36">Larimer et al., 2014</xref>; <xref ref-type="bibr" rid="bib30">Jeyaharan et al., 2016</xref>). This similarity suggests that some of SIMMER’s predicted enzymes conduct hydrolysis of MTX, similar to <italic>P. aeruginosa’s</italic> Cpg2 reaction.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>SIMMER predicts methotrexate (MTX) metabolizing enzymes similar to known environmental MTX metabolizers.</title><p>(<bold>A</bold>) When queried with MTX hydrolysis to 2,4-diamino-<italic>N</italic><sup>10</sup>-methylpteroic acid (DAMPA) and glutamate, SIMMER found that folate hydrolysis was the most chemically similar MetaCyc reaction. (<bold>B</bold>) SIMMER predicted 2286 unique bacterial sequences putatively capable of MTX hydrolysis to DAMPA and glutamate. There was great variability in the prevalence and abundance of these sequences in healthy human metagenomic data. Among the strains with predictions, Firmicutes were most common. The most frequent Prokka annotation was Carboxypeptidase G2.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>SIMMER's enzyme prediction output table for MTX hydrolysis to DAMPA and glutamate: 2,286 bacterial sequences and their UHGG database identifiers, taxonomy, predicted function, and prevalence and abundance in healthy humans.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig7-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig7-v3.tif"/></fig><p>We next screened an existing collection of 42 diverse bacterial strains found in the human gut for its ability to deplete MTX. This collection was of interest due to previously determined inter-strain variation in growth inhibition by MTX (<xref ref-type="bibr" rid="bib44">Nayak et al., 2021</xref>). Each isolate was incubated with MTX (100 μg/ml), and MTX levels were determined by high-performance liquid chromatography (HPLC) (<xref ref-type="fig" rid="fig8">Figure 8</xref>). MTX depletion varied across the strain collection, with 10 isolates exhibiting at least a 50% decrease in MTX levels compared to control. There was a statistically significant concordance between SIMMER’s predictions of which strains had an enzyme capable of metabolizing MTX and our experimental results (Fisher’s exact test, odds ratio = 5.4, p-value &lt;0.05, <xref ref-type="fig" rid="fig8">Figure 8</xref>). We next examined the seven strains for which SIMMER predicted capability to perform MTX hydrolysis but where we did not observe decreased drug levels. One of these discordant strains, <italic>E. coli</italic> BW25113, possesses the multidrug resistance efflux pump AcrAB-TolC, which actively exports MTX (<xref ref-type="bibr" rid="bib35">Kopytek et al., 2000</xref>), explaining why MTX was not affected. To test if other discordant strains possessed orthologs of this efflux pump, we looked for AcrAB sequences in the genomes of all 42 bacterial strains. We found two more discordant strains with AcrAB genes: <italic>Edwardsiella tarda</italic> and <italic>Providencia rettgeri</italic> (<xref ref-type="fig" rid="fig8">Figure 8</xref>). Thus, 3/7 SIMMER predictions that did not match experimental results could be explained by the ability of drug efflux to mask the potential for enzymatic activity.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>SIMMER accurately predicted bacterial strains capable of methotrexate (MTX) depletion.</title><p>A diverse panel of 42 isolates was incubated with MTX, and depletion (yes/no) measured via HPLC (50% decrease relative to sterile controls). SIMMER predicted (yes/no) that 13 of the 42 isolates were capable of MTX metabolism, and HPLC experiments showed that 10 isolates depleted MTX (SIMMER prediction p-value = 0.046, Fisher’s exact test). The maximum likelihood phylogenetic tree (PhyML) was created using 16S rRNA gene sequences from the 42 organisms’ closest representatives in the Greengenes database.</p><p><supplementary-material id="fig8sdata1"><label>Figure 8—source data 1.</label><caption><title>Identifiers and assembly file names for 42 isolates incubated with MTX, and example HPLC traces from two MTX depleting strains.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig8-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig8-v3.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>DrugBug methotrexate (MTX) metabolism predictions.</title><p>(<bold>A</bold>) In tandem with SIMMER predictions, we evaluated DrugBug species predictions for MTX metabolism in our in vitro assay. Unlike SIMMER, DrugBug predictions did not predict a single species capable of depleting MTX in the high-performance liquid chromatography (HPLC) assay. Additionally, by this HPLC assay, we were not able to validate any of DrugBug’s predicted MTX-metabolizing strains. MicrobeFDT could not be evaluated in our in vitro assay because it does not make species or enzyme predictions. (<bold>B</bold>) Confusion matrix for SIMMER predictions. Significance was determined with a Fisher’s exact test. (<bold>C</bold>) Confusion matrix for DrugBug predictions. Significance was determined with a Fisher’s exact test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig8-figsupp1-v3.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Representative methotrexate (MTX) depletion high-performance liquid chromatography (HPLC) traces.</title><p>Representative HPLC traces of bacteria that exhibited MTX depletion. The top row represents bacteria (or sterile control) after incubation with MTX for 15 hr, and the second row represents bacteria (or sterile control) after incubation with MTX for 72 hr. The gray shaded area represents the retention time of MTX (5.5 min).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig8-figsupp2-v3.tif"/></fig></fig-group><p>As an additional comparison to DrugBug and MicrobeFDT, we assessed MTX metabolism with both tools. Both incorrectly predicted that MTX degradation is through transferases rather than hydrolases. Because DrugBug also provides species and enzyme predictions, we assessed its ability to predict species responsible for MTX metabolism. We found that only SIMMER was able to significantly predict species capable of MTX metabolism (SIMMER odds ratio = 5.4 versus DrugBug odds ratio = 0). DrugBug produced zero true positives and predicted that MTX metabolism was a feature largely restricted to members of Bacteroidetes, a group who exhibited no activity in our in vitro assay (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>).</p></sec><sec id="s2-7"><title>Evaluation of SIMMER on external datasets</title><p>We next sought to determine the relationship between abundance of SIMMER predicted MTX-metabolizing enzymes and clinical response in patients. We took advantage of a publicly available dataset in which fecal samples from treatment-naive new-onset RA patients were profiled using shotgun sequencing; these same patients were followed for 4 months and MTX responder status and disease activity (DAS28) were assessed by the authors (<xref ref-type="bibr" rid="bib4">Artacho et al., 2021</xref>). Response was defined as a DAS28 score improvement of at least 1.8 points at 4 months of MTX therapy (<xref ref-type="bibr" rid="bib4">Artacho et al., 2021</xref>). Of SIMMER’s 2286 enzyme predictions for MTX hydrolysis, 386 were detected in the fecal samples of RA patients at baseline (prior to treatment). MTX non-responders exhibited a significant enrichment of SIMMER MTX predictions in their stool samples (<xref ref-type="fig" rid="fig9">Figure 9A</xref>). Similarly, a significant negative correlation was seen between patients’ disease score improvements and abundance of SIMMER enzyme predictions (<xref ref-type="fig" rid="fig9">Figure 9B</xref>). These data, combined with our HPLC validation and prior ex vivo incubations linking non-response to increased MTX metabolism (<xref ref-type="bibr" rid="bib4">Artacho et al., 2021</xref>), emphasize the utility of using SIMMER to uncover clinically relevant drug–microbe interactions.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>SIMMER enzyme predictions are enriched in methotrexate (MTX) non-responders.</title><p><italic>N</italic> = 368 of SIMMER predicted sequences for MTX hydrolysis were found in new-onset RA patients with variable MTX response. (<bold>A</bold>) SIMMER enzyme predictions (normalized by read depth) were enriched in MTX non-responders (Generalized Linear Model (GLM) Poisson, p-value = 0.001), and (<bold>B</bold>) a significant negative association between disease severity improvement and number of SIMMER enzyme predictions (normalized by read depth) was observed (Pearson correlation = −0.4, Student’s <italic>t</italic>-test p-value = 0.01).</p><p><supplementary-material id="fig9sdata1"><label>Figure 9—source data 1.</label><caption><title>Disease activity (DAS28) scores, MTX response status, and number of SIMMER predicted enzymes for RA patients.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig9-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig9-v3.tif"/></fig><p>Next, we sought experimental evidence for other novel transformations with SIMMER predictions. The side-chain cleavage of dexamethasone to 17-oxodexamethasone is one example. Dexamethasone was recently shown to be metabolized solely by <italic>Clostridium scindens</italic> (ATCC 35704) out of a collection of 76 isolates representative of the human gut microbiome (<xref ref-type="bibr" rid="bib66">Zimmermann et al., 2019b</xref>). When the authors assessed dexamethasone metabolism in 28 shotgun sequenced human stool samples, metabolite formation varied substantially by individual, but could not be explained by <italic>C. scindens</italic> species abundance. To explore this lack of correlation in light of our findings, we assessed the abundance of <italic>C. scindens</italic> SIMMER enzyme predictions (<xref ref-type="supplementary-material" rid="fig10sdata1">Figure 10—source data 1</xref>) within each of the 28 samples (i.e., the number of <italic>C. scindens</italic> SIMMER enzyme predictions aligned to each sample’s shotgun sequencing reads) rather than each sample’s <italic>C. scindens</italic> species relative abundance. We found a significant association between metabolite formation and number of SIMMER enzyme aligned reads, and also a significant association between parent compound consumption and number of SIMMER enzyme aligned reads (<xref ref-type="fig" rid="fig10">Figure 10B</xref>). This underscores the importance of identifying an enzyme and quantifying its presence in metagenomic data.</p><fig-group><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>SIMMER predicted enzymes explain inter-individual variations in drug metabolism.</title><p>(<bold>A</bold>) Donors (<italic>N</italic> = 20) from the Javdan et al. 16S rRNA gene sequencing study (<xref ref-type="bibr" rid="bib29">Javdan et al., 2020</xref>) possessed an enrichment of genomes harboring SIMMER enzyme predictions when metabolism of a given drug was observed. Violin plot curves were made using a seaborn package that performs a kernel density estimation of the underlying datapoint distribution. Chemical transformations were drawn using ChemDraw software. Single asterisks denote p-values ≤0.05, and double asterisks denote p-values ≤0.01 (<italic>t</italic>-test). (<bold>B</bold>) There was a significant correlation between a human stool sample’s ability to consume dexamethasone (consumption slope, a.u.), to produce 17-oxodexamethasone (production slope, a.u.), and the number of aligned SIMMER predicted sequences for side-chain cleavage of dexamethasone. Patient (<italic>N</italic> = 28) conversion slopes and metagenomics data were accessed from the original study (<xref ref-type="bibr" rid="bib66">Zimmermann et al., 2019b</xref>). Chemical structures were drawn using ChemDraw software.</p><p><supplementary-material id="fig10sdata1"><label>Figure 10—source data 1.</label><caption><title>SIMMER predictions for previously published drug metabolism studies.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-82401-fig10-data1-v3.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig10-v3.tif"/></fig><fig id="fig10s1" position="float" specific-use="child-fig"><label>Figure 10—figure supplement 1.</label><caption><title>Dexamethasone metabolism is not significantly correlated with presence of <italic>desAB</italic>.</title><p>There was not a significant correlation between a human stool sample’s ability to consume dexamethasone (consumption slope, a.u.) or to produce 17-oxodexamethasone (production slope, a.u.), and the number of aligned <italic>desAB</italic> sequences. Patient (<italic>N</italic> = 28) conversion slopes and metagenomics data were accessed from the original study (<xref ref-type="bibr" rid="bib66">Zimmermann et al., 2019b</xref>). This adds confidence to the finding described in <xref ref-type="fig" rid="fig7">Figure 7B</xref>, as it means SIMMER enzyme predictions were not correlated with dexamethasone metabolism due to co-occurrence in <italic>C. scindens</italic> with a gene previously reported to underlie bacterial side-chain cleavage of steroids (<xref ref-type="bibr" rid="bib37">Ly et al., 2020</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig10-figsupp1-v3.tif"/></fig></fig-group><p>It came to our attention while preparing this manuscript that recombinant steroid-17,20-desmolase (DesAB) enzymes from <italic>C. scindens</italic> were shown to perform side-chain cleavage on prednisone, but also to a lesser extent on dexamethasone. DesAB’s reduced activity for dexamethasone was assumed to be due to the compound’s potentially inhibitory 16α-methyl group (<xref ref-type="bibr" rid="bib37">Ly et al., 2020</xref>). To ensure that SIMMER’s enzyme prediction for dexamethasone cleavage was not enriched in metabolizing stool samples due to co-occurrence with already known DesAB, we next assessed the abundance of <italic>desAB</italic> reads across the 28 samples and found no significant correlation between number of reads and either metabolite formation or dexamethasone consumption slopes (<xref ref-type="fig" rid="fig10s1">Figure 10—figure supplement 1</xref>). These results indicate that species-level information alone is not enough to predict chemical transformations in a microbiome sample, but with SIMMER, knowledge of responsible enzymes can recapitulate a sample’s potential for therapeutic degradation.</p><p>Lastly, eight of the 88 novel transformations were among those investigated in a high-throughput study exploring the metabolism of 571 compounds in ex vivo stool samples (<xref ref-type="bibr" rid="bib29">Javdan et al., 2020</xref>). This publication demonstrated bacterial degradation of 57 therapeutics in a single pilot donor stool sample (with associated shotgun sequencing), as well as in 20 human stool samples (with associated 16S rRNA gene sequencing). While this study greatly expanded the number of drugs known to break down in the presence of gut bacteria and identified eight metabolite structures, it only identified a responsible enzyme in two of the 57 drug degradation cases due to the low-throughput nature of enzyme characterization. To further assess SIMMER’s ability to predict novel enzymes, and to demonstrate the utility of using SIMMER in an experimental context, we investigated the presence of our predictions in the Javdan et al. study sequencing results. Because shotgun metagenomics sequencing for the pilot donor was deposited, we were able to confirm via tBLASTn searches that SIMMER enzyme predictions were directly found in the pilot donor stool sample for all eight of the reactions with identified metabolites (<xref ref-type="supplementary-material" rid="fig10sdata1">Figure 10—source data 1</xref>). However, the sequencing data from the 20 human donor study were only 16S profiling, so we were unable to look directly for SIMMER enzyme predictions. We instead ensured that genomes found in metabolizing stool samples were SIMMER species predictions. We found that donors who could metabolize a given drug possessed a significant enrichment of species predicted by SIMMER. This was the case for five out of the six reactions analyzed (<xref ref-type="supplementary-material" rid="fig10sdata1">Figure 10—source data 1</xref>, <xref ref-type="fig" rid="fig10">Figure 10A</xref>). This result validates SIMMER’s ability to predict species potentially able to perform a queried metabolic reaction, though additional data would be needed to confirm that the strains in these 20 donors had the predicted enzyme.</p></sec><sec id="s2-8"><title>SIMMER software</title><p>In addition to providing SIMMER (<ext-link ext-link-type="uri" xlink:href="https://github.com/aebustion/SIMMER">https://github.com/aebustion/SIMMER</ext-link>, copy archived at <xref ref-type="bibr" rid="bib11">Bustion, 2023</xref>) as a command-line tool that quickly generates enzyme sequence predictions (fasta and tab-separated-value files), EC predictions (tab-separated-value file), and MetaCyc reactions ranked by similarity (tab-separated-value file) based on a user’s input reaction, SIMMER is also available as a user-friendly website (<ext-link ext-link-type="uri" xlink:href="https://simmer.pollard.gladstone.org/">https://simmer.pollard.gladstone.org/</ext-link>). The user can either input one query reaction at a time or upload multiple reactions in tsv file format (<xref ref-type="fig" rid="fig11">Figure 11</xref>). All output types available with the SIMMER command-line tool are likewise retrievable via the SIMMER website. SIMMER’s underlying chemical and protein databases will be updated whenever major releases of MetaCyc that result in new enzyme-annotated reactions are released (estimated to be once a year).</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>SIMMER web tool.</title><p>The landing page for the SIMMER website (<ext-link ext-link-type="uri" xlink:href="https://simmer.pollard.gladstone.org/">https://simmer.pollard.gladstone.org/</ext-link>) allows the user to upload a TSV file of queries or add a single query manually to run SIMMER on. It is recommended to use the command-line tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/aebustion/SIMMER">https://github.com/aebustion/SIMMER</ext-link>; <xref ref-type="bibr" rid="bib11">Bustion, 2023</xref>) for more than 10 input queries.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-fig11-v3.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this work, we created a tool that appropriately describes reaction chemistry and harnesses all current information on gut bacterial sequences, both from isolates and metagenome assembled genomes. This advances our ability to discover the genetic determinants of human microbiome chemical transformations, because previous methods for in silico metabolism prediction had several key limitations, including low accuracy. Here, we demonstrated SIMMER’s ability to recover known drug-metabolizing enzymes in the human gut, performed the first species-level characterization of MTX metabolism by bacteria in the human gut microbiome, and extended previous experimental findings for multiple drug metabolism events by identifying candidate species and enzymes.</p><p>To describe chemical reactions, we were initially influenced by recent research that employed substrate and product chemistry to compare bacterial-drug metabolism events to primary reactions in the MetaCyc database, but without the end goal of EC and enzyme identity prediction (<xref ref-type="bibr" rid="bib39">Mallory et al., 2018</xref>). From a reaction description standpoint, the published method was still limited in that it only included a description of one substrate and one product per reaction, precluding it from utilizing cofactors and from accurately describing anything other than intramolecular rearrangements (EC class 5, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). For this reason, we employed a chemical representation technique that can describe multiple inputs and outputs for a single reaction (<xref ref-type="bibr" rid="bib53">Schneider et al., 2015</xref>).</p><p>To connect these chemical descriptions to bacterial proteins in the human gut, we knew it was important not to rely on EC codes (as previous methods have done) to find relevant enzyme sequences. While EC codes are helpful for describing reaction types, they are not sufficient for predictions of microbiome orthologs due to the paucity of functional annotations in microbiome datasets (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>; <xref ref-type="bibr" rid="bib59">Thomas and Segata, 2019</xref>). Even when present, EC entries are sometimes incomplete, with about 36% of assigned EC numbers lacking either a gene or protein sequence (<xref ref-type="bibr" rid="bib49">Pouliot and Karp, 2007</xref>). Lastly, EC nomenclature fails to adequately express the complexity of peptidase enzymes (EC 3.4, about 10% of the enzymes currently classified by EC). All peptidases catalyze a nearly identical reaction, hydrolysis of a peptide bond, and as a result, the EC has lumped peptidases of diverse functions into only a few low-resolution sub-classes (<xref ref-type="bibr" rid="bib42">McDonald and Tipton, 2023</xref>; <xref ref-type="bibr" rid="bib41">McDonald and Tipton, 2014</xref>). For these reasons, we instead chose to create sequence searches of large genome databases directly from enzymes known to conduct chemically similar reactions, whether or not they have been fully annotated with an EC code.</p><p>When comparing database entries based on sequence similarity, the algorithm employed plays a critical role. Homology searches in pharmacomicrobiomics research are often conducted using pairwise search algorithms such as BLAST (<xref ref-type="bibr" rid="bib3">Altschul et al., 1990</xref>). A limitation of this method is that substitutions, deletions, and insertions are penalized by a set amount, regardless of where in the alignment they occur. For a given collection of functional enzymes, however, sequence conservation varies at different sites in the protein, as a result of differing strengths of selection pressures on different residues (i.e., high conservation at active sites versus low conservation in disordered domains). This position-specific information can be leveraged by performing homology searches with pHMMs, which encode protein family evolutionary patterns present in a multiple sequence alignment (<xref ref-type="bibr" rid="bib19">Eddy, 1998</xref>). In the antibiotic resistance protein space, for example, pHMMs that incorporate position-specific information have found distant homologs with retained function not recovered via pairwise search methods (<xref ref-type="bibr" rid="bib24">Gibson et al., 2015</xref>). pHMM searches are an improvement over BLAST from the standpoint of finding distant homologs and from the standpoint of finding targets with retained activity, as previous research has shown that global sequence identity does not necessarily map to similar function (<xref ref-type="bibr" rid="bib23">Gerlt et al., 2012</xref>; <xref ref-type="bibr" rid="bib34">Koppel et al., 2018</xref>). While an improvement, pHMM methods can still be uncorrelated with functional similarity and SIMMER enzyme predictions will include many false positives and require experimental validation. The goal of SIMMER, therefore, is to prioritize and limit the set of possible experiments one might do rather than to replace experiments.</p><p>SIMMER achieved high accuracy when applied to known drug metabolism events in the gut microbiome. Correct EC designations and enzyme sequences were recovered for 33 drug metabolism events previously characterized in microbiome literature. These reactions span multiple EC classes, and were described by multiple publications, demonstrating the wide application and accuracy of SIMMER. While SIMMER provides accurate (i.e., true positive) enzyme predictions for chemical transformations in the human gut, the potential for false positives may be high, as its enzyme lists are not filtered by biologically relevant metrics like substrate affinity or flux consistency in a microbial community. To the former point, users may wish to employ tools like Similarity Ensemble Approach to narrow in on hits most likely to interact with compounds of interest (<xref ref-type="bibr" rid="bib31">Keiser et al., 2007</xref>). To the latter, a user could choose to further analyze their SIMMER output for flux balance if the predicted SIMMER bacterial species are described in current metabolic reconstruction models (<xref ref-type="bibr" rid="bib27">Heinken et al., 2020</xref>; <xref ref-type="bibr" rid="bib38">Magnúsdóttir et al., 2017</xref>).</p><p>Due to its accurate predictions of previously described drug-metabolizing bacterial enzymes, we also used SIMMER to identify previously unknown bacterial species and enzymes at play in known gut microbiome drug transformations. Recent high-throughput experimental research has greatly increased our knowledge of the number of drugs altered by bacteria in the human gut, but has led to a bottleneck in identifying the responsible bacterial enzymes. While direct experimentation is a necessary component to elucidating the bacterial players responsible, in silico methods like SIMMER are needed to help prioritize which of the many bacterial species and enzymes to assess. Here, we showed that SIMMER both corroborates previous high-throughput experimental data, and also adds increased clarity to the findings. While a previous experimental study was able to elucidate the importance of an isolate <italic>C. scindens</italic> in the metabolism of dexamethasone, the abundance of <italic>C. scindens</italic> in human samples did not correlate with metabolism. When assessed with SIMMER, however, a significant correlation between metabolite production and abundance of SIMMER enzyme predictions was observed. This finding demonstrates that species identity alone is not enough to explain bacterial chemical transformation, and that responsible genetic elements must be interrogated as well.</p><p>Lastly, we used SIMMER to perform the first species-level characterization of MTX metabolism by bacteria in the human gut microbiome. While it has been suspected for some time now that inter-individual variation in patient response to oral MTX may be due to bacterial hydrolysis of the therapeutic, no characterizations have yet been made of the species of enzymes responsible. We demonstrated the utility of using SIMMER in such a use-case. The most similar MetaCyc reaction to MTX hydrolysis, folate hydrolysis, that SIMMER identified makes much logical sense based on substrate and metabolite structures, and overall reaction chemistry. Further adding confidence to SIMMER’s sequence predictions was their enrichment in the shotgun sequenced stool samples of RA patients exhibiting little response to MTX treatment. This finding plus our demonstration that human gut bacterial species are capable of depleting MTX in isolation provides provides additional support for the role of gut bacterial drug metabolism in interfering with the treatment of RA.</p><p>Two previous computational tools exist for describing non-antibiotic microbial drug metabolism. MicrobeFDT groups thousands of compounds based on their similarity to one another and annotates compound groups based on any known links to EC numbers, and subsequently, microbes known to contain such EC codes (<xref ref-type="bibr" rid="bib26">Guthrie et al., 2019</xref>). This network approach was an important addition to the exploration of microbiome metabolism, but its use is limited to a fixed database of chemicals and EC annotations which prevents the user from exploring novel chemistry and also from utilizing hypothetical protein data gathered from metagenomic sequencing studies. Furthermore, MicrobeFDT’s accuracy within its database of substrates is limited by its exclusive description of substrates rather than full reactions. DrugBug, a tool that employs Random Forests rather than a network approach, also exhibits limited power and accuracy due to its sole reliance on substrate chemistry and relatively small database of only 491 isolated bacterial genomes from the human gut (<xref ref-type="bibr" rid="bib55">Sharma et al., 2017</xref>). Of note, our comparison of SIMMER’s performance to existing methods necessitated downloading and analyzing our positive control list against the other tools, as none of the previous publications provided any computational validation or accuracy metrics.</p><p>One user pitfall of SIMMER in comparison to previous methods, is that a reaction’s product(s) and cofactor(s) identity is required to achieve the high accuracy enzyme predictions described here. This is a limitation, as a growing amount of liquid chromatography–mass spectrometry (LC–MS)/MS data in microbiome research only reports whether or not a compound is depleted in the microbiome and the mass/charge ratio of the product formed, not the product identity. While it is technically possible for the user to submit a SIMMER query that only consists of a substrate, or uses a compound identity as both substrate and product, we do not recommend this due to the previously discussed lack of accuracy when only considering substrates (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>). For users wishing to utilize SIMMER with a compound of interest and its either unknown or uncharacterized products, additional tools such as BioTransformer could be used in tandem to create product template predictions before querying (<xref ref-type="bibr" rid="bib17">Djoumbou-Feunang et al., 2019</xref>). Lastly, if the user does not hold a certain level of knowledge in chemistry, appropriate cofactors (such as water employed in a hydrolysis event) might be omitted from a query, leading to lower accuracy predictions. If a user is unsure which cofactors may be at play in their reaction of interest, reaction rules tools such as RetroRules could be employed (<xref ref-type="bibr" rid="bib18">Duigou et al., 2019</xref>).</p><p>Another limitation of SIMMER is that its underlying protein data is solely metagenomics data from the human gastrointestinal tract, but some compounds, such as the vaginal gel tenofovir, are known to be altered by bacteria in non-GI tract settings (<xref ref-type="bibr" rid="bib32">Klatt et al., 2017</xref>). That being said, for transformations in the human gut, SIMMER employs the largest available database of relevant bacterial sequences, and the tool could easily be expanded in the future to include other human body sites as well as non-host associated environments. Further related to database constraints, while SIMMER is novel in its ability to query reactions not previously described in chemistry databases, its search space is still limited to reactions that broadly relate to those captured in MetaCyc. While MetaCyc is the largest annotated bacterial reaction database to date (<xref ref-type="bibr" rid="bib2">Altman et al., 2013</xref>; <xref ref-type="bibr" rid="bib13">Caspi et al., 2020</xref>), it likely only represents a fraction of the still underexplored microbiome catalyzed biotransformation space. Additionally, the chemistry present in MetaCyc is not restricted to anaerobic organisms such as the bacteria found in the human gut. As MetaCyc expands, or additional databases get employed, SIMMER will be able to make increasingly fine-tuned predictions.</p><p>SIMMER enters microbiome biotransformation research at an important point: while there are hundreds of microbiome altered compounds which are in need of enzyme identification, there are also a sufficient number with characterized enzymes to enable us to test the tool’s accuracy. Its ability to predict these known enzymes accurately builds confidence for its predictions of yet unknown enzymes. With this tool in hand, microbiome researchers can make informed hypotheses before embarking on the lengthy laboratory experiments required to characterize novel bacterial enzymes that can alter human ingested compounds. Continued refinement of SIMMER and other computational tools will accelerate microbiome research, providing data-driven hypotheses for experimental testing and a first step toward understanding the full scope of metabolism by the human microbiome.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Chemical compound, drug</td><td align="left" valign="bottom">Methotrexate</td><td align="left" valign="bottom">Sigma-Aldrich</td><td align="left" valign="bottom">M9929-100MG</td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides thetaiotaomicron</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides thetaiotaomicron</italic></td><td align="left" valign="bottom">DSM 2079</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Clostridium asparagiforme</italic>)</td><td align="left" valign="bottom"><italic>Clostridium asparagiforme</italic></td><td align="left" valign="bottom">DSM 15981</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Clostridium sporogenes</italic>)</td><td align="left" valign="bottom"><italic>Clostridium sporogenes</italic></td><td align="left" valign="bottom">ATCC 15579</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Clostridium symbiosum</italic>)</td><td align="left" valign="bottom"><italic>Clostridium symbiosum</italic></td><td align="left" valign="bottom">DSM 934</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Akkermansia muciniphila</italic>)</td><td align="left" valign="bottom"><italic>Akkermansia muciniphila</italic></td><td align="left" valign="bottom">DSM 22959</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Alistipes shahii</italic>)</td><td align="left" valign="bottom"><italic>Alistipes shahii</italic></td><td align="left" valign="bottom">DSM 19121</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides caccae</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides caccae</italic></td><td align="left" valign="bottom">DSM 19024</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides eggerthii</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides eggerthii</italic></td><td align="left" valign="bottom">DSM 20697</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides finegoldii</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides finegoldii</italic></td><td align="left" valign="bottom">DSM 17565</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides fragilis</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides fragilis</italic></td><td align="left" valign="bottom">DSM 2151</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides ovatus</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides ovatus</italic></td><td align="left" valign="bottom">DSM 1896</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides stercoris</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides stercoris</italic></td><td align="left" valign="bottom">DSM 19555</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides uniformis</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides uniformis</italic></td><td align="left" valign="bottom">DSM 6597</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides vulgatus</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides vulgatus</italic></td><td align="left" valign="bottom">DSM 1447</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bacteroides xylanisolvens</italic>)</td><td align="left" valign="bottom"><italic>Bacteroides xylanisolvens</italic></td><td align="left" valign="bottom">DSM 18836</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Bifidobacterium longum</italic>)</td><td align="left" valign="bottom"><italic>Bifidobacterium longum subsp longum</italic></td><td align="left" valign="bottom">DSM 20219</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Blautia producta</italic>)</td><td align="left" valign="bottom"><italic>Blautia producta</italic></td><td align="left" valign="bottom">DSM 3507</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Clostridium innocuum</italic>)</td><td align="left" valign="bottom"><italic>Clostridium innocuum</italic></td><td align="left" valign="bottom">DSM 1286</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Clostridium scindens</italic>)</td><td align="left" valign="bottom"><italic>Clostridium scindens</italic></td><td align="left" valign="bottom">DSM 5676</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Collinsella aerofaciens</italic>)</td><td align="left" valign="bottom"><italic>Collinsella aerofaciens</italic></td><td align="left" valign="bottom">DSM 3979</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Dorea formicigenerans</italic>)</td><td align="left" valign="bottom"><italic>Dorea formicigenerans</italic></td><td align="left" valign="bottom">DSM 3992</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Dorea longicatena</italic>)</td><td align="left" valign="bottom"><italic>Dorea longicatena</italic></td><td align="left" valign="bottom">DSM 13814</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Edwardsiella tarda</italic>)</td><td align="left" valign="bottom"><italic>Edwardsiella tarda</italic></td><td align="left" valign="bottom">ATCC 23685</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eggerthella lenta</italic>)</td><td align="left" valign="bottom"><italic>Eggerthella lenta 1-3-56</italic></td><td align="left" valign="bottom">DSM 110906</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eggerthella lenta</italic>)</td><td align="left" valign="bottom"><italic>Eggerthella lenta</italic></td><td align="left" valign="bottom">DSM 2243</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eggerthella sinensis</italic>)</td><td align="left" valign="bottom"><italic>Eggerthella sinensis</italic></td><td align="left" valign="bottom">DSM 16107</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eggerthella sp</italic>.)</td><td align="left" valign="bottom"><italic>Eggerthella</italic> sp.</td><td align="left" valign="bottom">DSM 11767</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Enterococcus faecalis</italic>)</td><td align="left" valign="bottom"><italic>Enterococcus faecalis</italic></td><td align="left" valign="bottom">DSM 2570</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom"><italic>Escherichia coli BW25113</italic></td><td align="left" valign="bottom">DSM 27469</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eubacterium eligens</italic>)</td><td align="left" valign="bottom"><italic>Eubacterium eligens</italic></td><td align="left" valign="bottom">DSM 3376</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eubacterium hallii</italic>)</td><td align="left" valign="bottom"><italic>Eubacterium hallii</italic></td><td align="left" valign="bottom">DSM 3353</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Eubacterium rectale</italic>)</td><td align="left" valign="bottom"><italic>Eubacterium rectale</italic></td><td align="left" valign="bottom">DSM 17629</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Faecalibacterium prausnitzii</italic>)</td><td align="left" valign="bottom"><italic>Faecalibacterium prausnitzii</italic></td><td align="left" valign="bottom">DSM 17677</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Fusobacterium nucleatum</italic>)</td><td align="left" valign="bottom"><italic>Fusobacterium nucleatum subsp. nucleatum</italic></td><td align="left" valign="bottom">DSM 15643</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Gordonibacter pamelae</italic>)</td><td align="left" valign="bottom"><italic>Gordonibacter pamelae</italic></td><td align="left" valign="bottom">DSM 110924</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Lactococcus lactis</italic>)</td><td align="left" valign="bottom"><italic>Lactococcus lactis</italic></td><td align="left" valign="bottom">DSM 20481</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Lactonifactor longoviformis</italic>)</td><td align="left" valign="bottom"><italic>Lactonifactor longoviformis</italic></td><td align="left" valign="bottom">DSM 17459</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Parabacteroides distasonis</italic>)</td><td align="left" valign="bottom"><italic>Parabacteroides distasonis</italic></td><td align="left" valign="bottom">DSM 20701</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Parabacteroides merdae</italic>)</td><td align="left" valign="bottom"><italic>Parabacteroides merdae</italic></td><td align="left" valign="bottom">DSM 19495</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Prevotella copri</italic>)</td><td align="left" valign="bottom"><italic>Prevotella copri</italic></td><td align="left" valign="bottom">DSM 18205</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Providencia rettgeri</italic>)</td><td align="left" valign="bottom"><italic>Providencia rettgeri</italic></td><td align="left" valign="bottom">DSM 4542</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Strain, strain background (<italic>Ruminococcus obeum</italic>)</td><td align="left" valign="bottom"><italic>Ruminococcus obeum</italic></td><td align="left" valign="bottom">DSM 25238</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Preparation of SIMMER’s underlying chemical data</title><p>13,387 gene-annotated, enzyme-driven bacterial reactions were downloaded from MetaCyc version 24.1 (<xref ref-type="bibr" rid="bib12">Caspi et al., 2008</xref>). Each reaction contained Simplified Molecular Input Line Entry System strings (SMILES) of reactant(s) and product(s) and UniProt or Entrez identifiers for sequences that catalyze the reaction (we also had access to an expanded list of sequence annotations for these reactions from a personal correspondence with Peter Karp of MetaCyc). All MetaCyc compounds were then protonated based on the pH environment of 7.4 in the human small intestine, where most oral drug absorption occurs. Protonation states were calculated using ChemAxon’s cxcalc majorms software (<xref ref-type="bibr" rid="bib14">ChemAxon, 2023</xref> ).</p><p>RDKit’s rdChemReactions module was employed to create chemical fingerprints representing each MetaCyc reaction. Chemical reaction objects were constructed from reaction SMILES arbitrary target specification (SMARTS) strings. Fingerprints for these reactions were then created using the resulting difference of product(s) and reactant(s) Atom-Pair fingerprints (<xref ref-type="bibr" rid="bib53">Schneider et al., 2015</xref>). SIMMER users can also opt to use Topological Torsion, Pattern, or RDKit fingerprints, but unless otherwise stated, all analyses in this manuscript use Atom-Pair difference fingerprints. Of the 13,387 MetaCyc reactions, 8914 were able to be fingerprinted using this method. Failed fingerprints were due to ambiguous SMILES identifiers or presence of non-small-molecule compounds in a reaction, such as peptides.</p><p>After creating fingerprint vectors for all MetaCyc reactions, an 8914 by 8914 pairwise similarity matrix of Tanimoto coefficients was created. These Tanimoto vectors make up SIMMER’s underlying chemical data.</p></sec><sec id="s4-2"><title>Preparation of SIMMER’s underlying protein data</title><p>For each of the 8914 fingerprinted MetaCyc reactions, all relevant gene sequences were retrieved from the MetaCyc reaction’s UniProt and Entrez database linkouts and additional sequence data acquired from Peter Karp at MetaCyc. If at least two genes, with a median pairwise sequence similarity greater than or equal to 27%, were linked to a given MetaCyc reaction, the sequences were used to create a multiple sequence alignment and subsequent pHMM using Clustal Omega and HMMER3 (version 3.2.1) software, respectively (<xref ref-type="bibr" rid="bib20">Eddy, 2009</xref>; <xref ref-type="bibr" rid="bib56">Sievers and Higgins, 2014</xref>). This similarity cutoff was chosen based on previous protein family literature (<xref ref-type="bibr" rid="bib43">Mi et al., 2021</xref>). If fewer than two genes, or genes with less than 27% global similarity, were associated with a given MetaCyc reaction, a pHMM of the MetaCyc gene(s) PANTHER subfamily was retrieved via InterPro linkouts (<xref ref-type="bibr" rid="bib43">Mi et al., 2021</xref>). MetaCyc derived and PANTHER subfamily pHMMS were then queried against a UHGG collection of 286,997 isolate genomes and metagenome assembled genomes from the human gut environment using the HMMER3 hmmsearch module (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>; <xref ref-type="bibr" rid="bib20">Eddy, 2009</xref>). In the case of MetaCyc reactions with too few sequences, too low a median pairwise sequence identity, <italic>and</italic> a missing PANTHER database subfamily pHMM, single sequence protein queries were conducted against the UHGG databse using HMMER3’s phmmer module, which internally created protein profiles for the single query sequences based on a position-independent scoring system. Resulting enzyme hit lists were filtered to only include high significance hits (e-value &lt; 1E − 5, and hit length ≥ half of the input pHMM alignment or single sequence length). In sum, for each MetaCyc reaction, a profile representing the diversity of the enzyme family for that chemical transformation was used to find sequence similar hits in the human gut microbiome that can mediate chemically similar reactions.</p><p>Each human gut microbiome hit was further described by the identity, prevalence, and abundance of the bacterial strain in which it resides. To establish prevalence and abundance of UHGG strains, metagenomic analysis was performed on the Predict (Personalized Responses to Dietary Composition Trial) cohort due to its high number of samples and favorable sequencing depth (<xref ref-type="bibr" rid="bib5">Asnicar et al., 2021</xref>). Shotgun metagenomic reads were analyzed with MIDAS2 an implementation of Metagenomic Intra-Species Diversity Analysis Subcommands (MIDAS) (<xref ref-type="bibr" rid="bib45">Nayfach et al., 2016</xref>; <xref ref-type="bibr" rid="bib64">Zhao et al., 2022</xref>) designed for the UHGG database. Presence of a SIMMER predicted species in a given sample was established when reads mapped (HS-BLASTN) to 15 single-copy universal genes for that species (<xref ref-type="bibr" rid="bib15">Chen et al., 2015</xref>), with at least 75% alignment coverage. To assess the gene content of a sample, shotgun metagenomic reads were aligned to a MIDAS2 created pangenome of the SIMMER species’ genes clustered at 99% nucleotide identity. Copy number of a SIMMER gene prediction was established by dividing aligned prediction reads by the full length of the prediction. This number was then normalized by the read coverage of 15 single-copy universal genes in the same sample to estimate copy number per cell. Presence of a SIMMER enzyme was established if at least 0.35 gene copies per cell were present in a sample.</p><p>Phylogenetic trees were also constructed for each hmmsearch and phmmer result. For each set of MetaCyc reaction human gut microbiome enzyme hits, CD-HIT was used to cluster results at 95% identity (<xref ref-type="bibr" rid="bib22">Fu et al., 2012</xref>). Then MUSCLE was used to create a multiple sequence alignment for input to FastTree (<xref ref-type="bibr" rid="bib21">Edgar, 2004</xref>; <xref ref-type="bibr" rid="bib50">Price et al., 2009</xref>). Compact tree visualizations were made in R using ggtree and ggtreeExtra (<xref ref-type="bibr" rid="bib61">Xu et al., 2021</xref>; <xref ref-type="bibr" rid="bib62">Yu et al., 2017</xref>). All tree tips were colored by phylum and surrounded by circle annotators describing a given hit’s Prokka predicted function, genome type (i.e., from an isolate or metagenome assembled genome), and prevalence/abundance in the Predict cohort (<xref ref-type="bibr" rid="bib54">Seemann, 2014</xref>).</p></sec><sec id="s4-3"><title>Query functionality of SIMMER</title><p>The query functionality of SIMMER was designed similar to the precomputed chemistry data. After receiving an input chemical transformation (or tsv describing multiple input reactions) in the form of SMILES, SIMMER fingerprints the reaction(s) and compares it to the precomputed chemical space by computing the Tanimoto coefficients between the input(s) and all precomputed reactions. The 8914 precomputed MetaCyc reaction Tanimoto vectors are then sorted by ascending euclidean distance to the query Tanimoto vector. SIMMER by default ranks reactions’ euclidean distances based directly on the Tanimoto vectors, but if a user’s inputs require a decrease in computational burden, PCA can be employed after similarity matrix creation and before euclidean distance rankings. The number of PCs to be used depends on the fingerprint style employed and was determined by the Kaiser criterion. Unless otherwise stated, all analyses in this manuscript employed the full Tanimoto similarity matrix with no PCA reduction. Human gut microbiome enzymes that may conduct the input reaction are reported from the precomputed UHGG hmmsearch or phmmer results of the closest euclidean distance MetaCyc reaction. Significantly enriched EC identities (i.e., reaction types) are also reported.</p></sec><sec id="s4-4"><title>Reaction type predictions</title><p>SIMMER predicts an EC code (i.e., reaction type) for a query reaction if there is an enrichment of a particular EC at the top of the reaction list. Enrichment was determined in a manner similar to GSEA (<xref ref-type="bibr" rid="bib58">Subramanian et al., 2005</xref>). For each EC code associated with MetaCyc reactions, an enrichment score (ES) was calculated by walking down the ranked list of reactions. Starting with a score of zero, each time the given EC is encountered the score increases by one, and each time a different EC is encountered the score decreases by one. At the end of this process, each EC receives an ES that is the score’s maximum distance from zero after walking through the list (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>). Because the MetaCyc database of reactions is unbalanced in its EC code representation, ES scores for a given EC type are divided by the number of times the EC in question occurs in the database. This yields a normalized ES (NES) for SIMMER reporting. Significance is established by comparing the true NES to the NES achieved from 1000 permutations of a shuffled reaction list (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B, C</xref>). When multiple EC codes are predicted as significant, they are ranked in ascending order of where in the list of 8914 reactions the NES occurs. This method was verified by subsampling the database of MetaCyc reactions to equal numbers (<italic>N</italic> = 96) of reactions for each EC class, the broadest resolution level of an EC code. Each of these subsampled reactions was then queried with SIMMER against the entire MetaCyc reaction database to create sorted reaction lists for each query. SIMMER predicted an EC code(s) for each reaction based on the most highly enriched EC. SIMMER’s recall, precision, and accuracy are high for EC class, sub-class, and sub-sub-class level resolution (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). For the serial designation of an EC code (the most granular description of an EC code), however, SIMMER’s performance diminished, potentially because enrichment calculations suffer from increased uniqueness in the ranked list and therefore reduced power to determine a match (<xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>). This indeed appears to be the case; when the database is subsampled to ensure at least three of each unique serial designation, <italic>F</italic>1-scores (the harmonic mean of precision and recall) and accuracy remain high despite the increased EC resolution (<xref ref-type="supplementary-material" rid="fig2sdata1">Figure 2—source data 1</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>).</p></sec><sec id="s4-5"><title>Euclidean distance silhouette scores</title><p>To analyze SIMMER’s resilience to different reaction chemistry representations, we created a silhouette-like euclidean distance score. For the precomputed MetaCyc chemical dataset of 8914 reactions (i.e., the Tanimoto pairwise similarity matrix), we split all reactions into their top-level EC codes (i.e., EC class) and determined for each reaction its euclidean distance to all reactions within its EC class versus outside its EC class. From the two distributions (within EC and without EC distances) created, we computed a Kolmogorov statistic to determine if the distributions significantly (p &lt; 0.05) differed. We repeated this process for finer resolution EC classifications (sub-class, sub-sub-class, and serial designation). Euclidean distance silhouette scores were used to compare different chemical representations, such as fingerprint style, inclusion of products, and inclusion of cofactors.</p></sec><sec id="s4-6"><title>Relationship between SIMMER’s underlying chemical and protein data</title><p>For MetaCyc enzymes (<italic>N</italic> = 34,279) associated with multiple reactions, one reaction was used as a SIMMER query, and the other reaction(s) searched for in the ordered reaction list output. As a negative control, these reaction similarity results were then compared to all pairwise combinations of MetaCyc enzymes (subsampled to <italic>N</italic> = 34,279) that do not conduct the same reaction.</p><p>We also assessed the relationship between chemistry and protein similarity for all pairwise combinations of a subset of MetaCyc reactions annotated with only one protein sequence (<italic>N</italic> = 604 reactions). Chemical similarity was based on the Euclidean distance between two reaction fingerprint vectors in SIMMER’s precomputed chemical space (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Global protein similarity was determined via the Needleman–Wunsch algorithm. The relationship between chemical similarity and protein similarity was assessed with a Pearson’s correlation coefficient and p-value calculated using a Wald test with <italic>t</italic>-distribution of the test statistic.</p></sec><sec id="s4-7"><title>Creating a compendium of drug metabolism use cases from the human gut</title><p>To analyze SIMMER under the use-case of drug metabolism, we created a compendium of drug degradations that occur in the human gut microbiome. The compendium of reactions is based on a literature curation of hundreds of papers, and is organized by reactions producing known/unknown metabolites and driven by known/unknown bacterial enzymes. The drug metabolism positive controls used to assess SIMMER’s accuracy were drawn from the list of reactions possessing a structurally elucidated metabolite and driven by a characterized bacterial enzyme.</p><p>We further expanded the positive control list to include sequence similar enzymes that likely perform the same function. For this expansion, we performed pHMM searches (when a positive control reaction had been characterized with multiple sequence similar enzymes) and phmmer searches (when a positive control reaction had been characterized with only one sequence) of the UHGG database using HMMER3 software (<xref ref-type="bibr" rid="bib1">Almeida et al., 2021</xref>; <xref ref-type="bibr" rid="bib20">Eddy, 2009</xref>). High significance (e-value &lt; 1E − 5) hits were kept when the resulting alignment was at least 50% of the input pHMM or sequence length. This list of significant hits was filtered by presence in human ileum or jejunum (the site of human drug absorption) via DIAMOND searches against metagenomic reads from a published study that employed jejunum and ileum endoscopy (<xref ref-type="bibr" rid="bib9">Buchfink et al., 2021</xref>; <xref ref-type="bibr" rid="bib67">Zmora et al., 2018</xref>). The hits were also filtered for presence in RNAsequencing data via DIAMOND searches of rnaSPAdes assembled reads from HMP2 metatranscriptomics control patient samples (<xref ref-type="bibr" rid="bib10">Bushmanova et al., 2019</xref>; <xref ref-type="bibr" rid="bib28">Integrative HMP (iHMP) Research Network Consortium, 2019</xref>). The hits were lastly filtered by predicted affinity for their substrates using the Similarity Ensemble Approach (<xref ref-type="bibr" rid="bib31">Keiser et al., 2007</xref>).</p></sec><sec id="s4-8"><title>Comparison to existing methods</title><p>DrugBug predictions were made using the DrugBug web tool (<ext-link ext-link-type="uri" xlink:href="http://metagenomics.iiserb.ac.in/drugbug/">http://metagenomics.iiserb.ac.in/drugbug/</ext-link>) with default settings. MicrobeFDT predictions were made in two manners: first by looking for direct enzyme metabolism events, and second, by looking for enzyme metabolism of compounds that overlap chemically with the positive control in question. Cypher query commands used are included in <xref ref-type="supplementary-material" rid="table1sdata1">Table 1—source data 1</xref>.</p></sec><sec id="s4-9"><title>Analysis of 16S and metagenomics data from Javdan et al.</title><p>We analyzed results from sequencing studies (NCBI BioProject: PRJNA593062) described in a previously published high-throughput investigation of bacterial drug metabolism in human stool samples (<xref ref-type="bibr" rid="bib29">Javdan et al., 2020</xref>). The first sequencing set in this publication was a deep metagenomic sequencing of one pilot individual’s ex vivo stool originally evaluated for its ability to degrade hundreds of therapeutics. We used MetaSPAdes with default settings to assemble the metagenomics reads into scaffolds (<xref ref-type="bibr" rid="bib46">Nurk et al., 2017</xref>). We then queried SIMMER with eight reactions that were structurally elucidated (via nuclear magnetic resonance) by the previous publication, and ensured via TBLASTN searches that SIMMER predicted hits were found in the assembled metagenomic reads. The second sequencing set was a 16S rRNA sequencing experiment of twenty human donor stool samples originally evaluated for their inter-individual variation in bacterial drug degradation. We queried SIMMER with five of these reactions possessing structurally elucidated metabolites, and evaluated enrichment of SIMMER predicted bacterial species in metabolizing versus non-metabolizing donors. Species matches between SIMMER species predictions and the 16S study were made using the SequenceMatcher class from the difflib python module set to an 80% ratio cutoff. Enrichment of SIMMER predicted bacterial genomes was then assessed by computing a <italic>t</italic>-test for number of SIMMER genomes in metabolizers versus number of SIMMER genomes in non-metabolizers for a given reaction.</p></sec><sec id="s4-10"><title>Analysis of dexamethasone metagenomics data</title><p>For experimental corroboration of dexamethasone metabolism, we accessed shotgun sequencing data (PRJEB31790) from a cohort of 28 human stool samples shown to metabolize dexamethasone to varying degrees (<xref ref-type="bibr" rid="bib66">Zimmermann et al., 2019b</xref>). Shotgun reads were assembled using MetaSpades with default settings. The metabolism of dexamethasone to 17-oxodexamethasone was input to SIMMER with <italic>N</italic> = 20 reactions output, and a DIAMOND database of all SIMMER enzyme predictions from <italic>C. scindens</italic> was created. Presence of SIMMER enzyme predictions was established via search with DIAMOND and normalized by sample read depth. Significance was established with a Pearson’s correlation coefficient and p-value calculated using a Student’s <italic>t</italic>-distribution.</p></sec><sec id="s4-11"><title>Analysis of RA metagenomics data</title><p>The Artacho sequencing study (PRJNA682730) raw reads were assembled using MetaSpades with default settings (<xref ref-type="bibr" rid="bib46">Nurk et al., 2017</xref>). After assembly, DIAMOND was used to search for SIMMER sequences in reads, with presence defined as at least 50% coverage and at least 97% identity. All abundance measures were normalized by read depth. Correlation between DAS28 improvement and number of aligned SIMMER enzyme predictions was assessed using Pearson’s correlation coefficient and p-value calculated using a Student’s <italic>t</italic>-distribution. Enrichment of SIMMER enzyme predictions in MTX responders versus non-responders was assessed using a generalized linear model, glm(count~response, family = poisson).</p></sec><sec id="s4-12"><title>Bacterial isolate screen for MTX hydrolysis</title><p>42 isolates commonly found in the human gut microbiome were obtained from Deutsche Sammlung von Mikroorganismen und Zellkulturen (DSMZ) and American Type Culture Collection (ATCC), and subcultured as previously described (<xref ref-type="bibr" rid="bib44">Nayak et al., 2021</xref>). MTX (100 μg/ml) was added to cultures for 72 hr, samples then spun down at 2000 rcf for 5–10 min at 4°C, and supernatant injected to HPLC (see HPLC method). MTX was dosed based on the predicted concentration of the drug in a human gastrointestinal tract, as previously described (<xref ref-type="bibr" rid="bib44">Nayak et al., 2021</xref>). Drug depletion was defined as at least a 50% decrease in MTX levels compared to control. SIMMER predicted enzymes’ presence or absence in the 42 isolates was determined by downloading genomes (<xref ref-type="supplementary-material" rid="fig8sdata1">Figure 8—source data 1</xref>) for all 42 isolates and conducting DIAMOND searches. Presence was defined as at least 97% global percent identity. Presence of AcrAB efflux machinery was determined by conducting DIAMOND searches for <italic>E. coli</italic> AcrA (P0AE06) and AcrB (P31224) against all 42 isolates, and reported in <xref ref-type="supplementary-material" rid="fig8sdata1">Figure 8—source data 1</xref>. For the phylogenetic tree, 16S rRNA gene sequences for the 42 organisms were downloaded from the Greengenes database (<xref ref-type="bibr" rid="bib16">DeSantis et al., 2006</xref>) and aligned using MUSCLE (<xref ref-type="bibr" rid="bib21">Edgar, 2004</xref>). Gaps occurring in greater than 50% of sequences removed before creating a maximum likelihood phylogenetic tree (PhyML) with 100 bootstraps and the GTR substitution model (<xref ref-type="bibr" rid="bib25">Guindon et al., 2010</xref>).</p></sec><sec id="s4-13"><title>MTX HPLC method</title><p>HPLC assays were performed on an Agilent HPLC (1220 Infinity), and data collected with OpenLAB CDS (Agilent Technologies). Solvent A was 0.1% formic acid, and solvent B was 100% methanol. Solvent B concentration was 10–30% from 0 to 1 min, 30–100% from 1 to 7 min, and then 100–10% from 7 to 7.5 min. The flow rate was 0.6 ml/min. A C18 column (Kinetex 2.6  µM; 100  Å; 15 cm × 0.46 cm; Phenomenex; 00F-4462-E0) was used with a SecurityGuard ULTRA cartridge guard column (Phenomenex part number AJ0-8768). The injection volume was 30 µl. At 310  nm, MTX retention time was 5.5 min (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>). We compared the amount of MTX present in the bacterial supernatant compared to sterile and dimethyl sulfoxide (DMSO) controls to assess MTX metabolism.</p></sec><sec id="s4-14"><title>Web tool creation</title><p>We used the python web framework Flask (<ext-link ext-link-type="uri" xlink:href="https://flask.palletsprojects.com/en/2.1.x/">https://flask.palletsprojects.com/en/2.1.x/</ext-link>) to make SIMMER available as a user-friendly website. The website accepts either a single query reaction or multiple query reactions via a file upload and provides the same outputs as the SIMMER command-line tool. The website also allows the user to download the outputs of interest. Keeping in mind the privacy and security of the data that a user might upload to the website, the website is designed to delete all uploaded data within 24 hr from the server. This will ensure security of the uploaded data.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic></p></fn><fn fn-type="COI-statement" id="conf3"><p>is a consultant for Phylagen Inc</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Investigation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Resources, Software, Visualization, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Resources, Supervision, Funding acquisition, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Literature curated list of drug metabolism events in the human gut microbiome.</title></caption><media xlink:href="elife-82401-supp1-v3.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>SMILES used as SIMMER input.</title></caption><media xlink:href="elife-82401-supp2-v3.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-82401-mdarchecklist1-v3.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Data generated and analyzed during this study are provided in Figures 2–10 source data files, Table 1 source data file, supplementary files, and at <ext-link ext-link-type="uri" xlink:href="https://github.com/aebustion/SIMMER">https://github.com/aebustion/SIMMER</ext-link> (copy archived at <xref ref-type="bibr" rid="bib11">Bustion, 2023</xref>). Accession numbers of previously published datasets are provided in Materials and Methods section. SIMMER code can either be run at the SIMMER website (<ext-link ext-link-type="uri" xlink:href="https://simmer.pollard.gladstone.org/">https://simmer.pollard.gladstone.org/</ext-link>) or downloaded directly from the above-linked GitHub.</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><collab>Artacho, et al</collab></person-group><year iso-8601-date="2020">2020</year><data-title>human gut microbiome predicts response to MTX treatment</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA682730">PRJNA682730</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><collab>Zimmermann, et al</collab></person-group><year iso-8601-date="2019">2019</year><data-title>Drug metabolism by 28 human gut communities</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJEB31790">PRJEB31790</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><collab>Zimmermann, et al</collab></person-group><year iso-8601-date="2019">2019</year><data-title>Sequencing data for &quot;Mapping drug metabolism by the human gut microbiome using personalized microbial communities&quot;</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/?term=PRJNA593062">PRJNA593062</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Russ Altman and Emily Mallory for their work that first inspired the comparison of MetaCyc reactions to known gut microbiome chemistry (<xref ref-type="bibr" rid="bib39">Mallory et al., 2018</xref>), and Russ Altman for further insightful conversation. We thank Peter Karp and Peter Midford of MetaCyc for providing us with an expanded set of links between MetaCyc reactions and Uniprot or Entrez sequences. We thank Ben Guthrie of the Turnbaugh lab for collaboration and guidance in the ongoing experimental validation of SIMMER enzyme predictions. We thank Daniela Arce and Xiaofan Jin of the Pollard lab for guidance on assessing enzyme presence in the jejunum and ileum of the human intestinal tract. We thank Chunyu Zhao and Jason Shi of the Pollard lab for guidance on the appropriate use of MIDAS2 and the UHGG database. We thank Patrick Bradley for guidance on the use of HMMER3 software in a microbiome drug metabolism context. We thank members of the Pollard and Turnbaugh laboratories for their suggestions during the research process and writing of this manuscript. Annamarie Bustion was supported by a trainee pilot award from the UCSF Benioff Center for Microbiome Medicine, a predoctoral fellowship in informatics from the PhRMA foundation, an Achievement Rewards for College Scientists (ARCS) Scholarship from the ARCS foundation, and Training Grants from the NIGMS of NIH (5T32GM007175-42 and 2T32GM007175-41). This work was also supported by Gladstone Institutes. Renuka Nayak was supported by K08AR073930, Arthritis National Research Foundation, R01AR074500, Russell Engelman Rheumatology Research Center, UCSF Perstein Award, and a UCSF Bechtel Award. PJT was supported by the National Institutes of Health (R01HL122593, R01AR074500). PJT and KP are Chan Zuckerberg Biohub-San Francisco Investigators.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Almeida</surname><given-names>A</given-names></name><name><surname>Nayfach</surname><given-names>S</given-names></name><name><surname>Boland</surname><given-names>M</given-names></name><name><surname>Strozzi</surname><given-names>F</given-names></name><name><surname>Beracochea</surname><given-names>M</given-names></name><name><surname>Shi</surname><given-names>ZJ</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name><name><surname>Sakharova</surname><given-names>E</given-names></name><name><surname>Parks</surname><given-names>DH</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Segata</surname><given-names>N</given-names></name><name><surname>Kyrpides</surname><given-names>NC</given-names></name><name><surname>Finn</surname><given-names>RD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title><source>Nature Biotechnology</source><volume>39</volume><fpage>105</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1038/s41587-020-0603-3</pub-id><pub-id pub-id-type="pmid">32690973</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altman</surname><given-names>T</given-names></name><name><surname>Travers</surname><given-names>M</given-names></name><name><surname>Kothari</surname><given-names>A</given-names></name><name><surname>Caspi</surname><given-names>R</given-names></name><name><surname>Karp</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A systematic comparison of the MetaCyc and KEGG pathway databases</article-title><source>BMC Bioinformatics</source><volume>14</volume><elocation-id>112</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-14-112</pub-id><pub-id pub-id-type="pmid">23530693</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>SF</given-names></name><name><surname>Gish</surname><given-names>W</given-names></name><name><surname>Miller</surname><given-names>W</given-names></name><name><surname>Myers</surname><given-names>EW</given-names></name><name><surname>Lipman</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Basic local alignment search tool</article-title><source>Journal of Molecular Biology</source><volume>215</volume><fpage>403</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id><pub-id pub-id-type="pmid">2231712</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Artacho</surname><given-names>A</given-names></name><name><surname>Isaac</surname><given-names>S</given-names></name><name><surname>Nayak</surname><given-names>R</given-names></name><name><surname>Flor-Duro</surname><given-names>A</given-names></name><name><surname>Alexander</surname><given-names>M</given-names></name><name><surname>Koo</surname><given-names>I</given-names></name><name><surname>Manasson</surname><given-names>J</given-names></name><name><surname>Smith</surname><given-names>PB</given-names></name><name><surname>Rosenthal</surname><given-names>P</given-names></name><name><surname>Homsi</surname><given-names>Y</given-names></name><name><surname>Gulko</surname><given-names>P</given-names></name><name><surname>Pons</surname><given-names>J</given-names></name><name><surname>Puchades-Carrasco</surname><given-names>L</given-names></name><name><surname>Izmirly</surname><given-names>P</given-names></name><name><surname>Patterson</surname><given-names>A</given-names></name><name><surname>Abramson</surname><given-names>SB</given-names></name><name><surname>Pineda-Lucena</surname><given-names>A</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Ubeda</surname><given-names>C</given-names></name><name><surname>Scher</surname><given-names>JU</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The pretreatment gut microbiome is associated with lack of response to methotrexate in new‐onset rheumatoid arthritis</article-title><source>Arthritis &amp; Rheumatology</source><volume>73</volume><fpage>931</fpage><lpage>942</lpage><pub-id pub-id-type="doi">10.1002/art.41622</pub-id><pub-id pub-id-type="pmid">33314800</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asnicar</surname><given-names>F</given-names></name><name><surname>Berry</surname><given-names>SE</given-names></name><name><surname>Valdes</surname><given-names>AM</given-names></name><name><surname>Nguyen</surname><given-names>LH</given-names></name><name><surname>Piccinno</surname><given-names>G</given-names></name><name><surname>Drew</surname><given-names>DA</given-names></name><name><surname>Leeming</surname><given-names>E</given-names></name><name><surname>Gibson</surname><given-names>R</given-names></name><name><surname>Le Roy</surname><given-names>C</given-names></name><name><surname>Khatib</surname><given-names>HA</given-names></name><name><surname>Francis</surname><given-names>L</given-names></name><name><surname>Mazidi</surname><given-names>M</given-names></name><name><surname>Mompeo</surname><given-names>O</given-names></name><name><surname>Valles-Colomer</surname><given-names>M</given-names></name><name><surname>Tett</surname><given-names>A</given-names></name><name><surname>Beghini</surname><given-names>F</given-names></name><name><surname>Dubois</surname><given-names>L</given-names></name><name><surname>Bazzani</surname><given-names>D</given-names></name><name><surname>Thomas</surname><given-names>AM</given-names></name><name><surname>Mirzayi</surname><given-names>C</given-names></name><name><surname>Khleborodova</surname><given-names>A</given-names></name><name><surname>Oh</surname><given-names>S</given-names></name><name><surname>Hine</surname><given-names>R</given-names></name><name><surname>Bonnett</surname><given-names>C</given-names></name><name><surname>Capdevila</surname><given-names>J</given-names></name><name><surname>Danzanvilliers</surname><given-names>S</given-names></name><name><surname>Giordano</surname><given-names>F</given-names></name><name><surname>Geistlinger</surname><given-names>L</given-names></name><name><surname>Waldron</surname><given-names>L</given-names></name><name><surname>Davies</surname><given-names>R</given-names></name><name><surname>Hadjigeorgiou</surname><given-names>G</given-names></name><name><surname>Wolf</surname><given-names>J</given-names></name><name><surname>Ordovás</surname><given-names>JM</given-names></name><name><surname>Gardner</surname><given-names>C</given-names></name><name><surname>Franks</surname><given-names>PW</given-names></name><name><surname>Chan</surname><given-names>AT</given-names></name><name><surname>Huttenhower</surname><given-names>C</given-names></name><name><surname>Spector</surname><given-names>TD</given-names></name><name><surname>Segata</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Microbiome connections with host metabolism and habitual diet from 1,098 deeply phenotyped individuals</article-title><source>Nature Medicine</source><volume>27</volume><fpage>321</fpage><lpage>332</lpage><pub-id pub-id-type="doi">10.1038/s41591-020-01183-8</pub-id><pub-id pub-id-type="pmid">33432175</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aziz</surname><given-names>RK</given-names></name><name><surname>Hegazy</surname><given-names>SM</given-names></name><name><surname>Yasser</surname><given-names>R</given-names></name><name><surname>Rizkallah</surname><given-names>MR</given-names></name><name><surname>ElRakaiby</surname><given-names>MT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Drug pharmacomicrobiomics and toxicomicrobiomics: from scattered reports to systematic studies of drug-microbiome interactions</article-title><source>Expert Opinion on Drug Metabolism &amp; Toxicology</source><volume>14</volume><fpage>1043</fpage><lpage>1055</lpage><pub-id pub-id-type="doi">10.1080/17425255.2018.1530216</pub-id><pub-id pub-id-type="pmid">30269615</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bairoch</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The enzyme database in 2000</article-title><source>Nucleic Acids Research</source><volume>28</volume><fpage>304</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.304</pub-id><pub-id pub-id-type="pmid">10592255</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bisanz</surname><given-names>JE</given-names></name><name><surname>Soto-Perez</surname><given-names>P</given-names></name><name><surname>Noecker</surname><given-names>C</given-names></name><name><surname>Aksenov</surname><given-names>AA</given-names></name><name><surname>Lam</surname><given-names>KN</given-names></name><name><surname>Kenney</surname><given-names>GE</given-names></name><name><surname>Bess</surname><given-names>EN</given-names></name><name><surname>Haiser</surname><given-names>HJ</given-names></name><name><surname>Kyaw</surname><given-names>TS</given-names></name><name><surname>Yu</surname><given-names>FB</given-names></name><name><surname>Rekdal</surname><given-names>VM</given-names></name><name><surname>Ha</surname><given-names>CWY</given-names></name><name><surname>Devkota</surname><given-names>S</given-names></name><name><surname>Balskus</surname><given-names>EP</given-names></name><name><surname>Dorrestein</surname><given-names>PC</given-names></name><name><surname>Allen-Vercoe</surname><given-names>E</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A genomic toolkit for the mechanistic dissection of intractable human gut bacteria</article-title><source>Cell Host &amp; Microbe</source><volume>27</volume><fpage>1001</fpage><lpage>1013</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2020.04.006</pub-id><pub-id pub-id-type="pmid">32348781</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buchfink</surname><given-names>B</given-names></name><name><surname>Reuter</surname><given-names>K</given-names></name><name><surname>Drost</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title><source>Nature Methods</source><volume>18</volume><fpage>366</fpage><lpage>368</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id><pub-id pub-id-type="pmid">33828273</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bushmanova</surname><given-names>E</given-names></name><name><surname>Antipov</surname><given-names>D</given-names></name><name><surname>Lapidus</surname><given-names>A</given-names></name><name><surname>Prjibelski</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>rnaSPAdes: a de novo transcriptome assembler and its application to RNA-Seq data</article-title><source>GigaScience</source><volume>8</volume><elocation-id>giz100</elocation-id><pub-id pub-id-type="doi">10.1093/gigascience/giz100</pub-id><pub-id pub-id-type="pmid">31494669</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bustion</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>SIMMER</data-title><version designator="swh:1:rev:564b1074d1a7e93a7a29fe995107e4e443ab9149">swh:1:rev:564b1074d1a7e93a7a29fe995107e4e443ab9149</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:2a7999375d51ccf5f1ae7a2017075528d2f531e5;origin=https://github.com/aebustion/SIMMER;visit=swh:1:snp:074cfc58ffff388278cbaaabf736cda6b6b1a0a3;anchor=swh:1:rev:564b1074d1a7e93a7a29fe995107e4e443ab9149">https://archive.softwareheritage.org/swh:1:dir:2a7999375d51ccf5f1ae7a2017075528d2f531e5;origin=https://github.com/aebustion/SIMMER;visit=swh:1:snp:074cfc58ffff388278cbaaabf736cda6b6b1a0a3;anchor=swh:1:rev:564b1074d1a7e93a7a29fe995107e4e443ab9149</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caspi</surname><given-names>R</given-names></name><name><surname>Foerster</surname><given-names>H</given-names></name><name><surname>Fulcher</surname><given-names>CA</given-names></name><name><surname>Kaipa</surname><given-names>P</given-names></name><name><surname>Krummenacker</surname><given-names>M</given-names></name><name><surname>Latendresse</surname><given-names>M</given-names></name><name><surname>Paley</surname><given-names>S</given-names></name><name><surname>Rhee</surname><given-names>SY</given-names></name><name><surname>Shearer</surname><given-names>AG</given-names></name><name><surname>Tissier</surname><given-names>C</given-names></name><name><surname>Walk</surname><given-names>TC</given-names></name><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Karp</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The MetaCyc database of metabolic pathways and enzymes and the BioCyc collection of Pathway/Genome Databases</article-title><source>Nucleic Acids Research</source><volume>36</volume><fpage>D623</fpage><lpage>D631</lpage><pub-id pub-id-type="doi">10.1093/nar/gkm900</pub-id><pub-id pub-id-type="pmid">17965431</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caspi</surname><given-names>R</given-names></name><name><surname>Billington</surname><given-names>R</given-names></name><name><surname>Keseler</surname><given-names>IM</given-names></name><name><surname>Kothari</surname><given-names>A</given-names></name><name><surname>Krummenacker</surname><given-names>M</given-names></name><name><surname>Midford</surname><given-names>PE</given-names></name><name><surname>Ong</surname><given-names>WK</given-names></name><name><surname>Paley</surname><given-names>S</given-names></name><name><surname>Subhraveti</surname><given-names>P</given-names></name><name><surname>Karp</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The MetaCyc database of metabolic pathways and enzymes - a 2019 update</article-title><source>Nucleic Acids Research</source><volume>48</volume><fpage>D445</fpage><lpage>D453</lpage><pub-id pub-id-type="doi">10.1093/nar/gkz862</pub-id><pub-id pub-id-type="pmid">31586394</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="web"><person-group person-group-type="author"><collab>ChemAxon</collab></person-group><year iso-8601-date="2023">2023</year><article-title>cxcalc calculator functions</article-title><ext-link ext-link-type="uri" xlink:href="https://docs.chemaxon.com/display/docs/cxcalc-calculator-functions.md">https://docs.chemaxon.com/display/docs/cxcalc-calculator-functions.md</ext-link><date-in-citation iso-8601-date="2020-02-05">February 5, 2020</date-in-citation></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Ye</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>High speed BLASTN: an accelerated MegaBLAST search tool</article-title><source>Nucleic Acids Research</source><volume>43</volume><fpage>7762</fpage><lpage>7768</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv784</pub-id><pub-id pub-id-type="pmid">26250111</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeSantis</surname><given-names>TZ</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Larsen</surname><given-names>N</given-names></name><name><surname>Rojas</surname><given-names>M</given-names></name><name><surname>Brodie</surname><given-names>EL</given-names></name><name><surname>Keller</surname><given-names>K</given-names></name><name><surname>Huber</surname><given-names>T</given-names></name><name><surname>Dalevi</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>P</given-names></name><name><surname>Andersen</surname><given-names>GL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title><source>Applied and Environmental Microbiology</source><volume>72</volume><fpage>5069</fpage><lpage>5072</lpage><pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id><pub-id pub-id-type="pmid">16820507</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Djoumbou-Feunang</surname><given-names>Y</given-names></name><name><surname>Fiamoncini</surname><given-names>J</given-names></name><name><surname>Gil-de-la-Fuente</surname><given-names>A</given-names></name><name><surname>Greiner</surname><given-names>R</given-names></name><name><surname>Manach</surname><given-names>C</given-names></name><name><surname>Wishart</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Biotransformer: a comprehensive computational tool for small molecule metabolism prediction and metabolite identification</article-title><source>Journal of Cheminformatics</source><volume>11</volume><elocation-id>2</elocation-id><pub-id pub-id-type="doi">10.1186/s13321-018-0324-5</pub-id><pub-id pub-id-type="pmid">30612223</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duigou</surname><given-names>T</given-names></name><name><surname>du Lac</surname><given-names>M</given-names></name><name><surname>Carbonell</surname><given-names>P</given-names></name><name><surname>Faulon</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Retrorules: a database of reaction rules for engineering biology</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D1229</fpage><lpage>D1235</lpage><pub-id pub-id-type="doi">10.1093/nar/gky940</pub-id><pub-id pub-id-type="pmid">30321422</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Profile hidden Markov models</article-title><source>Bioinformatics</source><volume>14</volume><fpage>755</fpage><lpage>763</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/14.9.755</pub-id><pub-id pub-id-type="pmid">9918945</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A new generation of homology search tools based on probabilistic inference</article-title><conf-name>Proceedings of the 20th International Conference</conf-name><fpage>205</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1142/9781848165632_0019</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title><source>Nucleic Acids Research</source><volume>32</volume><fpage>1792</fpage><lpage>1797</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><pub-id pub-id-type="pmid">15034147</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>L</given-names></name><name><surname>Niu</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>Z</given-names></name><name><surname>Wu</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title><source>Bioinformatics</source><volume>28</volume><fpage>3150</fpage><lpage>3152</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts565</pub-id><pub-id pub-id-type="pmid">23060610</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerlt</surname><given-names>JA</given-names></name><name><surname>Babbitt</surname><given-names>PC</given-names></name><name><surname>Jacobson</surname><given-names>MP</given-names></name><name><surname>Almo</surname><given-names>SC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Divergent evolution in enolase superfamily: strategies for assigning functions</article-title><source>The Journal of Biological Chemistry</source><volume>287</volume><fpage>29</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1074/jbc.R111.240945</pub-id><pub-id pub-id-type="pmid">22069326</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gibson</surname><given-names>MK</given-names></name><name><surname>Forsberg</surname><given-names>KJ</given-names></name><name><surname>Dantas</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Improved annotation of antibiotic resistance determinants reveals microbial resistomes cluster by Ecology</article-title><source>The ISME Journal</source><volume>9</volume><fpage>207</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/ismej.2014.106</pub-id><pub-id pub-id-type="pmid">25003965</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guindon</surname><given-names>S</given-names></name><name><surname>Dufayard</surname><given-names>JF</given-names></name><name><surname>Lefort</surname><given-names>V</given-names></name><name><surname>Anisimova</surname><given-names>M</given-names></name><name><surname>Hordijk</surname><given-names>W</given-names></name><name><surname>Gascuel</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>New algorithms and methods to estimate maximum-likelihood phylogenies: assessing the performance of Phyml 3.0. SYST Biol 59:307–321</article-title><source>Systematic Biology</source><volume>59</volume><fpage>307</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syq010</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guthrie</surname><given-names>L</given-names></name><name><surname>Wolfson</surname><given-names>S</given-names></name><name><surname>Kelly</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The human gut chemical landscape predicts microbe-mediated biotransformation of foods and drugs</article-title><source>eLife</source><volume>8</volume><elocation-id>e42866</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.42866</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Acharya</surname><given-names>G</given-names></name><name><surname>Ravcheev</surname><given-names>DA</given-names></name><name><surname>Hertel</surname><given-names>J</given-names></name><name><surname>Nyga</surname><given-names>M</given-names></name><name><surname>Okpala</surname><given-names>OE</given-names></name><name><surname>Hogan</surname><given-names>M</given-names></name><name><surname>Magnúsdóttir</surname><given-names>S</given-names></name><name><surname>Martinelli</surname><given-names>F</given-names></name><name><surname>Preciat</surname><given-names>G</given-names></name><name><surname>Edirisinghe</surname><given-names>JN</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name><name><surname>Fleming</surname><given-names>RMT</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>AGORA2: Large scale reconstruction of the microbiome highlights wide-spread drug-metabolising capacities</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.09.375451</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Integrative HMP (iHMP) Research Network Consortium</collab></person-group><year iso-8601-date="2019">2019</year><article-title>The Integrative Human Microbiome Project</article-title><source>Nature</source><volume>569</volume><fpage>641</fpage><lpage>648</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1238-8</pub-id><pub-id pub-id-type="pmid">31142853</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Javdan</surname><given-names>B</given-names></name><name><surname>Lopez</surname><given-names>JG</given-names></name><name><surname>Chankhamjon</surname><given-names>P</given-names></name><name><surname>Lee</surname><given-names>YCJ</given-names></name><name><surname>Hull</surname><given-names>R</given-names></name><name><surname>Wu</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Chatterjee</surname><given-names>S</given-names></name><name><surname>Donia</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Personalized mapping of drug metabolism by the human gut microbiome</article-title><source>Cell</source><volume>181</volume><fpage>1661</fpage><lpage>1679</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2020.05.001</pub-id><pub-id pub-id-type="pmid">32526207</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeyaharan</surname><given-names>D</given-names></name><name><surname>Aston</surname><given-names>P</given-names></name><name><surname>Garcia-Perez</surname><given-names>A</given-names></name><name><surname>Schouten</surname><given-names>J</given-names></name><name><surname>Davis</surname><given-names>P</given-names></name><name><surname>Dixon</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Soluble expression, purification and functional characterisation of carboxypeptidase G2 and its individual domains</article-title><source>Protein Expression and Purification</source><volume>127</volume><fpage>44</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1016/j.pep.2016.06.015</pub-id><pub-id pub-id-type="pmid">27374188</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Keiser</surname><given-names>MJ</given-names></name><name><surname>Roth</surname><given-names>BL</given-names></name><name><surname>Armbruster</surname><given-names>BN</given-names></name><name><surname>Ernsberger</surname><given-names>P</given-names></name><name><surname>Irwin</surname><given-names>JJ</given-names></name><name><surname>Shoichet</surname><given-names>BK</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Relating protein pharmacology by ligand chemistry</article-title><source>Nature Biotechnology</source><volume>25</volume><fpage>197</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1038/nbt1284</pub-id><pub-id pub-id-type="pmid">17287757</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klatt</surname><given-names>NR</given-names></name><name><surname>Cheu</surname><given-names>R</given-names></name><name><surname>Birse</surname><given-names>K</given-names></name><name><surname>Zevin</surname><given-names>AS</given-names></name><name><surname>Perner</surname><given-names>M</given-names></name><name><surname>Noël-Romas</surname><given-names>L</given-names></name><name><surname>Grobler</surname><given-names>A</given-names></name><name><surname>Westmacott</surname><given-names>G</given-names></name><name><surname>Xie</surname><given-names>IY</given-names></name><name><surname>Butler</surname><given-names>J</given-names></name><name><surname>Mansoor</surname><given-names>L</given-names></name><name><surname>McKinnon</surname><given-names>LR</given-names></name><name><surname>Passmore</surname><given-names>JAS</given-names></name><name><surname>Abdool Karim</surname><given-names>Q</given-names></name><name><surname>Abdool Karim</surname><given-names>SS</given-names></name><name><surname>Burgener</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Vaginal bacteria modify HIV tenofovir microbicide efficacy in African women</article-title><source>Science</source><volume>356</volume><fpage>938</fpage><lpage>945</lpage><pub-id pub-id-type="doi">10.1126/science.aai9383</pub-id><pub-id pub-id-type="pmid">28572388</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koppel</surname><given-names>N</given-names></name><name><surname>Maini Rekdal</surname><given-names>V</given-names></name><name><surname>Balskus</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Chemical transformation of xenobiotics by the human gut microbiota</article-title><source>Science</source><volume>356</volume><elocation-id>eaag2770</elocation-id><pub-id pub-id-type="doi">10.1126/science.aag2770</pub-id><pub-id pub-id-type="pmid">28642381</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koppel</surname><given-names>N</given-names></name><name><surname>Bisanz</surname><given-names>JE</given-names></name><name><surname>Pandelia</surname><given-names>ME</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Balskus</surname><given-names>EP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Discovery and characterization of a prevalent human gut bacterial enzyme sufficient for the inactivation of a family of plant toxins</article-title><source>eLife</source><volume>7</volume><elocation-id>e33953</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.33953</pub-id><pub-id pub-id-type="pmid">29761785</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopytek</surname><given-names>SJ</given-names></name><name><surname>Dyer</surname><given-names>JC</given-names></name><name><surname>Knapp</surname><given-names>GS</given-names></name><name><surname>Hu</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Resistance to methotrexate due to AcrAB-dependent export from <italic>Escherichia coli</italic></article-title><source>Antimicrobial Agents and Chemotherapy</source><volume>44</volume><fpage>3210</fpage><lpage>3212</lpage><pub-id pub-id-type="doi">10.1128/AAC.44.11.3210-3212.2000</pub-id><pub-id pub-id-type="pmid">11036056</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larimer</surname><given-names>CM</given-names></name><name><surname>Slavnic</surname><given-names>D</given-names></name><name><surname>Pitstick</surname><given-names>LD</given-names></name><name><surname>Green</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Comparison of substrate specificity of <italic>Escherichia coli</italic> p-Aminobenzoyl-glutamate hydrolase with <italic>Pseudomonas</italic> carboxypeptidase G</article-title><source>Advances in Enzyme Research</source><volume>2</volume><fpage>39</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.4236/aer.2014.21004</pub-id><pub-id pub-id-type="pmid">27795973</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ly</surname><given-names>LK</given-names></name><name><surname>Rowles</surname><given-names>JL</given-names><suffix>III</suffix></name><name><surname>Paul</surname><given-names>HM</given-names></name><name><surname>Alves</surname><given-names>JMP</given-names></name><name><surname>Yemm</surname><given-names>C</given-names></name><name><surname>Wolf</surname><given-names>PM</given-names></name><name><surname>Devendran</surname><given-names>S</given-names></name><name><surname>Hudson</surname><given-names>ME</given-names></name><name><surname>Morris</surname><given-names>DJ</given-names></name><name><surname>Erdman</surname><given-names>JW</given-names></name><name><surname>Ridlon</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Bacterial Steroid-17,20-desmolase is a taxonomically rare enzymatic pathway that converts prednisone to 1,4-androstanediene-3,11,17-Trione, a metabolite that causes proliferation of prostate cancer cells</article-title><source>The Journal of Steroid Biochemistry and Molecular Biology</source><volume>199</volume><elocation-id>105567</elocation-id><pub-id pub-id-type="doi">10.1016/j.jsbmb.2019.105567</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Magnúsdóttir</surname><given-names>S</given-names></name><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Kutt</surname><given-names>L</given-names></name><name><surname>Ravcheev</surname><given-names>DA</given-names></name><name><surname>Bauer</surname><given-names>E</given-names></name><name><surname>Noronha</surname><given-names>A</given-names></name><name><surname>Greenhalgh</surname><given-names>K</given-names></name><name><surname>Jäger</surname><given-names>C</given-names></name><name><surname>Baginska</surname><given-names>J</given-names></name><name><surname>Wilmes</surname><given-names>P</given-names></name><name><surname>Fleming</surname><given-names>RMT</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Generation of genome-scale metabolic reconstructions for 773 members of the human gut Microbiota</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>81</fpage><lpage>89</lpage><pub-id pub-id-type="doi">10.1038/nbt.3703</pub-id><pub-id pub-id-type="pmid">27893703</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Mallory</surname><given-names>EK</given-names></name><name><surname>Acharya</surname><given-names>A</given-names></name><name><surname>Rensi</surname><given-names>SE</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Bright</surname><given-names>RA</given-names></name><name><surname>Altman</surname><given-names>RB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Chemical reaction vector embeddings: towards predicting drug metabolism in the human gut microbiome</article-title><conf-name>Pacific Symposium on Biocomputing 2018</conf-name><fpage>56</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1142/9789813235533_0006</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>AG</given-names></name><name><surname>Boyce</surname><given-names>S</given-names></name><name><surname>Tipton</surname><given-names>KF</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Explorenz: the primary source of the IUBMB enzyme list</article-title><source>Nucleic Acids Research</source><volume>37</volume><fpage>D593</fpage><lpage>D597</lpage><pub-id pub-id-type="doi">10.1093/nar/gkn582</pub-id><pub-id pub-id-type="pmid">18776214</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>AG</given-names></name><name><surname>Tipton</surname><given-names>KF</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Fifty-five years of enzyme classification: advances and difficulties</article-title><source>The FEBS Journal</source><volume>281</volume><fpage>583</fpage><lpage>592</lpage><pub-id pub-id-type="doi">10.1111/febs.12530</pub-id><pub-id pub-id-type="pmid">24103004</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>AG</given-names></name><name><surname>Tipton</surname><given-names>KF</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Enzyme nomenclature and classification: the state of the art</article-title><source>The FEBS Journal</source><volume>290</volume><fpage>2214</fpage><lpage>2231</lpage><pub-id pub-id-type="doi">10.1111/febs.16274</pub-id><pub-id pub-id-type="pmid">34773359</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mi</surname><given-names>H</given-names></name><name><surname>Ebert</surname><given-names>D</given-names></name><name><surname>Muruganujan</surname><given-names>A</given-names></name><name><surname>Mills</surname><given-names>C</given-names></name><name><surname>Albou</surname><given-names>LP</given-names></name><name><surname>Mushayamaha</surname><given-names>T</given-names></name><name><surname>Thomas</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>PANTHER version 16: a revised family classification, tree-based classification tool, enhancer regions and extensive API</article-title><source>Nucleic Acids Research</source><volume>49</volume><fpage>D394</fpage><lpage>D403</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa1106</pub-id><pub-id pub-id-type="pmid">33290554</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nayak</surname><given-names>RR</given-names></name><name><surname>Alexander</surname><given-names>M</given-names></name><name><surname>Deshpande</surname><given-names>I</given-names></name><name><surname>Stapleton-Gray</surname><given-names>K</given-names></name><name><surname>Rimal</surname><given-names>B</given-names></name><name><surname>Patterson</surname><given-names>AD</given-names></name><name><surname>Ubeda</surname><given-names>C</given-names></name><name><surname>Scher</surname><given-names>JU</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Methotrexate impacts conserved pathways in diverse human gut bacteria leading to decreased host immune activation</article-title><source>Cell Host &amp; Microbe</source><volume>29</volume><fpage>362</fpage><lpage>377</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2020.12.008</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nayfach</surname><given-names>S</given-names></name><name><surname>Rodriguez-Mueller</surname><given-names>B</given-names></name><name><surname>Garud</surname><given-names>N</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>An integrated metagenomics pipeline for strain profiling reveals novel patterns of bacterial transmission and biogeography</article-title><source>Genome Research</source><volume>26</volume><fpage>1612</fpage><lpage>1625</lpage><pub-id pub-id-type="doi">10.1101/gr.201863.115</pub-id><pub-id pub-id-type="pmid">27803195</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nurk</surname><given-names>S</given-names></name><name><surname>Meleshko</surname><given-names>D</given-names></name><name><surname>Korobeynikov</surname><given-names>A</given-names></name><name><surname>Pevzner</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>metaSPAdes: a new versatile metagenomic assembler</article-title><source>Genome Research</source><volume>27</volume><fpage>824</fpage><lpage>834</lpage><pub-id pub-id-type="doi">10.1101/gr.213959.116</pub-id><pub-id pub-id-type="pmid">28298430</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patel</surname><given-names>JR</given-names></name><name><surname>Oh</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Crawford</surname><given-names>JM</given-names></name><name><surname>Isaacs</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Cross-Kingdom expression of synthetic genetic elements promotes discovery of metabolites in the human Microbiome</article-title><source>Cell</source><volume>185</volume><fpage>1487</fpage><lpage>1505</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2022.03.008</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollet</surname><given-names>RM</given-names></name><name><surname>D’Agostino</surname><given-names>EH</given-names></name><name><surname>Walton</surname><given-names>WG</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Little</surname><given-names>MS</given-names></name><name><surname>Biernat</surname><given-names>KA</given-names></name><name><surname>Pellock</surname><given-names>SJ</given-names></name><name><surname>Patterson</surname><given-names>LM</given-names></name><name><surname>Creekmore</surname><given-names>BC</given-names></name><name><surname>Isenberg</surname><given-names>HN</given-names></name><name><surname>Bahethi</surname><given-names>RR</given-names></name><name><surname>Bhatt</surname><given-names>AP</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Gharaibeh</surname><given-names>RZ</given-names></name><name><surname>Redinbo</surname><given-names>MR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An atlas of Β-Glucuronidases in the human intestinal microbiome</article-title><source>Structure</source><volume>25</volume><fpage>967</fpage><lpage>977</lpage><pub-id pub-id-type="doi">10.1016/j.str.2017.05.003</pub-id><pub-id pub-id-type="pmid">28578872</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pouliot</surname><given-names>Y</given-names></name><name><surname>Karp</surname><given-names>PD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A survey of orphan enzyme activities</article-title><source>BMC Bioinformatics</source><volume>8</volume><elocation-id>244</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-244</pub-id><pub-id pub-id-type="pmid">17623104</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Dehal</surname><given-names>PS</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fasttree: computing large minimum evolution trees with profiles instead of a distance matrix</article-title><source>Molecular Biology and Evolution</source><volume>26</volume><fpage>1641</fpage><lpage>1650</lpage><pub-id pub-id-type="doi">10.1093/molbev/msp077</pub-id><pub-id pub-id-type="pmid">19377059</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Roon</surname><given-names>E</given-names></name><name><surname>Laar</surname><given-names>MVD</given-names></name></person-group><year iso-8601-date="2006">2006</year><data-title>Methotrexate Bioavailability</data-title><source>Medicine</source></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scher</surname><given-names>JU</given-names></name><name><surname>Nayak</surname><given-names>RR</given-names></name><name><surname>Ubeda</surname><given-names>C</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Abramson</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Pharmacomicrobiomics in inflammatory arthritis: gut microbiome as modulator of therapeutic response</article-title><source>Nature Reviews. Rheumatology</source><volume>16</volume><fpage>282</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1038/s41584-020-0395-3</pub-id><pub-id pub-id-type="pmid">32157196</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>N</given-names></name><name><surname>Lowe</surname><given-names>DM</given-names></name><name><surname>Sayle</surname><given-names>RA</given-names></name><name><surname>Landrum</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Development of a novel fingerprint for chemical reactions and its application to large-scale reaction classification and similarity</article-title><source>Journal of Chemical Information and Modeling</source><volume>55</volume><fpage>39</fpage><lpage>53</lpage><pub-id pub-id-type="doi">10.1021/ci5006614</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Prokka: rapid prokaryotic genome annotation</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2068</fpage><lpage>2069</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu153</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharma</surname><given-names>AK</given-names></name><name><surname>Jaiswal</surname><given-names>SK</given-names></name><name><surname>Chaudhary</surname><given-names>N</given-names></name><name><surname>Sharma</surname><given-names>VK</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A novel approach for the prediction of species-specific biotransformation of xenobiotic/drug molecules by the human gut microbiota</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>9751</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-10203-6</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sievers</surname><given-names>F</given-names></name><name><surname>Higgins</surname><given-names>DG</given-names></name></person-group><year iso-8601-date="2014">2014</year><chapter-title>Clustal Omega, accurate alignment of very large numbers of sequences</chapter-title><person-group person-group-type="editor"><name><surname>Russell</surname><given-names>DJ</given-names></name></person-group><source>Multiple Sequence Alignment Methods</source><publisher-loc>Totowa, NJ</publisher-loc><publisher-name>Humana Press</publisher-name><fpage>105</fpage><lpage>116</lpage><pub-id pub-id-type="doi">10.1007/978-1-62703-646-7_6</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spanogiannopoulos</surname><given-names>P</given-names></name><name><surname>Bess</surname><given-names>EN</given-names></name><name><surname>Carmody</surname><given-names>RN</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The microbial pharmacists within us: a metagenomic view of xenobiotic metabolism</article-title><source>Nature Reviews. Microbiology</source><volume>14</volume><fpage>273</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1038/nrmicro.2016.17</pub-id><pub-id pub-id-type="pmid">26972811</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>PNAS</source><volume>102</volume><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomas</surname><given-names>AM</given-names></name><name><surname>Segata</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Multiple levels of the unknown in microbiome research</article-title><source>BMC Biology</source><volume>17</volume><elocation-id>48</elocation-id><pub-id pub-id-type="doi">10.1186/s12915-019-0667-z</pub-id><pub-id pub-id-type="pmid">31189463</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>W</given-names></name><name><surname>Skolnick</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>How well is enzyme function conserved as a function of pairwise sequence identity</article-title><source>Journal of Molecular Biology</source><volume>333</volume><fpage>863</fpage><lpage>882</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2003.08.057</pub-id><pub-id pub-id-type="pmid">14568541</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>S</given-names></name><name><surname>Dai</surname><given-names>Z</given-names></name><name><surname>Guo</surname><given-names>P</given-names></name><name><surname>Fu</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>W</given-names></name><name><surname>Feng</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>M</given-names></name><name><surname>Zhan</surname><given-names>L</given-names></name><name><surname>Wu</surname><given-names>T</given-names></name><name><surname>Hu</surname><given-names>E</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Bo</surname><given-names>X</given-names></name><name><surname>Yu</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>ggtreeExtra: compact visualization of richly annotated phylogenetic data</article-title><source>Molecular Biology and Evolution</source><volume>38</volume><fpage>4039</fpage><lpage>4042</lpage><pub-id pub-id-type="doi">10.1093/molbev/msab166</pub-id><pub-id pub-id-type="pmid">34097064</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Smith</surname><given-names>DK</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name><name><surname>Lam</surname><given-names>TTY</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title><source>Methods in Ecology and Evolution</source><volume>8</volume><fpage>28</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.12628</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaharko</surname><given-names>DS</given-names></name><name><surname>Bruckner</surname><given-names>H</given-names></name><name><surname>Oliverio</surname><given-names>VT</given-names></name></person-group><year iso-8601-date="1969">1969</year><article-title>Antibiotics alter methotrexate metabolism and excretion</article-title><source>Science</source><volume>166</volume><fpage>887</fpage><lpage>888</lpage><pub-id pub-id-type="doi">10.1126/science.166.3907.887</pub-id><pub-id pub-id-type="pmid">5345205</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>C</given-names></name><name><surname>Dimitrov</surname><given-names>B</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Nayfach</surname><given-names>S</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>MIDAS2: Metagenomic intra-species diversity analysis system</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2022.06.16.496510</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimmermann</surname><given-names>M</given-names></name><name><surname>Zimmermann-Kogadeeva</surname><given-names>M</given-names></name><name><surname>Wegmann</surname><given-names>R</given-names></name><name><surname>Goodman</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2019">2019a</year><article-title>Separating host and microbiome contributions to drug pharmacokinetics and toxicity</article-title><source>Science</source><volume>363</volume><elocation-id>eaat9931</elocation-id><pub-id pub-id-type="doi">10.1126/science.aat9931</pub-id><pub-id pub-id-type="pmid">30733391</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zimmermann</surname><given-names>M</given-names></name><name><surname>Zimmermann-Kogadeeva</surname><given-names>M</given-names></name><name><surname>Wegmann</surname><given-names>R</given-names></name><name><surname>Goodman</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2019">2019b</year><article-title>Mapping human microbiome drug metabolism by gut bacteria and their genes</article-title><source>Nature</source><volume>570</volume><fpage>462</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1291-3</pub-id><pub-id pub-id-type="pmid">31158845</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zmora</surname><given-names>N</given-names></name><name><surname>Zilberman-Schapira</surname><given-names>G</given-names></name><name><surname>Suez</surname><given-names>J</given-names></name><name><surname>Mor</surname><given-names>U</given-names></name><name><surname>Dori-Bachash</surname><given-names>M</given-names></name><name><surname>Bashiardes</surname><given-names>S</given-names></name><name><surname>Kotler</surname><given-names>E</given-names></name><name><surname>Zur</surname><given-names>M</given-names></name><name><surname>Regev-Lehavi</surname><given-names>D</given-names></name><name><surname>Brik</surname><given-names>RBZ</given-names></name><name><surname>Federici</surname><given-names>S</given-names></name><name><surname>Cohen</surname><given-names>Y</given-names></name><name><surname>Linevsky</surname><given-names>R</given-names></name><name><surname>Rothschild</surname><given-names>D</given-names></name><name><surname>Moor</surname><given-names>AE</given-names></name><name><surname>Ben-Moshe</surname><given-names>S</given-names></name><name><surname>Harmelin</surname><given-names>A</given-names></name><name><surname>Itzkovitz</surname><given-names>S</given-names></name><name><surname>Maharshak</surname><given-names>N</given-names></name><name><surname>Shibolet</surname><given-names>O</given-names></name><name><surname>Shapiro</surname><given-names>H</given-names></name><name><surname>Pevsner-Fischer</surname><given-names>M</given-names></name><name><surname>Sharon</surname><given-names>I</given-names></name><name><surname>Halpern</surname><given-names>Z</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name><name><surname>Elinav</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Personalized gut mucosal colonization resistance to empiric probiotics is associated with unique host and microbiome features</article-title><source>Cell</source><volume>174</volume><fpage>1388</fpage><lpage>1405</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.041</pub-id><pub-id pub-id-type="pmid">30193112</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82401.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Redinbo</surname><given-names>Matthew</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0130frc33</institution-id><institution>The University of North Carolina - Chapel Hill</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.08.02.502504" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.02.502504"/></front-stub><body><p>This paper provides important advances in utilizing chemical, metagenomic and enzyme mechanistic insights into the roles gut microbiota play in health-related chemical conversions. The authors convey results from a series of convincing studies that outline the utility of their computational platform, one that will be useful to both specialized microbiome researchers as well as a broad audience of scientists interested in the numerous ways non-host enzymes impact host biology.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82401.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Redinbo</surname><given-names>Matthew</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0130frc33</institution-id><institution>The University of North Carolina - Chapel Hill</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Zimmermann</surname><given-names>Michael</given-names></name><role>Reviewer</role></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.02.502504">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2022.08.02.502504v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A novel <italic>in silico</italic> method employs chemical and protein similarity algorithms to accurately identify chemical transformations in the human gut microbiome&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Wendy Garrett as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Michael Zimmermann (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Additional non-experimental validations must be performed to support the conclusions drawn by the manuscript</p><p>2) At least one experimental validation must also be provided to establish the usefulness of this tool.</p><p>3) The manuscript frequently claims superiority over existing methods, but this is not supported by the necessary additional validations requested above.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The following should be addressed prior to consideration for publication.</p><p>1. The manuscript is far too repetitive in terms of its goals and its claims of success. These claims are clear from the Abstract and Introduction, and should not be revisited throughout the text.</p><p>2. More information should be given about the granularity present in the EC code (as noted first in the text on line 85) toward the goals stated. Are EC codes sufficient to select enzyme orthologs within an overall class? For example, would specific Azoreductases be selected by this tool (e.g., a Class I vs. Class II), or would AzoR be the output? This is important for several reasons. First, EC classifications are typically broad (e.g., glycoside hydrolase family 1 has many thousand orthologs in the gut microbiome), and within such classifications many, many distinct orthologs are present. The authors should be clear about what their tool produces and, perhaps even more importantly, what it does NOT produce.</p><p>3. How did MetaCyc filter from its ~18K reactions to the nearly ~9K employed?</p><p>4. What are the limitations of MetaCyc? Even 9K sounds like a lot, but given ~10 million unique proteins in a conservative estimation of the gut microbiome, those factors (even if only 10% are enzymes) are likely to catalyze more than 10,000 reactions.</p><p>5. The statement on lines 214-5 that the data in Figure 3B that &quot;there is much variation in this relationship&quot; appears to be a massive understatement. Figure 3B appears to contain much more information than the authors are considering. To name just one, what is the nature of the cluster between 0.2-0.4 on the x-axis and ~0.2 on the y-axis?</p><p>6. On line 281, an output from SIMMER is stated to provide a list of the &quot;top 20&quot; ranked MetaCyc reactions. Is this good enough? The manuscript claims that this tool will provide information that will allow researchers to focus their hypotheses, but if the &quot;right answer&quot; is only 5% of the &quot;possible answers&quot; provided, that is pretty unfocused and does not support the (highly, highly) repeated claims of clean deliverables proffered by the authors.</p><p>7. There appears to be package version conflicts for the majority of the conda dependencies specified in SIMMER.yml, such that implementing command-line SIMMER is not straightforward as described in the manuscript or on the github page. This needs to be corrected and β-tested so users can successfully use the tool locally in a command-line manner.</p><p>8. An additional &quot;real world&quot; example should be explored to examine the success of this tool. Two suggestions are PMID 31663730 or the very recently published PMID 35953888. In both cases, cleavage of glucuronides is examined from human drugs. However, very unique and hard-to-predict types of glucuronidases are identified in each case, and these unique orthologs are due to the distinct linkage of the glucuronide to the parent drug molecule. Would SIMMER be able to identify these orthologs?</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>A few suggestions to improve and clarify the manuscripts.</p><p>1) Related to comment 1) in the 'public review': presenting how many false positive hits per prediction are generated by SIMMER, belonging to how many EC classes, sub-classes, etc. together with the truly positive results would benefit the interpretation of results. Also, the rank position of the true positive prediction in the prediction list should be reported, and not only its presence, since only the top enzyme annotations are used as queries for the protein similarity search of potential gut bacterial enzymes. Especially the potential impact of the presence of several EC classes (eventually biasing the hypothesis generation process before experimental validation) should be assessed.</p><p>2) Related to comment 2) in the 'public review': due to the different input formats between SIMMER, MicrobeFDT, and DrugBug, it would be useful to demonstrate that SIMMER has at least comparable performances to the other tools when their input format is used (i.e., substrate fingerprint only).</p><p>3) Related to comment 5) in the 'public review': a revision of the text is needed to clarify terms and avoid the readers' confusion. Already in the title, the method is described as being able to &quot;identify chemical transformations in the human gut microbiome&quot;; however, SIMMER requires a fully chemically characterized biotransformation (in terms of substrate, (co-factors), and products) as input (and is therefore not able to identify new biotransformations). The text should be modified to highlight that SIMMER identifies and characterizes the enzymatic reaction of known biotransformation. On the same note, please also revise lines 81-82, 358-359, 480-481, and 531-532 accordingly.</p><p>4) The website version of SIMMER could be easily tested; it's intuitive, although a more extensive description of Output headers could help the user understand the results better. It was not possible to create the conda env after cloning the github repo (&quot;Solving environment: failed&quot; error)</p><p>5) As showcased in Figure4—figure supplement 1, additional filtering steps might be needed to filter the SIMMER enzyme list to a relevant subset (e.g., before in vitro validation). The authors should consider adding a plug-in to both the command line and online version of the tool so that these filtering steps could potentially be applied by the users as well. This might benefit especially experimentalist users, who might not be comfortable with running several additional filtering steps via cli.</p><p>6) More detailed results might improve the understanding of the reported examples. E.g., it is unclear how SIMMER could not accurately predict EC number for brivudine transformation (Line 197), but correctly predict BT_4554 as being responsible for the reaction. Reporting SIMMER output for this query as supplementary material would help the user navigate the examples better.</p><p>7) In the example describing dexamethasone biotransformation, the authors should describe the SIMMER predicted enzyme(s) in more detail (predicted EC number, sequence, etc.) since it (they) reportedly does not correspond to the already described DesAB gene.</p><p>8) When quantification of SIMMER predicted enzymes is performed in metagenome samples (see for example Lines 427, 430, 545), it is unclear what association is performed: is this the quantification of only the first (i.e., top scoring) predicted enzyme in the sample or is it the quantification of several different SIMMER enzymes in the same sample? If the latter, how are quantification results from different enzymes collapsed together?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>I am most concerned about major overstatements related to the performance and validation of SIMMER resource predictions.</p><p>&quot;We show that SIMMER predicts the chemistry and responsible species and enzymes for a queried reaction with high accuracy.&quot;</p><p>The validation of SIMMER predicted enzyme-drug interactions utilizes metagenomic data from a single donor stool sample in which drug metabolism was demonstrated. Other samples used as 'validation' have only 16S rRNA gene sequencing.</p><p>Their analysis, identifying microbial taxa via 16S in fecal samples that demonstrated metabolism of a drug does not support the claim that SIMMER &quot;predicts the chemistry and responsible species and enzymes&quot;. There is no experimental or computational enzymatic validation; rather the authors infer from taxonomic representation in 16S data that the enzymes they predict metabolize the drug must be present in the bacteria found in the drug-metabolizing fecal samples. This validation is several steps removed from identifying &quot;responsible species and enzymes&quot;. This sentence in the abstract is thus a major overstatement of their results.</p><p>&quot;Bacterial species containing these enzymes are enriched within human donor stool samples that metabolize the query compound.&quot;</p><p>To discuss this point further; that bacterial species purported to contain specific enzymes are enriched in stool samples that metabolize a compound is insufficient to validate that SIMMER has identified microbiome enzymes that metabolize a drug. Saying that you see species increase in abundance that you think have enzymes that can metabolize a drug is far removed from their claim that they can identify specific microbiome enzyme-drug interactions.</p><p>In a later discussion of microbiome metabolism of dexamethasone, the authors state: &quot;These results indicate that species level information alone is not enough to predict chemical transformations in a microbiome sample, but with SIMMER, knowledge of responsible enzymes can recapitulate a sample's potential for therapeutic degradation.&quot; However, using species-level information alone is precisely what they did in their 16S-based validation set. This point needs to be clarified.</p><p>Finally, they refer to these entirely computational validation approaches as &quot;experimental validation&quot; of SIMMER, which is inaccurate. Based on <italic>eLife</italic> precedent, I strongly advise experimental validation of at least one of their predicted novel enzyme-drug interactions.</p><p>Regarding sequence similarity/chemical similarity, a foundational component of the resource:</p><p>&quot;SIMMER was created with the assumption that chemically similar reactions are mediated by sequence similar enzymes&quot;</p><p>It would be helpful for the authors to consider the work of the Babbitt, Gerlt, Almo, and Jacobsen labs:</p><p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3249080/</p><p>&quot;From a survey of structurally characterized superfamilies, almost 40% are functionally diverse, i.e. different members catalyze reactions with different EC numbers (4). Thus, trivial annotation transfer by sequence homology is often not sufficient to assign function.&quot;</p><p>The authors' assertion that enzyme sequence similarity is sufficient to identify chemically similar reactions is also not well supported by experimental studies on enzyme families that metabolize drugs in the human gut.</p><p>In studies of Cgr2, a member of a microbiome drug-metabolizing enzyme family that was deeply characterized by the Turnbaugh and Balskus labs, sequence-based clustering was unable to resolve biochemical functioning.</p><p>https://elifesciences.org/articles/33953</p><p>&quot;At all thresholds at which Cgr2 remained connected to other protein sequences, all characterized enzymes within the SSN were co-clustered, precluding the resolution of unique biochemical functions at this cutoff. &quot;</p><p>In Figure 3B one can see the issues with protein percent identity as a metric for functional similarity. The use of a linear model is likely not appropriate here given the substantial variability in the relationship between reaction distance and percent identity. However, it is clear that the statement &quot;reactions with similar chemistry are conducted by sequence similar enzymes&quot; is not upheld in much of their data. As an example, in the range of identity that they are using (27% identity, per the methods) there is a large spread in reaction distances.</p><p>These nuances in sequence-function relationships that can confound microbiome drug metabolism studies are critical to deal with in such analyses and they are one reason that other resources that seek to identify microbiome-drug interactions utilize a variety of sources of evidence to assess the likelihood of specific microbiome-drug interactions.</p><p>As the authors note, each of these current tools to predict microbiome-drug interactions has limitations. For SIMMER, the major limitation, which is only briefly alluded to, is the need for a user to already know both substrate and product. As the authors note, publications experimentally characterizing microbiome-drug interactions often utilize parent compound loss as the marker for microbiome drug metabolism.</p><p>Knowing and providing the substrates and products requires chemical knowledge that could also be used to identify the type of reaction that is being carried out. This makes the SIMMER resource harder to use for users without that chemical knowledge, which is where the other resources that the authors use as a comparison (BugDrug, MicrobeFDT) may be more helpful.</p><p>Additional comments</p><p>The authors should indicate how many different modifications are represented in the 88 reactions that were queried to evaluate how well the resource works at predicting novel drug-metabolizing enzymes.</p><p>It is unclear if the SIMMER resource covers greater chemical space than the other resources. Database size does not necessarily correlate with chemical diversity. An explicit comparison of chemical space should be quantified and compared across all resources.</p><p>The authors do not represent the goals of the other resources that they use as comparisons accurately; these resources take different approaches to identify microbiome-drug predictions. As an example, the &quot;Direct query&quot; of the MicrobeFDT resource yielded 3/4 &quot;correct&quot; predictions, why does Table 1 not include this accuracy metric?</p><p>It would be helpful for the authors to discuss the limitations of MetaCyc and the representation of enzymes involves in anaerobic degradation reactions that would be expected in the gut.</p><p>The authors need to make available and searchable their data connecting microbiome taxa, enzymes and predicted drug metabolism, this would greatly broaden the utility of the resource to the community.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;SIMMER employs similarity algorithms to accurately identify human gut microbiome species and enzymes capable of known chemical transformations&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Wendy Garrett (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>I am satisfied that the authors have carried out key validations of the SIMMER tool, including experimental characterization of a SIMMER prediction, the metabolism of methotrexate by hydrolases.</p><p>I ask that the authors credit prior research demonstrating that methotrexate is metabolized by hydrolases (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5082436/). They extend prior work on methotrexate here by showing strain-level characterization of MTX metabolism, a valuable addition to our understanding of drug metabolism by gut microbes.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.82401.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Additional non-experimental validations must be performed to support the conclusions drawn by the manuscript</p></disp-quote><p>In addition to our previous validations, the resubmission now includes:</p><list list-type="order"><list-item><p>An additional validation on an external dataset (Rheumatoid Arthritis patients’ clinical response to methotrexate) described in Figure 9 and lines 507–530.</p></list-item><list-item><p>Two additions to the positive control set (regorafenib-glucuronide and mycophenolate-glucuronide), thanks to added knowledge from Reviewer 1. This expanded our list of enzyme-characterized microbiome biotransformations from 31 to 33, and we have adjusted the accuracy measures in Table 1, Figure 5, and the text accordingly.</p></list-item><list-item><p>An assessment of how the accuracy and false positive rate of SIMMER’s enzyme output relate as a user probes the N (now a user defined parameter) closest reactions to a query (described in Figure 5—figure supplement 2 and lines 295–302). We additionally detail (in Figure 5B and in lines 283–286) our rationale for using N=20 reactions when calculating SIMMER’s enzyme prediction accuracy.</p></list-item><list-item><p>A false positive rate for SIMMER’s EC predictor, described in Figure 2— figure supplement 2.</p></list-item><list-item><p>Additional comparisons to the two existing methods. We previously described competing methods and their abilities to predict EC numbers and enzyme sequences in comparison to SIMMER (Table 1). We have supplemented the text to clarify how this analysis was conducted (lines 979– 985), and we now provide further demonstration (via modifying SIMMER to use only substrates as inputs) that SIMMER’s improved accuracy is in part due to its chemical representation method (described in lines 369–384, Table 1—source data, Figure 2—figure supplement 4). We also applied the existing methods to data from our experimental validation of bacterial metabolism of methotrexate and compared the results to SIMMER’s predictions (described next in Essential Revision 2).</p></list-item></list><disp-quote content-type="editor-comment"><p>2) At least one experimental validation must also be provided to establish the usefulness of this tool.</p></disp-quote><p>In addition to SIMMER’s ability to predict strains and enzymes that explain interindividual metabolism variation in previously published studies (i.e., validation on external datasets), we now include a novel experimental assessment of bacterial strains SIMMER predicted as capable of degrading methotrexate (MTX), the mainline therapy for rheumatoid arthritis patients. We observed a significant concordance between SIMMER predictions and depletion of MTX measured with high-performance liquid chromatography (HPLC) (OR=5.4, Fisher’s Exact Test pvalue&lt;0.05). This experimental validation is described in a new figure (Figure 8 and lines 469–487 of the current manuscript), and represents the first strain-level characterization of MTX metabolism by human gut microbiome bacteria.</p><p>As an additional comparison to DrugBug and MicrobeFDT, we assessed MTX metabolism with the two tools. Both incorrectly predicted that MTX degradation is through transferases rather than hydrolases. Because DrugBug also provides species and enzyme predictions, we also assessed its ability to predict species responsible for MTX metabolism and found that only SIMMER was able to significantly predict the depleting species (SIMMER Odds Ratio=5.4 versus DrugBug Odds Ratio=0, Figure 8— figure supplement 1 and lines 489–497). DrugBug produced zero true positives and predicted that MTX-metabolism was a feature largely restricted to members of Bacteroidetes, a group who exhibited no activity in our <italic>in-vitro</italic> assay (Figure 8—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>3) The manuscript frequently claims superiority over existing methods, but this is not supported by the necessary additional validations requested above.</p></disp-quote><p>To address this recommendation, we revised the manuscript in multiple places to temper overstatements of superiority. We also edited and supplemented the text to make clear the method comparison previously conducted. We updated accuracy measures of all three methods to reflect the new additions to the positive control list (Table 1). We provided additional demonstration, via modifying SIMMER to use only a substrate as input, that DrugBug and MicrobeFDT exhibit lower accuracy predictions due to their limited chemical representations (described in lines 369– 384, Table 1—source data, Figure 2—figure supplement 4). Finally, we performed additional comparisons to these two competing methods by evaluating their predictions for MTX metabolism in our in vitro experiments, and observed lower accuracy (described in Response 2 above).</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The following should be addressed prior to consideration for publication.</p><p>1. The manuscript is far too repetitive in terms of its goals and its claims of success. These claims are clear from the Abstract and Introduction, and should not be revisited throughout the text.</p></disp-quote><p>We have revised the manuscript extensively to remove repetitive statements.</p><disp-quote content-type="editor-comment"><p>2. More information should be given about the granularity present in the EC code (as noted first in the text on line 85) toward the goals stated. Are EC codes sufficient to select enzyme orthologs within an overall class? For example, would specific Azoreductases be selected by this tool (e.g., a Class I vs. Class II), or would AzoR be the output? This is important for several reasons. First, EC classifications are typically broad (e.g., glycoside hydrolase family 1 has many thousand orthologs in the gut microbiome), and within such classifications many, many distinct orthologs are present. The authors should be clear about what their tool produces and, perhaps even more importantly, what it does NOT produce.</p></disp-quote><p>We have now added a quick description of what EC codes represent, in terms of increasing chemical granularity across the four-digit identifier in lines 166–172.</p><p>We thank the reviewers for highlighting that we did not adequately describe how SIMMER conducts protein similarity searches. EC predictions are not the primary output of SIMMER, and they are not the basis for SIMMER’s enzyme ortholog searches. SIMMER’s enzyme sequence and EC predictors are two separate functions that do not rely on each other. From the most similar MetaCyc reaction(s), we use MetaCyc enzyme <italic>sequence</italic> annotations to perform profile hidden Markov model (pHMM) searches against the UHGG database to find microbiome homologs of the annotated enzymes. These sequence searches do not use MetaCyc EC numbers in any way. As an <italic>auxiliary</italic> function, SIMMER also predicts EC numbers for input reactions through a separate process inspired by gene set enrichment analysis (details in Methods lines 893–923 and Figure 2—figure supplement 1). We added EC prediction since this is the primary output of existing tools and can provide useful information beyond specific enzyme hits.</p><p>To address this important point, we reworded the Results (lines 158–166) and Discussion (lines 640–654) of the text, and edited Figure 1 to make it explicit that these are two separate functions of the tool.</p><p>All this being said, the question still remains whether or not specific classes of a given enzyme can be drawn out using SIMMER’s pHMM sequence searching method. In short, it depends on the input reaction in question and how many examples of similar chemistry exist in the reaction database (MetaCyc). Enzyme class specificity of SIMMER will improve as databases continue to grow. This is possible with a method like SIMMER precisely because we do not rely on EC annotations; as MetaCyc is updated with new sequence annotated chemistry, SIMMER results will reflect orthologs based on sequence rather than database EC annotations that are missing ~70% of the time (Pouliot and Karp, 2007).</p><p>To conclude, we very much agree with the reviewers that EC codes are not sufficient for functional predictions of orthologs, and this was a key point that informed SIMMER’s architecture. By using pHMM searches for the most similar enzyme sequences and returning specific enzyme sequences, SIMMER provides a more specific output than would be possible with EC predictions alone. Thanks to the reviewers’ helpful feedback, we believe the text reads more clearly now, and readers will be able to determine from the text and from Figure 1 how SIMMER treats sequence predictions differently than its EC predictions, and what its explicit output is.</p><p>To address the reviewer’s azoreductase question specifically, there is currently a three-group classification scheme for these enzymes that does not neatly cover all known bacterial azoreductases (Misal and Gawai, 2018; Ryan, 2017; Zou et al., 2020). From our positive control searches of azoreductases: olsalazine and prontosil SIMMER predictions were all most-sequence similar to Class I enzymes. SIMMER nicardipine reduction predictions, however, were most sequence-similar to ArsH, an azoreductase that lies outside the three-class system (Ryan et al., 2014).</p><disp-quote content-type="editor-comment"><p>3. How did MetaCyc filter from its ~18K reactions to the nearly ~9K employed?</p></disp-quote><p>Good question. These numbers are clarified in our Methods section lines 811–814 and summarized here:</p><p>“We employed the Reactions dataset from MetaCyc version 24.1 which contains N=16,810 reactions. Of these reactions, only N=13,387 were enzyme-driven reactions that possessed UniProt and/or Entrez sequence linkouts. Of these, only 8,914 were fingerprintable. Failed fingerprints were due to ambiguous SMILES identifiers or presence of non-small molecule compounds in a reaction, such as peptides.”</p><disp-quote content-type="editor-comment"><p>4. What are the limitations of MetaCyc? Even 9K sounds like a lot, but given ~10 million unique proteins in a conservative estimation of the gut microbiome, those factors (even if only 10% are enzymes) are likely to catalyze more than 10,000 reactions.</p></disp-quote><p>MetaCyc and KEGG are currently the most informative literature-curated pathway databases, both containing more bacterial reactions than BRENDA, Reactome, or Rhea (Altman et al., 2013). In terms of numbers of single-step reactions, MetaCyc (version 24.1) exceeds KEGG (Release 104.0) (16,810 reactions versus KEGG’s 11,841). From a protein perspective too, MetaCyc exceeds KEGG in reaction representation (237,506 bacterial enzymes to KEGG’s 10,249 bacterial enzymes). Interestingly, the overlap between MetaCyc and KEGG is not as high as one would assume and was last calculated as only 1,961 reactions in common (Altman et al., 2013). Combining both bacterial chemistry databases, therefore, would be the most comprehensive representation of bacterial chemistry. For simplicity of standardized data preparation, we chose to only employ one database, MetaCyc, but SIMMER could easily be extended in the future to include more underlying databases. To satisfy the reviewer request for a comparison of chemical resources, we computed fingerprints for all KEGG reactions and plotted PCs 1-3 after performing PCA jointly on all MetaCyc and KEGG chemical reactions. The two databases largely overlap, but there does seem to be some additional chemical diversity in KEGG that SIMMER could benefit from in future iterations:</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-82401-sa2-fig1-v3.tif"/></fig><p>This is an important limitation to make the reader aware of, and we have edited our Discussion (lines 771–776) describing the limitations of MetaCyc accordingly:“While MetaCyc is the largest annotated bacterial reaction database to date (Altman et al., 2013; Caspi et al., 2020), it likely only represents a fraction of the still underexplored microbiome catalyzed biotransformation space. Additionally, the chemistry present in MetaCyc is not restricted to anaerobic organisms such as the bacteria found in the human gut. As MetaCyc expands, or additional databases get employed, SIMMER will be able to make increasingly fine-tuned predictions.”</p><disp-quote content-type="editor-comment"><p>5. The statement on lines 214-5 that the data in Figure 3B that &quot;there is much variation in this relationship&quot; appears to be a massive understatement. Figure 3B appears to contain much more information than the authors are considering. To name just one, what is the nature of the cluster between 0.2-0.4 on the x-axis and ~0.2 on the y-axis?</p></disp-quote><p>Great clarifying question. This linear relationship is not part of SIMMER; it’s a description of the relationship between proteins and chemistry in MetaCyc. This highly varied relationship is why we use pHMM searches that don’t require high global (i.e., full sequence) percent identities. Figure 3B and its significance for SIMMER’s architecture are now described more clearly in our Results section (lines 217–229):</p><p>“We also found a negative association between chemical reaction distance and global sequence similarity of MetaCyc enzyme annotations, though there is much variation in this relationship (Figure 3B). This reflects the known association between sequence similarity and similarity in chemical function, as well as reports that this relationship can often be overestimated (Tian and Skolnick, 2003). Indeed, MetaCyc reactions with identical chemical representations could be conducted by proteins with only ~20% global percent identity all the way to 100% (Figure 3B). This relationship informed our decision to use pHMM searches rather than BLAST to find sequence similar proteins from the human gut microbiome, as pHMM searches rely on matches of conserved sites rather than global percent identity between sequences. Together, these analyses informed the manner in which we combined chemical and protein similarity to create a microbiome enzyme prediction tool.”</p><disp-quote content-type="editor-comment"><p>6. On line 281, an output from SIMMER is stated to provide a list of the &quot;top 20&quot; ranked MetaCyc reactions. Is this good enough? The manuscript claims that this tool will provide information that will allow researchers to focus their hypotheses, but if the &quot;right answer&quot; is only 5% of the &quot;possible answers&quot; provided, that is pretty unfocused and does not support the (highly, highly) repeated claims of clean deliverables proffered by the authors.</p></disp-quote><p>We agree. We have edited the manuscript to describe why we chose the reaction cutoff we did for accuracy reporting in lines 283–286. Additionally, we provide an assessment of how SIMMER’s accuracy and false positive rate change as more reactions are used in the output (Figure 5—figure supplement 2). Finally, we modified SIMMER’s command-line program to make the number of reactions considered into a user-defined parameter.</p><disp-quote content-type="editor-comment"><p>7. There appears to be package version conflicts for the majority of the conda dependencies specified in SIMMER.yml, such that implementing command-line SIMMER is not straightforward as described in the manuscript or on the github page. This needs to be corrected and β-tested so users can successfully use the tool locally in a command-line manner.</p></disp-quote><p>We apologize for this issue, and thank Reviewers 1 and 2 for bringing it to our attention. The GitHub repository has been updated with a yml file that has been tested by independent users, along with instructions for alternatively installing required packages directly from Anaconda.</p><disp-quote content-type="editor-comment"><p>8. An additional &quot;real world&quot; example should be explored to examine the success of this tool. Two suggestions are PMID 31663730 or the very recently published PMID 35953888. In both cases, cleavage of glucuronides is examined from human drugs. However, very unique and hard-to-predict types of glucuronidases are identified in each case, and these unique orthologs are due to the distinct linkage of the glucuronide to the parent drug molecule. Would SIMMER be able to identify these orthologs?</p></disp-quote><p>We agree that evaluating SIMMER on external datasets (as we did previously with PMID32526207 and PMID31158845) is valuable. As mentioned in our original submission, SIMMER is meant to be a hypothesis-building tool for preliminary experiments on a broad set of enzymes and species, not a fine-tuned predictor of the specific residues and structures that allow a reaction to proceed. That being said, we did evaluate both of the recommnended publications and added both examples to our list of positive controls (PMID 31663730 and PMID 35953888).</p><p>The first study, PMID31663730, did not collect stool samples from a patient population, so we were only able to evaluate regorafenib-glucuronide deglucuronidation as an additional positive control reaction. Table 1, Figure 5, Supplementary Files 1-2, and the section “SIMMER captures known gut bacterial enzymes involved in drug metabolism” have been updated accordingly. To describe fully here, PMID31663730 showed that only four (CBK98066.1, WP_118096903.1, WP_118581144.1, CBJ55484.1) out of 31 tested β-glucuronidases were able to conduct reactivation of regorafenib. We evaluated which out of the 31 sequences SIMMER predicted and found that SIMMER significantly predicted the true metabolizers out of the 31 sequences (p-value=0.02, Fisher’s exact test). In addition to predicting all four of the true positives, SIMMER additionally predicted eight false positives,</p><list list-type="order"><list-item><p>WP_102727023.1 DUF4982 domain-containing protein [Akkermansia muciniphila]</p></list-item><list-item><p>WP_130053801.1 malectin domain-containing carbohydrate-binding protein [Phocaeicola dorei]</p></list-item><list-item><p>WP_005822521.1 DUF4982 domain-containing protein [Bacteroides]</p></list-item><list-item><p>WP_022502167.1 β-glucuronidase [Lachnospira pectinoschiza]</p></list-item><list-item><p>WP_001551153.1 β-glucuronidase [<italic>Enterobacteriaceae</italic>]</p></list-item><list-item><p>HBH98519.1 β-glucuronidase [Lachnospiraceae bacterium]</p></list-item><list-item><p>WP_010800018.1 β-galactosidase [Parabacteroides]</p></list-item><list-item><p>CUO31707.1 Β-glucuronidase [Roseburia hominis],</p></list-item></list><p>resulting in a 30% enzyme prediction false positive rate for this reaction. This was a helpful study for us to explore; most pharmacomicrobiomics findings only provide true-positives, but the current study allowed us to compute a false positive rate, which was fairly high (30%) for the reaction at hand. This is in line with our expectation that while SIMMER has high accuracy, it will suffer from false positives. From the perspective of hypothesis generation for future experiments, this false positive rate is tolerable.</p><p>Another point of interest from this study is that regorafenib-glucuronide is N-linked, unlike the O-linked β-glucuronidase reactions we previously assessed as positive controls. Despite there being no MetaCyc N-glucuronide hydrolysis reactions (only O-glucuronides), SIMMER’s precomputed chemical embeddings allowed the retrieval of N-glucuronide acting β-glucuronidases. This finding interested us, so we proceeded to assess the type of structures present in SIMMER’s regorafenib reactivation predictions. Previous research shows that β-glucuronidases come in six structural flavors based on type and/or presence of an active site loop: Loop1 (L1), mini-Loop1 (mL1), Loop2 (L2), mini-Loop2 (mL2), mini-Loop1,2 (mL1,2), and No Loop (NL) (Pollet et al., 2017). All four true positives from PMID31663730 were NL β-glucuronidases (Ervin et al., 2019), and SIMMER’s predictions were from the NL (76% of SIMMER predictions) and mL1 (24% of SIMMER predictions) active site groups. This analysis demonstrated SIMMER’s ability to make relevant enzyme predictions even for reactions not explicitly described in the MetaCyc database.</p><p>The second study (PMID35953888) could have been used as an additional external dataset validation, as it included an assessment of mycophenolic acid reactivation in patient stool samples. Unfortunately, we have not yet been granted approval to download the metagenomic sequencing data from this study (a request was submitted shortly after receiving these reviews). To satisfy the request for an additional “real world example,” we therefore turned to PMID33314800 and assessed whether or not SIMMER’s enzyme predictions for Methotrexate (MTX) hydrolysis to DAMPA and glutamate were enriched in rheumatoid arthritis (RA) patients clinically unresponsive to the drug. This work is described on lines 507– 530 of the resubmitted manuscript and in the Essential revisions response 1.1.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>A few suggestions to improve and clarify the manuscripts.</p><p>1) Presenting how many false positive hits per prediction are generated by SIMMER, belonging to how many EC classes, sub-classes, etc. together with the truly positive results would benefit the interpretation of results. Also, the rank position of the true positive prediction in the prediction list should be reported, and not only its presence, since only the top enzyme annotations are used as queries for the protein similarity search of potential gut bacterial enzymes. Especially the potential impact of the presence of several EC classes (eventually biasing the hypothesis generation process before experimental validation) should be assessed.</p></disp-quote><p>We have now added a false positive assessment. To answer the further questions here, we did previously report the rank position of positive controls in the Figure 5—source data file. Also, we realized after reading all reviewer responses, including this, that we did not adequately describe how protein similarity searches were conducted and that these are distinct from our predictions of EC codes. Please refer to Reviewer 1 point 2.</p><p>We agree that our analysis would benefit from an assessment of false positives. Unfortunately, current literature usually reports which reactions an enzyme is capable, rather than incapable, of performing. For this reason, we took a conservative approach and decided to define all reactions preceding that which yielded a positive control enzyme sequence as false positives. This is now described above in Essential revisions response 1.3.</p><disp-quote content-type="editor-comment"><p>2) Due to the different input formats between SIMMER, MicrobeFDT, and DrugBug, it would be useful to demonstrate that SIMMER has at least comparable performances to the other tools when their input format is used (i.e., substrate fingerprint only).</p></disp-quote><p>We have addressed this concern in Essential revisions response 3.</p><disp-quote content-type="editor-comment"><p>3) A revision of the text is needed to clarify terms and avoid the readers' confusion. Already in the title, the method is described as being able to &quot;identify chemical transformations in the human gut microbiome&quot;; however, SIMMER requires a fully chemically characterized biotransformation (in terms of substrate, (co-factors), and products) as input (and is therefore not able to identify new biotransformations). The text should be modified to highlight that SIMMER identifies and characterizes the enzymatic reaction of known biotransformation. On the same note, please also revise lines 81-82, 358-359, 480-481, and 531-532 accordingly.</p></disp-quote><p>We agree, and have reworded key phrases in the text, including the title.</p><p>New Title:</p><p>SIMMER employs similarity algorithms to accurately identify human gut microbiome species and enzymes capable of known chemical transformations</p><p>Former lines 81–82 (current lines 89–91) changed to:</p><p>“To address these gaps in accurate predictive software, we present SIMMER, a tool that combines chemoinformatics and metagenomics approaches to accurately predict bacterial species and enzymes capable of known biotransformations in the human gut.”</p><p>Former lines 358–359 (current lines 386–389) changed to:</p><p>“Altogether, these findings illustrate SIMMER’s enhanced accuracy over other methods for the use case of characterized drug metabolism events by gut bacteria, and also illustrate SIMMER’s novel ability to predict species and enzymes responsible for chemical transformations not previously described in literature or databases.”</p><p>Former lines 480–481 (current lines 620–623) changed to:</p><p>“This advances our ability to discover the genetic determinants of human microbiome chemical transformations, because previous methods for in silico metabolism prediction had several key limitations, including low accuracy.”</p><p>Former lines 531–532 (current lines 694–696) changed to:</p><p>“Due to its accurate predictions of previously described drug-metabolizing bacterial enzymes, we also used SIMMER to identify previously unknown bacterial species and enzymes at play in known gut microbiome drug transformations.”</p><disp-quote content-type="editor-comment"><p>4) The website version of SIMMER could be easily tested; it's intuitive, although a more extensive description of Output headers could help the user understand the results better. It was not possible to create the conda env after cloning the github repo (&quot;Solving environment: failed&quot; error)</p></disp-quote><p>We apologize for the conda environment issue, and thank both Reviewer 1 and 2 for bringing it to our attention. The GitHub repository has been updated with yml file that was tested by independent users, along with instructions for how to proceed in the case of solving environment issues.</p><disp-quote content-type="editor-comment"><p>5) As showcased in Figure4—figure supplement 1, additional filtering steps might be needed to filter the SIMMER enzyme list to a relevant subset (e.g., before in vitro validation). The authors should consider adding a plug-in to both the command line and online version of the tool so that these filtering steps could potentially be applied by the users as well. This might benefit especially experimentalist users, who might not be comfortable with running several additional filtering steps via cli.</p></disp-quote><p>We contacted the creators and maintainers of the Similarity Ensemble Approach (SEA) tool to see if this was possible. At this time unfortunately, the creators wish for the repository (and therefore commandline tool) to remain private. SIMMER users wishing to use SEA can use the public webtool, or likely gain access to the commandline SEA by directly contacting the creator (<italic>Keiser M, personal communication, October 24, 2022</italic>).</p><disp-quote content-type="editor-comment"><p>6) More detailed results might improve the understanding of the reported examples. E.g., it is unclear how SIMMER could not accurately predict EC number for brivudine transformation (Line 197), but correctly predict BT_4554 as being responsible for the reaction. Reporting SIMMER output for this query as supplementary material would help the user navigate the examples better.</p></disp-quote><p>Please see response to Reviewer 1, comment 2.</p><disp-quote content-type="editor-comment"><p>7) In the example describing dexamethasone biotransformation, the authors should describe the SIMMER predicted enzyme(s) in more detail (predicted EC number, sequence, etc.) since it (they) reportedly does not correspond to the already described DesAB gene.</p></disp-quote><p>Thank you for catching this. We have included SIMMER’s sequence and annotation prediction output for dexamethasone metabolism in the Figure 10—source data file.</p><disp-quote content-type="editor-comment"><p>8) When quantification of SIMMER predicted enzymes is performed in metagenome samples (see for example Lines 427, 430, 545), it is unclear what association is performed: is this the quantification of only the first (i.e., top scoring) predicted enzyme in the sample or is it the quantification of several different SIMMER enzymes in the same sample? If the latter, how are quantification results from different enzymes collapsed together?</p></disp-quote><p>The latter association is performed, and we have reworded the Materials and methods in lines 1012–1016 to make this clear:</p><p>“The metabolism of dexamethasone to 17-oxodexamethasone was input to SIMMER with N=20 reactions output, and a DIAMOND database of all SIMMER enzyme predictions from C. scindens was created. Presence of SIMMER enzyme predictions was established via search with DIAMOND and normalized by sample read depth.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>I am most concerned about major overstatements related to the performance and validation of SIMMER resource predictions.</p><p>&quot;We show that SIMMER predicts the chemistry and responsible species and enzymes for a queried reaction with high accuracy.&quot;</p></disp-quote><p>Thanks for pointing this out. We agree and have edited wording throughout to correct any overstatements. We also have added many additional validations to this manuscript version to further support our findings. These additional validations include an in vitro experimental validation of SIMMER methotrexate metabolism predictions, additional positive controls, a false positive rate, additional comparisons to competing methods, and an additional validation on an external dataset.</p><disp-quote content-type="editor-comment"><p>The validation of SIMMER predicted enzyme-drug interactions utilizes metagenomic data from a single donor stool sample in which drug metabolism was demonstrated. Other samples used as 'validation' have only 16S rRNA gene sequencing.</p></disp-quote><p>No—we previously evaluated SIMMER on two external datasets, PMID32526207 which includes a 16S study, and PMID31158845 which includes a <italic>shotgun sequencing study</italic> of 28 dexamethasone-treated patient stool samples. Reviewer 3 misread the dexamethasone metagenomics analysis as another 16S study. This is clear from our Methods section, but we failed to describe this well enough in Results. We have reworded the Results section (lines 534–547) to make it clear that the dexamethasone treated cohort was a shotgun metagenomics sequencing study:</p><p>“Dexamethasone was recently shown to be metabolized solely by Clostridium scindens (ATCC 35704) out of a collection of 76 isolates representative of the human gut microbiome (Zimmermann et al., 2019b). When the authors assessed dexamethasone metabolism in 28 shotgun sequenced human stool samples, metabolite formation varied substantially by individual, but could not be explained by C. scindens species abundance. To explore this lack of correlation in light of our findings, we assessed the abundance of C. scindens SIMMER enzyme predictions (Figure 10—source data) within each of the 28 samples (i.e., the number of C. scindens SIMMER enzyme predictions aligned to each sample’s shotgun sequencing reads) rather than each sample’s C. scindens species relative abundance. We found a significant association between metabolite formation and number of SIMMER enzyme aligned reads, and also a significant association between parent compound consumption and number of SIMMER enzyme aligned reads (Figure 10B). This underscores the importance of identifying an enzyme and quantifying its presence in metagenomic data.”</p><p>We hope that the Results section reads more clearly now and that readers will understand that validation in a multi-person shotgun metagenomics dataset was performed. Furthermore, we have included an additional shotgun sequencing study validation (Rheumatoid Arthritis patients’ clinical response to methotrexate) described in Essential Revisions 1.</p><p>As to the merits of including a validation on the 16S dataset: SIMMER predicts both species and enzymes for xenobiotics degradation. We completely agree that 16S data is not enough to confirm the relevant enzymes at play in a drug degradation event, but it is a helpful analysis to include for the demonstration of species metabolism prediction. We now state the purpose of this analysis in the manuscript (lines 577–585).</p><disp-quote content-type="editor-comment"><p>Their analysis, identifying microbial taxa via 16S in fecal samples that demonstrated metabolism of a drug does not support the claim that SIMMER &quot;predicts the chemistry and responsible species and enzymes&quot;. There is no experimental or computational enzymatic validation; rather the authors infer from taxonomic representation in 16S data that the enzymes they predict metabolize the drug must be present in the bacteria found in the drug-metabolizing fecal samples. This validation is several steps removed from identifying &quot;responsible species and enzymes&quot;. This sentence in the abstract is thus a major overstatement of their results.</p></disp-quote><p>Please see response above.</p><disp-quote content-type="editor-comment"><p>&quot;Bacterial species containing these enzymes are enriched within human donor stool samples that metabolize the query compound.&quot;</p><p>To discuss this point further; that bacterial species purported to contain specific enzymes are enriched in stool samples that metabolize a compound is insufficient to validate that SIMMER has identified microbiome enzymes that metabolize a drug. Saying that you see species increase in abundance that you think have enzymes that can metabolize a drug is far removed from their claim that they can identify specific microbiome enzyme-drug interactions.</p></disp-quote><p>Please see response above.</p><disp-quote content-type="editor-comment"><p>In a later discussion of microbiome metabolism of dexamethasone, the authors state: &quot;These results indicate that species level information alone is not enough to predict chemical transformations in a microbiome sample, but with SIMMER, knowledge of responsible enzymes can recapitulate a sample's potential for therapeutic degradation.&quot; However, using species-level information alone is precisely what they did in their 16S-based validation set. This point needs to be clarified.</p></disp-quote><p>Please see response above.</p><disp-quote content-type="editor-comment"><p>Finally, they refer to these entirely computational validation approaches as &quot;experimental validation&quot; of SIMMER, which is inaccurate. Based on eLife precedent, I strongly advise experimental validation of at least one of their predicted novel enzyme-drug interactions.</p></disp-quote><p>We have addressed this in Essential Revisions Response 2.</p><disp-quote content-type="editor-comment"><p>Regarding sequence similarity/chemical similarity, a foundational component of the resource:</p><p>&quot;SIMMER was created with the assumption that chemically similar reactions are mediated by sequence similar enzymes&quot;</p><p>It would be helpful for the authors to consider the work of the Babbitt, Gerlt, Almo, and Jacobsen labs:</p><p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3249080/</p><p>&quot;From a survey of structurally characterized superfamilies, almost 40% are functionally diverse, i.e. different members catalyze reactions with different EC numbers (4). Thus, trivial annotation transfer by sequence homology is often not sufficient to assign function.&quot;</p><p>The authors' assertion that enzyme sequence similarity is sufficient to identify chemically similar reactions is also not well supported by experimental studies on enzyme families that metabolize drugs in the human gut.</p><p>In studies of Cgr2, a member of a microbiome drug-metabolizing enzyme family that was deeply characterized by the Turnbaugh and Balskus labs, sequence-based clustering was unable to resolve biochemical functioning.</p><p>https://elifesciences.org/articles/33953</p><p>&quot;At all thresholds at which Cgr2 remained connected to other protein sequences, all characterized enzymes within the SSN were co-clustered, precluding the resolution of unique biochemical functions at this cutoff. &quot;</p></disp-quote><p>We agree with this important caveat. It is worth noting that the works cited are assessments of global percent identity and shared function. For SIMMER we chose to use pHMM searches for this very reason. pHMM searches allow for retrieval of conserved sites in a sequence (like active and binding sites), rather than reliance on blanket global similarity, which is insufficient for functional transfer as pointed out by the Reviewer. Nonetheless, we agree completely that sequence homology, including that identified by pHMM methods, can be uncorrelated with functional similarity. To address this comment, we have added discussion of this important caveat to the manuscript with citations to the recommended papers, emphasizing that the goal of SIMMER is to prioritize and limit the set of possible experiments one might do rather than to replace experiments. SIMMER predictions will include many false positives and require experimental validation. But we believe that SIMMER nonetheless provides important information for designing and prioritizing downstream experiments.</p><disp-quote content-type="editor-comment"><p>In Figure 3B one can see the issues with protein percent identity as a metric for functional similarity. The use of a linear model is likely not appropriate here given the substantial variability in the relationship between reaction distance and percent identity. However, it is clear that the statement &quot;reactions with similar chemistry are conducted by sequence similar enzymes&quot; is not upheld in much of their data. As an example, in the range of identity that they are using (27% identity, per the methods) there is a large spread in reaction distances.</p></disp-quote><p>Please see response to Reviewer 1, comment 5.</p><p>Also, Reviewer 3 appears to misunderstand the 27% identity cutoff in the Methods. We apologize for not explaining this clearly. To create our sequence searches of microbiome gene catalogs, we choose all enzymes known to be responsible for a given reaction in MetaCyc (i.e., all enzymes in question have established <italic>identical function</italic>), and as long as all these <italic>functionally identical</italic> enzyme sequences share at least 27% sequence identity to one another, we create profile Hidden Markov Models (pHMM) to retrieve microbiome homologs. 27% identity for input to a multiple sequence alignment/pHMM is an established guideline for HMM algorithms, and it is employed widely by protein database resources like PANTHER and Pfam. We do not use 27% identity as a threshold for the discovered matches to the pHMM.</p><disp-quote content-type="editor-comment"><p>These nuances in sequence-function relationships that can confound microbiome drug metabolism studies are critical to deal with in such analyses and they are one reason that other resources that seek to identify microbiome-drug interactions utilize a variety of sources of evidence to assess the likelihood of specific microbiome-drug interactions.</p></disp-quote><p>We completely agree that the nuances of sequence-function relationships are critical, and for this reason took care when deciding how to retrieve sequence similar proteins that could still retain chemical function. We believe that the text reads more clearly now on this front, as our rationale for choosing pHMM search algorithms is better stated and validated. Additionally, we have updated the text to:</p><list list-type="order"><list-item><p>Discuss the limitations of linking sequence similarity to functional similarity, and,</p></list-item><list-item><p>Highlight that other resources (MicrobeFDT) utilize a multi-pronged approach to identity shared function (Table 1).</p></list-item></list><disp-quote content-type="editor-comment"><p>As the authors note, each of these current tools to predict microbiome-drug interactions has limitations. For SIMMER, the major limitation, which is only briefly alluded to, is the need for a user to already know both substrate and product. As the authors note, publications experimentally characterizing microbiome-drug interactions often utilize parent compound loss as the marker for microbiome drug metabolism.</p><p>Knowing and providing the substrates and products requires chemical knowledge that could also be used to identify the type of reaction that is being carried out. This makes the SIMMER resource harder to use for users without that chemical knowledge, which is where the other resources that the authors use as a comparison (BugDrug, MicrobeFDT) may be more helpful.</p></disp-quote><p>We agree that this is a limitation for the user, but as we show in our Results, relying on substrates alone does not yield appropriate representations of <italic>reactions</italic> and therefore does not allow for accurate predictions of responsible species/strains and enzymes (i.e., finding True Positives, and confirming associations from previously collected data). We agree that tools requiring only substrates are convenient, but our results show that they are less helpful in finding appropriate metabolism and enzyme predictions. Many studies of biotransformation in the human gut identify the product information or product structure via HPLC, LC-MS, and NMR techniques. In cases where such data was not gathered, or not gathered with enough structural resolution, researchers can use tools such as Biotransformer to make product template predictions before inputting a query to SIMMER. This recommendation is included in the present manuscript’s lines 369–384:</p><p>“In instances when DrugBug and MicrobeFDT did make predictions, they suffered from low accuracy (Table 1), which we hypothesized was due to both methods’ reliance on substrate rather than reaction chemistry. Biotransformations involve the relationship between substrate(s), cofactor(s), and an enzyme to yield a particular product(s). As one substrate can exhibit affinity for multiple enzymes, resulting in multiple unique products, sole employment of substrates in a chemical fingerprint does not achieve the resolution necessary to make relevant predictions. To test if SIMMER’s better performance could be attributed to including cofactors and products, we modified our code to run with a chemical representation that includes only the substrate of each positive control reaction. Enzyme prediction accuracy dropped from 88% down to 33%, and EC prediction accuracy dropped from 93% down to 48% (Table 1—source data), supporting the hypothesis that SIMMER’s better performance when compared to DrugBug and MicrobeFDT is due in large part to our using chemical representations that include the full reaction. These results are in line with our previous demonstration that SIMMER clusters enzymatic reaction chemistry only when a full reaction is employed (Figure 2, Figure 2—figure supplement 4).”</p><disp-quote content-type="editor-comment"><p>Additional comments</p><p>The authors should indicate how many different modifications are represented in the 88 reactions that were queried to evaluate how well the resource works at predicting novel drug-metabolizing enzymes.</p></disp-quote><p>The 88 reactions in Figure 6 represent 88 distinct modifications, mostly hydrolysis events, followed by oxidoreduction and transferase events. To assess how well SIMMER predicts all 88 previously uncharacterized reactions, 88 experimental assessments would need to be performed. As this was intractable for the amount of time we had, we have now added an in vitro assessment of one of these reactions, methotrexate hydrolysis. For an additional seven reactions (dexamethasone, capecitabine, misoprostol, nicardipine, risperidone, spironolactone, and tolcapone), we performed validations using external datasets.</p><disp-quote content-type="editor-comment"><p>It is unclear if the SIMMER resource covers greater chemical space than the other resources. Database size does not necessarily correlate with chemical diversity. An explicit comparison of chemical space should be quantified and compared across all resources.</p></disp-quote><p>Please see our response to Reviewer 1, comment 4.</p><disp-quote content-type="editor-comment"><p>The authors do not represent the goals of the other resources that they use as comparisons accurately; these resources take different approaches to identify microbiome-drug predictions. As an example, the &quot;Direct query&quot; of the MicrobeFDT resource yielded 3/4 &quot;correct&quot; predictions, why does Table 1 not include this accuracy metric?</p></disp-quote><p>This is a good point, and we have updated Table 1 and the text to describe additional goals of the tools (e.g., MicrobeFDT’s network descriptions of existing data). We have updated the text, Table 1, and supplemental data files to make explicit the accuracy measures of each tool. MicrobeFDT has 29% accuracy on EC predictions (Table 1) because it correctly predicted EC classes for 4/14 substrate degradation events. To provide even more clarity:</p><p>Out of the 33 positive control reactions, MicrobeFDT only makes predictions for 14. MicrobeFDT can be queried in two ways: first by looking for direct enzyme metabolism events, and second, by looking for enzyme metabolism of compounds that overlap chemically with the positive control in question. In theory, the first manner of query should always result in 100% accuracy because it only reflects already known data. Four of the 14 reactions could be assessed in the first manner (3 of which MicrobeFDT predicted correctly), and ten reactions in the second manner (0 of which MicrobeFDT predicted correctly). This resulted in a total accuracy of 4/14, or 29%.</p><disp-quote content-type="editor-comment"><p>It would be helpful for the authors to discuss the limitations of MetaCyc and the representation of enzymes involves in anaerobic degradation reactions that would be expected in the gut.</p></disp-quote><p>Please see our response to Reviewer 1, comment 4.</p><disp-quote content-type="editor-comment"><p>The authors need to make available and searchable their data connecting microbiome taxa, enzymes and predicted drug metabolism, this would greatly broaden the utility of the resource to the community.</p></disp-quote><p>Thank you for this good suggestion. All the underlying chemical, microbiome taxa, and microbiome protein data of SIMMER is already available (via link on SIMMER’s webtool page and Github page). This data link will be updated each year in tandem with major MetaCyc updates. To make this information more searchable as you suggest though, we have made a new program within the SIMMER command line tool (metacyc_microbiome_homologs.py) that allows the user to directly look up the microbiome homologs associated with any given MetaCyc reaction. SIMMER was not created with the intention of providing a searchable network of all microbiome proteins and chemistry, but for the curious researcher this would be doable with this newly provided program.</p><p>Artacho A, Isaac S, Nayak R, Flor-Duro A, Alexander M, Koo I, Manasson J, Smith PB, Rosenthal P, Homsi Y, Gulko P, Pons J, Puchades-Carrasco L, Izmirly P, Patterson A, Abramson SB, Pineda-Lucena A, Turnbaugh PJ, Ubeda C, Scher JU. 2020. The Pre-treatment Gut Microbiome is Associated with Lack of Response to Methotrexate in New Onset Rheumatoid Arthritis. <italic>Arthritis Rheumatol</italic>. doi:10.1002/art.41622</p><p>Ervin SM, Hanley RP, Lim L, Walton WG, Pearce KH, Bhatt AP, James LI, Redinbo MR. 2019. Targeting Regorafenib-Induced Toxicity through Inhibition of Gut Microbial β-Glucuronidases. ACS Chem Biol 14:2737–2744. doi:10.1021/acschembio.9b00663 Misal SA, Gawai KR. 2018. Azoreductase: a key player of xenobiotic metabolism. Bioresources and Bioprocessing 5:17. doi:10.1186/s40643-018-0206-8</p><p>Pollet RM, D’Agostino EH, Walton WG, Xu Y, Little MS, Biernat KA, Pellock SJ, Patterson LM, Creekmore BC, Isenberg HN, Bahethi RR, Bhatt AP, Liu J, Gharaibeh RZ, Redinbo MR. 2017. An Atlas of β-Glucuronidases in the Human Intestinal Microbiome. Structure 25:967–977.e5. doi:10.1016/j.str.2017.05.003</p><p>Ryan A. 2017. Azoreductases in drug metabolism. Br J Pharmacol 174:2161–2173. doi:10.1111/bph.13571</p><p>Ryan A, Kaplan E, Nebel J-C, Polycarpou E, Crescente V, Lowe E, Preston GM, Sim E. 2014. Identification of NAD(P)H quinone oxidoreductase activity in azoreductases from <italic>P. aeruginosa</italic>: azoreductases and NAD(P)H quinone oxidoreductases belong to the same FMN-dependent superfamily of enzymes. PLoS One 9:e98551. doi:10.1371/journal.pone.0098551</p><p>Zou L, Spanogiannopoulos P, Pieper LM, Chien H-C, Cai W, Khuri N, Pottel J, Vora B, Ni Z, Tsakalozou E, Zhang W, Shoichet BK, Giacomini KM, Turnbaugh PJ. 2020. Bacterial metabolism rescues the inhibition of intestinal drug absorption by food and drug additives. Proc Natl Acad Sci U S A 117:16009–16018. doi:10.1073/pnas.1920483117</p><p>Altman T, Travers M, Kothari A, Caspi R, Karp PD. 2013. A systematic comparison of the MetaCyc and KEGG pathway databases. <italic>BMC Bioinformatics</italic> 14:112. doi:10.1186/1471-2105-14-112</p><p>Caspi R, Billington R, Keseler IM, Kothari A, Krummenacker M, Midford PE, Ong WK, Paley S, Subhraveti P, Karp PD. 2020. The MetaCyc database of metabolic pathways and enzymes – a 2019 update. <italic>Nucleic Acids Res</italic> 48:D445–D453. doi:10.1093/nar/gkz862</p><p>Pouliot Y, Karp PD. 2007. A survey of orphan enzyme activities. <italic>BMC Bioinformatics</italic> 8:244. doi:10.1186/1471-2105-8-244</p><p>Zimmermann M, Zimmermann-Kogadeeva M, Wegmann R, Goodman AL. 2019. Mapping human microbiome drug metabolism by gut bacteria and their genes. <italic>Nature</italic>. doi:10.1038/s41586-019-1291-3</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below.</p><p>Reviewer #3 (Recommendations for the authors):</p><p>I am satisfied that the authors have carried out key validations of the SIMMER tool, including experimental characterization of a SIMMER prediction, the metabolism of methotrexate by hydrolases.</p><p>I ask that the authors credit prior research demonstrating that methotrexate is metabolized by hydrolases (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5082436/). They extend prior work on methotrexate here by showing strain-level characterization of MTX metabolism, a valuable addition to our understanding of drug metabolism by gut microbes.</p></disp-quote><p>Thank you for this suggestion. We have now added this and another relevant citation to lines 458-461 of the current manuscript:</p><p>“When queried with MTX and its gut bacteria associated metabolites DAMPA and glutamate, SIMMER calculated a most similar MetaCyc reaction (3.4.17.11-RXN) and a significant EC prediction (3.4.17.11, p-value&lt;0.001). This MetaCyc reaction describes the hydrolysis of folate into pteroate and glutamate, driven by a glutamate carboxypeptidase (Cpg2) found in environmental <italic>Pseudomonas aeruginosa</italic>. Hydrolysis of MTX is chemically similar to hydrolysis of folate (Figure 7A) with a Tanimoto coefficient=0.6, and normalized euclidean distance=0.05 in SIMMER’s precomputed chemical space. SIMMER made 2,286 human gut microbiome enzyme predictions for degrading MTX into DAMPA and glutamate (Figure 7—source data). The most common Prokka annotation for these enzymes is Carboxypeptidase G2s (Figure 7B) due to their sequence similarity to MetaCyc’s environmental Cpg2. Furthermore, SIMMER’s predicted enzymes had a median global identity of 33% to <italic>Pseudomonas sp</italic> RS<sup>-1</sup>6 (an environmental bacterium) Cpg2, an enzyme known to conduct hydrolysis of MTX (Larimer et al., 2014; Jeyaharan et al., 2016).”</p></body></sub-article></article>