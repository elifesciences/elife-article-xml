<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">53985</article-id><article-id pub-id-type="doi">10.7554/eLife.53985</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>The head direction circuit of two insect species</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-166299"><name><surname>Pisokas</surname><given-names>Ioannis</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7426-3207</contrib-id><email>i.pisokas@sms.ed.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-110541"><name><surname>Heinze</surname><given-names>Stanley</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8145-3348</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-53232"><name><surname>Webb</surname><given-names>Barbara</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>School of Informatics, University of Edinburgh</institution><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution>Lund Vision Group and NanoLund, Lund University</institution><addr-line><named-content content-type="city">Lund</named-content></addr-line><country>Sweden</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>O'Leary</surname><given-names>Timothy</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>06</day><month>07</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e53985</elocation-id><history><date date-type="received" iso-8601-date="2019-11-26"><day>26</day><month>11</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-07-06"><day>06</day><month>07</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Pisokas et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Pisokas et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-53985-v2.pdf"/><abstract><p>Recent studies of the Central Complex in the brain of the fruit fly have identified neurons with activity that tracks the animal’s heading direction. These neurons are part of a neuronal circuit with dynamics resembling those of a ring attractor. The homologous circuit in other insects has similar topographic structure but with significant structural and connectivity differences. We model the connectivity patterns of two insect species to investigate the effect of these differences on the dynamics of the circuit. We illustrate that the circuit found in locusts can also operate as a ring attractor but differences in the inhibition pattern enable the fruit fly circuit to respond faster to heading changes while additional recurrent connections render the locust circuit more tolerant to noise. Our findings demonstrate that subtle differences in neuronal projection patterns can have a significant effect on circuit performance and illustrate the need for a comparative approach in neuroscience.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>head direction</kwd><kwd>ring attractor</kwd><kwd><italic>Schistocerca gregaria</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100010663</institution-id><institution>H2020 European Research Council</institution></institution-wrap></funding-source><award-id>Grant agreement no. 714599</award-id><principal-award-recipient><name><surname>Heinze</surname><given-names>Stanley</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000848</institution-id><institution>University Of Edinburgh</institution></institution-wrap></funding-source><award-id>Graduate Student Fellowship</award-id><principal-award-recipient><name><surname>Pisokas</surname><given-names>Ioannis</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Two evolutionary distant insect species share a common head direction circuit with subtle differences in neuronal morphologies that result in distinct circuit dynamics adapted to each species’ ecology.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>For a variety of behaviours that relocate an insect in its environment, it is important for the animal to be able to keep track of its heading relative to salient external objects. This external reference object could be a nearby target, a distant landmark or even a celestial beacon. In insects, the discovery of a neuronal circuit with activity that tracks heading direction provides a potential basis for an internal compass mechanism (<xref ref-type="bibr" rid="bib70">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib30">Homberg, 2004</xref>; <xref ref-type="bibr" rid="bib29">Heinze and Reppert, 2012</xref>). Such an internal compass can mediate a simple navigation competence such as maintaining a straight course (<xref ref-type="bibr" rid="bib8">Dacke et al., 2003</xref>; <xref ref-type="bibr" rid="bib37">Mouritsen and Frost, 2002</xref>) or reorienting to a target after distractions (<xref ref-type="bibr" rid="bib40">Neuser et al., 2008</xref>), but is also essential for the more complex navigational process of path integration (or dead reckoning) which enables central-place foragers to return directly to their nest after long and convoluted outward paths (<xref ref-type="bibr" rid="bib9">Darwin, 1873</xref>; <xref ref-type="bibr" rid="bib65">von Frisch, 1967</xref>; <xref ref-type="bibr" rid="bib36">Mittelstaedt and Mittelstaedt, 1980</xref>; <xref ref-type="bibr" rid="bib38">Müller and Wehner, 1988</xref>). While the neural basis underlying these navigation strategies is not known in detail, a brain region called the central complex (CX) is implicated in many navigation-related processes.</p><p>The CX of the insect brain is an unpaired, midline-spanning set of neuropils that consist of the protocerebral bridge (PB), the ellipsoid body (also called lower division of the central body), the fan-shaped body (also called upper division of the central body) and the paired noduli. These neuropils and their characteristic internal organisation in vertical slices combined with horizontal layers are highly conserved across insect species. This regular neuroarchitecture is generated by sets of columnar cells, innervating individual slices, as well as large tangential neurons, innervating entire layers. The structured projection patterns of columnar cells result in the PB being organised in 16 or 18 contiguous glomeruli and the ellipsoid body (EB) in eight adjoined tiles.</p><p>Crucially, the CX is of key importance for the computations required to derive a heading signal (<xref ref-type="bibr" rid="bib44">Pfeiffer and Homberg, 2014</xref>; <xref ref-type="bibr" rid="bib60">Triphan et al., 2010</xref>; <xref ref-type="bibr" rid="bib40">Neuser et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">Ofstad et al., 2011</xref>; <xref ref-type="bibr" rid="bib30">Homberg, 2004</xref>; <xref ref-type="bibr" rid="bib31">Homberg et al., 2011</xref>). In locusts (<italic>Schistocerca gregaria</italic>), intracellular recordings have revealed a neuronal layout that topographically maps the animal’s orientation relative to simulated skylight cues, including polarised light and point sources of light (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib12">el Jundi et al., 2014</xref>; <xref ref-type="bibr" rid="bib43">Pegel et al., 2019</xref>). Calcium imaging of columnar neurons connecting the EB and the PB (E-PG neurons) in the fruit fly <italic>Drosophila melanogaster</italic> revealed that the E-PG neuronal ensemble maintains localised spiking activity — commonly called an activity ‘bump’ — that moves from one group of neurons to the next as the animal rotates with respect to its surrounding (<xref ref-type="bibr" rid="bib48">Seelig and Jayaraman, 2015</xref>; <xref ref-type="bibr" rid="bib17">Giraldo et al., 2018</xref>). This has been confirmed for restrained flies walking on an air-supported rotating ball (<xref ref-type="bibr" rid="bib48">Seelig and Jayaraman, 2015</xref>) as well as tethered flies flying in a virtual reality environment (<xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref>). Notably, the heading signal (the activity ‘bump’) is maintained even when the visual stimulus is removed, and it moves relative to the (no longer visible) cue as the animal walks in darkness (<xref ref-type="bibr" rid="bib48">Seelig and Jayaraman, 2015</xref>). The underlying circuit therefore combines idiothetic and allothetic information into a coherent heading signal. Overall, this neuronal activity appears to constitute an internal encoding of heading in the insect’s CX, which closely resembles the hypothetical ring attractor (<xref ref-type="bibr" rid="bib2">Amari, 1977</xref>) proposed by <xref ref-type="bibr" rid="bib51">Skaggs et al., 1995</xref> to account for the rat ‘head direction’ cells (<xref ref-type="bibr" rid="bib58">Taube et al., 1990</xref>; <xref ref-type="bibr" rid="bib4">Blair and Sharp, 1995</xref>; <xref ref-type="bibr" rid="bib46">Redish et al., 1996</xref>; <xref ref-type="bibr" rid="bib52">Stackman and Taube, 1998</xref>; <xref ref-type="bibr" rid="bib18">Goodridge et al., 1998</xref>; <xref ref-type="bibr" rid="bib19">Goodridge and Touretzky, 2000</xref>; <xref ref-type="bibr" rid="bib49">Sharp et al., 2001</xref>; <xref ref-type="bibr" rid="bib59">Taube and Bassett, 2003</xref>; <xref ref-type="bibr" rid="bib55">Stratton et al., 2010</xref>). That is, the activity has the following key properties associated with ring attractors: input to the circuit results in a single localised ‘bump’ of activity — centred in one subset of the neurons — while other neuronal units are silenced; the activity ‘bump’ can move around the attractor space, which forms a ring, in a manner that consistently tracks some property of the input; and the ‘bump’ of activity is maintained for some time after all input is removed. These properties can be obtained, in computational neural models, by utilising opposing excitatory and inhibitory connections with excitatory lateral connections to neighbouring neuronal units and inhibitory ones affecting neurons on the opposite side of the ring.</p><p>In recent years, several computational models of the fly’s CX heading tracking circuit have been presented. Some of these models are abstract while others attempt to ascribe particular roles to neurons (<xref ref-type="bibr" rid="bib7">Cope et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>; <xref ref-type="bibr" rid="bib56">Su et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref>). <xref ref-type="bibr" rid="bib7">Cope et al., 2017</xref> proposed a ring attractor model that is inspired by the rat ‘head direction’ cell model of <xref ref-type="bibr" rid="bib51">Skaggs et al., 1995</xref>. <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> presented a spiking neuronal model consisting of the four types of CX neurons shown to play a role in heading encoding: E-PG, P-EN, P-EG, and Delta7 neurons. Their model demonstrated that this neuron set is sufficient for exhibiting ring attractor behaviour. In contrast, <xref ref-type="bibr" rid="bib56">Su et al., 2017</xref> implemented a spiking neuronal model consisting of the E-PG, P-EN, and P-EG neurons with inhibition provided by a group of R ring neurons. In both neurobiological studies and computational models, the key neurons variously involved in the hypothetical ring attractor circuit are the E-PG, P-EN, P-EG, Delta7 and R ring neurons (<xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>; <xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>; <xref ref-type="bibr" rid="bib56">Su et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Green et al., 2017</xref>; <xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref>). The E-PG, P-EN and P-EG neurons have been postulated to be excitatory while Delta7 or R ring neurons are conjectured to be mediating the inhibition (<xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>; <xref ref-type="bibr" rid="bib56">Su et al., 2017</xref>). The E-PG and P-EN neurons are postulated to form synapses in the PB and in the EB forming a recurrent circuit. The ring attractor state is set by a mapping of the azimuthal position of visual cues to E-PG neurons around the ring which are assumed to receive the positional input to this circuit. Furthermore, P-EN neurons shift the heading signal around the ring attractor when stimulated, in a fashion similar to the left-right rotation neurons proposed by <xref ref-type="bibr" rid="bib51">Skaggs et al., 1995</xref> (<xref ref-type="bibr" rid="bib61">Turner-Evans et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Green et al., 2017</xref>). In principle, two main types of ring attractor implementation exist: one with local excitation and global, uniform, inhibition and another one characterised by sinusoidally modulated inhibition across the ring attractor. <xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref> have experimentally explored the type of ring attractor that could underlie the head direction circuit of the fruit fly and concluded that the observed dynamics of E-PG neurons can best be modelled using a ring attractor with local excitation and uniform global inhibition.</p><p>The above-outlined overall circuit depends critically on the detailed anatomical connections between cell types of the CX, so that the implementation of a specific type of ring attractor imposes additional constraints on the neuronal connection patterns and individual morphologies. Although the CX is highly conserved on a broad level, details at the level of single neurons vary between insect species. Yet, conclusions about the function of the circuit are usually drawn from <italic>Drosophila</italic> data and applied to insects in general. Given numerous differences in the CX neuroarchitecture between insects, we asked whether a ring attractor circuit is also plausible when taking into account anatomical data from another model species, the desert locust.</p><p>Three main differences are evident when comparing the CX of the fruit fly and the locust (<xref ref-type="fig" rid="fig1">Figure 1</xref>). First, as in most insects except <italic>Drosophila</italic>, the EB of the locust is not closed around the edges, but is crescent-shaped, preventing the E-PG neurons from forming a physical ring. Second, the <italic>Drosophila</italic> PB consists of nine glomeruli per hemisphere, and accordingly 18 groups of E-PG neurons. In locusts, there are 8 glomeruli per hemisphere and 16 groups of neurons. Third, a key part of the proposed ring attractor circuit, the Delta7 neurons (TB1 neurons in the locust) differ strikingly in their arborization pattern across the width of the PB. Whereas these cells possess two columnar output sites located eight glomeruli apart in all species, their dendrites have an approximately uniform density across the PB glomeruli in <italic>Drosophila</italic>. This differs substantially from the dendritic distribution in the desert locust, in which the postsynaptic domains of the eight Delta7 neurons are restricted to particular glomeruli of the PB, avoiding the regions around the output branches. This pattern is conserved in other species as well, such as in the Monarch butterfly (<italic>Danaus plexippus</italic>), the sweat bee (<italic>Megalopta genalis</italic>), as well as in two species of dung beetles (<italic>Scarabaeus lamarcki</italic> and <italic>Scarabaeus satyrus</italic>) (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib25">Heinze et al., 2013</xref>; <xref ref-type="bibr" rid="bib54">Stone et al., 2017</xref>; <xref ref-type="bibr" rid="bib13">El Jundi et al., 2018</xref>). Given these three differences of the <italic>Drosophila</italic> CX from other insects, we explored the functional consequences of each difference and how these might relate to the behavioural characteristics of each insect.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Anatomical differences between two species.</title><p>There are three apparent differences between the CX of the fruit fly (<italic>Drosophila melanogaster</italic>) and the desert locust (<italic>Schistocerca gregaria</italic>). (<bold>A</bold>, <bold>B</bold>) The ellipsoid body in the fruit fly has a toroidal shape while in the locust is crescent-shaped so its two ends are separate. (<bold>C</bold>, <bold>D</bold>) The protocerebral bridge consists of 18 glomeruli and 18 corresponding E-PG and P-EG neurons in the fruit fly (see <xref ref-type="table" rid="table3">Table 3</xref>) while in the locust there are 16 glomeruli and neurons innervating them. (<bold>E</bold>, <bold>F</bold>) The Delta7 neurons in the fruit fly have postsynaptic domains along the whole length of their neurite while in the desert locust only in specific sections with gaps in between.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig1-v2.tif"/><permissions><copyright-statement>© 2018 Wiley Periodicals, Inc</copyright-statement><copyright-year>2018</copyright-year><copyright-holder>Wiley Periodicals, Inc</copyright-holder><license><license-p>Panel A, C and E are reproduced and adapted from <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref> with permission from Wiley Periodicals, Inc. They are not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</license-p></license></permissions><permissions><copyright-statement>© 2009 Insect Brain Database</copyright-statement><copyright-year>2009</copyright-year><copyright-holder>Insect Brain Database</copyright-holder><license><license-p>Panel B is an original image only available for non-commercial use from <xref ref-type="bibr" rid="bib11">El Jundi et al., 2009</xref> with permission from Insect Brain Database, <ext-link ext-link-type="uri" xlink:href="https://insectbraindb.org">https://insectbraindb.org</ext-link>. They are not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</license-p></license></permissions><permissions><copyright-statement>© 1998 Wiley-Liss, Inc</copyright-statement><copyright-year>1998</copyright-year><copyright-holder>Wiley-Liss, Inc</copyright-holder><license><license-p>Panel D is reproduced from <xref ref-type="bibr" rid="bib64">Vitzthum and Homberg, 1998</xref> with permission from Wiley-Liss, Inc. They are not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</license-p></license></permissions><permissions><copyright-statement>© 2015 Wiley Periodicals, Inc</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Wiley Periodicals, Inc</copyright-holder><license><license-p>Panel F is reproduced from Figure 1J of <xref ref-type="bibr" rid="bib3">Beetz et al., 2015</xref> with permission from Wiley Periodicals, Inc. They are not covered by the CC-BY 4.0 licence and further reproduction of this panel would need permission from the copyright holder.</license-p></license></permissions></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Connectivity matrices of the two species.</title><p>Connectivity matrices of the two species. The connectivity matrices derived by the exact neuronal projections of (<bold>A</bold>) the fruit fly (<italic>Drosophila melanogaster</italic>) and (<bold>B</bold>) the desert locust (<italic>Schistocerca gregaria</italic>), respectively. The difference in the distribution of Delta7 neuron synaptic domains is evident at the lower right part of the images. Synaptic strength is denoted by colour in units of postsynaptic current equivalents as described in section Materials and methods.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig1-figsupp1-v2.tif"/></fig></fig-group><p>To explore this question, we used the anatomical projection patterns of the main CX neuron types in flies and locusts and derived the effective neuronal circuits by simplifying anatomical redundancy. Both resulting circuits indeed have the structural topology of a ring attractor. Despite significant anatomical differences the homologous circuits in the fruit fly and the locust are structurally similar but not identical. Their differences have significant functional effect in the ability of the two circuits to track fast rotational movements and to maintain a stable heading signal. Our results highlight that even seemingly small differences in the distribution of dendritic fibres can affect the behavioural repertoire of an animal. These differences, emerging from morphologically distinct single neurons, highlight the importance of a comparative approach to neuroscience. Rather than assuming results from model species are generalisable, we gain deeper insight into function by discovering which elements are actually shared across species and what are the consequences of observed variation.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The effective circuit</title><p>The neuronal projection data of the fruit fly and the desert locust were encoded in connectivity matrices and used for the simulations we report here (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>; <xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>; <xref ref-type="bibr" rid="bib28">Heinze and Homberg, 2009</xref>; <xref ref-type="bibr" rid="bib24">Heinze et al., 2009</xref>). While some simplifications could not be avoided, we have exclusively used projection patterns grounded in anatomical data for each species to construct the connectivity matrices. To facilitate conceptual understanding, we visualised the connectivity matrices as directed graphs and analysed the effective connectivity of the neuronal components of the CX for both species.</p><sec id="s2-1-1"><title>Inhibitory circuit</title><p>First, we focus on the inhibitory portion of the circuit. Study of the actual neuronal anatomy of Delta7 neurons in the PB shows that, in both species, each Delta7 neuron has presynaptic terminal domains in two or three glomeruli along the PB (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). These presynaptic terminal domains are separated by seven glomeruli (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2">Figure 2D</xref>). In <italic>Drosophila</italic>, the Delta7 neurons have postsynaptic terminals across all remaining glomeruli of the PB (<xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>; <xref ref-type="bibr" rid="bib14">Franconville et al., 2018</xref>) while in locusts the Delta7 neurons have postsynaptic terminal domains only in specific glomeruli (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib3">Beetz et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Hadeln et al., 2020</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Effective connectivity of the inhibitory (Delta7) neurons.</title><p>On the top row is the fruit fly circuit, on the bottom row is the locust circuit. In A and D, four examples of how the eight types of Delta7 neurons innervate the PB are illustrated. In both species, presynaptic domains are separated by seven glomeruli. (<bold>B</bold> and <bold>E</bold>) Effective connectivity. Each horizontal blue line represents one Delta7 neuron. Vertical lines represent axons, with triangles indicating outputs from Delta7 neurons and filled circles representing inhibitory synapses between axons and other Delta7 neurons. (<bold>C</bold> and <bold>F</bold>) Alternative depiction of the circuit in graph form with blue circles representing Delta7 neurons and lines representing inhibitory synapses between pairs of neurons. Each Delta7 neuron inhibits all other Delta7s in the fruit fly (<bold>C</bold>), but only more distant Delta7s in the locust (<bold>F</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig2-v2.tif"/></fig><p>There are eight types of Delta7 neurons in the PB, each having the same pattern of synaptic terminals shifted by one glomerulus (<xref ref-type="fig" rid="fig2">Figure 2A</xref> and <xref ref-type="fig" rid="fig2">Figure 2D</xref>). Within each glomerulus, the Delta7 neuron with presynaptic terminals is assumed to form synapses with all other Delta7 neurons that have postsynaptic terminals in the same glomerulus. Since each Delta7 neuron is presynaptic to the same Delta7 neurons in two or three glomeruli along the PB, we reduce these two or three synaptic domains to one single equivalent synapse between each pair of Delta7 neurons in order to draw a simplified equivalent circuit (<xref ref-type="fig" rid="fig2">Figure 2B</xref> and <xref ref-type="fig" rid="fig2">Figure 2E</xref>). In order to highlight the main functional differences, we redrew these neuronal circuits in a network graph form which revealed an eight-fold radial symmetry in both species, regardless of the different neuronal anatomies and the anatomical presence of nine PB glomeruli in flies.</p><p>The network graph form of the circuit further makes evident a global, uniform, inhibition pattern in the case of the fruit fly versus a local inhibition pattern in the case of the locust (<xref ref-type="fig" rid="fig2">Figure 2C</xref> and <xref ref-type="fig" rid="fig2">Figure 2F</xref>). That is, in fruit flies each Delta7 neuron forms synapses and inhibits all other Delta7 neurons. In contrast, in the locust each Delta7 neuron only inhibits a subset of Delta7 neurons with weakening synaptic strengths towards its nearest neighbours (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>). The effective global inhibition pattern found in the fruit fly fits the observation of <xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref> that calcium dynamics better matched a ring attractor with global inhibition in this species.</p></sec><sec id="s2-1-2"><title>Excitatory circuit</title><p>We next focused on the excitatory portion of the hypothetical ring attractor circuit. For deriving the effective circuit of the excitatory portion of the network, it was necessary to employ an unconventional numbering scheme for the PB glomeruli; that is, in both hemispheres, glomeruli are numbered incrementally from left to right, 1–9 for the fruit fly (<xref ref-type="fig" rid="fig3">Figure 3</xref>) and 1–8 for the locust (<xref ref-type="fig" rid="fig4">Figure 4</xref>). EB tiles were numbered 1 to 8 for both species. For brevity, throughout this text, we denote a tile numbered ‘1’ as T1 and a glomerulus numbered ‘1’ as G1. Neurons are numbered by the glomerulus they innervate, using a numerical subscript, e.g. P-EN<sub>1</sub> for the P-EN neurons innervating glomeruli G1.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Projection patterns of the excitatory portion of the fruit fly circuit.</title><p>(<bold>Ai–Fi</bold>) Examples of E-PG (combined E-PG and E-PG<sub><italic>T</italic></sub>, see <xref ref-type="table" rid="table3">Table 3</xref>), P-EN and P-EG neurons with their synaptic domains and projection patterns. (<bold>Aii–Cii</bold>) Step by step derivation of the effective circuit as a directed graph network (see main text for a complete description). Each coloured disc represents a group of neurons with arrows representing excitatory synaptic connections. Pairs of E-PG and P-EG neurons can be considered to act as single units connecting the respective tile to equally numbered PB glomeruli in both hemispheres, while P-EN neurons are shown overlapped because each receives input only from its contralateral nodulus. (<bold>Dii–Eii</bold>) The connectivity also allows neurons innervating glomeruli 1 and 9 to act as a single unit. (<bold>F</bold>ii) Depiction of the complete effective connectivity of the excitatory circuit, which has an eight-fold radial symmetry.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Neuronal activity across PB glomeruli.</title><p>The neuronal activity of P-EN, P-EG and E-PG neurons innervating the glomeruli of the PB for the simulated model of the fruit fly. The activity ‘bump’ is centred around identically numbered glomeruli on the two hemispheres.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Neuronal projections in the fruit fly.</title><p>(<bold>A</bold>, <bold>B</bold>) Examples of the projection patterns of E-PG neurons (combined E-PG and E-PG<sub><italic>T</italic></sub>, see <xref ref-type="table" rid="table3">Table 3</xref>). (<bold>C</bold>, <bold>D</bold>) Examples of P-EN neurons with their synaptic domains and projection patterns (see main text for detailed description).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig3-figsupp2-v2.tif"/></fig><media id="fig3video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-53985-fig3-video1.mp4"><label>Figure 3—video 1.</label><caption><title>Animation illustrating the operation of the excitatory portion of the fruit fly circuit.</title></caption></media></fig-group><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Projection patterns of the excitatory portion of the locust circuit.</title><p>(<bold>Ai–Ei</bold>) Examples of E-PG, P-EN and P-EG neurons with their synaptic domains and projection patterns. (Aii–Eii) Step by step derivation of the effective circuit (see main text for a complete description). Each coloured disc represents a group of neurons with arrows representing excitatory synaptic connections. Pairs of E-PG and P-EG neurons can be considered to act as single units connecting the respective tile to equally numbered PB glomeruli in both hemispheres, while P-EN neurons are shown overlapped because each receives input only from its contralateral nodulus. Note that the numbering of the EB slices is conceptual and arbitrary, chosen to assist description of the circuit organisation; what matters for the connectivity is the overlap of the synaptic domains in the EB and not the particular numbering choice. (<bold>F</bold>i) The complete effective connectivity of the locust excitatory circuit closely resembles that of the fruit fly. (<bold>Fii</bold>) Between octants 1 and 8, the locust circuit obtains functional connectivity from P-EN<sub>8</sub> to ‘neighbouring’ E-PG<sub>1</sub> (red dashed arrow) via three actual connections: P-EN<sub>8</sub> to E-PG<sub>8</sub> to P-EN<sub>1</sub> to E-PG<sub>1</sub> (black arrows); and equivalently for P-EN<sub>1</sub> to E-PG<sub>8</sub>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Neuronal activity across PB glomeruli.</title><p>The neuronal activity of P-EN, P-EG and E-PG neurons innervating the glomeruli of the PB for the simulated model of the locust. The activity ‘bump’ is centred around identically numbered glomeruli on the two hemispheres.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Neuronal projections in the locust.</title><p>Examples of the projection patterns of E-PG (<bold>A, B</bold>) and P-EN (<bold>C, D</bold>) neurons in the locust. The anatomy and projection patterns differ from those in the fruit fly (see main text for detailed description).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig4-figsupp2-v2.tif"/></fig><media id="fig4video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-53985-fig4-video1.mp4"><label>Figure 4—video 1.</label><caption><title>Animation illustrating the operation of the excitatory portion of the locust circuit.</title></caption></media></fig-group><p>In accordance with calcium imaging (<xref ref-type="bibr" rid="bib61">Turner-Evans et al., 2017</xref>; <xref ref-type="bibr" rid="bib21">Green et al., 2017</xref>), simulating the fruit fly and locust circuits confirmed that there are two activity ‘bumps’ along the PB. The choice of unconventional numbering scheme for the PB glomeruli has as an effect that both activity ‘bumps’ are centred around neurons innervating identically numbered glomeruli (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). We use this symmetry to simplify the circuit and derive the effective connectivity.</p><p>First, we analyse and derive the effective circuit of the fruit fly. Under our numbering scheme, each E-PG neuron has synaptic domains in identically numbered EB tiles and PB glomeruli (e.g. <xref ref-type="fig" rid="fig3">Figure 3Ai</xref>). That is, E-PG<sub>5</sub> neurons have synaptic domains in tile T5 and glomeruli G5 in both hemispheres of the PB. Since activity is symmetrical in both PB hemispheres, the pair of E-PG<sub>5</sub> neurons forms a single functional unit, as illustrated in the equivalent circuit (<xref ref-type="fig" rid="fig3">Figure 3Aii</xref>), with single synaptic connections shown to the corresponding P-EN<sub>5</sub> and P-EG<sub>5</sub> neurons. P-EN neurons, however, connect corresponding glomeruli from each PB hemisphere to two tiles, one shifted to the left and one to the right, for example, P-EN<sub>5</sub> would connect glomeruli G5 to tiles T4 and T6 (<xref ref-type="fig" rid="fig3">Figure 3Bi</xref>). P-EN neurons are indicated as two overlapped discs in the equivalent circuit (<xref ref-type="fig" rid="fig3">Figure 3Bii</xref>) because even though each pair receives common input in the glomeruli they also receive differential angular velocity input, depending on the hemisphere they innervate. The pair of P-EN<sub>5</sub> neurons forms synapses with E-PG<sub>4</sub> neurons in T4 and E-PG<sub>6</sub> neurons in T6, respectively. A third class of cells, P-EG neurons, innervate equally numbered glomeruli and tiles, following the same pattern as the E-PG neurons but with their presynaptic and postsynaptic terminals on opposite ends (<xref ref-type="fig" rid="fig3">Figure 3Ci</xref>), and are thus illustrated as single functional units in the equivalent circuit (<xref ref-type="fig" rid="fig3">Figure 3Cii</xref>). Following the synaptic connections forward around the circuit (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), E-PG<sub>4</sub> and E-PG<sub>6</sub> neurons innervate glomeruli G4 and G6 respectively, forming synapses with P-EN and P-EG neurons in these glomeruli; P-EG<sub>6</sub> make reciprocal connections to E-PG<sub>6</sub>; and the paired P-EN<sub>6</sub> neurons make connections back to T5 and onward to T7, etc. Thus the connectivity pattern shown in <xref ref-type="fig" rid="fig3">Figure 3Cii</xref> is repeated all the way around the circuit. Crucially, tile T1 is innervated by both E-PG<sub>1</sub> and E-PG<sub>9</sub> which also innervate glomeruli G1 and G9, respectively (<xref ref-type="fig" rid="fig3">Figure 3Di</xref>). These neurons can also be treated as one unit, E-PG<sub>1&amp;9</sub>, in the effective circuit (<xref ref-type="fig" rid="fig3">Figure 3Dii</xref>) because they receive common synaptic input. Since there are no P-EN neurons innervating the innermost glomeruli (G9 in the left and G1 in the right hemisphere), P-EN<sub>1</sub> and P-EN<sub>9</sub> consist a pair of neurons in the equivalent circuit, making onward connections to tiles T2 and T8, and thus E-PG<sub>2</sub> and E-PG<sub>8</sub>, respectively (<xref ref-type="fig" rid="fig3">Figure 3Ei and Eii</xref>). Therefore, the effective circuit of the fruit fly has an eight-fold radial symmetry despite the nine PB glomeruli (illustrated in <xref ref-type="fig" rid="fig3">Figure 3Fii</xref>).</p><p>We follow a similar procedure to derive the effective circuit in the locust (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Here, E-PG neurons from the two corresponding PB glomeruli, one in each hemisphere, have synaptic domains in two neighbouring EB wedges (half tiles), for example E-PG<sub>5</sub> innervates two wedges in tiles T5 and T6 and glomeruli G5 of the PB (<xref ref-type="fig" rid="fig4">Figure 4Ai</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Note that in the equivalent circuit (<xref ref-type="fig" rid="fig4">Figure 4Aii</xref>) we label these neurons by the relevant glomeruli number ‘5’ and can still treat them as a single unit connecting (as for the fruit fly) to the P-EN<sub>5</sub> and P-EG<sub>5</sub>. P-EN neurons connect PB glomeruli to tiles shifted by one wedge to the left and right, for example glomeruli G5 with tiles T5 and T6 (<xref ref-type="fig" rid="fig4">Figure 4Bi</xref>). This is a shift of half tile while in the fruit fly we see a whole tile shift. As a consequence, P-EN<sub>5</sub> neurons effectively make reciprocal connections back to E-PG<sub>5</sub>, which does not occur in the fruit fly. However, similar to the fruit fly, the P-EN<sub>5</sub> neurons also make onward connections to E-PG<sub>6</sub> and E-PG<sub>4</sub> (note that following the same labelling system as above, the E-PG<sub>4</sub> innervates neighbouring wedges in T4 and T5) (<xref ref-type="fig" rid="fig4">Figure 4Bii</xref>). Finally, P-EG neurons follow a similar pattern to E-PG neurons (<xref ref-type="fig" rid="fig4">Figure 4Ci</xref>), innervating equally numbered glomeruli and two wedges in neighbouring tiles, e.g. P-EG<sub>5</sub> connects G5 to T5 and T6, which can be shown as a single unit making a reciprocal connection to E-PG neurons with the same number. Tracing this connectivity pattern forward as before, the connections are repeated around the circuit. The circuit forms a closed ring because the pair of E-PG neurons innervating the medial glomeruli (glomerulus G8 in the left and G1 in the right hemisphere) have arborizations that cross the borders of these two glomeruli (<xref ref-type="bibr" rid="bib28">Heinze and Homberg, 2009</xref>, <xref ref-type="fig" rid="fig1">Figure 1</xref>) hence forming synapses with both P-EN<sub>1</sub> and P-EN<sub>8</sub> neurons in the two medial glomeruli (<xref ref-type="fig" rid="fig4">Figure 4Di,Ei</xref>). This evolutionary adaptation results in a closed ring without the need for an extra pair of neurons connecting the two edges of the EB. The crossing of glomeruli borders is characteristically evident in these two medial glomeruli resulting in a modified connectivity pattern between octants 1 and 8 of the circuit (<xref ref-type="fig" rid="fig4">Figure 4Fi</xref>). Even though this pattern might at first appear to break the structural radial symmetry in effect it provides a functional continuity of left-right activity ‘bump’ shifting all around the ring as illustrated in <xref ref-type="fig" rid="fig4">Figure 4Fii</xref>. <xref ref-type="fig" rid="fig4">Figure 4Fii</xref> shows in detail the specific portion of <xref ref-type="fig" rid="fig4">Figure 4Fi</xref>, illustrating how the connectivity we found in the animal effectively functions equivalently to the other P-EN to E-PG connections around the ring. The dashed red arrows show the effective connections closing the ring.</p><p>In spite of the EB in the locust not being torus-shaped but rather having a crescent shape, the effective circuit still forms a closed ring with an eight-fold structure almost identical to that of the fruit fly (<xref ref-type="fig" rid="fig4">Figure 4Fi</xref>). This is a consequence of the combination of E-PG neurons selectively cross-innervating the two medial glomeruli and the P-EN neurons forming reciprocal connections back to the E-PG neurons in the same octant. Both of these features are missing in the fruit fly. We thus observe the existence of two different solutions to the same problem, in the fruit fly the torus-shaped EB anatomically facilitates closing the ring while in the locust, which has an EB with open ends, adaptations in the neuronal projection patterns result again in a closed ring.</p></sec><sec id="s2-1-3"><title>Overall circuit</title><p>The similarity between the effective circuits of the locust and the fruit fly is striking. Despite the fact that locusts have eight PB glomeruli while fruit flies have nine, both circuits form closed rings organised in eight octants with the functional role of each neuron class appearing to be identical. The E-PG neurons were presynaptic to both P-EG and P-EN neurons, with P-EG neurons forming recurrent synapses back to E-PG neurons. P-EN neurons were presynaptic to E-PG neurons with a shift of one octant to the left or right. Overall, two of the main anatomical differences between the two species (eight versus nine PB glomeruli and ring-shaped versus crescent-shaped EB) had no fundamental effect on the principal structure of the CX heading direction circuit.</p><p>During our analysis of the anatomical data in locusts and flies, we observed that the order of E-PG neuronal projections in the EB differs between the two species (<xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>; <xref ref-type="bibr" rid="bib66">Williams, 1975</xref>; <xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). Spanning the EB clockwise starting from tile 1, the fruit fly wedges connect first to the right PB hemisphere, then to the left and so on, while in the locust they connect first to the left, then to the right and so on. However, despite this seemingly major difference in projection patterns the effective circuit is preserved between the two species.</p><p>The excitatory portions of the circuits differed in that the locust P-EN neurons make synapses back to E-PG neurons in the same octant while in the fruit fly they do not (Compare <xref ref-type="fig" rid="fig3">Figure 3F</xref> with <xref ref-type="fig" rid="fig4">Figure 4F</xref>). This difference resulted from the P-EN synaptic domains being shifted by half-tile in the locust instead of the whole tile shift seen in the fruit fly (<xref ref-type="fig" rid="fig3">Figure 3B</xref> and <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Consequently, the middle portion of neighbouring P-EN synaptic domains overlap in the EB and feed back to E-PG neurons in the same octant of the ring. This specialisation of the locust together with the cross-innervation of the two medial glomeruli by E-PG neurons enable the closing of the ring in the locust.</p><p>When we combined the inhibitory and the excitatory sub-circuits into a complete model (<xref ref-type="fig" rid="fig5">Figure 5</xref>), the E-PG neurons became presynaptically connected to the Delta7 neurons, in line with (<xref ref-type="bibr" rid="bib14">Franconville et al., 2018</xref>; <xref ref-type="bibr" rid="bib62">Turner-Evans et al., 2019</xref>). Additionally, each Delta7 neuron inhibits the P-EN and P-EG neurons in the same octant, as well as all other Delta7 neurons (for the fruit fly) or a subset (for the locust), as described above. This difference results in two different types of ring attractor topology; one with global inhibition in the fruit fly and another with local inhibition in the locust.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Combined excitatory and inhibitory portion of the ring attractors.</title><p>Explanatory drawings of the connectivity of the inhibitory portion with the excitatory portion of the circuit for the fruit fly (<bold>A–C</bold>) and the locust (<bold>D–F</bold>). Each coloured disc represents one or more neurons with lines representing synaptic connections. (<bold>A</bold>) Conceptual depiction of effective global inhibition in the fruit fly. The connectivity of E-PG neurons is shown for two neurons only (<bold>B,C and E,F</bold>). In this conceptual effective connectivity drawing, E-PG neurons appear to be located on the one side of the ring making synapses around the ring. However, anatomically each E-PG neuron innervates one glomerulus where it makes all its synapses with postsynaptic Delta7 neurons that run along the PB.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig5-v2.tif"/></fig></sec></sec><sec id="s2-2"><title>Predicted synaptic strengths</title><p>We next focused on whether and how the two circuits could operate as ring attractors. To this end, we implemented computational models of the two circuits using neuronal projection patterns derived from the anatomical data and investigated what synaptic connectivity strengths would be required for the circuits to produce ring attractor dynamics. The results constitute a prediction for the synaptic efficacies we expect to be observed in insects when such measurements become available.</p><p>We used spiking Leaky Integrate and Fire neuron models following the same approach as <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> and we ran an optimisation algorithm to find regularities in the synaptic efficacy patterns that resulted in functional ring attractors (see section Materials and methods). A functional ring attractor should maintain a ‘bump’ of activity along the neurons of the ring, with characteristics defined in section Materials and methods. A k-means algorithm was used to identify the clusters around which solutions were found. These clusters were ordered by the number of instances found by repetitive runs of the optimiser. Although the absolute synaptic strengths are arbitrary, as they depend on unknown biophysical properties of the involved neurons, a pattern emerged in the relative synaptic strengths between the different synapses (<xref ref-type="fig" rid="fig6">Figure 6</xref>). The most frequent synaptic strengths patterns were comparably consistent for the fruit fly and the locust. In both species, among the excitatory synapses, the P-EN to E-PG and P-EG to E-PG synaptic strengths were the weakest, while the synaptic strengths from E-PG to P-EG and P-EN neurons were the strongest. The inhibitory synaptic strengths from Delta7 to P-EN and P-EG were stronger in the locust than in the fruit fly, which was consistent with the fly neurons receiving input from more Delta7 neurons.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Relative synaptic strengths.</title><p>Graphical depiction of the synaptic strengths between classes of neurons. (<bold>A,C</bold>) For the fruit fly ring attractor circuit. (<bold>B,D</bold>) For the desert locust ring attractor circuit. Synaptic strengths are denoted by colour in panels A and B. In panels C and D, synaptic strengths between neurons are indicated by arrow colour and thickness in scale. Note that in the locust the synaptic strengths shown for Delta7 neurons are the peak values of the Gaussian distributed strengths shown in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig6-v2.tif"/></fig></sec><sec id="s2-3"><title>Predicted neuronal activity</title><p>Whereas our simulations confirmed that both the fruit fly and the locust circuit can operate as ring attractors, there were clear differences in the spiking activity and dynamics of the two circuits (<xref ref-type="fig" rid="fig7">Figure 7</xref>). One major difference was that Delta7 neurons exhibited distinct firing patterns in the two species. In the locust, there was a strong heading-dependent modulation in the firing of Delta7 neurons, in line with the heading signal (activity ‘bump’) location. Those Delta7 neurons corresponding to the current heading signal location remained silent. In contrast, in the fruit fly the firing of action potentials was only minimally modulated across the Delta7 population (<xref ref-type="fig" rid="fig7">Figure 7A</xref> and <xref ref-type="table" rid="table1">Table 1</xref>). This difference reflected the utilisation of local inhibition in the case of the locust versus the global inhibition in the fruit fly. Electrophysiologists have indeed reported this pronounced firing rate variation in the locust (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib24">Heinze et al., 2009</xref>; <xref ref-type="bibr" rid="bib5">Bockhorst and Homberg, 2015</xref>; <xref ref-type="bibr" rid="bib42">Pegel et al., 2018</xref>). It will be interesting to see if the fruit fly neurons indeed show a lower modulation as predicted by our model.</p><fig-group><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Response to abrupt stimulus changes and tuning curves of neurons.</title><p>(<bold>A</bold> and <bold>B</bold>) The raster plots of the stimuli used to drive the ring attractor during the simulation are shown on top and the spiking rate activity of each neuron at the bottom. In the beginning of the simulation the stimulus spiking activity sets the ring attractor to an initial attractor state. A ‘darkness’ period of no stimulus follows. Then a second stimulus corresponding to a sudden change of heading by 120° is provided. In the lower parts of A and B, the spiking activity of each neuron, filtered along the time axis by a Gaussian low-pass filter with window of <inline-formula><mml:math id="inf1"><mml:mrow><mml:mn>120</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf2"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>24</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, is shown colour coded. The order of recorded neurons is the same as shown in the connectivity matrices (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). (<bold>A</bold>) Response of the fruit fly ring attractor to sudden change of heading. (<bold>B</bold>) Response of the locust ring attractor to sudden change of heading. Even though the activity ‘bump’ in the locust model tends to start transitioning sooner, the fruit fly model completes the transition faster. (<bold>C</bold> and <bold>D</bold>) Response of individual neuron types to different stimuli azimuths (n = 40 trials in each condition). The mean and standard deviation are indicated by the error bars at the sampled azimuth points. Peak activity has been shifted to 0°. (<bold>C</bold>) Tuning curves for the fruit fly and (<bold>D</bold>) tuning curves for the locust.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig7-v2.tif"/></fig><fig id="fig7s1" position="float" specific-use="child-fig"><label>Figure 7—figure supplement 1.</label><caption><title>Response of spiking and rate-based models to step change of heading.</title><p>The mean activity ‘bump’ heading and corresponding standard deviation for the fruit fly and the locust models across time when stimulated with a step change of heading by 180° (80 trials each). (<bold>A</bold>, <bold>B</bold>) using spiking neuron models; (<bold>C</bold>, <bold>D</bold>) using rate-based neuron models. The activity ‘bump’ moves gradually to the new heading azimuth in the locust models (<bold>B, D</bold>) while it moves instantaneously in the fruit fly models (<bold>A, C</bold>). Note that in A and C, the transition slope does not appear exactly vertical (instantaneous) because it is the mean of multiple trials with the transition for each trial occurring with a small time lag in respect to the others.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig7-figsupp1-v2.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Characteristics of the activity ‘bump’.</title><p>The Full Width at Half Maximum (FWHM), the peak impulse rate of the activity ‘bump’ formed across each family of neurons and the amplitude of the activity ‘bump’ measured as the range of firing rates are shown. Measurements were made 10 s after the stimulus was removed. Numbers are given as median and standard deviation. The activity of Delta7 neurons in <italic>Drosophila</italic> is approximately even, hence the corresponding FWHM measurement is not meaningful and marked as ‘N/A’.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Neuron class</th><th colspan="3"><italic>Drosophila</italic></th><th colspan="3">Locust</th></tr><tr><th/><th>FWHM</th><th>Peak</th><th>Amplitude</th><th>FWHM</th><th>Peak</th><th>Amplitude</th></tr></thead><tbody><tr><td/><td align="center">(°) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf1-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf2-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf3-v2.tif"/></td><td align="center">(°) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf4-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf5-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf6-v2.tif"/></td></tr><tr><td>E-PG</td><td>88.3 ± 0.3</td><td>161.0 ± 0.2</td><td>160.1 ± 0.3</td><td>68.3 ± 0.1</td><td>192.6 ± 0.1</td><td>192.0 ± 0.2</td></tr><tr><td>P-EN</td><td>80.4 ± 0.4</td><td>190.1 ± 0.2</td><td>190.1 ± 0.2</td><td>63.1 ± 0.3</td><td>153.5 ± 0.1</td><td>153.5 ± 0.1</td></tr><tr><td>P-EG</td><td>71.0 ± 0.2</td><td>190.1 ± 0.2</td><td>190.1 ± 0.2</td><td>63.1 ± 0.3</td><td>153.5 ± 0.1</td><td>153.5 ± 0.1</td></tr><tr><td>Delta7</td><td>N/A</td><td>274.7 ± 0.1</td><td>27.1 ± 0.2</td><td>101.1 ± 0.2</td><td>266.6 ± 0.2</td><td>266.6 ± 0.2</td></tr></tbody></table></table-wrap><p>When comparing the head-direction tuning widths between the two species, we noted that in locusts all cell types are consistently tuned more narrowly (ca. 20%, <xref ref-type="table" rid="table2">Table 2</xref>). Within both species, the activity ‘bump’ is wider for E-PG neurons than for the other excitatory neuron classes (<xref ref-type="table" rid="table1">Table 1</xref>), a difference that is more pronounced in the fruit fly. The tuning of the Delta7 neurons is the widest across cell types in both species (approx. 96° in the locust, <xref ref-type="table" rid="table2">Table 2</xref>). In the fruit fly, the activity is approximately even across all Delta7 neurons (ca. 10% modulation).</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Characteristics of the neuron tuning curves.</title><p>The Full Width at Half Maximum (FWHM), the peak impulse rate of each family of neurons and the activity amplitude measured as the range of firing rates are shown. Numbers are given as median and standard deviation. The activity of Delta7 neurons in <italic>Drosophila</italic> is approximately even, hence the corresponding FWHM measurement is not meaningful and marked as ‘N/A’.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Neuron class</th><th colspan="3"><italic>Drosophila</italic></th><th colspan="3">Locust</th></tr><tr><th/><th>FWHM</th><th>Peak</th><th>Amplitude</th><th>FWHM</th><th>Peak</th><th>Amplitude</th></tr></thead><tbody><tr><td/><td align="center">(°) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf7-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf8-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf9-v2.tif"/></td><td align="center">(°) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf10-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf11-v2.tif"/></td><td align="center">(imp./s) <break/><inline-graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-inf12-v2.tif"/></td></tr><tr><td>E-PG</td><td>94.7 ± 4.0</td><td>208.4 ± 2.3</td><td>208.2 ± 2.2</td><td>73.4 ± 2.6</td><td>220.8 ± 1.4</td><td>220.8 ± 1.4</td></tr><tr><td>P-EN</td><td>74.6 ± 3.8</td><td>230.3 ± 2.3</td><td>230.3 ± 2.3</td><td>58.9 ± 3.1</td><td>163.6 ± 0.9</td><td>163.6 ± 0.9</td></tr><tr><td>P-EG</td><td>74.6 ± 3.8</td><td>230.3 ± 2.3</td><td>230.3 ± 2.3</td><td>58.9 ± 3.1</td><td>163.6 ± 0.9</td><td>163.6 ± 0.9</td></tr><tr><td>Delta7</td><td>N/A</td><td>289.9 ± 1.8</td><td>58.1 ± 4.2</td><td>96.0 ± 3.2</td><td>265.4 ± 2.9</td><td>265.4 ± 2.9</td></tr></tbody></table></table-wrap><p>In our models, we employed one neuron for each connection, whereas in the actual animals there are multiple copies of each neuron. While definite numbers of neurons will have to await electron microscopy data, there are likely at least two copies of E-PG, P-EG and P-EN neurons in each columnar module, and three to four copies of Delta7 cells (<xref ref-type="bibr" rid="bib66">Williams, 1975</xref>; <xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>; <xref ref-type="bibr" rid="bib3">Beetz et al., 2015</xref>; <xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). If we were to replace each modelled neuron by a bundle of neurons, the action potential firing rates shown in <xref ref-type="table" rid="table1">Table 1</xref> would be divided among the neurons in each bundle. The peak firing rate of each neuron would be in the range of 40–90 impulses/s which is similar to the range of the rates recorded electrophysiologically in the locust (<xref ref-type="bibr" rid="bib28">Heinze and Homberg, 2009</xref>). The objective function did not explicitly constrain the firing rates of the neurons but the synergy of biophysical parameters, circuit structure and performance requirements produced working circuits that operate in firing rates similar to those recorded electrophysiologically (see section Discussion).</p><p>The steady state peak spiking rate for each group of neurons differs between the fruit fly and the locust circuits. On average, the locust neurons showed ca. 25% higher peak firing rates compared to the fruit fly neurons while the Delta7 neurons have the highest spiking rate in both species. Electrophysiology studies will clarify if this is the case.</p><p>The tuning curves of the P-EN and P-EG neurons have the same statistics because in our models we assumed that all neurons have the same biophysical properties and since both these types of neurons receive the same inputs their responses are identical.</p></sec><sec id="s2-4"><title>Connectivity differences affect response dynamics</title><p>Despite the substantial similarity in functional structure of the two circuits, the subtle differences in connectivity affected the dynamics of the circuit behaviour. This became apparent when we compared the response of both circuits to sudden changes of heading (<xref ref-type="fig" rid="fig7">Figure 7</xref>). At a qualitative level, the fruit fly heading signal (the ‘bump’) could jump abruptly from one state to another, whereas the locust circuit exhibited a gradual transition. The results obtained with our spiking neuron models were corroborated by rate-based implementations of the models (<xref ref-type="fig" rid="fig7s1">Figure 7—figure supplement 1</xref>), confirming that the observed difference in response dynamics is not a consequence of neuron model choice but rather due to the differences in connectivity.</p><p>To explore whether this difference in movement dynamics of the heading signal could be a result of the different inhibition patterns produced by the Delta7 neurons, we replaced the global Delta7 connectivity pattern in the fruit fly model with the connectivity pattern of the locust Delta7 neurons, effectively swapping the fruit fly version of these cells with the locust version. Both the Delta7 to Delta7 and the E-PG to Delta7 connections were replaced with that of the locust. The data generated by this hybrid-species model revealed that changing the global inhibition to local inhibition was sufficient to produce the gradual ‘bump’ transition we observed in the locust circuit (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Transition time and rate of the heading signal.</title><p>(<bold>A</bold>) Time required from the onset of the stimulus until the heading signal settles to its new state. The abscissa (horizontal axis) displays the azimuthal difference between initial and target azimuth. (<bold>B</bold>) The maximum rate of angular change each model can attain computed as the ratio of shortest angular change of stimulus divided by transition duration. The values for different magnitudes of heading change are depicted as medians. The boxes indicate the 25th and 75th percentiles while the whiskers indicate the minimum and maximum value in the data after removal of the outliers (black dots). ‘Hybrid-species’ is the combination of the fruit fly model with the locust inhibition pattern.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig8-v2.tif"/></fig><sec id="s2-4-1"><title>Quantification of the ring attractor responsiveness</title><p>Having shown that small changes in the morphology of the Delta7 cells affect the dynamics of the heading signal in a qualitative way, we next quantified the maximal rate of change each ring attractor circuit could attain. To this end, we measured the time it took for the heading signal to transition from one stable location to a new one, in response to different angular heading changes of the stimulus. This was carried out for all three models: the fruit fly model, the locust model, and the hybrid-species model. The fruit fly ring attractor circuit stabilised to the new heading in approximately half the time it takes for the locust circuit to stabilise, across different magnitudes of angular heading change (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). The hybrid-species circuit had a similar response time to the locust circuit. This confirmed that the pattern of inhibition in the network is the main contributor to the observed effect.</p><p>To calculate the maximal rate of angular change each circuit can possibly track we divided the angular heading change by the time required for the heading signal to transition. When moving gradually, the heading signal transitions along the shortest path around the ring attractor. Therefore, in the calculation of the angular change rate, the numerator was the shortest angular distance between the two azimuths, calculated as<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mn>180</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mn>360</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mn>180</mml:mn><mml:mrow><mml:mo>∘</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The resulting angular rate of change values revealed that the circuit found in the fruit fly is significantly faster than the locust circuit and the hybrid-species circuit with localised inhibition (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). The rate of change was maximal for angular displacement of 180°, because this is the maximum azimuth distance the bump has to travel, as for all other angular displacements there is a shorter path.</p></sec><sec id="s2-4-2"><title>Effects of varying the uniformity of inhibition</title><p>The above results strongly suggested that the different pattern of inhibition is instrumental to generating the different dynamics in the two circuits. Up to this point, we have examined two extreme cases of inhibitory synaptic patterns, that of the global, uniform, inhibition found in <italic>Drosophila</italic> and the localised inhibition found in the locust. However, in principle, there could be any degree of uniformity of the inhibition between these two extremes. So far, the locust inhibition has been modelled as a summation of two Gaussian functions that approximates the synaptic density across the PB glomeruli, as derived from estimates of dendritic density along the PB in dye-filled Delta7 neurons (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib3">Beetz et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Hadeln et al., 2020</xref>). In the fruit fly, the synaptic distribution of Delta7 neurons has been modelled as uniform across the PB glomeruli, although there might be subtle synaptic density variation along their length. To account for this possibility, we explored a range of synaptic terminal domains distributions. As no measurements of synaptic strengths exist for either animal, we asked what effect varying the synaptic terminal distribution would have on the ring attractor behaviour. We thus modelled the inhibitory synaptic strength across the PB using two Gaussian functions, with peaks separated by 7 or 8 glomeruli, and varied their width (standard deviation σ, see also section Materials and methods). This would not only give us the effect of different inhibitory synaptic domain widths but also predict the plausible range of widths that the actual animals must have in order to exhibit the observed dynamics.</p><p>Modelling these variations showed that the transition mode of the heading signal depended on both the extent of the inhibitory synaptic domain width and the angular heading change of the stimulus. This sets limits on the plausible standard deviation (σ) range that the synaptic strength distribution must obey in the actual animals (<xref ref-type="fig" rid="fig9">Figure 9</xref>). We observed that for both circuits there was a range of low σ values, corresponding to more localised inhibition, which produce gradual transitions (‘locust-like’). As σ was increased, the inhibitory pattern became more uniform or global, and both circuits transitioned to abrupt jumps (‘fly-like’). Based on density estimates of dendrites in the PB, we approximated the inhibitory synaptic distribution with a value of <inline-formula><mml:math id="inf3"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula> for the locust model, yielding a gradual activity transition regime across the whole range of angular changes. These results suggested that the pattern of inhibition is indeed key to the circuit dynamics in response to rapid heading changes.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>Transition regime as function of inhibitory uniformity.</title><p>Heading signal transition regime for (<bold>A</bold>) the fruit fly ring attractor circuit and (<bold>B</bold>) the desert locust ring attractor circuit. Blue denotes gradual transition of the heading signal, orange denotes abrupt transition (jump), and yellow marks trials that were producing both gradual and abrupt transitions (for definitions see section Materials and methods).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig9-v2.tif"/></fig><p>However, the morphology of the Delta7 neurons is not the only difference between the ring attractors in the two species, hence the recorded response patterns are not identical for the two species (<xref ref-type="fig" rid="fig9">Figure 9</xref>). There is also anatomical difference in the presence of the P-EN to E-PG feedback loops only in the locust and consequently the synaptic efficacies differ between the two models. We investigate the effect of this anatomical difference in the subsequent section.</p></sec></sec><sec id="s2-5"><title>Attractor states distribution</title><p>We next investigated the attractor basin of each model. The finite size of the two circuits renders them discrete approximations of ring attractors (<xref ref-type="bibr" rid="bib6">Brody et al., 2003</xref>). As a consequence, in the absence of input, the activity ‘bump’ will tend to settle to one of a discrete set of states (note this does not prevent a continuous encoding of heading while a heading stimulus is provided, which could be decoded by downstream neuronal circuits). We tested this by stimulating the E-PG neurons at varying azimuthal locations around the circuits, then removing the input stimulus and examining the position of the activity ‘bump’ after 3 s. Both the fruit fly and locust circuits had discrete attractor states where the heading signal eventually settled once the stimulus was removed. Typically, the heading signal moved to the nearest attractor state. When a stimulus was applied equidistantly between two attractor states then, once the stimulus was removed, the activity ‘bump’ moved to one of the two attractor states stochastically due to the presence of noise in the system (<xref ref-type="fig" rid="fig10">Figure 10</xref>). These attractor states were more stable and clearly delineated in the locust while in the fruit fly there was a wider distribution of ‘bump’ locations, indicating that the locust ring attractor is more robust to drift and noise (<xref ref-type="fig" rid="fig10">Figure 10</xref>).</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Distribution of activity ‘bump’ locations.</title><p>The distribution of azimuthal location of the heading signal 3 s after stimulus removal is plotted. On the abscissa (horizontal axis), the azimuth where the stimulus is applied is shown. On the ordinate (vertical axis), the mean location and standard deviation of the activity ‘bump’ azimuth, 3 s after the stimulus is removed, are shown. (<bold>A</bold>) for the fruit fly and (<bold>B</bold>) for the locust. Inset images depict the corresponding EB tiles in colour. Smaller standard deviation corresponds to the ‘bump’ settling more frequently to the same azimuth. This is the case when the stimulus is applied near an attractor state. Applying the stimulus equidistantly from two attractor states results in a movement of the ‘bump’ to either of them and hence the increased standard deviation. In the locust when stimulating the ring attractor at one of the attractor states the ‘bump’ tends to settle at it, indicated by the reduced standard deviation at these locations. In the fruit fly, the activity ‘bump’ is prone to noise and not as stable, thus the standard deviation is not as modulated. This means that the locust attractor states are more stable resulting to the smaller dispersion of ‘bump’ location.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig10-v2.tif"/></fig></sec><sec id="s2-6"><title>Stability characteristics of the ring attractors</title><sec id="s2-6-1"><title>The locust head direction circuit is more robust to noise</title><p>An important aspect of a ring attractor is its stability characteristics. The differences in the distribution of activity ‘bump’ locations reported in the previous section hinted that the locust ring attractor is more robust to noise. To quantify this property of the two ring attractors, we measured the effect of different levels of structural (synaptic) noise to the circuit stability. The ring attractor of the locust was significantly more tolerant to structural noise than the fruit fly circuit (<xref ref-type="fig" rid="fig11">Figure 11A</xref>).</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Effect of synaptic efficacy heterogeneity on ring attractor stability.</title><p>(<bold>A</bold>) Stability of the ring attractor heading signal for the fruit fly, locust and hybrid-species (fruit fly with localised inhibition) model as a function of heterogeneity in the synaptic efficacies across all synapse types (modelled as additive white Gaussian noise). (<bold>B, C</bold>) Stability of the ring attractor heading signal as a function of structural asymmetry introduced by deviating synaptic efficacies between P-EN and E-PG neurons when the circuit includes the P-EG neurons versus when they are removed. In all three plots, the percentage of trials that result in a stable activity ‘bump’ is shown. On the horizontal axis the absolute value of percentile synaptic strength change is shown. Number of trials n = 100 for each level of noise. With P-EG neurons both ring attractors are more tolerant to such structural asymmetries. The locust ring attractor is more robust to both types of structural noise.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig11-v2.tif"/></fig><p>However, these two ring attractors differ in several respects. To identify the reason for the reduced sensitivity of the locust model to synaptic noise we compared the locust with the hybrid-species model. These two models differ in that reciprocal connections between P-EN and E-PG neurons are present only in the locust model (<xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>). If these reciprocal connections are responsible for the increased robustness of the circuit, we would expect the locust model to be more robust to synaptic noise than the hybrid-species model. This is exactly what we found (<xref ref-type="fig" rid="fig11">Figure 11A</xref>), thus we inferred that these reciprocal connections, between P-EN and E-PG neurons, provide the increased robustness to the locust model. This circuit specialisation might have important repercussions to the behavioural repertoire of the species, enabling locusts to maintain their heading for longer stretches of time than fruit flies, an important competence for a migratory species such as the locust.</p></sec><sec id="s2-6-2"><title>P-EG neurons stabilise the head direction circuit</title><p>In our models, we included the P-EG neurons connecting the PB glomeruli with EB tiles. Unlike the P-ENs, these neurons have the same connectivity pattern as the E-PG neurons but with presynaptic and postsynaptic terminals on opposite ends. What is the effect of the P-EG neurons in the circuit? Effectively, the P-EG neurons form secondary positive feedback loops within each octant of the circuit that, we hypothesised, help the heading signal to be maintained stably in the current position, even when lacking external input. Therefore, we expected the circuit to function as a ring attractor without these connections, but to be more vulnerable to drift if the neuronal connection weights are not perfectly balanced. The recurrent P-EG to E-PG loops should counteract this tendency to drift.</p><p>We tested this hypothesis by measuring the effect of imposing imbalance in the connectivity strengths of P-EN to E-PG neurons between the two hemispheres. We did this for both the full fruit fly and locust circuits as well as two altered circuits with the P-EG neurons removed. The synaptic strengths for the four circuits were optimised separately, since completely removing the P-EG neurons without appropriate synaptic strength adjustment breaks the ring attractor. We measured the percentage of simulation runs that resulted in a stable heading signal being maintained for at least 3 s. The presence of the P-EG neurons substantially increased the robustness of both species models to the effects of synaptic strength imbalance in the P-EN to E-PG synapses, as a stable heading signal was observed over a far wider range of synaptic efficacy changes (<xref ref-type="fig" rid="fig11">Figure 11B&amp;C</xref>). The P-EG neurons therefore contribute significantly to the tolerance of the ring attractors to synaptic strength asymmetries.</p></sec><sec id="s2-6-3"><title>Effect of inhibition to stability</title><p>It is interesting to note that even though in the locust model the reciprocal connections between E-PG and P-EG neurons were weaker than in the fruit fly model, the presence of the extra reciprocal connections between P-EN and E-PG neurons in the locust resulted in a more stable ring attractor than that in the fruit fly, which possesses only one but stronger recurrency loop. Finally, the hybrid-species model was more robust than the fruit fly one (<xref ref-type="fig" rid="fig11">Figure 11A</xref>). The fruit fly and the hybrid-species models differed in the width of their inhibitory synaptic domains and in their synaptic strengths. Although their difference in robustness was smaller than the previously examined ones, we can see an effect of the inhibitory pattern on the stability of the circuit.</p></sec><sec id="s2-6-4"><title>Effect of neuronal heterogeneity</title><p>Until this point, we have assumed that all neurons have identical properties. We now relax this assumption by making the membrane properties of the neurons heterogeneous. We tested the effect of neuronal heterogeneity to the stability of the ring attractors. Overall, the stability of the ring attractors deteriorated with increased deviation from the nominal values of membrane properties (<xref ref-type="fig" rid="fig12">Figure 12</xref>), but the locust model was more robust to these membrane property variations. Importantly, the distinct heading signal transition regimes (gradual transition in the locust model versus jump in the fruit fly model) were preserved regardless of heterogeneous membrane properties across the neuronal population (<xref ref-type="fig" rid="fig12s1">Figure 12—figure supplement 1</xref>).</p><fig-group><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Effect of membrane parameter heterogeneity on ring attractor stability.</title><p>(<bold>A</bold>) Stability of the ring attractor heading signal for the fruit fly and the locust model when the membrane properties are heterogeneous across the neuronal population. (<bold>B, C</bold>) Stability of the ring attractor heading signal when the level of noise on conductance and capacitance is varied independently. In all three plots, the percentage of trials that result in a stable activity ‘bump’ as a function of heterogeneity in cell membrane properties is shown (number of trials n = 50 for each condition). The locust ring attractor is more robust to white Gaussian noise in both conductance and capacitance. In both cases, the activity ‘bump’ is more tolerant to conductance variation than capacitance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig12-v2.tif"/></fig><fig id="fig12s1" position="float" specific-use="child-fig"><label>Figure 12—figure supplement 1.</label><caption><title>Effect of cell membrane parameter heterogeneity to transition regime.</title><p>The difference in the heading signal transition is present at different amounts of heterogeneity in neuron membrane parameters. As neuronal parameters deviate from their nominal values, from top to bottom, the stability of the heading signal deteriorates. The noise added to each membrane property (conductance and capacitance) was chosen from a normally distributed pseudorandom generator with sigma values in the range from 0 to the nominal value of the parameter and the resulting values were clipped to 0 so they are never negative.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig12-figsupp1-v2.tif"/></fig></fig-group></sec></sec><sec id="s2-7"><title>Response to proprioceptive stimuli</title><p>Mechanistically, Turner-Evans et al. showed that the activity of P-EN neurons in one hemisphere of the brain increases when the animal turns contralaterally, both with and without visual input (<xref ref-type="bibr" rid="bib61">Turner-Evans et al., 2017</xref>). The increase in activity is related to the angular velocity the fly experiences (<xref ref-type="bibr" rid="bib61">Turner-Evans et al., 2017</xref>). Whereas the origin of the angular velocity information in darkness is not known, efference copies of motor commands or proprioceptive inputs are the most likely sources of information about the fly’s rotational velocity. To test whether our models reproduce this behaviour, we artificially stimulated the P-EN neurons in one hemisphere of the PB, mimicking an angular velocity signal caused by turning of the animal, and observed the effect on the heading signal (<xref ref-type="fig" rid="fig13">Figure 13</xref>).</p><fig id="fig13" position="float"><label>Figure 13.</label><caption><title>Response to uni-hemispheric stimulation.</title><p>Upper plots show the P-EN stimulation protocol and corresponding induced P-EN activity; lower plots show the response of the ring attractor for (<bold>A</bold>) the fruit fly circuit and (<bold>B</bold>) the locust circuit. The initial bilateral stimulation initialises a persistent activity ‘bump’, which moves around the circuit in response to stimulation of P-ENs in all the columns in one hemisphere only.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig13-v2.tif"/></fig><p>Both the locust and the fruit fly model reproduced the response dynamics reported by <xref ref-type="bibr" rid="bib61">Turner-Evans et al., 2017</xref>. Exploration of the response of the circuit to different stimulation strengths showed that the rate by which the heading signal shifts around the ring attractor increases exponentially with increase of uni-hemispheric stimulation strength (<xref ref-type="fig" rid="fig14">Figure 14</xref>). While this general relationship was consistent between the two species, the increase was much steeper in the fly. Additionally, the required stimulus for initiating ‘bump’ shifting was lower in the fruit fly. Both of these aspects concur with the faster response rate of the fruit fly model to positional stimuli and support their ability to track fast body saccades even when only angular velocity input is available.</p><fig id="fig14" position="float"><label>Figure 14.</label><caption><title>Response to uni-hemispheric stimulation.</title><p>Response rate of change of the heading signal with uni-hemispheric stimulation of P-EN neurons. The angular rate of change increases exponentially with stimulation strength and does so most rapidly for the fruit fly circuit. The data points have been fit with the function <inline-formula><mml:math id="inf4"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and the parameters of the fitted curves are shown on the plot.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig14-v2.tif"/></fig><p>Continuous application of angular velocity input caused the heading signal to reach an edge of the PB and then wrap around and continue on the other edge. This behaviour is present in both models and is thus independent of the physical shape of the EB, that is, whether it forms a closed ring or possesses open ends. The wrapping around of the heading signal is required for the animals to track movements that involve turning around its body axis for more that 360° and is supported by the effective closed ring structure we found in both species.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>The availability of tools for the study of insect brains at the single neuron level has opened the way to deciphering the neuronal organisation and principles of the underlying circuit’s behaviour. However, even where there is progress towards a complete connectome, the lack of data on synaptic strengths, neurotransmitter identity, neuronal conductances, etc. leave many parameters of the circuit unspecified. Exploring these parameters via computational modelling can help to illuminate the functional significance of identified neural elements. We have applied this approach to gain greater insight into the nature of the heading encoding circuit in the insect central complex (CX), including the consequences of differences in circuit connectivity across two insect species.</p><sec id="s3-1"><title>Overall conservation of structure and function</title><p>We have focused on a subset of neurons in the PB and EB which have been hypothesised to operate as a ring attractor, with a ‘bump’ of neuronal activity moving across columns consistently with the changing heading direction of the animal. The neuronal projection patterns and columnar organisation differ between the two insect species we have analysed, the fruit fly and the locust. There are additional morphological columns in the PB of flies (9 vs. 8), resulting in a different number of functional units that could influence the symmetry of the underlying neural circuits. Also, the EB in the fruit fly forms a physical ring, while the homologous region in the locust is an open structure. Our analysis of the connectivity as a directed graph has revealed, surprisingly, that the circuits are nevertheless equivalent in their effective structure, forming a closed ring attractor in both species with an identical functional role for each neuron class. The preservation of this circuit across 400 million years of evolutionary divergence suggests that it is an essential, potentially fundamental, part of the insect brain.</p><p>It is worth noting that an essential part of the circuit, namely the functionally closed ring that we found in both species, is achieved with two different solutions. In the fruit fly, the torus-shaped EB provides an anatomical solution to the closure of the ring via overlapping projections from E-PG neurons innervating the innermost and outermost PB glomeruli. In contrast, in the locust the midline spanning output fibers of the E-PG neurons in the medial PB glomeruli serve this function in combination with a slightly different projection pattern that results in the P-EN neurons forming reciprocal connections back to E-PG neurons in the same octant. In this context, it is interesting to note that neither solution to this problem is possible for insects of a different order, the lepidoptera (moths and butterflies). These insects have an almost straight EB, their PB is split along the midline, and right-left connections between the two halves are realised by a neuropil-free fiber bundle (<xref ref-type="bibr" rid="bib29">Heinze and Reppert, 2012</xref>; <xref ref-type="bibr" rid="bib1">Adden et al., 2020</xref>). Neither midline crossing E-PG fibers within the PB, nor local connections around the ring of the EB are therefore morphologically possible, suggesting that a functional closure of the heading direction circuit is either not required or achieved via other means in these species. The notion that there are many solutions to the same problem is further highlighted by data from bumblebees showing the existence of a ninth E-PG neuron that connects the medialmost PB glomerulus to the outermost ipsilateral EB wedge, closing the ring in yet another way (personal observations, S.H.). Exploring these different solutions across many species could provide key insights into the evolution of this circuit under a multitude of evolutionary history constraints.</p><p>In combination, these findings underline that the large-scale anatomical differences at the level of neuropils and projection patterns do not necessarily affect the core functions of the circuit. Rather, the functional constraints appear significant enough that even in those parts of the circuit that clearly differ between species convergent solutions have evolved that solve similar problems, albeit in slightly different ways.</p><sec id="s3-1-1"><title>Differences in dynamical response</title><p>Surprisingly, more subtle differences in the morphology between the two species have significant effects on the dynamical response of the heading direction circuit. First, the shape of the dendritic arborizations of one type of CX neuron determines how quickly the model circuit tracks rotational movements. Second, a difference in the overlap of neuronal projections in the EB results in an extra feedback loop between the P-EN and E-PG neurons in the locust circuit that makes it more robust to synaptic noise.</p><p>We suggest that the effects of these differences are consistent with the behavioural ecology of the two species. On the one hand, the faster response of the ring attractor circuit in the fruit fly accommodates the fast body saccades that fruit flies are known to perform (<xref ref-type="bibr" rid="bib57">Tammero and Dickinson, 2002</xref>; <xref ref-type="bibr" rid="bib15">Fry et al., 2003</xref>). On the other hand, the locust is a migratory species, so its behaviour demands maintenance of a defined heading for a long period of time (<xref ref-type="bibr" rid="bib32">Homberg, 2015</xref>; <xref ref-type="bibr" rid="bib10">de Vries et al., 2017</xref>). This requirement for heading stability might have provided the selective pressure needed to drive the evolution of a more noise resilient head direction circuit.</p></sec></sec><sec id="s3-2"><title>Assumptions and simplifications</title><p>As any model, our circuits are necessarily condensed and simplified versions of the real circuits in the insect brain. In comparison to previous models, the work we present has been more precisely constrained by the latest anatomical evidence. We additionally constrained our models to use plausible values for the biophysical properties of neurons (membrane conductance and capacitance) as well as spiking rates (background activity) supported by electrophysiological evidence. Furthermore, in building our models we did not assume that the underlying circuits must be ring attractors, but rather asked and investigated whether, given the available connectivity data, they can be. This was especially the case for the locust model since our work represents the first model of this circuit to date. Nevertheless, it is important to outline those areas where our assumptions cannot be fully justified from the existing data and identify the potential consequences for the modelling results.</p><sec id="s3-2-1"><title>Morphological assumptions</title><p>In our model of the fruit fly heading tracking circuit, we assumed a uniform distribution of dendrites across the Delta7 neurons. Imaging of these neurons suggests that there might be a subtle variation of the dendritic density along their length. However, it is unclear how this subtle variation might be related to synaptic density and efficacy. We, therefore, initially made the simplifying assumption that these neurons have uniform synaptic efficacy across the PB. However, we also explored the effect of varying the degree of synaptic uniformity, showing that there is a range of synaptic efficacy distributions that still can produce the fly-like rapidity in the circuit response.</p><p>In general, arborization trees of neurons in the CX can be very complex, as they are not only confined to specific slices, but also to one or several layers, especially within the EB. In <italic>Drosophila</italic>, the spiny terminal arbors of E-PG neurons extend to the width of single wedges in the EB, occupying both the posterior and medial layers. In contrast, P-EG and P-EN neurons arborize in tiles, hence innervating only the posterior surface volume of the EB (<xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). Therefore, we assume that presynaptic terminals of P-EG and P-EN neurons form synapses with E-PG postsynaptic terminals in the posterior layer of the EB. In locusts, the E-PG arborizations are more complex, as these cells innervate a single wedge of the anterior and medial EB layers, but extend at least twice this width to either side in the posterior layer that provides overlap with the P-EN neurons (<xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>). Additionally, the wider fibres have a different morphological appearance. P-EG neurons in this species innervate all layers evenly. Although these detailed differences likely have consequences for connectivity, we simplified these arborizations to their most essential components, aiding the extraction of the core features. With the advance of comparative connectomics, these aspects will become accessible for investigation.</p></sec><sec id="s3-2-2"><title>Connectivity assumptions</title><p>Several assumptions were made while deriving the neuronal connectivity in our models. We assumed well delineated borders of synaptic domains, which is clearly not always the case. Especially in the EB, some overlapping of neighbouring synaptic domains due to stray terminals is to be expected (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>). The circumferential extent of arbors in wedges and tiles may affect the integrity of the resulting circuit and its properties. However, due to lack of adequate data about the extent of such overlap we cannot currently model this aspect in a sensible way.</p><p>Furthermore, neuronal connectivity was mostly inferred by co-location of neuronal arbors, that is, projection patterns. A functional connectivity study has reported that stimulation of E-PG neurons triggered significant responses to Delta7 neurons but no columnar neurons (<xref ref-type="bibr" rid="bib14">Franconville et al., 2018</xref>). However, as those authors note, the lack of response might be due to the limitations of the method used. Alternatively, such connections might be mediated by interneurons instead of being monosynaptic. Future work using electron microscopy data will elucidate which of the overlapping arborizations correspond to functional connections and allow us to augment our models.</p></sec><sec id="s3-2-3"><title>Functional assumptions</title><p>Further assumptions were made about neuronal polarity, type of synapses and synaptic efficacies. <xref ref-type="bibr" rid="bib35">Lin et al., 2013</xref> characterise the EB arbor of E-PG neurons in <italic>Drosophila</italic> as having both presynaptic and postsynaptic domains; however, <xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref> report that using anti-synaptotagamin is inconclusive for presynaptic terminals. In our models for both the fruit fly and the locust we thus assumed that E-PG neurons are purely postsynaptic in the EB, following the most parsimonious polarity estimate. Connectomics data from a recent preprint demonstrate that in <italic>Drosophila</italic> synapses exist that directly link Delta7 to E-PG neurons in the PB (<xref ref-type="bibr" rid="bib62">Turner-Evans et al., 2019</xref>). These synapses are most likely inhibitory and would thus inhibit the distal portion of the ring and thus would not alter the location of the activity ‘bump’. For simplicity and because they do not affect the functional layout of the circuit, these synapses were not included in our model.</p><p>Furthermore, the Delta7 neurons are assumed to have inhibitory effect on their postsynaptic neurons, as <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> proposed. However, there is evidence that Delta7 neurons make both inhibitory and excitatory synapses to other neurons (<xref ref-type="bibr" rid="bib14">Franconville et al., 2018</xref>). Indeed, these cells were recently shown to be glutamatergic, enabling both inhibitory and excitatory effects on postsynaptic cells via different glutamate receptors (<xref ref-type="bibr" rid="bib62">Turner-Evans et al., 2019</xref>). As the downstream neurons with demonstrated excitatory responses (P-FN neurons) are not part of our current model, we made the simplifying assumption that Delta7 neurons have exclusively inhibitory effect on their postsynaptic neurons, both in flies and locusts. It is also possible that there are other sources of inhibition in the circuit, for example mediated by the GABAergic ring neurons originating in the bulbs, as suggested by <xref ref-type="bibr" rid="bib22">Green and Maimon, 2018</xref>, or via GABAergic Gall-EB ring neurons (<xref ref-type="bibr" rid="bib62">Turner-Evans et al., 2019</xref>). We do not explore this possibility in our current work.</p><p>We additionally assumed that the synaptic strengths of all synapses of each class are identical. This might not be the case in the actual animals, especially considering that one of the EB tiles (T1) is innervated by twice as many neurons as other tiles in fruit flies (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Neurons innervating this tile might have reduced synaptic efficacy in order to maintain the radial symmetry of the circuit intact. Similarly, the synaptic strengths of the neurons closing the ring in locusts would be expected to be different than those of other synapses if the ring does not have a functional ‘seam’. Such a synaptic efficacy variation is suggested by the fact that the arborization density of E-PG neurons innervating the two medial PB glomeruli (G9 and G1) is not the same in both of them. There is certainly space for further exploration of the effect of synaptic efficacy in those segments of the ring in both species. Finally, synaptic strength variation might exist for the two Delta7 neurons that have presynaptic terminals in three glomeruli instead of two (<xref ref-type="table" rid="table3">Table 3</xref>).</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Neuronal nomenclature.</title><p>The names used for the homologous neurons differ between <italic>Drosophila</italic> and other species. The first column shows the name used in this paper to refer to each group of neurons. The other three columns provide the names used in the literature.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Model</th><th colspan="2"><italic>Drosophila</italic></th><th>Locust</th></tr><tr><th>Neuron name</th><th>Consensus name</th><th>Systematic name (<xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>)</th><th>Name</th></tr></thead><tbody><tr><td>E-PG</td><td>E-PG and E-PG<sub><italic>T</italic></sub></td><td>PBG1-8.b-EBw.s-D/V GA.b and PBG9.b-EB.P.s-GA-t.b</td><td>CL1a</td></tr><tr><td>P-EN</td><td>P-EN</td><td>PBG2-9.s-EBt.b-NO1.b</td><td>CL2</td></tr><tr><td>P-EG</td><td>P-EG</td><td>PBG1-9.s-EBt.b-D/V GA.b</td><td>CL1b</td></tr><tr><td>Delta7</td><td>Delta7 or Δ7</td><td>PB18.s-GxΔ7Gy.b and PB18.s-9i1i8c.b</td><td>TB1</td></tr></tbody></table></table-wrap></sec><sec id="s3-2-4"><title>Biophysical assumptions</title><p>All types of neurons in our models were assumed to have the same nominal biophysical properties even though anatomical evidence has shown that their morphology, somata size and main neurite thickness differ (<xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>). To relax this assumption, we explored the effect of heterogeneity in the biophysical properties of the neuronal population. We corroborated our conclusions using both rate-based and Leaky Integrate and Fire neurons with refractory period. This allowed us to highlight the significance of the neuronal connectivity on the circuit dynamics. The point spiking neuron model was sufficient for investigating the performance characteristics, spike timing dynamics and potential spike synchronisation effects in the ring attractors when exposed to neuronal noise, but clearly is highly abstracted in comparison to real neurons. However, we lack most of the necessary detail to constrain more complex neural models. One caveat is that intrinsic properties of neurons could provide short-term memory that would radically alter the circuit response. It is not possible to explore this possibility with the models we have used, but we can conclude that such properties do not appear to be necessary for generating basic ring attractor dynamics. Furthermore, it will be interesting to study how differences in the biophysical properties of neurons between the two species might be affecting performance. We are not exploring this possibility here.</p></sec></sec><sec id="s3-3"><title>Comparison to ‘canonical’ ring attractor models</title><p>In our work, we compared the hypothetical heading tracking circuit of two evolutionary distant species. We went beyond mere simulation of neuronal projection data by analysing and deriving the effective underlying circuit structure of the two ring attractors. Our analysis and derivation of the complete effective neuronal circuits revealed not only differences in dynamics but also the construction principles of these circuits. This approach allowed us to identify elements that differ in several ways from the ‘canonical’ ring attractor described in earlier theoretical models (e.g. <xref ref-type="bibr" rid="bib2">Amari, 1977</xref>; <xref ref-type="bibr" rid="bib51">Skaggs et al., 1995</xref>; <xref ref-type="bibr" rid="bib70">Zhang, 1996</xref>).</p><p>For example, the circuit found in the two insect species combines two functionalities in the P-EN neurons that are typically assigned to separate neural populations in computational models of ring attractors. Such computational models use one set of neurons to provide the lateral excitation to nearest neighbours and a different set of neurons that receive angular velocity input to drive the left-right rotation of the heading signal. In the insect circuit, the P-EN cells are part of the lateral excitation circuit, providing excitation to their two nearest neighbours, but they also receive angular velocity input. This difference is suggestive of a more efficient use of neuronal resources than the typical computational models of ring attractors. Another novel element we found in the insect ring attractors is the presence of local feedback loops within each octant of the circuit structure (P-EG to E-PG and P-EN to E-PG). Both of these feedback loops increase the tolerance of the ring attractors to noise.</p></sec><sec id="s3-4"><title>Hypotheses regarding circuit differences</title><p>Another unique aspect of our modelling work is the comparison of related, but not identical, circuits found in two species. Indeed, using computational modelling allows us to investigate ’hybrid’ circuits, combining features of each, in order to try to understand the functional significance of each observed difference independently. Nevertheless, some differences between these circuits are not explained by the current model, and may require additional work to fully explicate.</p><p>One question is what is the role, if any, of the ninth PB glomeruli found so far only in <italic>Drosophila</italic>? In particular, the existence of the innermost glomeruli that are not innervated by the P-EN neurons seems perplexing. The same signals from tile 1 of the EB are sent to both ends of each hemisphere of the PB (glomeruli 1 and 9) and from there action potentials propagate along the Delta7 neurons along the PB length. Our speculation is that this may be a mechanism to reduce the distance and time these signals have to travel to cover the full PB, that is, the maximum distance any signal must travel is only half of the distance it would need to propagate from one end of the PB to the other as in other species, such as the locust. If this is the case, it would constitute one more specialisation in <italic>Drosophila</italic> that reduces the response time of the ring attractor. It therefore seems that several specialisations have been orchestrated in minimising the response delays in fruit flies. Testing this idea would require multi-compartmental models to capture the action potential transmission time along neurites; as argued above, this may be contingent upon first obtaining detailed biophysical characterisation of the Delta7 neurons.</p><p>Another remaining question is what is the role of the closed ring-shaped EB in <italic>D. melanogaster</italic>. One possibility is that such a closed ring topology would allow local reciprocal connections between P-EN and E-PG neurons all around the EB ring, as reported in <xref ref-type="bibr" rid="bib62">Turner-Evans et al., 2019</xref>. This would allow direct propagation of signals between these neurons within the EB instead of requiring them to travel via the PB, as in the current model, again increasing the speed with which the heading direction can be tracked and allowing smoother transition between neighbouring tiles. Note that such direct reciprocal connections within the EB can only span the full ring with a closed ring anatomy and would not be possible between the two ends of the EB in the locust. To investigate the potential effect of such hypothetical reciprocal connections within the EB, further studies are required. Possibly blocking signal transmission via the PB to isolate functional connectivity within the EB would allow comparison of signal transmission time measurements within the EB versus via the PB. Such measurements would determine how different and hence significant those two pathways might be in the ring attractor performance.</p><p>A further hypothesis relates to the evolutionary lineage of these two features in the <italic>Drosophila</italic> CX. It will be of interest to study whether the ring shaped EB appeared before or after the appearance of the ninth glomeruli. One possibility is that the EB evolved into a ring shape after the appearance of the ninth glomeruli in the PB, allowing connections from one common tile to both glomeruli 1 and 9 and hence providing such a common driving signal. Alternatively, a pre-existing ring-shaped EB might have allowed the evolution of usable ninth glomeruli that resulted in faster propagation. Similarly, the P-EN to E-PG recurrency found only in the locust might be an acquired adaptation of the locust that increases robustness to noise, or an ancestral feature that has been lost in fruit flies.</p><p>Comparison of different species could potentially elucidate such questions. We would expect individual species to have a selective subset of the specialisations we found, endowing them with brain circuits supporting the behavioural repertoire suiting their ecological niche. It will, therefore, be informative to analyse the effective heading direction circuit of other species, spanning evolutionary history, in order to get insights into how such adaptations relate to and accommodate behaviour. Our results emphasise the importance of comparative studies if we are to derive general principles about neuronal processing, even in systems that appear highly conserved such as the CX head direction circuit in insects. Many of the circuit properties observed in <italic>Drosophila</italic> appear to reflect specific evolutionary adaptations related to tracking rapid flight manoeuvres. Despite the many strengths of <italic>Drosophila</italic> as an experimental model, it therefore remains important to ground conclusions about the insect brain in comparison with other species.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Neuron model</title><p>Our models used the source code of <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> as a starting point. We used Leaky Integrate and Fire neuron models with refractory period (<xref ref-type="bibr" rid="bib53">Stein, 1967</xref>). The membrane potential of each neuron was modelled by the differential equation<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfrac><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf5"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the membrane potential of neuron <italic>i</italic>, <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> the resting potential, <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> the membrane resistance, <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> the membrane capacitance, <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the external input current of neuron <italic>i</italic>, <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the network connectivity matrix, <inline-formula><mml:math id="inf11"><mml:msub><mml:mi>I</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> the output current of each neuron in the circuit and <italic>N</italic> is the number of neurons.</p><p>The model parameter values including membrane resistance, capacitance, resting potential, undershoot potential and postsynaptic current magnitude (<inline-formula><mml:math id="inf12"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) were set to the same values as used by <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>. These values are consistent with evidence from measurements in <italic>D. melanogaster</italic> and other species. The membrane capacitance <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> is set to <inline-formula><mml:math id="inf14"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:math></inline-formula> and the membrane resistance <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>R</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf16"><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:math></inline-formula> for all neurons, assuming a surface area of <inline-formula><mml:math id="inf17"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib20">Gouwens and Wilson, 2009</xref>). The resting potential <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is set to <inline-formula><mml:math id="inf19"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>52</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for all neurons (<xref ref-type="bibr" rid="bib47">Rohrbough and Broadie, 2002</xref>; <xref ref-type="bibr" rid="bib50">Sheeba et al., 2008</xref>). The action potential threshold is <inline-formula><mml:math id="inf20"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>45</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib20">Gouwens and Wilson, 2009</xref>). When the membrane potential reaches the threshold voltage an action potential template is inserted in the recorded time series. No other impulses occur during this period operating in effect as a refractory period. The action potential template is defined as <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the peak voltage set to <inline-formula><mml:math id="inf22"><mml:mrow><mml:mn>20</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib47">Rohrbough and Broadie, 2002</xref>). <inline-formula><mml:math id="inf23"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the action potential undershoot voltage, set to <inline-formula><mml:math id="inf24"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mn>72</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>(<xref ref-type="bibr" rid="bib39">Nagel et al., 2015</xref>). <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the duration of the action potential set to 2 ms (<xref ref-type="bibr" rid="bib20">Gouwens and Wilson, 2009</xref>; <xref ref-type="bibr" rid="bib16">Gaudry et al., 2013</xref>). <inline-formula><mml:math id="inf26"><mml:mrow><mml:mi class="ltx_font_mathcaligraphic">𝒩</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a Gaussian function with a mean µ and standard deviation σ. <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf30"><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> are normalisation parameters for scaling the range of the Gaussian and the sinusoidal to 0 to 1.</p><p>The firing of an action potential also adds a postsynaptic current template to the current time series. The postsynaptic current template is defined as<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mtext> </mml:mtext><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>if </mml:mtext></mml:mstyle><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mn>7</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib16">Gaudry et al., 2013</xref>). Excitatory and inhibitory postsynaptic currents are assumed to have the same magnitude but opposite signs. <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the half-life of the postsynaptic current decay (<xref ref-type="bibr" rid="bib16">Gaudry et al., 2013</xref>). <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf35"><mml:msub><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are normalisation constants so that the range of the sinusoidal and exponential terms is 0 to 1. The postsynaptic current traces have duration <inline-formula><mml:math id="inf37"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>7</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, that is <inline-formula><mml:math id="inf38"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> of rise time plus <inline-formula><mml:math id="inf39"><mml:mrow><mml:mn>7</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of decay time. The simulation was implemented using Euler’s method with a simulation time step of <inline-formula><mml:math id="inf40"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>. Our simulation code is derived from the source code published by <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref>. All simulations were performed using MATLAB (The MathWorks Inc, Natick, MA) and all source codes are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019">https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/eLife_Pisokas_Heinze_Webb_2019">https://github.com/elifesciences-publications/eLife_Pisokas_Heinze_Webb_2019</ext-link>; <xref ref-type="bibr" rid="bib45">Pisokas, 2020</xref>). For data analysis we used MATLAB, python, and R scripts.</p></sec><sec id="s4-2"><title>Neuronal projections and connectivity</title><p>We modelled and compared the hypothetical ring attractor circuits of the fruit fly <italic>D. melanogaster</italic> and the desert locust <italic>S. gregaria</italic>. The connectivity of the circuits has been inferred mostly from anatomical data derived using light microscopy, with overlapping neuronal terminals assumed to form synapses between them (<xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>; <xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib27">Heinze and Homberg, 2008</xref>; <xref ref-type="bibr" rid="bib44">Pfeiffer and Homberg, 2014</xref>).</p><p>Our models include the E-PG, P-EG, P-EN and Delta7 neurons. Note that, in fruit flies, P-EG refers to the updated set of neurons innervating all PB glomeruli as reported in <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref> (PBG1-9.s-EBt.b-D/V GA.b). In this paper, E-PG refers to the E-PG (PBG1-8.b-EBw.s-D/V GA.b) and the complimentary E-PG<sub><italic>T</italic></sub> (PBG9.b-EB.P.s-GA-t.b) combined (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). Therefore, E-PG neurons are innervating all PB glomeruli in both species. Delta7 refers to PB18.s-GxΔ7Gy.b and PB18.s-9i1i8c.b neurons combined (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>; <xref ref-type="bibr" rid="bib68">Wolff and Rubin, 2018</xref>). <xref ref-type="table" rid="table3">Table 3</xref> shows the nomenclature correspondence in detail.</p><p>These neurons innervate two of the central complex neuropils, the protocerebral bridge (PB) and the ellipsoid body (EB). Ellipsoid body is the name used for this structure in the fruit fly <italic>D. melanogaster</italic>, while in the locust <italic>S. gregaria</italic> the equivalent structure is referred to as lower division of the central body (CBL). To aid comparisons with previous models and for general simplification, we use the term EB for both species. The PB is a moustache shaped structure consisting of 16 or 18 glomeruli, depending on the species. In the fruit fly <italic>D. melanogaster</italic>, the EB has a torus shape consisting of eight tiles. Each tile is further broken down in two wedges. In the locust <italic>S. gregaria</italic>, the EB (CBL) is a linear structure, open at the edges, consisting of eight columns. Each column has two subsections similar to the wedges found in <italic>D. melanogaster</italic>.</p><p>For both <italic>D. melanogaster</italic> and <italic>S. gregaria</italic>, the synaptic domains of each of the E-PG, P-EN and P-EG neurons are confined to one glomerulus of the PB, with the exception of the locust E-PG neurons that cross-innervate the two medial glomeruli (<xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">Figure 4</xref>). In the EB, the synaptic domains of E-PG neurons are constrained in single wedges (half tiles) while the synaptic domains of P-EN and P-EG neurons extend to whole tiles (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>). Furthermore, E-PG neurons innervate wedges filling the posterior and medial shells of the EB while P-EG neurons innervate whole tiles filling only the posterior shell of the EB (<xref ref-type="bibr" rid="bib67">Wolff et al., 2015</xref>). Our model assumes that their overlap in the posterior shell implies functional connectivity.</p><p>In our models, the E-PG, P-EG and P-EN neurons are assumed to produce excitatory effect on their postsynaptic neurons while Delta7 neurons are assumed to provide the inhibition, as <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> proposed. The projection patterns of the aforementioned neurons were mapped to one connectivity matrix for each species (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref> shows the connectivity matrix of the <italic>Drosophila melanogaster</italic> fruit fly model, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref> the connectivity matrix of the <italic>S. gregaria</italic> desert locust model.</p><p>The most salient difference between the two matrices is the connectivity pattern of the Delta7 neurons (lower right part of <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref> and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). In <italic>D. melanogaster</italic>, the Delta7 neurons receive synapses uniformly across the PB glomeruli, while in the locust <italic>S. gregaria</italic> the Delta7 neurons have synaptic domains focused in specific glomeruli. We analysed the effect of this difference in detail in the Results section. Another major difference apparent in the connectivity matrices is the existence of 18 glomeruli in the PB of <italic>D. melanogaster</italic> but 16 in <italic>S. gregaria</italic>.</p><p>We modelled each PB glomerulus, as being innervated by one neuron of each class (E-PG, P-EG, P-EN) even though in reality there are several instances of each one. This was done in order to simplify the computational demands of the simulations.</p><p>The locust inhibition pattern has been modelled as the summation of two Gaussian functions that approximate the synaptic density across the PB glomeruli, as derived from estimates of dendritic density along the PB in dye-filled Delta7 neurons. The standard deviation (σ) of the Gaussian functions was set to the value 0.8 as the nearest approximation to the visually determined synaptic domain width. To calculate the synaptic strength of each synapse we used the expression<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>σ</mml:mi><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>W</italic> is a scaling factor specifying the maximum synaptic strength across the PB, <italic>i</italic> is the glomerulus number as shown in <xref ref-type="fig" rid="fig15">Figure 15</xref>, <italic>n</italic> is the number of glomeruli in each hemisphere, <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:math></inline-formula>, and σ is the standard deviation parameter specifying the width of the Gaussian function used. σ is the parameter estimated by visual inspection of light microscopy data. <italic>W</italic> is the parameter selected by the optimisation process.</p><fig id="fig15" position="float"><label>Figure 15.</label><caption><title>Illustration of Gaussian distribution of synaptic strengths.</title><p>The Gaussian distribution of synaptic strengths along synapses located in the PB glomeruli. The synaptic strengths along the PB are illustrated for one Delta7 neuron. The example illustrates the distribution for eight glomeruli, the same method is used for the hybrid-species model using nine glomeruli instead.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig15-v2.tif"/></fig><p>It is worth noting that in all our simulations we use the full connectivity matrices derived from neuronal projection data and not the effective circuits described in the section Results.</p></sec><sec id="s4-3"><title>Stimuli</title><p>Two types of input stimuli were used for the experiments: heading and angular velocity. The heading stimulus was provided as incoming spiking activity directly to the E-PG neurons, corresponding to input from Ring neurons (<xref ref-type="bibr" rid="bib69">Young and Armstrong, 2010</xref>) (called TL neurons in locusts [<xref ref-type="bibr" rid="bib63">Vitzthum et al., 2002</xref>]). The position of a visual cue, angle of light polarisation (<xref ref-type="bibr" rid="bib26">Heinze and Homberg, 2007</xref>) or retinotopic landmark position (<xref ref-type="bibr" rid="bib48">Seelig and Jayaraman, 2015</xref>) around the animal, was mapped to higher firing rates supplied to E-PG neurons at the corresponding location of the EB. The stimulus followed spatially a von Mises distribution with mean the azimuth of the stimulus and full width at half maximum (FWHM) of approximately 90° (<xref ref-type="fig" rid="fig16">Figure 16</xref>). The spatial distribution of the stimulus strength was derived using <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>.</p><fig id="fig16" position="float"><label>Figure 16.</label><caption><title>Illustration of von Mises distributed stimulus.</title><p>The curve demonstrates the relative intensity of the stimulus supplied to neurons innervating each EB tile. In this illustration the stimulus is centred at tile 5.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53985-fig16-v2.tif"/></fig><p><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>κ</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:msup><mml:mi>κ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>!</mml:mo><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mi>π</mml:mi><mml:mn>4</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the stimulus centre location parameter, <inline-formula><mml:math id="inf43"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the EB tile numerical index and <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>κ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the shape parameter. The values returned by <inline-formula><mml:math id="inf45"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are converted to corresponding spiking activity levels. To do this, we sampled from a Poisson distribution. The minimum value is mapped to the background activity level and the maximum to the peak level of activity. We assumed that the background activity follows a Poisson distribution with a mean background action potential rate of 5 impulses/s. The peak impulse firing rate of the stimulus signal was equal to the peak spiking rate of the activity ‘bump’ across the E-PG neuron population under steady state conditions, in order to obtain comparable measurements across species.</p><p>The second type of stimulus, angular velocity stimulus, consisted of spikes which were directly supplied to all P-EN neurons in one hemisphere of the PB, corresponding to the direction of rotation (clockwise versus counter-clockwise). The peak impulse rate of the injected spike trains was equal to the peak rate of the steady state activity ‘bump’ across the P-EN neurons. This was done in order to allow for direct comparisons between species.</p></sec><sec id="s4-4"><title>Free parameters</title><p>The free parameters of our models are the synaptic efficacies. The efficacies of synapses connecting each class of neurons are assumed to be identical, e.g., all P-EN to E-PG synapses have the same strength. Therefore, we have one free parameter for each synaptic class. Furthermore, we reduced the computational complexity of optimising the synaptic strengths by making the synaptic strength between some classes of neurons identical. The synaptic strengths of E-PG to P-EN and P-EG are identical as are the synaptic strengths of Delta7 to P-EN and P-EG. This is the minimum set of synaptic strengths that results in working ring attractors. We assumed that all synapses are excitatory apart from the synapses with Delta7 neurons on the presynaptic side, which were assumed to be inhibitory, as <xref ref-type="bibr" rid="bib33">Kakaria and de Bivort, 2017</xref> proposed. The synaptic strength was modelled as the number of <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> unit equivalents flowing to the postsynaptic neuron per action potential.</p><p>Although our models are constrained by anatomical evidence, existing biological studies do not specify synaptic weights or connectivity. Based on the goal that each of the circuits should yield a functional ring attractor, an optimisation algorithm was used to search for synaptic strength combinations that resulted in working ring attractors. Both simulated annealing and particle swarm optimisation algorithms were used (Matlab Optimization Toolbox ‘simulannealbnd’ and ‘particleswarm’ functions); the first one converges quicker while the second one covers the search space more thoroughly. We constrained the acceptable solutions to those that produced an activity ‘bump’ with full width at half maximum (FWHM) of approximately 90° since this is the width that has been observed in fruit flies (<xref ref-type="bibr" rid="bib34">Kim et al., 2017</xref>).</p><p>The objective function used to optimise the synaptic strengths <inline-formula><mml:math id="inf47"><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> was:<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:munder></mml:mtd><mml:mtd><mml:mn>4</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>360</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>360</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>90</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>360</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>90</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>360</mml:mn><mml:mrow><mml:msup><mml:mi/><mml:mo>∘</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>100</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>100</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>100</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mn>100</mml:mn></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo>−</mml:mo><mml:mn>100</mml:mn></mml:mtd><mml:mtd><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi>W</mml:mi><mml:mo>⁢</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are the error factors measured as deviations from the desired values. <inline-formula><mml:math id="inf52"><mml:msub><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> is used to penalise synaptic strengths being too close to 0. <italic>N</italic> is the number of synaptic strengths <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the desired activity ‘bump’ heading at time <italic>t</italic>, while <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐰</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the actual measured activity ‘bump’ heading at time <italic>t</italic> given a model with synaptic strengths <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">w</mml:mi></mml:mrow><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold">t</mml:mi><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the actual measured width of the activity ‘bump’ at time <italic>t</italic> (measured as the full width at half maximum). The constraints in <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> specify that the synapses with Delta7 neurons at their presynaptic side are inhibitory (negative) and all others are excitatory (positive). Synaptic weights were initialised with values −0.01 or 0.01 depending on whether the negative only or positive only constraint was applied. During optimisation the spiking models were used to run the simulations and search the space of synaptic strengths. The synaptic strength sets that resulted from multiple runs were manually tested to verify the results. The objective function was used to optimise the synaptic strengths separately for each of the models: the fruit fly, the locust, and the hybrid-species model.</p></sec><sec id="s4-5"><title>Sensitivity analysis and parameter noise</title><p>For the sensitivity analysis, white Gaussian noise was added to the membrane parameters of neurons (conductance and capacitance) as well as to the synaptic efficacies, using the formula<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>x</mml:mi><mml:mn>100</mml:mn></mml:mfrac><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϵ</mml:mi></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒩</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf58"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is the resulting noisy value of the parameter with <inline-formula><mml:math id="inf59"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:mi>M</mml:mi></mml:math></inline-formula> being the number of parameters. <inline-formula><mml:math id="inf61"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the nominal value of the parameter, <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the percentage of noise to be added to the nominal value, ε is a random variable sampled from the Gaussian distribution with <inline-formula><mml:math id="inf63"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. When noise was added to the conductance and capacitance of neurons the resulting values were clipped to a minimum of 0 because conductance and capacitance values cannot be negative. For measuring the tolerance to inter-hemispheric synaptic asymmetry we altered the P-EN to E-PG synapses in one hemisphere by different amounts in the range −100% to 100%.</p><p>The number of successful trials was counted in each condition. The criterion for a successful trial was that the activity ‘bump’ transitioned from an initial stimulus-driven heading to a second stimulus-driven heading with an error of less that ±45° and subsequently the second heading was maintained for at least 3 s. The criterion used for judging jump versus gradual transition of the heading signal was that for the transition to be considered a jump the intervening neurons between the origin and end location must not become maximally active during the transition.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>The authors thank Matthias Hennig and Michael Rule for their invaluable comments.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Funding acquisition, Validation, Visualization, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Supervision, Funding acquisition, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-53985-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All source scripts for producing the data as well as for generating Figures 6A, 6B, 7, 8, 9, 10, 11, 12, 14 and Tables 1 and 2 are located at <ext-link ext-link-type="uri" xlink:href="https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019">https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/eLife_Pisokas_Heinze_Webb_2019">https://github.com/elifesciences-publications/eLife_Pisokas_Heinze_Webb_2019</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adden</surname> <given-names>A</given-names></name><name><surname>Wibrand</surname> <given-names>S</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Warrant</surname> <given-names>E</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The brain of a nocturnal migratory insect, the australian bogong moth</article-title><source>Journal of Comparative Neurology</source><volume>528</volume><fpage>1942</fpage><lpage>1963</lpage><pub-id pub-id-type="doi">10.1002/cne.24866</pub-id><pub-id pub-id-type="pmid">31994724</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amari</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Dynamics of pattern formation in lateral-inhibition type neural fields</article-title><source>Biological Cybernetics</source><volume>27</volume><fpage>77</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1007/BF00337259</pub-id><pub-id pub-id-type="pmid">911931</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beetz</surname> <given-names>MJ</given-names></name><name><surname>El Jundi</surname> <given-names>B</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Topographic organization and possible function of the posterior optic tubercles in the brain of the desert locust <italic>Schistocerca gregaria</italic></article-title><source>Journal of Comparative Neurology</source><volume>523</volume><fpage>1589</fpage><lpage>1607</lpage><pub-id pub-id-type="doi">10.1002/cne.23736</pub-id><pub-id pub-id-type="pmid">25557150</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blair</surname> <given-names>HT</given-names></name><name><surname>Sharp</surname> <given-names>PE</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Anticipatory head direction signals in anterior thalamus: evidence for a thalamocortical circuit that integrates angular head motion to compute head direction</article-title><source>The Journal of Neuroscience</source><volume>15</volume><fpage>6260</fpage><lpage>6270</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.15-09-06260.1995</pub-id><pub-id pub-id-type="pmid">7666208</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bockhorst</surname> <given-names>T</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Amplitude and dynamics of polarization-plane signaling in the central complex of the locust brain</article-title><source>Journal of Neurophysiology</source><volume>113</volume><fpage>3291</fpage><lpage>3311</lpage><pub-id pub-id-type="doi">10.1152/jn.00742.2014</pub-id><pub-id pub-id-type="pmid">25609107</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brody</surname> <given-names>CD</given-names></name><name><surname>Romo</surname> <given-names>R</given-names></name><name><surname>Kepecs</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Basic mechanisms for graded persistent activity: discrete attractors, continuous attractors, and dynamic representations</article-title><source>Current Opinion in Neurobiology</source><volume>13</volume><fpage>204</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/S0959-4388(03)00050-3</pub-id><pub-id pub-id-type="pmid">12744975</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cope</surname> <given-names>AJ</given-names></name><name><surname>Sabo</surname> <given-names>C</given-names></name><name><surname>Vasilaki</surname> <given-names>E</given-names></name><name><surname>Barron</surname> <given-names>AB</given-names></name><name><surname>Marshall</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A computational model of the integration of landmarks and motion in the insect central complex</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0172325</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0172325</pub-id><pub-id pub-id-type="pmid">28241061</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dacke</surname> <given-names>M</given-names></name><name><surname>Nilsson</surname> <given-names>D-E</given-names></name><name><surname>Scholtz</surname> <given-names>CH</given-names></name><name><surname>Byrne</surname> <given-names>M</given-names></name><name><surname>Warrant</surname> <given-names>EJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Insect orientation to polarized moonlight</article-title><source>Nature</source><volume>424</volume><elocation-id>33</elocation-id><pub-id pub-id-type="doi">10.1038/424033a</pub-id><pub-id pub-id-type="pmid">12840748</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darwin</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1873">1873</year><article-title>Origin of certain instincts</article-title><source>Nature</source><volume>7</volume><fpage>417</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1038/007417a0</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Vries</surname> <given-names>L</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Trebels</surname> <given-names>B</given-names></name><name><surname>Adden</surname> <given-names>AK</given-names></name><name><surname>Green</surname> <given-names>K</given-names></name><name><surname>Warrant</surname> <given-names>E</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Comparison of Navigation-Related brain regions in migratory versus Non-Migratory noctuid moths</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>11</volume><elocation-id>158</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2017.00158</pub-id><pub-id pub-id-type="pmid">28928641</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Jundi</surname> <given-names>B</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Lenschow</surname> <given-names>C</given-names></name><name><surname>Kurylas</surname> <given-names>A</given-names></name><name><surname>Rohlfing</surname> <given-names>T</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The locust standard brain: a 3D standard of the central complex as a platform for neural network analysis</article-title><source>Frontiers in Systems Neuroscience</source><volume>3</volume><elocation-id>21</elocation-id><pub-id pub-id-type="doi">10.3389/neuro.06.021.2009</pub-id><pub-id pub-id-type="pmid">20161763</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>el Jundi</surname> <given-names>B</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Integration of polarization and chromatic cues in the insect sky compass</article-title><source>Journal of Comparative Physiology A: Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>200</volume><fpage>575</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1007/s00359-014-0890-6</pub-id><pub-id pub-id-type="pmid">24589854</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Jundi</surname> <given-names>B</given-names></name><name><surname>Warrant</surname> <given-names>EJ</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Dacke</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neuroarchitecture of the dung beetle central complex</article-title><source>Journal of Comparative Neurology</source><volume>526</volume><fpage>2612</fpage><lpage>2630</lpage><pub-id pub-id-type="doi">10.1002/cne.24520</pub-id><pub-id pub-id-type="pmid">30136721</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franconville</surname> <given-names>R</given-names></name><name><surname>Beron</surname> <given-names>C</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Building a functional connectome of the <italic>Drosophila</italic> central complex</article-title><source>eLife</source><volume>7</volume><elocation-id>e37017</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.37017</pub-id><pub-id pub-id-type="pmid">30124430</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fry</surname> <given-names>SN</given-names></name><name><surname>Sayaman</surname> <given-names>R</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The aerodynamics of free-flight maneuvers in <italic>Drosophila</italic></article-title><source>Science</source><volume>300</volume><fpage>495</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1126/science.1081944</pub-id><pub-id pub-id-type="pmid">12702878</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaudry</surname> <given-names>Q</given-names></name><name><surname>Hong</surname> <given-names>EJ</given-names></name><name><surname>Kain</surname> <given-names>J</given-names></name><name><surname>de Bivort</surname> <given-names>BL</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Asymmetric neurotransmitter release enables rapid odour lateralization in <italic>Drosophila</italic></article-title><source>Nature</source><volume>493</volume><fpage>424</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/nature11747</pub-id><pub-id pub-id-type="pmid">23263180</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giraldo</surname> <given-names>YM</given-names></name><name><surname>Leitch</surname> <given-names>KJ</given-names></name><name><surname>Ros</surname> <given-names>IG</given-names></name><name><surname>Warren</surname> <given-names>TL</given-names></name><name><surname>Weir</surname> <given-names>PT</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Sun navigation requires compass neurons in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>28</volume><fpage>2845</fpage><lpage>2852</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2018.07.002</pub-id><pub-id pub-id-type="pmid">30174187</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodridge</surname> <given-names>JP</given-names></name><name><surname>Dudchenko</surname> <given-names>PA</given-names></name><name><surname>Worboys</surname> <given-names>KA</given-names></name><name><surname>Golob</surname> <given-names>EJ</given-names></name><name><surname>Taube</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Cue control and head direction cells</article-title><source>Behavioral Neuroscience</source><volume>112</volume><fpage>749</fpage><lpage>761</lpage><pub-id pub-id-type="doi">10.1037/0735-7044.112.4.749</pub-id><pub-id pub-id-type="pmid">9733184</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodridge</surname> <given-names>JP</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Modeling attractor deformation in the rodent head-direction system</article-title><source>Journal of Neurophysiology</source><volume>83</volume><fpage>3402</fpage><lpage>3410</lpage><pub-id pub-id-type="doi">10.1152/jn.2000.83.6.3402</pub-id><pub-id pub-id-type="pmid">10848558</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gouwens</surname> <given-names>NW</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Signal propagation in <italic>Drosophila</italic> central neurons</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>6239</fpage><lpage>6249</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0764-09.2009</pub-id><pub-id pub-id-type="pmid">19439602</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname> <given-names>J</given-names></name><name><surname>Adachi</surname> <given-names>A</given-names></name><name><surname>Shah</surname> <given-names>KK</given-names></name><name><surname>Hirokawa</surname> <given-names>JD</given-names></name><name><surname>Magani</surname> <given-names>PS</given-names></name><name><surname>Maimon</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A neural circuit architecture for angular integration in <italic>Drosophila</italic></article-title><source>Nature</source><volume>546</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1038/nature22343</pub-id><pub-id pub-id-type="pmid">28538731</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname> <given-names>J</given-names></name><name><surname>Maimon</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Building a heading signal from anatomically defined neuron types in the <italic>Drosophila</italic> central complex</article-title><source>Current Opinion in Neurobiology</source><volume>52</volume><fpage>156</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2018.06.010</pub-id><pub-id pub-id-type="pmid">30029143</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hadeln</surname> <given-names>J</given-names></name><name><surname>Hensgen</surname> <given-names>R</given-names></name><name><surname>Bockhorst</surname> <given-names>T</given-names></name><name><surname>Rosner</surname> <given-names>R</given-names></name><name><surname>Heidasch</surname> <given-names>R</given-names></name><name><surname>Pegel</surname> <given-names>U</given-names></name><name><surname>Quintero Pérez</surname> <given-names>M</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Neuroarchitecture of the central complex of the desert locust: tangential neurons</article-title><source>Journal of Comparative Neurology</source><volume>528</volume><fpage>906</fpage><lpage>934</lpage><pub-id pub-id-type="doi">10.1002/cne.24796</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Gotthardt</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Transformation of polarized light information in the central complex of the locust</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>11783</fpage><lpage>11793</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1870-09.2009</pub-id><pub-id pub-id-type="pmid">19776265</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Florman</surname> <given-names>J</given-names></name><name><surname>Asokaraj</surname> <given-names>S</given-names></name><name><surname>El Jundi</surname> <given-names>B</given-names></name><name><surname>Reppert</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Anatomical basis of sun compass navigation II: the neuronal composition of the central complex of the monarch butterfly</article-title><source>Journal of Comparative Neurology</source><volume>521</volume><fpage>267</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1002/cne.23214</pub-id><pub-id pub-id-type="pmid">22886450</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Maplike representation of celestial E-vector orientations in the brain of an insect</article-title><source>Science</source><volume>315</volume><fpage>995</fpage><lpage>997</lpage><pub-id pub-id-type="doi">10.1126/science.1135531</pub-id><pub-id pub-id-type="pmid">17303756</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neuroarchitecture of the central complex of the desert locust: intrinsic and columnar neurons</article-title><source>The Journal of Comparative Neurology</source><volume>511</volume><fpage>454</fpage><lpage>478</lpage><pub-id pub-id-type="doi">10.1002/cne.21842</pub-id><pub-id pub-id-type="pmid">18837039</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Linking the input to the output: new sets of neurons complement the polarization vision network in the locust central complex</article-title><source>Journal of Neuroscience</source><volume>29</volume><fpage>4911</fpage><lpage>4921</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0332-09.2009</pub-id><pub-id pub-id-type="pmid">19369560</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Reppert</surname> <given-names>SM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Anatomical basis of sun compass navigation I: the general layout of the monarch butterfly brain</article-title><source>The Journal of Comparative Neurology</source><volume>520</volume><fpage>1599</fpage><lpage>1628</lpage><pub-id pub-id-type="doi">10.1002/cne.23054</pub-id><pub-id pub-id-type="pmid">22473804</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>In search of the sky compass in the insect brain</article-title><source>Naturwissenschaften</source><volume>91</volume><fpage>199</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1007/s00114-004-0525-9</pub-id><pub-id pub-id-type="pmid">15146265</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homberg</surname> <given-names>U</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Kinoshita</surname> <given-names>M</given-names></name><name><surname>el Jundi</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Central neural coding of sky polarization in insects</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>366</volume><fpage>680</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1098/rstb.2010.0199</pub-id><pub-id pub-id-type="pmid">21282171</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sky compass orientation in desert Locusts-Evidence from field and laboratory studies</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>9</volume><elocation-id>346</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2015.00346</pub-id><pub-id pub-id-type="pmid">26733834</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kakaria</surname> <given-names>KS</given-names></name><name><surname>de Bivort</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ring attractor dynamics emerge from a spiking model of the entire protocerebral bridge</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>11</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2017.00008</pub-id><pub-id pub-id-type="pmid">28261066</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>SS</given-names></name><name><surname>Rouault</surname> <given-names>H</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ring attractor dynamics in the <italic>Drosophila</italic> central brain</article-title><source>Science</source><volume>356</volume><fpage>849</fpage><lpage>853</lpage><pub-id pub-id-type="doi">10.1126/science.aal4835</pub-id><pub-id pub-id-type="pmid">28473639</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname> <given-names>CY</given-names></name><name><surname>Chuang</surname> <given-names>CC</given-names></name><name><surname>Hua</surname> <given-names>TE</given-names></name><name><surname>Chen</surname> <given-names>CC</given-names></name><name><surname>Dickson</surname> <given-names>BJ</given-names></name><name><surname>Greenspan</surname> <given-names>RJ</given-names></name><name><surname>Chiang</surname> <given-names>AS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>A comprehensive wiring diagram of the protocerebral bridge for visual information processing in the <italic>Drosophila</italic> brain</article-title><source>Cell Reports</source><volume>3</volume><fpage>1739</fpage><lpage>1753</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2013.04.022</pub-id><pub-id pub-id-type="pmid">23707064</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mittelstaedt</surname> <given-names>M-L</given-names></name><name><surname>Mittelstaedt</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1980">1980</year><article-title>Homing by path integration in a mammal</article-title><source>Naturwissenschaften</source><volume>67</volume><fpage>566</fpage><lpage>567</lpage><pub-id pub-id-type="doi">10.1007/BF00450672</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mouritsen</surname> <given-names>H</given-names></name><name><surname>Frost</surname> <given-names>BJ</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Virtual migration in tethered flying monarch butterflies reveals their orientation mechanisms</article-title><source>PNAS</source><volume>99</volume><fpage>10162</fpage><lpage>10166</lpage><pub-id pub-id-type="doi">10.1073/pnas.152137299</pub-id><pub-id pub-id-type="pmid">12107283</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname> <given-names>M</given-names></name><name><surname>Wehner</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Path integration in desert ants, Cataglyphis fortis</article-title><source>PNAS</source><volume>85</volume><fpage>5287</fpage><lpage>5290</lpage><pub-id pub-id-type="doi">10.1073/pnas.85.14.5287</pub-id><pub-id pub-id-type="pmid">16593958</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname> <given-names>KI</given-names></name><name><surname>Hong</surname> <given-names>EJ</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Synaptic and circuit mechanisms promoting broadband transmission of olfactory stimulus dynamics</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/nn.3895</pub-id><pub-id pub-id-type="pmid">25485755</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neuser</surname> <given-names>K</given-names></name><name><surname>Triphan</surname> <given-names>T</given-names></name><name><surname>Mronz</surname> <given-names>M</given-names></name><name><surname>Poeck</surname> <given-names>B</given-names></name><name><surname>Strauss</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Analysis of a spatial orientation memory in <italic>Drosophila</italic></article-title><source>Nature</source><volume>453</volume><fpage>1244</fpage><lpage>1247</lpage><pub-id pub-id-type="doi">10.1038/nature07003</pub-id><pub-id pub-id-type="pmid">18509336</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ofstad</surname> <given-names>TA</given-names></name><name><surname>Zuker</surname> <given-names>CS</given-names></name><name><surname>Reiser</surname> <given-names>MB</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Visual place learning in <italic>Drosophila melanogaster</italic></article-title><source>Nature</source><volume>474</volume><fpage>204</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1038/nature10131</pub-id><pub-id pub-id-type="pmid">21654803</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pegel</surname> <given-names>U</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integration of celestial compass cues in the central complex of the locust brain</article-title><source>The Journal of Experimental Biology</source><volume>221</volume><elocation-id>jeb171207</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.171207</pub-id><pub-id pub-id-type="pmid">29180600</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pegel</surname> <given-names>U</given-names></name><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Zittrell</surname> <given-names>F</given-names></name><name><surname>Scholtyssek</surname> <given-names>C</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Two compasses in the central complex of the locust brain</article-title><source>The Journal of Neuroscience</source><volume>39</volume><fpage>3070</fpage><lpage>3080</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0940-18.2019</pub-id><pub-id pub-id-type="pmid">30755489</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname> <given-names>K</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Organization and functional roles of the central complex in the insect brain</article-title><source>Annual Review of Entomology</source><volume>59</volume><fpage>165</fpage><lpage>184</lpage><pub-id pub-id-type="doi">10.1146/annurev-ento-011613-162031</pub-id><pub-id pub-id-type="pmid">24160424</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Pisokas</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Code used in Pisokas, Heinze, Webb 2019, Biorxiv and Pisokas, Heinze, Webb (2020), eLife.</data-title><source>GitHub</source><version designator="d8b6baf">d8b6baf</version><ext-link ext-link-type="uri" xlink:href="https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019">https://github.com/johnpi/eLife_Pisokas_Heinze_Webb_2019</ext-link></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Redish</surname> <given-names>AD</given-names></name><name><surname>Elga</surname> <given-names>AN</given-names></name><name><surname>Touretzky</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A coupled attractor model of the rodent head direction system</article-title><source>Network: Computation in Neural Systems</source><volume>7</volume><fpage>671</fpage><lpage>685</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_7_4_004</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rohrbough</surname> <given-names>J</given-names></name><name><surname>Broadie</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Electrophysiological analysis of synaptic transmission in central neurons of <italic>Drosophila</italic> larvae</article-title><source>Journal of Neurophysiology</source><volume>88</volume><fpage>847</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1152/jn.2002.88.2.847</pub-id><pub-id pub-id-type="pmid">12163536</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seelig</surname> <given-names>JD</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural dynamics for landmark orientation and angular path integration</article-title><source>Nature</source><volume>521</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1038/nature14446</pub-id><pub-id pub-id-type="pmid">25971509</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharp</surname> <given-names>PE</given-names></name><name><surname>Blair</surname> <given-names>HT</given-names></name><name><surname>Cho</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>The anatomical and computational basis of the rat head-direction cell signal</article-title><source>Trends in Neurosciences</source><volume>24</volume><fpage>289</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1016/S0166-2236(00)01797-5</pub-id><pub-id pub-id-type="pmid">11311382</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheeba</surname> <given-names>V</given-names></name><name><surname>Gu</surname> <given-names>H</given-names></name><name><surname>Sharma</surname> <given-names>VK</given-names></name><name><surname>O'Dowd</surname> <given-names>DK</given-names></name><name><surname>Holmes</surname> <given-names>TC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Circadian- and light-dependent regulation of resting membrane potential and spontaneous action potential firing of <italic>Drosophila</italic> circadian pacemaker neurons</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>976</fpage><lpage>988</lpage><pub-id pub-id-type="doi">10.1152/jn.00930.2007</pub-id><pub-id pub-id-type="pmid">18077664</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Skaggs</surname> <given-names>WE</given-names></name><name><surname>Knierim</surname> <given-names>JJ</given-names></name><name><surname>Kudrimoti</surname> <given-names>HS</given-names></name><name><surname>McNaughton</surname> <given-names>BL</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A model of the neural basis of the rat’s sense of direction</article-title><conf-name>Advances in Neural Information Processing Systems</conf-name><fpage>173</fpage><lpage>180</lpage></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stackman</surname> <given-names>RW</given-names></name><name><surname>Taube</surname> <given-names>JS</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Firing properties of rat lateral mammillary single units: head direction, head pitch, and angular head velocity</article-title><source>The Journal of Neuroscience</source><volume>18</volume><fpage>9020</fpage><lpage>9037</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.18-21-09020.1998</pub-id><pub-id pub-id-type="pmid">9787007</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname> <given-names>RB</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>Some models of neuronal variability</article-title><source>Biophysical Journal</source><volume>7</volume><fpage>37</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(67)86574-3</pub-id><pub-id pub-id-type="pmid">19210981</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname> <given-names>T</given-names></name><name><surname>Webb</surname> <given-names>B</given-names></name><name><surname>Adden</surname> <given-names>A</given-names></name><name><surname>Weddig</surname> <given-names>NB</given-names></name><name><surname>Honkanen</surname> <given-names>A</given-names></name><name><surname>Templin</surname> <given-names>R</given-names></name><name><surname>Wcislo</surname> <given-names>W</given-names></name><name><surname>Scimeca</surname> <given-names>L</given-names></name><name><surname>Warrant</surname> <given-names>E</given-names></name><name><surname>Heinze</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An anatomically constrained model for path integration in the bee brain</article-title><source>Current Biology</source><volume>27</volume><fpage>3069</fpage><lpage>3085</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.08.052</pub-id><pub-id pub-id-type="pmid">28988858</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stratton</surname> <given-names>P</given-names></name><name><surname>Wyeth</surname> <given-names>G</given-names></name><name><surname>Wiles</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Calibration of the head direction network: a role for symmetric angular head velocity cells</article-title><source>Journal of Computational Neuroscience</source><volume>28</volume><fpage>527</fpage><lpage>538</lpage><pub-id pub-id-type="doi">10.1007/s10827-010-0234-7</pub-id><pub-id pub-id-type="pmid">20354898</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname> <given-names>TS</given-names></name><name><surname>Lee</surname> <given-names>WJ</given-names></name><name><surname>Huang</surname> <given-names>YC</given-names></name><name><surname>Wang</surname> <given-names>CT</given-names></name><name><surname>Lo</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coupled symmetric and asymmetric circuits underlying spatial orientation in fruit flies</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>139</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00191-6</pub-id><pub-id pub-id-type="pmid">28747622</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tammero</surname> <given-names>LF</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>The influence of visual landscape on the free flight behavior of the fruit fly <italic>Drosophila melanogaster</italic></article-title><source>The Journal of Experimental Biology</source><volume>205</volume><fpage>327</fpage><lpage>343</lpage><pub-id pub-id-type="pmid">11854370</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name><name><surname>Muller</surname> <given-names>RU</given-names></name><name><surname>Ranck</surname> <given-names>JB</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Head-direction cells recorded from the postsubiculum in freely moving rats. I. description and quantitative analysis</article-title><source>The Journal of Neuroscience</source><volume>10</volume><fpage>420</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.10-02-00420.1990</pub-id><pub-id pub-id-type="pmid">2303851</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname> <given-names>JS</given-names></name><name><surname>Bassett</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Persistent neural activity in head direction cells</article-title><source>Cerebral Cortex</source><volume>13</volume><fpage>1162</fpage><lpage>1172</lpage><pub-id pub-id-type="doi">10.1093/cercor/bhg102</pub-id><pub-id pub-id-type="pmid">14576208</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Triphan</surname> <given-names>T</given-names></name><name><surname>Poeck</surname> <given-names>B</given-names></name><name><surname>Neuser</surname> <given-names>K</given-names></name><name><surname>Strauss</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Visual targeting of motor actions in climbing <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>20</volume><fpage>663</fpage><lpage>668</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2010.02.055</pub-id><pub-id pub-id-type="pmid">20346674</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner-Evans</surname> <given-names>D</given-names></name><name><surname>Wegener</surname> <given-names>S</given-names></name><name><surname>Rouault</surname> <given-names>H</given-names></name><name><surname>Franconville</surname> <given-names>R</given-names></name><name><surname>Wolff</surname> <given-names>T</given-names></name><name><surname>Seelig</surname> <given-names>JD</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Angular velocity integration in a fly heading circuit</article-title><source>eLife</source><volume>6</volume><elocation-id>e23496</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23496</pub-id><pub-id pub-id-type="pmid">28530551</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Turner-Evans</surname> <given-names>DB</given-names></name><name><surname>Jensen</surname> <given-names>K</given-names></name><name><surname>Ali</surname> <given-names>S</given-names></name><name><surname>Paterson</surname> <given-names>T</given-names></name><name><surname>Sheridan</surname> <given-names>A</given-names></name><name><surname>Ray</surname> <given-names>RP</given-names></name><name><surname>Lauritzen</surname> <given-names>S</given-names></name><name><surname>Bock</surname> <given-names>D</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The neuroanatomical ultrastructure and function of a biological ring attractor</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/847152</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitzthum</surname> <given-names>H</given-names></name><name><surname>Muller</surname> <given-names>M</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Neurons of the central complex of the locust <italic>Schistocerca gregaria</italic> are sensitive to polarized light</article-title><source>The Journal of Neuroscience</source><volume>22</volume><fpage>1114</fpage><lpage>1125</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.22-03-01114.2002</pub-id><pub-id pub-id-type="pmid">11826140</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitzthum</surname> <given-names>H</given-names></name><name><surname>Homberg</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Immunocytochemical demonstration of locustatachykinin-related peptides in the central complex of the locust brain</article-title><source>The Journal of Comparative Neurology</source><volume>390</volume><fpage>455</fpage><lpage>469</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1096-9861(19980126)390:4&lt;455::AID-CNE1&gt;3.0.CO;2-#</pub-id><pub-id pub-id-type="pmid">9450529</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von Frisch</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1967">1967</year><article-title>The dance language and orientation of bees</article-title><source>Science</source><volume>159</volume><fpage>864</fpage><lpage>865</lpage><pub-id pub-id-type="doi">10.1126/science.159.3817.864</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname> <given-names>JLD</given-names></name></person-group><year iso-8601-date="1975">1975</year><article-title>Anatomical studies of the insect central nervous system: a ground-plan of the midbrain and an introduction to the central complex in the Locust, Schistocerca gregaria (Orthoptera)</article-title><source>Journal of Zoology</source><volume>176</volume><fpage>67</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1111/j.1469-7998.1975.tb03188.x</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolff</surname> <given-names>T</given-names></name><name><surname>Iyer</surname> <given-names>NA</given-names></name><name><surname>Rubin</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neuroarchitecture and neuroanatomy of the <italic>Drosophila</italic> central complex: a GAL4-based dissection of protocerebral bridge neurons and circuits</article-title><source>Journal of Comparative Neurology</source><volume>523</volume><fpage>997</fpage><lpage>1037</lpage><pub-id pub-id-type="doi">10.1002/cne.23705</pub-id><pub-id pub-id-type="pmid">25380328</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolff</surname> <given-names>T</given-names></name><name><surname>Rubin</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Neuroarchitecture of the <italic>Drosophila</italic> central complex: a catalog of Nodulus and asymmetrical body neurons and a revision of the protocerebral bridge catalog</article-title><source>Journal of Comparative Neurology</source><volume>526</volume><fpage>2585</fpage><lpage>2611</lpage><pub-id pub-id-type="doi">10.1002/cne.24512</pub-id><pub-id pub-id-type="pmid">30084503</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname> <given-names>JM</given-names></name><name><surname>Armstrong</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Structure of the adult central complex in <italic>Drosophila</italic>: organization of distinct neuronal subsets</article-title><source>The Journal of Comparative Neurology</source><volume>518</volume><fpage>1500</fpage><lpage>1524</lpage><pub-id pub-id-type="doi">10.1002/cne.22284</pub-id><pub-id pub-id-type="pmid">20187142</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53985.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>O'Leary</surname><given-names>Timothy</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>de Bivort</surname><given-names>Benjamin L</given-names></name><role>Reviewer</role><aff><institution>Harvard University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>This study disentangles navigational circuitry in the central complex of locusts, showing that the effective connectivity exhibits a ring-like structure that encodes head direction. Importantly, such circuit structure resembles that of another insect species, <italic>Drosophila</italic>, with a key difference in the profile of recurrent and inhibitory connections. Simulations show how these differences in connectivity may navigate a tradeoff between the stability and responsiveness of head direction encoding that is tuned to the motor behaviour of each species.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;The head direction circuit of two insect species&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Ronald Calabrese as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Benjamin L de Bivort (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This study uses existing quantitative neuroanatomy data in <italic>Drosophila</italic> and locust to construct a connectivity matrix of the presumptive ring attractor circuit used in navigation. Using a simplification of the connectivity the authors show a “hidden” ring attractor in the locust that has a distinct connectivity profile from <italic>Drosophila</italic>. Using simulations the authors examine the consequences of the different connectivity in each species and conclude that the locust has a more robust internal representation of heading, with possible ethological consequences.</p><p>Essential revisions:</p><p>1) Reviewers were concerned about a lack of detail and possible ambiguity in how the reduced/effective connectivity diagrams are obtained. The authors should revise the diagrams and accompanying text, providing additional explanatory figures if necessary.</p><p>2) Conclusions are based on the contribution of connectivity to dynamics alone, yet the choice of modelling detail is inconsistent. The authors should show that the most parsimonious assumptions (e.g. rate-based models) corroborate the results and include robustness analysis of the more “detailed” simulations. Statements about the biological realism should be appropriately edited.</p><p><italic>Reviewer #1:</italic></p><p>Summary:</p><p>This work uses existing quantitative neuroanatomy data in <italic>Drosophila</italic> and locust to construct a connectivity matrix of the presumptive ring attractor circuit used in navigation. They show using an elegant topological analysis that there is a “hidden” ring attractor in the locust that has a distinct connectivity profile. Using integrate and fire based simulations the authors examine the consequences of the different connectivity in each species and conclude that the locust has a more robust internal representation of heading, with possible ethological consequences. The manuscript is beautifully presented and highly relevant, however there are unfortunate and gravely misleading statements about the assumptions in the model that need to be addressed. A final, positive attribute of the work is an important broad message that cautions against drawing overly general conclusions from the details of a heavily studied model system, something the community urgently needs to be reminded of. If the substantive concerns can be addressed the manuscript could make a valuable contribution to systems/circuit neuroscience.</p><p>Major comments:</p><p>1) The conclusions of this study rest on the assumption that all of the neuronal properties in both circuits are identical and conform to simple integrate and fire dynamics with a linear membrane. This is almost certainly false but little to no mention is made of the “potential consequences” of this assumption. No attempt has been made to test the sensitivity of the conclusions to this assumption, even though this is possible without resorting to “multicompartmental models”. The only acknowledgement of this is made in the Discussion which simply asserts that this is essentially a technical simulation detail that would not add “tangible gains”. Worse still, the authors claim elsewhere that the model “uses realistic biophysical properties”. The point extends beyond heterogeneity and it is a little painful to have to remind the authors of how false their statement is; the writing indicates they are almost certainly aware of this. Intrinsic properties alone can provide short term memory that would radically alter the responsiveness of a circuit and there are thousands of neurophysiological studies that make this very clear. The manuscript could have been written in a more scientifically honest and circumspect way, pointing out these issues without necessarily exhaustively addressing all of them. Instead, unfortunately, the authors have chosen to mislead their readers. This makes the manuscript unpublishable in its present form.</p><p>2) The optimization algorithm and the results obtained from it are inadequately described and validated. There are many ways of using particle swarm optimisation, for example, and there are initial values/distributions/search limits that affect the results. None of this is described. Making code available is not a substitute.</p><p>3) The choice of detail in the modelling is a little bizarre. On one hand, it is clear that this is an abstract model, placing synaptic connectivity above all else. This would suggest a rate based model. Instead, integrate and fire models are used that have additional parameters as well as a highly detailed spike waveform inserted in place of a spike event. This is a cosmetic feature that only obscures the results. Do any of the conclusions depend on these decisions, and if not, why were these decisions made? Again, this decision unfortunately looks like an attempt to convince the reader of biophysical realism in a trivial and inconsequential way, while ducking the substantive issues.</p><p>4) I suggest the authors build up their modelling approach from a truly minimal (e.g. rate based) case, proceeding to details like spiking and proper heterogeneity. This would allow readers to get some sense of which details “may” actually matter. The manuscript should also be more scientifically honest about the limitations of the study because these are necessary given available data and tractability. The manuscript would actually be stronger if this were made clear.</p><p><italic>Reviewer #2:</italic></p><p>The authors simulated models based on the circuit's structure of the CX of the fruit fly and of the locust while optimizing free parameters, and demonstrated a yielded trade-off in functionality between the two models: faster respond to changes in fruit fly circuit vs higher tolerance to noise in locust circuit.</p><p>The scientific significance of the work may be debated, but I find the manuscript unclear.</p><p>Figure 1:</p><p>Panels G-H are too small, which makes them almost unreadable.</p><p>Make horizontal and vertical lines to separate the different groups (P-EN/P-EG/E-PG/Delta7)</p><p>Number the ticks within each group to indicate the order of the glomeruli (might have been either 1-2-3-….-9-1-2-…-9 or 1-1-2-2-3-3….9-9).</p><p>The gray/black bars that indicate borders between groups in panel 1G seem to be a bit off (between P-EN and P-EG, and between E-PG and Delta7 -both in x and y axes).</p><p>It is unclear what the extra two empty rows/columns at Delta7 mean. Maybe I am missing something, so please explain it explicitly in the figure legend.</p><p>There seem be several mistakes in the connectivity description as given in panels 1G-H, it is hard to be sure given the notation of the matrices (order of glomeruli) are unclear.</p><p>Figure 3:</p><p>It is unclear what additional information panel D provides given panel A, and similarly what additional information panel E provides given panel B.</p><p>In panel F, P-EG are not numbered.</p><p>Although in practice there is no difference between the pattern of connectivity from E-PG to P-EN and the pattern of connectivity from E-PG to P-EG, in principle there could have been. Therefore I suggest that the two patterns will be indicated in two separate panels.</p><p>I understand the attempt for simplicity, nevertheless I suggest making the illustration in panel F much larger, and separate each note in the graph into two (the two glomeruli of each ordinal number). I believe that the 8-fold symmetry can be still appreciated by the reader, on top of allowing a clearer description of the circuit connectivity. (It is perfectly fine to exclude in this illustration the 9th glomerulus for simplicity, and indicate the pattern of its connections in a supplementary figure, as currently done).</p><p>Figure 4:</p><p>Same comments as given for Figure 3.</p><p>Maybe I am missing something about the notations but there seem to be several discrepancies between panels A-E and panel F. For example: given panel A there should be an arrow from yellow node 5 to green node 6, given panel B there should not be an arrow from green node 5 to yellow node 4, given panel C there should be an arrow from orange node (5) to yellow node 6, and given panel D there should be an arrow from yellow node 6 to orange node (5).</p><p>Figure 5:</p><p>The illustration is not accurate since each E-PG is shown to send its output only to one Delta7. In case it is too hard to illustrate the connectivity form E-PG to Delta7, authors may exclude E-PG from this illustration altogether. Additionally, as only the connections from Delta7 1 to other Delta7 are shown in black and the connections from the rest of Delta7 are shown in gray -I suggest making also only the connections from Delta7 1 to the relevant P-EG and P-EN in black and the connections from the rest of Delta7 in gray (for consistency).</p><p>Figure 10:</p><p>The mean bump azimuth for stimulus 7/4 π seem not to 7/4 pi. Is it indeed the case? If yes, then why?</p><p>Overall, the bump azimuth seems to be biased toward smaller angle than stimulus azimuth (and given that, I am surprised not to see any cases of bump azimuth 7/4 π for stimulus azimuth 0).</p><p>&quot;We next investigated the fixed points of each ring attractor… circuits had eight discrete attractor states&quot;, in this case these are not ring attractors.</p><p><italic>Reviewer #3:</italic></p><p>In this manuscript, Pisokas et al. consider a neural circuit that is conserved across insect species: the reciprocal connections between the protocerebral bridge and ellipsoid body. There is evidence this circuit supports goal-directed navigation in several species. Using neuroanatomical data from locust and fruit flies, the authors simulate the dynamics of this circuit in each species. There are three major conclusions. First, the connectivity of the locust circuit has the potential to implement a ring-attractor. Second, the simulated dynamics in the locust model reiterate the qualitative physiological results consistent with a ring-attractor. Third, in a comparative analysis, the authors determine that differences between the locust and fly circuits (different presynaptic extents in inhibitory PB neurons and reciprocal connections between P-ENs and E-PGs in the locust) render the locust spatial dynamics more stable, but also slower to respond to stimulus changes. The authors speculate that these differences may relate to differences in the ethology of the species. The comparative circuit dynamics approach is innovative and interesting, and this may be an early example of a technique that becomes increasingly valuable and prevalent as more connectomic data is produced in non-model species.</p><p>The authors do a persuasive job of justifying these conclusions. The conclusions are relatively mild in their ambitions, and there are ways to restructure this approach that might offer more in terms of substantive conclusions and less of a feeling of a rather ad hoc, piecewise analysis. For example, the authors could delineate ~6 circuits: fly, locust, hybrid, locust without PEGs, fly without PEGs, hybrid without PEGs, as the rows of a matrix, in which the columns are analyses, bump movement speed, rate of change, number of locations, stability etc. If that's too much for a table, then the core figures could have the same panel arrangement of the same ~6 (or how many ever) circuit configurations. This is just an idea, and might be outside the scope of revisions because the authors have achieved their stated goal of those three main conclusions.</p><p>As for presentation, the figures are generally clear. The text is a bit wordy, but it makes it more palateable to get through all the neuroanatomical jargon. There are a fair number of typos/grammatical issues as indicated below. We almost certainly did not catch them all, so the authors will have to do careful editing. Because the writing is not super dense, the typos did not really interfere with understanding.</p><p>Note: This review was done by a π and grad student in the same lab, so it's long because it’s the consensus of both reviews. We did not find any major concerns that would call into question the major conclusions.</p><p>More substantive concerns:</p><p>– Clearer definitions of ring attractor would be helpful early on. What are the requirements in neuroanatomy for a circuit to have the structure of a ring-attractor. What are the requirements in physiological dynamics and stimulus response for the behavior of a circuit to be consistent with a ring attractor? Operational definitions would be particularly valuable because the authors frame their investigation as a test of the existence of such properties in the circuitry.</p><p>– More needs to be said in the Results section about the synapse strength parameterization. What was the cost function for this optimization, etc. Even in the Materials and methods section, this is covered rather briefly.</p><p>– The hybrid model is good, but the authors might consider titrating the number of glomeruli with postsynaptic sites in the Delta7 neurons from 3 to 7, and show the response in stimulus shift + other &quot;ring attractor&quot; behaviors. This is not necessary to the conclusions they present, but would be interesting from a theoretical perspective and there may be other species with morphologies like that.</p><p>– Unclear why 9th glomerulus in fly is okay to exclude from Figure 3.</p><p>– We wondered if the wraparound of the 8th tile to the 1st tile in locust is justified. If E-PG5 innervates tiles T5 and T6 and glomeruli G5 of the PB, would E-PG8 innervate the right-most wedges of Figure 4, i.e. T8 and T1? Then, as P-EN5 innervates tiles T5 and T6, does P-EN8 innervate T8 and both half-tiles of T1 on opposite sides of the crescent?</p><p>– Please make clear how the effective circuits are different from the full connectivity matrices, is the former simplified to give intuition? Are there reasons for reducing the real connectivity matrix to the effective matrix other than computational simplicity?</p><p>– Why was the test of the role of P-EGs done by an interhemispheric mismatch? (Also, what does this mean, since the CX is on the midline.) Simply removing that population from the simulation would seem more in line with how other hypotheses were tested.</p><p>– The discussion on the closed ring shape of the Dipteran EB confused me. The physical shape doesn't matter much (other than in timing details) if the network connectivity is the same? Why would the closure of the physical ring matter for P-EN to E-PG connectivity, except at the suture, and if it's only there that it might matter, the text needs to say this.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53985.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Reviewers were concerned about a lack of detail and possible ambiguity in how the reduced/effective connectivity diagrams are obtained. The authors should revise the diagrams and accompanying text, providing additional explanatory figures if necessary.</p></disp-quote><p>We have clarified the derivation of the ‘effective connectivity’ diagrams with substantially revised Figures 3 and 4 that show step-by-step the reasoning that reveals the effective circuits and have expanded the relevant text accordingly. The revised figures consist of pairs of panels, one showing the neuronal projection pattern and the other the effective connection in a directed graph. We have also clarified that our simulations use the full circuits not the reduced circuits.</p><disp-quote content-type="editor-comment"><p>2) Conclusions are based on the contribution of connectivity to dynamics alone, yet the choice of modelling detail is inconsistent. The authors should show that the most parsimonious assumptions (e.g. rate-based models) corroborate the results and include robustness analysis of the more “detailed” simulations. Statements about the biological realism should be appropriately edited.</p></disp-quote><p>We have confirmed that the key difference between the circuits – sudden activity bump transition versus gradual transition – can be reproduced using rate-based simulations (Figure 7—figure supplement 1), and thus is not dependent on specific assumptions made in the spiking model. We have also expanded the robustness analysis, running simulations with heterogeneous neuronal membrane parameters (membrane conductance and capacitance) as well as random noise on all synaptic weights (updated Figure 11, new Figure 12 and Figure 12—figure supplement 1) and reporting the percentage of trials that produce a bump that follows the stimulus heading as the parameter variance is increased. This shows that our results do not depend on precise tuning of the parameter values or on them having the same value across all units. We have tried to adapt our description of the modelling to be appropriately cautious about the limits on biological realism.</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>Summary:</p><p>This work uses existing quantitative neuroanatomy data in <italic>Drosophila</italic> and locust to construct a connectivity matrix of the presumptive ring attractor circuit used in navigation. They show using an elegant topological analysis that there is a “hidden” ring attractor in the locust that has a distinct connectivity profile. Using integrate and fire based simulations the authors examine the consequences of the different connectivity in each species and conclude that the locust has a more robust internal representation of heading, with possible ethological consequences. The manuscript is beautifully presented and highly relevant, however there are unfortunate and gravely misleading statements about the assumptions in the model that need to be addressed. A final, positive attribute of the work is an important broad message that cautions against drawing overly general conclusions from the details of a heavily studied model system, something the community urgently needs to be reminded of. If the substantive concerns can be addressed the manuscript could make a valuable contribution to systems/circuit neuroscience.</p><p>Major comments:</p><p>1) The conclusions of this study rest on the assumption that all of the neuronal properties in both circuits are identical and conform to simple integrate and fire dynamics with a linear membrane. This is almost certainly false but little to no mention is made of the “potential consequences” of this assumption. No attempt has been made to test the sensitivity of the conclusions to this assumption, even though this is possible without resorting to “multicompartmental models”. The only acknowledgement of this is made in the Discussion which simply asserts that this is essentially a technical simulation detail that would not add “tangible gains”. Worse still, the authors claim elsewhere that the model “uses realistic biophysical properties”. The point extends beyond heterogeneity and it is a little painful to have to remind the authors of how false their statement is; the writing indicates they are almost certainly aware of this. Intrinsic properties alone can provide short term memory that would radically alter the responsiveness of a circuit and there are thousands of neurophysiological studies that make this very clear. The manuscript could have been written in a more scientifically honest and circumspect way, pointing out these issues without necessarily exhaustively addressing all of them. Instead, unfortunately, the authors have chosen to mislead their readers. This makes the manuscript unpublishable in its present form.</p></disp-quote><p>It was not our intent to mislead our readers, but we accept that the previous version of the paper did not sufficiently discuss or explore the extent to which the results could be dependent on the choice of integrate and fire units as the basis for the modelling. We have addressed this in several ways in the revision. First, we have confirmed that the key difference between the circuits – sudden activity bump transition versus gradual transition – can be reproduced using rate-based simulations (Figure 7—figure supplement 1), and thus is not dependent on specific assumptions made in the spiking model. Second, we have expanded the robustness analysis, running simulations with heterogeneous neuronal membrane parameters (membrane conductance and capacitance) as well as random noise on all synaptic weights (updated figure 11, new figure 12 and Figure 12—figure supplement 1). This shows that our results do not depend on precise tuning of the parameter values or on them having the same value across all units. We have avoided any use of the term ‘realistic’ and extended our discussion of these issues in the Discussion section ‘Biophysical Assumptions’, including consideration of the possible effect of intrinsic short term neural memory.</p><disp-quote content-type="editor-comment"><p>2) The optimization algorithm and the results obtained from it are inadequately described and validated. There are many ways of using particle swarm optimisation, for example, and there are initial values/distributions/search limits that affect the results. None of this is described. Making code available is not a substitute.</p></disp-quote><p>We apologise for this omission and have now included full details of the algorithms, optimization parameters and objective function used in the Materials and methods.</p><disp-quote content-type="editor-comment"><p>3) The choice of detail in the modelling is a little bizarre. On one hand, it is clear that this is an abstract model, placing synaptic connectivity above all else. This would suggest a rate based model. Instead, integrate and fire models are used that have additional parameters as well as a highly detailed spike waveform inserted in place of a spike event. This is a cosmetic feature that only obscures the results. Do any of the conclusions depend on these decisions, and if not, why were these decisions made? Again, this decision unfortunately looks like an attempt to convince the reader of biophysical realism in a trivial and inconsequential way, while ducking the substantive issues.</p></disp-quote><p>The choice of model detail was motivated principally by the intent to build on the model of Kakaria and de Bivort, 2017, with the explicit inclusion of anatomical connectivity details that differ from their model, but without altering any other details such as the use of a spike waveform (as a convenient technique to not only signify the action potential event but also to produce a refractory period where no further action potentials can be inserted). We chose to use spiking models in order to investigate the possible effects of spike timing interaction given the substantially recurrent structure of the circuits. Rate based models would have obscured any such interactions. The use of spiking neurons is our first step in including more biological detail once it becomes available. We have now verified that the main conclusions still hold for rate-based models, and include discussion of this point in the manuscript.</p><disp-quote content-type="editor-comment"><p>4) I suggest the authors build up their modelling approach from a truly minimal (e.g. rate based) case, proceeding to details like spiking and proper heterogeneity. This would allow readers to get some sense of which details “may” actually matter. The manuscript should also be more scientifically honest about the limitations of the study because these are necessary given available data and tractability. The manuscript would actually be stronger if this were made clear.</p></disp-quote><p>As noted, we have added simulations for both the spiking and rate based implementations of the models for both fruit fly and locust. This illustrates that the difference between sudden activity bump transition versus gradual transition is also holding for the rate based models. These are shown on Figure 7—figure supplement 1, and mentioned at the appropriate part of the manuscript to emphasise that the effects appear to be a property of the connectivity. We have added exploration of the effects of increased heterogeneity in neuronal and synaptic parameters, showing that the conclusions remain robust to significant variation.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>The authors simulated models based on the circuit's structure of the CX of the fruit fly and of the locust while optimizing free parameters, and demonstrated a yielded trade-off in functionality between the two models: faster respond to changes in fruit fly circuit vs higher tolerance to noise in locust circuit.</p><p>The scientific significance of the work may be debated, but I find the manuscript unclear.</p><p>Figure 1:</p><p>Panels G-H are too small, which makes them almost unreadable.</p><p>Make horizontal and vertical lines to separate the different groups (P-EN/P-EG/E-PG/Delta7)</p><p>Number the ticks within each group to indicate the order of the glomeruli (might have been either 1-2-3-….-9-1-2-…-9 or 1-1-2-2-3-3….9-9).</p><p>The gray/black bars that indicate borders between groups in panel 1G seem to be a bit off (between P-EN and P-EG, and between E-PG and Delta7 -both in x and y axes).</p><p>It is unclear what the extra two empty rows/columns at Delta7 mean. Maybe I am missing something, so please explain it explicitly in the figure legend.</p><p>There seem be several mistakes in the connectivity description as given in panels 1G-H, it is hard to be sure given the notation of the matrices (order of glomeruli) are unclear.</p></disp-quote><p>We moved the connectivity matrices to a separate supplementary figure to allow them to be magnified and be more clearly visible.</p><p>The different groups of neurons are now marked with bars and labels.</p><p>Numbering was added to the ticks of the connectivity matrices to indicate the order of neurons.</p><p>Bars indicating grouping of neuron types were adjusted to match the borders.</p><p>The two empty rows/columns were removed from the connectivity matrices.</p><p>The connectivity matrices (panels G and H) were enlarged and moved to a separate supplementary figure to make the details more visible and the added numerical labeling should now aid understanding.</p><disp-quote content-type="editor-comment"><p>Figure 3:</p><p>It is unclear what additional information panel D provides given panel A, and similarly what additional information panel E provides given panel B.</p><p>In panel F, P-EG are not numbered.</p><p>Although in practice there is no difference between the pattern of connectivity from E-PG to P-EN and the pattern of connectivity from E-PG to P-EG, in principle there could have been. Therefore I suggest that the two patterns will be indicated in two separate panels.</p><p>I understand the attempt for simplicity, nevertheless I suggest making the illustration in panel F much larger, and separate each note in the graph into two (the two glomeruli of each ordinal number). I believe that the 8-fold symmetry can be still appreciated by the reader, on top of allowing a clearer description of the circuit connectivity. (It is perfectly fine to exclude in this illustration the 9th glomerulus for simplicity, and indicate the pattern of its connections in a supplementary figure, as currently done).</p></disp-quote><p>We replaced the figure with an improved version with additional panels explaining the derivation of the effective circuits step by step. This includes separate panels for E-PG and P-EG neurons. Panels D and E were moved to a supplementary figure and replaced with panels showing the connectivity at the edges of the PB which are more helpful for explaining connectivity. Neuron numbering was added in all panels for consistency. All neurons are now numbered, including in panel F. The labeling in the network graphs was updated to more clearly explain what happens to the 9th glomerulus and we labeled the corresponding neurons as “1&amp;9” in the derived circuit to make things clearer for the reader.</p><disp-quote content-type="editor-comment"><p>Figure 4:</p><p>Same comments as given for Figure 3.</p><p>Maybe I am missing something about the notations but there seem to be several discrepancies between panels A-E and panel F. For example: given panel A there should be an arrow from yellow node 5 to green node 6, given panel B there should not be an arrow from green node 5 to yellow node 4, given panel C there should be an arrow from orange node (5) to yellow node 6, and given panel D there should be an arrow from yellow node 6 to orange node (5).</p></disp-quote><p>Similarly to Figure 3, we overhauled Figure 4 with an improved version to help explain the derivation of the effective circuits more clearly. Panels were inserted to illustrate the derivation of the effective circuit step by step and panel F is now two panels one with the full circuit and another showing the detail of the ring closing. We believe this supersedes the specific points made above.</p><disp-quote content-type="editor-comment"><p>Figure 5:</p><p>The illustration is not accurate since each E-PG is shown to send its output only to one Delta7. In case it is too hard to illustrate the connectivity form E-PG to Delta7, authors may exclude E-PG from this illustration altogether. Additionally, as only the connections from Delta7 1 to other Delta7 are shown in black and the connections from the rest of Delta7 are shown in gray -I suggest making also only the connections from Delta7 1 to the relevant P-EG and P-EN in black and the connections from the rest of Delta7 in gray (for consistency).</p></disp-quote><p>Since illustrating accurately the whole connectivity in a single image results in a very cluttered image, we separated the illustration to three images for each animal, which depict the connectivity patterns more accurately.</p><disp-quote content-type="editor-comment"><p>Figure 10:</p><p>The mean bump azimuth for stimulus 7/4 π seem not to 7/4 pi. Is it indeed the case? If yes, then why?</p><p>Overall, the bump azimuth seems to be biased toward smaller angle than stimulus azimuth (and given that, I am surprised not to see any cases of bump azimuth 7/4 π for stimulus azimuth 0).</p></disp-quote><p>We fixed plots C and D (now relabeled as A and B), the mapping of tiles to angles along the y axis was indeed incorrect.</p><disp-quote content-type="editor-comment"><p>&quot;We next investigated the fixed points of each ring attractor… circuits had eight discrete attractor states&quot;, in this case these are not ring attractors.</p></disp-quote><p>We updated this paragraph to clarify that even though the two circuits structurally form rings, they have a finite number of neurons and thus are discrete approximations of ring attractors. While the circuits are driven by stimulus, the activity bump can smoothly move to any location around the ring and the activity could be decoded by downstream neuronal circuitry as a continuous azimuth value. We therefore use the term “ring attractor” in this sense for simplicity.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>In this manuscript, Pisokas et al. consider a neural circuit that is conserved across insect species: the reciprocal connections between the protocerebral bridge and ellipsoid body. There is evidence this circuit supports goal-directed navigation in several species. Using neuroanatomical data from locust and fruit flies, the authors simulate the dynamics of this circuit in each species. There are three major conclusions. First, the connectivity of the locust circuit has the potential to implement a ring-attractor. Second, the simulated dynamics in the locust model reiterate the qualitative physiological results consistent with a ring-attractor. Third, in a comparative analysis, the authors determine that differences between the locust and fly circuits (different presynaptic extents in inhibitory PB neurons and reciprocal connections between P-ENs and E-PGs in the locust) render the locust spatial dynamics more stable, but also slower to respond to stimulus changes. The authors speculate that these differences may relate to differences in the ethology of the species. The comparative circuit dynamics approach is innovative and interesting, and this may be an early example of a technique that becomes increasingly valuable and prevalent as more connectomic data is produced in non-model species.</p><p>The authors do a persuasive job of justifying these conclusions. The conclusions are relatively mild in their ambitions, and there are ways to restructure this approach that might offer more in terms of substantive conclusions and less of a feeling of a rather ad hoc, piecewise analysis. For example, the authors could delineate ~6 circuits: fly, locust, hybrid, locust without PEGs, fly without PEGs, hybrid without PEGs, as the rows of a matrix, in which the columns are analyses, bump movement speed, rate of change, number of locations, stability etc. If that's too much for a table, then the core figures could have the same panel arrangement of the same ~6 (or how many ever) circuit configurations. This is just an idea, and might be outside the scope of revisions because the authors have achieved their stated goal of those three main conclusions.</p></disp-quote><p>This is an interesting idea, but we do feel (as the reviewer suggests) that this ‘is outside the scope of revisions’: optimising the parameters and running the simulations for all possible combinations would take significant time without (we believe) significantly adding to the substantive conclusions made in the paper. We have however added some additional combinations (e.g. the locust model with/without PEGs) where this helps to substantiate the core arguments.</p><disp-quote content-type="editor-comment"><p>As for presentation, the figures are generally clear. The text is a bit wordy, but it makes it more palateable to get through all the neuroanatomical jargon. There are a fair number of typos/grammatical issues as indicated below. We almost certainly did not catch them all, so the authors will have to do careful editing. Because the writing is not super dense, the typos did not really interfere with understanding.</p></disp-quote><p>Grammar and language was corrected in multiple places throughout the manuscript. All the changes made can be seen in the submitted document with tracked changes.</p><disp-quote content-type="editor-comment"><p>Note: This review was done by a π and grad student in the same lab, so it's long because its the consensus of both reviews. We did not find any major concerns that would call into question the major conclusions.</p></disp-quote><p>Thank you, we have tried to address all the concerns and comments as detailed below.</p><disp-quote content-type="editor-comment"><p>More substantive concerns:</p><p>– Clearer definitions of ring attractor would be helpful early on. What are the requirements in neuroanatomy for a circuit to have the structure of a ring-attractor. What are the requirements in physiological dynamics and stimulus response for the behavior of a circuit to be consistent with a ring attractor? Operational definitions would be particularly valuable because the authors frame their investigation as a test of the existence of such properties in the circuitry.</p></disp-quote><p>We added a more explicit outline of the expected dynamics and neuroanatomical features of a ring attractor in the Introduction.</p><disp-quote content-type="editor-comment"><p>– More needs to be said in the Results section about the synapse strength parameterization. What was the cost function for this optimization, etc. Even in the Materials and methods section, this is covered rather briefly.</p></disp-quote><p>We apologise for this omission, we have now included full details of the optimization algorithms, parameters and objective function used in the Materials and methods section.</p><disp-quote content-type="editor-comment"><p>– The hybrid model is good, but the authors might consider titrating the number of glomeruli with postsynaptic sites in the Delta7 neurons from 3 to 7, and show the response in stimulus shift + other &quot;ring attractor&quot; behaviors. This is not necessary to the conclusions they present, but would be interesting from a theoretical perspective and there may be other species with morphologies like that.</p></disp-quote><p>If we have understood the reviewer correctly, this suggestion is essentially equivalent to the analysis we perform in the section ‘Effects of varying the uniformity of inhibition’, where we model the inhibitory synaptic strength across the PB with two Gaussians, and systematically vary the width (σ) (Figure 9). We have tried to clarify this in the text.</p><disp-quote content-type="editor-comment"><p>– Unclear why 9th glomerulus in fly is okay to exclude from Figure 3.</p></disp-quote><p>We have updated Figure 3 and the corresponding text to more clearly explain what happens to the 9th glomerulus, and also label the corresponding neurons as “1&amp;9” in the derived circuit in Figure 3 to make things clearer and assist the reader.</p><disp-quote content-type="editor-comment"><p>– We wondered if the wraparound of the 8th tile to the 1st tile in locust is justified. If E-PG5 innervates tiles T5 and T6 and glomeruli G5 of the PB, would E-PG8 innervate the right-most wedges of Figure 4, i.e. T8 and T1? Then, as P-EN5 innervates tiles T5 and T6, does P-EN8 innervate T8 and both half-tiles of T1 on opposite sides of the crescent?</p></disp-quote><p>We thank the reviewer for bringing to our attention that this aspect was not adequately explained. We have significantly updated Figure 4 and the corresponding text to more clearly explain how the wraparound from the 8th to the 1st tile is justified.</p><disp-quote content-type="editor-comment"><p>– Please make clear how the effective circuits are different from the full connectivity matrices, is the former simplified to give intuition? Are there reasons for reducing the real connectivity matrix to the effective matrix other than computational simplicity?</p></disp-quote><p>The derivation of the effective circuit is performed to gain intuition in the circuit functional structure and to facilitate comparisons between species with different anatomy. Note that for all the results shown in this manuscript we are simulating the whole connectivity matrix not the simplified circuit. We have updated the text to clarify this.</p><disp-quote content-type="editor-comment"><p>– Why was the test of the role of P-EGs done by an interhemispheric mismatch? (Also, what does this mean, since the CX is on the midline.) Simply removing that population from the simulation would seem more in line with how other hypotheses were tested.</p></disp-quote><p>The effect of removing the whole population of P-EG neurons is shown in Figure 11. The interhemispheric mismatch test is an extra test done in addition to the typical white Gaussian noise sensitivity tests to validate our hypothesis that the presence of P-EG neurons renders the circuits more tolerant to synaptic efficacy asymmetries between the two hemispheres which could result in the activity bump drifting and rotating around the ring.</p><disp-quote content-type="editor-comment"><p>– The discussion on the closed ring shape of the Dipteran EB confused me. The physical shape doesn't matter much (other than in timing details) if the network connectivity is the same? Why would the closure of the physical ring matter for P-EN to E-PG connectivity, except at the suture, and if it's only there that it might matter, the text needs to say this.</p></disp-quote><p>As suggested by the reviewer, timing is likely one of the issues that might be different. We updated the relevant paragraph to more clearly explain this. A recent preprint by Vivek Jayaraman’s lab indeed reports the existence of reciprocal connections between P-EN and E-PG cells within the EB of the fruit fly, a connection that is not yet functionally understood, but which is only possible for each pair of P-EN/E-PG neuron around the ring, if the EB ring is indeed closed, and which might facilitate direct recurrence in close spatial proximity (i.e. a very fast connection).</p><p>We further expanded the paragraph to additionally contrast the solution of the two species in closing the ring circuit, i.e. physically closed EB ring in the fruit fly versus neurons cross-innervating the medial glomeruli (across the midline) in the PB in the locust.</p></body></sub-article></article>