<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">84167</article-id><article-id pub-id-type="doi">10.7554/eLife.84167</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Epidemiology and Global Health</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>Rapid geographical source attribution of <italic>Salmonella enterica</italic> serovar Enteritidis genomes using hierarchical machine learning</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-295585"><name><surname>Bayliss</surname><given-names>Sion C</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5997-2002</contrib-id><email>s.bayliss@bristol.ac.uk</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-297605"><name><surname>Locke</surname><given-names>Rebecca K</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-295587"><name><surname>Jenkins</surname><given-names>Claire</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295588"><name><surname>Chattaway</surname><given-names>Marie Anne</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-295589"><name><surname>Dallman</surname><given-names>Timothy J</given-names></name><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-295590"><name><surname>Cowley</surname><given-names>Lauren A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0835-7971</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0524sp257</institution-id><institution>Bristol Veterinary School, University of Bristol</institution></institution-wrap><addr-line><named-content content-type="city">Bristol</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/002h8g185</institution-id><institution>Milner Centre for Evolution, Life Sciences Department, University of Bath</institution></institution-wrap><addr-line><named-content content-type="city">Bath</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04v54gj93</institution-id><institution>Genomic Laboratory Hub (GLH), Addenbrooke’s Hospital, Cambridge University Hospitals NHS Foundation Trust</institution></institution-wrap><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/018h10037</institution-id><institution>Gastrointestinal Reference Services, UK Health Security Agency</institution></institution-wrap><addr-line><named-content content-type="city">London</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04pp8hn57</institution-id><institution>Institute for Risk Assessment Sciences, Utrecht University</institution></institution-wrap><addr-line><named-content content-type="city">Utrecht</named-content></addr-line><country>Netherlands</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cooper</surname><given-names>Ben S</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Ferguson</surname><given-names>Neil M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>12</day><month>04</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e84167</elocation-id><history><date date-type="received" iso-8601-date="2022-10-13"><day>13</day><month>10</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-04-02"><day>02</day><month>04</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-08-25"><day>25</day><month>08</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.08.23.22279111"/></event></pub-history><permissions><copyright-statement>© 2023, Bayliss et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Bayliss et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-84167-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-84167-figures-v2.pdf"/><abstract><p><italic>Salmonella enterica</italic> serovar Enteritidis is one of the most frequent causes of Salmonellosis globally and is commonly transmitted from animals to humans by the consumption of contaminated foodstuffs. In the UK and many other countries in the Global North, a significant proportion of cases are caused by the consumption of imported food products or contracted during foreign travel, therefore, making the rapid identification of the geographical source of new infections a requirement for robust public health outbreak investigations. Herein, we detail the development and application of a hierarchical machine learning model to rapidly identify and trace the geographical source of <italic>S.</italic> Enteritidis infections from whole genome sequencing data. 2313 <italic>S.</italic> Enteritidis genomes, collected by the UKHSA between 2014–2019, were used to train a ‘local classifier per node’ hierarchical classifier to attribute isolates to four continents, 11 sub-regions, and 38 countries (53 classes). The highest classification accuracy was achieved at the continental level followed by the sub-regional and country levels (macro F1: 0.954, 0.718, 0.661, respectively). A number of countries commonly visited by UK travelers were predicted with high accuracy (hF1: &gt;0.9). Longitudinal analysis and validation with publicly accessible international samples indicated that predictions were robust to prospective external datasets. The hierarchical machine learning framework provided granular geographical source prediction directly from sequencing reads in &lt;4 min per sample, facilitating rapid outbreak resolution and real-time genomic epidemiology. The results suggest additional application to a broader range of pathogens and other geographically structured problems, such as antimicrobial resistance prediction, is warranted.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>genomics</kwd><kwd>machine learning</kwd><kwd>epidemiology</kwd><kwd>public health</kwd><kwd>gastroenteritis</kwd><kwd><italic>Salmonella</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000691</institution-id><institution>Academy of Medical Sciences</institution></institution-wrap></funding-source><award-id>SBF005\1089</award-id><principal-award-recipient><name><surname>Cowley</surname><given-names>Lauren A</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Application of hierarchical machine learning to the geographical source attribution of <italic>Salmonella enteritidis</italic> indicates high utility for the rapid translation of raw pathogen genome sequencing data into accurate and actionable information for disease management in public health.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Diarrhoeal diseases are the most common illnesses caused by contaminated food, with 550 million people falling ill each year, including 220 million children under the age of 5 years (<xref ref-type="bibr" rid="bib59">WHO, 2022</xref>). High disease-burden foodborne pathogens represent a major public health concern, necessitating real-time epidemiological monitoring and follow-up. Outbreak investigations are often confounded by the complexity of the international food-trade networks which distribute zoonotic food-borne pathogens across the globe (<xref ref-type="bibr" rid="bib23">Gould et al., 2017</xref>). Understanding the contributing factors, whether they be environmental, geographical, or zoonotic is critical for designing public health intervention strategies to combat and prevent food-borne pathogen outbreaks (<xref ref-type="bibr" rid="bib45">Pires et al., 2009</xref>).</p><p>In many developed nations, <italic>Salmonella enterica</italic> serovar Enteritidis is the most common cause of the diarrhoeal disease (<xref ref-type="bibr" rid="bib57">UKHSA, 2021</xref>) and represents a significant economic and healthcare burden (<xref ref-type="bibr" rid="bib15">Daniel et al., 2020</xref>). In the UK, nationwide vaccination and monitoring programs have been responsible for a precipitous drop in detectable <italic>Salmonella</italic> from local animal products and a concurrent drop in human infection rates (<xref ref-type="bibr" rid="bib53">Surveillance, Zoonoses, Epidemiology and Risk Food and Farming Group, 2007</xref>; <xref ref-type="bibr" rid="bib54">Tam et al., 2012</xref>). However, recent studies have identified imported foodstuffs (<xref ref-type="bibr" rid="bib12">Cowley et al., 2016</xref>; <xref ref-type="bibr" rid="bib34">McLauchlin et al., 2019</xref>; <xref ref-type="bibr" rid="bib51">Somorin et al., 2021</xref>) and foreign travel (<xref ref-type="bibr" rid="bib43">PHE, 2017</xref>) as more pertinent <italic>Salmonella</italic> infection risks.</p><p>Whole genome sequencing (WGS) has become a powerful tool for untangling complex networks of pathogen dissemination by providing high-resolution sub-typing for transmission tracing as well as detailed information on antimicrobial and virulence status (<xref ref-type="bibr" rid="bib1">Allard et al., 2018</xref>). Since 2014, the UK Health Security Agency (UKHSA) has routinely applied WGS to all clinically identified cases of <italic>Salmonella</italic> in the UK alongside collecting detailed metadata, such as patients recent foreign travel (<xref ref-type="bibr" rid="bib4">Ashton et al., 2016</xref>). This program has been instrumental in identifying various international outbreaks, such as the largest known salmonellosis outbreak in Europe where, between 2015 and 2018 <italic>S.</italic> Enteritidis-contaminated eggs resulted in 1209 reported cases across 16 countries (<xref ref-type="bibr" rid="bib13">Dallman et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Pijnacker et al., 2019</xref>). The approach taken by the UKHSA for inferring geographical source from genomics data involves phylogenetic population structure analysis, the examination of the genetic relatedness of isolates from various relevant source populations, alongside in-depth analysis of isolates from recent-reported travel cases and reconstruction of domestic or international food networks (<xref ref-type="bibr" rid="bib8">Chan et al., 2023</xref>; <xref ref-type="bibr" rid="bib10">Chattaway et al., 2023</xref>; <xref ref-type="bibr" rid="bib28">Jenkins et al., 2019</xref>). Due to the resources involved, this type of investigation is often only undertaken in exceptional cases representing a threat to public health. A range of other methodologies exist for application to source attribution of genomics data (<xref ref-type="bibr" rid="bib36">Mughini-Gras et al., 2018</xref>) including population genetics approaches such as STRUCTURE (<xref ref-type="bibr" rid="bib46">Pritchard et al., 2000</xref>) and the asymmetric island model (<xref ref-type="bibr" rid="bib60">Wilson et al., 2008</xref>); Bayesian methods, such as sourceR (<xref ref-type="bibr" rid="bib35">Miller et al., 2017</xref>); and hybrid methodologies which can variably include additional information, such as exposure risk (<xref ref-type="bibr" rid="bib47">Ravel et al., 2017</xref>). These methodologies require significant bioinformatic expertise and research time, are computationally expensive, and scale poorly with the increasingly vast collections of bacterial genomes available for analysis.</p><p>In order to promote rapid outbreak responses, novel methods are required to translate the increasing volumes of pathogen genomes generated by surveillance programs into immediate and actionable information for epidemiologists. <italic>S</italic>. Enteritidis represents a desirable initial target for such tools due to its large public health burden. WGS provides high-resolution information about pathogen strain relatedness and, by association, contains contextualized information on geographical or host origin. In the case of <italic>S.</italic> Enteritidis, which has a population structure observably stratified by geographical source (<xref ref-type="bibr" rid="bib21">Feasey et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Li et al., 2021</xref>), there is potential for genomics to provide key information for successful epidemiological follow-up, namely the likely country of origin of an infectious strain, and an opportunity to rapidly enact intervention strategies. Machine learning (ML) approaches have recently shown utility in predicting the original host of infectious <italic>S. enterica</italic> and <italic>Escherichia coli</italic> (<xref ref-type="bibr" rid="bib32">Lupolova et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Lupolova et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Wheeler et al., 2018</xref>; <xref ref-type="bibr" rid="bib61">Zhang et al., 2019</xref>), <italic>S. typhimurium</italic> (<xref ref-type="bibr" rid="bib37">Munck et al., 2020</xref>), <italic>Campylobacter jejuni</italic> (<xref ref-type="bibr" rid="bib3">Arning et al., 2021</xref>), and <italic>Listeria monocytogenes</italic> (<xref ref-type="bibr" rid="bib55">Tanui et al., 2022</xref>), but has yet to be applied to the problem of geographical source attribution. Herein we present the first implementation of a hierarchical machine learning (hML) classifier for geographical source attribution of <italic>S.</italic> Enteritidis genomes. We applied this model to the UKHSA’s large and uniquely detailed genomic database of clinical <italic>S.</italic> Enteritidis isolates collected between January 2014-April 2019. Using these data, we have generated a fully automated analysis pipeline with which to monitor imported cases of <italic>S.</italic> Enteritidis. The hML model was designed to provide a granular and multi-level prediction of the geographical origin of an <italic>S.</italic> Enteritidis genome in under 4 minutes directly from raw sequencing reads.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>The UKHSA genomic surveillance program consistently samples <italic>S.</italic> Enteritidis associated with international travel through time</title><p>Broad and unbiased surveillance by the UKHSA of all clinically reported <italic>S.</italic> Enteritidis cases in the UK coupled with returning traveler data has provided a large genomic dataset representative of <italic>S.</italic> Enteritidis infections in the UK between 2014–2019 (<xref ref-type="fig" rid="fig1">Figure 1</xref>). This consisted of 10,223 isolates, of which 3,434 had matched recently reported travel data collected as a part of the UKHSA’s ‘enhanced surveillance’ program.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Summary of <italic>S.</italic> Enteritidis isolates collected by the UKHSA from UK clinical patients who recently reported foreign travel between 2014–2019.</title><p>(<bold>A</bold>) Geographical distribution of 2,313 <italic>S.</italic> Enteritidis isolates by reported foreign travel. Variably sized points represent the number of samples per country. The map is colored by region (Africa: yellow, Americas: red, Asia: purple, Europe: blue). (<bold>B</bold>) Maximum likelihood phylogenetic tree of 2,313 <italic>S.</italic> Enteritidis isolates with bar colored by region of origin. (<bold>C</bold>) Kernel density plot indicating sampling density per region through time. No correction was made for the seasonal variation observed in international travel. (<bold>D</bold>) Comparison of the consistency of the sampling effort of the UKHSA to all publicly available <italic>S.</italic> Enteritidis isolates on NCBI for the same period. Isolates were resampled to control for variable sample number per year and compared to a uniform distribution using the Kolmogorov-Smirnov D statistic (NCBI = red, UKHSA = blue). Higher values indicate greater deviation from a uniform distribution. (<bold>E</bold>) Relative risk per country of acquiring <italic>S. E</italic>nteritidis infection when traveling. A risk score was generated by dividing the proportion of UKHSA clinical isolates per country by the proportion of all UK travelers traveling to that country as recorded by the Office of National Statistics (ONS). Only countries present in both datasets were used to calculate proportions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Summary of 2,313 <italic>S.</italic> Enteritidis isolates collected by the UKHSA from UK clinical patients during 2014-2019 who recently reported foreign travel to 38 individual country classes. Each panel contains a bar chart of isolate counts per year per country class.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Recent travel was reported to 122 countries across five continents. A source of potential bias, common to bacterial genomics analysis, is the over-representation of clonally related isolates due to their increased prevalence during outbreaks (<xref ref-type="bibr" rid="bib19">Ebel et al., 2016</xref>; <xref ref-type="bibr" rid="bib22">Feil and Spratt, 2003</xref>). A clone was defined as a single-linkage cluster of isolates with five or less single nucleotide polymorphisms (SNPs), a definition routinely-used by the UKHSA in genomic disease surveillance as part of the ‘SNP Address’ framework for describing clones (<xref ref-type="bibr" rid="bib9">Chattaway et al., 2019</xref>; <xref ref-type="bibr" rid="bib14">Dallman et al., 2018</xref>). In order to reduce the influence of highly related clonal outbreaks on the resulting ML model, a single, random representative isolate was selected for each clone per country. After quality-filtering, downsampling, and the removal of countries with a low-incidence of reported infections of UK tourists (&lt;10 total isolates), 2,313 genomes from 38 countries from four continents were included in the final dataset for ML (<xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p><p>Grouping these countries by geographic region and subregion using the UN M49 Standard for Regional Codes provided a framework for a granular geographical analysis and an established hierarchy of countries/subregions/regions (<xref ref-type="bibr" rid="bib52">Statistics Division of the United Nations Secretariat, 2020</xref>). Phylogenetic analysis indicated that the dataset displayed a strong phylogeographical signal, with large clusters of isolates from geographically related countries clustering together (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). An interactive maximum likelihood phylogenetic tree is available in <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">Microreact</ext-link> (<xref ref-type="bibr" rid="bib2">Argimón et al., 2016</xref>). <italic>S.</italic> Enteritidis infection rates in Europe and Asia were highly seasonal, with significantly increased rates of infection during the summer months (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). This was less pronounced in travel to/from the Americas and Africa.</p><p>An analysis of the consistency of sampling effort over time identified that some notable countries in the dataset were composed of samples collected predominantly during a single year, such as Sri Lanka, Tunisia, and Dominica, and others were missing data from one or more years (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). However, a comparison of the UKHSA collection to a dataset of location/date-matched genomes from the NCBI Pathogen Detection Database identified that the UKHSA dataset represented a significantly more consistent sampling effort which was less influenced by sporadic outbreaks (<xref ref-type="fig" rid="fig1">Figure 1D</xref>).</p><p>The countries with the highest number of travel-associated <italic>S.</italic> Enteritidis cases were Turkey (804), Spain (357), Egypt (343), Cuba (190), and the Dominican Republic (117) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Controlling for the volume of UK travelers as recorded by the Office of National Statistics over a matched time period allowed for the identification of countries with disproportionate low- or high-risk of <italic>S.</italic> Enteritidis infection after traveling (<xref ref-type="fig" rid="fig1">Figure 1E</xref>; <xref ref-type="bibr" rid="bib40">Office of National Statistics, 2020</xref>). Travelers to Turkey and Egypt were at a disproportionately higher risk of <italic>S.</italic> Enteritidis infection during this period. Conversely, travelers to France and Spain, two of the more popular travel destinations for UK travelers, were very low-risk. This highlights that the dataset was a product of the volume of UK-travel combined with a variable risk of infection per country. Consequently, there was a large degree of class imbalance (i.e. different number of isolates per country) in the dataset used for ML, in addition to low/absent sampling coverage of some parts of the globe. However, when considering larger geographical groupings (i.e. subregion/region) these imbalances were less pronounced or absent.</p></sec><sec id="s2-2"><title>A novel hierarchical model provides real-time geographical source attribution prediction directly from sequencing reads in under 4 min</title><p>Taking advantage of the hierarchical structure of geographical data, we designed a multi-level hML classifier following a ‘Local Classifier per Node’ framework (<xref ref-type="bibr" rid="bib49">Silla and Freitas, 2011</xref>). This was made up of 16 individual multi-class classifiers, one per node (one root, four regional, 11 sub-regional). Multi-class classifiers allow for the classification of samples into three or more classes (i.e. Region = Europe, Africa, Americas, Asia), rather than making a series of binary classifiers per individual class (e.g. Africa/Not-Africa, Europe/Not-Europe, etc.). In total, 53 individual classes (four regions, 11 sub-regions, and 38 countries) were included in the model. Sample classification was performed using a top-down approach, where samples are first classified at the root node into ‘regions’ (e.g. Africa) then, if the predicted probability is greater than a minimum threshold value (0.5), samples are passed to the appropriate regional node to be classified into a nested subset of ‘subregions’ (e.g. Northern Africa) and finally passed to a subregional node where they are classified into a nested subset of ‘countries’ (e.g. Egypt) (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Using this scheme no samples could be attributed to a class that was not a predicted class of a previous classifier (i.e. Africa→Southern Asia→France is not possible, but Africa→Northern Africa→Egypt is). Sample classification was exclusive, disallowing multiple classifications on the same hierarchical level for a single sample.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Summary statistics showing model and resampling scheme selection, feature selection, and optimization of the <italic>S.</italic> Enteritidis hML source attribution model.</title><p>(<bold>A</bold>) Example schematic of a geographical hierarchy based upon the UN M49 Standard for regional codes. (<bold>B</bold>) Table of summary statistics for the ten top-performing co-optimized model and resampling methods from a cohort of 36 combinations, sorted by hF1 (high-low). Training time is reported in the final column in seconds. A black box indicates the top four models used for feature selection. (<bold>C</bold>) Grouped bar chart comparing macro F1 per hierarchical level for the ten top-performing model/resampled combinations. (<bold>D</bold>) Table of summary statistics for random forest feature selection applied to the four top-performing co-optimized model and resampling methods. Black boxes indicate the optimal number of features per combination. (<bold>E</bold>) Grouped bar chart comparing macro F1 per hierarchical level for the four top-performing co-optimied model and resampling methods after feature selection optimization. (<bold>F</bold>) Summary statistics for the final optimized Random Forest - Random Oversampler model (25,000 features selected). ML Model abbreviations: Random Forest (RF), XGBoost (XGB), Extra Trees (ET), K-Nearest Neighbours (KNN). Resampler abbreviations: No Resampling (NA), Random Undersampler (RUS), Random Oversampler (ROS), Balancing Mean (BM), Hierarchical Mean (HM).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig2-v2.tif"/></fig><p>For rapid and minimal sample processing and to provide end-to-end sample classification directly from the sequencer, the model was trained on filtered unitig patterns (presence-absence) generated from quality-controlled genomic short-read data files. Each local classifier per node was trained using only data pertinent to that node (e.g. a local subregion classifier was trained only on the data from its constituent countries). This end-to-end process, from FASTQ to sample prediction, is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/SionBayliss/HierarchicalML">https://github.com/SionBayliss/HierarchicalML</ext-link>, copy archived at <xref ref-type="bibr" rid="bib5">Bayliss and Cowley, 2023</xref>).</p><p>Due to the imbalanced nature of the real-world surveillance dataset, it was necessary to resample the data to generate less biased datasets for training. To this end, a range of classifier and resampler algorithms were compared before selecting the top-performing models (<xref ref-type="fig" rid="fig2">Figure 2B–C</xref>). Models were assessed using a range of accuracy metrics, although the F1-score (or its hierarchical alternative, hF1) was preferentially used. The F1-score or F-score is the harmonic mean between the precision (the number of true positives divided by the number of true positives plus the number of false positives) and recalls (the number of true positives divided by the number of true positives plus the number of false negatives) and allows for a partial representation of both values in a single metric. The top four models subsequently underwent feature selection (<xref ref-type="fig" rid="fig2">Figure 2D–E</xref>) followed by parameter optimization using the TPOT genetic algorithm (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). The optimized hML model produced a more accurate classification of the test dataset than a ‘flat’ classifier applied to a similarly pre-processed dataset (macro F1: 0.61) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>). Based on these comparisons, the most desirable assessment metrics overall (i.e. high macro F1 at the country level, <xref ref-type="fig" rid="fig2">Figure 2E</xref>) were from feature selection by a Random Forest (RF) classifier (25,000 unitig patterns) before random oversampling to correct for class imbalance and final classification using an optimized RF model. Assuming &lt;100 x read coverage, the entire pipeline takes ~3.5 min to classify novel samples using the pre-optimized model.</p></sec><sec id="s2-3"><title>Granular predictions are provided at a regional, subregional, and individual country level</title><p>Classification metrics were highest at the regional level (macro F1: 0.954), but less discriminatory at the sub-regional (macro F1: 0.718) and country levels (macro F1: 0.661) (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). There was a moderate degree of variation in predictive accuracy between different geographical locations. Africa was the most consistent accurately classified region, with all country and subregional classes presenting a hF1 of &gt;0.7. In The Americas, Latin American and Caribbean countries showed very high classification metrics (hF1: &gt;0.8), whereas samples for the United States were consistently misclassified. All Asian classes were classified at moderate to high accuracy (hF1: 0.58–0.95). Europe was generally well classified (hF1: &gt;0.66), but contained two classes, France and Italy, which were classified poorly (hF1: ~0.3). Further scrutiny of poorly performing classes showed a correlation between a lack of training data and lower prediction accuracy (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). This did not fully explain the observed results as some countries with a similarly low number of samples to poorly predicted countries (e.g. Czech Republic, Pakistan) showed moderate classification accuracy. An analysis of genetic diversity within classes indicated that at least two of the most poorly classified countries, France and the United States, displayed both low numbers of samples and high genetic diversity (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Samples from recent travel to France were particularly diverse, arising from multiple highly divergent clades of <italic>S.</italic> enteritidis. A range of countries that were commonly visited by UK travelers, such as Cuba, Egypt, Indonesia, Jamaica, Malta, Spain, Thailand, Tunisia, and Turkey, were well predicted (hF1: &gt;0.9).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Plots summarizing results from hierarchical machine learning (hML) model applied to the <italic>S.</italic> Enteritidis test dataset and a measurement of the genetic diversity of <italic>S.</italic> Enteritidis sample collection per country.</title><p>(<bold>A</bold>) Diagrammatic representation of classification metrics of the hML classifier applied to the test dataset. Links between classes/nodes in the hierarchy are indicated by connecting lines. Boxes represent individual classes in the Machine learning (ML) model and are colored by their hierarchical F1 (hF1) scores. The top panel of each class box displays the class label, the bottom left panel indicates the total number of samples for that class before the train/test split (75%/25%) and the bottom right panel shows the class hF1 score calculated from the test dataset. Classes within individual ‘regions’ (continents) were contained in a colored background panel. (<bold>B</bold>) Bar plot of genomic diversity per country. Genomic diversity was estimated as the number of 25 single nucleotide polymorphism (SNP) single linkage clusters divided by the total number of samples per class. Panels (<bold>A</bold>) and bars (<bold>B</bold>) were colored according to region (Africa: yellow, Americas: red, Asia: purple, Europe: blue). (<bold>C</bold>) Maximum-likelihood phylogenetic tree of the UKHSA <italic>S.</italic> Enteritidis isolates from the training and test datasets. The real label and predicted label (each assigned a unique color) of each isolate alongside the p-value generated by the model is shown for each hierarchical class level - region, subregion and country. Colored tree tips represent the region class of each isolate. An interactive version of the tree and associated metadata are available in <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">Microreact</ext-link>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Scatter plots summarizing the number of samples (x-axis) vs hF1 score (y-axis) generated by the optimized hierarchical machine learning (hML) model.</title><p>The three hierarchical levels (country/subregion/region) are represented by a separate plot panel. Each point is the hF1 score per class at that hierarchical level.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Scatter plots summarizing hF1 score (x-axis) vs. the number of samples/genomic diversity at SNP5/genomic diversity at SNP50 (y-axis – top/middle/bottom).</title><p>Genomic diversity was calculated by dividing the number of single linkage clusters at SNP5/SNP50 (single nucleotide polymorphism (SNP) Address) by the total number of samples per class. Points were colored according to the region (Africa: red, Americas: green, Asia: blue, Europe: purple).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig3-figsupp2-v2.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Diagrammatic representation of classification metrics of the hierarchical machine learning (hML) classifier applied to the <italic>S.</italic> Enteritidis test dataset showing % isolates correctly assigned per class.</title><p>Links between classes/nodes in the hierarchy are indicated by connecting lines. Boxes represent individual classes in the hML model and are colored by the % of isolates for that class that were correctly assigned to that class. The top panel of each class box displays the class label, the bottom left panel indicates the total number of samples for that class before the train/test split (75%/25%) and the bottom right panel shows the class % correctly assigned as calculated from the test dataset. Classes within individual ‘regions’ (continents) were contained in a colored background panel.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig3-figsupp3-v2.tif"/></fig></fig-group><p>This model allows for a separate measure of predictive confidence (i.e. the probability value reported by the appropriate classifier) to be reported to the end-user for each hierarchical level. An example of how this uncertainty maybe visualized for the end-user is available in <xref ref-type="fig" rid="fig3">Figure 3C</xref> and mirrored in the interactive <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">Microreact</ext-link> project. These figures include three columns containing the predicted class of each sample per hierarchical level and three matched columns with the probability of the prediction per class as reported by the appropriate classifier. This also allows for a user to visually inspect the variable level of predictive confidence for each bacterial lineage within its particular phylogenetic context. For ease of interpretation, an alternative to <xref ref-type="fig" rid="fig3">Figure 3</xref> has been included in the supplementary information (<xref ref-type="fig" rid="fig3s3">Figure 3—figure supplement 3</xref>) which displays the % of isolates of each class correctly assigned to that class instead of HF1.</p><p>In summary, these results suggest that the optimized model can attribute the geographical source of <italic>S.</italic> Enteritidis isolates with high confidence at a regional level whilst also providing more nuanced and granular predictions for a range of countries regularly visited by UK travelers with a very high degree of accuracy. The resulting measures of confidence in individual sample predictions can be easily communicated to end-user an a simple and easily interpretable manner.</p></sec><sec id="s2-4"><title>Models demonstrate durability to future predictions with 2 years previous training data providing the sufficient signal for accurate subsequent year predictions</title><p>Bacterial population lineage composition is not expected to remain static through time, therefore, predictive models based on genomic data require periodic retraining. To understand the amount of data required for accurate prospective prediction, we compared the outcomes of four yearly window sizes (1, 2, 3, and 4 years) for the prediction of subsequent years (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Predictive accuracy and consistency of prediction of the subsequent year improved on increasing window size, with hF1 beginning to asymptote after 2 years. The largest improvement was observed between 1–2 years’ worth of data. A minor decrease in predictive accuracy (micro F1: ~0.05 per year) was observed for each additional year into the future (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). A regional breakdown of the hF1 score indicated that a one-year window varied in predictive accuracy per region per year (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), but that a two-year window provided more consistent and accurate predictions (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). These results indicate that should this model be instituted for ML-enhanced genomic surveillance, it would require retraining on the two previous years samples each year to provide an optimal trade-off between predictive accuracy and training time.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>A longitudinal analysis of the predictive performance of hierarchical machine learning (hML) models on 2,313 <italic>S.</italic> Enteritidis samples.</title><p>(<bold>A</bold>) The hF1 scores of hML Random Forest (RF) models trained on a subset of samples from a 1–4 year moving window predicting the following year. (<bold>B</bold>) The micro F1 scores of hML RF models trained on a subset of samples from a 1–3 year moving window predicting 1–5 years into the future. (<bold>C</bold>) Regional hF1 scores of hML RF models trained on one-year sampling windows predicting the following year. (<bold>D</bold>) Regional hF1 scores of hierarchical models trained on two-year sample windows predicting the following year.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig4-v2.tif"/></fig></sec><sec id="s2-5"><title>The optimized hML model provides accurate predictions in 4/5 validation datasets</title><p>The hML model was further validated by application to a series of external, independent datasets (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1D</xref>). The initial datasets were from two UK-based, well-characterized, and epidemiologically-traced imported food outbreaks. Sample redundancy between validation and training datasets was removed before comparison. First, a 2015 outbreak epidemiologically-traced to eggs imported from Spain (<xref ref-type="bibr" rid="bib26">Inns et al., 2017</xref>) was 100% correctly attributed to a Spanish origin (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Second, a multi-country outbreak originating from Polish egg farms (<xref ref-type="bibr" rid="bib44">Pijnacker et al., 2019</xref>), comprising of two distinct lineages each differing by five or fewer SNPs, was correctly attributed to a European origin (131/131 cases), but subsequently misattributed to a Southern Europe (131/131 cases), Spanish origin (103/130) (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). This complex outbreak was a particularly difficult test case for the model, as it had been continuously causing cases in 16 European countries for several years (2015–2018). The outbreak cases were also phylogenetically distinct from those associated with travel to Poland in the UKHSA dataset (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). It was possible to identify samples attributed to the outbreak in our training data, this included six samples that were present in the training dataset. These six samples were labeled as having been acquired from Portugal (3), Spain (1), Greece (1), and Turkey (1) based on recently reported travel information, despite having got their infection from Polish eggs. 5/6 of these were of a Southern European origin, and likely contributed to the misattribution of the samples from the Polish validation datasets to a Southern European origin.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Classification summaries of the optimised hML model applied to five additional independent validation collections of <italic>S.</italic> Enteritidis genomes.</title><p>(<bold>A</bold>) 128 samples from an international outbreak that originated in Spain in 2015 (<xref ref-type="bibr" rid="bib26">Inns et al., 2017</xref>). (<bold>B</bold>) 131 samples from a large-scale international outbreak that originated from Polish eggs between 2015–2018 (<xref ref-type="bibr" rid="bib44">Pijnacker et al., 2019</xref>). (<bold>C</bold>) 35 samples from Poland were uploaded to the NCBI database between 2014–2019. (<bold>D</bold>) 25 samples from South Africa were uploaded to the NCBI database between 2014–2019 (<xref ref-type="bibr" rid="bib50">Smith et al., 2020</xref>). (<bold>E</bold>) 48 samples from Singapore were uploaded to the NCBI database between 2014–2019 (<xref ref-type="bibr" rid="bib39">Octavia et al., 2018</xref>). The number of samples assigned per class is indicated for classes relevant to the query dataset. Class boxes are colored by the proportion of correctly/incorrectly classified samples (correct: green, incorrect: red). (<bold>F</bold>) Maximum-likelihood phylogenetic tree of <italic>S.</italic> Enteritidis isolates from the training, test, and validation datasets. Validation dataset isolates are displayed as a colored bar alongside the p-value of the model predictions for associated region, subregion, and country class. Colored tree tips represent the training isolates from the four countries tested across the validation datasets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Maximum-likelihood phylogenetic tree of <italic>S.</italic> Enteritidis isolates from the training, test, and validation datasets.</title><p>Validation dataset isolates are displayed as a colored bar alongside the p-value of the model predictions for the associated region, subregion, and country class. Colored tree tips represent the training isolates from the four countries tested across the validation datasets. <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>. Summary statistics for a ‘flat’ Random Forest multi-class classifier. The classier was trained and tested using a 75–25% split using the same random seed as was used for the hierarchical machine learning (hML) classifier. The dataset was randomly oversampled to address the class imbalance. Country classes from the hML model were used as labels (i.e. region/subregion were excluded).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-84167-fig5-figsupp1-v2.tif"/></fig></fig-group><p>The model was further tested on datasets generated by other non-UK institutions. Three countries from three different regions were identified from the NCBI database as having acceptable sample numbers (&gt;20), falling within the time-frame of the current model (2014–2019), and having been sampled from a country included in the current model hierarchy (South Africa, Singapore, and Poland). The Polish dataset, sampled from poultry, was attributed to a European origin with high accuracy (34/35, 97.1%), 19 of these were subsequently attributed to an East European origin (19/35, 54.3%) or which 18 were attributed to Poland (18/35, 51.4%) (<xref ref-type="fig" rid="fig5">Figure 5C</xref>). The remaining 15 samples were misclassified as having a Spanish origin (15/35, 42.9%). The South African dataset of clinical cases (<xref ref-type="bibr" rid="bib50">Smith et al., 2020</xref>), was correctly attributed to a South African origin with 100% accuracy (25/25) (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). The Singaporean dataset of human outbreaks (<xref ref-type="bibr" rid="bib39">Octavia et al., 2018</xref>) was correctly attributed to South-East Asia (48/48) with 91.7% of samples being correctly attributed to a Singaporean origin (44/48) and 4 samples being attributed to Indonesia (2), Malaysia (1), and Thailand (1) (<xref ref-type="fig" rid="fig5">Figure 5E</xref>). An additional visualization of the validation datasets alongside the training and test datasets has been presented in <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>.</p><p>Application of the hML model to independent validation datasets indicated that the model provided highly accurate and granular predictions for single-country outbreaks which occur over short time-frames. A large-scale, long-term, multi-country outbreak was poorly predicted by the model, likely due to a small number of outbreak isolates present in the training dataset being incorrectly labeled as having a Southern European origin. However, the application of the hML model to a range of other independent validation datasets provided highly accurate and granular predictions.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Outbreaks caused by foodborne pathogens, where rapid response times are essential for effective interventions, represent an epidemiological challenge for public health bodies as they arise from complex, interconnected global supply chains which include many potential sources of infection. Our optimized hML model generates accurate predictions of the geographical origin of <italic>S.</italic> Enteritidis genomes directly from raw read data in under 4 min per sample. The output of this pipeline is a predicted probability per hierarchical level (i.e. region, sub-region, and country levels) allowing for granular source attribution alongside an assessment of confidence in the prediction. The observed classification accuracy of the model was high, varying across both hierarchical levels and individual classes (<xref ref-type="fig" rid="fig2">Figures 2</xref>–<xref ref-type="fig" rid="fig3">3</xref>). Accuracy was highest at the regional level (macro F1: 0.954), which contained the largest number of samples for training and the lowest level of class imbalance, before dropping at the subregional (macro F1: 0.718) and country levels (macro F1: 0.661), both of which contained generally smaller and more variable numbers of samples, increasing class imbalance (<xref ref-type="fig" rid="fig3">Figure 3</xref>). It should be noted that these macro values, being an average of the F1 score across all classes, were strongly influenced by outliers representing a handful of classes with poor classification accuracy (e.g. United States, France, US, Italy). Classification accuracy was negatively associated with both low sample numbers and increasing within-class genetic diversity (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>), although this did not fully explain the variation in predictive accuracy observed in the model, suggesting other complex factors may be involved. Although variation in predictive accuracy was observed, a number of commonly visited countries were predicted with extremely high predictive accuracy (e.g. Cuba, Egypt, Indonesia, Jamaica, Malta, Spain, Thailand, Tunisia, and Turkey) which would be of high-utility for the UK epidemiologists tracing foodborne outbreaks.</p><p>Selection and optimization of the ML classifier and resampler methods, as well as pre-classification feature selection, were performed in a stepwise manner to assess the impact of each step on the resulting model. Ensemble classifiers outperformed other classifiers (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1B</xref>). Interestingly, considering the large variation observed in some nodes of the hierarchy, the class imbalance was not found to have a large impact on the resulting model. Two of the top four best-performing classifier/resampler combinations included no resampling. These were both ensemble classifiers, suggesting that these were better able to account for the high dimensionality, high collinearity, and variable levels of class imbalance than other classifier models. The resampling itself was observed to differentially impact the various hierarchical levels (<xref ref-type="fig" rid="fig2">Figure 2</xref>). The model required a sample to be classified at a higher hierarchical level before being passed on to the next nested level (e.g. classified as European before being classes as West/East/South European) which biased model selection towards favoring classifiers which improved regional and subregional predictions. It should be noted that each classifier/resampler/feature selection step was applied uniformly across the hierarchy prior to parameter optimization, to allow for an assessment of individual steps on the resulting model. An attractive, although less informative, approach for future retraining would be to optimize all steps (classifier/resampler/feature selection) on a per-node basis using an AutoML method, such as the genetic algorithm used in the current work to optimize hyperparameters in the final hML RF model (<xref ref-type="bibr" rid="bib41">Olson et al., 2016</xref>). Validation using external datasets indicated that the model robustly predicted the majority of novel samples, but was less effective for complex multi-country, multi-year outbreaks (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p><p>We acknowledge that this study has a number of important limitations. Whilst we have presented evidence that the hML model can robustly predict geographical sources for <italic>S.</italic> Enteritidis, the COVID-19 pandemic has resulted in a vast disruption to international travel over the past 2 years. The UKHSA is already seeing a return to pre-pandemic levels of imported infection and expect the pattern of the seasonality of imported <italic>S.</italic> Enteritidis infections to return. However, there may be unquantified impacts on the global food network which could result in a reduction in the prediction accuracy of the current model and would likely require retraining on post-pandemic data. Furthermore, the dataset, collected as part of the UKHSA’s national genomic surveillance program, is a product of two factors; the countries to which UK residents commonly travel and the variable likelihood of <italic>S.</italic> Enteritidis infection whilst in these countries (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Both factors influence the geographical distribution of sampling locations present in the dataset as well as the number of available samples per country. For example, of the 122 countries present in the initial dataset only 38 (31%) were present in sufficient quantities over the surveillance period to include in the model. The second factor influencing the composition of the dataset is the variable risk of infection posed by the countries present in the dataset. Some commonly visited countries posed only a minor risk of infection (e.g. France) whilst others posed a disproportionately high risk of infection on visiting (e.g. Turkey) (<xref ref-type="fig" rid="fig1">Figure 1E</xref>). The risk of infection per country is likely to be a product of the overall prevalence of <italic>S.</italic> Enteritidis as well as the local circulation of high-virulence or low-virulence strains, infections with which is more or less likely to result in referral to the clinical setting. Due to the complex nature of both the global food supply chain and pathogen transmission dynamics, it is likely that these factors will cause misattribution in some cases; for instance, UK-travelers might travel to country A and consume contaminated foodstuffs imported from country B which was absent from the training data, and the model would then ‘correctly’ assign future cases to country A. One might also imagine that country C, which is only rarely visited by UK-travelers, produces a contaminated foodstuff and exports it to country D, which is often visited by UK-travelers, causing the model to misattribute a sample from country C to D. In these cases, the model would provide useful information on the origin of infection but would not ultimately identify the true reservoir of the pathogen. Evidence of this form of misattribution has been presented in the Polish eggs outbreak dataset used for validation (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). This outbreak represents a particularly difficult attribution problem as many of the contaminated eggs were distributed to 18 different EU countries during the sampling period used to train the model – allowing for the inclusion of a small number of erroneously labeled samples in the training data and resulting in inaccurate classification. This outbreak represents an important limitation of the current model and illustrates how multi-country outbreaks or long-established food network contamination pathways can confound accurate source attribution.</p><p>Other potential forms of mislabeling in reported travel data include the incorrect reporting of multi-country trips or infection of travellers during return-trip layovers. The ONS records travel destination as the primary location visited, so no estimates of the proportion of samples attributable to multi-country trips could be made, although they will certainly represent a minority of the data. Recent surveys have estimated that layovers occur on only a small proportion of flights (~15%), although this could potentially have a larger impact on the data due to the bias in detecting cases that occur towards the end of a trip, which could result in a patient being admitted to UK-based clinical care setting, rather than one overseas (<xref ref-type="bibr" rid="bib16">Department for Transport, 2018</xref>; <xref ref-type="bibr" rid="bib17">Department of Transport, 2018</xref>). Another limitation of this work was its reliance on recently reported travel data, which was used as a proxy for the prevalence of infections arising from imported foodstuffs. Whilst there is evidence that this approach can capture highly-relevant disease strains present in foodstuffs imported to the UK (<xref ref-type="bibr" rid="bib8">Chan et al., 2023</xref>; <xref ref-type="bibr" rid="bib10">Chattaway et al., 2023</xref>; <xref ref-type="bibr" rid="bib28">Jenkins et al., 2019</xref>), strain prevalence is likely to vary across national borders due to differences in national and domestic regulations and food-processed methods.</p><p>We have presented a conceptually simple hML model which is able to successfully predict the geographical source of infection for a wide range of popular destinations frequented by UK travelers. However, the basis of this work was a single dataset which, although exceptional in the breadth of sampling and metadata, compositionally reflects locations routinely visited by UK travelers. A number of destinations were present in the dataset for which there is little to no data present in public databases during a matching time period (e.g. Malta). This demonstrates the additional utility provided by the collection of recent travel information as part of a national surveillance program to generate consistent geographical coverage for disease-sampling over a much larger geographical area. Travel-associated samples have recently been used to improve our understanding of the geographical distribution of various <italic>S.</italic> Typhi lineages by being used as an informal substitute for sampling efforts from geographical regions lacking formal disease surveillance programs (<xref ref-type="bibr" rid="bib7">Carey et al., 2022</xref>). One could imagine that coordination between public health bodies with complementary citizen travel preferences would allow for a small network of national genomic surveillance initiatives to provide global coverage of gastrointestinal diseases without the costly necessity of instituting comprehensive global surveillance initiatives. If this was coupled with a similar hML model to the one detailed here, then rapid and precise global predictions of the source of gastrointestinal disease outbreaks could be achieved.</p><p>The model presented herein is conceptually simple and does not incorporate temporal information, account for seasonal fluctuations in disease incidence, allow for multiple labels to be assigned to samples, or incorporate animal host/food source information, which may improve the prediction of multi-country outbreaks or provide additional information to further enhance epidemiological follow-up (<xref ref-type="bibr" rid="bib32">Lupolova et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Lupolova et al., 2019</xref>; <xref ref-type="bibr" rid="bib58">Wheeler et al., 2018</xref>; <xref ref-type="bibr" rid="bib61">Zhang et al., 2019</xref>). Furthermore, the UK was excluded as a potential geographical source in the model due to the extremely low prevalence of <italic>S.</italic> Enteritidis in domestic poultry flocks and a lack of clinical isolates linked to consumption of locally produced foodstuffs (<xref ref-type="bibr" rid="bib20">European Food Safety Authority and European Centre for Disease Prevention and Control, 2017</xref>). Future studies could include samples collected via veterinary or food chain-based surveillance programs to provide finer-scale inference of causation or provide model coverage of low-prevalence geographical locations.</p><p>This study provides a framework for future hML applications in the area of pathogen genomics. Other geographically stratified problems which might benefit from a hierarchical approach include antimicrobial resistance in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib25">Ingle et al., 2018</xref>), the transmission of <italic>Staphylococcus aureus</italic> in hospital networks (<xref ref-type="bibr" rid="bib18">Donker et al., 2017</xref>), and application to other serovars of <italic>S. enterica</italic> (<xref ref-type="bibr" rid="bib32">Lupolova et al., 2017</xref>; <xref ref-type="bibr" rid="bib37">Munck et al., 2020</xref>). This work represents the first application of hML for the automation of genomics-based geographical source attribution. The rapidity of predictions from raw sequencing data should greatly enhance epidemiologists’ ability to trace the source of gastrointestinal outbreaks by condensing complex genetic data into understandable and actionable outputs.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Genome collection and processing</title><p>The initial dataset consisted of 10,223 <italic>S.</italic> Enteritidis isolates collected and sequenced by UKHSA between 2014–2019 as a part of their routine disease monitoring program. Raw read data were downloaded from the Sequence Read Archive (Bioproject: PRJNA248792) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1C</xref>). Reads were filtered using Trimmomatic 0.39, residual Illumina adapter sequences were removed, the first and last three base pairs in a read were trimmed, before a sliding window quality trimming of four bases with a quality threshold of 20 were applied, and reads of less than 36 bp (after trimming) were removed (ILLUMINACLIP:PE_All.fasta:2:30:10:2:keepBothReads SLIDINGWINDOW:4:20 LEADING:3 TRAILING:3 MINLEN:36) (<xref ref-type="bibr" rid="bib6">Bolger et al., 2014</xref>). The coverage of the resulting file was estimated against the size of <italic>S.</italic> Enteritidis reference genome P12510 (<xref ref-type="bibr" rid="bib56">Thomson et al., 2008</xref>) and downsampled to ~100 x coverage using in-house scripts. Musket 1.1 was applied for k-mer spectrum read correction using a k-mer size of 31 bp. Unitigs were generated directly from filtered reads using bcalm 2.2.3 with a k-mer size of 31 bp and a minimum k-mer abundance of six (estimated from data) (<xref ref-type="bibr" rid="bib11">Chikhi et al., 2016</xref>).</p><p>Reads were mapped to <italic>S.</italic> Enteritidis reference genome P12510 and variants were called using SNIPPY 4.6 with a minimum coverage of 10x and a mapping quality of 60 (<xref ref-type="bibr" rid="bib48">Seemann, 2021</xref>). A reduced alignment of variant sites was generated using snp-sites (<xref ref-type="bibr" rid="bib42">Page et al., 2016</xref>) and passed to IQ-Tree for phylogenetic reconstruction using a GTR + I + G substitution model and ultra-fast bootstrapping (1000 bootstraps) (<xref ref-type="bibr" rid="bib38">Nguyen et al., 2015</xref>). An interactive maximum likelihood phylogenetic tree is available in <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">Microreact</ext-link>.</p></sec><sec id="s4-2"><title>Isolate selection for Machine learning</title><p>Of the initial 10,223 isolates, 3,434 had matched recent reported travel data, in the form of ‘country’ of recent travel (within 28 days of generating symptoms), provided by the clinical laboratories on submission of the isolate. These isolates were selected as potential candidates for ML model construction and testing. The 3,434 initial isolates were subsequently filtered to identify samples that had both consistent metadata and good sequence quality. The criteria for inclusion included: (a) clear and uncontradictory recent travel metadata, unrecognized or invalid regions (e.g. Yugoslavia) were removed; (b) reads that were not genetically distant from the majority of isolates in the collection as measured by MASH distance; (c) reads that had &gt;28 x coverage of <italic>S.</italic> Enteritidis reference genome P12510; (d) samples that did not have a total unitig length greater than 5,250,000 bp; (e) k-mers created from the reads that did not have a singleton frequency of &gt;0.5. A total of 220 samples were excluded due to these criteria.</p><p>Further dataset reduction was performed to remove genetically identical, or near-identical, isolates from the collection prior to processing for ML. SNP Address was used as a proxy for genetic relatedness and a single example of each SNP Address (SNP5) was randomly selected per country for further analysis. Samples were assigned to region and subregion based upon the UN M49 Standard for regional codes (<ext-link ext-link-type="uri" xlink:href="https://unstats.un.org/unsd/methodology/m49/overview">https://unstats.un.org/unsd/methodology/m49/overview</ext-link>) [Accessed: 30 November 2021]. Recent travel information which represented historically distinct subregions or autonomous subregions of a larger country grouping (e.g. Hong Kong), was considered a part of the larger entity for the purpose of classification. Any country with less than ten representative samples after filtering was excluded from further analysis. The final sample collection after filtering contained 2,313 samples (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1C</xref>).</p><p>The relative risk of acquiring <italic>S.</italic> Enteritidis infection when traveling was estimated using the ratio of the proportion of UKHSA clinical isolates reported as having recently traveled to each country over the proportion of all UK travelers traveling to that country as recorded by the (<xref ref-type="bibr" rid="bib40">Office of National Statistics, 2020</xref>). The data used for this comparison was the date (year) and location (country) matched before proportions were calculated.</p><p>The NCBI Pathogen Genome database was interrogated to identify <italic>S.</italic> Enteritidis isolates collected in countries present in the hML model over a matching time period [Accessed: 18 November 2021]. 2019 was excluded as UKHSA samples were only available for a relatively short duration of the year (January-April). Variation in the isolate number collected each year was controlled for by resampling with replacement (1,000 samples). The resulting yearly sampling data was compared to a uniform distribution using the Kolmogorov-Smirnov D statistic to quantify deviation from a consistent sampling scheme for both the UKHSA and NBCI reference datasets.</p></sec><sec id="s4-3"><title>Unitig processing for ML</title><p>A colored De Bruijn graph was constructed for the complete genome collection by passing the unitigs for individual samples to unitig caller v1.2.0 (<xref ref-type="bibr" rid="bib24">Holley and Melsted, 2020</xref>). This identified 426,647 unique unitigs present in the 2,313 genome collection. The resulting De Brujin graph was then queried to establish the presence/absence of each unitig on a per-sample basis. Unitigs present/absent in only a single sample were removed. Unitigs that co-occurred in the same subset of samples (i.e. perfect correlation) were clustered into a single feature ‘pattern’ for input into feature selection and ML model-building algorithms. This reduced the input from 426,647 unitig features into 94,865 pattern features. The dataset was split into 75–25% train-test ratio stratified by the country for downstream applications.</p></sec><sec id="s4-4"><title>Hierarchical classifier design</title><p>A class-prediction top-down hierarchical classifier framework was developed to be compatible with any scikit-learn classifier which generates a per-sample predicted probability value. The framework followed a Local Classifier per Node (LCN) approach as detailed in <xref ref-type="bibr" rid="bib49">Silla and Freitas, 2011</xref>, wherein a multi-class classifier was fitted at each node of the hierarchy to differentiate between the various child classes of that node. The geographical hierarchy used as the basis of the classifier was constructed using the three levels of geographical labels, region-&gt;subregion-&gt;country, assigned by UN M49 Standard for regional codes (<xref ref-type="bibr" rid="bib52">Statistics Division of the United Nations Secretariat, 2020</xref>). At each node, samples were relabeled according to the current hierarchical level (e.g. Cuba and the United States would be labeled as Americas at the root/regional node) before being passed to the classifier. Only samples in classes relevant to the current hierarchical node classifier were included in the training data for each classifier (i.e. samples from countries that were not a part of the region/subregion being trained were excluded).</p></sec><sec id="s4-5"><title>Hierarchical classification strategy</title><p>The hierarchical classifier framework allowed for the flexible assignment of samples to a single unambiguous class in the hierarchy (i.e. a single region/sub-region/country or unclassified). Samples were first classified at the root (regional) node. A classification was assigned if the predicted probabilities adhered to the threshold criteria, and the maximum probability value at that node exceeds a threshold value (0.5). Only then would the sample be passed to the next node in the hierarchy. This is not permissive of multiple, conflicting classifications.</p><p>A range of hierarchical and non-hierarchical statistics was applied to aid model assessment. Standard non-hierarchical statistics were generated for each individual classifier/node (precision, recall, micro/macro/weighted F1) as well as their hierarchical analogs (hP, hR, hF1). These were calculated as described by <xref ref-type="bibr" rid="bib29">Kiritchenko et al., 2005</xref>:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>h</mml:mi><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∩</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>|</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mstyle></mml:mfrac><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi>h</mml:mi><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>P</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∩</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>|</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mstyle></mml:mfrac></mml:mrow><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>h</mml:mi><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>h</mml:mi><mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi>h</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the set of predicted classes consisting of the most specific class (i.e. the lowest level of the hierarchy) predicted for test example <italic>i</italic> plus all parent classes and <inline-formula><mml:math id="inf2"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the set of classes consisting of the most specific true class of test example <italic>i</italic> and all its ancestor classes. Summations were calculated over all test samples. Macro hF1 was calculated by taking the average F1 of all classes of interest.</p></sec><sec id="s4-6"><title>Feature selection, resampling, model testing, and optimization</title><p>During model selection, various combinations of classifier, resampler and feature selection models were applied to the test-train dataset to assess their suitability for model building. These were assessed based on a combination of non-hierarchical statistics including overall micro/macro F1 and micro/macro F1 per hierarchical level. The implemented classifier models included K-Nearest Neighbours, Support Vector, Random Forest, Gaussian Naive Bayes, XGBoost, Extra Trees. All classifier models were implemented using scikit-learn using a set seed value and default parameters with the exception of Random Forest, Extra Trees, and XGBoost classifiers which were run with n_estimators = 1000 and SVC which was run with probability = True.</p><p>The implemented resampling schemes included downsampling (smallest class), upsampling (largest class), resampling to the mean count of all classes, and hierarchically aware implementation for the previously described samplers. Hierarchically aware resampling was developed using in-house scripts to iteratively apply a resampler to each of the lowest levels of the hierarchy (country) before passing the resampled data to higher levels in the hierarchy for further resampling.</p><p>An all-vs-all comparison of classifier vs resampler models was used to identify the most suitable combinations for further optimization (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1B</xref>). In all cases, a fixed seed value was used for the comparison of models and resamplers. The top four combinations of classifier-resampler were selected for feature selection comparison. The implemented feature selection method was Random Forest using varying numbers of patterns as training data (<xref ref-type="fig" rid="fig2">Figure 2D</xref>).</p><p>The final classifier-resampler-selection combination was passed to a genetic algorithm framework (TPOT) to identify an approximation of optimal parameters from a wide range of possible combinations (sklearn.ensemble.RandomForestClassifier': 'n_estimators': [100, 500, 1000], 'criterion': ['gini', 'entropy'], 'max_features': np.array([0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 1. ]), 'min_samples_split': range(2, 21), 'min_samples_leaf': range(1, 21), 'bootstrap': [True, False]) (<xref ref-type="bibr" rid="bib41">Olson et al., 2016</xref>). The TPOT genetic algorithm used the macro F1 score per node as the optimization metric, was run for 100 generations with a population size of 50, and stratified threefold cross-validation of the input database and was stopped if no model improvement was found for 10 generations. A ‘flat’ model was also trained and tested in the same manner for comparison, whereby a multiclass Random Forest classifier was provided with a randomly oversampled dataset which only included ‘country’ class labels (i.e. region/subregion were ignored) (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1A</xref>).</p></sec><sec id="s4-7"><title>Validation dataset collection and processing</title><p>Various public datasets were used as additional validation data including outbreaks described in previous publications (<xref ref-type="bibr" rid="bib26">Inns et al., 2017</xref>; <xref ref-type="bibr" rid="bib39">Octavia et al., 2018</xref>; <xref ref-type="bibr" rid="bib44">Pijnacker et al., 2019</xref>; <xref ref-type="bibr" rid="bib50">Smith et al., 2020</xref>) and samples identified from the NCBI Pathogen Genome database [Accessed: 18 November 2021]. In the case of samples taken from previous publications, accession numbers were identified from these manuscripts, and samples were downloaded and passed through the genome and unitig processing pipelines described above. Additionally, NCBI Pathogen Genome database metadata was downloaded [Accessed: 18 November 2021] and filtered to return only samples that had publicly accessible read files, and country metadata from the 38 countries and were collected between 2014–2018. Three representative countries were chosen to trial the model on (Poland, South Africa, and Singapore). Read data was downloaded and passed through the unitig processing pipeline as described above. The presence of unitigs generated from the UKHSA collection which formed the basis of the hML model was ascertained using <ext-link ext-link-type="uri" xlink:href="https://github.com/johnlees/unitig-counter">unitig-counter</ext-link> (<xref ref-type="bibr" rid="bib27">Jaillard et al., 2018</xref>, <xref ref-type="bibr" rid="bib30">Lees et al., 2018</xref>). The unitig features were then converted into the patterns generated from the UKHSA collection as described above.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Resources, Data curation, Software, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Data curation</p></fn><fn fn-type="con" id="con3"><p>Data curation, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Data curation, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Data curation, Supervision</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary Tables.</title><p>(<bold>A</bold>) Summary of <italic>S</italic>. Enteritidis isolates collected by the UKHSA from UK clinical patients who recently reported foreign travel to 38 individual country classes. Each panel contains a bar chart of isolate counts per year per country class. (<bold>B</bold>) Summary of the all-vs-all comparison of classifier vs resampler models used to identify the most suitable combinations for feature selection and additional optimization. The implemented resampling schemes included downsampling (smallest class), upsampling (largest class), resampling to the mean count of all classes, and hierarchically aware implementation for the previously described samplers. Hierarchically aware resampling was developed using in-house scripts to iteratively apply a resampler to each of the lowest levels of the hierarchy (country) before passing the resampled data to higher levels in the hierarchy for further resampling. Abbreviations; RF: Random Forest, KNN: K Nearest Neighbour, SVM: Support Vector Machine, GNB: Gaussian Naïve Bayes, and XGB: Xtreme Gradient Boosting. (<bold>C</bold>) The 2313 <italic>Salmonella </italic>Enteritidis sample collection was used for training and testing of the hML classifier presented in the main manuscript. All samples were collected by the UKHSA as a part of their genomic surveillance initiative. Recently recorded travel was collected as a part of the UKHSA’s ‘enhanced surveillance’ program. The columns include: SRA accession code, receipt date of isolate, SNP Address, reported country of travel, subregion, and region that the country lies within based on the UN M49 Standard for regional codes. (<bold>D</bold>) Validation dataset genomic collection and associated metadata.</p></caption><media xlink:href="elife-84167-supp1-v2.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-84167-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The final optimised hierarchical model as well as a pipeline for pre-processing raw read data to unitigs/patterns for input and paper data is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/SionBayliss/HierarchicalML">https://github.com/SionBayliss/HierarchicalML</ext-link> (copy archived at <xref ref-type="bibr" rid="bib5">Bayliss and Cowley, 2023</xref>) with a short description and tutorial for ease of use. This end-to-end process, from FASTQ to prediction, is open access and available to users under GNU GPLv2 licence . This depository also includes the preprocessed unitig datasets and resulting predictions. Short read sequencing data is available from the Sequence Read Archive (Bioproject: PRJNA248792). Please note that the sequence data has been previously deposited/published in the Sequence Read Archive by PHE/UKHSA and was not generated for this project.</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><collab>UKHSA</collab></person-group><year iso-8601-date="2018">2018</year><data-title>Public Health England - Salmonella</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/data-hub/genome/?bioproject=PRJNA248792">PRJNA248792</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>AM</given-names></name><name><surname>Tau</surname><given-names>NP</given-names></name><name><surname>Ngomane</surname><given-names>HM</given-names></name><name><surname>Sekwadi</surname><given-names>P</given-names></name><name><surname>Ramalwa</surname><given-names>N</given-names></name><name><surname>Moodley</surname><given-names>K</given-names></name><name><surname>Govind</surname><given-names>C</given-names></name><name><surname>Khan</surname><given-names>S</given-names></name><name><surname>Archary</surname><given-names>M</given-names></name><name><surname>Thomas</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Whole-genome sequencing to investigate two concurrent outbreaks of Salmonella Enteritidis in South Africa, 2018</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA646325">PRJNA646325</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Octavia</surname><given-names>S</given-names></name><name><surname>Ang</surname><given-names>MLT</given-names></name><name><surname>La</surname><given-names>MV</given-names></name><name><surname>Zulaina</surname><given-names>Siti</given-names></name><name><surname>Tien</surname><given-names>WS</given-names></name><name><surname>Han</surname><given-names>HK</given-names></name><name><surname>Ooi</surname><given-names>PL</given-names></name><name><surname>Cui</surname><given-names>Lin</given-names></name><name><surname>Lin</surname><given-names>RTP</given-names></name><name><surname>Zul</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Retrospective genome-wide comparisons of <italic>Salmonella enterica</italic> serovar Enteritidis from suspected outbreaks in Singapore</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA434621">PRJNA434621</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We would like to acknowledge both Dr. Harry Thorpe and Dr. Nicola Coyle who have both previously contributed to the development of scripts that underlie the unitig processing pipeline. This work was funded by an Academy of Medical Sciences Springboard grant (SBF005\1089). CJ, TD, and MAC are affiliated to the National Institute for Health Research Health Protection Research Unit (NIHR HPRU) in Gastrointestinal Infections and Genomics and Enabling Data at the University of Liverpool and University of Warwick, respectively in partnership with the UK Health Security Agency (UKHSA). CJ and MAC are based at UKHSA. The views expressed are those of the author(s) and not necessarily those of the NIHR, the Department of Health and Social Care, or the UK Health Security Agency.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Allard</surname><given-names>MW</given-names></name><name><surname>Bell</surname><given-names>R</given-names></name><name><surname>Ferreira</surname><given-names>CM</given-names></name><name><surname>Gonzalez-Escalona</surname><given-names>N</given-names></name><name><surname>Hoffmann</surname><given-names>M</given-names></name><name><surname>Muruvanda</surname><given-names>T</given-names></name><name><surname>Ottesen</surname><given-names>A</given-names></name><name><surname>Ramachandran</surname><given-names>P</given-names></name><name><surname>Reed</surname><given-names>E</given-names></name><name><surname>Sharma</surname><given-names>S</given-names></name><name><surname>Stevens</surname><given-names>E</given-names></name><name><surname>Timme</surname><given-names>R</given-names></name><name><surname>Zheng</surname><given-names>J</given-names></name><name><surname>Brown</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Genomics of foodborne pathogens for microbial food safety</article-title><source>Current Opinion in Biotechnology</source><volume>49</volume><fpage>224</fpage><lpage>229</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2017.11.002</pub-id><pub-id pub-id-type="pmid">29169072</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Argimón</surname><given-names>S</given-names></name><name><surname>Abudahab</surname><given-names>K</given-names></name><name><surname>Goater</surname><given-names>RJE</given-names></name><name><surname>Fedosejev</surname><given-names>A</given-names></name><name><surname>Bhai</surname><given-names>J</given-names></name><name><surname>Glasner</surname><given-names>C</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Holden</surname><given-names>MTG</given-names></name><name><surname>Yeats</surname><given-names>CA</given-names></name><name><surname>Grundmann</surname><given-names>H</given-names></name><name><surname>Spratt</surname><given-names>BG</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Microreact: visualizing and sharing data for genomic epidemiology and phylogeography</article-title><source>Microbial Genomics</source><volume>2</volume><elocation-id>e000093</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000093</pub-id><pub-id pub-id-type="pmid">28348833</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arning</surname><given-names>N</given-names></name><name><surname>Sheppard</surname><given-names>SK</given-names></name><name><surname>Bayliss</surname><given-names>S</given-names></name><name><surname>Clifton</surname><given-names>DA</given-names></name><name><surname>Wilson</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Machine learning to predict the source of campylobacteriosis using whole genome data</article-title><source>PLOS Genetics</source><volume>17</volume><elocation-id>e1009436</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1009436</pub-id><pub-id pub-id-type="pmid">34662334</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashton</surname><given-names>PM</given-names></name><name><surname>Nair</surname><given-names>S</given-names></name><name><surname>Peters</surname><given-names>TM</given-names></name><name><surname>Bale</surname><given-names>JA</given-names></name><name><surname>Powell</surname><given-names>DG</given-names></name><name><surname>Painset</surname><given-names>A</given-names></name><name><surname>Tewolde</surname><given-names>R</given-names></name><name><surname>Schaefer</surname><given-names>U</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>de Pinna</surname><given-names>EM</given-names></name><name><surname>Grant</surname><given-names>KA</given-names></name><collab>Salmonella Whole Genome Sequencing Implementation Group</collab></person-group><year iso-8601-date="2016">2016</year><article-title>Identification of salmonella for public health surveillance using whole genome sequencing</article-title><source>PeerJ</source><volume>4</volume><elocation-id>e1752</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.1752</pub-id><pub-id pub-id-type="pmid">27069781</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Bayliss</surname><given-names>S</given-names></name><name><surname>Cowley</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Hierarchical machine learning (HML)</data-title><version designator="swh:1:rev:62bdf3592243b16867de0988cacf0d409d939c11">swh:1:rev:62bdf3592243b16867de0988cacf0d409d939c11</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:fe1eb963e48d181c85a2bba04ca4ad24db3fafbd;origin=https://github.com/SionBayliss/HierarchicalML;visit=swh:1:snp:fab8e5e71eb9ce2c259d0f41dbabb1d2db1d8bca;anchor=swh:1:rev:62bdf3592243b16867de0988cacf0d409d939c11">https://archive.softwareheritage.org/swh:1:dir:fe1eb963e48d181c85a2bba04ca4ad24db3fafbd;origin=https://github.com/SionBayliss/HierarchicalML;visit=swh:1:snp:fab8e5e71eb9ce2c259d0f41dbabb1d2db1d8bca;anchor=swh:1:rev:62bdf3592243b16867de0988cacf0d409d939c11</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolger</surname><given-names>AM</given-names></name><name><surname>Lohse</surname><given-names>M</given-names></name><name><surname>Usadel</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Trimmomatic: a flexible trimmer for illumina sequence data</article-title><source>Bioinformatics</source><volume>30</volume><fpage>2114</fpage><lpage>2120</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu170</pub-id><pub-id pub-id-type="pmid">24695404</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Carey</surname><given-names>ME</given-names></name><name><surname>Dyson</surname><given-names>ZA</given-names></name><name><surname>Ingle</surname><given-names>DJ</given-names></name><name><surname>Amir</surname><given-names>A</given-names></name><name><surname>Aworh</surname><given-names>MK</given-names></name><name><surname>Chattaway</surname><given-names>MA</given-names></name><name><surname>Chew</surname><given-names>KL</given-names></name><name><surname>Crump</surname><given-names>JA</given-names></name><name><surname>Feasey</surname><given-names>NA</given-names></name><name><surname>Howden</surname><given-names>BP</given-names></name><name><surname>Keddy</surname><given-names>KH</given-names></name><name><surname>Maes</surname><given-names>M</given-names></name><name><surname>Parry</surname><given-names>CM</given-names></name><name><surname>Puyvelde</surname><given-names>SV</given-names></name><name><surname>Webb</surname><given-names>HE</given-names></name><name><surname>Afolayan</surname><given-names>AO</given-names></name><name><surname>Anandan</surname><given-names>S</given-names></name><name><surname>Andrews</surname><given-names>JR</given-names></name><name><surname>Ashton</surname><given-names>PM</given-names></name><name><surname>Basnyat</surname><given-names>B</given-names></name><name><surname>Bavdekar</surname><given-names>A</given-names></name><name><surname>Bogoch</surname><given-names>II</given-names></name><name><surname>Clemens</surname><given-names>JD</given-names></name><name><surname>da Silva</surname><given-names>KE</given-names></name><name><surname>De</surname><given-names>A</given-names></name><name><surname>de Ligt</surname><given-names>J</given-names></name><name><surname>Diaz Guevara</surname><given-names>PL</given-names></name><name><surname>Dolecek</surname><given-names>C</given-names></name><name><surname>Dutta</surname><given-names>S</given-names></name><name><surname>Watkins</surname><given-names>LF</given-names></name><name><surname>Garrett</surname><given-names>DO</given-names></name><name><surname>Godbole</surname><given-names>G</given-names></name><name><surname>Gordon</surname><given-names>MA</given-names></name><name><surname>Greenhill</surname><given-names>AR</given-names></name><name><surname>Griffin</surname><given-names>C</given-names></name><name><surname>Gupta</surname><given-names>M</given-names></name><name><surname>Hendricksen</surname><given-names>R</given-names></name><name><surname>Heyderman</surname><given-names>RS</given-names></name><name><surname>Hooda</surname><given-names>Y</given-names></name><name><surname>Hormazabal</surname><given-names>JC</given-names></name><name><surname>Ikhimiukor</surname><given-names>OO</given-names></name><name><surname>Iqbal</surname><given-names>J</given-names></name><name><surname>Jacob</surname><given-names>JJ</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Jinka</surname><given-names>DR</given-names></name><name><surname>John</surname><given-names>J</given-names></name><name><surname>Kang</surname><given-names>G</given-names></name><name><surname>Kanteh</surname><given-names>A</given-names></name><name><surname>Kapil</surname><given-names>A</given-names></name><name><surname>Karkey</surname><given-names>A</given-names></name><name><surname>Kariuki</surname><given-names>S</given-names></name><name><surname>Kingsley</surname><given-names>RA</given-names></name><name><surname>Koshy</surname><given-names>RM</given-names></name><name><surname>Lauer</surname><given-names>AC</given-names></name><name><surname>Levine</surname><given-names>MM</given-names></name><name><surname>Lingegowda</surname><given-names>RK</given-names></name><name><surname>Luby</surname><given-names>SP</given-names></name><name><surname>Mackenzie</surname><given-names>GA</given-names></name><name><surname>Mashe</surname><given-names>TA</given-names></name><name><surname>Msefula</surname><given-names>C</given-names></name><name><surname>Mutreja</surname><given-names>A</given-names></name><name><surname>Nagaraj</surname><given-names>G</given-names></name><name><surname>Nagaraj</surname><given-names>S</given-names></name><name><surname>Nair</surname><given-names>S</given-names></name><name><surname>Naseri</surname><given-names>TK</given-names></name><name><surname>Nimarota-Brown</surname><given-names>S</given-names></name><name><surname>Njamkepo</surname><given-names>E</given-names></name><name><surname>Okeke</surname><given-names>IN</given-names></name><name><surname>Perumal</surname><given-names>SPB</given-names></name><name><surname>Pollard</surname><given-names>AJ</given-names></name><name><surname>Pragasam</surname><given-names>AK</given-names></name><name><surname>Qadri</surname><given-names>F</given-names></name><name><surname>Qamar</surname><given-names>FN</given-names></name><name><surname>Rahman</surname><given-names>SIA</given-names></name><name><surname>Rambocus</surname><given-names>SD</given-names></name><name><surname>Rasko</surname><given-names>DA</given-names></name><name><surname>Ray</surname><given-names>P</given-names></name><name><surname>Robins-Browne</surname><given-names>R</given-names></name><name><surname>Rongsen-Chandola</surname><given-names>T</given-names></name><name><surname>Rutanga</surname><given-names>JP</given-names></name><name><surname>Saha</surname><given-names>SK</given-names></name><name><surname>Saha</surname><given-names>S</given-names></name><name><surname>Saigal</surname><given-names>K</given-names></name><name><surname>Sajib</surname><given-names>MSI</given-names></name><name><surname>Seidman</surname><given-names>JC</given-names></name><name><surname>Shakya</surname><given-names>J</given-names></name><name><surname>Shamanna</surname><given-names>V</given-names></name><name><surname>Shastri</surname><given-names>J</given-names></name><name><surname>Shrestha</surname><given-names>R</given-names></name><name><surname>Sia</surname><given-names>S</given-names></name><name><surname>Sikorski</surname><given-names>MJ</given-names></name><name><surname>Singh</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>AM</given-names></name><name><surname>Tagg</surname><given-names>KA</given-names></name><name><surname>Tamrakar</surname><given-names>D</given-names></name><name><surname>Tanmoy</surname><given-names>AM</given-names></name><name><surname>Thomas</surname><given-names>M</given-names></name><name><surname>Thomas</surname><given-names>MS</given-names></name><name><surname>Thomsen</surname><given-names>R</given-names></name><name><surname>Thomson</surname><given-names>NR</given-names></name><name><surname>Tupua</surname><given-names>S</given-names></name><name><surname>Vaidya</surname><given-names>K</given-names></name><name><surname>Valcanis</surname><given-names>M</given-names></name><name><surname>Veeraraghavan</surname><given-names>B</given-names></name><name><surname>Weill</surname><given-names>FX</given-names></name><name><surname>Wright</surname><given-names>J</given-names></name><name><surname>Dougan</surname><given-names>G</given-names></name><name><surname>Argimón</surname><given-names>S</given-names></name><name><surname>Keane</surname><given-names>JA</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name><name><surname>Baker</surname><given-names>S</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name><collab>Global Typhoid Genomics Consortium Group Authorship</collab></person-group><year iso-8601-date="2022">2022</year><article-title>Global Diversity and Antimicrobial Resistance of Typhoid Fever Pathogens: Insights from 13,000 Salmonella Typhi Genomes</article-title><source>medRxiv</source><pub-id pub-id-type="doi">10.1101/2022.12.28.22283969</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>Y-W</given-names></name><name><surname>Hoban</surname><given-names>A</given-names></name><name><surname>Moore</surname><given-names>H</given-names></name><name><surname>Greig</surname><given-names>DR</given-names></name><name><surname>Painset</surname><given-names>A</given-names></name><name><surname>Jorgensen</surname><given-names>F</given-names></name><name><surname>Chattaway</surname><given-names>MA</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Balasegaram</surname><given-names>S</given-names></name><name><surname>McCormick</surname><given-names>J</given-names></name><name><surname>Larkin</surname><given-names>L</given-names></name><collab>Incident Management Teams</collab></person-group><year iso-8601-date="2023">2023</year><article-title>Two outbreaks of foodborne gastrointestinal infection linked to consumption of imported melons, United Kingdom, March to August 2021</article-title><source>Journal of Food Protection</source><volume>86</volume><elocation-id>100027</elocation-id><pub-id pub-id-type="doi">10.1016/j.jfp.2022.100027</pub-id><pub-id pub-id-type="pmid">36916586</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chattaway</surname><given-names>MA</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Larkin</surname><given-names>L</given-names></name><name><surname>Nair</surname><given-names>S</given-names></name><name><surname>McCormick</surname><given-names>J</given-names></name><name><surname>Mikhail</surname><given-names>A</given-names></name><name><surname>Hartman</surname><given-names>H</given-names></name><name><surname>Godbole</surname><given-names>G</given-names></name><name><surname>Powell</surname><given-names>D</given-names></name><name><surname>Day</surname><given-names>M</given-names></name><name><surname>Smith</surname><given-names>R</given-names></name><name><surname>Grant</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The transformation of reference microbiology methods and surveillance for Salmonella with the use of whole genome sequencing in England and Wales</article-title><source>Frontiers in Public Health</source><volume>7</volume><elocation-id>317</elocation-id><pub-id pub-id-type="doi">10.3389/fpubh.2019.00317</pub-id><pub-id pub-id-type="pmid">31824904</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chattaway</surname><given-names>MA</given-names></name><name><surname>Painset</surname><given-names>A</given-names></name><name><surname>Godbole</surname><given-names>G</given-names></name><name><surname>Gharbia</surname><given-names>S</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Evaluation of genomic typing methods in the salmonella reference laboratory in public health</article-title><source>Pathogens</source><volume>12</volume><elocation-id>223</elocation-id><pub-id pub-id-type="doi">10.3390/pathogens12020223</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chikhi</surname><given-names>R</given-names></name><name><surname>Limasset</surname><given-names>A</given-names></name><name><surname>Medvedev</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Compacting de bruijn graphs from sequencing data quickly and in low memory</article-title><source>Bioinformatics</source><volume>32</volume><fpage>i201</fpage><lpage>i208</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw279</pub-id><pub-id pub-id-type="pmid">27307618</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cowley</surname><given-names>LA</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Fitzgerald</surname><given-names>S</given-names></name><name><surname>Irvine</surname><given-names>N</given-names></name><name><surname>Rooney</surname><given-names>PJ</given-names></name><name><surname>McAteer</surname><given-names>SP</given-names></name><name><surname>Day</surname><given-names>M</given-names></name><name><surname>Perry</surname><given-names>NT</given-names></name><name><surname>Bono</surname><given-names>JL</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Gally</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Short-Term evolution of Shiga toxin-producing <italic>Escherichia coli</italic> O157: H7 between two food-borne outbreaks</article-title><source>Microbial Genomics</source><volume>2</volume><elocation-id>e000084</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000084</pub-id><pub-id pub-id-type="pmid">28348875</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dallman</surname><given-names>T</given-names></name><name><surname>Inns</surname><given-names>T</given-names></name><name><surname>Jombart</surname><given-names>T</given-names></name><name><surname>Ashton</surname><given-names>P</given-names></name><name><surname>Loman</surname><given-names>N</given-names></name><name><surname>Chatt</surname><given-names>C</given-names></name><name><surname>Messelhaeusser</surname><given-names>U</given-names></name><name><surname>Rabsch</surname><given-names>W</given-names></name><name><surname>Simon</surname><given-names>S</given-names></name><name><surname>Nikisins</surname><given-names>S</given-names></name><name><surname>Bernard</surname><given-names>H</given-names></name><name><surname>le Hello</surname><given-names>S</given-names></name><name><surname>Jourdan da-Silva</surname><given-names>N</given-names></name><name><surname>Kornschober</surname><given-names>C</given-names></name><name><surname>Mossong</surname><given-names>J</given-names></name><name><surname>Hawkey</surname><given-names>P</given-names></name><name><surname>de Pinna</surname><given-names>E</given-names></name><name><surname>Grant</surname><given-names>K</given-names></name><name><surname>Cleary</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Phylogenetic structure of European Salmonella enteritidis outbreak correlates with national and international egg distribution network</article-title><source>Microbial Genomics</source><volume>2</volume><elocation-id>e000070</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000070</pub-id><pub-id pub-id-type="pmid">28348865</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dallman</surname><given-names>T</given-names></name><name><surname>Ashton</surname><given-names>P</given-names></name><name><surname>Schafer</surname><given-names>U</given-names></name><name><surname>Jironkin</surname><given-names>A</given-names></name><name><surname>Painset</surname><given-names>A</given-names></name><name><surname>Shaaban</surname><given-names>S</given-names></name><name><surname>Hartman</surname><given-names>H</given-names></name><name><surname>Myers</surname><given-names>R</given-names></name><name><surname>Underwood</surname><given-names>A</given-names></name><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Grant</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SnapperDB: a database solution for routine sequencing analysis of bacterial isolates</article-title><source>Bioinformatics</source><volume>34</volume><fpage>3028</fpage><lpage>3029</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bty212</pub-id><pub-id pub-id-type="pmid">29659710</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Daniel</surname><given-names>N</given-names></name><name><surname>Casadevall</surname><given-names>N</given-names></name><name><surname>Sun</surname><given-names>P</given-names></name><name><surname>Sugden</surname><given-names>D</given-names></name><name><surname>Aldin</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><source>The Burden of Foodborne Disease in the UK 2018</source><publisher-name>Food Standards Agency</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><collab>Department for Transport</collab></person-group><year iso-8601-date="2018">2018</year><source>Dynamic Surveying for Aviation: Business Passengers</source><publisher-name>Department for Transport</publisher-name></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><collab>Department of Transport</collab></person-group><year iso-8601-date="2018">2018</year><source>Dynamic Surveying for Aviation: Foreign Residents and Surface Access</source><publisher-name>European Commission</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donker</surname><given-names>T</given-names></name><name><surname>Reuter</surname><given-names>S</given-names></name><name><surname>Scriberras</surname><given-names>J</given-names></name><name><surname>Reynolds</surname><given-names>R</given-names></name><name><surname>Brown</surname><given-names>NM</given-names></name><name><surname>Török</surname><given-names>ME</given-names></name><name><surname>James</surname><given-names>R</given-names></name><name><surname>Network</surname><given-names>E</given-names></name><name><surname>Aanensen</surname><given-names>DM</given-names></name><name><surname>Bentley</surname><given-names>SD</given-names></name><name><surname>Holden</surname><given-names>MTG</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name><name><surname>Spratt</surname><given-names>BG</given-names></name><name><surname>Peacock</surname><given-names>SJ</given-names></name><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Grundmann</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Population genetic structuring of methicillin-resistant <italic>Staphylococcus aureus</italic> clone EMRSA-15 within UK reflects patient referral patterns</article-title><source>Microbial Genomics</source><volume>3</volume><elocation-id>e000113</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000113</pub-id><pub-id pub-id-type="pmid">29026654</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebel</surname><given-names>ED</given-names></name><name><surname>Williams</surname><given-names>MS</given-names></name><name><surname>Cole</surname><given-names>D</given-names></name><name><surname>Travis</surname><given-names>CC</given-names></name><name><surname>Klontz</surname><given-names>KC</given-names></name><name><surname>Golden</surname><given-names>NJ</given-names></name><name><surname>Hoekstra</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Comparing characteristics of sporadic and outbreak-associated foodborne illnesses, United States, 2004-2011</article-title><source>Emerging Infectious Diseases</source><volume>22</volume><fpage>1193</fpage><lpage>1200</lpage><pub-id pub-id-type="doi">10.3201/eid2207.150833</pub-id><pub-id pub-id-type="pmid">27314510</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>European Food Safety Authority</collab><collab>European Centre for Disease Prevention and Control</collab></person-group><year iso-8601-date="2017">2017</year><article-title>The european union summary report on trends and sources of zoonoses, zoonotic agents and food-borne outbreaks in 2016</article-title><source>EFSA Journal. European Food Safety Authority</source><volume>15</volume><elocation-id>e05077</elocation-id><pub-id pub-id-type="doi">10.2903/j.efsa.2017.5077</pub-id><pub-id pub-id-type="pmid">32625371</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feasey</surname><given-names>NA</given-names></name><name><surname>Hadfield</surname><given-names>J</given-names></name><name><surname>Keddy</surname><given-names>KH</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Jacobs</surname><given-names>J</given-names></name><name><surname>Deng</surname><given-names>X</given-names></name><name><surname>Wigley</surname><given-names>P</given-names></name><name><surname>Barquist</surname><given-names>L</given-names></name><name><surname>Langridge</surname><given-names>GC</given-names></name><name><surname>Feltwell</surname><given-names>T</given-names></name><name><surname>Harris</surname><given-names>SR</given-names></name><name><surname>Mather</surname><given-names>AE</given-names></name><name><surname>Fookes</surname><given-names>M</given-names></name><name><surname>Aslett</surname><given-names>M</given-names></name><name><surname>Msefula</surname><given-names>C</given-names></name><name><surname>Kariuki</surname><given-names>S</given-names></name><name><surname>Maclennan</surname><given-names>CA</given-names></name><name><surname>Onsare</surname><given-names>RS</given-names></name><name><surname>Weill</surname><given-names>F-X</given-names></name><name><surname>Le Hello</surname><given-names>S</given-names></name><name><surname>Smith</surname><given-names>AM</given-names></name><name><surname>McClelland</surname><given-names>M</given-names></name><name><surname>Desai</surname><given-names>P</given-names></name><name><surname>Parry</surname><given-names>CM</given-names></name><name><surname>Cheesbrough</surname><given-names>J</given-names></name><name><surname>French</surname><given-names>N</given-names></name><name><surname>Campos</surname><given-names>J</given-names></name><name><surname>Chabalgoity</surname><given-names>JA</given-names></name><name><surname>Betancor</surname><given-names>L</given-names></name><name><surname>Hopkins</surname><given-names>KL</given-names></name><name><surname>Nair</surname><given-names>S</given-names></name><name><surname>Humphrey</surname><given-names>TJ</given-names></name><name><surname>Lunguya</surname><given-names>O</given-names></name><name><surname>Cogan</surname><given-names>TA</given-names></name><name><surname>Tapia</surname><given-names>MD</given-names></name><name><surname>Sow</surname><given-names>SO</given-names></name><name><surname>Tennant</surname><given-names>SM</given-names></name><name><surname>Bornstein</surname><given-names>K</given-names></name><name><surname>Levine</surname><given-names>MM</given-names></name><name><surname>Lacharme-Lora</surname><given-names>L</given-names></name><name><surname>Everett</surname><given-names>DB</given-names></name><name><surname>Kingsley</surname><given-names>RA</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name><name><surname>Heyderman</surname><given-names>RS</given-names></name><name><surname>Dougan</surname><given-names>G</given-names></name><name><surname>Gordon</surname><given-names>MA</given-names></name><name><surname>Thomson</surname><given-names>NR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Distinct Salmonella enteritidis lineages associated with enterocolitis in high-income settings and invasive disease in low-income settings</article-title><source>Nature Genetics</source><volume>48</volume><fpage>1211</fpage><lpage>1217</lpage><pub-id pub-id-type="doi">10.1038/ng.3644</pub-id><pub-id pub-id-type="pmid">27548315</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feil</surname><given-names>EJ</given-names></name><name><surname>Spratt</surname><given-names>BG</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Recombination and the population structures of bacterial pathogens</article-title><source>Annual Review of Microbiology</source><volume>55</volume><fpage>561</fpage><lpage>590</lpage><pub-id pub-id-type="doi">10.1146/annurev.micro.55.1.561</pub-id><pub-id pub-id-type="pmid">11544367</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gould</surname><given-names>LH</given-names></name><name><surname>Kline</surname><given-names>J</given-names></name><name><surname>Monahan</surname><given-names>C</given-names></name><name><surname>Vierk</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Outbreaks of disease associated with food imported into the united states, 1996-2014<sup>1</sup></article-title><source>Emerging Infectious Diseases</source><volume>23</volume><fpage>525</fpage><lpage>528</lpage><pub-id pub-id-type="doi">10.3201/eid2303.161462</pub-id><pub-id pub-id-type="pmid">28221117</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Holley</surname><given-names>G</given-names></name><name><surname>Melsted</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Bifrost: highly parallel construction and indexing of colored and compacted de Bruijn graphs</article-title><source>Genome Biology</source><volume>21</volume><elocation-id>249</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-020-02135-8</pub-id><pub-id pub-id-type="pmid">32943081</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingle</surname><given-names>DJ</given-names></name><name><surname>Levine</surname><given-names>MM</given-names></name><name><surname>Kotloff</surname><given-names>KL</given-names></name><name><surname>Holt</surname><given-names>KE</given-names></name><name><surname>Robins-Browne</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dynamics of antimicrobial resistance in intestinal <italic>Escherichia coli</italic> from children in community settings in South Asia and Sub-Saharan Africa</article-title><source>Nature Microbiology</source><volume>3</volume><fpage>1063</fpage><lpage>1073</lpage><pub-id pub-id-type="doi">10.1038/s41564-018-0217-4</pub-id><pub-id pub-id-type="pmid">30127495</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Inns</surname><given-names>T</given-names></name><name><surname>Ashton</surname><given-names>PM</given-names></name><name><surname>Herrera-leon</surname><given-names>S</given-names></name><name><surname>Lighthill</surname><given-names>J</given-names></name><name><surname>Foulkes</surname><given-names>S</given-names></name><name><surname>Jombart</surname><given-names>T</given-names></name><name><surname>Rehman</surname><given-names>Y</given-names></name><name><surname>Fox</surname><given-names>A</given-names></name><name><surname>Dallman</surname><given-names>T</given-names></name><name><surname>De Pinna</surname><given-names>E</given-names></name><name><surname>Browning</surname><given-names>L</given-names></name><name><surname>Coia</surname><given-names>JE</given-names></name><name><surname>Edeghere</surname><given-names>O</given-names></name><name><surname>Vivancos</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Prospective use of whole genome sequencing (WGS) detected a multi-country outbreak of Salmonella enteritidis</article-title><source>Epidemiology and Infection</source><volume>145</volume><fpage>289</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1017/S0950268816001941</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jaillard</surname><given-names>M</given-names></name><name><surname>Lima</surname><given-names>L</given-names></name><name><surname>Tournoud</surname><given-names>M</given-names></name><name><surname>Mahé</surname><given-names>P</given-names></name><name><surname>van Belkum</surname><given-names>A</given-names></name><name><surname>Lacroix</surname><given-names>V</given-names></name><name><surname>Jacob</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A fast and agnostic method for bacterial genome-wide association studies: bridging the gap between k-mers and genetic events</article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007758</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007758</pub-id><pub-id pub-id-type="pmid">30419019</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Grant</surname><given-names>KA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Impact of whole genome sequencing on the investigation of food-borne outbreaks of shiga toxin-producing <italic>Escherichia coli</italic> serogroup O157:H7, England, 2013 to 2017</article-title><source>Euro Surveillance</source><volume>24</volume><elocation-id>1800346</elocation-id><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2019.24.4.1800346</pub-id><pub-id pub-id-type="pmid">30696532</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kiritchenko</surname><given-names>S</given-names></name><name><surname>Matwin</surname><given-names>S</given-names></name><name><surname>Famili</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Functional Annotation of Genes Using Hierarchical Text Categorization</article-title><conf-name>Proceedings of BioLink SIG, ISMB</conf-name></element-citation></ref><ref id="bib30"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lees</surname><given-names>J</given-names></name><name><surname>Puranen</surname><given-names>S</given-names></name><name><surname>Cantwell</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Unitig-counter</data-title><version designator="a3fd54d">a3fd54d</version><source>GitHub</source><ext-link ext-link-type="uri" xlink:href="https://github.com/bacpop/unitig-counter">https://github.com/bacpop/unitig-counter</ext-link></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>S</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Mann</surname><given-names>DA</given-names></name><name><surname>Deng</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Global spread of Salmonella enteritidis via centralized sourcing and international trade of poultry breeding stocks</article-title><source>Nature Communications</source><volume>12</volume><elocation-id>5109</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-021-25319-7</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lupolova</surname><given-names>N</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Holden</surname><given-names>NJ</given-names></name><name><surname>Gally</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Patchy promiscuity: machine learning applied to predict the host specificity of <italic>Salmonella enterica</italic> and <italic>Escherichia coli</italic></article-title><source>Microbial Genomics</source><volume>3</volume><elocation-id>e000135</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000135</pub-id><pub-id pub-id-type="pmid">29177093</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lupolova</surname><given-names>N</given-names></name><name><surname>Lycett</surname><given-names>SJ</given-names></name><name><surname>Gally</surname><given-names>DL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A guide to machine learning for bacterial host attribution using genome sequence data</article-title><source>Microbial Genomics</source><volume>5</volume><elocation-id>e000317</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000317</pub-id><pub-id pub-id-type="pmid">31778355</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLauchlin</surname><given-names>J</given-names></name><name><surname>Aird</surname><given-names>H</given-names></name><name><surname>Andrews</surname><given-names>N</given-names></name><name><surname>Chattaway</surname><given-names>M</given-names></name><name><surname>de Pinna</surname><given-names>E</given-names></name><name><surname>Elviss</surname><given-names>N</given-names></name><name><surname>Jørgensen</surname><given-names>F</given-names></name><name><surname>Larkin</surname><given-names>L</given-names></name><name><surname>Willis</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Public health risks associated with Salmonella contamination of imported edible betel leaves: analysis of results from England, 2011-2017</article-title><source>International Journal of Food Microbiology</source><volume>298</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.ijfoodmicro.2019.03.004</pub-id><pub-id pub-id-type="pmid">30889473</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>P</given-names></name><name><surname>Marshall</surname><given-names>J</given-names></name><name><surname>French</surname><given-names>N</given-names></name><name><surname>Jewell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SourceR: classification and source Attribution of infectious agents among heterogeneous populations</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005564</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005564</pub-id><pub-id pub-id-type="pmid">28558033</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mughini-Gras</surname><given-names>L</given-names></name><name><surname>Kooh</surname><given-names>P</given-names></name><name><surname>Augustin</surname><given-names>JC</given-names></name><name><surname>David</surname><given-names>J</given-names></name><name><surname>Fravalo</surname><given-names>P</given-names></name><name><surname>Guillier</surname><given-names>L</given-names></name><name><surname>Jourdan-Da-Silva</surname><given-names>N</given-names></name><name><surname>Thébault</surname><given-names>A</given-names></name><name><surname>Sanaa</surname><given-names>M</given-names></name><name><surname>Watier</surname><given-names>L</given-names></name><collab>Anses Working Group on Source Attribution of Foodborne Diseases</collab></person-group><year iso-8601-date="2018">2018</year><article-title>Source attribution of foodborne diseases: potentialities, hurdles, and future expectations</article-title><source>Frontiers in Microbiology</source><volume>9</volume><elocation-id>1983</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2018.01983</pub-id><pub-id pub-id-type="pmid">30233509</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Munck</surname><given-names>N</given-names></name><name><surname>Njage</surname><given-names>PMK</given-names></name><name><surname>Leekitcharoenphon</surname><given-names>P</given-names></name><name><surname>Litrup</surname><given-names>E</given-names></name><name><surname>Hald</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Application of whole-genome sequences and machine learning in source Attribution of Salmonella typhimurium</article-title><source>Risk Analysis</source><volume>40</volume><fpage>1693</fpage><lpage>1705</lpage><pub-id pub-id-type="doi">10.1111/risa.13510</pub-id><pub-id pub-id-type="pmid">32515055</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>L-T</given-names></name><name><surname>Schmidt</surname><given-names>HA</given-names></name><name><surname>von Haeseler</surname><given-names>A</given-names></name><name><surname>Minh</surname><given-names>BQ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title><source>Molecular Biology and Evolution</source><volume>32</volume><fpage>268</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id><pub-id pub-id-type="pmid">25371430</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Octavia</surname><given-names>S</given-names></name><name><surname>Ang</surname><given-names>MLT</given-names></name><name><surname>La</surname><given-names>MV</given-names></name><name><surname>Zulaina</surname><given-names>S</given-names></name><name><surname>Saat</surname><given-names>ZAAS</given-names></name><name><surname>Tien</surname><given-names>WS</given-names></name><name><surname>Han</surname><given-names>HK</given-names></name><name><surname>Ooi</surname><given-names>PL</given-names></name><name><surname>Cui</surname><given-names>L</given-names></name><name><surname>Lin</surname><given-names>RTP</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Retrospective genome-wide comparisons of <italic>Salmonella enterica</italic> serovar enteritidis from suspected outbreaks in Singapore</article-title><source>Infection, Genetics and Evolution</source><volume>61</volume><fpage>229</fpage><lpage>233</lpage><pub-id pub-id-type="doi">10.1016/j.meegid.2018.04.004</pub-id><pub-id pub-id-type="pmid">29625239</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="web"><person-group person-group-type="author"><collab>Office of National Statistics</collab></person-group><year iso-8601-date="2020">2020</year><article-title>Travel trends estimates: UK residents‘ visits abroad: 2009-2019</article-title><ext-link ext-link-type="uri" xlink:href="https://www.ons.gov.uk/peoplepopulationandcommunity/leisureandtourism/datasets/ukresidentsvisitsabroad">https://www.ons.gov.uk/peoplepopulationandcommunity/leisureandtourism/datasets/ukresidentsvisitsabroad</ext-link><date-in-citation iso-8601-date="2022-02-14">February 14, 2022</date-in-citation></element-citation></ref><ref id="bib41"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>RS</given-names></name><name><surname>Bartley</surname><given-names>N</given-names></name><name><surname>Urbanowicz</surname><given-names>RJ</given-names></name><name><surname>Moore</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Evaluation of a Tree-based Pipeline Optimization Tool for Automating Data ScienceProceedings of the Genetic and Evolutionary Computation Conference 2016</article-title><conf-name>GECCO ’16: Proceedings of the Genetic and Evolutionary Computation Conference 2016</conf-name><conf-loc>New York</conf-loc><fpage>485</fpage><lpage>492</lpage></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Page</surname><given-names>AJ</given-names></name><name><surname>Taylor</surname><given-names>B</given-names></name><name><surname>Delaney</surname><given-names>AJ</given-names></name><name><surname>Soares</surname><given-names>J</given-names></name><name><surname>Seemann</surname><given-names>T</given-names></name><name><surname>Keane</surname><given-names>JA</given-names></name><name><surname>Harris</surname><given-names>SR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>SNP-sites: rapid efficient extraction of snps from multi-FASTA alignments</article-title><source>Microbial Genomics</source><volume>2</volume><elocation-id>56</elocation-id><pub-id pub-id-type="doi">10.1099/mgen.0.000056</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="book"><person-group person-group-type="author"><collab>PHE</collab></person-group><year iso-8601-date="2017">2017</year><source>Travel-Associated Non Typhoidal Salmonella Infection in England, Wales and Northern Ireland: 2014</source><publisher-name>PHE</publisher-name></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pijnacker</surname><given-names>R</given-names></name><name><surname>Dallman</surname><given-names>TJ</given-names></name><name><surname>Tijsma</surname><given-names>ASL</given-names></name><name><surname>Hawkins</surname><given-names>G</given-names></name><name><surname>Larkin</surname><given-names>L</given-names></name><name><surname>Kotila</surname><given-names>SM</given-names></name><name><surname>Amore</surname><given-names>G</given-names></name><name><surname>Amato</surname><given-names>E</given-names></name><name><surname>Suzuki</surname><given-names>PM</given-names></name><name><surname>Denayer</surname><given-names>S</given-names></name><name><surname>Klamer</surname><given-names>S</given-names></name><name><surname>Pászti</surname><given-names>J</given-names></name><name><surname>McCormick</surname><given-names>J</given-names></name><name><surname>Hartman</surname><given-names>H</given-names></name><name><surname>Hughes</surname><given-names>GJ</given-names></name><name><surname>Brandal</surname><given-names>LCT</given-names></name><name><surname>Brown</surname><given-names>D</given-names></name><name><surname>Mossong</surname><given-names>J</given-names></name><name><surname>Jernberg</surname><given-names>C</given-names></name><name><surname>Müller</surname><given-names>L</given-names></name><name><surname>Palm</surname><given-names>D</given-names></name><name><surname>Severi</surname><given-names>E</given-names></name><name><surname>Gołębiowska</surname><given-names>J</given-names></name><name><surname>Hunjak</surname><given-names>B</given-names></name><name><surname>Owczarek</surname><given-names>S</given-names></name><name><surname>Le Hello</surname><given-names>S</given-names></name><name><surname>Garvey</surname><given-names>P</given-names></name><name><surname>Mooijman</surname><given-names>K</given-names></name><name><surname>Friesema</surname><given-names>IHM</given-names></name><name><surname>van der Weijden</surname><given-names>C</given-names></name><name><surname>van der Voort</surname><given-names>M</given-names></name><name><surname>Rizzi</surname><given-names>V</given-names></name><name><surname>Franz</surname><given-names>E</given-names></name><collab>International Outbreak Investigation Team</collab></person-group><year iso-8601-date="2019">2019</year><article-title>An international outbreak of <italic>Salmonella enterica</italic> serotype enteritidis linked to eggs from Poland: a microbiological and epidemiological study</article-title><source>The Lancet. Infectious Diseases</source><volume>19</volume><fpage>778</fpage><lpage>786</lpage><pub-id pub-id-type="doi">10.1016/S1473-3099(19)30047-7</pub-id><pub-id pub-id-type="pmid">31133519</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pires</surname><given-names>SM</given-names></name><name><surname>Evers</surname><given-names>EG</given-names></name><name><surname>van Pelt</surname><given-names>W</given-names></name><name><surname>Ayers</surname><given-names>T</given-names></name><name><surname>Scallan</surname><given-names>E</given-names></name><name><surname>Angulo</surname><given-names>FJ</given-names></name><name><surname>Havelaar</surname><given-names>A</given-names></name><name><surname>Hald</surname><given-names>T</given-names></name><collab>Med-Vet-Net Workpackage 28 Working Group</collab></person-group><year iso-8601-date="2009">2009</year><article-title>Attributing the human disease burden of foodborne infections to specific sources</article-title><source>Foodborne Pathogens and Disease</source><volume>6</volume><fpage>417</fpage><lpage>424</lpage><pub-id pub-id-type="doi">10.1089/fpd.2008.0208</pub-id><pub-id pub-id-type="pmid">19415971</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>JK</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Donnelly</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Inference of population structure using multilocus genotype data</article-title><source>Genetics</source><volume>155</volume><fpage>945</fpage><lpage>959</lpage><pub-id pub-id-type="doi">10.1093/genetics/155.2.945</pub-id><pub-id pub-id-type="pmid">10835412</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravel</surname><given-names>A</given-names></name><name><surname>Hurst</surname><given-names>M</given-names></name><name><surname>Petrica</surname><given-names>N</given-names></name><name><surname>David</surname><given-names>J</given-names></name><name><surname>Mutschall</surname><given-names>SK</given-names></name><name><surname>Pintar</surname><given-names>K</given-names></name><name><surname>Taboada</surname><given-names>EN</given-names></name><name><surname>Pollari</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Source Attribution of human campylobacteriosis at the point of exposure by combining comparative exposure assessment and subtype comparison based on comparative genomic fingerprinting</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0183790</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0183790</pub-id><pub-id pub-id-type="pmid">28837643</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Seemann</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Snippy</data-title><version designator="2af674c">2af674c</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</ext-link></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Silla</surname><given-names>CN</given-names></name><name><surname>Freitas</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A survey of hierarchical classification across different application domains</article-title><source>Data Mining and Knowledge Discovery</source><volume>22</volume><fpage>31</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1007/s10618-010-0175-9</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>AM</given-names></name><name><surname>Tau</surname><given-names>NP</given-names></name><name><surname>Ngomane</surname><given-names>HM</given-names></name><name><surname>Sekwadi</surname><given-names>P</given-names></name><name><surname>Ramalwa</surname><given-names>N</given-names></name><name><surname>Moodley</surname><given-names>K</given-names></name><name><surname>Govind</surname><given-names>C</given-names></name><name><surname>Khan</surname><given-names>S</given-names></name><name><surname>Archary</surname><given-names>M</given-names></name><name><surname>Thomas</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Whole-genome sequencing to investigate two concurrent outbreaks of <italic>salmonella</italic> enteritidis in South Africa, 2018</article-title><source>Journal of Medical Microbiology</source><volume>69</volume><fpage>1303</fpage><lpage>1307</lpage><pub-id pub-id-type="doi">10.1099/jmm.0.001255</pub-id><pub-id pub-id-type="pmid">33048044</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Somorin</surname><given-names>YM</given-names></name><name><surname>Odeyemi</surname><given-names>OA</given-names></name><name><surname>Ateba</surname><given-names>CN</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Salmonella is the most common foodborne pathogen in African food exports to the European Union: analysis of the rapid alert system for food and feed (1999–2019)</article-title><source>Food Control</source><volume>123</volume><elocation-id>107849</elocation-id><pub-id pub-id-type="doi">10.1016/j.foodcont.2020.107849</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="web"><person-group person-group-type="author"><collab>Statistics Division of the United Nations Secretariat</collab></person-group><year iso-8601-date="2020">2020</year><article-title>Standard country or area codes for statistical use (M49). United Nations</article-title><ext-link ext-link-type="uri" xlink:href="https://unstats.un.org/unsd/methodology/m49/">https://unstats.un.org/unsd/methodology/m49/</ext-link><date-in-citation iso-8601-date="2021-11-30">November 30, 2021</date-in-citation></element-citation></ref><ref id="bib53"><element-citation publication-type="book"><person-group person-group-type="author"><collab>Surveillance, Zoonoses, Epidemiology and Risk Food and Farming Group</collab></person-group><year iso-8601-date="2007">2007</year><source>UK National Control Programme for Salmonella in Layers Gallus Gallus</source><publisher-name>DEFRA</publisher-name></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tam</surname><given-names>CC</given-names></name><name><surname>Rodrigues</surname><given-names>LC</given-names></name><name><surname>Viviani</surname><given-names>L</given-names></name><name><surname>Dodds</surname><given-names>JP</given-names></name><name><surname>Evans</surname><given-names>MR</given-names></name><name><surname>Hunter</surname><given-names>PR</given-names></name><name><surname>Gray</surname><given-names>JJ</given-names></name><name><surname>Letley</surname><given-names>LH</given-names></name><name><surname>Rait</surname><given-names>G</given-names></name><name><surname>Tompkins</surname><given-names>DS</given-names></name><name><surname>O’Brien</surname><given-names>SJ</given-names></name><collab>IID2 Study Executive Committee</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Longitudinal study of infectious intestinal disease in the UK (IID2 study): incidence in the community and presenting to general practice</article-title><source>Gut</source><volume>61</volume><fpage>69</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1136/gut.2011.238386</pub-id><pub-id pub-id-type="pmid">21708822</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanui</surname><given-names>CK</given-names></name><name><surname>Benefo</surname><given-names>EO</given-names></name><name><surname>Karanth</surname><given-names>S</given-names></name><name><surname>Pradhan</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A machine learning model for food source Attribution of Listeria monocytogenes</article-title><source>Pathogens</source><volume>11</volume><elocation-id>691</elocation-id><pub-id pub-id-type="doi">10.3390/pathogens11060691</pub-id><pub-id pub-id-type="pmid">35745545</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>NR</given-names></name><name><surname>Clayton</surname><given-names>DJ</given-names></name><name><surname>Windhorst</surname><given-names>D</given-names></name><name><surname>Vernikos</surname><given-names>G</given-names></name><name><surname>Davidson</surname><given-names>S</given-names></name><name><surname>Churcher</surname><given-names>C</given-names></name><name><surname>Quail</surname><given-names>MA</given-names></name><name><surname>Stevens</surname><given-names>M</given-names></name><name><surname>Jones</surname><given-names>MA</given-names></name><name><surname>Watson</surname><given-names>M</given-names></name><name><surname>Barron</surname><given-names>A</given-names></name><name><surname>Layton</surname><given-names>A</given-names></name><name><surname>Pickard</surname><given-names>D</given-names></name><name><surname>Kingsley</surname><given-names>RA</given-names></name><name><surname>Bignell</surname><given-names>A</given-names></name><name><surname>Clark</surname><given-names>L</given-names></name><name><surname>Harris</surname><given-names>B</given-names></name><name><surname>Ormond</surname><given-names>D</given-names></name><name><surname>Abdellah</surname><given-names>Z</given-names></name><name><surname>Brooks</surname><given-names>K</given-names></name><name><surname>Cherevach</surname><given-names>I</given-names></name><name><surname>Chillingworth</surname><given-names>T</given-names></name><name><surname>Woodward</surname><given-names>J</given-names></name><name><surname>Norberczak</surname><given-names>H</given-names></name><name><surname>Lord</surname><given-names>A</given-names></name><name><surname>Arrowsmith</surname><given-names>C</given-names></name><name><surname>Jagels</surname><given-names>K</given-names></name><name><surname>Moule</surname><given-names>S</given-names></name><name><surname>Mungall</surname><given-names>K</given-names></name><name><surname>Sanders</surname><given-names>M</given-names></name><name><surname>Whitehead</surname><given-names>S</given-names></name><name><surname>Chabalgoity</surname><given-names>JA</given-names></name><name><surname>Maskell</surname><given-names>D</given-names></name><name><surname>Humphrey</surname><given-names>T</given-names></name><name><surname>Roberts</surname><given-names>M</given-names></name><name><surname>Barrow</surname><given-names>PA</given-names></name><name><surname>Dougan</surname><given-names>G</given-names></name><name><surname>Parkhill</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Comparative genome analysis of Salmonella enteritidis PT4 and Salmonella gallinarum 287/91 provides insights into evolutionary and host adaptation pathways</article-title><source>Genome Research</source><volume>18</volume><fpage>1624</fpage><lpage>1637</lpage><pub-id pub-id-type="doi">10.1101/gr.077404.108</pub-id><pub-id pub-id-type="pmid">18583645</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="web"><person-group person-group-type="author"><collab>UKHSA</collab></person-group><year iso-8601-date="2021">2021</year><article-title>Non-typhoidal Salmonella data 2010 to 2019</article-title><ext-link ext-link-type="uri" xlink:href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1026208/salmonella-annual-report-2019.pdf">https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/1026208/salmonella-annual-report-2019.pdf</ext-link><date-in-citation iso-8601-date="2021-03-01">March 1, 2021</date-in-citation></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wheeler</surname><given-names>NE</given-names></name><name><surname>Gardner</surname><given-names>PP</given-names></name><name><surname>Barquist</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Machine learning identifies signatures of host adaptation in the bacterial pathogen <italic>Salmonella enterica</italic></article-title><source>PLOS Genetics</source><volume>14</volume><elocation-id>e1007333</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1007333</pub-id><pub-id pub-id-type="pmid">29738521</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="web"><person-group person-group-type="author"><collab>WHO</collab></person-group><year iso-8601-date="2022">2022</year><article-title>Factsheet: Non-typhoidal Salmonella</article-title><ext-link ext-link-type="uri" xlink:href="https://www.who.int/news-room/fact-sheets/detail/salmonella-(non-typhoidal)">https://www.who.int/news-room/fact-sheets/detail/salmonella-(non-typhoidal)</ext-link><date-in-citation iso-8601-date="2021-03-01">March 1, 2021</date-in-citation></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>DJ</given-names></name><name><surname>Gabriel</surname><given-names>E</given-names></name><name><surname>Leatherbarrow</surname><given-names>AJH</given-names></name><name><surname>Cheesbrough</surname><given-names>J</given-names></name><name><surname>Gee</surname><given-names>S</given-names></name><name><surname>Bolton</surname><given-names>E</given-names></name><name><surname>Fox</surname><given-names>A</given-names></name><name><surname>Fearnhead</surname><given-names>P</given-names></name><name><surname>Hart</surname><given-names>CA</given-names></name><name><surname>Diggle</surname><given-names>PJ</given-names></name><name><surname>Guttman</surname><given-names>DS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Tracing the source of campylobacteriosis</article-title><source>PLOS Genetics</source><volume>4</volume><elocation-id>e1000203</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1000203</pub-id><pub-id pub-id-type="pmid">18818764</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Li</surname><given-names>S</given-names></name><name><surname>Gu</surname><given-names>W</given-names></name><name><surname>den Bakker</surname><given-names>H</given-names></name><name><surname>Boxrud</surname><given-names>D</given-names></name><name><surname>Taylor</surname><given-names>A</given-names></name><name><surname>Roe</surname><given-names>C</given-names></name><name><surname>Driebe</surname><given-names>E</given-names></name><name><surname>Engelthaler</surname><given-names>DM</given-names></name><name><surname>Allard</surname><given-names>M</given-names></name><name><surname>Brown</surname><given-names>E</given-names></name><name><surname>McDermott</surname><given-names>P</given-names></name><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Bruce</surname><given-names>BB</given-names></name><name><surname>Trees</surname><given-names>E</given-names></name><name><surname>Fields</surname><given-names>PI</given-names></name><name><surname>Deng</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Zoonotic source attribution of <italic>Salmonella enterica</italic> serotype typhimurium using genomic surveillance data, United States</article-title><source>Emerging Infectious Diseases</source><volume>25</volume><fpage>82</fpage><lpage>91</lpage><pub-id pub-id-type="doi">10.3201/eid2501.180835</pub-id><pub-id pub-id-type="pmid">30561314</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.84167.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cooper</surname><given-names>Ben S</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2022.08.23.22279111" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.23.22279111"/></front-stub><body><p>This important study presents a machine learning-based classifier that can accurately determine the geographic origin of a <italic>Salmonella enterica</italic> sample from its whole-genome sequencing data in under five minutes leading to actionable public health insights. Applying the method to 2,313 whole genome sequences collected in the United Kingdom and several external validation datasets, the authors provide convincing evidence that <italic>Salmonella</italic> genomic data can be used to identify the likely geographic source of a food-borne outbreak and, in most cases, correctly identify the country of origin of an infection acquired overseas. The work presents an excellent case for the potential utility of routine genomics coupled with machine learning for public health microbiology and the methods are likely to be applicable to other pathogens besides <italic>Salmonella enterica</italic>.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.84167.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Cooper</surname><given-names>Ben S</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/052gg0110</institution-id><institution>University of Oxford</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Wheeler</surname><given-names>Nicole E</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03angcq70</institution-id><institution>University of Birmingham</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Chindelevitch</surname><given-names>Leonid</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/041kmwe10</institution-id><institution>Imperial College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2022.08.23.22279111">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.medrxiv.org/content/10.1101/2022.08.23.22279111v1.full">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Rapid geographical source attribution of <italic>Salmonella enterica</italic> serovar Enteritidis genomes using hierarchical machine learning&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Neil Ferguson as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Nicole E Wheeler (Reviewer #2); Leonid Chindelevitch (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1. It would be helpful expand on the comparison with existing methods giving more background on current state-of-the-art for geographic source attribution prior to this paper.</p><p>2. The training dataset appears to be only based on infections acquired overseas. It would be helpful to discuss the limitations in using this data source to investigate infections due to imported contaminated food.</p><p>3. More clearly communicating when a prediction is uncertain could be helpful in dealing with isolates from countries or food transport networks where it is hard to make a reliable determination. It would be helpful to consider this in the discussion.</p><p>4. There is a need for a discussion of limits to the utility of the tool due to exclusion of UK <italic>Salmonella</italic> isolates.</p><p>5. There is a need to improve the clarity of Figure 5, in particular increasing the resolution of the trees.</p><p>6. The authors should elaborate on the plausibility of missing data on multi-country trips and their frequency based on available travel data.</p><p>7. Any corrections made in the analysis for increased travel during the summer months should be stated.</p><p>8. Consider expanding the discussion on the poor predictions in the outbreak due to Polish eggs.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>1. It would have been nice to see more background on state-of-the art for geographic source attribution prior to this paper. Currently there is just one sentence and two references (line 73-77).</p><p>2. Should define &quot;SNP&quot; on first use (line 109) also please explain &quot;5-SNP cluster by SNP Address&quot;.</p><p>3. line 165: &quot;was made up of 15 &quot; or 16?</p><p>4. For a general audience (including public health professionals) it would be helpful to spend more time explaining key terminology eg &quot;multi-class classifier&quot;, 'F1 score&quot; etc. The work should be of wide interest, including to public health professionals, and explaining terminology would likely help increase impact of the paper.</p><p>5. line 166-167 &quot;were predictable&quot; What does this mean?</p><p>6. line 331 &quot;Variation in classification accuracy was negatively associated with both low sample number and increasing within-class genetic diversity&quot; is this the intended meaning or is what is meant &quot;classification accuracy was negatively associated with both low sample number and increasing within-class genetic diversity&quot; (i.e. is the association with classification accuracy or with variation in classification accuracy?).</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>Overall, this was an excellent paper to read. One thing I wish the authors had given more real estate to in the introduction is allowing the reader to understand how (if at all) the same determinations re: geographic origin are made today – how long does it take? Is there a big cost to an investigation? Are there regulatory or political hurdles?</p><p>I struggled to interpret Figure 5, and it is quite important for understanding this algorithm's capabilities. The main issue is the resolution of the trees, plus their size makes it difficult to discern how much overlap there is between the public and UKHSA data. The Microreact view makes this easier to explore and could be leveraged to create clearer figures. What I want to see in this figure is how interspersed the outbreak isolates are with UKHSA ones, which requires a close view and high resolution, and how interspersed isolates from different countries are for these outbreaks. When looking at the Poland/Spain mix-up in panel B on Microreact, it becomes very clear why this has happened when you look at the country of travel associated with each sample and the dataset each sample comes from.</p><p>Useful additional metadata columns on the Microreact tree would be the individual country of origin predictions and their associated probabilities – it would be helpful to see how confidence levels change across the tree and with more geographically interspersed clades.</p><p>Usually, I find F1 to be the best measure of accuracy, but here the % accurate calls would also be interesting, as this has direct public health implications, and there is a relationship between the total number of infections originating in a country and the accuracy of classification.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>In addition to the concerns outlined above, here are a few typos that should be corrected; a non-exhaustive list:</p><p>– line 105: replace &quot;from&quot; by &quot;to&quot;.</p><p>– line 247: providing.</p><p>– line 348: &quot;before BEING passed ON to&quot;.</p><p>Also, just because a country has fewer than 10 samples in the collection does not mean it is &quot;low incidence&quot;; technically, this only means that it is &quot;low incidence in UK tourists&quot;. Please clarify your statement accordingly.</p><p>The data and code are fully available, in compliance with <italic>eLife</italic>'s policies.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.84167.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1. It would be helpful expand on the comparison with existing methods giving more background on current state-of-the-art for geographic source attribution prior to this paper.</p></disp-quote><p>We have addressed this with an expansion of the introduction to include further sources on existing methods. The text now reads:</p><p>“The approach taken by the UKHSA for inferring geographical source from genomics data involves phylogenetic population structure analysis, the examination of the genetic relatedness of isolates from various relevant source populations, alongside in-depth analysis of isolates from recent-reported travel cases and reconstruction of domestic or international food networks (Chan et al., 2023, Chattaway et al., 2023, Jenkins et al., 2019). Due to the resources involved, this type of investigation is often only undertaken in exceptional cases representing a threat to public health. A range of other methodologies exist for application to source attribution of genomics data (Mughini-Gras et al., 2018) including; population genetics approaches such as STRUCTURE (Pritchard et al., 2000) and the asymmetric island model (Wilson et al., 2008); Bayesian methods, such as sourceR (Miller et al., 2017); and hybrid methodologies which can variably include additional information, such as exposure risk (Ravel et al., 2017). These methodologies require significant bioinformatic expertise and research time, are computationally expensive and scale poorly with the increasingly vast collections of bacterial genomes available for analysis.” Furthermore a second section was later added including background on the previous use of ML for source attribution “Machine learning (ML) approaches have recently shown utility in predicting the original host of infectious <italic>S. enterica</italic> and <italic>Escherichia coli</italic> (Lupolova et al., 2017, 2019; Wheeler et al. 2018, Zhang et al., 2019), <italic>Campylobacter jejuni</italic> (Arning et al. 2021), S. Typhimurium (Munk et al., 2020), and <italic>Listeria monocytogenes</italic> (Tanui et al., 2022), but has yet to be applied to the problem of geographical source attribution.”</p><disp-quote content-type="editor-comment"><p>2. The training dataset appears to be only based on infections acquired overseas. It would be helpful to discuss the limitations in using this data source to investigate infections due to imported contaminated food.</p></disp-quote><p>We have addressed this point with the addition of two separate sections of the discussion:</p><p>Firstly, addition text was added in relation to the ‘risk’ of infection per country. The text reads:</p><p>“The risk of infection per country is likely to be a product of the overall prevalence of S. Enteritidis as well as the local circulation of high-virulence or low-virulence strains, infections with which is more or less likely to result in referral to the clinical setting.”</p><p>A second section discusses the use of recently reported travel data and its limitations:</p><p><bold>“</bold>Another limitations of this work was its reliance on recent reported travel data, which was used a proxy for the prevalence of infections arising from imported foodstuffs. Whilst there is evidence that this approach can capture highly-relevant disease strains present in foodstuffs imported to the UK (Chan et al., 2023, Chattaway et al., 2023, Jenkins et al., 2019), strain prevalence is likely to vary across national borders due to differences in national and domestic regulations and food-processed methods.”</p><disp-quote content-type="editor-comment"><p>3. More clearly communicating when a prediction is uncertain could be helpful in dealing with isolates from countries or food transport networks where it is hard to make a reliable determination. It would be helpful to consider this in the discussion.</p></disp-quote><p>We have added text, amended Figure 3 and updated the Microreact project to address this. Text was added in the ‘Granular predictions are provided at a regional, subregional and individual country level’ section when reporting on the outputs of the hML model:</p><p>“This model allows for a separate measures of predictive confidence (i.e. the probability value reported by the appropriate classifier) to be reported to the end-user for each hierarchical level. For an example of how this uncertainty maybe visualised for the end-user is available in Figure 3C and mirrored in the interactive <ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">Microreact</ext-link> project. These figures include three columns containing the predicted class of each sample per hierarchical level and three matched columns with the probability of the prediction per class as reported by the appropriate classifier. This also allows for a user to visually inspect the variable level of predictive confidence for each bacterial lineage within its particular phylogenetic context.”.</p><p>Additionally, the microreact figure has been recreated (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier</ext-link>) and now includes the top prediction of region/subregion/country for each isolates in the training/test/validation datasets, the associated p-value and a binary measure of if the prediction was correct. The tree now defaults to including this information as coloured bars next to the tree and the colours used are congruent with those used in the main manuscript. If any of these variables are selected as tip labels to the tree then the concordance between metadata and phylogeny/geography can be observed alongside the phylogenetic tree or as piecharts on the map view.</p><p>We have added an additional panel to Figure 3 (Figure 3C) which contains the same data presented in the Microreact project described above with matching colours for consistency of presentation.</p><disp-quote content-type="editor-comment"><p>4. There is a need for a discussion of limits to the utility of the tool due to exclusion of UK Salmonella isolates.</p></disp-quote><p>We have added text to address this point in the discussion of future directions for this work. The additional text reads:</p><p>“Furthermore, the UK was excluded as a potential geographical source in the model due to extremely low prevalence of <italic>S.</italic> Enteritidis in domestic poultry flocks and a lack of clinical isolates linked to consumption of locally produced foodstuffs (European Food Safety Authority and European Centre for Disease Prevention and Control, 2017). Future studies could include samples collected via veterinary or food chain-based surveillance programmes to provide finer scale inference of causation or provide model coverage of low-prevalence geographical locations.”</p><disp-quote content-type="editor-comment"><p>5. There is a need to improve the clarity of Figure 5, in particular increasing the resolution of the trees.</p></disp-quote><p>To improve clarity of Figure 5 we have condensed the multiple phylogenic trees on the right hand side of the figure to display a single phylogenetic tree containing all of the training and validation samples. Coloured tree tips representing the training data from countries matching those in the validation dataset. The samples from the validation dataset along with the associated p-value of predictions for region/subregion/country have been displayed as additional bars alongside the tree. The figure legend has been updated to reflect this change. A supplementary figure (Figure 5 —figure supplement 1) has been added which shows the same data but in a circularised form which maybe easier for some readers to interpret.</p><disp-quote content-type="editor-comment"><p>6. The authors should elaborate on the plausibility of missing data on multi-country trips and their frequency based on available travel data.</p></disp-quote><p>We believe that this is a good point for discussion, but one which is currently difficult to investigate due to the limitations of the available travel data. We have added a section to the discussion discussion these limitations and speculating where we are able. The text reads:</p><p>“Other potential forms of mislabelling in reported travel data includes the incorrect reporting for multi-country trips or infection during layovers during return travel. The ONS records travel destination as the primary location visited, so no estimates of the proportion of samples attributable to multi-country trips could be made, but will certainly represent a minority of the data. Recent surveys have estimated that layovers occur on only a small proportion of flights (~15%), although this could potentially have a larger impact on the data due to the bias in detecting cases which occur towards the end of a trip, which could result in a patient being admitted to UK-based clinical care setting, rather than one overseas (Department for Transport, 2018a, Department for Transport, 2018b).“</p><disp-quote content-type="editor-comment"><p>7. Any corrections made in the analysis for increased travel during the summer months should be stated.</p></disp-quote><p>No correction for increased travel during the summer months was made in this analysis. In order to clarify this, the text in the discussion was changed from “The model presented herein is conceptually simple and does not incorporate temporal information, … ” changed to “ The model presented herein is conceptually simple and does not incorporate temporal information, account for seasonal fluctuations in disease incidence,…”. Furthermore, the figure legend for Figure 1 has the following text added:</p><p>“No correction was made for the seasonal variation observed in international travel.”</p><disp-quote content-type="editor-comment"><p>8. Consider expanding the discussion on the poor predictions in the outbreak due to Polish eggs.</p></disp-quote><p>Our thanks to the reviewers for identifying this useful improvement to the manuscript. An audit was taken of training samples which had likely originated from the polish outbreak present in the training dataset. This identified only 6 samples from 4 countries. None of these were attributed to a Polish origin, but 5/6 samples came from Southern Europe. The majority of the Polish eggs outbreak samples were misattributed to a Southern European origin and this analysis providing a more parsimonious explanation than we have previously provided. Text has been added in the Results section to reflect this:</p><p>“It was possible to identify samples attributed to the outbreak in our training data, this included 6 samples which were present in the training dataset. These six samples were labelled as having been acquired from Portugal (3), Spain (1), Greece (1) and Turkey (1) based on recent reported travel information, despite having got their infection from Polish eggs. 5/6 of these were of a Southern European origin, and likely contributed to the misattribution of the samples from the Polish validation datasets to a Southern European origin..”</p><p>The summary text at the bottom of this section was amended to read:</p><p>“A large-scale, long-term, multi-country outbreak was poorly predicted by the model, due to a small number of outbreak isolates being present in the training dataset but incorrectly labelled as having a Southern European origin”.</p><p>Further small changes have been made throughout the manuscript related to this addition.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>1. It would have been nice to see more background on state-of-the art for geographic source attribution prior to this paper. Currently there is just one sentence and two references (line 73-77).</p></disp-quote><p>Please refer to the additions made during Essential Revision 1.</p><disp-quote content-type="editor-comment"><p>2. Should define &quot;SNP&quot; on first use (line 109) also please explain &quot;5-SNP cluster by SNP Address&quot;.</p></disp-quote><p>Text at line 109 was chaged to read:</p><p>“Clones were defined as a single-linkage cluster of isolates with 5 or less single nucleotide polymorphisms (SNPs), a definition routinely-used by the UKHSA in genomic disease surveillance (Chattaway et al., 2019, Dallman et al., 2018). In order to reduce the influence of highly related clonal outbreaks on the resulting ML model, a single, random representative isolate was selected per clone per country.”</p><disp-quote content-type="editor-comment"><p>3. line 165: &quot;was made up of 15 &quot; or 16?</p></disp-quote><p>Amended in text to “16”.</p><disp-quote content-type="editor-comment"><p>4. For a general audience (including public health professionals) it would be helpful to spend more time explaining key terminology eg &quot;multi-class classifier&quot;, 'F1 score&quot; etc. The work should be of wide interest, including to public health professionals, and explaining terminology would likely help increase impact of the paper.</p></disp-quote><p>We thank the reviewer for this advice. To this end we added these explanations in text related to multiple topics:</p><p>a) population structure analysis – “population structure analysis, the examination of the genetic relatedness of isolates from various relevant source populations.”</p><p>b) Multi-class classifiers – “Multi-class classifiers allow for the classification of samples into 3 or more classes (i.e. Region = Europe, Africa, Americas, Asia), rather than making a series of binary classifiers per individual class (e.g. Africa/Not-Africa, Europe/Not-Europe etc.).”</p><p>c) F1-score – “Model were assessed using a range of accuracy metrics, although the F1-score (or its hierarchical alternative, hF1) was preferentially used. The F1-score or F-score is the harmonic mean between the precision (how much samples are correctly classified as positive out of all positives) and recall (how many positive samples are predicted as positive) and allows for a partial representation of both values in a single metric.”</p><p>d) Resampling data- “Due to the imbalanced nature of the real-world surveillance dataset, it was necessary resample the data to generate less biased datasets for training.”</p><disp-quote content-type="editor-comment"><p>5. line 166-167 &quot;were predictable&quot; What does this mean?</p></disp-quote><p>Clarified in text:</p><p>“In total, 53 individual classes (4 regions, 11 sub-regions and 38 countries) were included in the model.”</p><disp-quote content-type="editor-comment"><p>6. line 331 &quot;Variation in classification accuracy was negatively associated with both low sample number and increasing within-class genetic diversity&quot; is this the intended meaning or is what is meant &quot;classification accuracy was negatively associated with both low sample number and increasing within-class genetic diversity&quot; (i.e. is the association with classification accuracy or with variation in classification accuracy?).</p></disp-quote><p>Line 331 now reads:</p><p>“Classification accuracy was negatively associated with both low sample number and increasing within-class genetic diversity”</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>Overall, this was an excellent paper to read. One thing I wish the authors had given more real estate to in the introduction is allowing the reader to understand how (if at all) the same determinations re: geographic origin are made today – how long does it take? Is there a big cost to an investigation? Are there regulatory or political hurdles?</p></disp-quote><p>The references added to address Essential Revision 1 represent the current state-of-the-art methods used for genomic investigation of outbreaks by the UKHSA.</p><disp-quote content-type="editor-comment"><p>I struggled to interpret Figure 5, and it is quite important for understanding this algorithm's capabilities. The main issue is the resolution of the trees, plus their size makes it difficult to discern how much overlap there is between the public and UKHSA data. The Microreact view makes this easier to explore and could be leveraged to create clearer figures. What I want to see in this figure is how interspersed the outbreak isolates are with UKHSA ones, which requires a close view and high resolution, and how interspersed isolates from different countries are for these outbreaks. When looking at the Poland/Spain mix-up in panel B on Microreact, it becomes very clear why this has happened when you look at the country of travel associated with each sample and the dataset each sample comes from.</p></disp-quote><p>Figure 5 has been amended for clarity and the Microreact project has been recreated with additional metadata and the outputs of the model to allow interactive visualisation of model outputs and uncertainty (<ext-link ext-link-type="uri" xlink:href="https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier">https://microreact.org/project/vsy9Ctr1dbzr49Mjs53bYj-s-enteritidis-hml-classifier</ext-link>). An additional supplementary figure (Figure 5) has been added to aid visualisation.</p><p>Please see Essential Revision 5 for more details.</p><disp-quote content-type="editor-comment"><p>Useful additional metadata columns on the Microreact tree would be the individual country of origin predictions and their associated probabilities – it would be helpful to see how confidence levels change across the tree and with more geographically interspersed clades.</p></disp-quote><p>This information has been included in the new Microreact project (please see Essential Revision 5 or the previous comment).</p><disp-quote content-type="editor-comment"><p>Usually, I find F1 to be the best measure of accuracy, but here the % accurate calls would also be interesting, as this has direct public health implications, and there is a relationship between the total number of infections originating in a country and the accuracy of classification.</p></disp-quote><p>We have added an additional supplementary figure (Supp. Figure *) which is a modification of Figure 3 which includes %correctly predicted per class. Text has been added to the results to reflect this:</p><p>“For ease of interpretation, an alternative to Figure 3 has been including in the supplementary information (Figure 3 —figure supplement 3) which simply displays the % of isolates of each class correctly assigned to that class instead of HF1.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>In addition to the concerns outlined above, here are a few typos that should be corrected; a non-exhaustive list:</p><p>– line 105: replace &quot;from&quot; by &quot;to&quot;.</p></disp-quote><p>Replaced in text</p><disp-quote content-type="editor-comment"><p>– line 247: providing.</p></disp-quote><p>Replaced in text</p><disp-quote content-type="editor-comment"><p>– line 348: &quot;before BEING passed ON to&quot;.</p></disp-quote><p>Replaced in text</p><disp-quote content-type="editor-comment"><p>Also, just because a country has fewer than 10 samples in the collection does not mean it is &quot;low incidence&quot;; technically, this only means that it is &quot;low incidence in UK tourists&quot;. Please clarify your statement accordingly.</p></disp-quote><p>Clarified in text:</p><p>“After quality-filtering, downsampling and the removal of countries with a low-incidence of reported infections of UK tourists (&lt;10 total isolates)”</p></body></sub-article></article>