<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">57524</article-id><article-id pub-id-type="doi">10.7554/eLife.57524</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Walking <italic>Drosophila</italic> navigate complex plumes using stochastic decisions biased by the timing of odor encounters</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-42197"><name><surname>Demir</surname><given-names>Mahmut</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-3278-7843</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-129971"><name><surname>Kadakia</surname><given-names>Nirag</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9978-6450</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="other" rid="fund11"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-182919"><name><surname>Anderson</surname><given-names>Hope D</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-27474"><name><surname>Clark</surname><given-names>Damon A</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8487-700X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-8366"><name><surname>Emonet</surname><given-names>Thierry</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6746-6564</contrib-id><email>thierry.emonet@yale.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund10"/><xref ref-type="other" rid="fund11"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Molecular, Cellular and Developmental Biology, Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Swartz Foundation Fellow, Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Interdepartmental Neuroscience Program, Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>Department of Physics, Yale University</institution><addr-line><named-content content-type="city">New Haven</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Seminara</surname><given-names>Agnese</given-names></name><role>Reviewing Editor</role><aff><institution>Université Côte d'Azur</institution><country>France</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>03</day><month>11</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e57524</elocation-id><history><date date-type="received" iso-8601-date="2020-04-03"><day>03</day><month>04</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2020-09-15"><day>15</day><month>09</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Demir et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Demir et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-57524-v1.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.63385"/><abstract><p>How insects navigate complex odor plumes, where the location and timing of odor packets are uncertain, remains unclear. Here we imaged complex odor plumes simultaneously with freely-walking flies, quantifying how behavior is shaped by encounters with individual odor packets. We found that navigation was stochastic and did not rely on the continuous modulation of speed or orientation. Instead, flies turned stochastically with stereotyped saccades, whose direction was biased upwind by the timing of prior odor encounters, while the magnitude and rate of saccades remained constant. Further, flies used the timing of odor encounters to modulate the transition rates between walks and stops. In more regular environments, flies continuously modulate speed and orientation, even though encounters can still occur randomly due to animal motion. We find that in less predictable environments, where encounters are random in both space and time, walking flies navigate with random walks biased by encounter timing.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>When walking along a city street, you might encounter a range of scents and odors, from the smells of coffee and food to those of exhaust fumes and garbage. The odors are swept to your nose by air currents that move scents in two different ways. They carry them downwind in a process called advection, but they also mix them chaotically with clean air in a process called turbulence. What results is an odor plume: a complex ever-changing structure resembling the smoke rising from a chimney.</p><p>Within a plume, areas of highly concentrated odor particles break up into smaller parcels as they travel further from the odor source. This means that the concentration of the odor does not vary along a smooth gradient. Instead, the odor arrives in brief and unpredictable bursts. Despite this complexity, insects are able to use odor plumes with remarkable ease to navigate towards food sources. But how do they do this?</p><p>Answering this question has proved challenging because odor plumes are usually invisible. Over the years, scientists have come up with a number of creative solutions to this problem, including releasing soap bubbles together with odors, or using wind tunnels to generate simpler, straight plumes in known locations. These approaches have shown that when insects encounter an odor, they surge upwind towards its source. When they lose track of the odor, they cast themselves crosswind in an effort to regain contact. But this does not explain how insects are able to navigate irregular odor plumes, in which both the timing and location of the odor bursts are unpredictable.</p><p>Demir, Kadakia et al. have now bridged this gap by showing how fruit flies are attracted to smoke, an odorant that is also visible. By injecting irregular smoke plumes into a custom-built wind tunnel, and then imaging flies as they walked through it, Demir, Kadakia et al. showed that flies make random halts when navigating the plume. Each time they stop, they use the timing of the odor bursts reaching them to decide when to start moving again. Rather than turning every time they detect an odor, flies initiate turns at random times. When several odor bursts arrive in a short time, the flies tend to orient these turns upwind rather than downwind.</p><p>Flies therefore rely on a different strategy to navigate irregular odor plumes than the ‘surge and cast’ method they use for regular odor streams. Successful navigation through complex irregular plumes involves a degree of random behavior. This helps the flies gather information about an unpredictable environment as they search for the source of the odor. These findings may help to understand how other insects use odor to navigate in the real world, for example, how mosquitoes track down human hosts.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>olfaction</kwd><kwd>navigation</kwd><kwd>odor plumes</kwd><kwd>turbulence</kwd><kwd>olfactory search</kwd><kwd>wind tunnel</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008796</institution-id><institution>Allen Foundation</institution></institution-wrap></funding-source><award-id>11562</award-id><principal-award-recipient><name><surname>Demir</surname><given-names>Mahmut</given-names></name><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01GM106189</award-id><principal-award-recipient><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>F32MH118700</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution>Swartz Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>DBI-1755494</award-id><principal-award-recipient><name><surname>Anderson</surname><given-names>Hope D</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01EY026555</award-id><principal-award-recipient><name><surname>Clark</surname><given-names>Damon A</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100005326</institution-id><institution>Yale University</institution></institution-wrap></funding-source><award-id>Program in Physics, Engineering and Biology</award-id><principal-award-recipient><name><surname>Demir</surname><given-names>Mahmut</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>PHY-1748958</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund10"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id><institution>National Institute of General Medical Sciences</institution></institution-wrap></funding-source><award-id>R25GM067110</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><award-group id="fund11"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000936</institution-id><institution>Gordon and Betty Moore Foundation</institution></institution-wrap></funding-source><award-id>2919.02</award-id><principal-award-recipient><name><surname>Kadakia</surname><given-names>Nirag</given-names></name><name><surname>Emonet</surname><given-names>Thierry</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Visualized odor encounters show that <italic>Drosophila</italic> navigate spatiotemporally complex odor plumes using random walks biased by the timing of brief and unpredictable odor encounters.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Olfactory search strategies depend on both an animal’s locomotive repertoire and the odor landscape it navigates. Navigational strategies have been investigated in a variety of odor plumes, each exhibiting a particular structure in space and time. The statistics of these plumes govern what information is available to the animal as it navigates, which in turn dictates the sequence of behaviors it can use to find its target. In some environments, such as the diffusion-dominated odor landscapes of <italic>Drosophila</italic> larvae, concentrations vary relatively smoothly from point to point. Accordingly, larvae can progress toward odor sources by sampling odor gradients spatially and temporally (<xref ref-type="bibr" rid="bib26">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="bib23">Gepner et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Hernandez-Nunez et al., 2015</xref>; <xref ref-type="bibr" rid="bib48">Schulze et al., 2015</xref>). Similarly, adult flies in gradients can walk up the gradient by monitoring the odor intensity difference across their antennae pairs (<xref ref-type="bibr" rid="bib8">Borst and Heisenberg, 1982</xref>; <xref ref-type="bibr" rid="bib22">Gaudry et al., 2013</xref>).</p><p>In the absence of stable gradients, odor landscapes may still be relatively simple when the airflow is laminar. This is true for modest wind speeds and in the near-surface laminar sublayer of turbulent flows, provided the source and average wind directions are not shifting and the surface is smooth (<xref ref-type="bibr" rid="bib16">Crimaldi and Koseff, 2001</xref>). Variations in odor concentration are generally slow – odor encounters can last longer than seconds (<xref ref-type="bibr" rid="bib16">Crimaldi and Koseff, 2001</xref>; <xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>). Furthermore, the largely unidirectional and steady wind provides a reliable cue about odor source location. Experiments in walking flies suggest that, in this case, high-frequency fluctuations in odor concentration might be ignored and upwind progress may result from temporal integration of the odor concentration (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>). Flies turn upwind at the onset of spatially uniform blocks of natural (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>; <xref ref-type="bibr" rid="bib51">Steck et al., 2012</xref>) or optogenetic fictive odors (<xref ref-type="bibr" rid="bib5">Bell and Wilson, 2016</xref>), and turn downwind or initiate a local search when the odor is lost.</p><p>Steady odor ribbons have provided an informative experimental paradigm used extensively in insect navigation studies (<xref ref-type="bibr" rid="bib10">Budick and Dickinson, 2006</xref>; <xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>). Like near-surface flows and spatially uniform odor blocks, ribbons are spatiotemporally simple. Walking and flying moths accelerate and turn upwind upon entering the straight ribbons, and cast perpendicular to the wind or counterturn when losing it (<xref ref-type="bibr" rid="bib38">Mafra-Neto and Cardé, 1994</xref>; <xref ref-type="bibr" rid="bib14">Cardé and Willis, 2008</xref>; <xref ref-type="bibr" rid="bib36">Kuenen and Carde, 1994</xref>; <xref ref-type="bibr" rid="bib34">Kanzaki and Sugi, 1992</xref>; <xref ref-type="bibr" rid="bib59">Vickers and Baker, 1994</xref>; <xref ref-type="bibr" rid="bib35">Kennedy and Marsh, 1974</xref>; <xref ref-type="bibr" rid="bib2">Baker and Haynes, 1989</xref>; <xref ref-type="bibr" rid="bib28">Haynes and Baker, 1989</xref>; <xref ref-type="bibr" rid="bib3">Baker and Vickers, 1997</xref>). Flying flies navigate them similarly, combining upwind surges with counterturns back into the ribbon after passing through. In these plumes, odor encounters are very brief (~100 ms) and also exhibit some degree of temporal irregularity due to the animal’s self-motion as it randomly crosses the ribbon (<xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>). Still, the locations of encounters are highly predictable, and this spatial regularity is naturally exploited by reflex-dominated strategies such as surging and counterturning (<xref ref-type="bibr" rid="bib42">Pang et al., 2018</xref>).</p><p>By contrast, in the bulk of turbulent flows (<xref ref-type="bibr" rid="bib14">Cardé and Willis, 2008</xref>; <xref ref-type="bibr" rid="bib40">Murlis et al., 1992</xref>; <xref ref-type="bibr" rid="bib41">Murlis et al., 2000</xref>; <xref ref-type="bibr" rid="bib45">Riffell et al., 2008</xref>; <xref ref-type="bibr" rid="bib62">Yee et al., 1993</xref>) or on rough surfaces where shifting winds and obstacles such as grass, shrubs, and branches can perturb the laminar boundary layer (<xref ref-type="bibr" rid="bib47">Schlichting, 1960</xref>; <xref ref-type="bibr" rid="bib30">Hunt et al., 1978</xref>), odor landscapes are irregular in both space and time. Measurements of odor concentrations in forests (<xref ref-type="bibr" rid="bib41">Murlis et al., 2000</xref>; <xref ref-type="bibr" rid="bib60">Webster and Weissburg, 2001</xref>; <xref ref-type="bibr" rid="bib39">Moore et al., 1994</xref>) show that not only are local concentration gradients less indicative of odor source location, but importantly, odor encounters are intermittent, occurring as a random sequence of brief bursts. Theory suggests that in complex intermittent plumes, the timing of odor encounters may provide important information to the navigator (<xref ref-type="bibr" rid="bib4">Balkovsky and Shraiman, 2002</xref>; <xref ref-type="bibr" rid="bib58">Vergassola et al., 2007</xref>). Indeed, moths follow tight trajectories upwind while navigating within a turbulent plume, much narrower than those in steady ribbons (<xref ref-type="bibr" rid="bib38">Mafra-Neto and Cardé, 1994</xref>; <xref ref-type="bibr" rid="bib34">Kanzaki and Sugi, 1992</xref>; <xref ref-type="bibr" rid="bib2">Baker and Haynes, 1989</xref>). These narrow tracks were recapitulated for moths navigating pulsed ribbons, provided the pulse frequency was high enough, again implicating encounter timing in upwind progress (<xref ref-type="bibr" rid="bib38">Mafra-Neto and Cardé, 1994</xref>).</p><p>There is an important distinction between experiments informed by steady odor ribbons versus those informed by spatiotemporally complex plumes. In steady ribbons, navigational behaviors can be tied to individual odor encounters because the location of the ribbon can be measured and the time-dependent odor signal perceived by the animal can be inferred from its trajectory. In spatiotemporally complex plumes, behaviors can at most be correlated with plume statistics, as the time when each individual filament hits the animal is unknown. In this context, analyzing how animals use the timing of individual encounters to navigate would require simultaneous measurement of behavior with odor.</p><p>Here we identified the navigational principles of walking fruit flies in spatiotemporally complex odor plumes resembling those in naturalistic settings. In particular, we investigated how these navigational principles are shaped by the temporal features of the individual odor encounters made with the rapidly fluctuating plume. We exploit a technical advance that relaxes the tradeoff between restricting odor dynamics and animal motion: an attractive odor that can be imaged in real time with unrestrained walking flies. By passing this odor in a laminar airflow and perturbing it with random lateral air jets, we generate a spatiotemporally complex plume whose statistics approximate those of turbulent plumes near boundaries (<xref ref-type="bibr" rid="bib15">Celani et al., 2014</xref>; detailed comparison with theory in Results). This odor allows us to study walking fly olfactory navigation by directly connecting navigational behaviors to individual odor encounters.</p><p>Consistent with prior studies (<xref ref-type="bibr" rid="bib9">Budick et al., 2007</xref>; <xref ref-type="bibr" rid="bib18">David et al., 1982</xref>), we find that flies on average walk upwind within the odor plume cone. However, upwind bias does not result from an accumulation of orientation changes following every odor encounter. Instead, flies execute stochastic, stereotyped 30-degree saccades at a rate independent of the duration or frequency of odor encounters. Upwind bias results not from modulating turn magnitude or frequency but rather turn direction: the randomly-occurring saccades are more likely to be oriented upwind when the frequency of odor encounters – but not their duration or concentration – is high, suggesting an important role for precise odor timing detection (<xref ref-type="bibr" rid="bib27">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib54">Szyszka et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Shusterman et al., 2011</xref>; <xref ref-type="bibr" rid="bib43">Park et al., 2016</xref>). Prior studies have shown that flies increase the walking speed at the onset of uniform odor blocks (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>; <xref ref-type="bibr" rid="bib32">Jung et al., 2015</xref>; <xref ref-type="bibr" rid="bib21">Gao et al., 2013</xref>). In our spatiotemporal plume, flies spend only a fraction of time (~15%) experiencing detectable odor concentrations, and we expectedly do not find an appreciable increase in walking speed. However, flies do markedly modulate their rate of walking and stopping. In contrast to turn decisions, the rates of these walk-stop transitions are strongly tied to the frequency of encounters. We model stops and walks as a double, inhomogeneous Poisson process and find using maximum likelihood estimation and cross-validation that stop rates reset at every encounter before decaying back to a baseline rate. This suggests that individual encounters prolong the flies’ tendency to continue walking but only for a brief time. Meanwhile, walks are triggered by accumulating evidence from multiple encounters while stopped. Using agent-based simulations, we show that this modulation of stops and walks shaped by the timing of odor encounters greatly enhances navigation performance. Together, our results suggest that navigation within spatiotemporally complex odor plumes is shaped by the sequence of encounters with individual odor packets. Both electrophysiological and behavioral measurements indicate that <italic>Drosophila</italic> – along with other insects, mammals, and crustaceans, among others – can precisely encode odor timing within their signal transduction cascade (<xref ref-type="bibr" rid="bib27">Gorur-Shandilya et al., 2017</xref>; <xref ref-type="bibr" rid="bib43">Park et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Smear et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Schaefer and Margrie, 2007</xref>). Our findings suggest that <italic>Drosophila</italic> leverage this capability to navigate their olfactory world.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Visualizing dynamic odor plumes simultaneously with fly behavior</title><p>To investigate how freely-walking insects navigate odor plumes that are complex in both space and time, we developed a wind-tunnel walking assay for <italic>Drosophila melanogaster</italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). The large size of our 2D arena (300 × 180 × 1 cm<sup>3</sup>) allowed us to simultaneously image several flies in the dark with minimal mutual interactions. The main flow was set to 150 mm/s, chosen as sufficiently strong for flies to tax upwind, but not so strong that they remained stationary (<xref ref-type="bibr" rid="bib63">Yorozu et al., 2009</xref>). Plumes that fluctuated in space and time were generated by injecting odors at the center of an air comb and perturbing the laminar flow with lateral jets stochastically alternating at a Poisson rate of 10/s. To visualize the flow, we injected smoke, which is turbid, into the center of the air comb and imaged it in the infrared at 90 Hz. Serendipitously, we noticed that when we placed starved flies in the assay with the fluctuating smoke, flies walked upwind toward the source (<xref ref-type="fig" rid="fig1">Figure 1B</xref> , <xref ref-type="video" rid="video1">Video 1</xref>) in a manner reminiscent of their behavior when we injected an attractive odor such as ethyl acetate. We reasoned that if this attraction to smoke were olfactory, the imaged smoke intensity could then provide a proxy for odor concentration, allowing us to visualize dynamic odor plumes simultaneously with fly behavior (<xref ref-type="fig" rid="fig1">Figure 1C–E</xref> and <xref ref-type="video" rid="video2">Video 2</xref>).</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Simultaneous visualization of odor and fly behavior.</title><p>(<bold>A</bold>) Experimental apparatus. The main flow (150 mm/s) is perturbed by lateral jets (1500 mm/s) that alternate stochastically with a characteristic time scale of 100 ms. (<bold>B</bold>) Walking arena with flies (blue), odor intensity (gray), and a representative trajectory of a navigating fly (red). Green: the portion of the trajectory plotted in <bold>C-E</bold>. Note that since the odor environment is fluctuating, the image in B only represents the environment at a random time point. Blue rectangle: the area shown in the inset. Inset: blue: fly; gray: odor intensity; red triangle: orientation of the fly; purple: the virtual antenna in which the odor intensity is averaged as a proxy for the signal perceived by the fly. Simultaneous orientation (<bold>C</bold>), speed (<bold>D</bold>), and perceived stimulus (<bold>E</bold>) of the fly while it is navigating in the intermittent plume (green portion of the trajectory in B). Dashed lines in C indicate up-wind and cross-wind orientations. Orientation and speed were smoothed with a 100 ms sliding box filter. The shaded area in E (top) is plotted at a larger scale (bottom) with the sensory threshold (dotted line) used to identify the odor encounters (magenta lines above the signal trace in purple; see also <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and Materials and methods). (<bold>F</bold>) The fraction of time that odor concentration is above the sensory threshold (i.e. intermittency) at fixed locations. Image intensity is median-filtered (square filter size 2.3 mm), and the likelihood that the intensity is above the sensory threshold, averaged over all frames of the video. Red dots: positions of encounter and blank duration distributions plotted in G-H. Green dots: positions of encounter probability distributions plotted in J. (<bold>G-H</bold>) Distributions of encounter and blank durations, respectively, at positions color-coded in F. The pink dash line shows the <inline-formula><mml:math id="inf1"><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> expected from theory for turbulent flow (<xref ref-type="bibr" rid="bib15">Celani et al., 2014</xref>). Exponents of the power law fit to the tail of the distributions are indicated with the same color code as in F. (<bold>I</bold>) Odor encounter and blank durations perceived by navigating flies. Values in the parenthesis indicate the exponent of the power law fit to the tail of the distribution. (<sc><bold>J</bold></sc>) Probability (r axis) to have an odor encounter within 1 s while walking with a speed of 10 mm/s, starting from positions color-coded in F, as a function of walking direction (theta axis). (<bold>K</bold>) Probability distribution functions (pdf) of fly positions in the arena for the complex smoke plume as in A (<italic>n</italic> = 1073 trajectories). (<bold>L</bold>) Same without smoke but with the same complex wind pattern as in K (<italic>n</italic> = 502). Magenta: location of the source. Blue curves: marginal pdfs.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Attraction to smoke is olfactory and dose-dependent, closely mimicking to ethyl acetate and apple cider vinegar.</title><p>(<bold>A</bold>) GC-MS measurement of smoke. Many volatiles belonging to various chemical groups such as alcohols, ketones, and aldehydes are present in the smoke. (<bold>B</bold>) A snapshot of flies (blue), navigating straight smoke plume (gray) in laminar flow (blue arrow, lateral jets were turned off) with a representative trajectory of a navigating fly (red). (<bold>C</bold>) Probability distribution functions (pdf) of fly positions in the arena for wild-type CS flies navigating straight plumes (as in B) of smoke with increasing doses (top to bottom, <italic>n</italic> = 871, 1714, 1600, 1996, 4421 trajectories). Marginal pdfs in the x- or y-direction are plotted on a log scale on the exterior. (<bold>D</bold>) Integral of pdfs over the ribbon region (orange box, illustrated in the bottom plot of C) as a function of smoke dose. The dashed line represents chance probability. (<bold>E–F</bold>) Same as C-D but for ethyl acetate (EA, <italic>n</italic> = 369, 363, 907, 1351, 1604). (<bold>G–H</bold>) Same as C-D but for apple cider vinegar (ACV, <italic>n</italic> = 176, 212, 829, 1067, 1332). Dose values reported in C-H are the odor concentration of the straight plume released into the arena from the center straw (3 mm diameter). (<bold>I</bold>) PDFs in straight smoke plumes (dose 100%) for mutant flies, and at humidity saturation for wild-type CS flies. Mutant flies: Gr63a<sup>-/-</sup> (<italic>n</italic> = 1581); norpA (<italic>n</italic> = 4480); Orco<sup>-/-</sup> (<italic>n</italic> = 2420); anosmic (Gr63a<sup>-/-</sup>, Orco<sup>-/-</sup>, Ir8a<sup>-/-</sup>, Ir25a<sup>-/-</sup>; <italic>n</italic> = 3992). High humidity: (86.0 ± 3.9%; <italic>n</italic> = 2772). (<bold>J</bold>) Pdf integrated over the ribbon region (same region used in F-H) for control experiments.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>The average turning position of flies in straight plume agrees with smoke intensity.</title><p>(<bold>A</bold>) A representative trajectory of a fly walking around straight smoke plume or ribbon (lateral jets were turned off). Gray: smoke intensity. Blue: the trajectory of the fly. Red dots: points where fly makes a turn toward ribbon. Red line: the distance between ribbon center and turning point (i.e. ΔY). (<bold>B</bold>) Comparison of smoke diffusivity to turning points of flies in straight plumes of smoke and EA. Red (black) dots: Turning points in straight smoke (EA) plume. Red (black) curves: data smoothed with the lowess method, with the option of resistance to the outliers. Blue bar: Length representing the size of the fly (3 mm) as a guide for the reader. Pink curve: iso-line of smoke intensity at 0.1 (a.u.). Cyan curve: iso-line of smoke intensity at 5 (a.u.) which is the value used for encounter detection.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>Intermittency in the complex plume.</title><p>(<bold>A</bold>) Distribution of intermittencies at fixed locations, same color codes as in the inset (same as <xref ref-type="fig" rid="fig1">Figure 1F</xref>), across the arena in a complex smoke plume. Intermittency is calculated by estimating the fraction of time that smoke intensity is above the sensory threshold over a 2 s sliding window. Inset: (same as <xref ref-type="fig" rid="fig1">Figure 1F</xref>) Intermittency at fixed locations: The fraction of time that odor concentration is above the sensory threshold <bold>B</bold> Intermittency is perceived by flies navigating in a complex plume. Intermittency is calculated as in <bold>A</bold> using the traces of smoke signal perceived by the flies as they navigated the complex plumes (same data as in <xref ref-type="fig" rid="fig1">Figure 1K</xref>). Colors indicate the different regions of the behavioral arena where the flies where located as shown in the inset. Black: all regions, green: between 0 and 100 mm down-wind from the source, blue: between 100 and 200 mm, red: between 200 and 300.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig1-figsupp3-v1.tif"/></fig></fig-group><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-57524-video1.mp4"><label>Video 1.</label><caption><title>Starved wild-type (CS) female flies navigating in the intermittent smoke plume.</title></caption></media><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-57524-video2.mp4"><label>Video 2.</label><caption><title>Simultaneous quantification of odor stimulus and fly behavior.</title><p>Starved wild-type (CS) female flies navigating in the intermittent smoke plume. The trajectory of a single fly (same as in <xref ref-type="fig" rid="fig1">Figure 1A</xref>) is displayed with its speed, orientation, and perceived signal. Green and blue dashed lines in the orientation panel represent up-wind and cross-wind orientations, respectively.</p></caption></media><p>Smoke is a complex stimulus (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>), containing not only CO<sub>2</sub> and volatile chemicals, but also heat, humidity, and airborne particles. We, therefore, set out to verify that the attraction to smoke is olfactory. For this purpose, we used a simplified environment consisting of a standing odor ribbon, which we generated in our assay by maintaining the laminar flow and odor injection, but turning off the lateral jets (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). First, we compared behavioral statistics in smoke to those in the attractive odors ethyl acetate (EA) and apple cider vinegar (ACV). The likelihood that flies were in the narrow band near the smoke ribbon increased with smoke concentration (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>), before saturating at a sufficient dose (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1D</xref>), a result reproduced in both EA and ACV (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1E–H</xref>). We then tested contributions from carbon dioxide sensing and vision, using Gr63a<sup>-/-</sup> (<xref ref-type="bibr" rid="bib31">Jones et al., 2007</xref>) and norpA<sup>-/-</sup> (<xref ref-type="bibr" rid="bib6">Bloomquist et al., 1988</xref>) mutants, respectively. Both mutants retained the ability to localize the odor source at a level comparable to wild-type flies (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1I–J</xref>). To test whether humidity played a major role, we saturated the airflow with 80% humidity and found that source localization was reduced but still significantly above random (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1I–J</xref>). Finally, we tested the olfaction directly using Orco<sup>-/-</sup> mutants (<xref ref-type="bibr" rid="bib37">Larsson et al., 2004</xref>), as well as anosmic flies (Gr63a<sup>-/-</sup>, Orco<sup>-/-</sup>, Ir8a<sup>-/-</sup>, and Ir25<sup>-/-</sup>; <xref ref-type="bibr" rid="bib44">Ramdya et al., 2015</xref>). In both sets of mutants, the ability to find the odor source was completely abolished. Orco<sup>-/-</sup> mutants (but not the anosmic flies) exhibited a slight repulsion to the smoke ribbon, which we attributed to an aversive response to carbon dioxide (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1I-J</xref>; <xref ref-type="bibr" rid="bib37">Larsson et al., 2004</xref>; <xref ref-type="bibr" rid="bib53">Suh et al., 2004</xref>). Thus, flies’ attraction to smoke is driven mainly by olfaction.</p><p>To quantify the time-dependent stimulus experienced by each fly during navigation, we averaged the signal intensity in a small area (1.10 mm<sup>2</sup>) near its antennae (<xref ref-type="fig" rid="fig1">Figure 1B</xref> inset, <xref ref-type="fig" rid="fig1">Figure 1E</xref>, and <xref ref-type="video" rid="video2">Video 2</xref>). The onset and offset of odor encounters were defined as the times when the signal crossed a sensory threshold, which we set to 2.5 SD (σ) above the background noise. We refer to the periods when the odor is above threshold as ‘odor encounters,’ or ‘encounters’ for short, and periods when the odor is below the threshold as ‘blanks.’ We verified that the results and conclusions presented below remained unchanged for thresholds between 2.0<italic>σ</italic> and 3.5<italic>σ</italic>. Using the 2.5<italic>σ</italic> threshold, the error in the timing of odor encounters was estimated to be less than 25 ms (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref> and Materials and methods). Using this setup, we then examined how walking flies navigate odor plumes that fluctuate in both space and time.</p></sec><sec id="s2-2"><title>Within the odor plume, odor encounters are brief, frequent, and unpredictable</title><p>We first quantified the statistics of the odor environment the flies must navigate. Our odor plume was highly intermittent, composed of spatiotemporally localized filaments breaking continuously in time (<xref ref-type="fig" rid="fig1">Figure 1B</xref> and <xref ref-type="video" rid="video1">Video 1</xref>, lateral jets on). Odor mean intermittency – the fraction of time the odor was above the sensory threshold – ranged several orders of magnitude in the conical extent of the plume (<xref ref-type="fig" rid="fig1">Figure 1F</xref>). The average signal intermittency was low across the arena, increasing from about 10<sup>−6</sup> at the border of the plume to about 0.12–0.39 at the center line, depending on the distance to the source (see also <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3A</xref>). Still, navigating flies perceived intermittencies ranging over a decade and a half, with an average intermittency around 0.11 (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3B</xref>), resembling values measured (<xref ref-type="bibr" rid="bib41">Murlis et al., 2000</xref>) in natural settings. At fixed locations from the source, odor encounter (<xref ref-type="fig" rid="fig1">Figure 1G</xref>) and blank (<xref ref-type="fig" rid="fig1">Figure 1H</xref>) durations spanned a wide range of time scales (exponents ranging from −3.3 close to the source to −2.1 far from the source), gradually approaching the power law <inline-formula><mml:math id="inf2"><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> theoretically predicted for turbulent odor plumes in the atmospheric boundary layer (<xref ref-type="bibr" rid="bib15">Celani et al., 2014</xref>). The distribution of encounter and blank durations experienced by navigating flies spanned an even greater range and were closer to a power law (<xref ref-type="fig" rid="fig1">Figure 1I</xref>). On average, flies experienced brief odor encounters (mean duration ~200 ms) at a mean frequency of 4 Hz. Even beyond their variability and brevity, encounters were also highly unpredictable in location. To quantify this, we calculated the likelihood to receive an odor encounter in 1 s, assuming one walks straight at 10 mm/s radially outward from a fixed point. Predictability in the location of future odor encounters would then manifest as a directional dependence of this likelihood. Within the conical extent of the plume, the likelihood was nearly isotropic with respect to walking direction, whereas near the plume edges, likelihoods were skewed toward the centerline of the plume cone (<xref ref-type="fig" rid="fig1">Figure 1J</xref>). Within the conical extent of the odor plume, therefore, the location of future odor encounters was uncertain. Despite this uncertainty, flies remained largely in the plume cone and were able to successfully locate the odor source (<xref ref-type="fig" rid="fig1">Figure 1K</xref>). However, during fluctuating winds without odor, they could not locate the source (<xref ref-type="fig" rid="fig1">Figure 1L</xref>).</p></sec><sec id="s2-3"><title>Stopping and turning comprise the bulk of the navigational repertoire within a spatiotemporally complex odor plume</title><p>How are fly orientation and speed shaped on average by an odor signal exhibiting this degree of spatiotemporal complexity? To compare these behaviors to those in an odorless environment, we presented the complex plume in 15 s blocks by closing and opening the odor valve every 15 s but maintaining the alternating lateral jets throughout the trial. This produced an environment in which a 15 s block of complex odor plume alternated with a 15 s block of fluctuating wind only (<xref ref-type="video" rid="video3">Video 3</xref>). When the odor was on, odor encounters were frequent, but randomly experienced in time (<xref ref-type="fig" rid="fig2">Figure 2A–B</xref>). As expected, flies were more likely to be oriented upwind when the odor was on (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), as previously reported (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>; <xref ref-type="bibr" rid="bib51">Steck et al., 2012</xref>; <xref ref-type="bibr" rid="bib5">Bell and Wilson, 2016</xref>; <xref ref-type="bibr" rid="bib10">Budick and Dickinson, 2006</xref>; <xref ref-type="bibr" rid="bib35">Kennedy and Marsh, 1974</xref>; <xref ref-type="bibr" rid="bib40">Murlis et al., 1992</xref>; <xref ref-type="bibr" rid="bib19">Flügge, 1934</xref>). However, unlike for flies walking into a spatially homogeneous odor block (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>; <xref ref-type="bibr" rid="bib32">Jung et al., 2015</xref>; <xref ref-type="bibr" rid="bib21">Gao et al., 2013</xref>), changes in average angular speed were minor, with a less than 10% change between blocks (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Walking speeds were similarly unmodulated, again in contrast to walking flies in homogenous odor blocks (<xref ref-type="fig" rid="fig2">Figure 2E</xref>; <xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>). This is not inconsistent, however, since encounters were so brief (~200 ms), the integration timescales for speed modulation measured previously (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>) would only produce &lt;10% increase in either ground or angular speed.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Navigation within intermittent complex odor plumes comprises walk-stop transitions and upwind orientation.</title><p>(<bold>A</bold>) The odor encounters experienced by flies navigating the intermittent smoke plume as in <xref ref-type="fig" rid="fig1">Figure 1B</xref> (see also <xref ref-type="video" rid="video3">Video 3</xref>). While the wind is continuously perturbed by the lateral jets, the odor is turned on/off in 15 s blocks (gray shading). Rows indicate independent trajectories (<italic>n =</italic> 429) obtained from 267 flies. (<bold>B-F</bold>) Quantities averaged over all trajectories in A as a function of time. (<bold>B</bold>) Probability of having an encounter. (<bold>C</bold>) Probability of being in up-wind (green), cross-wind (blue), and down-wind (red) orientations estimated in 90-degree quadrants as shown in the circle with the same color codes. C-E include only time points for which the fly was walking (<italic>v</italic> &gt; 2 mm/s). (<bold>D</bold>) Angular speed. (<bold>E</bold>) Walking speed. (<bold>F</bold>) Walk-to-stop (red) and stop-to-walk (blue) switching rates. All quantities in B-F are smoothed with a 5 s sliding box filter. Error bars indicate SEM.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Smoke elicits behavior similar to natural odorants.</title><p>Behavior of flies navigating in the intermittent plumes of <bold>A</bold> apple cider vinegar (ACV) and <bold>B</bold> ethyl acetate (EA) as in <xref ref-type="fig" rid="fig2">Figure 2</xref> where the wind is perturbed continuously with random lateral jets whereas the odor is turned on/off over 15 s periods. Quantities averaged over all trajectories in A-B (<italic>n</italic> = 1830 trajectories for ACV and <italic>n</italic> = 1809 for EA) as a function of time. 1st row: Probability of being in up-wind (green), cross-wind (blue), and down-wind (red) orientations estimated in 90-degree quadrants as shown in the circle with the same color codes. 2s row: Angular speed, 3rd row: Walking speed, 4th row: Walk-to-stop (red) and stop-to-walk (blue) switching rates. Quantities in all four rows are smoothed with a 5 s sliding box filter. Error bars indicate SEM. Gray area indicates the period that odor injection, into the arena, is turned while the wind is constantly perturbed with lateral jets as in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig2-figsupp1-v1.tif"/></fig></fig-group><media id="video3" mime-subtype="mp4" mimetype="video" xlink:href="elife-57524-video3.mp4"><label>Video 3.</label><caption><title>Starved wild-type (CS) female flies navigating in the intermittent smoke plume.</title><p>The smoke valve is turned on/off at 15 s blocks while the wind is kept fluctuating.</p></caption></media><p>Though changes in ground speed were minor, we noticed a high incidence of stopping in our spatiotemporally complex plume (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The prevalence of immobility has been noted before in walking flies navigating homogenous odor blocks (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>), though its role in navigation was not investigated. We suspected that stopping might form a critical component of intermittent plume navigation for walking flies. Indeed, walk-to-stop and stop-to-walk transition rates were strongly modulated during the transitions between odorized and non-odorized blocks (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). Natural odors ACV and EA elicited similar navigational trends in angular and ground speeds, orientation, and stopping rate when presented in these 15 s blocks (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Together, this suggested that turning and stopping comprised the bulk of the navigational repertoire for walking flies in spatiotemporally complex plumes. This prompted us to next examine how the sequence of individual odor encounters experienced by navigating flies precisely shapes their decisions to turn, walk, and stop.</p></sec><sec id="s2-4"><title>Upwind orientation results from repeated odor encounters, not cumulative odor exposure time</title><p>Flies reorient upwind soon after flying into an odor ribbon (<xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>) or walking into a homogeneous odor block (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>). We therefore calculated the change in fly orientation following an individual encounter, finding that within 2 s of an encounter onset, flies of any orientation biased their orientation upwind (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Since encounter frequency was on the order of a few Hz, flies receiving one encounter were likely to receive more within the 2 s window. Upwind bias may therefore reflect an accumulated effect from repeated odor encounters. Partitioning the data into encounters followed by 0, 1-3, or 4+ further encounters within 2 s, we found that odor encounters followed closely by many others elicited much stronger upwind bias than did isolated ones (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). To quantify this more precisely, we calculated a running average of encounter frequency <italic>W</italic><sub><italic>freq</italic></sub>(<italic>t</italic>) by convolving the binary vector of encounter onset times with an exponential filter (timescale <italic>τ</italic> = 2 s), and plotted upwind orientation as a function of encounter frequency (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). All orientations were reflected over the <italic>x</italic>-axis, whereby 0° is upwind and 180° is downwind. The trend was strongly monotonic, with an intercept of 88.6° at 0 Hz – flies experiencing no encounters were oriented nearly equally upwind and downwind – and a slope of 21.6°/Hz (<italic>p</italic> &lt; 10<sup>−4</sup>) – flies experiencing a frequency of 3 Hz would be oriented just 25<sup>o</sup> off the upwind direction. If no further encounters were received, this monotonic trend dropped steadily to a slope of 4.5°/Hz (not significantly different from 0, <italic>p</italic> &gt; 0.05) after 5 s (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). This suggests that repeated interactions with the plume biased the fly upwind, and after some time without encounters, flies were again uniformly oriented.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Flies use encounter frequency to bias orientation upwind.</title><p>(<bold>A</bold>) Orientation 2 s after an encounter, as a function of orientation at encounter onset (<italic>n</italic>=5040). The mean orientation change for random times is subtracted out. (<bold>B</bold>) Same data, now binned by the number of subsequent encounters in the 2 s window. (<bold>C</bold>) Orientation as a function of encounter frequency at the most recent encounter, <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, for various times <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> after encounters have been interrupted. Encounter frequency is defined by convolving the binary vector of encounter onsets with an exponential filter of timescale <italic>τ </italic>= 2 s. <inline-formula><mml:math id="inf5"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn> <mml:mi/></mml:math></inline-formula> defines the time of the most recent encounter, and the individual plots show fly orientation as a function of the encounter frequency at this time, <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula>. Orientation biases strongly upwind with frequency and this correlation vanishes after ~5 s. (<bold>D</bold>) Orientation versus encounter frequency when encounter duration is held fixed within a small range, for various ranges. (<bold>E</bold>) Orientation versus encounter duration when encounter frequency held fixed within a small range. (<bold>F</bold>) Estimated regression coefficients for a trilinear fit of fly orientation to encounter frequency, encounter duration, and signal intensity. Each of the independent variables has been standardized. Coefficients are plotted for various times after encounters are interrupted (as in C). Statistical significances using a 2-tailed t-test are shown next to curves; if no stars are shown, the coefficients are not statistically distinct from 0. The data indicate that orientation correlated with encounter frequency but not encounter duration or signal intensity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Encounter-elicited orientation change in time.</title><p>(<bold>A</bold>) Orientation 2 s window following an encounter (<italic>n</italic> = 5040), for fly orientations binned in 0–30, 30–60, 60–120, 120–150, and 150–180 degrees, where 0 is upwind and 180 is downwind. Time progresses radially outward. Orientations for random (non-encounter elicited) times are indicated by the dashed lines. (<bold>B</bold>) Same data, now binned by number of subsequent encounters in the 2 s window.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig3-figsupp1-v1.tif"/></fig></fig-group><p>The amount of time a fly is exposed to odor increases with each subsequent encounter. Does upwind bias result from the number of individual odor interactions, the cumulative duration of these encounters, or both? If, for example, all encounters were 200 ms long, then tripling encounter frequency would also triple perceived odor duration – frequency and duration would be perfectly correlated. But if orientation depended on odor duration alone, the dependency on frequency noted above would arise simply as a consequence of this correlation. Prior results suggest that walking flies bias orientation and speed by filtering odor in time (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>), so we suspected that odor duration might contribute to some or all of the upwind bias. To investigate this possibility, we defined a running average of odor duration <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> analogously to <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> by exponentially filtering the binary vector of odor intermittency (1 during encounters, 0 during blanks). We disassociated <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> by holding one constant to a small range, and plotting upwind orientation against the other. Surprisingly, with this analysis, only the correlation of orientation with encounter frequency remained (<xref ref-type="fig" rid="fig3">Figure 3D-E</xref>). We also investigated the possibility that odor concentration contributed to upwind turning by defining <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> analogously using the raw signal. While we have not quantified the exact relationship between odor concentration and image intensity, our dose-response results (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C-D</xref>) suggest that they are monotonically related, so a correlation would exist to first order. Linearly regressing upwind orientation simultaneously against <inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, and <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, revealed <inline-formula><mml:math id="inf15"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> as the sole explanatory variable (<italic>p &lt;</italic> 1e-6, <italic>p</italic> &gt; 0.05, <italic>p</italic> &gt; 0.05, respectively; <xref ref-type="fig" rid="fig3">Figure 3F</xref>). Together, these results indicate that in the intermittent, spatiotemporally complex plumes in this experiment, upwind orientation was driven by the frequency, but not by the duration or concentration, of odor encounters.</p></sec><sec id="s2-5"><title>Odor encounters bias turn direction but not turn likelihood or turn magnitude</title><p>The lack of a clear upwind bias following an isolated encounter (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1B</xref>) suggested that reorientations may not be simply an encounter-elicited reflex. To characterize reorientations, we first thresholded angular speed to identify turn events (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, and Materials and methods). We found that individual turns occurred not in a continuum of angles but rather in discrete saccades of 30°±10° either left or right (<xref ref-type="fig" rid="fig4">Figure 4A</xref>), consistent with previous studies in non-odorized environments (<xref ref-type="bibr" rid="bib24">Geurten et al., 2014</xref>). Moreover, the contribution to upwind bias from the inter-saccade sections of the trajectories was not significant (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). This indicates that the discrete saccadic turns were responsible for upwind progress during navigation. The waiting time between saccades obeyed an exponential distribution with timescale <italic>τ</italic> = 0.75 s±0.17, or a Poisson rate of about 1.3 turns per second (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Surprisingly, this turn rate was insensitive to either encounter frequency or duration (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). This presented a puzzle: if flies turned left and right at discrete angles and a constant rate, they were effectively executing a random walk on the circle. Since angular random walks randomize orientations in time, how would flies orient upwind? Partitioning the turn angle distribution into bouts of low (&lt; 1 Hz) and high (&gt; 4 Hz) encounter frequency resolved this puzzle. For high frequencies, the distribution of turn angles exhibited the same ±~30° peaks, but now with an upwind lobe much larger than the downwind one (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). Thus, odor encounter frequency biased the direction of turns, while leaving the magnitude and rate of turns unchanged.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Odor encounters bias turn direction but not turn rate or turn magnitude.</title><p>(<bold>A</bold>) Distribution of change in orientation following a turn. The discreteness of turn angle (two narrow peaks in pdf) was verified to be insensitive to the threshold used to determine turns (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). (<bold>B</bold>) Cumulative change in orientation over non-turning bouts (‘straight’ segments) 2 s after an encounter, versus orientation at encounter onset (compare with <xref ref-type="fig" rid="fig3">Figure 3B</xref>). Data are partitioned into encounters followed by 0, 1-3, or 4+ subsequent encounters in the following 2 s. (<bold>C</bold>) Leftmost plot: Distribution of time until a turn. Red line: maximum likelihood fit to an exponential distribution, with mean 0.75±0.17 s (distribution generated by bootstrapping). Remaining plots: Same, now for times at which encounter frequency is low (&lt;1Hz; 2nd plot) or high (&gt;3Hz; 3rd plot), or times at which encounter duration is low (&lt;100 ms; 4th plot) or high (&gt;500 ms; 5th plot). Fits are 0.71±0.17 s, 0.86±0.31 s, 0.75±0.19 s, 0.70±0.35 s, respectively, none of which are statistically distinct from the data for all turns (<italic>p</italic> &gt; 0.05, 2-tailed t-test). (<bold>D</bold>) Distribution of turn angles during low (&lt; 1 Hz) or high (&gt; 4 Hz) encounter frequency bouts (compare A). (<bold>E</bold>) Model of fly turning. Turn events obey a Poisson process with timescale <italic>τ</italic><sub>T</sub>=0.75s (C). Turn direction is chosen randomly at each turn time, where the probability <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that the turn is directed upwind is modeled by <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi/></mml:math></inline-formula>(Materials and methods). <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is therefore a sigmoidal function of the frequency of odor encounters <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where the gain parameter <inline-formula><mml:math id="inf20"><mml:mi>α</mml:mi></mml:math></inline-formula> represents the steepness of the sigmoid. (<bold>F</bold>) Distribution of gain parameter <inline-formula><mml:math id="inf21"><mml:mi>α</mml:mi></mml:math></inline-formula>, estimated for 500 distinct subsets of the data. The distribution is highly peaked, indicating its robustness. The median estimate of <inline-formula><mml:math id="inf22"><mml:mi>α</mml:mi></mml:math></inline-formula> is 0.242 Hz<sup>−1</sup>. (<bold>G</bold>) Upwind orientation versus encounter frequency for data (black) and model prediction (red).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Quantification of turn detection.</title><p>(<bold>A</bold>) Turns occur when the angular speed crosses a threshold. The total change in orientation <inline-formula><mml:math id="inf23"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> is the change in angle over some time window <inline-formula><mml:math id="inf24"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi> <mml:mi/></mml:math></inline-formula> centered on the turn time. (<bold>B</bold>) Distributions of orientation change <inline-formula><mml:math id="inf25"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> for various time windows <inline-formula><mml:math id="inf26"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula> (shades) about the turn midpoint, for various thresholds (colors). For all thresholds &gt; 150 deg/s, orientation change <inline-formula><mml:math id="inf27"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> increases with window <inline-formula><mml:math id="inf28"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi> <mml:mi/></mml:math></inline-formula> at first, but then the distributions remain steady, maintaining a bimodal structure. (<bold>C</bold>) Location of peak <inline-formula><mml:math id="inf29"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi> <mml:mi/></mml:math></inline-formula> for different turn thresholds, as a function of window length <inline-formula><mml:math id="inf30"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula>. For all thresholds &gt; 150 deg/s, peak <inline-formula><mml:math id="inf31"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi> <mml:mi/></mml:math></inline-formula> remains constant for sufficient <inline-formula><mml:math id="inf32"> <mml:mi mathvariant="normal"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig4-figsupp1-v1.tif"/></fig></fig-group><p>These findings could be recapitulated with a simple stochastic model of turning, in which walking flies execute Poisson turns at a constant rate. The magnitude of each turn is chosen randomly from the measured distribution, and the likelihood <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that the turn is directed upwind is a sigmoidal function of the encounter frequency. Specifically, <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). This model produces unbiased turns (<inline-formula><mml:math id="inf35"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>) in the absence of odor encounters and a high likelihood of upwind turns (<inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) when encounters are very frequent. We estimated the parameters from a maximum likelihood fit to the data, obtaining a distribution of parameters by performing the estimation on 500 distinct subsets of the measured data (Materials and methods). The distribution of estimated gains <inline-formula><mml:math id="inf37"><mml:mi>α</mml:mi> <mml:mi/></mml:math></inline-formula> clustered tightly around a mean of <inline-formula><mml:math id="inf38"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.242</mml:mn></mml:math></inline-formula> 1/Hz (<xref ref-type="fig" rid="fig4">Figure 4F</xref>), indicating that the parameter estimates were robust. Simulating this model with the mean of the estimated parameters closely reproduced the dependence of upwind orientation on encounter frequency (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). Together, these findings indicated that in the spatiotemporally complex plume, odor encounters did not initiate reflexive upwind turning. Rather, odor encounters increased the likelihood that stochastically-occurring, saccadic left/right turns were directed upwind.</p></sec><sec id="s2-6"><title>Stopping and walking are stochastic events whose rates depend on odor encounter timing</title><p>Walking flies navigating spatiotemporally complex plumes stopped frequently (<xref ref-type="fig" rid="fig1">Figure 1D</xref>), and the rate of both stopping and starting depended strongly on the presence of odor (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). To connect walk-stop transitions to individual encounters, we first calculated the likelihood to be walking or stopped during the 2 s after an encounter (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1A</xref>). Walking flies were more likely to remain walking after an encounter (versus random times), while stopped flies were more likely to initiate a walk. Notably, even a single encounter was sufficient to initiate walks, and higher encounter frequencies biased this further (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>). This implicated both individual encounters and encounter history in decisions to walk or stop. In contrast, we found no change in walking speed following encounters (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1C</xref>), even when encounter frequencies were appreciable (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1D</xref>).</p><p>How does the sequence of encounters shape a fly’s decision to walk or stop? After an odor encounter, flies walked for longer periods before stopping, compared to random (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Thus, encounters reduce stopping likelihood, and flies experiencing higher encounter frequencies walked for longer (<xref ref-type="fig" rid="fig5">Figure 5B-C</xref>). In addition, the time to stop following an encounter was the same, whether the encounter was isolated or part of a clump containing 3+ encounters in 1 s (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). The times to stop were approximately exponentially distributed. We therefore modeled stop decisions as a Poisson process with a time-dependent stopping rate <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf40"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the binary vector of encounter onset times. We considered various models for the dependency of the stopping rate on the encounter sequence <inline-formula><mml:math id="inf41"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. In the <italic>last encounter</italic> model, <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> drops to the same given value at each encounter, before decaying back to baseline with some characteristic time <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5D</xref>). In the <italic>accumulated evidence</italic> model, <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> decreases further at every odor encounter, and therefore remains at a lower value when encounters are more closely spaced (<xref ref-type="fig" rid="fig5">Figure 5H</xref>). In the <italic>encounter duration</italic> model, <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> switches between a low value during encounters and a higher value during blanks (<xref ref-type="fig" rid="fig5">Figure 5I</xref>). These models contain various parameters dictating the baseline rates and timescales, which we fit to the data using maximum likelihood estimation. As in the turn model, we obtained a distribution of parameters by carrying out the estimation on 500 distinct subsets of the data – quantifying the robustness of each parameter (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2A</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Stop decisions are stochastic events whose rate is modulated by the timing of the most recent encounter.</title><p>(<bold>A</bold>) Distribution of walking duration following any odor encounter, or the most recent encounter or clump before a stop. Dashed: distribution for randomly chosen times. Red dashed: clean air control. (<bold>B</bold>) Cumulative encounter counts since walk onset, for various walk durations. (<bold>C</bold>) Average encounter frequency versus duration of walk bout. (<bold>D</bold>) In the last encounter model, stop decisions are modeled as a Poisson process with an inhomogeneous rate <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> resets to a fixed value at every encounter, then decays back to baseline. This is modeled by <inline-formula><mml:math id="inf48"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf49"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></inline-formula> is the time since the most recent encounter (Materials and methods for details). Median of estimated parameters are <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.78</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, Δ<italic>λ</italic>=-0.61s<sup>-1</sup>, <italic>τ</italic><sub>s</sub>=0.25s (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). (<bold>E-G</bold>) Analogs of A-D using data generated by the model. (<bold>H</bold>) Analogs of E-G for the accumulated evidence model. In this model, <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> decreases at every encounter, but remains at a lower value when encounters are more closely spaced. We model this with <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>I</bold>) Analogs of E-G for the encounter duration model, in which <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced> <mml:mi/></mml:math></inline-formula> switches between a low value during encounters and a higher value during blanks.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Stop and walk decisions depend on encounter timing.</title><p>(<bold>A</bold>) Probability of walking (green) and being stopped (red) in a 2 s window following an odor encounter (solid) or at random times (dashed). (<bold>B</bold>) Same, for encounters with zero subsequent encounters (lighter shade) or &gt; 5 subsequent encounters (darker shade) in the following 2 s. (<bold>C</bold>) Walking speed in a 2 s window following encounters, binned by the speed at encounter onset. Dotted lines indicate randomly chosen times. (<bold>D</bold>) Same, for six or more subsequent encounters in the 2 s window.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Distributions of estimated parameters for walk-to-stop models.</title><p>(<bold>A</bold>) The estimated parameters for the last encounter model of walk-to-stop transitions, using 500 distinct subsets of the data. The red box indicates that this model was the best fit to the data (<xref ref-type="fig" rid="fig5">Figure 5D-G</xref>). Occasionally, the global minimum of the nonconvex cost function cannot be found and the optimization terminates near the parameter bounds, rendering the parameter distributions bimodal. (<bold>B–C</bold>) Same for the other two models, which did not explain the data. In some cases, the minimum consistently lies at the boundary (e.g. <inline-formula><mml:math id="inf54"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> in the accumulated evidence model), suggesting that the model is poor. In both models, the predictions were poor (<xref ref-type="fig" rid="fig5">Figure 5H-I</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig5-figsupp2-v1.tif"/></fig></fig-group><p>We found that the time-to-stop statistics were explained well by the last encounter model (<xref ref-type="fig" rid="fig5">Figure 5E–G</xref>) but not by the other models (<xref ref-type="fig" rid="fig5">Figure 5H–I</xref>). Our parameter fits indicate that at each encounter, the stopping rate drops to 0.17 s<sup>−1</sup>, before rising with timescale 0.25 s to a background rate of 0.78 s<sup>−1</sup>. In the accumulated evidence model, the distribution of parameter estimates were broad, and often the parameters were estimated close to the imposed bounds (which ranged 2 orders of magnitude), suggesting that this model was not robust to the data (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2B</xref>). The parameters of the encounter duration model were narrowly peaked, but the predictions were poor, so the model was incomplete (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2C</xref>). In both these latter models, the distribution of walk durations following encounters was not higher than those following random times (compare black and dotted black lines in <xref ref-type="fig" rid="fig5">Figure 5A E</xref> to those in <xref ref-type="fig" rid="fig5">Figure 5H–I</xref>). Thus, our data indicate that flies continuously adjust their likelihood to stop while navigating and that the rate of stops decreases by a factor of nearly five at the onset of each encounter. This decrease in stop rate at each encounter is brief, less than 1 s, suggesting that the ongoing perception of frequent encounters retains the flies in an active, walking state, but when encounters are interrupted, stops are frequent.</p><p>Next, we quantified the rate of stop-to-walk transitions. In contrast to stops, the time to walk was significantly shorter following a clump of encounters than an isolated encounter (<xref ref-type="fig" rid="fig6">Figure 6A</xref>), implicating the history of encounters in walk initiation. In addition, the cumulative number of encounters received during a stop bout was rather independent of stop length, ~ 0.75-1.25 encounters for stops between 2 and 6 s long (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). This observation would not rule out models in which the walking likelihood accumulated with every encounter, nor those in which the rate jumped to a large, fixed value at each encounter. Therefore, we modeled walk decisions with three models analogous to those used for the stop decisions. In the accumulated evidence model, the rate increases by the same amount at each encounter (<xref ref-type="fig" rid="fig6">Figure 6D</xref>), while in the last encounter model, the walk rate <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> increases to a set value at each encounter, before decaying to baseline (<xref ref-type="fig" rid="fig6">Figure 6H</xref>). In the accumulated evidence model, stopped flies receiving a clump would initiate walks sooner than those receiving a single encounter. In the encounter duration model, the rate switches between a higher value in encounters and a lower value in blanks (<xref ref-type="fig" rid="fig6">Figure 6I</xref>). The time-to-walk statistics were fit well by the accumulated evidence model (<xref ref-type="fig" rid="fig6">Figure 6E-G</xref>) but not the other two models (<xref ref-type="fig" rid="fig6">Figure 6H-I</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). The estimated baseline walking rate is <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.29</mml:mn></mml:math></inline-formula> s<sup>−1</sup>, so stopped flies will on average remain stopped for ~3 s if they receive no signal. This rate increases at each encounter by <inline-formula><mml:math id="inf57"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.41</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, before decaying to baseline <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> with a timescale of 0.52s. Though our model predicts that a higher frequency of encounters will elicit an earlier walk, <inline-formula><mml:math id="inf59"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi></mml:math></inline-formula> is comparable to the base rate – more than doubling the transition rate – so even a single encounter is sufficient to elicit a walk, as observed in <xref ref-type="fig" rid="fig6">Figure 6B</xref> and <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1B</xref>. Together, this suggests that stopping forms a key component of the navigational strategy, and that stop and walk decisions are stochastic events whose rates of occurrence depend on the precise timing of recent encounters.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Walk decisions are stochastic events whose rate accumulates evidence from recent encounters.</title><p>(<bold>A</bold>) Distribution of stop duration following any encounter, or the most recent encounter or clump before a walk. (<bold>B</bold>) Cumulative encounter counts since walk onset, for various stop durations. (<bold>C</bold>) Average encounter frequency versus duration of stop bout. (<bold>D</bold>) In the accumulated evidence model of walk decisions, <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> increases at every encounter onset, before decaying to baseline. This is modeled by <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi><mml:mo>∫</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. Median of estimated parameters are <italic>λ</italic><sub>0</sub>=0.29s<sup>-1</sup>, Δ<italic>λ</italic>=0.41s<sup>-1</sup>, <italic>τ</italic><sub>w</sub>=0.52s (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). (<bold>E-G</bold>) Analogs of A-C using data generated by the model. (<bold>H</bold>) Analogs of E-G for the last encounter model, in which the walk rate increases to a fixed value at each encounter before decaying to baseline. (<bold>I</bold>) Analogs of E-G for the encounter duration model, in which <inline-formula><mml:math id="inf62"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> switches between a high value during encounters and low value during blanks.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Distributions of estimated parameters for stop-to-walk models.</title><p>(<bold>A</bold>) The estimated parameters for the accumulated evidence model of stop-to-walk transitions, using 500 distinct subsets of the data. (<bold>B–C</bold>) Same for the other two models, which did not explain the data well. In the last encounter model, the <inline-formula><mml:math id="inf63"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi></mml:math></inline-formula> parameter was consistently estimated at its bound (effectively zero). In both models, the predictions were poor (<xref ref-type="fig" rid="fig6">Figure 6H-I</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig6-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-7"><title>Encounter-modulated decisions enhance navigational performance</title><p>To test how these behavioral algorithms individually affected navigational performance, we incorporated our findings into an agent-based simulation (<xref ref-type="fig" rid="fig7">Figure 7A</xref>). We simulated 10,000 individual virtual flies navigating using the turn, stop-to-walk, and walk-to-stop models that we found in our data. In these simulations, we calculated both the likelihood that agents reach the source as well as the time taken to do so. Virtual flies implementing all three encounter-modulated behaviors navigated largely in the plume cone (<xref ref-type="fig" rid="fig7">Figure 7B</xref>) and converged to the source (<xref ref-type="fig" rid="fig7">Figure 7C</xref>), similarly to real flies (10.5% of real flies and 7.8% of virtual agents reached within 15 mm of the source). Visually, the simulated tracks resembled the measured tracks, containing non-linear, circuitous routes toward the source, as well as wide loops (<xref ref-type="fig" rid="fig7">Figure 7B</xref>). To meaningfully test the contribution of the walk, stop, and turn decisions in effective navigation, we systematically replaced each time-dependent rate with its average, so that overall biases were retained but the dependency on encounters was not. Without encounter-modulated turning, adding stopping and walking decisions alone improved performance marginally (<xref ref-type="fig" rid="fig7">Figure 7D</xref>). With encounter-modulated turning present, however, the addition of either walk or stop decisions obeying our models both markedly increased the chance of finding the source and markedly reduced the search time. Together, this indicates a key benefit of encounter-driven stop-walk modulation when navigating spatiotemporally complex plumes.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Agent-based simulation reveals navigational performance is significantly improved by encounter-modulated turn and walk decisions.</title><p>(<bold>A</bold>) Agent-based simulation. Left: An agent has four behavioral states: stops, walks, and saccadic turns either left or right. Middle: Diagram of behavioral transitions. Right: Hypothetical trajectory of a virtual fly. Stop-to-walk rates and upwind turn probability depend on encounter history, whereas walk-to-stop rates depend only on the time of the last encounter. (<bold>B</bold>) Comparison of trajectories of real flies to those of virtual navigators in the complex plume. Top row: Representative trajectories. Bottom row: seven exemplary trajectories that reached within a 15 mm radius of the source. (<bold>C</bold>) Pdf of virtual flies (<italic>n</italic> = 10000 trajectories). Magenta: location of the source; blue curves: marginal pdfs over x- and y-direction for the simulation; dotted-black curves: marginal pdfs for the real flies (reproduced from <xref ref-type="fig" rid="fig1">Figure 1K</xref>). Very close to the source, the plume becomes ribbon-like, and real flies navigate this region by zigzagging around the slowly meandering ribbon as we have found in static ribbons (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1B</xref>). In addition, flies tend to aggregate near the front of the arena near the odor inlet once reaching the source region. Since our models describe the navigation strategy in the interior of the plume, rather than this anterior near-source region, we have excluded the front 20 mm of the arena from the marginals. Red rectangle: borders used to determine whether a synthetic navigator reached to the source. (<bold>D</bold>) Purple: a fractional increase in the number of virtual flies that arrived at the source (borders of red box in C, same width in the y-direction as the one used in our static plumes [<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>] and a length of 20 mm in the x-direction), <inline-formula><mml:math id="inf64"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>100</mml:mn><mml:mo>(</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>N<sub>C</sub></italic> is the number of control flies that arrived at the source, and <italic>N<sub>i</sub></italic> is the number of flies arrived at the source for simulation condition <italic>i.</italic> Simulation conditions <italic>i</italic> (x-axis) are distinguished by which behavioral components (turn, walk, and stop decisions) were removed. Stop and walk decisions were removed by setting the corresponding transition rate to their averages over all navigators in the full model (left-most bar). Turn decisions were removed by setting the upwind turn probability to its average. Orange: a fractional decrease in the arrival time, <inline-formula><mml:math id="inf65"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mn>100</mml:mn><mml:mo>(</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>T</italic> is the time to arrive to source. n = 762, 726, 694, 522, 341, 350, 389 trajectories. Error bars represent the SEM calculated by bootstrapping the data 30 times with replacement.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-57524-fig7-v1.tif"/></fig></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Odor plumes can vary widely in spatiotemporal structure depending on the geometry of the surroundings and the nature of the airflow. In turbulent flows, the duration of odor encounters and blanks are power-law distributed, spanning a wide range of values from milliseconds to a few seconds long (<xref ref-type="bibr" rid="bib15">Celani et al., 2014</xref>). While these flows become laminar near very smooth boundaries, the presence in natural terrains of obstacles, wind shifts, source motions, surface roughness, and boundary layer instabilities can cause smooth odor streams to break up into complex filaments (<xref ref-type="bibr" rid="bib14">Cardé and Willis, 2008</xref>; <xref ref-type="bibr" rid="bib40">Murlis et al., 1992</xref>; <xref ref-type="bibr" rid="bib41">Murlis et al., 2000</xref>; <xref ref-type="bibr" rid="bib45">Riffell et al., 2008</xref>). In our wind tunnel, we generate such perturbations by perturbing the laminar flow with stochastically alternating air jets near the upwind end. The key feature of this environment is that the statistics of the resulting odor patches are broadly distributed and approximate those in the atmospheric boundary layer (<xref ref-type="fig" rid="fig1">Figure 1G–H</xref>, <xref ref-type="fig" rid="fig1s3">Figure 1—figure supplement 3</xref>), while allowing us to image behavior and signal simultaneously.</p><p>The intermittent nature of turbulent odor plumes has inspired a number of theoretical navigational algorithms that treat odor signals as a train of event times (e.g. as in <inline-formula><mml:math id="inf66"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>), ignoring encounter information about concentration and duration (<xref ref-type="bibr" rid="bib4">Balkovsky and Shraiman, 2002</xref>; <xref ref-type="bibr" rid="bib58">Vergassola et al., 2007</xref>). Indeed, information-theoretic analysis has indicated that precise measurements of odor concentration may confer less benefit than coarse measurements across space or time (<xref ref-type="bibr" rid="bib7">Boie et al., 2018</xref>). In ‘infotactic’ searches (<xref ref-type="bibr" rid="bib58">Vergassola et al., 2007</xref>), agents successfully navigate turbulent plumes by updating an internal spatial model of the plume structure, using only the arrival time of individual encounters. Analysis of insect flying trajectories (<xref ref-type="bibr" rid="bib42">Pang et al., 2018</xref>) and <italic>Caenorhabditis elegans</italic> larvae crawling patterns (<xref ref-type="bibr" rid="bib12">Calhoun et al., 2014</xref>) indicate that encounter-timing-driven infotaxis may form part of the navigation repertoire when concentration gradients are absent or difficult to measure.</p><p>Beyond theory, various experiments have shown that in intermittent plumes the frequency of encounters strongly shapes navigational behavior. The starkest indication of this in insect olfaction is the response of flying moths, <italic>Cadra cautella</italic> and <italic>Heliothos Virescens</italic> (<xref ref-type="bibr" rid="bib38">Mafra-Neto and Cardé, 1994</xref>; <xref ref-type="bibr" rid="bib59">Vickers and Baker, 1994</xref>; <xref ref-type="bibr" rid="bib3">Baker and Vickers, 1997</xref>; <xref ref-type="bibr" rid="bib13">Carde and MafraNeto, 1997</xref>), and walking moths, <italic>Bombyx mori</italic> (<xref ref-type="bibr" rid="bib34">Kanzaki and Sugi, 1992</xref>), to pheromone plumes. In turbulent plumes and plumes pulsed at sufficient frequency, moths follow tight, narrow trajectories toward the source, whereas when the pulsing frequency is too low or the ribbon is static, they execute more zigzagging motion. To explain this, a model has been proposed in which an internal counterturning tendency is suppressed or reset by plume hits (<xref ref-type="bibr" rid="bib35">Kennedy and Marsh, 1974</xref>; <xref ref-type="bibr" rid="bib3">Baker and Vickers, 1997</xref>). A loose analogy could be made with our findings. Moths move crosswind and execute counterturns to find the plume, but once within the plume cone, high-frequency odor encounters cause them to suppress counterturns and surge upwind. Analogously, walking <italic>Drosophila</italic> move crosswind and execute a local search to get inside the plume but once inside a complex plume cone they execute random left/right saccades, with frequent odor encounters biasing these saccades upwind. In both cases, the timing and frequency of odor encounters suppress exploration and drive progress toward the source.</p><p>Like moths, flying flies navigating static odor ribbons counterturn back into them after passing through, effecting a similar upwind zigzag motion, though with smaller angles (<xref ref-type="bibr" rid="bib10">Budick and Dickinson, 2006</xref>; <xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>). An alternative explanation to the internal counterturning model in moth is that flies simply counterturn after losing the plume (<xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>). The duration of encounters as flying flies pass through a static ribbon are brief – 10–250 ms – not unlike the encounters we measure in the plume used here. Further, due to the erratic zigzags of flies as they cross the ribbon, encounters are perceived somewhat randomly in time. Thus, it was suggested that since the statistics of perceived odor signals end up resembling those in turbulence, this plume loss-initiated counterturning might be a generic navigational strategy, occurring in spatiotemporally complex plumes as well (<xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>).</p><p>At least for walking flies, we find that this is not the case. Turns occur stochastically, with rates independent of how long flies spend in the odor and the frequency of encounters (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). But there is an important distinction between intermittency in flies crossing standing ribbons and those navigating dynamic plumes. In ribbons, intermittency is generated by animals’ self-motion, creating a strong correlation between the likelihood of an odor encounter and spatial location. The location of expected plume encounters is in this sense highly predictable, which makes counterturning an effective strategy. Within the cone subtended by our dynamic plumes, the frequency and duration of encounters are less correlated with location and direction, and can occur even when the fly is stopped. This makes the location of future hits less predictable (<xref ref-type="fig" rid="fig1">Figure 1J</xref>), so within the plume cone, reactive strategies such as counterturning might be ineffective.</p><p>An important finding here is that the duration of odor encounters plays no role in navigation (<xref ref-type="fig" rid="fig3">Figure 3D–F</xref>). This was unexpected, since a recent systematic quantification of navigation algorithms in walking <italic>Drosophila</italic> found that flies bias their orientation upwind by integrating odor concentration (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>). In that model, the concentration is normalized, so reorientations are accounted for primarily by the duration of the odor. However, the odor signals were relatively slow – pulsed from 0.1 to 1 Hz – giving encounter durations an order of magnitude larger than in the plume used here. This suggests that for rapid, intermittent signals, encounter frequency drives navigation, while for slower signals such as those expected in the boundary layer of a smooth surface, the duration of odor exposure matters. Effective navigation may therefore combine two important features of the temporal odor signal: its rectified derivative (giving encounter onset times) and it is integral (giving odor exposure time). Future studies interpolating between these extremes could elucidate if and how animals weight these two distinctly informative contributions.</p><p>A second important finding is that stopping forms a key component of the search strategy for walking flies (<xref ref-type="fig" rid="fig5">Figures 5</xref>–<xref ref-type="fig" rid="fig7">7</xref>). Stopping and waiting for encounters allows flies to receive odor encounters from dynamic plumes without wandering off-track or expending energy. We find that in deciding to walk, flies accumulate evidence from individual encounters, so walks are more likely following a clump of encounters than a single one. Theoretical work has shown that evidence accumulation from odor encounters can inform internal representations of plume structure to drive successful navigation in gradient-less plumes (<xref ref-type="bibr" rid="bib58">Vergassola et al., 2007</xref>; <xref ref-type="bibr" rid="bib12">Calhoun et al., 2014</xref>), an interesting possibility still to be examined. Filtering and integrating odor concentration drives navigation in odor plumes with longer encounters and less regularity (<xref ref-type="bibr" rid="bib1">Álvarez-Salvado et al., 2018</xref>), suggesting that evidence accumulation – be it from odor duration or frequency – is a generic feature of olfactory navigation in a variety of environments. More work is required to understand the neural circuits and computations responsible for enacting stop and walk decisions. There is evidence that the transcription factor <italic>FoxP</italic> plays a role in value-based decision making, implicating these mutants as possible targets for future studies (<xref ref-type="bibr" rid="bib17">DasGupta et al., 2014</xref>). Finally, encounter-elicited stopping might be unique to walking <italic>Drosophila</italic> and larvae (<xref ref-type="bibr" rid="bib56">Tastekin et al., 2018</xref>), since remaining stationary is more difficult in flight. Still, the reflexive counterturns that flying <italic>Drosophila</italic> execute after losing a plume (<xref ref-type="bibr" rid="bib57">van Breugel and Dickinson, 2014</xref>) do bear a loose resemblance to the increased stop rates following a drop in encounter frequency, so these decisions may have a common origin, but a different behavioral response.</p><p>Our visualizable signal is conventional smoke, a complex odor consisting of various aromatic compounds (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1A</xref>). Gross fly behaviors in smoke are largely reminiscent of those in other known attractive odors, both in straight ribbons and complex intermittent plumes (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>; <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Still, we expect differences in wind conditions, odor identity, and odor valence to modulate finer motor control in navigation (<xref ref-type="bibr" rid="bib32">Jung et al., 2015</xref>). For example, the responses to the onset of the 15 s blocks of spatiotemporally complex signals were less pronounced in ACV than in smoke or ethyl acetate, with the latter being more similar to each other than to ACV (<xref ref-type="fig" rid="fig2">Figure 2</xref>, and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Moreover, <italic>Orco<sup>-/-</sup></italic> flies that lack major olfactory input, but are intact in CO<sub>2</sub> sensing, showed mild aversion around the center of the straight smoke plume, illustrating how different components contribute to the perception of the odor mixture.</p><p>It is surprising that despite the rich locomotive repertoire of walking <italic>Drosophila</italic>, a large part of their olfactory navigational strategy can be reduced to four actions – left turn, right turn, walk, and stop. A recent, systematic study of the locomotive structure of walking <italic>Drosophila</italic> in various windless odor environments has similarly found that behaviors fall into a limited number of states comprising a hierarchical hidden Markov model (<xref ref-type="bibr" rid="bib55">Tao et al., 2019</xref>). While the identity of the odor and fly individuality affect the transition rates between these states, new states do not emerge in different conditions. These findings are consistent with ours. A natural extension would be to study how fly individuality and odor identity affect transition rates in our model, and which conditions would indeed require an extended behavioral space.</p><p>Finally, an important aspect not explored in our work is learning. The navigational algorithms we have found in the plume used here are shaped by odor information from the recent past, over timescales no longer than a few seconds. Animals can learn odor landscapes over longer periods, by associating odor cues with spatial location. Desert ants, <italic>Cataglyphis fortis</italic>, have been shown to use learned olfactory scenes for homeward navigation in the absence of other directional cues (<xref ref-type="bibr" rid="bib11">Buehlmann et al., 2015</xref>). Similarly, in mice, efficient foraging strategies can overtake an otherwise local gradient ascent strategy, if prior information about the odor scene is available (<xref ref-type="bibr" rid="bib25">Gire et al., 2016</xref>). It is possible that the stochastic random walk strategies we observe here could be replaced with more stereotyped maneuvers if flies were sufficiently preconditioned to the environment. How the navigational strategies we have observed here are affected by conditioning, either with repeated trials or with reward feedback, provides a fruitful direction for future studies.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th valign="top">Reagent type <break/>(species) or resource</th><th valign="top">Designation</th><th valign="top">Source or reference</th><th valign="top">Identifiers</th><th valign="top">Additional information</th></tr></thead><tbody><tr><td valign="top">Strain <break/><italic>Drosophila melanogaster</italic></td><td valign="top">Canton-S (CS)</td><td valign="top">John Carlson</td><td valign="top">NA</td><td valign="top"/></tr><tr><td valign="top">Strain <break/><italic>Drosophila melanogaster</italic></td><td valign="top">Gr63A (w*;+;Gr63A<sup>-/-</sup>)</td><td valign="top">Bloomington <italic>Drosophila</italic> Stock Center</td><td valign="top">Bloomington: RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/BDSC_9941">BDSC_9941</ext-link></td><td valign="top"><xref ref-type="bibr" rid="bib31">Jones et al., 2007</xref></td></tr><tr><td valign="top">Strain <break/><italic>Drosophila melanogaster</italic></td><td valign="top">norpA<sup>7</sup></td><td valign="top">Bloomington <italic>Drosophila</italic> Stock Center</td><td valign="top">Bloomington: RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/BDSC_5685">BDSC_5685</ext-link></td><td valign="top"><xref ref-type="bibr" rid="bib6">Bloomquist et al., 1988</xref> <break/><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0092-8674(88)80017-5(47)">https://doi.org/10.1016/S0092-8674(88)80017-5(47)</ext-link></td></tr><tr><td valign="top">Strain <break/><italic>Drosophila melanogaster</italic></td><td valign="top">Orco (w;+;orco[2])</td><td valign="top">John Carlson</td><td valign="top">NA</td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11712">https://doi.org/10.1038/nature11712</ext-link> <xref ref-type="bibr" rid="bib52">Su et al., 2012</xref></td></tr><tr><td valign="top">Strain <break/><italic>Drosophila melanogaster</italic></td><td valign="top">Anosmic (Ir8a[1]; Ir25A[2]; Gr63A[1],Orco[1])</td><td valign="top">Richard Benton</td><td valign="top">NA</td><td valign="top"><xref ref-type="bibr" rid="bib44">Ramdya et al., 2015</xref> <break/><ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14024">https://doi.org/10.1038/nature14024</ext-link></td></tr><tr><td valign="top">Chemical compound</td><td valign="top">Ethyl acetate</td><td valign="top">MilliporeSigma</td><td valign="top">CAT # 270989</td><td valign="top">CAS # 141-78-6</td></tr><tr><td valign="top">Chemical compound</td><td valign="top">Apple cider vinegar</td><td valign="top">Heinz</td><td valign="top">NA</td><td valign="top"/></tr><tr><td valign="top">Software</td><td valign="top">Matlab, R2018a</td><td valign="top">MathWorks, Natick, MA</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_001622">SCR_001622</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/products/new_products/release2018a.html">https://www.mathworks.com/products/new_products/release2018a.html</ext-link></td></tr><tr><td valign="top">Software</td><td valign="top">Anaconda Distribution</td><td valign="top">Anaconda Inc, Austin, TX</td><td valign="top">NA</td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://www.anaconda.com/">https://www.anaconda.com/</ext-link></td></tr><tr><td valign="top">Software</td><td valign="top">Python, 3.6.5</td><td valign="top">Python Software Foundation</td><td valign="top">RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/SCR_008394">SCR_008394</ext-link></td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://www.python.org/downloads/release/python-365/">https://www.python.org/downloads/release/python-365/</ext-link></td></tr><tr><td valign="top">Other</td><td valign="top">Fly food</td><td valign="top">Archon Scientific, Durham, NC</td><td valign="top">NA</td><td valign="top"><ext-link ext-link-type="uri" xlink:href="http://archonscientific.com/">http://archonscientific.com/</ext-link></td></tr><tr><td valign="top">Other</td><td valign="top">Smoke wick</td><td valign="top">Regin Inc Oxford, CT, USA</td><td valign="top">S220</td><td valign="top">Commercial wick to generate smoke</td></tr></tbody></table></table-wrap><sec id="s4-1"><title>Experimental model and subject details</title><sec id="s4-1-1"><title>Fly strains and handling</title><p>Flies were reared at 25°C and 60% humidity on a 12 hr/12 hr light-dark cycle in plastic vials containing 10 mL standard glucose-cornmeal medium (i.e. 81.8% water, 00.6% agar, 05.3% cornmeal, 03.8% yeast, 07.6% glucose, 00.5% propionic acid, 00.1% methylparaben, and 00.3% ethanol. Media was supplied by Archon Scientific, NC). All flies used in behavioral experiments were females. Newly eclosed flies were collected each day and placed in fresh vials. Females were then collected for starvation and placed in empty vials, 30–40 females in each vial, containing soaked cotton plugs at the bottom and top. All flies were 5–9 days old and 3–4 days starved when experiments were performed. Experiments were carried out within 5 hr prior to the subjective sunset (i.e. 12 hr light turn off). All fly strains used in this paper are listed in the Key resources table.</p><p>Wild type CS and Orco<sup>-/-</sup> mutant flies were provided by John Carlson. Gr63a<sup>-/-</sup> (RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/BDSC_9941">BDSC_9941</ext-link>) (<xref ref-type="bibr" rid="bib31">Jones et al., 2007</xref>), and norpA<sup>7</sup> (RRID:<ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/BDSC_5685">BDSC_5685</ext-link>) (<xref ref-type="bibr" rid="bib6">Bloomquist et al., 1988</xref>) mutant lines were purchased from Bloomington <italic>Drosophila</italic> Stock Center. Anosmic flies (Ir8a[1]; Ir25A[2]; Gr63A[1],Orco[1]) were provided by Richard Benton (<xref ref-type="bibr" rid="bib44">Ramdya et al., 2015</xref>).</p></sec><sec id="s4-1-2"><title>Chemicals and reagents</title><p>Smoke wicks used to generate smoke were obtained from Regin Inc, Oxford, CT, USA (sku: S220). Ethyl acetate was purchased from Sigma-Aldrich (sku: S270989; CAS: 141-78-6), and apple cider vinegar, purchased from a grocery store, was made by Heinz.</p></sec></sec><sec id="s4-2"><title>Method details</title><sec id="s4-2-1"><title>Behavioral apparatus and stimulus delivery</title><p>Flies are introduced into an arena of size 300 mm (along wind) and 180 mm (across wind) with a depth of 10 mm (see schematic, <xref ref-type="fig" rid="fig1">Figure 1A</xref>). Flies walk unrestrained in this arena on glass surfaces, top and bottom, which were separated with acrylic walls and also bounded at the upstream and downstream end of the arena by straws and a plastic mesh, respectively. Experiments were recorded with an infrared (IR) sensitive camera (FLIR Grasshopper USB 3.0 NIR) in a dark room under IR illumination (850 nm). The recording rate was 30 Hz and 90 Hz for straight and intermittent plume experiments, respectively. The intermittent plume required a higher frame rate to track the dynamic smoke stimulus with sufficient resolution.</p><p>The behavioral apparatus operates as a wind tunnel. Active-charcoal filtered dry-air passes through the straws stacked at the upstream end of the arena and creates a laminar flow with a flow speed around 150 mm/s. Flow speed is measured by two methods: with an anemometer and by imaging and calculating the speed of a smoke plume in the laminar flow. The flow speed calculated with these two methods were similar (data not shown). The air and any odor carried with it were collected at the downstream end of the device with a vacuum hose loosely coupled to the device.</p><p>In order to deliver odorants into the behavioral chamber, clean air was passed over the headspace of pure odors placed in glass vials, and obtained odorized air was passed through a straw fixed at the center of the stack that creates the laminar flow. Variations in the odor dose was obtained by varying the ratio of odorized and clean air in the final flow delivered into the chamber. In the case of smoke, smoke generated by a burned wick (S220, Regin Inc) is accumulated in a 250 mL bottle for 20 s, and that bottle was used as the smoke-odor source.</p><p>Straight plumes were obtained by simply matching the odorized air flow speed to laminar flow speed. In order to generate intermittent plumes, air flows (flow speed:~1500 mm/s) perpendicular to the laminar flow were injected into the arena near the upstream end of the device. The injected air flows were randomly alternated between the left and right side of the arena with 100 ms correlation time.</p></sec><sec id="s4-2-2"><title>Experimental protocol</title><p>Starved flies, between 30 and 40 in number, were aspirated into the arena all in once while the wind was on and allowed 1 min to acclimate to their environment before the experiment. This odor was on during the whole experiment, which lasted 90 s (unless otherwise noted), however, it took several seconds,~5 s, to pass through the tubing and enter into the arena. In pulsed intermittent plume experiments, while the random lateral air injections persisted, the odor was alternatively turned on and off in 15 s blocks. Experiments were repeated three times on the same flies, leaving 3 min intervals in between. The humidity and temperature of the room is logged for each experiment. Room temperature was stable at 24.2 ± 0.3 °C. Although the room humidity varied between 25% and 43% (average: 32.5 ± 2.5%) depending on the season of the year, flies were tested in dry air flow which had humidity close to zero.</p><p>To minimize contamination caused by odor molecules sticking to inner surfaces of the experimental apparatus we took the following precautions: First, we used only PTFE Teflon (a hydrophobic, chemically inert, and low friction material that minimizes odor sticking) tubes to deliver odors. Second, we kept experiment durations relatively short (less than 2 min) which eliminated continuous accumulation of residual odorants on the glass surfaces. Third, the main laminar flow was kept flowing for 3–5 min in between trials to wash away residual odors on the glass surfaces and acrylic side walls. Fourth, flies in close vicinity (~3 mm) to the plastic mesh at the downwind end of the apparatus and acrylic side walls were not tracked and therefore not included in the analysis. Fifth, glass surfaces and acrylic side walls were wiped clean with Windex and the downwind plastic mesh was replaced with a clean one before each experiment. Finally, the whole stack of straws and tubing were replaced with clean ones before a different odor was tested.</p><p>Our experimental protocol starts with recording flies in clean air for 90 s before the odor is presented for the first time. This control recording is followed by the experiment that involves odor release and lasts for 90 s. This experiment is repeated three times with the same flies allowing 3 min clean air periods in between trials, before the protocol is repeated on different flies. To assess whether possible residual odors in the arena affected navigation, we compared the behavior of flies in clean air to that of in odorized air. <xref ref-type="fig" rid="fig1">Figure 1L</xref> shows that flies in clean air do not accumulate near the upstream straws or the side walls, even though this is where odors are likely to stick more.</p></sec></sec><sec id="s4-3"><title>Quantification and statistical analysis</title><p>All analysis was performed using custom-written Matlab and Python scripts.</p></sec><sec id="s4-4"><title>Fly tracking and signal estimation</title><sec id="s4-4-1"><title>Fly tracking</title><p>Fly tracks were extracted by analyzing recorded videos. Non-uniform illumination in the arena was corrected by dividing each frame pixel-by-pixel with a flat field image. The flat field image was obtained as follows: (a) median smoothing (filter size ~ 8 mm) the image of the arena free of flies, (b) fitting a 5th-order polynomial to the smoothed surface, (c) normalizing the fitted surface with the mean value. Following the flat-field correction, each frame was thresholded and binarized. In the binarized images, objects with an area larger than one square millimeter were registered as flies. The positions (<inline-formula><mml:math id="inf67"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf68"><mml:mi>y</mml:mi></mml:math></inline-formula> coordinates) and orientations (<inline-formula><mml:math id="inf69"><mml:mi>θ</mml:mi></mml:math></inline-formula>) of the flies were obtained by finding the centroids and major axis of these regions (Matlab regionprops). Tracks were assembled by linking each centroid in a frame to the closest one in the consecutive frame. Whenever two or more flies interacted (i.e. passing over each other on opposite surfaces or collision), water-shedding was used to resolve the identity of the flies. If water-shedding failed, fly positions were predicted based on their recent average velocities until they separate, and identities were then assigned by comparing the predicted positions with the positions right after separation. If this failed, the track was flagged and eliminated from subsequent analysis.</p></sec><sec id="s4-4-2"><title>Signal estimation</title><p>The signal <inline-formula><mml:math id="inf70"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> that flies experience along their path was estimated by calculating the mean smoke intensity in a virtual antenna fixed in front of the flies’ head (<xref ref-type="fig" rid="fig1">Figure 1B</xref> inset). The virtual antenna was as wide as the fly (i.e. 1.72±.24 mm), and its length was set to one-fifth of the fly minor axis (average: 0.46±.08 mm). The distance between the virtual antenna and fly head (i.e. 1.24±.22 mm) was optimized by minimizing the overlap between the virtual antenna and dilated fly body (dilation number: 7). Instances in which the virtual antenna overlapped with another fly or its reflection were flagged as unreliable and eliminated from all analyses that required odor information. The accuracy of our automated detection system was validated by comparing its output to the output of manual annotation. Four videos were manually annotated, frame by frame, by two researchers for the validity of the signal values in the virtual antenna of all flies. The total number of annotated time points was 166,411. This comparison revealed that only 0.97% of all data points were assigned as false positives by our automated software, whereas the fraction of trajectories that were assigned as false negatives was 6.05%.</p></sec><sec id="s4-4-3"><title>Encounter detection</title><p>Due to shot noise, signal values were above zero. In order to calculate the mean background signal value, for each recorded video, we fitted a Gaussian to the distribution of the signal values of all flies and set the mean signal background to the mean of the Gaussian. The signal was then thresholded with a threshold value, equal to the sum of the mean and 2.5 SD of the background signal, and binarized for encounter detections. Instances with signal values higher than the threshold are identified as encounters, and blanks are defined as the intervals between encounters.</p></sec><sec id="s4-4-4"><title>Error estimation in the timing of encounter detection</title><p>The difference in the location of the virtual antenna from that of the actual fly antenna introduces some uncertainty in signal timing. This uncertainty depends on wind speed and direction, and we estimated it as 8.3±1.5 ms and -8.3±1.5 ms for downwind and upwind oriented flies, respectively. Further uncertainty in timing is introduced by our sensory threshold, which we chose as 2.5 SD above the mean camera shot noise. To estimate this uncertainty, we considered flies navigating a static smoke ribbon. We calculated the lateral distance from the plume at which flies counterturn back into the ribbon after passing through it (counterturn positions were found using Matlab’s ‘findpeaks’ function), and compared it to the iso-line of the smoke intensity used for the sensory threshold (2.5<italic>σ</italic>; <xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2A</xref>). The average counterturn positions along the ribbon (calculated using Matlab’s LOWESS smoothing function) aligned with the iso-line of the minimum smoke intensity captured by the camera (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2B</xref>). However, they differed from the iso-line of our 2.5<italic>σ</italic> sensory threshold by 1.94 mm at the downstream end of the device, giving an upper bound of 13 ms uncertainty in encounter timing. Combined with uncertainty from the virtual antenna locations, we estimate the overall error in encounter timing to be less than 25 ms.</p></sec></sec><sec id="s4-5"><title>Analysis of behavioral data</title><sec id="s4-5-1"><title>Smoothing of measured behavioral time traces</title><p>From the procedures described above, we obtained for each fly trajectory the position (<italic>x</italic> and <italic>y</italic> coordinates) and the orientation (<inline-formula><mml:math id="inf71"><mml:mi>θ</mml:mi></mml:math></inline-formula>) of the fly, together with the signal <italic>s</italic> in the virtual antenna. To remove measurement shot noise from the fly tracking and signal estimation, we filtered each of these quantities with a Savitsky-Golay filter with <italic>k</italic>-order polynomial and <italic>m-</italic>length windows, where <italic>k = 4</italic> and <italic>m = 9</italic>. Taking the derivative of the fitted piecewise Savitsky-Golay polynomials for <italic>x</italic> and <italic>y</italic> gives us smoothed velocity components <inline-formula><mml:math id="inf72"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"> <mml:mi/><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively, from which we obtain the speed <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow/></mml:mroot></mml:mrow></mml:mstyle></mml:math></inline-formula>. Similarly, the time rate of change of orientation, <inline-formula><mml:math id="inf75"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo> <mml:mi/><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula>, was found by converting <inline-formula><mml:math id="inf76"><mml:mi>θ</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf77"><mml:mi>x</mml:mi></mml:math></inline-formula>-<inline-formula><mml:math id="inf78"><mml:mi>y</mml:mi></mml:math></inline-formula> components on the unit circle, smoothing each of these with the same Savitsky-Golay filter, taking their first derivative (which is the analytical derivative of the smoothed polynomials), and then converting back to polar coordinates. This last conversion was done using <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, the appropriate equation being chosen if either <inline-formula><mml:math id="inf80"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> or <inline-formula><mml:math id="inf81"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> were too small. This procedure removes issues with the branch cut at <inline-formula><mml:math id="inf82"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, which would arise if <inline-formula><mml:math id="inf83"><mml:mi>θ</mml:mi></mml:math></inline-formula> were differentiated directly. Finally, upwind orientation <inline-formula><mml:math id="inf84"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> was determined by reflecting all angles over the polar <italic>x</italic>-axis to the range 0-180 degrees. All subsequent analyses used these smoothed time traces.</p></sec><sec id="s4-5-2"><title>Determination of stop, turn, and encounter events</title><p>From these smoothed quantities, all binary events – stops, turns, and encounters – were determined in the same way, using a thresholding technique that minimizes false detections. Specifically, the onset of an event is said to occur when the quantity is above threshold, but only if the time above the threshold is longer than some set duration. This prevents false detections of artificially short events that may arise from measurement fluctuations. The same requirement is enforced for the event offset: the quantity must drop below threshold for a sufficient time. For encounter instances, the threshold was set to 2.5× the standard deviation of the background signal, when fit to a Gaussian. For stops, the threshold was set at <inline-formula><mml:math id="inf85"><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> mm/s, and for turns the threshold was set to <inline-formula><mml:math id="inf86"><mml:mo>|</mml:mo><mml:mi>ω</mml:mi><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:math></inline-formula> deg/s. The minimum duration for stops was set to 300 ms, for turns was set to 20 ms, and for encounters was set to 50 ms.</p><p>To verify that the discrete nature of turns was not an artifact of turn detection thresholds, we used the following analysis, whose results are presented in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. Turn events were first detected for a given threshold on absolute angular velocity, <inline-formula><mml:math id="inf87"><mml:mo>|</mml:mo><mml:mi>ω</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula>. A window of length <inline-formula><mml:math id="inf88"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula> is defined around the midpoint of each turn, over which the total orientation change <inline-formula><mml:math id="inf89"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> of the fly can be defined (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1A</xref>, top plot). If angle changes are indeed discrete, then the distribution of <inline-formula><mml:math id="inf90"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> would increase with <inline-formula><mml:math id="inf91"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula> for small <inline-formula><mml:math id="inf92"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula>, but would level out asymptotically to a bimodal distribution for sufficient <inline-formula><mml:math id="inf93"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula>, corresponding to the maximum length of a stereotypical turn. For different choices of <inline-formula><mml:math id="inf94"><mml:mo>|</mml:mo><mml:mi>ω</mml:mi><mml:mo>|</mml:mo></mml:math></inline-formula> (different colored plots in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1B</xref>), darker shades correspond to <inline-formula><mml:math id="inf95"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:math></inline-formula> distributions for increasing window lengths <inline-formula><mml:math id="inf96"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula>. The distributions are invariant once the window is long enough, showing that for sufficiently long time window, the turns are discrete. The positive peak of the distributions is plotted as a function of <inline-formula><mml:math id="inf97"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1C</xref>). This peak levels off above <inline-formula><mml:math id="inf98"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi></mml:math></inline-formula> = 150 ms, for all turn thresholds larger than 150 deg/s. As such, we chose a threshold of 200 deg/s for turns, verifying visually that false positives and false negatives were minimized.</p></sec><sec id="s4-5-3"><title>Fly distributions in the arena</title><p>The probability density function (pdf) of fly distribution in the arena (<xref ref-type="fig" rid="fig1">Figure 1K–L</xref>, <xref ref-type="fig" rid="fig7">Figure 7C</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1C</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1E</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1G</xref>, and <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1I</xref>) is estimated by calculating the histogram (count) of fly positions for each unit area (ΔX = ΔY = 1 mm), and normalizing that histogram with the total count of fly positions. Areas with zero fly visits are indicated with white color in the color scale. All positions for all time points throughout the experiment are used to calculate the histogram, and therefore the estimated pdf represents the cumulative fly walking behavior. Trajectories shorter than 5 s, with a mean speed less than 2 mm/s, and with a total displacement less than 50 mm are eliminated.</p></sec><sec id="s4-5-4"><title>Calculation of stop-to-walk and walk-to-stop transition rates</title><p>To calculate the transition rate from a stop to a walk <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2F</xref>), we considered each part of the trajectory containing one stop followed by one walk. In this range, we set <inline-formula><mml:math id="inf100"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the duration of the stop. Likewise, we get the transition rate from walk to stop, <inline-formula><mml:math id="inf102"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, by considering every trajectory snippet containing one walk followed by one stop. In this range, <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, the walk-to-stop rates update their values at the onset of every stop, and vice versa for walks.</p></sec></sec><sec id="s4-6"><title>Numerical methods</title><sec id="s4-6-1"><title>Statistical tests</title><p>Unless noted otherwise, all error bars represent standard error of the mean. Stars in the manuscript indicating significance are *<italic>p</italic>&lt;0.05, **<italic>p</italic>&lt;0.01, ***<italic>p</italic>&lt;0.001. Unless otherwise noted, for estimating SEM through bootstrapping, 5000 resamples were chosen, with resample size half of the original data size.</p><p>The trivariate linear regression we use to determine the dependence of upwind orientation <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> on <inline-formula><mml:math id="inf105"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf106"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3F</xref>) can exhibit issues of multicollinearity when the two regressors are correlated. This can produce erroneous and non-robust parameter estimates. To check for this, we ensured that the moment matrix <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf109"><mml:mi>X</mml:mi></mml:math></inline-formula> is the matrix of observations, was not ill-conditioned. We found conditions numbers less than 2, indicating no ill-conditioning. We also ensured that the estimated parameters were robust to different subsets of the data. We found that the parameter ranges for these subsets are statistically indistinct from those of the full dataset.</p></sec><sec id="s4-6-2"><title>Calculation of encounter frequency and encounter duration</title><p>Calculation of the odor encounter frequency <inline-formula><mml:math id="inf110"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was done by convolving the binary vector of encounter times <inline-formula><mml:math id="inf111"><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, which contains a ‘1’ at the onset of every encounter and 0s elsewhere, with an exponential filter:<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf112"><mml:mi>τ</mml:mi></mml:math></inline-formula> is set to 2 s. This timescale was chosen to optimize the trends but our findings were robust to this value. Similarly, the encounter duration <inline-formula><mml:math id="inf113"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was calculated by convolving the binary vector of encounter exposure, <inline-formula><mml:math id="inf114"><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> which contains a ‘1’ whenever the fly is within a encounter and 0 s elsewhere, with the same exponential filter:<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, odor concentration was calculated by convolving the raw signal <inline-formula><mml:math id="inf115"><mml:mi>s</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> (an 8-bit integer representing the intensity of the imaged smoke signal) with the same exponential filter:<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec></sec><sec id="s4-7"><title>Modeling</title><sec id="s4-7-1"><title>Stochastic models of stereotyped turning</title><p>Turns are modeled as a homogeneous Poisson processes with rate <inline-formula><mml:math id="inf116"><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo> <mml:mi/><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.3</mml:mn></mml:math></inline-formula> turns/s, determined by fitting the data to an exponential distribution (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). While we did not find a statistically significant dependence of the turning rate on encounter frequency or duration, we allowed for this dependence in fitting the model to the data (below). When a turn occurs, its magnitude and direction are also sampled from probability distributions. The absolute value of the turn angle is chosen from a normal distribution with mean <inline-formula><mml:math id="inf117"><mml:msup><mml:mrow><mml:mn>30</mml:mn></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and standard deviation <inline-formula><mml:math id="inf118"> <mml:mi/><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, representing the two peaks in the bivariate distribution in <xref ref-type="fig" rid="fig4">Figure 4A</xref>. The turn direction is a binomial variable with probability <inline-formula><mml:math id="inf119"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> that the direction is upwind, where the encounter onset times <inline-formula><mml:math id="inf120"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> are defined above. Guided by the observation that the upwind turning probability increases with encounter frequency, we set <inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></inline-formula> as:<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mtext> where </mml:mtext><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>τ</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula>where the filter timescale <inline-formula><mml:math id="inf122"><mml:mi>τ</mml:mi></mml:math></inline-formula> is set to 2 s as above.</p></sec><sec id="s4-7-2"><title>Stochastic ‘accumulated evidence,’ ‘last encounter,’ and ‘odor duration’ models of walk-stop transitions</title><p>Walk-to-stop transitions are modeled as an inhomogeneous Poisson process with rate <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf124"><mml:mi>w</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> are defined above. The distinguishing feature between the three models we test, the last encounter model, the accumulated evidence model, and the encounter duration model, is their functional dependence on <inline-formula><mml:math id="inf126"><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>.</p><p>In the last encounter stopping model, we have:<disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>λ</mml:mi><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mi/></mml:math></disp-formula>where <inline-formula><mml:math id="inf128"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></inline-formula> indicates the time since the most recent encounter. In the accumulated evidence stopping model, we have:<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Finally, in the encounter duration model, we have:<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In the encounter duration model, therefore, the rate is <inline-formula><mml:math id="inf129"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> during encounters and <inline-formula><mml:math id="inf130"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> during blanks. The rates for the stop-to-walk transitions are analogous. For the last encounter model, we have:<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>for the accumulated evidence walking model, we have:<disp-formula id="equ9"><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>λ</mml:mi><mml:mo>∫</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>and for the encounter duration model, we have:<disp-formula id="equ10"><mml:math id="m10"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></disp-formula></p></sec><sec id="s4-7-3"><title>Turn model parameter estimation</title><p>In our turning model, the gain parameter <inline-formula><mml:math id="inf131"><mml:mi>α</mml:mi></mml:math></inline-formula> must be estimated from the data. While we measured the turn rate <inline-formula><mml:math id="inf132"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> from experiment and found no significant dependence on encounter duration or frequency (<xref ref-type="fig" rid="fig4">Figure 4C</xref>), we nevertheless allow it to be a free parameter with a linear dependence on both. The full turn rate <inline-formula><mml:math id="inf133"><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo> <mml:mi/><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is therefore:<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The turning model thus contains four unknown parameters: <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, which we obtain using maximum likelihood estimation. The expression for the maximum likelihood depends on various conditional probability distributions, which we now discuss. The measured data are orientation changes <inline-formula><mml:math id="inf135"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at each time step during which the fly is walking. These angle changes arise either during straight bouts, where the angle changes consist of small zero-mean jitter, or during turns. At any given time <inline-formula><mml:math id="inf136"><mml:mi>i</mml:mi></mml:math></inline-formula>, the probability of angle change <inline-formula><mml:math id="inf137"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is:<disp-formula id="equ12"><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf138"><mml:mi>X</mml:mi> <mml:mi/></mml:math></inline-formula> denotes the three possible behaviors: upwind turns, downwind turns, and straight bouts. The probability that a turn is upwind, <inline-formula><mml:math id="inf139"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, is the probability of a turn times the probability that the turn is upwind, given by our turn model above. This gives:<disp-formula id="equ13"><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf140"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi></mml:math></inline-formula> is time step of the measured data. The distribution of upwind angle changes, <inline-formula><mml:math id="inf141"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, is assumed Gaussian with <inline-formula><mml:math id="inf142"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msup> <mml:mi/></mml:math></inline-formula> and mean <inline-formula><mml:math id="inf143"><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mn>30</mml:mn></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (for <inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> between 0 and 180<sup>o</sup>) and <inline-formula><mml:math id="inf145"><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mn>30</mml:mn></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (for <inline-formula><mml:math id="inf146"><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> between 180<sup>o</sup> and 360<sup>o</sup>). These values represent the mean and spread of the two peaks in the measured <inline-formula><mml:math id="inf147"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> during turns (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The distribution of downwind angle changes <inline-formula><mml:math id="inf148"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the same, but with opposite means. The likelihood of a straight walk is:<disp-formula id="equ15"><mml:math id="m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The jitter for straight bouts was measured to be 0.22<sup>o</sup> per time step, whereby <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is assumed normal with standard deviation 0.22<sup>o</sup> and mean 0. With these distributions, the likelihood function of parameters <inline-formula><mml:math id="inf150"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> given the measured data <inline-formula><mml:math id="inf151"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> reads:<disp-formula id="equ16"><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ17"><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first product contains only times at which the flies turn upwind, etc. The parameters were estimated by maximizing the logarithm of <inline-formula><mml:math id="inf152"><mml:mi>L</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. The optimization was performed using the limited-memory Broyden–Fletcher–Goldfarb–Shanno optimization algorithm (L-BFGS). In our implementation of this method, we only provide the cost function (the log-likelihood), and the gradient is computed numerically with finite differences. L-BGFS approximates Hessians from function and gradient evaluations in previous iterations, using this to steer the estimate toward the function minimum. To get an idea of the spread and robustness of parameter values, we perform this optimization for 500 distinct subsets of the data, where each subset contains 20% of all measured trajectories, randomly chosen. We find that the distribution of the 500 estimated <italic>α</italic> and 𝜏<sub>T</sub> are highly peaked around a mean of 0.046 Hz<sup>−1</sup> and 0.75 s, respectively, suggesting that these values are robust to various subsets of the experimental data. The estimated coefficients <italic>τ</italic><sub>freq</sub> and <italic>τ</italic><sub>dur</sub> are small (medians 0.008 and 0.07, respectively, which would each contribute &lt;3% to the base timescale <italic>τ</italic><sub>T</sub>, given the encounter statistics in our intermittent plume), and span both negative and positive values, suggesting that they are not robust. These are in accordance with the lack of dependence in turn frequency on encounter duration or frequency (<xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p></sec><sec id="s4-7-4"><title>Stop and walk models parameter estimation</title><p>The likelihood function for stop and walk models is similar to the turn model. Since the walk-to-stop and stop-to-walk rates are distinct inhomogeneous Poisson processes, with distinct functional forms <inline-formula><mml:math id="inf153"> <mml:mi/><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="inf154"><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for the rates, respectively, we write the likelihood function for walk-to-stop transitions <inline-formula><mml:math id="inf155"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> only here. The other, <inline-formula><mml:math id="inf156"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>→</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>, is analogous.</p><p>The likelihood function for walk-to-stop transitions is:<disp-formula id="equ19"><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first product runs over all times that the fly is walking, while the second product contains only the initial point of each stop bout, which represents the decision to stop, given that the fly is walking. Like the turning model, the rates follow a Poisson process, giving:<disp-formula id="equ20"><mml:math id="m20"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>w</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo> <mml:mi/><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:math></disp-formula><disp-formula id="equ21"><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mo>;</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where the dependence on the parameters <inline-formula><mml:math id="inf157"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> enters through <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. Parameters are estimated as described above by minimizing the logarithm of the likelihood. Rather than optimizing for <inline-formula><mml:math id="inf159"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf160"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, both of which enter the cost function in the denominators (introducing artificial singularities in the derivatives), we optimize for their inverses, which enter linearly in the exponents.</p><p>Since we are fitting stochastic dynamical models (Poisson processes generated by a nonlinear rate function with ODE dynamics), our models naturally allow us to cross-validate by generating predictions to novel stimuli. Cross-validation is a natural check for overfitting and is particularly suited to dynamical models (<xref ref-type="bibr" rid="bib20">Gábor and Banga, 2015</xref>; see <italic>Generation of stop and walk model statistics</italic> below). In nonlinear models with hidden states, near-perfect fits to the data can often produce highly inaccurate predictions when applied to novel data. These inaccuracies are masked by the unobservability of the hidden states but can be revealed by cross-validation (<xref ref-type="bibr" rid="bib33">Kadakia et al., 2016</xref>; <xref ref-type="bibr" rid="bib61">Ye et al., 2015</xref>). In our case, the models were shown to give quite distinct predictions from the estimated parameters. Cross-validation, therefore, provides a strong test for model comparison in our case.</p><p>Alternatively, Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) are both statistical tests for model comparison that combine the log likelihood with a contribution from the number of model parameters. If we calculate the AIC and BIC for our models, for all 500 subsets of the data for which we carried out parameter estimates, we do not find a statistical distinction between the AIC or BIC distributions (among these 500 subsets) for either the set of walk-to-stop models or the set of stop-to-walk models. This can be explained by the following reasoning. The number <italic>k</italic> of model parameters is largely similar between our models, and both <italic>k</italic> (in the case of AIC) or <italic>k</italic>ln(<italic>n</italic>) (where <italic>n</italic> is the number of data points, in the case of BIC) is significantly smaller than the log likelihood <italic>L</italic>, which therefore dominates the AIC/BIC values. <italic>L</italic> is a sum over all timepoints but odor encounter frequency is not evenly distributed among these timepoints: low encounter timepoints are far more common than high-frequency timepoints. Thus, <italic>L</italic> is strongly biased by lower encounter frequency data. In principle, we would like the model predictions to match equally well against the data for all encounter frequencies (e.g. as in <xref ref-type="fig" rid="fig5">Figure 5D–I</xref> and <xref ref-type="fig" rid="fig6">Figure 6D–I</xref>, which span low and high encounter frequencies). This would not manifest in <italic>L</italic>, and thus would not manifest in the AIC or BIC criteria.</p><p>On the other hand, using cross-validation, we find that the predictions are quite distinct for the models (<xref ref-type="fig" rid="fig5">Figure 5D–I</xref> and <xref ref-type="fig" rid="fig6">Figure 6D–I</xref>). In addition to the reasoning given above, cross-validation requires fewer assumptions than AIC/BIC – there are no Laplace approximations (Gaussian approximation near the optimal parameter) being performed, nor is it derived in the limit of infinite data. Finally, for all our models, the log likelihoods are highly nonlinear, so the Gaussian assumption needed for the Laplace approximation in the AIC and BIC is not well-satisfied.</p></sec><sec id="s4-7-5"><title>Generation of turn model predictions</title><p>To generate the upwind orientation versus encounter frequency plot predicted by the model estimates (red line in the second plot of <xref ref-type="fig" rid="fig4">Figure 4G</xref>), we chose from the 500 sets of estimated parameters <inline-formula><mml:math id="inf161"><mml:mi mathvariant="normal">Θ</mml:mi></mml:math></inline-formula> the median of each parameter. Synthetic <inline-formula><mml:math id="inf162"><mml:mi>θ</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> traces were generated by applying the model to a synthetic random encounter trace which contained encounter frequencies spanning a range from very low (&lt; 0.1 Hz) to high (10 Hz), mimicking the range of frequencies encountered in the data.</p></sec><sec id="s4-7-6"><title>Generation of stop and walk model statistics</title><p>To generate the statistics in Figures 5-6, we chose from the 500 sets of <inline-formula><mml:math id="inf163"><mml:mi mathvariant="normal">Θ</mml:mi> <mml:mi mathvariant="normal"/></mml:math></inline-formula> the median of each parameter. Synthetic stops and walks were then generated from the aggregated measured <inline-formula><mml:math id="inf164"><mml:mi>w</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> of all trajectories by simulating a Poisson process with the corresponding rate functions. This procedure generated a synthetic time series of stop events, given that the fly is walking. From this vector, we calculated time-to-stop for all cases as in the measured data: (i) all encounters, (ii) all isolated encounters, and (iii) all isolated clumps. A similar procedure was used to generate a vector of walk events, given that the fly is stopped. From this vector, we calculated time-to-walk for analogous cases: (i) all encounters, (ii) all isolated encounters, and (iii) all isolated clumps.</p></sec><sec id="s4-7-7"><title>Agent-based simulation</title><p>Virtual agents navigated the same arena and the same intermittent smoke environment as experimental flies. Each simulation batch was run using 10,000 agents, initialized randomly along the back, downwind wall of the arena. The simulation ran for 11,690 time steps at a timestep corresponding to the same sampling rate as the recorded videos, 90 frames per second. The agents were assigned a walking speed equal to the mean walking speed of experimental flies (10.1 mm/s), and their turns were assumed to be instantaneous. Turn angles were drawn from a normal distribution with mean 30<sup>o</sup> and standard deviation 10<sup>o</sup>. The navigators were given elliptical virtual antennas, the centers of which were located approximately 14 pixels (2.16 mm) in front of the fly centers. The elliptical antennas had a semi-major axis of five pixels (0.77 mm) and semi-minor axis of 1.5 pixels (0.23 mm); the semi-major axis was oriented perpendicular to the agent’s orientation vector. To avoid spurious detections arising from jitter in the signal, the virtual navigators registered an encounter only if they had not encountered one in the past 100 ms.</p><p>To remove individual navigational components, the corresponding rate for that component was set to an average rate from the full model. For example, to remove stop decisions, the walk-to-stop rate was set to the average. The average stop-to-walk rate was determined by fitting the distribution of stop durations from all 10,000 trajectories in the full model to an exponential distribution; the fitted timescale was used as the average rate. The average walk-to-stop rate was determined similarly from the distribution of walk durations. The average probability of turning upwind was defined as the fraction of turns directed upwind by all 10,000 trajectories in the full model.</p></sec></sec><sec id="s4-8"><title>Data and code availability</title><p>The fly lines used in this study are available upon request. The data are available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.4j0zpc87z">https://doi.org/10.5061/dryad.4j0zpc87z</ext-link> and the scripts used to perform the experiments, track flies, and extract relevant behavioral data are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/emonetlab/fly-walk">https://github.com/emonetlab/fly-walk</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:6a9266effbdc305c2e6177a7b6786e295cb48a2c/">swh:1:rev:6a9266effbdc305c2e6177a7b6786e295cb48a2c</ext-link>) and scripts used to run simulations are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/emonetlab/fly-walk-sims">https://github.com/emonetlab/fly-walk-sims</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:be9bb7a93eb4963ca0515144940694412304f633/">swh:1:rev:be9bb7a93eb4963ca0515144940694412304f633</ext-link>). We thank the following people for making their Matlab scripts, utilized for generating plots in this work, freely available: Ben Mitch, Panel; Holger Hoffman, Violin; Kelly Kearney, legendflex; Yair Altman, export_fig; David Legland, geom2D; Rob Campbell, shadedErrorBar.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Viraaj Jayaram for his help in running agent-based simulations, John Carlson for providing several fly lines used in this study and for giving us access to instruments in his lab, Richard Benton for providing anosmic flies, Francesco Carbone and Kevin Gleason for performing GCMS analysis on the smoke. Srinivas Gorur-Shandilya helped write the fly tracking code. We thank Pedro Cisneros and Abhishek Sethi for their help writing scripts and annotating experimental videos. MD was supported by the Program in Physics, Engineering and Biology at Yale University. MD and TE were partially supported by the Allen Distinguished Investigator Program (grant 11562) through The Paul G Allen Frontiers Group. TE was partially supported by NIH R01GM106189. NK was supported by a postdoctoral fellowship through the Swartz Foundation and by postdoctoral fellowship NIH F32MH118700. HDA was supported by NSF DBI-1755494. DAC was supported by NIH R01EY026555, a Searle Scholar Award, a Sloan Fellowship in Neuroscience, and the Smith Family Foundation. This research was supported in part during a visit to KITP by NSF Grant No. PHY-1748958, NIH Grant No. R25GM067110, and the Gordon and Betty Moore Foundation Grant No. 2919.02</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Resources, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing, Statistical analysis and modeling</p></fn><fn fn-type="con" id="con3"><p>Software, Formal analysis, Visualization, H.A. performed the agent-based simulations and their analysis</p></fn><fn fn-type="con" id="con4"><p>Formal analysis, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-57524-transrepform-v1.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The data is be available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5061/dryad.4j0zpc87z">https://doi.org/10.5061/dryad.4j0zpc87z</ext-link> and the scripts used to perform the experiments, track flies, and extract relevant behavioral data and run simulations are available on <ext-link ext-link-type="uri" xlink:href="https://github.com/emonetlab/fly-walk">https://github.com/emonetlab/fly-walk</ext-link> (copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/browse/revision/6a9266effbdc305c2e6177a7b6786e295cb48a2c/">https://archive.softwareheritage.org/browse/revision/6a9266effbdc305c2e6177a7b6786e295cb48a2c/</ext-link>). These link are included in the text.</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Demir</surname><given-names>M</given-names></name><name><surname>Kadakia</surname><given-names>N</given-names></name><name><surname>Anderson</surname><given-names>HD</given-names></name><name><surname>Clark</surname><given-names>DA</given-names></name><name><surname>Emonet</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data from: Walking Drosophila navigate complex plumes using stochastic decisions biased by the timing of odor encounters</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.4j0zpc87z</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Álvarez-Salvado</surname> <given-names>E</given-names></name><name><surname>Licata</surname> <given-names>AM</given-names></name><name><surname>Connor</surname> <given-names>EG</given-names></name><name><surname>McHugh</surname> <given-names>MK</given-names></name><name><surname>King</surname> <given-names>BMN</given-names></name><name><surname>Stavropoulos</surname> <given-names>N</given-names></name><name><surname>Victor</surname> <given-names>JD</given-names></name><name><surname>Crimaldi</surname> <given-names>JP</given-names></name><name><surname>Nagel</surname> <given-names>KI</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Elementary sensory-motor transformations underlying olfactory navigation in walking fruit-flies</article-title><source>eLife</source><volume>7</volume><elocation-id>e37815</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.37815</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>TC</given-names></name><name><surname>Haynes</surname> <given-names>KF</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Field and laboratory electroantennographic measurements of pheromone plume structure correlated with oriental fruit moth behaviour</article-title><source>Physiological Entomology</source><volume>14</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1111/j.1365-3032.1989.tb00931.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>TC</given-names></name><name><surname>Vickers</surname> <given-names>NJ</given-names></name></person-group><year iso-8601-date="1997">1997</year><chapter-title>Pheromone-mediated flight in moths</chapter-title><person-group person-group-type="editor"><name><surname>Cardé</surname> <given-names>R. T</given-names></name><name><surname>Minks</surname> <given-names>A. K</given-names></name></person-group><source>Insect Pheromone Research</source><publisher-name>Springer</publisher-name><fpage>248</fpage><lpage>264</lpage><pub-id pub-id-type="doi">10.1007/978-1-4615-6371-6_23</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Balkovsky</surname> <given-names>E</given-names></name><name><surname>Shraiman</surname> <given-names>BI</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Olfactory search at high Reynolds number</article-title><source>PNAS</source><volume>99</volume><fpage>12589</fpage><lpage>12593</lpage><pub-id pub-id-type="doi">10.1073/pnas.192393499</pub-id><pub-id pub-id-type="pmid">12228727</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>JS</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Behavior reveals selective summation and max pooling among olfactory processing channels</article-title><source>Neuron</source><volume>91</volume><fpage>425</fpage><lpage>438</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.06.011</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bloomquist</surname> <given-names>BT</given-names></name><name><surname>Shortridge</surname> <given-names>RD</given-names></name><name><surname>Schneuwly</surname> <given-names>S</given-names></name><name><surname>Perdew</surname> <given-names>M</given-names></name><name><surname>Montell</surname> <given-names>C</given-names></name><name><surname>Steller</surname> <given-names>H</given-names></name><name><surname>Rubin</surname> <given-names>G</given-names></name><name><surname>Pak</surname> <given-names>WL</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Isolation of a putative phospholipase C gene of <italic>Drosophila</italic>, norpA, and its role in phototransduction</article-title><source>Cell</source><volume>54</volume><fpage>723</fpage><lpage>733</lpage><pub-id pub-id-type="doi">10.1016/S0092-8674(88)80017-5</pub-id><pub-id pub-id-type="pmid">2457447</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boie</surname> <given-names>SD</given-names></name><name><surname>Connor</surname> <given-names>EG</given-names></name><name><surname>McHugh</surname> <given-names>M</given-names></name><name><surname>Nagel</surname> <given-names>KI</given-names></name><name><surname>Ermentrout</surname> <given-names>GB</given-names></name><name><surname>Crimaldi</surname> <given-names>JP</given-names></name><name><surname>Victor</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Information-theoretic analysis of realistic odor plumes: what cues are useful for determining location?</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1006275</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006275</pub-id><pub-id pub-id-type="pmid">29990365</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borst</surname> <given-names>A</given-names></name><name><surname>Heisenberg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Osmotropotaxis in <italic>Drosophila melanogaster</italic></article-title><source>Journal of Comparative Physiology ? A</source><volume>147</volume><fpage>479</fpage><lpage>484</lpage><pub-id pub-id-type="doi">10.1007/BF00612013</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Budick</surname> <given-names>SA</given-names></name><name><surname>Reiser</surname> <given-names>MB</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The role of visual and mechanosensory cues in structuring forward flight in <italic>Drosophila melanogaster</italic></article-title><source>Journal of Experimental Biology</source><volume>210</volume><fpage>4092</fpage><lpage>4103</lpage><pub-id pub-id-type="doi">10.1242/jeb.006502</pub-id><pub-id pub-id-type="pmid">18025010</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Budick</surname> <given-names>SA</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Free-flight responses of <italic>Drosophila melanogaster</italic> to attractive odors</article-title><source>Journal of Experimental Biology</source><volume>209</volume><fpage>3001</fpage><lpage>3017</lpage><pub-id pub-id-type="doi">10.1242/jeb.02305</pub-id><pub-id pub-id-type="pmid">16857884</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buehlmann</surname> <given-names>C</given-names></name><name><surname>Graham</surname> <given-names>P</given-names></name><name><surname>Hansson</surname> <given-names>BS</given-names></name><name><surname>Knaden</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Desert ants use olfactory scenes for navigation</article-title><source>Animal Behaviour</source><volume>106</volume><fpage>99</fpage><lpage>105</lpage><pub-id pub-id-type="doi">10.1016/j.anbehav.2015.04.029</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calhoun</surname> <given-names>AJ</given-names></name><name><surname>Chalasani</surname> <given-names>SH</given-names></name><name><surname>Sharpee</surname> <given-names>TO</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Maximally informative foraging by <italic>Caenorhabditis elegans</italic></article-title><source>eLife</source><volume>3</volume><elocation-id>e04220</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.04220</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Carde</surname> <given-names>RT</given-names></name><name><surname>MafraNeto</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1997">1997</year><chapter-title>Mechanisms of flight of male moths to pheromone</chapter-title><person-group person-group-type="editor"><name><surname>Cardé</surname> <given-names>R. T</given-names></name><name><surname>Minks</surname> <given-names>A. K</given-names></name></person-group><source>Insect Pheromone Research</source><publisher-name>Springer</publisher-name><fpage>275</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1007/978-1-4615-6371-6_25</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cardé</surname> <given-names>RT</given-names></name><name><surname>Willis</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Navigational strategies used by insects to find distant, wind-borne sources of odor</article-title><source>Journal of Chemical Ecology</source><volume>34</volume><fpage>854</fpage><lpage>866</lpage><pub-id pub-id-type="doi">10.1007/s10886-008-9484-5</pub-id><pub-id pub-id-type="pmid">18581182</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Celani</surname> <given-names>A</given-names></name><name><surname>Villermaux</surname> <given-names>E</given-names></name><name><surname>Vergassola</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Odor landscapes in turbulent environments</article-title><source>Physical Review X</source><volume>4</volume><elocation-id>041015</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.4.041015</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crimaldi</surname> <given-names>JP</given-names></name><name><surname>Koseff</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>High-resolution measurements of the spatial and temporal scalar structure of a turbulent plume</article-title><source>Experiments in Fluids</source><volume>31</volume><fpage>90</fpage><lpage>102</lpage><pub-id pub-id-type="doi">10.1007/s003480000263</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DasGupta</surname> <given-names>S</given-names></name><name><surname>Ferreira</surname> <given-names>CH</given-names></name><name><surname>Miesenböck</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>FoxP influences the speed and accuracy of a perceptual decision in <italic>Drosophila</italic></article-title><source>Science</source><volume>344</volume><fpage>901</fpage><lpage>904</lpage><pub-id pub-id-type="doi">10.1126/science.1252114</pub-id><pub-id pub-id-type="pmid">24855268</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>David</surname> <given-names>CT</given-names></name><name><surname>Kennedy</surname> <given-names>JS</given-names></name><name><surname>Ludlow</surname> <given-names>AR</given-names></name><name><surname>Perry</surname> <given-names>JN</given-names></name><name><surname>Wall</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>A reappraisal of insect flight towards a distant point source of wind-borne odor</article-title><source>Journal of Chemical Ecology</source><volume>8</volume><fpage>1207</fpage><lpage>1215</lpage><pub-id pub-id-type="doi">10.1007/BF00990753</pub-id><pub-id pub-id-type="pmid">24413963</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flügge</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1934">1934</year><article-title>Geruchliche raumorientierung von <italic>Drosophila melanogaster</italic></article-title><source>Zeitschrift Für Vergleichende Physiologie</source><volume>20</volume><fpage>463</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1007/BF00339650</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gábor</surname> <given-names>A</given-names></name><name><surname>Banga</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Robust and efficient parameter estimation in dynamic models of biological systems</article-title><source>BMC Systems Biology</source><volume>9</volume><elocation-id>74</elocation-id><pub-id pub-id-type="doi">10.1186/s12918-015-0219-2</pub-id><pub-id pub-id-type="pmid">26515482</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname> <given-names>XJ</given-names></name><name><surname>Potter</surname> <given-names>CJ</given-names></name><name><surname>Gohl</surname> <given-names>DM</given-names></name><name><surname>Silies</surname> <given-names>M</given-names></name><name><surname>Katsov</surname> <given-names>AY</given-names></name><name><surname>Clandinin</surname> <given-names>TR</given-names></name><name><surname>Luo</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Specific kinematics and motor-related neurons for aversive chemotaxis in <italic>Drosophila</italic></article-title><source>Current Biology</source><volume>23</volume><fpage>1163</fpage><lpage>1172</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.05.008</pub-id><pub-id pub-id-type="pmid">23770185</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gaudry</surname> <given-names>Q</given-names></name><name><surname>Hong</surname> <given-names>EJ</given-names></name><name><surname>Kain</surname> <given-names>J</given-names></name><name><surname>de Bivort</surname> <given-names>BL</given-names></name><name><surname>Wilson</surname> <given-names>RI</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Asymmetric neurotransmitter release enables rapid odour lateralization in <italic>Drosophila</italic></article-title><source>Nature</source><volume>493</volume><fpage>424</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/nature11747</pub-id><pub-id pub-id-type="pmid">23263180</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gepner</surname> <given-names>R</given-names></name><name><surname>Mihovilovic Skanata</surname> <given-names>M</given-names></name><name><surname>Bernat</surname> <given-names>NM</given-names></name><name><surname>Kaplow</surname> <given-names>M</given-names></name><name><surname>Gershow</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Computations underlying <italic>Drosophila</italic> photo-taxis, odor-taxis, and multi-sensory integration</article-title><source>eLife</source><volume>4</volume><elocation-id>e06229</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06229</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geurten</surname> <given-names>BR</given-names></name><name><surname>Jähde</surname> <given-names>P</given-names></name><name><surname>Corthals</surname> <given-names>K</given-names></name><name><surname>Göpfert</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Saccadic body turns in walking <italic>Drosophila</italic></article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><elocation-id>365</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00365</pub-id><pub-id pub-id-type="pmid">25386124</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gire</surname> <given-names>DH</given-names></name><name><surname>Kapoor</surname> <given-names>V</given-names></name><name><surname>Arrighi-Allisan</surname> <given-names>A</given-names></name><name><surname>Seminara</surname> <given-names>A</given-names></name><name><surname>Murthy</surname> <given-names>VN</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mice develop efficient strategies for foraging and navigation using complex natural stimuli</article-title><source>Current Biology</source><volume>26</volume><fpage>1261</fpage><lpage>1273</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2016.03.040</pub-id><pub-id pub-id-type="pmid">27112299</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gomez-Marin</surname> <given-names>A</given-names></name><name><surname>Stephens</surname> <given-names>GJ</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Active sampling and decision making in <italic>Drosophila</italic> chemotaxis</article-title><source>Nature Communications</source><volume>2</volume><elocation-id>441</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms1455</pub-id><pub-id pub-id-type="pmid">21863008</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorur-Shandilya</surname> <given-names>S</given-names></name><name><surname>Demir</surname> <given-names>M</given-names></name><name><surname>Long</surname> <given-names>J</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name><name><surname>Emonet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Olfactory receptor neurons use gain control and complementary kinetics to encode intermittent odorant stimuli</article-title><source>eLife</source><volume>6</volume><elocation-id>e27670</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.27670</pub-id><pub-id pub-id-type="pmid">28653907</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haynes</surname> <given-names>KF</given-names></name><name><surname>Baker</surname> <given-names>TC</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>An analysis of anemotactic flight in female moths stimulated by host odour and comparison with the males' response to sex pheromone</article-title><source>Physiological Entomology</source><volume>14</volume><fpage>279</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1111/j.1365-3032.1989.tb01095.x</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hernandez-Nunez</surname> <given-names>L</given-names></name><name><surname>Belina</surname> <given-names>J</given-names></name><name><surname>Klein</surname> <given-names>M</given-names></name><name><surname>Si</surname> <given-names>G</given-names></name><name><surname>Claus</surname> <given-names>L</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name><name><surname>Samuel</surname> <given-names>ADT</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Reverse-correlation analysis of navigation dynamics in <italic>Drosophila</italic> larva using optogenetics</article-title><source>eLife</source><volume>4</volume><elocation-id>e06225</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06225</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname> <given-names>JCR</given-names></name><name><surname>Abell</surname> <given-names>CJ</given-names></name><name><surname>Peterka</surname> <given-names>JA</given-names></name><name><surname>Woo</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Kinematical studies of the flows around free or surface-mounted obstacles; applying topology to flow visualization</article-title><source>Journal of Fluid Mechanics</source><volume>86</volume><fpage>179</fpage><lpage>200</lpage><pub-id pub-id-type="doi">10.1017/S0022112078001068</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname> <given-names>WD</given-names></name><name><surname>Cayirlioglu</surname> <given-names>P</given-names></name><name><surname>Kadow</surname> <given-names>IG</given-names></name><name><surname>Vosshall</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Two chemosensory receptors together mediate carbon dioxide detection in <italic>Drosophila</italic></article-title><source>Nature</source><volume>445</volume><fpage>86</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1038/nature05466</pub-id><pub-id pub-id-type="pmid">17167414</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname> <given-names>SH</given-names></name><name><surname>Hueston</surname> <given-names>C</given-names></name><name><surname>Bhandawat</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Odor-identity dependent motor programs underlie behavioral responses to odors</article-title><source>eLife</source><volume>4</volume><elocation-id>e11092</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.11092</pub-id><pub-id pub-id-type="pmid">26439011</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kadakia</surname> <given-names>N</given-names></name><name><surname>Armstrong</surname> <given-names>E</given-names></name><name><surname>Breen</surname> <given-names>D</given-names></name><name><surname>Morone</surname> <given-names>U</given-names></name><name><surname>Daou</surname> <given-names>A</given-names></name><name><surname>Margoliash</surname> <given-names>D</given-names></name><name><surname>Abarbanel</surname> <given-names>HD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Nonlinear statistical data assimilation for HVC[Formula: see text] neurons in the avian song system</article-title><source>Biological Cybernetics</source><volume>110</volume><fpage>417</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1007/s00422-016-0697-3</pub-id><pub-id pub-id-type="pmid">27688218</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanzaki</surname> <given-names>R</given-names></name><name><surname>Sugi</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Self-generated zigzag turning of Bombyx mori males during pheromone-mediated upwind walking</article-title><source>Zoological Science</source><volume>9</volume><fpage>515</fpage><lpage>527</lpage></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname> <given-names>JS</given-names></name><name><surname>Marsh</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Pheromone-regulated anemotaxis in flying moths</article-title><source>Science</source><volume>184</volume><fpage>999</fpage><lpage>1001</lpage><pub-id pub-id-type="doi">10.1126/science.184.4140.999</pub-id><pub-id pub-id-type="pmid">4826172</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuenen</surname> <given-names>LPS</given-names></name><name><surname>Carde</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Strategies for recontacting a lost pheromone plume: casting and upwind flight in the male gypsy moth</article-title><source>Physiological Entomology</source><volume>19</volume><fpage>15</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1111/j.1365-3032.1994.tb01069.x</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larsson</surname> <given-names>MC</given-names></name><name><surname>Domingos</surname> <given-names>AI</given-names></name><name><surname>Jones</surname> <given-names>WD</given-names></name><name><surname>Chiappe</surname> <given-names>ME</given-names></name><name><surname>Amrein</surname> <given-names>H</given-names></name><name><surname>Vosshall</surname> <given-names>LB</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Or83b encodes a broadly expressed odorant receptor essential for <italic>Drosophila</italic> olfaction</article-title><source>Neuron</source><volume>43</volume><fpage>703</fpage><lpage>714</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.08.019</pub-id><pub-id pub-id-type="pmid">15339651</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mafra-Neto</surname> <given-names>A</given-names></name><name><surname>Cardé</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Fine-scale structure of pheromone plumes modulates upwind orientation of flying moths</article-title><source>Nature</source><volume>369</volume><fpage>142</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1038/369142a0</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname> <given-names>PA</given-names></name><name><surname>Weissburg</surname> <given-names>MJ</given-names></name><name><surname>Parrish</surname> <given-names>JM</given-names></name><name><surname>Zimmer-Faust</surname> <given-names>RK</given-names></name><name><surname>Gerhardt</surname> <given-names>GA</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Spatial distribution of odors in simulated benthic boundary layer flows</article-title><source>Journal of Chemical Ecology</source><volume>20</volume><fpage>255</fpage><lpage>279</lpage><pub-id pub-id-type="doi">10.1007/BF02064435</pub-id><pub-id pub-id-type="pmid">24242052</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murlis</surname> <given-names>J</given-names></name><name><surname>Elkinton</surname> <given-names>JS</given-names></name><name><surname>Cardé</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Odor plumes and how insects use them</article-title><source>Annual Review of Entomology</source><volume>37</volume><fpage>505</fpage><lpage>532</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.37.010192.002445</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Murlis</surname> <given-names>J</given-names></name><name><surname>Willis</surname> <given-names>MA</given-names></name><name><surname>Carde</surname> <given-names>RT</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Spatial and temporal structures of pheromone plumes in fields and forests</article-title><source>Physiological Entomology</source><volume>25</volume><fpage>211</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1046/j.1365-3032.2000.00176.x</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pang</surname> <given-names>R</given-names></name><name><surname>van Breugel</surname> <given-names>F</given-names></name><name><surname>Dickinson</surname> <given-names>M</given-names></name><name><surname>Riffell</surname> <given-names>JA</given-names></name><name><surname>Fairhall</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>History dependence in insect flight decisions during odor tracking</article-title><source>PLOS Computational Biology</source><volume>14</volume><elocation-id>e1005969</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005969</pub-id><pub-id pub-id-type="pmid">29432454</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname> <given-names>IJ</given-names></name><name><surname>Hein</surname> <given-names>AM</given-names></name><name><surname>Bobkov</surname> <given-names>YV</given-names></name><name><surname>Reidenbach</surname> <given-names>MA</given-names></name><name><surname>Ache</surname> <given-names>BW</given-names></name><name><surname>Principe</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neurally encoding time for olfactory navigation</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004682</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004682</pub-id><pub-id pub-id-type="pmid">26730727</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramdya</surname> <given-names>P</given-names></name><name><surname>Lichocki</surname> <given-names>P</given-names></name><name><surname>Cruchet</surname> <given-names>S</given-names></name><name><surname>Frisch</surname> <given-names>L</given-names></name><name><surname>Tse</surname> <given-names>W</given-names></name><name><surname>Floreano</surname> <given-names>D</given-names></name><name><surname>Benton</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Mechanosensory interactions drive collective behaviour in <italic>Drosophila</italic></article-title><source>Nature</source><volume>519</volume><fpage>233</fpage><lpage>236</lpage><pub-id pub-id-type="doi">10.1038/nature14024</pub-id><pub-id pub-id-type="pmid">25533959</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riffell</surname> <given-names>JA</given-names></name><name><surname>Abrell</surname> <given-names>L</given-names></name><name><surname>Hildebrand</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Physical processes and real-time chemical measurement of the insect olfactory environment</article-title><source>Journal of Chemical Ecology</source><volume>34</volume><fpage>837</fpage><lpage>853</lpage><pub-id pub-id-type="doi">10.1007/s10886-008-9490-7</pub-id><pub-id pub-id-type="pmid">18548311</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schaefer</surname> <given-names>AT</given-names></name><name><surname>Margrie</surname> <given-names>TW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Spatiotemporal representations in the olfactory system</article-title><source>Trends in Neurosciences</source><volume>30</volume><fpage>92</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2007.01.001</pub-id><pub-id pub-id-type="pmid">17224191</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schlichting</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1960">1960</year><source>Boundary Layer Theory</source><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulze</surname> <given-names>A</given-names></name><name><surname>Gomez-Marin</surname> <given-names>A</given-names></name><name><surname>Rajendran</surname> <given-names>VG</given-names></name><name><surname>Lott</surname> <given-names>G</given-names></name><name><surname>Musy</surname> <given-names>M</given-names></name><name><surname>Ahammad</surname> <given-names>P</given-names></name><name><surname>Deogade</surname> <given-names>A</given-names></name><name><surname>Sharpe</surname> <given-names>J</given-names></name><name><surname>Riedl</surname> <given-names>J</given-names></name><name><surname>Jarriault</surname> <given-names>D</given-names></name><name><surname>Trautman</surname> <given-names>ET</given-names></name><name><surname>Werner</surname> <given-names>C</given-names></name><name><surname>Venkadesan</surname> <given-names>M</given-names></name><name><surname>Druckmann</surname> <given-names>S</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dynamical feature extraction at the sensory periphery guides chemotaxis</article-title><source>eLife</source><volume>4</volume><elocation-id>e06694</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06694</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shusterman</surname> <given-names>R</given-names></name><name><surname>Smear</surname> <given-names>MC</given-names></name><name><surname>Koulakov</surname> <given-names>AA</given-names></name><name><surname>Rinberg</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Precise olfactory responses tile the sniff cycle</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>1039</fpage><lpage>1044</lpage><pub-id pub-id-type="doi">10.1038/nn.2877</pub-id><pub-id pub-id-type="pmid">21765422</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smear</surname> <given-names>M</given-names></name><name><surname>Shusterman</surname> <given-names>R</given-names></name><name><surname>O'Connor</surname> <given-names>R</given-names></name><name><surname>Bozza</surname> <given-names>T</given-names></name><name><surname>Rinberg</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Perception of sniff phase in mouse olfaction</article-title><source>Nature</source><volume>479</volume><fpage>397</fpage><lpage>400</lpage><pub-id pub-id-type="doi">10.1038/nature10521</pub-id><pub-id pub-id-type="pmid">21993623</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steck</surname> <given-names>K</given-names></name><name><surname>Veit</surname> <given-names>D</given-names></name><name><surname>Grandy</surname> <given-names>R</given-names></name><name><surname>Badia</surname> <given-names>SB</given-names></name><name><surname>Badia</surname> <given-names>SB</given-names></name><name><surname>Mathews</surname> <given-names>Z</given-names></name><name><surname>Verschure</surname> <given-names>P</given-names></name><name><surname>Hansson</surname> <given-names>BS</given-names></name><name><surname>Knaden</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A high-throughput behavioral paradigm for <italic>Drosophila</italic> olfaction - The flywalk</article-title><source>Scientific Reports</source><volume>2</volume><elocation-id>361</elocation-id><pub-id pub-id-type="doi">10.1038/srep00361</pub-id><pub-id pub-id-type="pmid">22511996</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname> <given-names>CY</given-names></name><name><surname>Menuz</surname> <given-names>K</given-names></name><name><surname>Reisert</surname> <given-names>J</given-names></name><name><surname>Carlson</surname> <given-names>JR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Non-synaptic inhibition between grouped neurons in an olfactory circuit</article-title><source>Nature</source><volume>492</volume><fpage>66</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1038/nature11712</pub-id><pub-id pub-id-type="pmid">23172146</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suh</surname> <given-names>GS</given-names></name><name><surname>Wong</surname> <given-names>AM</given-names></name><name><surname>Hergarden</surname> <given-names>AC</given-names></name><name><surname>Wang</surname> <given-names>JW</given-names></name><name><surname>Simon</surname> <given-names>AF</given-names></name><name><surname>Benzer</surname> <given-names>S</given-names></name><name><surname>Axel</surname> <given-names>R</given-names></name><name><surname>Anderson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>A single population of olfactory sensory neurons mediates an innate avoidance behaviour in <italic>Drosophila</italic></article-title><source>Nature</source><volume>431</volume><fpage>854</fpage><lpage>859</lpage><pub-id pub-id-type="doi">10.1038/nature02980</pub-id><pub-id pub-id-type="pmid">15372051</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szyszka</surname> <given-names>P</given-names></name><name><surname>Gerkin</surname> <given-names>RC</given-names></name><name><surname>Galizia</surname> <given-names>CG</given-names></name><name><surname>Smith</surname> <given-names>BH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>High-speed odor transduction and pulse tracking by insect olfactory receptor neurons</article-title><source>PNAS</source><volume>111</volume><fpage>16925</fpage><lpage>16930</lpage><pub-id pub-id-type="doi">10.1073/pnas.1412051111</pub-id><pub-id pub-id-type="pmid">25385618</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tao</surname> <given-names>L</given-names></name><name><surname>Ozarkar</surname> <given-names>S</given-names></name><name><surname>Beck</surname> <given-names>JM</given-names></name><name><surname>Bhandawat</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Statistical structure of locomotion and its modulation by odors</article-title><source>eLife</source><volume>8</volume><elocation-id>e41235</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.41235</pub-id><pub-id pub-id-type="pmid">30620334</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tastekin</surname> <given-names>I</given-names></name><name><surname>Khandelwal</surname> <given-names>A</given-names></name><name><surname>Tadres</surname> <given-names>D</given-names></name><name><surname>Fessner</surname> <given-names>ND</given-names></name><name><surname>Truman</surname> <given-names>JW</given-names></name><name><surname>Zlatic</surname> <given-names>M</given-names></name><name><surname>Cardona</surname> <given-names>A</given-names></name><name><surname>Louis</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Sensorimotor pathway controlling stopping behavior during chemotaxis in the <italic>Drosophila melanogaster</italic> larva</article-title><source>eLife</source><volume>7</volume><elocation-id>e38740</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.38740</pub-id><pub-id pub-id-type="pmid">30465650</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Breugel</surname> <given-names>F</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Plume-tracking behavior of flying <italic>Drosophila</italic> emerges from a set of distinct sensory-motor reflexes</article-title><source>Current Biology</source><volume>24</volume><fpage>274</fpage><lpage>286</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2013.12.023</pub-id><pub-id pub-id-type="pmid">24440395</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vergassola</surname> <given-names>M</given-names></name><name><surname>Villermaux</surname> <given-names>E</given-names></name><name><surname>Shraiman</surname> <given-names>BI</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>'Infotaxis' as a strategy for searching without gradients</article-title><source>Nature</source><volume>445</volume><fpage>406</fpage><lpage>409</lpage><pub-id pub-id-type="doi">10.1038/nature05464</pub-id><pub-id pub-id-type="pmid">17251974</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vickers</surname> <given-names>NJ</given-names></name><name><surname>Baker</surname> <given-names>TC</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Reiterative responses to single strands of odor promote sustained upwind flight and odor source location by moths</article-title><source>PNAS</source><volume>91</volume><fpage>5756</fpage><lpage>5760</lpage><pub-id pub-id-type="doi">10.1073/pnas.91.13.5756</pub-id><pub-id pub-id-type="pmid">11607476</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webster</surname> <given-names>DR</given-names></name><name><surname>Weissburg</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Chemosensory guidance cues in a turbulent chemical odor plume</article-title><source>Limnology and Oceanography</source><volume>46</volume><fpage>1034</fpage><lpage>1047</lpage><pub-id pub-id-type="doi">10.4319/lo.2001.46.5.1034</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ye</surname> <given-names>J</given-names></name><name><surname>Rey</surname> <given-names>D</given-names></name><name><surname>Kadakia</surname> <given-names>N</given-names></name><name><surname>Eldridge</surname> <given-names>M</given-names></name><name><surname>Morone</surname> <given-names>UI</given-names></name><name><surname>Rozdeba</surname> <given-names>P</given-names></name><name><surname>Abarbanel</surname> <given-names>HDI</given-names></name><name><surname>Quinn</surname> <given-names>JC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Systematic variational method for statistical nonlinear state and parameter estimation</article-title><source>Physical Review E</source><volume>92</volume><elocation-id>052901</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.92.052901</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yee</surname> <given-names>E</given-names></name><name><surname>Kosteniuk</surname> <given-names>PR</given-names></name><name><surname>Chandler</surname> <given-names>GM</given-names></name><name><surname>Biltoft</surname> <given-names>CA</given-names></name><name><surname>Bowers</surname> <given-names>JF</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Statistical characteristics of concentration fluctuations in dispersing plumes in the atmospheric surface layer</article-title><source>Boundary-Layer Meteorology</source><volume>65</volume><fpage>69</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1007/BF00708819</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yorozu</surname> <given-names>S</given-names></name><name><surname>Wong</surname> <given-names>A</given-names></name><name><surname>Fischer</surname> <given-names>BJ</given-names></name><name><surname>Dankert</surname> <given-names>H</given-names></name><name><surname>Kernan</surname> <given-names>MJ</given-names></name><name><surname>Kamikouchi</surname> <given-names>A</given-names></name><name><surname>Ito</surname> <given-names>K</given-names></name><name><surname>Anderson</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Distinct sensory representations of wind and near-field sound in the <italic>Drosophila</italic> brain</article-title><source>Nature</source><volume>458</volume><fpage>201</fpage><lpage>205</lpage><pub-id pub-id-type="doi">10.1038/nature07843</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57524.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Seminara</surname><given-names>Agnese</given-names></name><role>Reviewing Editor</role><aff><institution>Université Côte d'Azur</institution><country>France</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Murthy</surname><given-names>Venkatesh N</given-names></name><role>Reviewer</role><aff><institution>Harvard University</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Celani</surname><given-names>Antonio</given-names> </name><role>Reviewer</role><aff><institution>ICTP</institution><country>Italy</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>In this manuscript, the authors present the first dataset that simultaneously monitors behavior and odor in real time for freely walking flies navigating toward an intermittent odor. Flies were visualised as they navigated toward the source of a turbulent plume of smoke, that the flies were naturally attracted to. A quantitative statistical analysis of behavior in relation to odor unveiled novel algorithms underlying navigation toward intermittent odor cues.</p><p>These results pave the way for further research on the neural and computational basis of olfactory navigation strategies in the fly and introduce an attractive odor that can be imaged simultaneously with behavior, with impact for a broad swathe of the scientific community.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Walking <italic>Drosophila</italic> navigate complex plumes using stochastic decisions biased by the timing of odor encounters&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Ronald Calabrese as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Venkatesh N Murthy (Reviewer #2); Antonio Celani (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>Summary:</p><p>In this manuscript, the authors present the first dataset that simultaneously monitors behavior and odor in real time for freely walking flies navigating toward an intermittent odor. Flies were visualised as they navigated toward the source of a turbulent plume of smoke, that the flies were naturally attracted to. Intermittency was quantified by visualisation of the smoke in real time while following the animals. A quantitative statistical analysis of behavior in relation to odor unveiled novel algorithms underlying navigation toward intermittent odor cues. Turning and stopping was a semi-random process whereas anemotactic responses depended on odor encounter. The authors tested mutants to ensure that behavior was driven by olfaction.</p><p>These results pave the way for further research on the neural and the computational basis of olfactory navigation strategies in the fly and introduce an attractive odor that can be imaged simultaneously with behavior, with impact for a broad swathe of the scientific community.</p><p>Essential revisions:</p><p>A) Because smoke is a complex signal, the behavior it elicits may be caused by a combination of effects caused by the single compounds contained in the plume, including potential repellents (e.g. CO and toluene are toxic at high concentration). Hence aspects of this behavior may be odor-dependent, and not be generally applicable to other odors. The authors should make this caveat clear to the audience, and we expect this will stimulate further work.</p><p>B) The distribution for the simulated fly (Figure 7C) is quite different from the one of true flies. One notable feature is that the simulated agent's distribution is less &quot;peaky&quot; along the y axis (compare with Figure 1K). True flies, it would seem, remain closer to the central axis than simulated ones. Perhaps a couple of slight changes in the model could influence/improve the fit:</p><p>• From Figure 4D, it seems like turn angle distribution could be tetra-modal, with an encounter independent part centered on 50 and an encounter-dependent part centered on 25. Could a model with this added level of granularity improve the fits to behavior? It would make odor driven changes in direction sharper and potentially improve tracking.</p><p>• The generating function for P(upwind|turn) is not very satisfactory. It is a linear fit offset by 0.5 and truncated at 1. Why did the authors not use a standard choice model with a bias term and inverse temperature controlling the slope? This could potentially handle better the extreme of the encounter frequency axis which are those that have the worst fit with the current model (Figure 4G).</p><p>C) We expect the combined behavior-odor dataset to prove extremely valuable for further research, is it possible to make it publicly available?</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.57524.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>A) Because smoke is a complex signal, the behavior it elicits may be caused by a combination of effects caused by the single compounds contained in the plume, including potential repellents (e.g. CO and toluene are toxic at high concentration). Hence aspects of this behavior may be odor-dependent, and not be generally applicable to other odors. The authors should make this caveat clear to the audience, and we expect this will stimulate further work.</p></disp-quote><p>To address this point, we added the following paragraph at the end of the Discussion: “Our visualizable signal is conventional smoke, a complex odor consisting of various aromatic compounds (Figure 1—figure supplement 1A). […] Moreover, <italic>Orco<sup>-/-</sup></italic> flies that lack major olfactory input, but are intact in CO<sub>2</sub> sensing, showed mild aversion around the center of the straight smoke plume, illustrating how different components contribute to the perception of the odor mixture.”</p><disp-quote content-type="editor-comment"><p>B) The distribution for the simulated fly (Figure 7C) is quite different from the one of true flies. One notable feature is that the simulated agent's distribution is less &quot;peaky&quot; along the y axis (compare with Figure 1K). True flies, it would seem, remain closer to the central axis than simulated ones. Perhaps a couple of slight changes in the model could influence/improve the fit:</p><p>• From Figure 4D, it seems like turn angle distribution could be tetra-modal, with an encounter independent part centered on 50 and an encounter-dependent part centered on 25. Could a model with this added level of granularity improve the fits to behavior? It would make odor driven changes in direction sharper and potentially improve tracking.</p><p>• The generating function for P(upwind|turn) is not very satisfactory. It is a linear fit offset by 0.5 and truncated at 1. Why did the authors not use a standard choice model with a bias term and inverse temperature controlling the slope? This could potentially handle better the extreme of the encounter frequency axis which are those that have the worst fit with the current model (Figure 4G).</p></disp-quote><p>Regarding the first suggestion, to test the multimodality of the turning distribution (Figure 4D), we used a slight variation of our turning model, in which we set the turn angle at 25<sup>o</sup> for encounter frequencies of 4Hz or higher and to 40<sup>o</sup> for encounter frequencies of 0 Hz, linearly interpolating between these. We did not find any significant changes in the fit of the model to the turning bias (Figure 4G). We therefore retained the turn angle distributions used in the original version (Gaussians with a mean of 30<sup>o</sup> and deviation of 10<sup>o</sup>).</p><p>Regarding the second suggestion, we initially opted for a truncated linear model since it requires only a single parameter (assuming that the bias is 50% at an encounter frequency of 0 Hz), while a sigmoidal-type model would require 2 parameters (half-max and spread). However, it is true that the latter can similarly be reduced to a single-parameter model if we assume that the half-max is fixed to 0 Hz. This assumption is consistent with our observation that there is no turning bias for low encounter frequencies (Figure 4D). Given this assumption, we used a sigmoidal model and estimated the parameters as before, finding a spread (i.e. inverse temperature) of 0.242 Hz<sup>-1</sup>. Comfortingly, the parameters are fairly well localized, indicating robustness as in our linear model (new Figure 4F), and the response functions for the two models are quite similar in the 0-3Hz regime, suggesting that the sigmoidal model is largely consistent with the linear model. Further, the fits are indeed improved at the extrema, as predicted by the reviewer (new Figure 4G). Since this sigmoidal relationship has a natural asymptotic behavior at high frequency, we have replaced our truncated linear model with the sigmoidal model, updating the main text, figure, legend, and Materials and methods accordingly.</p><p>We have incorporated this updated turning model in our agent-based simulation (Figure 7C). We note that in comparing the pdfs of real and virtual flies (Figures 1K and 7C, respectively), the front end of the plume, near the lateral perturbing jets that create intermittency, the plume is not composed of odor packets but is instead a meandering ribbon. We have observed that flies zigzag around this ribbon-like region much like they do in the static ribbon (Figure 1—figure supplement 1B). Furthermore, upon reaching the source region near the odor inlet, flies aggregate around and revisit this region. Our simulations do not include these boundary-like effects, as this would require further assumptions on their behavior when hitting the arena boundaries. As such, we have removed the front 20 mm of the arena from the marginals. In combination, both the updated turning model and this slight modification in our definition of the marginals brings the virtual and real flies into more agreement (updated Figure 7C). We have noted this in the caption of Figure 7. Finally, we note that one difference between the real and virtual flies is that the former are initialized at random positions throughout the arena (once being aspirated into the device), while the latter are initialized uniformly at the back end of the arena (Materials and methods) to make the simulations more straightforward to interpret. This produces further differences between the pdfs for real and virtual flies.</p><disp-quote content-type="editor-comment"><p>C) We expect the combined behavior-odor dataset to prove extremely valuable for further research, is it possible to make it publicly available?</p></disp-quote><p>We have the uploaded the combined behavior-odor dataset on Dryad for anyone to download. A link is included in the paper.</p></body></sub-article></article>