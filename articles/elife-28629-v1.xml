<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">28629</article-id><article-id pub-id-type="doi">10.7554/eLife.28629</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Inferring genetic interactions from comparative fitness data</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-86268"><name><surname>Crona</surname><given-names>Kristina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-1819-474X</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-88137"><name><surname>Gavryushkin</surname><given-names>Alex</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6299-8249</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-88136"><name><surname>Greene</surname><given-names>Devin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4889-9225</contrib-id><email>deving@american.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-35681"><name><surname>Beerenwinkel</surname><given-names>Niko</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0573-6119</contrib-id><email>niko.beerenwinkel@bsse.ethz.ch</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Mathematics and Statistics</institution><institution>American University</institution><addr-line><named-content content-type="city">Washington, DC</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Biosystems Science and Engineering</institution><institution>ETH Zurich</institution><addr-line><named-content content-type="city">Basel</named-content></addr-line><country>Switzerland</country></aff><aff id="aff3"><label>3</label><institution>SIB Swiss Institute of Bioinformatics</institution><addr-line><named-content content-type="city">Basel</named-content></addr-line><country>Switzerland</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor" id="author-6442"><name><surname>Weinreich</surname><given-names>Dan</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>20</day><month>12</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e28629</elocation-id><history><date date-type="received" iso-8601-date="2017-05-15"><day>15</day><month>05</month><year>2017</year></date><date date-type="accepted" iso-8601-date="2017-11-21"><day>21</day><month>11</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Crona et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Crona et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-28629-v1.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.28629.001</object-id><p>Darwinian fitness is a central concept in evolutionary biology. In practice, however, it is hardly possible to measure fitness for all genotypes in a natural population. Here, we present quantitative tools to make inferences about epistatic gene interactions when the fitness landscape is only incompletely determined due to imprecise measurements or missing observations. We demonstrate that genetic interactions can often be inferred from fitness rank orders, where all genotypes are ordered according to fitness, and even from partial fitness orders. We provide a complete characterization of rank orders that imply higher order epistasis. Our theory applies to all common types of gene interactions and facilitates comprehensive investigations of diverse genetic interactions. We analyzed various genetic systems comprising HIV-1, the malaria-causing parasite <italic>Plasmodium vivax</italic>, the fungus <italic>Aspergillus niger</italic>, and the TEM-family of <inline-formula><mml:math id="inf1"><mml:mi>β</mml:mi></mml:math></inline-formula>-lactamase associated with antibiotic resistance. For all systems, our approach revealed higher order interactions among mutations.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>fitness landscape</kwd><kwd>epistasis</kwd><kwd>gene interactions</kwd><kwd>fitness graph</kwd><kwd>rank order</kwd><kwd>partial order</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><funding-statement>No external funding was received for this work</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A new mathematical approach can infer higher order genetic interactions from pairwise fitness comparisons between genotypes.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>The fitness of an individual with a particular genotype is a measure of its expected contribution to the next generation of the population. The collection of all fitness values for all genotypes, referred to as the fitness landscape, is a central concept in evolutionary biology (<xref ref-type="bibr" rid="bib49">Wright, 1932</xref>; <xref ref-type="bibr" rid="bib29">Orr, 2009</xref>). The fitness landscape can have a strong impact on the fate of the evolving population, such as, for example, the risk of a pathogen population to develop drug resistance and to survive under drug treatment (<xref ref-type="bibr" rid="bib10">de Visser and Krug, 2014</xref>).</p><p>Genetic interactions, or epistasis, are abundant in nature. They can have many causes and occur at various scales, for instance, among mutations of a protein-coding sequence or between sequences coding for different genes. Unless there are genetic interactions, we assume that fitness is additive, that is, the fitness effects of individual mutations sum. An additive fitness landscape is determined by the wild-type and single-mutant fitness values.</p><p>If the fitness landscape is determined by the wild-type, single-mutant, and double-mutant fitness values, then we say that it has no higher order epistasis. Intuitively, higher order epistasis means that the fitness of a multiple mutant is unexpected given the fitness of the wild type and all single and double mutants. For example, <xref ref-type="bibr" rid="bib46">Weinreich et al. (2006)</xref> showed that five mutations jointly increase antibiotic resistance considerably more than expected.</p><p>Measuring fitness experimentally is challenging. Fitness measurements tend to come with high uncertainty and they are often obtained only for a subset of genotypes. Moreover, fitness can sometimes not be measured directly at all. Instead, phenotypes are considered that can be measured and are believed to approximate fitness well. For instance, antimicrobial drug resistance is the dominating survival factor for a bacterial population under drug exposure, so that the degree of resistance is a good substitute measure of fitness. Several such fitness proxies are used in microbiology, including survival as measured by disc diffusion tests. Although it is possible to study epistasis of the proxy data, in general, presence or absence of epistasis in the proxy landscape does not imply presence or absence of epistasis in the fitness landscape itself.</p><p>Experimentally, epistatic interactions have been measured in several genetic systems, including <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib20">Khan et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib30">Poelwijk et al., 2007</xref>), HIV-1 (<xref ref-type="bibr" rid="bib9">da Silva et al., 2010</xref>; <xref ref-type="bibr" rid="bib38">Segal et al., 2004</xref>), and other viruses (<xref ref-type="bibr" rid="bib51">Wylie and Shakhnovich, 2011</xref>; <xref ref-type="bibr" rid="bib37">Sanjuán, 2010</xref>). These and similar studies involve the analysis of standing genetic variation or spontaneous mutations (<xref ref-type="bibr" rid="bib3">Bonhoeffer et al., 2004</xref>; <xref ref-type="bibr" rid="bib2">Bershtein et al., 2006</xref>), engineered site-directed mutations (<xref ref-type="bibr" rid="bib36">Sanjuán et al., 2004</xref>; <xref ref-type="bibr" rid="bib46">Weinreich et al., 2006</xref>), and combinations of both (<xref ref-type="bibr" rid="bib35">Sanjuán et al., 2005</xref>; <xref ref-type="bibr" rid="bib32">Poon and Chao, 2006</xref>). Competition experiments are also frequently employed to learn mutational fitness effects. For example, <xref ref-type="bibr" rid="bib36">Sanjuán et al. (2004)</xref> studied the distribution of deleterious mutational effects in RNA viruses using this approach. Such experiments are typically run on single-nucleotide substitution mutants produced by site-directed mutagenesis. The data produced in competition experiments is informative about pairwise comparisons of genotypes with respect to their fitness. However, little is known about whether or not it is possible to learn higher order genetic interactions from such fitness comparison data.</p><p>Due to the rapid growth of the number of possible interactions with the number of loci, all interactions can exhaustively be studied only for a small number of loci. At the human genome scale, for example, a complete study of only pairwise gene interactions would already require hundreds of millions of experiments. On the other hand, for smaller organisms, such as yeast, all pairwise and several three-way gene interactions have been measured experimentally (<xref ref-type="bibr" rid="bib4">Costanzo et al., 2010</xref>). Only when restricting to a small set of preselected loci, can one assess all combinations of mutations and hence all epistatic interactions. This approach has been pursued, for example, by <xref ref-type="bibr" rid="bib46">Weinreich et al. (2006)</xref> for a five-locus system associated with bacterial drug resistance.</p><p>Historically, the study of genetic interactions was mostly restricted to pairwise epistasis. According to <xref ref-type="bibr" rid="bib8">Crow and Kimura, 1970</xref> (p. 224) higher order interactions were generally believed not to be significant in nature, with references to Fisher, Haldane, and Wright. More recent arguments for the same view have been stated in the context of protein folding (<xref ref-type="bibr" rid="bib16">Gupta and Adami, 2016</xref>). On the other hand, empirical findings suggest that the opposite is true for many other systems (<xref ref-type="bibr" rid="bib43">Szendro et al., 2013</xref>; <xref ref-type="bibr" rid="bib25">Neidhart et al., 2013</xref>; <xref ref-type="bibr" rid="bib33">Sailer and Harms, 2017a</xref>). For example, <xref ref-type="bibr" rid="bib47">Weinreich et al. (2013)</xref> argue that three-way and four-way interactions can be as strong as pairwise epistasis referring to various empirical fitness studies, and <xref ref-type="bibr" rid="bib21">Knies et al. (2017)</xref> find many epistatic interactions in a numerically near-additive fitness landscape, reducing dramatically the number of accessible evolutionary trajectories. Although the significance of higher order interactions may vary between systems, the topic has not been thoroughly investigated. This is partly due to lack of adequate methodology to quantitatively assess the interactions underlying an observed empirical fitness landscape. Improved mathematical and statistical tools for detecting higher order interactions, as well as more empirical results, are necessary for more conclusive answers regarding the importance of higher order interactions.</p><p>In this paper, we consider fitness data that comes in the form of pairwise comparisons. Such data are frequent in practice and can arise in different ways. First, some assays rely on comparing the fitness of two genotypes, for example, by letting them grow in direct competition. Each competition experiment is informative about which of the two genotypes has higher fitness, without estimating the fitness values themselves. Second, direct but uncertain fitness measurements are also often summarized as pairwise fitness relations by recording only whether two genotypes displayed significantly different fitness values or not. Third, rather than fitness itself, a fitness proxy, that is, a phenotype closely related to fitness, may be considered. Fitness proxies cannot be used directly to measure epistasis, because they generally do not preserve fitness linearity (<xref ref-type="bibr" rid="bib12">Gong et al., 2013</xref>), but if proxy data preserves pairwise comparisons, they may be used instead. Lists of mutants found in a new environment, such as, for example, a new host for a pathogen or a drug environment can be utilized similarly. Assuming that the capability to transition to and survive in the new environment is an indication of higher fitness, this type of observational data also provides pairwise fitness comparisons. Similarly, the population frequency of genotypes can sometimes be used to draw conclusions about fitness. For example, by employing a specific model of viral evolution, fitness was inferred computationally from deep sequencing data of an HIV-1 population, and pairwise credible fitness differences were reported (<xref ref-type="bibr" rid="bib39">Seifert et al., 2015</xref>).</p><p>Irrespective of how they were obtained, any consistent set of pairwise fitness relations can be regarded as a partial order of the genotypes with respect to fitness. Two specific types of partial orders play important roles for fitness landscapes. First, if comparisons are available for all pairs of genotypes, then the partial order is a total order, or rank order. In this case, all genotypes are ordered according to fitness. Second, several studies compare fitness only between mutational neighbors, that is, genotypes which differ at exactly one locus. The resulting partial orders are referred to as fitness graphs and have recently been used extensively (<xref ref-type="bibr" rid="bib28">Ogbunugafor et al., 2016</xref>; <xref ref-type="bibr" rid="bib50">Wu et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Smith and Cobey, 2016</xref>; <xref ref-type="bibr" rid="bib23">Mira et al., 2015</xref>).</p><p>The question addressed in the present study is whether higher order interactions can be inferred from rank orders, fitness graphs, and general partial orders. Connections between rank orders and fitness graphs to epistasis and global properties of fitness landscapes have been observed repeatedly (<xref ref-type="bibr" rid="bib14">Greene and Crona, 2014</xref>; <xref ref-type="bibr" rid="bib6">Crona et al., 2013</xref>; <xref ref-type="bibr" rid="bib31">Poelwijk et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Weinreich et al., 2006</xref>; <xref ref-type="bibr" rid="bib48">Weinreich et al., 2005</xref>). Most recently, <xref ref-type="bibr" rid="bib50">Wu et al. (2016)</xref> discussed an example of a fitness graph that implies higher order epistasis. The significance of rank orders of genotypes for epistasis was recognized by <xref ref-type="bibr" rid="bib48">Weinreich et al. (2005)</xref>. The authors introduced the concept of sign epistasis. By definition, a system has sign epistasis if the sign of the effect of a mutation, whether positive or negative, depends on genetic background. Importantly, sign epistasis implies that the rank order of the genotypes is not compatible with additive fitness. In this paper, we develop a related approach based on rank orders that applies to higher order epistasis as well as other measures of gene interactions. For instance, if the rank order of the genotypes implies three-way epistasis for a three-locus system, then one has a signed variant of three-way epistasis. Similarly, one can consider signed variants of almost any type of gene interaction. The theory of sign epistasis stands as a model for development in the area, and there is a potential for understanding global properties of fitness landscapes in terms of (local) signed interactions, similar to results for sign epistasis.</p><p>In addition to the theoretical work mentioned above, rank order arguments have been used for developing antimicrobial treatment strategies (<xref ref-type="bibr" rid="bib40">Smith and Cobey, 2016</xref>; <xref ref-type="bibr" rid="bib26">Nichol et al., 2015</xref>; <xref ref-type="bibr" rid="bib23">Mira et al., 2015</xref>; <xref ref-type="bibr" rid="bib13">Goulart et al., 2013</xref>). However, the full potential of rank order consideration for the comprehensive analysis of epistatic gene interactions in general <inline-formula><mml:math id="inf2"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus genetic systems has not been exploited. Furthermore, to the best of our knowledge the general case of arbitrary partial fitness orders has yet to be considered.</p><p>Here, we develop quantitative tools to detect any type of gene interactions measured by linear forms, including epistasis as described by Fourier coefficients, Walsh coefficients, and circuits (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>; <xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>). In particular, our approach applies to total <inline-formula><mml:math id="inf3"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, conditional epistasis, and marginal epistasis. We used our approach to analyze genetic interactions in HIV-1, the parasite <italic>Plasmodium vivax</italic>, the fungus <italic>Asbergillus niger</italic>, and <inline-formula><mml:math id="inf4"><mml:mi>β</mml:mi></mml:math></inline-formula>-lactamase antibiotic resistance systems. In all cases, we detect higher order interactions based only on partial information about the fitness order of genotypes, without knowing or estimating the actual fitness values.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We consider genetic systems consisting of <inline-formula><mml:math id="inf5"><mml:mi>n</mml:mi></mml:math></inline-formula> biallelic loci. A genotype can then be represented as a binary string of zeros and ones of length <inline-formula><mml:math id="inf6"><mml:mi>n</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf7"><mml:mn>0</mml:mn></mml:math></inline-formula> denotes the wild-type allele and <inline-formula><mml:math id="inf8"><mml:mn>1</mml:mn></mml:math></inline-formula> the alternative allele. We assume that fitness is additive in the absence of epistasis. The fitness of a genotype <inline-formula><mml:math id="inf9"><mml:mi>g</mml:mi></mml:math></inline-formula> is denoted by <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula>, and we assume that the fitness landscape <inline-formula><mml:math id="inf11"><mml:mi>w</mml:mi></mml:math></inline-formula> is generic in the sense that no two genotypes have exactly the same fitness.</p><p>A complete analysis of all epistatic interactions would require fitness measurements of all <inline-formula><mml:math id="inf12"><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> genotypes. However, this level of completeness is rarely available in empirical data sets due to experimental design or an infeasible number of genotypes. To address this limitation, we developed methods that are applicable to partial orders of genotypes according to fitness. For example, the two fitness relations <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> together define a partial order. One can always extend a partial order to a rank order, that is, a total order of the genotypes in the system from highest to lowest fitness. For example, the total order <inline-formula><mml:math id="inf15"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> extends the partial order above. Our goal is to understand what fitness rank orders and more generally partial fitness orders of genotypes reveal about gene interactions.</p><sec id="s2-1"><title>Two-locus case</title><p>We first consider epistasis for a biallelic two-locus population consisting of the unmutated genotype, or wild type, <inline-formula><mml:math id="inf16"><mml:mn>00</mml:mn></mml:math></inline-formula>, the two single mutants <inline-formula><mml:math id="inf17"><mml:mn>01</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:mn>10</mml:mn></mml:math></inline-formula>, and the double mutant <inline-formula><mml:math id="inf19"><mml:mn>11</mml:mn></mml:math></inline-formula>. In this case, epistasis is denoted by <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula>, where the index two refers to the number of loci. It is defined as the deviation from additivity,<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The system has no epistasis if <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, positive epistasis if <inline-formula><mml:math id="inf22"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and negative epistasis if <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>We first assume that the available information on fitness is a rank order of the genotypes (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The rank order is sometimes sufficient for determining that the system has epistasis. For instance, the rank order <inline-formula><mml:math id="inf24"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1</xref> rank order 3), implies <inline-formula><mml:math id="inf25"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, so <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. It follows that the rank order alone allows one to detect positive epistasis without knowledge of the actual fitness values. There are 24 rank orders of the biallelic two-locus system. Among these, eight imply positive epistasis, eight imply negative epistasis, and eight do not permit any inference regarding epistasis. In total two thirds of the rank orders imply epistasis. Each rank order that implies epistasis also determines the sign of <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.002</object-id><label>Figure 1.</label><caption><title>All <inline-formula><mml:math id="inf28"><mml:mn>24</mml:mn></mml:math></inline-formula> rank orders of the biallelic two-locus system, where the <inline-formula><mml:math id="inf29"><mml:mn>16</mml:mn></mml:math></inline-formula> colored rank orders imply epistasis.</title><p>Red (top row) indicates positive epistasis and blue (middle row) negative epistasis.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig1-v1"/></fig><p>Sometimes even a partial order of the genotypes is sufficient for determining that the system has epistasis. For instance, if we know that <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, then we can infer that the system has negative epistasis (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). To see this, we consider all rank orders that extend the partial order. There are six such total extensions, namely rank orders 9, 10, 12, 13, 14, and 16 in <xref ref-type="fig" rid="fig1">Figure 1</xref>, and all imply negative epistasis. We conclude that the partial order implies epistasis, based on only two fitness comparisons and without knowing any of the actual fitness values. This observation holds in general: If all total extensions imply epistasis then the same is true for the partial order. We will use this argument repeatedly.</p><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.003</object-id><label>Figure 2.</label><caption><title>(<bold>a</bold>) A partial fitness order of genotypes.</title><p>The rank orders that extend this partial order are orders (9 , 10 , 12 , 13 , 14), and (16) in <xref ref-type="fig" rid="fig1">Figure 1</xref>. All of them imply negative epistasis (<inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). (<bold>b</bold>) A partial order of genotypes with all its total extensions shown on the right. The first extension shown in red implies positive epistasis (<inline-formula><mml:math id="inf33"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), while the second one in black does not.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig2-v1"/></fig><p>A partial order can also be compatible with several rank orders, some of which might imply epistasis while others do not. In this case, the information is not sufficient to detect epistasis from the partial order alone. For example, the partial order <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is compatible with the two rank orders <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). The first rank order implies positive epistasis, but the other one does not. Consequently, the partial order does not reveal whether or not the system has epistasis, and further comparisons are needed for a conclusion. A more detailed treatment of partial fitness orders can be found in <xref ref-type="bibr" rid="bib22">Lienkaemper et al. (2017)</xref>.</p><p>Fitness graphs constitute an important subclass of partial orders, as they often are the reported result of experiments, and because of their relevance for evolutionary processes (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Briefly, the nodes of a fitness graph represent genotypes and for each pair of mutational neighbors, that is, genotypes which differ at exactly one locus, an arrow points toward the genotype of higher fitness (Section Partial orders and fitness graphs).</p><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.004</object-id><label>Figure 3.</label><caption><title>For a biallelic two-locus system where the genotype <inline-formula><mml:math id="inf37"><mml:mn>00</mml:mn></mml:math></inline-formula> has the lowest fitness, there are four fitness graphs.</title><p>The graph (<bold>a</bold>) is compatible with additive fitness, whereas the remaining graphs imply negative epistasis.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig3-v1"/></fig><p>A fitness graph implies epistasis exactly when all rank orders compatible with the graph do, as is the case for partial orders in general. For example, <xref ref-type="fig" rid="fig3">Figure 3</xref> shows the four fitness graphs where genotype <inline-formula><mml:math id="inf38"><mml:mn>00</mml:mn></mml:math></inline-formula> has lowest fitness in the in the system. The graphs (b), (c) and (d) imply epistasis, whereas (a) is compatible with additive fitness.</p><p>A couple of observations from <xref ref-type="fig" rid="fig3">Figure 3</xref> are useful for determining if a system is compatible with additive fitness. First, any rank order compatible with the graph (a) has the following property: For each genotype, replacing <inline-formula><mml:math id="inf39"><mml:mn>0</mml:mn></mml:math></inline-formula> by <inline-formula><mml:math id="inf40"><mml:mn>1</mml:mn></mml:math></inline-formula> results in a genotype of higher fitness. If the genotype <inline-formula><mml:math id="inf41"><mml:mn>00</mml:mn></mml:math></inline-formula> has minimal fitness in the system, then rank orders are compatible with graph (a) exactly if they satisfy this property. The second observation is that a fitness graph where <inline-formula><mml:math id="inf42"><mml:mn>00</mml:mn></mml:math></inline-formula> has minimal fitness is compatible with additive fitness exactly if all arrows point up. Both observations generalize to any number of loci, and can be phrased in full generality (one can reduce the general problem to the case when <inline-formula><mml:math id="inf43"><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> has lowest fitness in the system by a relabeling argument). In particular, only 384 out of <inline-formula><mml:math id="inf44"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:math></inline-formula> = 40,320 rank orders are compatible with fitness graphs with all arrows up (after relabeling) for the three-locus system, which we consider next (Materials and methods, Section Partial orders and fitness graphs).</p></sec><sec id="s2-2"><title>Three-locus case</title><p>The biallelic three-locus system consists of the eight genotypes <inline-formula><mml:math id="inf45"><mml:mn>000</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf46"><mml:mn>001</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf47"><mml:mn>010</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf48"><mml:mn>011</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf49"><mml:mn>100</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf50"><mml:mn>101</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf51"><mml:mn>110</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="inf52"><mml:mn>111</mml:mn></mml:math></inline-formula>. The system has total three-way epistasis if<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:math></disp-formula></p><p>For the three-locus system, we distinguish between fitness landscapes with no epistasis (fitness is additive), with pairwise but not higher order epistasis (fitness is not additive but <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), and with three-way epistasis (<inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>ε</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p>Some rank orders imply three-way epistasis, similar to our observation of epistasis in the two-locus case. The condition for when a rank order implies three-way epistasis is remarkably simple, and we demonstrate it with an example. Consider the rank order <disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We can represent this rank order by a word in the letters <inline-formula><mml:math id="inf55"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:mi>o</mml:mi></mml:math></inline-formula> using the following procedure. The genotype <inline-formula><mml:math id="inf57"><mml:mn>110</mml:mn></mml:math></inline-formula> with the highest fitness is represented by <inline-formula><mml:math id="inf58"><mml:mi>e</mml:mi></mml:math></inline-formula> because it has an even number of <inline-formula><mml:math id="inf59"><mml:mn>1</mml:mn></mml:math></inline-formula>’s, the genotype <inline-formula><mml:math id="inf60"><mml:mn>111</mml:mn></mml:math></inline-formula> with the second highest fitness is represented by <inline-formula><mml:math id="inf61"><mml:mi>o</mml:mi></mml:math></inline-formula> because it has an odd number of <inline-formula><mml:math id="inf62"><mml:mn>1</mml:mn></mml:math></inline-formula>’s, and so forth. Working from highest to lowest fitness, we obtain the word <disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>If one reads the word letter by letter from left to right, then one has never encountered more <inline-formula><mml:math id="inf63"><mml:mi>o</mml:mi></mml:math></inline-formula>’s than <inline-formula><mml:math id="inf64"><mml:mi>e</mml:mi></mml:math></inline-formula>’s. This property means that <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:math></inline-formula> is a Dyck word (<xref ref-type="bibr" rid="bib41">Stanley, 1999</xref>).</p><p>For a biallelic three-locus system, a rank order implies three-way epistasis exactly if its associated word (where the role of <inline-formula><mml:math id="inf66"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mi>o</mml:mi></mml:math></inline-formula> can be interchanged) is a Dyck word (Proposition 1). This simple rule allows us to conclude that an empirical system has three-way epistasis. As in the two-locus case, a landscape may have three-way epistasis even if the rank order does not imply it. For biallelic three-locus systems, there are in total <inline-formula><mml:math id="inf68"><mml:mrow><mml:mn>40</mml:mn><mml:mo rspace="0.8pt">,</mml:mo><mml:mn>320</mml:mn></mml:mrow></mml:math></inline-formula> rank orders, of which <inline-formula><mml:math id="inf69"><mml:mrow><mml:mn>16</mml:mn><mml:mo rspace="0.8pt">,</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="inf70"><mml:mrow><mml:mn>40</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>) imply three-way epistasis (Proposition 1).</p><p>Fitness graphs can be analyzed by using our results on rank orders as in the two-locus case. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows three fitness graphs for three-locus systems. The fitness graph (a) implies three-way epistasis, the graph (b) pairwise but not higher order epistasis, and the graph (c) is compatible with additive fitness.</p><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.005</object-id><label>Figure 4.</label><caption><title>The fitness graph (<bold>a</bold>) implies three way epistasis, the graph (<bold>b</bold>) implies epistasis, but not higher order epistasis, and (<bold>c</bold>) does not imply epistasis, since all arrows point up.</title></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig4-v1"/></fig><p>There are in total <inline-formula><mml:math id="inf71"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>862</mml:mn></mml:mrow></mml:math></inline-formula> fitness graphs for the biallelic three-locus system, of which <inline-formula><mml:math id="inf72"><mml:mn>698</mml:mn></mml:math></inline-formula> graphs (<inline-formula><mml:math id="inf73"><mml:mrow><mml:mn>37</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula>) imply three-way epistasis. In principle one can check a particular three-locus system for higher order epistasis using this result. However, it is not convenient to work with a list of over one thousand graphs. In order to make the problem more tractable, we can utilize the fact that some fitness graphs are isomorphic (<xref ref-type="fig" rid="fig5">Figure 5</xref>). There are <inline-formula><mml:math id="inf74"><mml:mn>54</mml:mn></mml:math></inline-formula> distinct isomorphism classes of graphs for the three-locus system, of which <inline-formula><mml:math id="inf75"><mml:mn>20</mml:mn></mml:math></inline-formula> imply higher order epistasis (Mathematical framework and proofs, Section Partial orders and fitness graphs). Consequently, to detect three-way epistasis, one can find the isomorphism class and then check <inline-formula><mml:math id="inf76"><mml:mn>54</mml:mn></mml:math></inline-formula> graphs, namely one for each isomorphism class (<xref ref-type="fig" rid="fig6">Figure 6</xref> ).</p><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.006</object-id><label>Figure 5.</label><caption><title>Interactions detected from fitness summary statistics and from rank orders.</title><p>The horizontal axis is labeled by the four interaction coordinates <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:mi mathvariant="normal">…</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf79"><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula> and twenty circuits <inline-formula><mml:math id="inf80"><mml:mi>a</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf81"><mml:mi mathvariant="normal">…</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf82"><mml:mi>t</mml:mi></mml:math></inline-formula>. The boxplots show the distributions of the various interactions induced by the empirical fitness distribution. The red star indicates whether the interaction has been detected by our rank order method. Specifically, a star with vertical coordinate <inline-formula><mml:math id="inf83"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, 0, and one means negative, no, and positive interaction, respectively.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig5-v1"/></fig><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.007</object-id><label>Figure 6.</label><caption><title>The TEM-family of <inline-formula><mml:math id="inf84"><mml:mi>β</mml:mi></mml:math></inline-formula>-lactamase contributes to antibiotic resistance problems in hospitals.</title><p>The fitness graph shows a four-locus system consisting of the wild type, TEM-1, the quadruple mutant, TEM-50, and all intermediate mutants, including six clinically found mutants in the TEM family. The mutation M69L corresponds to <inline-formula><mml:math id="inf85"><mml:mn>1000</mml:mn></mml:math></inline-formula>, E104K to <inline-formula><mml:math id="inf86"><mml:mn>0100</mml:mn></mml:math></inline-formula>, G238S to <inline-formula><mml:math id="inf87"><mml:mn>0010</mml:mn></mml:math></inline-formula>, and N276D to <inline-formula><mml:math id="inf88"><mml:mn>0001</mml:mn></mml:math></inline-formula>. Growth rates were measured for the 16 genotypes under exposure to the antibiotic FEP Cefepime, and the fitness graph was determined accordingly (<xref ref-type="bibr" rid="bib23">Mira et al., 2015</xref>). The graph reveals higher order epistasis.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig6-v1"/></fig><fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.008</object-id><label>Figure 7.</label><caption><title>The fitness graph shows a four-locus system for the filamentous fungus <italic>Aspergillus Niger</italic>.</title><p>The system consists of all combinations of the four individually deleteriouis mutations <italic>fwnA1</italic>, <italic>leuA1</italic>, <italic>oliC2</italic> and <italic>crnB12</italic>. The landscape has in total four peaks, labeled <inline-formula><mml:math id="inf89"><mml:mrow><mml:mn>0000</mml:mn><mml:mo>,</mml:mo><mml:mn>1100</mml:mn><mml:mo>,</mml:mo><mml:mn>0011</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf90"><mml:mn>1001</mml:mn></mml:math></inline-formula>.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig7-v1"/></fig><fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.009</object-id><label>Figure 8.</label><caption><title>The fitness graph is compatible with the two rank orders (5) and (6).</title></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig8-v1"/></fig><fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.010</object-id><label>Figure 9.</label><caption><title>An example of an isomorphism.</title><p>Here, the allele labels ‘0’ and ‘1’ in the first locus have been interchanged, as well as the second and third loci.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig9-v1"/></fig><p>We complete the consideration of the three-locus case by analyzing partial orders. Again, in favorable cases one can infer three-way epistasis. Indeed, if there exists a partition of all eight genotypes into four pairs <inline-formula><mml:math id="inf91"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo rspace="4.2pt">,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf92"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf93"><mml:mi>o</mml:mi></mml:math></inline-formula> are as above, and <inline-formula><mml:math id="inf94"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:msub></mml:mrow></mml:math></inline-formula> for each pair, then one can conclude three-way epistasis ( Proposition 7).</p></sec><sec id="s2-3"><title>General <inline-formula><mml:math id="inf95"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus case</title><p>The results on rank orders and higher order epistasis for <inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> generalize to any number of loci. The definition of <inline-formula><mml:math id="inf97"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis in an <inline-formula><mml:math id="inf98"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system is analogous to the three-locus case, as is the condition for when rank orders imply <inline-formula><mml:math id="inf99"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. Accordingly, a characterization of rank orders that imply <inline-formula><mml:math id="inf100"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis can be phrased in terms of Dyck words (Proposition 1). From this result it follows that the fraction of rank orders that imply <inline-formula><mml:math id="inf101"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis is <inline-formula><mml:math id="inf102"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ( Corollary 2) and that it can be determined in a computationally efficient manner whether or not a rank order implies <inline-formula><mml:math id="inf103"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis.</p><p>Rank order methods are useful for analyzing the total <inline-formula><mml:math id="inf104"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis for an <inline-formula><mml:math id="inf105"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system, as demonstrated. However, a single quantity cannot capture all possible gene interactions. Rank order approaches have the capacity to reveal finer interactions as well.</p><p>We start with a general description of gene interactions before exploring what rank orders can reveal about these interactions. We define an additive dependence relation as a linear form that is zero on additive fitness landscapes. Interaction coordinates and circuits (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>), as well as Walsh coefficients of order two or more (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>), are additive dependence relations. For simplicity, we restrict our analysis to the three-locus system, although the arguments used are readily extendable to any number of loci <inline-formula><mml:math id="inf106"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p><p>First, we consider additive dependence relations that directly correspond to the two-locus case by fixing one allele at the third locus. For example, if we fix the third locus at <inline-formula><mml:math id="inf107"><mml:mn>0</mml:mn></mml:math></inline-formula>, then <disp-formula id="equ5"><mml:math id="m5"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>measures pairwise epistasis between the first and second locus. Similarly, if we set the third locus to <inline-formula><mml:math id="inf108"><mml:mn>1</mml:mn></mml:math></inline-formula>, then<disp-formula id="equ6"><mml:math id="m6"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>measures pairwise epistasis between the first and second locus.</p><p>An example of an additive dependence relation with no correspondence in the two-locus setting is<disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which compares the fitness of the triple mutant <inline-formula><mml:math id="inf109"><mml:mn>111</mml:mn></mml:math></inline-formula> to the three single mutants. This expression is negative if the triple mutant has higher fitness than one would expect based on the fitness effects of the three single mutations. An example of an additive dependence relation with eight non-zero terms is<disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>One can verify that <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> is twice the average of <inline-formula><mml:math id="inf111"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mi>b</mml:mi></mml:math></inline-formula>. For a systematic approach to a comprehensive set of gene interactions, one can take advantage of circuits, that is, minimal additive dependence relations. In contrast, <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> is not minimal, because it can be derived from <inline-formula><mml:math id="inf114"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf115"><mml:mi>b</mml:mi></mml:math></inline-formula>. There are 20 circuits for the three-locus system, including <inline-formula><mml:math id="inf116"><mml:mi>a</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf117"><mml:mi>b</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf118"><mml:mi>m</mml:mi></mml:math></inline-formula> (Mathematical framework and proofs, Section Circuits).</p><p>The interactions described by <inline-formula><mml:math id="inf119"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:mi>b</mml:mi></mml:math></inline-formula> are referred to as conditional epistasis, that is, interactions that measure the total epistasis of subsystems obtained by fixing some loci at 0 or 1. If the interactions <inline-formula><mml:math id="inf121"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:mi>b</mml:mi></mml:math></inline-formula> differ substantially, it may be important to consider both of them. However, if we are rather interested in the average interaction for the first two loci over all genetic backgrounds, then <inline-formula><mml:math id="inf123"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> is the right measure.</p><p>In general, relations that measure average effects, such as <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, are referred to as interaction coordinates. The interaction coordinates <inline-formula><mml:math id="inf125"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> differs from the Walsh coefficient <inline-formula><mml:math id="inf126"><mml:msub><mml:mi>E</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>) only by a constant scaling factor. Provided that average effects are sufficient for the purpose of a study, one can analyze higher order epistasis by considering interaction coordinates, or Walsh coefficients, (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>) (Mathematical framework and proofs).</p><p>One interesting class of circuits compares the effect of replacing pairs of loci with different backgrounds. For instance, <disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>compares the effect of replacing 00 by 11 if the third coordinate is fixed at 0, versus if the third coordinate is fixed at 1. We refer to <inline-formula><mml:math id="inf127"><mml:mi>k</mml:mi></mml:math></inline-formula> as a circuit measuring marginal epistasis between two pairs of loci as in <xref ref-type="bibr" rid="bib1">Beerenwinkel et al. (2007)</xref>.</p><p>Arguments based on Dyck words can be used for analyzing rank orders and additive dependence relations in general. The letters are determined by the signs of the coefficients in the linear form, as for three-way epistasis (Theorem 3).</p><p>For each circuit and interaction coordinate, we identify all rank orders that determine its sign. The characterization is given in terms of general Dyck word conditions. We found that for each interaction coordinate, <inline-formula><mml:math id="inf128"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> of all rank orders determine its sign; for each circuit corresponding to either conditional two-way interaction or marginal epistasis between two pairs of loci, <inline-formula><mml:math id="inf129"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> of all rank orders determine its sign; and for each circuit relating the three-way interaction to the total two-way epistasis, <inline-formula><mml:math id="inf130"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> of all rank orders determine its sign ( Corollary 4 and 6).</p><p>Importantly, if a rank order implies that the sign of an additive dependence relation, such as a circuit or an interaction coordinates, is determined, then the system has sign epistasis.</p><p>One can ask if it possible to decompose the word obtained for analyzing <inline-formula><mml:math id="inf131"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis into subunits, so as to learn about circuits or properties for subsystems of the genotypes. In general, no such decompositions are possible unless one has information in addition to the word itself. For instance, suppose that a rank order is mapped to <inline-formula><mml:math id="inf132"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>. The first half of the word, namely <inline-formula><mml:math id="inf133"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>, does not necessarily reveal any interesting information about the system. (Mathematical framework and proofs, Section Circuits).</p><p>The signs of all twenty circuits determines the polyhedral shape of the fitness landscape (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>). The shape combines the circuit information into a more manageable object. However, no rank order determines a shape for <inline-formula><mml:math id="inf134"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> (Mathematical framework and proofs, Section Circuits).</p><p>Our tools for detecting gene interactions work for total <inline-formula><mml:math id="inf135"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, interaction coordinates and circuits. Moreover, our approach applies to any type of gene interaction that can be expressed by a linear form (Theorem 3), such as Fourier coefficients (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>) and Walsh coefficients (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>). We have implemented algorithms for detecting the gene interactions described in this section, both for rank orders and partial orders, specifically, algorithms for <inline-formula><mml:math id="inf136"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, three-way and four-way interaction coordinates, and three-way circuit interactions (<ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#fitlands">https://github.com/gavruskin/fitlands#fitlands</ext-link>). The most computationally demanding task of our algorithms is reading the rank order from disk. The run time complexity is proportional to the number of non-zero coefficients in the linear form.</p></sec><sec id="s2-4"><title>Analysis of empirical fitness data</title><p>As proof of principle, we applied our tools to fitness data from a diverse set of biological systems, ranging from HIV-1 (<xref ref-type="bibr" rid="bib38">Segal et al., 2004</xref>), malaria (<xref ref-type="bibr" rid="bib27">Ogbunugafor and Hartl, 2016</xref>), antibiotic resistance (<xref ref-type="bibr" rid="bib23">Mira et al., 2015</xref>), to the fungus <italic>Aspergillus Niger</italic> (<xref ref-type="bibr" rid="bib11">Franke et al., 2011</xref>). Our approach reveals higher order epistasis for all of these systems, only by considering rank orders and partial orders of genotypes, without the need to access direct fitness measurements or estimates.</p><p>Our first application is to the HIV-1 data published by <xref ref-type="bibr" rid="bib38">Segal et al., 2004</xref>. Following <xref ref-type="bibr" rid="bib1">Beerenwinkel et al. (2007)</xref>, we consider the three-locus biallelic system that consists of the mutation <inline-formula><mml:math id="inf137"><mml:mi>L90M</mml:mi></mml:math></inline-formula> in the protease and mutations <inline-formula><mml:math id="inf138"><mml:mi>M184V</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf139"><mml:mi>T215Y</mml:mi></mml:math></inline-formula> in the reverse transcriptase of HIV-1. Fitness was measured as the number of offspring in a single replication cycle of the virus in the original study, and was reported relative to the wild-type strain NL4-3 on a logarithmic scale. The data consist of <inline-formula><mml:math id="inf140"><mml:mn>288</mml:mn></mml:math></inline-formula> fitness measurements, including between <inline-formula><mml:math id="inf141"><mml:mn>5</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf142"><mml:mn>214</mml:mn></mml:math></inline-formula> replicates per genotype.</p><p>The following rank order was obtained by comparing the mean fitness of the eight genotypes:<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf143"><mml:mn>000</mml:mn></mml:math></inline-formula> corresponds to the sequence of amino acids <inline-formula><mml:math id="inf144"><mml:mi>LMT</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf145"><mml:mn>111</mml:mn></mml:math></inline-formula> to <inline-formula><mml:math id="inf146"><mml:mi>MVY</mml:mi></mml:math></inline-formula> comprising the three selected loci. This rank order implies positive three-way epistasis because the associated word<disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>e</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mpadded width="+1.7pt"><mml:mi>o</mml:mi></mml:mpadded><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:math></disp-formula></p><p>is a Dyck word. It follows that the three mutations under consideration together have a stronger effect on fitness than one would predict from single and double mutants. A closer inspection of the word reveals more information. If we swap any two adjacent letters in the word, then we still have a Dyck word, with the single exception of the first two letters. In other words, only one pair of adjacent genotypes in the rank order, namely <inline-formula><mml:math id="inf147"><mml:mn>000</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf148"><mml:mn>100</mml:mn></mml:math></inline-formula>, could violate the conclusion if transposed.</p><p>If the experiment was to continue, our analysis could be used to direct the data collection process. Indeed, the argument above suggests that the position of the genotype <inline-formula><mml:math id="inf149"><mml:mn>100</mml:mn></mml:math></inline-formula> may violate the conclusion of positive three-way epistasis. To quantify the uncertainty in the ranking of <inline-formula><mml:math id="inf150"><mml:mn>100</mml:mn></mml:math></inline-formula> with respect to the wild type <inline-formula><mml:math id="inf151"><mml:mn>000</mml:mn></mml:math></inline-formula>, we employed the Wilcoxon rank sum test on the replicate fitness measurements. The p-value of the test is <inline-formula><mml:math id="inf152"><mml:mn>0.47</mml:mn></mml:math></inline-formula> for the relation <inline-formula><mml:math id="inf153"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which implies considerable uncertainty and justifies our recommendation of further experiments to clarify the position of <inline-formula><mml:math id="inf154"><mml:mn>100</mml:mn></mml:math></inline-formula>. Importantly, the suggested experiment reduces the number of measurements required to make a more robust conclusion about epistasis considerably, namely to one out of <inline-formula><mml:math id="inf155"><mml:mn>28</mml:mn></mml:math></inline-formula> possible comparisons.</p><p>We proceeded by considering other types of gene interactions in this data set. When considering all <inline-formula><mml:math id="inf156"><mml:mn>20</mml:mn></mml:math></inline-formula> circuits, the rank order implies interactions for <inline-formula><mml:math id="inf157"><mml:mrow><mml:mn>55</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> of the circuits, with positive sign for <inline-formula><mml:math id="inf158"><mml:mrow><mml:mn>30</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> and negative for <inline-formula><mml:math id="inf159"><mml:mrow><mml:mn>25</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> of the circuits. This result is consistent with the conventional statistical approaches that use direct fitness measurements. Indeed, since the empirical study of <xref ref-type="bibr" rid="bib38">Segal et al., 2004</xref> provided multiple fitness measurements of each genotype, it was possible to compare our conclusion based on rank orders with statistical tests based on fitness estimates.</p><p>The results for fitness measurements were confirmed by the conventional Wilcoxon rank sum test. We computed interaction coordinates and circuit interactions for the summary statistics reported in (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>). <xref ref-type="fig" rid="fig7">Figure 7</xref> shows that our rank order methods detected the majority of circuit interactions identified by using the summary statistics. Specifically, both approaches detected three-way epistasis. Furthermore, <inline-formula><mml:math id="inf160"><mml:mn>11</mml:mn></mml:math></inline-formula> of the <inline-formula><mml:math id="inf161"><mml:mn>20</mml:mn></mml:math></inline-formula> circuit interactions have been detected by our method and confirmed by Wilcoxon rank sum test.</p><p>We also applied Student’s t-test to detect interactions and quantify the significance of the estimates. In addition to the <inline-formula><mml:math id="inf162"><mml:mn>11</mml:mn></mml:math></inline-formula> interactions, the t-test found <inline-formula><mml:math id="inf163"><mml:mn>6</mml:mn></mml:math></inline-formula> circuit interactions as significant (Table 2). We emphasize that the rank order approach required much less information to arrive at the same conclusions, thus demonstrating the power of the method.</p><p>We conclude that the three sites in the HIV-1 genome under consideration are prone to a diverse set of interactions. Specifically, the strong support for the three-way epistasis, along with the <inline-formula><mml:math id="inf164"><mml:mrow><mml:mn>55</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:math></inline-formula> of informative circuit interactions, imply that the three loci together interact in a complex manner, meaning that the interactions cannot be explained using pairwise interactions alone. Thus, in this data set, higher order interactions have a strong impact on the fitness landscape.</p><p>Our second application is to a study of antimicrobial drug resistance in malaria (<xref ref-type="bibr" rid="bib27">Ogbunugafor and Hartl, 2016</xref>). The authors measured growth rates for several mutants of <italic>Plasmodium vivax</italic> under exposure to the antimalarial drug pyrimethamine. We identified higher order epistasis by analyzing rank orders. More precisely, we considered a three-locus sub-system of the study that consists of mutations N50I, S58R, and S117N, in the context of T173L, a fixed mutation, under nine different concentrations of pyrimethamine. The genotypes comprising positions 50, 58, and 117 are labeled <inline-formula><mml:math id="inf165"><mml:mn>000</mml:mn></mml:math></inline-formula> (NSS), <inline-formula><mml:math id="inf166"><mml:mn>100</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf167"><mml:mn>010</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf168"><mml:mn>001</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf169"><mml:mn>110</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf170"><mml:mn>101</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf171"><mml:mn>011</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="inf172"><mml:mn>111</mml:mn></mml:math></inline-formula> (IRN). The three highest concentrations of the drug resulted in the following rank orders: <disp-formula id="equ12"><mml:math id="m12"><mml:mtable columnalign=" left right right left right right left right right"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>The corresponding words are <inline-formula><mml:math id="inf173"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> for the first rank order, obtained under the highest concentration of the drug, and <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> for the second and third rank orders. Since we obtain Dyck words in all cases, the system has negative three-way epistasis for the three highest concentrations of the drug. This consistency among pyrimethamine concentrations shows that the result is robust.</p><p>Using our software, we also analyzed all interaction coordinates for this data set (<ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands/blob/master/Four-way_interaction_coordinates_and_total_n-way_interaction.ipynb">https://github.com/gavruskin/fitlands/blob/master/Four-way_interaction_coordinates_and_total_n-way_interaction.ipynb</ext-link>). Our analysis revealed that for the two highest concentrations of the drug, the rank order implies that the interaction coordinate denoted <inline-formula><mml:math id="inf175"><mml:msub><mml:mi>u</mml:mi><mml:mn>0111</mml:mn></mml:msub></mml:math></inline-formula>(Mathematical framework and proofs) is negative.</p><p>Next, we applied our tools to a study of the TEM-family of <inline-formula><mml:math id="inf176"><mml:mi>β</mml:mi></mml:math></inline-formula>-lactamase, associated with antibiotic resistance (<xref ref-type="bibr" rid="bib23">Mira et al., 2015</xref>). The study measured growth rates for <inline-formula><mml:math id="inf177"><mml:mn>16</mml:mn></mml:math></inline-formula> genotypes exposed to <inline-formula><mml:math id="inf178"><mml:mn>15</mml:mn></mml:math></inline-formula> different antibiotics. Specifically, all <inline-formula><mml:math id="inf179"><mml:mn>16</mml:mn></mml:math></inline-formula> genotypes that combine subsets of the four amino acid substitutions M69L, E104K, G238S, N276D found in TEM-50, including eight known enzymes, were created using site-directed mutagenesis. We considered the fitness graph obtained when the system was exposed to the antibiotic FEP Cefepime at a concentration of <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0.0156</mml:mn><mml:mtext> </mml:mtext><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>g/ml (<xref ref-type="fig" rid="fig8">Figure 8</xref>). The fitness graph implies higher order epistasis (Proposition 7), that is, the fitness of TEM-50 cannot be predicted even with complete knowledge of the fitness values of the remaining genotypes in the system. The fitness graphs for the other 14 antibiotics do not share this property. We conclude that even though some of the single and triple mutants confer low antibiotic resistance, a large population of triple mutants alone is more prone to become antibiotic resistant due to the epistatic fitness advantage of TEM-50, as compared to a setting with no higher order epistasis.</p><p>Finally, we investigated a study of the filamentous fungus <italic>Aspergillus Niger</italic> (<xref ref-type="bibr" rid="bib11">Franke et al., 2011</xref>). We considered a system consisting of the wild type and all combinations of the four individually deleterious mutations <italic>fwnA1</italic>, <italic>leuA1</italic>, <italic>oliC2</italic> and <italic>crnB12</italic> (<xref ref-type="fig" rid="fig9">Figure 9</xref>). Fitness was estimated with two-fold replication by measuring the linear mycelium growth rate in the original study. The fitness graph implies higher order epistasis (Proposition 7).</p><p>All four arrows incident to <inline-formula><mml:math id="inf181"><mml:mn>0000</mml:mn></mml:math></inline-formula> point towards the genotype, so that the genotype <inline-formula><mml:math id="inf182"><mml:mn>0000</mml:mn></mml:math></inline-formula> is a peak in the landscape. The same is true for the genotypes <inline-formula><mml:math id="inf183"><mml:mn>1100</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf184"><mml:mn>0011</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="inf185"><mml:mn>1001</mml:mn></mml:math></inline-formula>. Because of the four peaks, it is possible that the fungus population gets stranded at a suboptimal peak during the course of evolution (we do not necessarily assume that the starting point for an evolutionary process is at <inline-formula><mml:math id="inf186"><mml:mn>0000</mml:mn></mml:math></inline-formula>). In contrast, an additive fitness landscape is single peaked. This example illustrates that epistasis may have an impact on the evolutionary dynamics. Several peaks can make the evolutionary process less predictable, depending also on other factors such as population size, mutation rate, etc. More generally, for three-locus fitness graphs, we analyzed the impact of higher order epistasis versus only pairwise epistasis systematically. We found that higher order epistasis correlates with more peaks as well as other features that can lead to involved evolutionary dynamics (Mathematical framework and proofs, Section Graph theoretical aspects).</p><p>We completed our analysis of this data set by considering the <inline-formula><mml:math id="inf187"><mml:mn>5</mml:mn></mml:math></inline-formula>-locus system of mutations <italic>fwnA1</italic>, <italic>argH12</italic>, <italic>pyrA5</italic>, <italic>leuA1</italic>, and <italic>pheA1</italic>, conditioning on mutations <italic>lysD25</italic>, <italic>oliC2</italic>, and <italic>crnB12</italic> all being absent. The original study does not contain any measurements for the two genotypes <inline-formula><mml:math id="inf188"><mml:mn>11010</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf189"><mml:mn>10111</mml:mn></mml:math></inline-formula>. Furthermore, two pairs of genotypes in the system have identical ranks, namely <inline-formula><mml:math id="inf190"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>11000</mml:mn><mml:mo>,</mml:mo><mml:mn> 10010</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf191"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>10011</mml:mn><mml:mo>,</mml:mo><mml:mn> 11101</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We obtained the following word for the total five-way epistasis <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>u</mml:mi><mml:mn>11111</mml:mn></mml:msub></mml:math></inline-formula>, <disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where the two <inline-formula><mml:math id="inf193"><mml:mi>x</mml:mi></mml:math></inline-formula>’s correspond to genotypes <inline-formula><mml:math id="inf194"><mml:mn>11000</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf195"><mml:mn>10010</mml:mn></mml:math></inline-formula>, the <inline-formula><mml:math id="inf196"><mml:mi>y</mml:mi></mml:math></inline-formula>’s to <inline-formula><mml:math id="inf197"><mml:mn>10011</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf198"><mml:mn>11101</mml:mn></mml:math></inline-formula>, and two letters are missing. Whether one can draw conclusions about five-way epistasis or not, depends on the positions of the two missing genotypes, as well as the genotypes represented by <inline-formula><mml:math id="inf199"><mml:mi>y</mml:mi></mml:math></inline-formula>’s, whereas it is independent of the genotypes represented by <inline-formula><mml:math id="inf200"><mml:mi>x</mml:mi></mml:math></inline-formula>’s. Specifically, if genotype <inline-formula><mml:math id="inf201"><mml:mn>11101</mml:mn></mml:math></inline-formula> has higher fitness than <inline-formula><mml:math id="inf202"><mml:mn>10011</mml:mn></mml:math></inline-formula>, genotype <inline-formula><mml:math id="inf203"><mml:mn>10111</mml:mn></mml:math></inline-formula> has rank between 1 and 15, and genotype <inline-formula><mml:math id="inf204"><mml:mn>11010</mml:mn></mml:math></inline-formula> has rank between 20 and 32, then the resulting rank order implies positive five-way epistasis, that is, <inline-formula><mml:math id="inf205"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>11111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, for both possible options to resolve the ranking of genotypes <inline-formula><mml:math id="inf206"><mml:mn>11000</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf207"><mml:mn>10010</mml:mn></mml:math></inline-formula> (<xref ref-type="table" rid="table3">Table 3</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Gene interactions play a critical role in evolutionary processes. Important features of fitness landscapes, such as the number of peaks, and accessible evolutionary trajectories, depend on epistatic gene interactions. The importance of higher order versus pairwise epistasis, within and among genes or in non-coding regions, as well as the impact of higher order epistasis on evolutionary dynamics, remains a central research topic (<xref ref-type="bibr" rid="bib34">Sailer and Harms, 2017b</xref>; <xref ref-type="bibr" rid="bib50">Wu et al., 2016</xref>; <xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>). Progress in all of these areas requires adequate mathematical and statistical approaches, in addition to empirical studies.</p><p>Here, we have developed new quantitative tools for detecting gene interactions from empirical data. The main advantage of our tools is that they can reveal gene interactions from the types of data frequently generated in empirical studies, specifically rank orders, fitness graphs, and general partial orders of genotypes. The reasons why, in practice, these types of data are available more often than precise fitness measurements for each genotype are manifold. They include restricted comparative experimental designs and known and unknown confounding factors in measuring fitness that can result in uncertain and biased estimates. The methods presented here allow for studying epistatic interactions even when direct fitness measurements are lacking or only a subset of pairwise fitness comparisons is available, either as the immediate outcome of the experiment or the reported summary.</p><p>We provide a complete characterization of rank orders that imply higher order epistasis, along with precise results for fitness graphs of three-locus systems. In principle, our approach applies to general partial orders as well, and we have implemented algorithms accordingly. However, because of the increasing computational complexity it would be desirable to have theoretical results for handling large systems. In particular, a characterization of fitness graphs that imply higher order epistasis is of independent mathematical interest.</p><p>We found that for biallelic three-locus systems, 40% of all possible rank orders and 37% of all possible fitness graphs imply higher order epistasis. These fractions suggest that our methods have a good capacity to detect higher order epistasis among three loci, even if exact and complete fitness measurements or estimates are not available.</p><p>The fraction of rank orders that imply <inline-formula><mml:math id="inf208"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis decreases rapidly with increasing number of loci, <inline-formula><mml:math id="inf209"><mml:mi>n</mml:mi></mml:math></inline-formula>. However, many rank orders are informative regarding other additive dependence relations, for instance some circuits measuring conditional epistasis. This is clear from the observation that the proportion of rank orders that are compatible with additive fitness decreases rapidly with <inline-formula><mml:math id="inf210"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p><p>Moreover, the power of our methods was demonstrated for a diverse set of biological systems. We detected higher order epistasis for HIV, malaria, the fungus <italic>Aspergillus Niger</italic>, and antibiotic resistance systems. Our findings suggest that genetic interactions beyond two-way epistasis shape the fitness landscapes of these genetic systems and may play an important role in determining their evolutionary trajectories. We also exhaustively investigated various types of higher order interactions in HIV-1 and discovered a complex pattern of interactions, confirming that our approach is powerful enough to detect finer gene interactions. Specifically, we identified over twenty interactions by conventional approaches, and rank order methods detected about half of them.</p><p>Another important application of our method is to experimental design. When the information available in the data does not contradict an interaction, but is not conclusive enough to claim the interaction, for example because the number of performed competition experiments is too small, then the method allows for prioritizing further experiments by suggesting additional comparisons of genotypes. This feature may prove useful in guiding fitness experiments that aim for testing specific interactions and allow for iteration. We have developed this idea further in <xref ref-type="bibr" rid="bib22">Lienkaemper et al. (2017)</xref>, where we consider partial fitness orders of genotypes and develop efficient algorithms to detect genetic interactions, as well as study the geometry of such partial orders. Evolutionary aspects of partial orders and gene interactions are studied in <xref ref-type="bibr" rid="bib7">Crona and Luo, 2017</xref>.</p><p>Genetic interactions, especially those of higher order, are particularly difficult to detect in high-dimensional systems, where complete fitness measurements of all genotypes are infeasible. Human genome-wide association studies (GWAS) are a prime example. Here, already the number of loci, <inline-formula><mml:math id="inf211"><mml:mi>n</mml:mi></mml:math></inline-formula>, and certainly the number of possible genotypes, <inline-formula><mml:math id="inf212"><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula>, is much larger than the actual number of genotyped and phenotyped individuals, even if the genotype data is summarized on the level of genes or haplotype blocks. Since most diseases are polygenic, rather than monogenic, genetic interactions play an important role, and accounting for them may explain some of the missing heritability and improve genetic disease models. Several methods have been proposed for detecting pairwise interactions in GWAS, most of them relying on scanning all or a prioritized subset of pairs of loci (<xref ref-type="bibr" rid="bib45">Wei et al., 2014</xref>), but little is known about higher order interactions in these landscapes.</p><p>The methods presented in the present study may help addressing this challenge as they can sometimes reveal higher order interactions from a small number of comparisons, and the choice of genotypes to compare can be optimized if particular interactions are to be tested. Another advantage is the flexibility of our approach regarding the type of epistatic interaction analyzed. While we have focused on analyzing complete genetic systems, that is, <inline-formula><mml:math id="inf213"><mml:mi>n</mml:mi></mml:math></inline-formula>-dimensional hypercubes, for small values of <inline-formula><mml:math id="inf214"><mml:mi>n</mml:mi></mml:math></inline-formula> in this work, genotype spaces consisting of subsets of the <inline-formula><mml:math id="inf215"><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> possible genotypes have different sets of interactions, such as circuits, that are natural to consider. Towards this end, <xref ref-type="bibr" rid="bib19">Huggins et al. (2007)</xref> have explored circuits and their sign patterns for genotype data from the HapMap project in two ENCODE regions. The Dyck word approach will be particularly useful if quantitative data on the phenotype is difficult to obtain, but rank order information is more accessible, for example by considering disease indicators, rather than the condition itself.</p><p>For a more theoretical perspective, we emphasize the distinction between rank order-induced gene interactions, and interactions that do not change the rank order of genotypes. This distinction was pointed out by <xref ref-type="bibr" rid="bib48">Weinreich et al., 2005</xref> who introduced the term sign epistasis. If a system has sign epistasis, then the rank order of the genotypes is not compatible with additive fitness. Rank order-induced gene interactions of any type can thus be regarded as analogues to sign epistasis.</p><p>There exist a number of possible ways to quantify and interpret higher order interactions (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>; <xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>; <xref ref-type="bibr" rid="bib18">Hallgrímsdóttir and Yuster, 2008</xref>), and our rank order approach applies to any type of gene interactions measured by linear forms. In particular, we can detect interactions as described by Fourier coefficients and Walsh coefficients. From our general argument based on Dyck words we investigated three-locus systems, and determined the number of rank orders that imply circuit interactions, including conditional and marginal epistasis, and similarly for interactions coordinates. The method works equally well for other interactions.</p><p>Further investigation of rank order-induced interaction has the potential to relate global and local properties of fitness landscapes, similarly to results on sign epistasis (<xref ref-type="bibr" rid="bib48">Weinreich et al., 2005</xref>; <xref ref-type="bibr" rid="bib31">Poelwijk et al., 2011</xref>; <xref ref-type="bibr" rid="bib6">Crona et al., 2013</xref>). Global properties concern peaks and mutational trajectories in the fitness landscape, whereas local properties concern, for instance, fitness graphs for small system. The relation between global and local properties is important since only local properties can be easily observed in experiments or nature.</p><p>A very useful feature of sign epistasis is that one can identify, or rule out, sign epistasis in a system from inspection of two-locus subsystems only. The theoretical significance and applicability of sign epistasis depends on its local nature. Fortunately, the signed versions of other gene interactions are sometimes local as well. For instance, it seems plausible that the absence of rank order induced conditional epistasis of specified orders (a local property) correlates with few peaks and good peak accessibility. In this spirit we explore some evolutionary consequences of higher order epistasis in <xref ref-type="bibr" rid="bib7">Crona and Luo, 2017</xref>. Theory for sign epistasis stands as a model for further development in this area.</p><p>Although we have applied our method here only to fitness, any other continuous phenotype of interest can be analyzed in exactly the same manner. The fitness landscape <inline-formula><mml:math id="inf216"><mml:mi>w</mml:mi></mml:math></inline-formula> is then replaced by a more general genotype-to-phenotype map. For example, rather than using it as a fitness proxy, one may be concerned about the drug resistance phenotype itself and its genetic architecture.</p><p>In summary, rank order methods have potential for the interpretation of empirical data, as well as for relating higher order gene interactions and evolutionary dynamics. Our approach facilitates detecting higher order epistasis from a very broad range of empirical data, and will therefore contribute to enhancing our general understanding of empirical fitness landscapes and epistatic gene interactions.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Mathematical framework and proofs</title><p>Here we provide proofs for the results in the main text, and give a brief background on the discrete Fourier transform, Dyck words, and Catalan numbers. Catalan numbers (<xref ref-type="bibr" rid="bib41">Stanley, 1999</xref>) have rarely been used in biology, so we describe them briefly without assuming any knowledge. Several arguments in the Materials and methods depend on elementary combinatorics, and the reader may consult a general text, such as <xref ref-type="bibr" rid="bib15">Grimaldi (2006)</xref>.</p><p>We start with rank orders and the total <inline-formula><mml:math id="inf217"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, followed by more general results on rank orders, circuits and other linear forms. The next topic is epistasis and fitness graphs, including some related graph theory. Finally we provide a few observations on epistasis and partial orders.</p><p>Gene interactions for a biallelic <inline-formula><mml:math id="inf218"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system can be described in terms of the Fourier transform for <inline-formula><mml:math id="inf219"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ℤ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:math></inline-formula> defined as <disp-formula id="equ14"><mml:math id="m14"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>⋅</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi mathvariant="normal">⋯</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>By abuse of notation we will ignore the scaling factor <inline-formula><mml:math id="inf220"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> We define interaction coordinates as the elements <inline-formula><mml:math id="inf221"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> such that at least two entries in <inline-formula><mml:math id="inf222"><mml:mrow><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are 1. The interaction coordinate <inline-formula><mml:math id="inf223"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> measures the total <inline-formula><mml:math id="inf224"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, <disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mi mathvariant="normal">⋯</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:munderover><mml:mo largeop="true" movablelimits="false" symmetric="true">∑</mml:mo><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:munderover><mml:mrow><mml:mpadded width="+1.7pt"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mpadded><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>In particular,<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula></p><p>as defined in <xref ref-type="disp-formula" rid="equ1 equ2">Equations 1 and 2</xref> in the main text. A biallelic three-locus system has three-way epistasis exactly if <inline-formula><mml:math id="inf225"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Otherwise the system has only pairwise interactions. Similarly, a biallelic <inline-formula><mml:math id="inf226"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system has (total) <inline-formula><mml:math id="inf227"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis exactly if <inline-formula><mml:math id="inf228"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>The remaining interaction coordinates of the three-locus system are<disp-formula id="equ18"><mml:math id="m18"><mml:mtable columnalign=" left right left right left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p><xref ref-type="bibr" rid="bib47">Weinreich et al. (2013)</xref> characterize epistatic interactions using Walsh coefficients, which are closely related to interaction coordinates. Specifically, the Walsh coefficients <inline-formula><mml:math id="inf229"><mml:msub><mml:mi>E</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>E</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf231"><mml:msub><mml:mi>E</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf232"><mml:msub><mml:mi>E</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula> differ from the interaction coordinates <inline-formula><mml:math id="inf233"><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf234"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf235"><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf236"><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula> only by a scalar. Here we ignore scalars, since we focus on the signs of the interactions coordinates only. It follows that all our results on interaction coordinates hold for Walsh coefficients as well.</p><sec id="s4-1-1"><title>Rank orders</title><p>We will determine the number of rank orders which imply <inline-formula><mml:math id="inf237"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. The proof depends on Catalan numbers and Dyck words (<xref ref-type="bibr" rid="bib41">Stanley, 1999</xref>). Let <inline-formula><mml:math id="inf238"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> denote the <inline-formula><mml:math id="inf239"><mml:mi>i</mml:mi></mml:math></inline-formula><sup>th</sup> Catalan number for <inline-formula><mml:math id="inf240"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, that is, <inline-formula><mml:math id="inf241"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. In particular, <inline-formula><mml:math id="inf242"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf243"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf244"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>42</mml:mn></mml:mrow></mml:math></inline-formula>. A Dyck word of length <inline-formula><mml:math id="inf245"><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> in the letters <inline-formula><mml:math id="inf246"><mml:mi>X</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf247"><mml:mi>Y</mml:mi></mml:math></inline-formula> is a string consisting of <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s and <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>n</mml:mi><mml:mspace width="thinmathspace"/><mml:mi>Y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s such that no initial segment of the string has more <inline-formula><mml:math id="inf250"><mml:mi>Y</mml:mi></mml:math></inline-formula>’s than <inline-formula><mml:math id="inf251"><mml:mi>X</mml:mi></mml:math></inline-formula>’s. For instance, the Dyck words of length <inline-formula><mml:math id="inf252"><mml:mn>4</mml:mn></mml:math></inline-formula> are <inline-formula><mml:math id="inf253"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf254"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula>. The initial segments of <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> are <inline-formula><mml:math id="inf256"><mml:mi>X</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf258"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf259"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>X</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi><mml:mo>⁢</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p><bold>Proposition 1. </bold><italic>Consider a biallelic <inline-formula><mml:math id="inf260"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus system. The number of rank orders which imply <inline-formula><mml:math id="inf261"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis is</italic><disp-formula id="equ19"><mml:math id="m19"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p><italic>Proof.</italic> There are <inline-formula><mml:math id="inf262"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:math></inline-formula> rank orders in total. Let <inline-formula><mml:math id="inf263"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> denote the fitnesses of genotypes with an even number of <inline-formula><mml:math id="inf264"><mml:mn>1</mml:mn></mml:math></inline-formula>’s in the subscripts (<inline-formula><mml:math id="inf265"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf266"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>110</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and so forth) and <inline-formula><mml:math id="inf267"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> the fitnesses of genotypes with an odd number of <inline-formula><mml:math id="inf268"><mml:mn>1</mml:mn></mml:math></inline-formula>’s, ordered in such a way that <inline-formula><mml:math id="inf269"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf271"><mml:mi>i</mml:mi></mml:math></inline-formula>. We will refer to even and odd elements from now on. Let <inline-formula><mml:math id="inf272"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> denote the interaction coordinate as defined above. Notice that <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> exactly if <inline-formula><mml:math id="inf274"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Consequently a rank order implies positive <inline-formula><mml:math id="inf275"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis (<inline-formula><mml:math id="inf276"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) when the sum <inline-formula><mml:math id="inf277"><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is positive for all fitness landscapes compatible with the rank order. It is therefore sufficient to count such rank orders.</p><p>We define a map from fitness rank orders to words in the alphabet <inline-formula><mml:math id="inf278"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> as follows: <inline-formula><mml:math id="inf279"><mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>↦</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>↦</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. For instance, the order <inline-formula><mml:math id="inf280"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is mapped to <inline-formula><mml:math id="inf281"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:math></inline-formula>. We claim that a rank order satisfies <inline-formula><mml:math id="inf282"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> exactly when it is mapped to a Dyck word (where <inline-formula><mml:math id="inf283"><mml:mi>e</mml:mi></mml:math></inline-formula> precedes <inline-formula><mml:math id="inf284"><mml:mi>o</mml:mi></mml:math></inline-formula>).</p><p>It is immediate that <inline-formula><mml:math id="inf285"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> holds if the rank order is mapped to a Dyck word. Conversely, suppose that a rank order is not mapped to a Dyck word. Let <inline-formula><mml:math id="inf286"><mml:mi>s</mml:mi></mml:math></inline-formula> be the least number such that the number of <inline-formula><mml:math id="inf287"><mml:mi>o</mml:mi></mml:math></inline-formula>’s exceeds the number of <inline-formula><mml:math id="inf288"><mml:mi>e</mml:mi></mml:math></inline-formula>’s for an initial segment of length <inline-formula><mml:math id="inf289"><mml:mi>s</mml:mi></mml:math></inline-formula> (note that <inline-formula><mml:math id="inf290"><mml:mi>s</mml:mi></mml:math></inline-formula> has to be odd in this case) and let <inline-formula><mml:math id="inf291"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></inline-formula>. Clearly one can make the sum of <inline-formula><mml:math id="inf292"><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> negative for a particular choice of <inline-formula><mml:math id="inf293"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf294"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>. By choosing the remaining numbers <inline-formula><mml:math id="inf295"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sufficiently small, we get <inline-formula><mml:math id="inf296"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, which proves the claim.</p><p>It remains to count the rank orders where <inline-formula><mml:math id="inf297"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Such rank orders are mapped to Dyck words (where <inline-formula><mml:math id="inf298"><mml:mi>e</mml:mi></mml:math></inline-formula> precedes <inline-formula><mml:math id="inf299"><mml:mi>o</mml:mi></mml:math></inline-formula>) consisting of <inline-formula><mml:math id="inf300"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>X</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s and <inline-formula><mml:math id="inf301"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="thinmathspace"/><mml:mi>Y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s. There are <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>C</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msub></mml:math></inline-formula> such Dyck words (<xref ref-type="bibr" rid="bib41">Stanley, 1999</xref>). For each word there are <inline-formula><mml:math id="inf303"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> fitness rank orders which map to the word. Indeed, one can choose the ordering of even and odd elements each in <inline-formula><mml:math id="inf304"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:math></inline-formula> different ways.</p><p>In total there are <inline-formula><mml:math id="inf305"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> fitness rank orders such that <inline-formula><mml:math id="inf306"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all landscapes. By symmetry, the same number of fitness rank orders satisfy the negative epistasis condition <inline-formula><mml:math id="inf307"><mml:mrow><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. One verifies that<disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>which completes the proof.□</p><p>A few observations in the proof of Proposition 1 are of interest. Importantly, the proof gives a computationally efficient method (linear in the number of genotypes) for checking if a rank order implies <inline-formula><mml:math id="inf308"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. Indeed, the rank order implies higher order epistasis exactly if it is mapped to a Dyck word. Moreover, the proposition states that <inline-formula><mml:math id="inf309"><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula> orders imply <inline-formula><mml:math id="inf310"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. From the proof it is clear that half of these orders imply positive <inline-formula><mml:math id="inf311"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis (<inline-formula><mml:math id="inf312"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) and the other half negative <inline-formula><mml:math id="inf313"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis (<inline-formula><mml:math id="inf314"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Also, the proof points out some symmetries. If a rank order implies epistasis, then the same is true for rank orders obtained by (i) any permutation of the even elements, (ii) any permutation of the odd elements, and (iii) the flip obtained by replacing every “<inline-formula><mml:math id="inf315"><mml:mo>&lt;</mml:mo></mml:math></inline-formula>” by “<inline-formula><mml:math id="inf316"><mml:mo>&gt;</mml:mo></mml:math></inline-formula>” in the rank order. It follows that each rank order that implies three-way epistasis belongs to a class of <inline-formula><mml:math id="inf317"><mml:mn>1152</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> elements, which differ by the operations (i)–(iii) only.</p><p><bold>Corollary 2. </bold><italic>The fraction of rank orders that imply <inline-formula><mml:math id="inf318"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis among all rank orders is</italic><disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><italic>Proof.</italic> Since the number of all rank orders is <inline-formula><mml:math id="inf319"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow></mml:math></inline-formula>, the result follows. □</p><p>The results on rank orders and epistasis for <inline-formula><mml:math id="inf320"><mml:mrow><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> are summarized in <xref ref-type="table" rid="table1">Table 1</xref>. Notice that the expression in the corollary approaches <inline-formula><mml:math id="inf321"><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:math></inline-formula> for large <inline-formula><mml:math id="inf322"><mml:mi>n</mml:mi></mml:math></inline-formula>.</p><table-wrap id="table1" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.011</object-id><label>Table 1.</label><caption><title>Numbers and fractions of rank orders that imply <inline-formula><mml:math id="inf323"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. </title></caption><table frame="hsides" rules="groups"><thead><tr><th>Loci</th><th>Rank orders</th><th>Imply epistasis</th><th>Fraction</th></tr></thead><tbody><tr><td>2</td><td>24</td><td>16</td><td><inline-formula><mml:math id="inf324"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td>3</td><td>40,320</td><td>16,128</td><td><inline-formula><mml:math id="inf325"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula></td></tr><tr><td>4</td><td>20,922,789,890,000</td><td>4,649,508,864,000</td><td><inline-formula><mml:math id="inf326"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap><p>Interestingly, no integer sequence that starts with 16, <inline-formula><mml:math id="inf327"><mml:mn>16 128</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="inf328"><mml:mi mathvariant="normal">…</mml:mi></mml:math></inline-formula> is available at <xref ref-type="bibr" rid="bib44">The On-Line Encyclopedia of Integer Sequences (2016)</xref>.</p></sec><sec id="s4-1-2"><title>Circuits</title><p>The proof of Proposition 1 depends on the map defined from the rank orders to words in the alphabet <inline-formula><mml:math id="inf329"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. We will use a generalization of the map in subsequent proofs. The starting point is a given linear form. The form determines a map from rank orders to words. Although the idea is closely related to the previous proof, we will work with positive and negative coefficients in the linear forms. For that reason, we will use <inline-formula><mml:math id="inf330"><mml:mi>P</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf331"><mml:mi>N</mml:mi></mml:math></inline-formula> rather than <inline-formula><mml:math id="inf332"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf333"><mml:mi>o</mml:mi></mml:math></inline-formula> (even and odd is no longer meaningful).</p><p>We start with a clarifying example. Assume that a given linear form has integer coefficients and that the sum of its coefficients is zero. For instance, the form<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>defines a map <inline-formula><mml:math id="inf334"><mml:msup><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula> as follows: Each of the variables <inline-formula><mml:math id="inf335"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> corresponds to the letter <inline-formula><mml:math id="inf336"><mml:mi>P</mml:mi></mml:math></inline-formula> (for positive), and the variable <inline-formula><mml:math id="inf337"><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula> corresponds to <inline-formula><mml:math id="inf338"><mml:mi>N</mml:mi></mml:math></inline-formula> (for negative). The variable <inline-formula><mml:math id="inf339"><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:math></inline-formula> corresponds to <inline-formula><mml:math id="inf340"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, because of the coefficient <inline-formula><mml:math id="inf341"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. In this case, the rank order <disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:math></disp-formula></p><p>is mapped to <inline-formula><mml:math id="inf342"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> under <inline-formula><mml:math id="inf343"><mml:msup><mml:mi>φ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>. Specifically, starting from left <inline-formula><mml:math id="inf344"><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula> corresponds to <inline-formula><mml:math id="inf345"><mml:mi>N</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf346"><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf347"><mml:mi>P</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf349"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf350"><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf351"><mml:mi>P</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf352"><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:math></inline-formula> to <inline-formula><mml:math id="inf353"><mml:mi>P</mml:mi></mml:math></inline-formula>. The remaining variables <inline-formula><mml:math id="inf354"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> do not impact the word, since their coefficients are zero for the form <inline-formula><mml:math id="inf355"><mml:mi>m</mml:mi></mml:math></inline-formula>.</p><p><bold>Definition 1. </bold>Let <inline-formula><mml:math id="inf356"><mml:mi>f</mml:mi></mml:math></inline-formula> be a linear form with integer coefficients. Assume that the sum of its coefficients is zero. Let <inline-formula><mml:math id="inf357"><mml:msup><mml:mi>φ</mml:mi><mml:mi>f</mml:mi></mml:msup></mml:math></inline-formula> denote the map from a total order on the variables (a rank order) to words in the alphabet <inline-formula><mml:math id="inf358"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> defined as follows: Each variable of <inline-formula><mml:math id="inf359"><mml:mi>f</mml:mi></mml:math></inline-formula> with a positive integer coefficient <inline-formula><mml:math id="inf360"><mml:mi>c</mml:mi></mml:math></inline-formula> corresponds to a substring of <inline-formula><mml:math id="inf361"><mml:mi>c</mml:mi></mml:math></inline-formula> letters <inline-formula><mml:math id="inf362"><mml:mi>P</mml:mi></mml:math></inline-formula>. Each variable in <inline-formula><mml:math id="inf363"><mml:mi>f</mml:mi></mml:math></inline-formula> with a negative integer coefficient <inline-formula><mml:math id="inf364"><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula> corresponds to a substring of <inline-formula><mml:math id="inf365"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> letters <inline-formula><mml:math id="inf366"><mml:mi>N</mml:mi></mml:math></inline-formula>. A rank order of the variables is mapped to the word consisting of the substrings obtained for each variable with non-zero coefficient in <inline-formula><mml:math id="inf367"><mml:mi>f</mml:mi></mml:math></inline-formula>. Specifically, the substrings (from left to right) of the word correspond to the variables in the rank order (from highest to lowest fitness).</p><p>The proof of Proposition 1 uses <inline-formula><mml:math id="inf368"><mml:mi>e</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf369"><mml:mi>o</mml:mi></mml:math></inline-formula> instead of <inline-formula><mml:math id="inf370"><mml:mi>P</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf371"><mml:mi>N</mml:mi></mml:math></inline-formula>. However, notice that the map from rank orders to words in <inline-formula><mml:math id="inf372"><mml:mi>e</mml:mi></mml:math></inline-formula>’s and <inline-formula><mml:math id="inf373"><mml:mi>o</mml:mi></mml:math></inline-formula>’s is exactly <inline-formula><mml:math id="inf374"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula> (modulo the labeling). The next result is a generalization of Proposition 1. The proof is similar in every step with the modification that <inline-formula><mml:math id="inf375"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf376"><mml:msup><mml:mi>φ</mml:mi><mml:mi>f</mml:mi></mml:msup></mml:math></inline-formula> for an arbitrary form <inline-formula><mml:math id="inf377"><mml:mi>f</mml:mi></mml:math></inline-formula>, so we omit the details.</p><p><bold>Theorem 3. </bold><italic>Let <inline-formula><mml:math id="inf378"><mml:mi>f</mml:mi></mml:math></inline-formula> be a linear form with integer coefficients. Assume that the sum of its coefficients is zero. Then a rank order implies that <inline-formula><mml:math id="inf379"><mml:mi>f</mml:mi></mml:math></inline-formula> is not zero if and only if it is mapped to a Dyck word by <inline-formula><mml:math id="inf380"><mml:msup><mml:mi>φ</mml:mi><mml:mi>f</mml:mi></mml:msup></mml:math></inline-formula>.</italic></p><p>We define additive dependence relations as linear forms that are zero for all additive landscapes. Theorem 3 applies to all additive dependence relations, because the coefficients of an additive dependence relation sum to zero. This fact explains why our Dyck word-based method applies broadly. All we require is that an epistasis measure is defined by linear forms, as any such measure is zero on additive fitness landscapes. In particular, Theorem 1 applies to <inline-formula><mml:math id="inf381"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, interaction coordinates, and circuits. However, some approaches to epistasis are of a completely different type, for instance the approach based on Shannon entropy (<xref ref-type="bibr" rid="bib24">Moore et al., 2006</xref>), in which case rank order methods may not apply.</p><p>Recall from the main text that <inline-formula><mml:math id="inf382"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is a circuit. In particular, <inline-formula><mml:math id="inf383"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all additive fitness landscapes. Moreover, <inline-formula><mml:math id="inf384"><mml:mi>a</mml:mi></mml:math></inline-formula> is minimal with this property, in the sense that no linear form in a proper subset of <inline-formula><mml:math id="inf385"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf386"><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf387"><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf388"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> equals zero for all additive landscapes. In general, circuits are defined as minimal (additive) dependence relations, in the sense that the set of <inline-formula><mml:math id="inf389"><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> which appear with non-zero coefficient is minimal with respect to inclusion.</p><p>There are <inline-formula><mml:math id="inf390"><mml:mn>20</mml:mn></mml:math></inline-formula> circuits <inline-formula><mml:math id="inf391"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> for the three-locus system (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>), namely <disp-formula id="equ24"><mml:math id="m24"><mml:mtable columnalign=" left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:mi>a</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>c</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>d</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>e</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>f</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>g</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>h</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>i</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>j</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>k</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>l</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>m</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>n</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>o</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>p</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>q</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>r</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>s</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>t</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Before describing applications of Theorem 3 in more detail, we will compare different approaches to epistasis. As already noted, interaction coordinates (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>) and Walsh coefficients of order two or more (<xref ref-type="bibr" rid="bib47">Weinreich et al., 2013</xref>) differ only by a scalar. However, circuits provide information of a different type. To see this, we consider the two circuits <disp-formula id="equ25"><mml:math id="m25"><mml:mtable columnalign=" left right left right left right left right"><mml:mtr><mml:mtd/><mml:mtd><mml:mi>a</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>b</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>which measure epistasis between the first and the second locus conditional on the third locus being fixed to 0 and 1, respectively. If <inline-formula><mml:math id="inf392"><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for a system, then <inline-formula><mml:math id="inf393"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (and the Walsh coefficient <inline-formula><mml:math id="inf394"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> as well), because <inline-formula><mml:math id="inf395"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. If, in addition, <inline-formula><mml:math id="inf396"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a large number, then the first and second loci have substantial interactions as measured by <inline-formula><mml:math id="inf397"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf398"><mml:mi>b</mml:mi></mml:math></inline-formula>, yet the interaction coordinate <inline-formula><mml:math id="inf399"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> captures only the average effect which is zero and would indicate no interaction.</p><p>Even if one knows the signs of all interaction coordinates <inline-formula><mml:math id="inf400"><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf401"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf402"><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf403"><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula>, one may still be ignorant about important gene interactions. In contrast, the signs of all 20 circuits provide a more complete description of the gene interactions from a qualitative point of view. In this sense, it is natural to say that two fitness landscapes have similar gene interactions if their circuit sign patterns agree.</p><p>One type of circuits measures conditional epistasis, and they relate to interaction coordinates in an interesting way. More precisely, conditional epistasis concerns subsystem obtained by fixing a subset of coordinates at <inline-formula><mml:math id="inf404"><mml:mn>0</mml:mn></mml:math></inline-formula> or <inline-formula><mml:math id="inf405"><mml:mn>1</mml:mn></mml:math></inline-formula> and varying the remaining loci. Conditional epistasis for an <inline-formula><mml:math id="inf406"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus subsystem agrees with the total <inline-formula><mml:math id="inf407"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis for the subsystem. In particular, the circuits <inline-formula><mml:math id="inf408"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf409"><mml:mi>b</mml:mi></mml:math></inline-formula> measure conditional epistasis. The circuit <inline-formula><mml:math id="inf410"><mml:mi>a</mml:mi></mml:math></inline-formula> measures epistasis for the two-locus subsystem of genotypes with last coordinate <inline-formula><mml:math id="inf411"><mml:mn>0</mml:mn></mml:math></inline-formula>, and the circuit <inline-formula><mml:math id="inf412"><mml:mi>b</mml:mi></mml:math></inline-formula> measures epistasis for the two-locus subsystem of genotypes with last coordinate at <inline-formula><mml:math id="inf413"><mml:mn>1</mml:mn></mml:math></inline-formula>. As mentioned, the interaction coordinate <inline-formula><mml:math id="inf414"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> is the average of <inline-formula><mml:math id="inf415"><mml:mi>a</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf416"><mml:mi>b</mml:mi></mml:math></inline-formula> (modulo a constant).</p><p>The relation between interaction coordinates and circuits is similar for larger systems. For instance, the circuit <disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>0000</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>0100</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1000</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1100</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>measures conditional epistasis for the two-locus subsystem obtained by fixing the last two coordinates at zero. The interaction coordinate <inline-formula><mml:math id="inf417"><mml:msub><mml:mi>u</mml:mi><mml:mn>1100</mml:mn></mml:msub></mml:math></inline-formula> measures the average effect of four different circuits that measure conditional epistasis. In summary, all interaction coordinates can be interpreted as averages of circuits expressing conditional epistasis.</p><p>Technically, the 20 circuits can be obtained as linear combinations of the interaction coordinates <inline-formula><mml:math id="inf418"><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf419"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf420"><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf421"><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula>. However, none of the interaction coordinates are themselves circuits, since they do not satisfy the condition of being minimal.</p><p>The circuits <inline-formula><mml:math id="inf422"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula> all measure conditional two-way epistasis between two loci when the allele at the third locus is fixed. But there are other types of circuits. The circuits <inline-formula><mml:math id="inf423"><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math></inline-formula> relate marginal epistasis of two pairs of loci, and the circuits <inline-formula><mml:math id="inf424"><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> relate the three-way interaction to the total two-way epistasis (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>).</p><p>For a given circuit, some rank orders imply that the circuit is positive, that is, the circuit is positive for all fitness values compatible with the rank order. Similarly, some rank orders imply that the circuit is negative, whereas the sign cannot be determined from other rank orders. We will use Theorem 3 to check whether a rank order determines the sign of a circuit or not.</p><p><bold>Corollary 4. </bold><italic>For the circuits <inline-formula><mml:math id="inf425"><mml:mrow><mml:mi>a</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mrow><mml:mi mathvariant="normal">…</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, two thirds of all possible rank orders determine the sign of the circuit. For the circuits <inline-formula><mml:math id="inf426"><mml:mrow><mml:mi>m</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, one half of all possible rank orders determine the sign of the circuit.</italic></p><p><italic>Proof.</italic> Fix one of the circuits from <inline-formula><mml:math id="inf427"><mml:mi>a</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf428"><mml:mi>l</mml:mi></mml:math></inline-formula> and a rank order. The circuit has exactly four variables with non-zero coefficients (for instance, for the circuit <inline-formula><mml:math id="inf429"><mml:mi>a</mml:mi></mml:math></inline-formula> the variables are <inline-formula><mml:math id="inf430"><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf431"><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf432"><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf433"><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, so that <inline-formula><mml:math id="inf434"><mml:msup><mml:mi>φ</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:math></inline-formula> maps rank orders to four-letter words). By Theorem 3, the rank order implies that the circuit differs from zero when it is mapped to one of the Dyck words <inline-formula><mml:math id="inf435"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf436"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf437"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf438"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> under <inline-formula><mml:math id="inf439"><mml:mi>φ</mml:mi></mml:math></inline-formula>, whereas the sign of the circuit is not determined when the word is <inline-formula><mml:math id="inf440"><mml:mrow><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf441"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. One concludes that the sign of a given circuit from <inline-formula><mml:math id="inf442"><mml:mi>a</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf443"><mml:mi>l</mml:mi></mml:math></inline-formula> is determined for <inline-formula><mml:math id="inf444"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> of the rank orders.</p><p>Using a similar argument, we consider words of length <inline-formula><mml:math id="inf445"><mml:mn>6</mml:mn></mml:math></inline-formula> for the circuits labeled <inline-formula><mml:math id="inf446"><mml:mi>m</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf447"><mml:mi>t</mml:mi></mml:math></inline-formula>. There are in total <inline-formula><mml:math id="inf448"><mml:mn>20</mml:mn></mml:math></inline-formula> words consisting of <inline-formula><mml:math id="inf449"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>P</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s and <inline-formula><mml:math id="inf450"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>’s. Ten of them are Dyck words. We conclude that the sign of a given circuit from <inline-formula><mml:math id="inf451"><mml:mi>m</mml:mi></mml:math></inline-formula> to <inline-formula><mml:math id="inf452"><mml:mi>t</mml:mi></mml:math></inline-formula> is determined for <inline-formula><mml:math id="inf453"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> of the rank orders. □</p><p>In general, it is not possible to decompose the word obtained for analyzing <inline-formula><mml:math id="inf454"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis into informative subunits. For example, as mentioned in the main text, the first half of the word <inline-formula><mml:math id="inf455"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="inf456"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>, and it does not appear to reveal any interesting information about the system. On the other hand, if one knows that the word <inline-formula><mml:math id="inf457"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> was obtained from the rank order<disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>010</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>111</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>110</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>101</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>100</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>001</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>000</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>then one can identify meaningful parts of the word. For instance, consider the subsystem of genotypes with last coordinate <inline-formula><mml:math id="inf458"><mml:mn>0</mml:mn></mml:math></inline-formula>. The corresponding letters (the first, third, sixth and eighth letter of the word <inline-formula><mml:math id="inf459"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>) form the four-letter word <inline-formula><mml:math id="inf460"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula>, which implies that the corresponding subsystem has sign epistasis. Moreover, there is no connection between words used for analyzing three-way epistasis and the words representing Walsh-coefficients. For instance, in order to analyze <inline-formula><mml:math id="inf461"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula> one maps the rank order above to <inline-formula><mml:math id="inf462"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula>, but the two words <inline-formula><mml:math id="inf463"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf464"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi><mml:mo>⁢</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:math></inline-formula> are unrelated.</p><p>The gene interactions for a biallelic three-locus system can be classified in terms of shapes of the fitness landscape, or triangulations of the 3-cube (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>). There are <inline-formula><mml:math id="inf465"><mml:mn>74</mml:mn></mml:math></inline-formula> shapes for the <inline-formula><mml:math id="inf466"><mml:mn>3</mml:mn></mml:math></inline-formula>-cube. The shape of the fitness landscapes is determined by the signs of the 20 circuits. It follows that rank orders provide some information about possible shapes. However, the following result shows that rank orders do not determine shapes.</p><p><bold>Proposition 5. </bold><italic>Consider a three-locus biallelic system. No rank order determines the shape of a fitness landscape.</italic></p><p><italic>Proof.</italic> The result follows from the characterization of shapes for the 3-cube in (<xref ref-type="bibr" rid="bib1">Beerenwinkel et al., 2007</xref>), where each shape is described in terms of a circuit sign pattern. We verified computationally that no rank order implies that all the circuits have the signs which describe a particular shape (<ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#analysis-of-rank-orders">https://github.com/gavruskin/fitlands#analysis-of-rank-orders</ext-link>) . More precisely, for every circuit <inline-formula><mml:math id="inf467"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>, we determined the set of all rank orders that imply that the circuit is positive or negative.</p><p>For every rank order, we then considered the circuit signs determined by the order. In no case did a rank order determine all the circuit signs necessary for describing a particular shape.□</p><p>The fact that rank orders do not determine the shape of a fitness landscape over a three-locus system is not surprising. Shapes reflect interactions in a very fine scaled way, whereas rank orders provide only coarse information.</p><p><bold>Corollary 6. </bold><italic>For each of the interaction coordinates <inline-formula><mml:math id="inf468"><mml:msub><mml:mi>u</mml:mi><mml:mn mathvariant="normal">110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf469"><mml:msub><mml:mi>u</mml:mi><mml:mn mathvariant="normal">101</mml:mn></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf470"><mml:msub><mml:mi>u</mml:mi><mml:mn mathvariant="normal">011</mml:mn></mml:msub></mml:math></inline-formula>, the number of rank orders which determines its sign is 16,128.</italic></p><p><italic>Proof.</italic> The linear form for each interaction coordinate consists of <inline-formula><mml:math id="inf471"><mml:mn>8</mml:mn></mml:math></inline-formula> elements, <inline-formula><mml:math id="inf472"><mml:mn>4</mml:mn></mml:math></inline-formula> with positive signs and <inline-formula><mml:math id="inf473"><mml:mn>4</mml:mn></mml:math></inline-formula> with negative signs. Notice that <inline-formula><mml:math id="inf474"><mml:mrow><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:math></inline-formula> rank orders imply three-way epistasis, by Proposition 1. By Theorem 3 the problem can be reduced to counting Dyck words of length <inline-formula><mml:math id="inf475"><mml:mn>8</mml:mn></mml:math></inline-formula>. It follows that the number of rank orders is <inline-formula><mml:math id="inf476"><mml:mrow><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:math></inline-formula> for each interaction coordinate.□</p><p>Note that the sign of a given interaction coordinate is determined for <inline-formula><mml:math id="inf477"><mml:mrow><mml:mn>16</mml:mn><mml:mo>,</mml:mo><mml:mn>128</mml:mn></mml:mrow></mml:math></inline-formula> out of <inline-formula><mml:math id="inf478"><mml:mrow><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>320</mml:mn></mml:mrow></mml:math></inline-formula> rank orders, that is <inline-formula><mml:math id="inf479"><mml:mrow><mml:mn>2</mml:mn><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> or all rank orders. As mentioned, the Walsh coefficients <inline-formula><mml:math id="inf480"><mml:msub><mml:mi>E</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf481"><mml:msub><mml:mi>E</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf482"><mml:msub><mml:mi>E</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula> differ from the interaction coordinates <inline-formula><mml:math id="inf483"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf484"><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf485"><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula> only by a scalar, so that Corollary 6 applies to the coefficients as well.</p></sec><sec id="s4-1-3"><title>Partial orders and fitness graphs</title><p>We now consider partial orders, for instance,<disp-formula id="equ28"><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>111</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>110</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>101</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>011</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>for a three-locus system. Arguing as in the proof of Proposition 1, the (unknown) total order is mapped to the word <inline-formula><mml:math id="inf486"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> under <inline-formula><mml:math id="inf487"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>, where <inline-formula><mml:math id="inf488"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> is some permutation of <inline-formula><mml:math id="inf489"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi></mml:mrow></mml:math></inline-formula>. For any such permutation we get a Dyck word. It follows that the system has three-way epistasis. This condition can be stated and proved in a more general form.</p><p><bold>Proposition 7. </bold><italic>Consider an <inline-formula><mml:math id="inf490"><mml:mi>n</mml:mi></mml:math></inline-formula>-locus biallelic system. Let <inline-formula><mml:math id="inf491"><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf492"><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> be defined as in the proof of Proposition 1. If there exists a partition of the total set of fitness values into pairs <inline-formula><mml:math id="inf493"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo mathvariant="normal">,</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf494"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo mathvariant="normal">&gt;</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for all <inline-formula><mml:math id="inf495"><mml:mi>i</mml:mi></mml:math></inline-formula>, then one can conclude <inline-formula><mml:math id="inf496"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis. By symmetry, the same is true for a partition where <inline-formula><mml:math id="inf497"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo mathvariant="normal">&lt;</mml:mo><mml:msub><mml:mi>o</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for each pair.</italic></p><p><italic>Proof.</italic> We will verify that the existence of a partition as described is equivalent to the order being mapped to a Dyck word under the map <inline-formula><mml:math id="inf498"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>. It is immediate that the existence of such a partition implies that the order is mapped to a Dyck word. Conversely, if the rank order is mapped to a Dyck word under <inline-formula><mml:math id="inf499"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>, then one can construct a partition as follows. One pair in the partition corresponds to the first <inline-formula><mml:math id="inf500"><mml:mi>e</mml:mi></mml:math></inline-formula> and the first <inline-formula><mml:math id="inf501"><mml:mi>o</mml:mi></mml:math></inline-formula> in the Dyck word, a second pair corresponds to the second <inline-formula><mml:math id="inf502"><mml:mi>e</mml:mi></mml:math></inline-formula> and the second <inline-formula><mml:math id="inf503"><mml:mi>o</mml:mi></mml:math></inline-formula> in the word, and so forth. This partition has the desired property.□</p><p>A fitness graph is a directed acyclic graph where each node represents a genotype, and arrows connect each pair of mutational neighbors, directed toward the node representing the genotype of higher fitness. Moreover, fitness graphs are structured so that the node labeled <inline-formula><mml:math id="inf504"><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is at the bottom, genotypes with exactly one <inline-formula><mml:math id="inf505"><mml:mn>1</mml:mn></mml:math></inline-formula> on the level above, and so forth (see <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>Our systematic analysis of fitness graphs takes advantage of the fact that some graphs are isomorphic, that is, there exists an edge preserving bijection between the nodes of the graphs. In biological terms, an isomorphism can be considered a relabeling of the genotypes such that mutational neighbors stay neighbors and the direction of arrows indicating higher fitness is preserved. For example, <xref ref-type="fig" rid="fig5">Figure 5</xref> shows two isomorphic fitness graphs.</p><p>The analysis of the two-locus case is straightforward. An arbitrary fitness graph is isomorphic to a graph where <inline-formula><mml:math id="inf506"><mml:mn>00</mml:mn></mml:math></inline-formula> has the lowest fitness. There are four fitness graphs satisfying the assumption. Indeed, two of the arrows point up, so that there are in total <inline-formula><mml:math id="inf507"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula> possible fitness graphs depending on the directions of the remaining arrows (<xref ref-type="fig" rid="fig3">Figure 3</xref>). By inspection, two of the graphs in the figure are isomorphic. Consequently, there are three different fitness graphs for two-locus systems up to isomorphism.</p><p>Some fitness graphs imply epistasis, whereas other fitness graphs are compatible with additive fitness. As illustrated in the two-locus case, a fitness graph is compatible with additive fitness if all arrows point up, that is toward a higher level. More generally, a fitness graph implies epistasis unless it is isomorphic to a graph where all arrows point up. Indeed, the graph implies sign epistasis unless such an isomorphism exists. (<xref ref-type="bibr" rid="bib48">Weinreich et al., 2005</xref>; <xref ref-type="bibr" rid="bib6">Crona et al., 2013</xref>).</p><p>Accordingly, we can characterize rank orders that are compatible with fitness graphs with all arrows up. After relabeling genotypes, we can assume that the genotype <inline-formula><mml:math id="inf508"><mml:mrow><mml:mn>0</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>⁢</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> has the lowest fitness in the system. Then a rank order is compatible with a fitness graph with all arrows up, exactly if for each genotype replacing <inline-formula><mml:math id="inf509"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> by <inline-formula><mml:math id="inf510"><mml:mn>1</mml:mn></mml:math></inline-formula> results in higher fitness. For instance, <inline-formula><mml:math id="inf511"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is compatible with such a graph whereas the rank order <inline-formula><mml:math id="inf512"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is not.</p><p>If <inline-formula><mml:math id="inf513"><mml:mn>000</mml:mn></mml:math></inline-formula> has the lowest fitness in the system, one can verify that exactly 48 rank orders are compatible with the fitness graph with all arrows up. It follows that in total <inline-formula><mml:math id="inf514"><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo><mml:mn>48</mml:mn></mml:mrow><mml:mo>=</mml:mo><mml:mn>384</mml:mn></mml:mrow></mml:math></inline-formula> rank orders are compatible with such graphs since there are eight genotypes in a three-locus system, each of which can have lowest fitness.</p><p>Interestingly, the same result can be obtained from theory on house-of-cards landscapes. Since all rank orders are equally likely under this statistical fitness landscape model, the fraction of rank orders that imply sign epistasis agrees with the probability of sign epistasis. This probability is <inline-formula><mml:math id="inf515"><mml:mfrac><mml:mn>104</mml:mn><mml:mn>105</mml:mn></mml:mfrac></mml:math></inline-formula> (Schmiegelt and Krug 2014, <xref ref-type="table" rid="table2">Table 2</xref>). It follows that <inline-formula><mml:math id="inf516"><mml:mrow><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">!</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>105</mml:mn></mml:mfrac></mml:mrow><mml:mo>=</mml:mo><mml:mn>384</mml:mn></mml:mrow></mml:math></inline-formula> rank orders are compatible with fitness graphs with all arrows up, that is, the total number of rank orders multiplied by the fraction of rank orders compatible with such graphs.</p><p>As we have already seen, rank orders have potential far beyond detecting whether or not there is epistasis in a system. The same is true for fitness graphs, and we proceed with higher order interactions. In order to analyze fitness graphs and three-way epistasis, we consider the set of rank orders compatible with a given fitness graphs. For instance, the fitness graph in <xref ref-type="fig" rid="fig10">Figure 10</xref> is compatible with the following two rank orders:<disp-formula id="equ29"><label>(5)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>111</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>110</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>101</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>011</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ30"><label>(6)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>000</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>111</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>010</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>001</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>110</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>101</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mn>011</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The first order implies three-way epistasis (it is mapped to <inline-formula><mml:math id="inf517"><mml:mrow><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> under <inline-formula><mml:math id="inf518"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>) and the second does not (it is mapped to <inline-formula><mml:math id="inf519"><mml:mrow><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math></inline-formula> under <inline-formula><mml:math id="inf520"><mml:msup><mml:mi>φ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msup></mml:math></inline-formula>). We conclude that in this case, the fitness graph does not imply higher order epistasis. However, if every rank order compatible with the fitness graph implies higher order epistasis, then the fitness graph itself does imply higher order epistasis. More generally, the same observation holds for any partial order.</p><fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.012</object-id><label>Figure 10.</label><caption><title>All 54 fitness graph types.</title><p>Those depicted in red imply three-way epistasis.</p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-28629-fig10-v1"/></fig><p><bold>Remark. </bold><italic>A partial order implies higher order epistasis exactly if all its total extensions imply higher order epistasis.</italic></p><p>Indeed, if all total extensions imply higher order epistasis, then in particular the (unknown) rank order does. The converse holds by definition.</p><p>Consequently, one can in principle determine if a fitness graph implies higher order epistasis by checking all of the compatible rank orders. For a systematic study of the three-locus case, it is convenient to reduce the problem to isomorphic graphs. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows two isomorphic fitness graphs.</p><p>As mentioned in the main text, there are in total <inline-formula><mml:math id="inf521"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>862</mml:mn></mml:mrow></mml:math></inline-formula> fitness graphs for three-locus systems, and the number of fitness graphs that imply higher order epistasis is <inline-formula><mml:math id="inf522"><mml:mn>698</mml:mn></mml:math></inline-formula> (37 percent). Up to isomorphism there are in total <inline-formula><mml:math id="inf523"><mml:mn>54</mml:mn></mml:math></inline-formula> fitness graphs, and <inline-formula><mml:math id="inf524"><mml:mn>20</mml:mn></mml:math></inline-formula> graphs imply higher order epistasis. This result was verified by reducing the study of all <inline-formula><mml:math id="inf525"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>862</mml:mn></mml:mrow></mml:math></inline-formula> graphs for three-locus systems to a non-redundant list of 54 graphs, such that no two graphs in the list are isomorphic. The fact that the total number of graphs is <inline-formula><mml:math id="inf526"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>862</mml:mn></mml:mrow></mml:math></inline-formula> follows from general theory on acyclic graphs (<xref ref-type="bibr" rid="bib42">Stanley, 2006</xref>), or can be verified computationally (see below).</p><p>Isomorphisms between three-locus systems have a geometric interpretation. The fitness graph can be regarded as a three-dimensional cube, with vertices corresponding to genotypes and edges corresponding to arrows. The group of isomorphisms (see below) then corresponds to the symmetry group of the three dimensional cube (<xref ref-type="bibr" rid="bib5">Coxeter, 1973</xref>). Indeed, it was by way of this equivalence that we carried out the enumeration described above.</p><p>For clarity, we give a more explicit description of the cube isomorphisms. Any isomorphism can be constructed as a composition of the following two transformations: (i) interchange of labels of the pair of alleles at a locus, and (ii) change of order of the loci in the bitstring representation of a genotype. There are in total forty-eight isomorphisms of the cube, including the identity transformation which leaves the cube unchanged. <xref ref-type="fig" rid="fig5">Figure 5</xref> is an example of such a transformation, where at the first locus the labels 0 and 1 have been swapped, and the second and third loci have been interchanged. The code used for verifying the isomorphisms is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/devingreene/3-cube-partial-order-count.git">https://github.com/devingreene/3-cube-partial-order-count.git</ext-link>.</p><p>A cube has 12 edges, so that the total number graphs on the cube (graphs similar to fitness graphs, but cycles are allowed) is <inline-formula><mml:math id="inf527"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>12</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>4096</mml:mn></mml:mrow></mml:math></inline-formula>. After exclusion of graphs with cycles, <inline-formula><mml:math id="inf528"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>862</mml:mn></mml:mrow></mml:math></inline-formula> graphs remain. An arbitrary graph is isomorphic to a graph where <inline-formula><mml:math id="inf529"><mml:mn>000</mml:mn></mml:math></inline-formula> has the lowest fitness. This relabeling reduces the number of graphs one has to consider substantially, as in the two-locus case. The list of remaining graphs can be reduced further using the isomorphisms described above to finally obtain 54 graphs (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p></sec><sec id="s4-1-4"><title>Graph theoretical aspects</title><p>As mentioned in the main text, the <inline-formula><mml:math id="inf530"><mml:mn>20</mml:mn></mml:math></inline-formula> graphs which imply higher order epistasis (see <xref ref-type="fig" rid="fig6">Figure 6</xref>) constitute a diverse category. We analyzed the category from a graph theoretical point of view, but could not see that the graphs have any property which singles them out.</p><p>Recall that a unique sink orientation is a graph where each face has no more than one sink. Equivalently, there is no subsystems with reciprocal sign epistasis (<xref ref-type="bibr" rid="bib6">Crona et al., 2013</xref>; <xref ref-type="bibr" rid="bib30">Poelwijk et al., 2007</xref>). The category of 20 graphs includes unique sink orientations (also called USO or AOF graph s), as well as non-USO’s. Moreover, in the terminology of <xref ref-type="bibr" rid="bib17">Gärtner and Kaibel, 1998</xref>, the category includes separable and non-separable graphs, as well as realizable and non-realizable graphs.</p><p>There were some indications of higher complexity for the category, but only in a statistical sense. Indeed, as can be verified from <xref ref-type="fig" rid="fig6">Figure 6</xref>, the graphs in the category have on average 1.8 sinks (a sink corresponds to a peak in the landscape), whereas the average number of sinks for all graphs is 1.6. Moreover, <inline-formula><mml:math id="inf531"><mml:mn>5</mml:mn></mml:math></inline-formula> out of the <inline-formula><mml:math id="inf532"><mml:mn>20</mml:mn></mml:math></inline-formula> graphs (25 percent) in the category are unique sink orientations, whereas in total <inline-formula><mml:math id="inf533"><mml:mn>19</mml:mn></mml:math></inline-formula> out of the <inline-formula><mml:math id="inf534"><mml:mn>54</mml:mn></mml:math></inline-formula> graphs (35 percent) are unique sink orientations.</p><p>Even though the category of fitness graphs which implies epistasis is diverse, it is still possible that a characterization exists. This is an open problem.</p></sec></sec><sec id="s4-2"><title>Software and HIV-1 study</title><p>We have implemented algorithms based on our theoretical results in an open source software package (<ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands#fitlands">https://github.com/gavruskin/fitlands#fitlands</ext-link>). The package provides software for detecting gene interactions as described in the main text for two- and three-locus systems. Furthermore, algorithms for detecting total <inline-formula><mml:math id="inf535"><mml:mi>n</mml:mi></mml:math></inline-formula>-way epistasis, three- and four-way interaction coordinates and three-way circuit interactions have been implemented. The documentation also explains how to reproduce results for our application to HIV-1 data described in the main text.</p><p>The results of Student’s t-test explained in the main text are summarized in <xref ref-type="table" rid="table1">Table 1</xref>, and for related code see <ext-link ext-link-type="uri" xlink:href="https://github.com/gavruskin/fitlands/blob/master/HIV_2007_conventional_analysis.ipynb">https://github.com/gavruskin/fitlands/blob/master/HIV_2007_conventional_analysis.ipynb</ext-link></p><table-wrap id="table2" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.013</object-id><label>Table 2.</label><caption><title>Comparison of the rank order method with t-test.</title><p>The first column lists the four interaction coordinates and twenty circuits. The second column shows p-values returned by Student’s t-test based on fitness measurements. The third column shows which interactions are significant based on 0.03 threshold and their signs. For comparison, the last column displays the results obtained from rank order methods.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Interaction</th><th>p-value</th><th>Result</th><th>From rank order</th></tr></thead><tbody><tr><td><inline-formula><mml:math id="inf536"><mml:msub><mml:mi>u</mml:mi><mml:mn>011</mml:mn></mml:msub></mml:math></inline-formula></td><td>1.13e-31</td><td><inline-formula><mml:math id="inf537"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf538"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf539"><mml:msub><mml:mi>u</mml:mi><mml:mn>101</mml:mn></mml:msub></mml:math></inline-formula></td><td>2.67e-12</td><td><inline-formula><mml:math id="inf540"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf541"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf542"><mml:msub><mml:mi>u</mml:mi><mml:mn>110</mml:mn></mml:msub></mml:math></inline-formula></td><td>1.20e-24</td><td><inline-formula><mml:math id="inf543"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf544"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf545"><mml:msub><mml:mi>u</mml:mi><mml:mn>111</mml:mn></mml:msub></mml:math></inline-formula></td><td>1.50e-29</td><td><inline-formula><mml:math id="inf546"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf547"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf548"><mml:mi>a</mml:mi></mml:math></inline-formula></td><td>7.10e-16</td><td><inline-formula><mml:math id="inf549"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf550"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf551"><mml:mi>b</mml:mi></mml:math></inline-formula></td><td>5.23e-32</td><td><inline-formula><mml:math id="inf552"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf553"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf554"><mml:mi>c</mml:mi></mml:math></inline-formula></td><td>7.62e-04</td><td><inline-formula><mml:math id="inf555"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf556"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf557"><mml:mi>d</mml:mi></mml:math></inline-formula></td><td>8.36e-68</td><td><inline-formula><mml:math id="inf558"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf559"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf560"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>1.39e-38</td><td><inline-formula><mml:math id="inf561"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf562"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf563"><mml:mi>f</mml:mi></mml:math></inline-formula></td><td>2.59e-01</td><td><inline-formula><mml:math id="inf564"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf565"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf566"><mml:mi>g</mml:mi></mml:math></inline-formula></td><td>3.10e-59</td><td><inline-formula><mml:math id="inf567"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf568"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf569"><mml:mi>h</mml:mi></mml:math></inline-formula></td><td>2.22e-02</td><td><inline-formula><mml:math id="inf570"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf571"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf572"><mml:mi>i</mml:mi></mml:math></inline-formula></td><td>7.97e-05</td><td><inline-formula><mml:math id="inf573"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf574"><mml:mn>0</mml:mn></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf575"><mml:mi>j</mml:mi></mml:math></inline-formula></td><td>2.20e-32</td><td><inline-formula><mml:math id="inf576"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf577"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf578"><mml:mi>k</mml:mi></mml:math></inline-formula></td><td>1.96e-05</td><td><inline-formula><mml:math id="inf579"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf580"><mml:mn>0</mml:mn></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf581"><mml:mi>l</mml:mi></mml:math></inline-formula></td><td>7.50e-51</td><td><inline-formula><mml:math id="inf582"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf583"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf584"><mml:mi>m</mml:mi></mml:math></inline-formula></td><td>4.88e-07</td><td><inline-formula><mml:math id="inf585"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf586"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf587"><mml:mi>n</mml:mi></mml:math></inline-formula></td><td>9.87e-37</td><td><inline-formula><mml:math id="inf588"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf589"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf590"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>8.83e-03</td><td><inline-formula><mml:math id="inf591"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf592"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf593"><mml:mi>p</mml:mi></mml:math></inline-formula></td><td>7.18e-19</td><td><inline-formula><mml:math id="inf594"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf595"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf596"><mml:mi>q</mml:mi></mml:math></inline-formula></td><td>1.94e-01</td><td><inline-formula><mml:math id="inf597"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf598"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf599"><mml:mi>r</mml:mi></mml:math></inline-formula></td><td>5.02e-50</td><td><inline-formula><mml:math id="inf600"><mml:mo>+</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf601"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf602"><mml:mi>s</mml:mi></mml:math></inline-formula></td><td>7.10e-27</td><td><inline-formula><mml:math id="inf603"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf604"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf605"><mml:mi>t</mml:mi></mml:math></inline-formula></td><td>8.49e-61</td><td><inline-formula><mml:math id="inf606"><mml:mo>-</mml:mo></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf607"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr></tbody></table></table-wrap><table-wrap id="table3" position="float"><object-id pub-id-type="doi">10.7554/eLife.28629.014</object-id><label>Table 3.</label><caption><title>Data from (<xref ref-type="bibr" rid="bib11">Franke et al., 2011</xref>) on a 5-locus system determined by the mutations <italic>fwnA1</italic>, <italic>argH12</italic>, <italic>pyrA5</italic>, <italic>leuA1</italic>, and <italic>pheA1</italic>.</title><p>We consider 5-way epistasis for the system. The first column lists the ranking of the genotypes, where ”?” means missing measurement. The eighth column indicates whether the genotype is odd or even. The ninth and tenth columns show the cumulative number of <inline-formula><mml:math id="inf608"><mml:mi mathsize="111%">o</mml:mi></mml:math></inline-formula>’s and <inline-formula><mml:math id="inf609"><mml:mi mathsize="111%">e</mml:mi></mml:math></inline-formula>’s, respectively. The last column indicates whether the number of <inline-formula><mml:math id="inf610"><mml:mi mathsize="111%">o</mml:mi></mml:math></inline-formula>’s exceeds the number of <inline-formula><mml:math id="inf611"><mml:mi mathsize="111%">e</mml:mi></mml:math></inline-formula>’s (<inline-formula><mml:math id="inf612"><mml:mo mathsize="111%" stretchy="false">-</mml:mo></mml:math></inline-formula>) or vice versa (<inline-formula><mml:math id="inf613"><mml:mo mathsize="111%" stretchy="false">+</mml:mo></mml:math></inline-formula>). We see that if genotype <inline-formula><mml:math id="inf614"><mml:mn mathsize="111%">11101</mml:mn></mml:math></inline-formula> has higher fitness than genotype <inline-formula><mml:math id="inf615"><mml:mn mathsize="111%">10011</mml:mn></mml:math></inline-formula>, genotypes <inline-formula><mml:math id="inf616"><mml:mrow><mml:mn mathsize="111%">11000</mml:mn><mml:mo mathsize="111%" stretchy="false">,</mml:mo><mml:mn mathsize="111%">10010</mml:mn></mml:mrow></mml:math></inline-formula> are ranked arbitrarily, the missing genotype <inline-formula><mml:math id="inf617"><mml:mn mathsize="111%">10111</mml:mn></mml:math></inline-formula> has rank <inline-formula><mml:math id="inf618"><mml:mrow><mml:mn mathsize="111%">1</mml:mn><mml:mo mathsize="111%" stretchy="false">-</mml:mo><mml:mn mathsize="111%">15</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf619"><mml:mn mathsize="111%">11010</mml:mn></mml:math></inline-formula> rank <inline-formula><mml:math id="inf620"><mml:mrow><mml:mn mathsize="111%">20</mml:mn><mml:mo mathsize="111%" stretchy="false">-</mml:mo><mml:mn mathsize="111%">32</mml:mn></mml:mrow></mml:math></inline-formula>, then the last column would change to all +’s, so the rank order would imply <inline-formula><mml:math id="inf621"><mml:mrow><mml:msub><mml:mi mathsize="111%">u</mml:mi><mml:mn mathsize="111%">11111</mml:mn></mml:msub><mml:mo mathsize="111%" stretchy="false">&gt;</mml:mo><mml:mn mathsize="111%">0</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Rank</th><th>fwn</th><th>arg</th><th>pyr</th><th>leu</th><th>phe</th><th>#mutations</th><th><inline-formula><mml:math id="inf622"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>/<break/><inline-formula><mml:math id="inf623"><mml:mi>e</mml:mi></mml:math></inline-formula></th><th>#<inline-formula><mml:math id="inf624"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> cumul.</th><th>#<inline-formula><mml:math id="inf625"><mml:mi>e</mml:mi></mml:math></inline-formula> cumul.</th><th>neg. vs <break/>pos.</th></tr></thead><tbody><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td><inline-formula><mml:math id="inf626"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>0</td><td>1</td><td>+</td></tr><tr><td>2</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>2</td><td><inline-formula><mml:math id="inf627"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></td><td>0</td><td>2</td><td>+</td></tr><tr><td>3</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf628"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>1</td><td>2</td><td>+</td></tr><tr><td>4</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>2</td><td><inline-formula><mml:math id="inf629"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>1</td><td>3</td><td>+</td></tr><tr><td>5</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>4</td><td><inline-formula><mml:math id="inf630"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>1</td><td>4</td><td>+</td></tr><tr><td>6 (or 7)</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf631"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>1</td><td>5</td><td>+</td></tr><tr><td>7 (or 6)</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf632"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>1</td><td>6</td><td>+</td></tr><tr><td>8</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td><inline-formula><mml:math id="inf633"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>2</td><td>6</td><td>+</td></tr><tr><td>9</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>3</td><td><inline-formula><mml:math id="inf634"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>3</td><td>6</td><td>+</td></tr><tr><td>10</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td><inline-formula><mml:math id="inf635"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>4</td><td>6</td><td>+</td></tr><tr><td>11</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf636"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>5</td><td>6</td><td>+</td></tr><tr><td>12</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf637"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>5</td><td>7</td><td>+</td></tr><tr><td>13</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td><inline-formula><mml:math id="inf638"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>6</td><td>7</td><td>+</td></tr><tr><td>14</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td><inline-formula><mml:math id="inf639"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>7</td><td>7</td><td>+</td></tr><tr><td>15</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf640"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>8</td><td>7</td><td><inline-formula><mml:math id="inf641"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td>16</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf642"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>8</td><td>8</td><td>+</td></tr><tr><td>17</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf643"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>9</td><td>8</td><td><inline-formula><mml:math id="inf644"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td>18 (or 19)</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>4</td><td><inline-formula><mml:math id="inf645"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>9</td><td>9</td><td><inline-formula><mml:math id="inf646"><mml:mo>+</mml:mo></mml:math></inline-formula></td></tr><tr><td>19 (or 18)</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf647"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>10</td><td>9</td><td><inline-formula><mml:math id="inf648"><mml:mo>-</mml:mo></mml:math></inline-formula></td></tr><tr><td>20</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>2</td><td><inline-formula><mml:math id="inf649"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>10</td><td>10</td><td>+</td></tr><tr><td>21</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf650"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>10</td><td>11</td><td>+</td></tr><tr><td>22</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>2</td><td><inline-formula><mml:math id="inf651"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>10</td><td>12</td><td>+</td></tr><tr><td>23</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td><inline-formula><mml:math id="inf652"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>11</td><td>12</td><td>+</td></tr><tr><td>24</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>4</td><td><inline-formula><mml:math id="inf653"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>11</td><td>13</td><td>+</td></tr><tr><td>25</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>3</td><td><inline-formula><mml:math id="inf654"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>12</td><td>13</td><td>+</td></tr><tr><td>26</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>2</td><td><inline-formula><mml:math id="inf655"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>12</td><td>14</td><td>+</td></tr><tr><td>27</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>3</td><td><inline-formula><mml:math id="inf656"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>13</td><td>14</td><td>+</td></tr><tr><td>28</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>4</td><td><inline-formula><mml:math id="inf657"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>13</td><td>15</td><td>+</td></tr><tr><td>29</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>5</td><td><inline-formula><mml:math id="inf658"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>14</td><td>15</td><td>+</td></tr><tr><td>30</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>3</td><td><inline-formula><mml:math id="inf659"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>15</td><td>15</td><td>+</td></tr><tr><td>?</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>3</td><td><inline-formula><mml:math id="inf660"><mml:mi>o</mml:mi></mml:math></inline-formula></td><td>?</td><td>?</td><td>?</td></tr><tr><td>?</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>4</td><td><inline-formula><mml:math id="inf661"><mml:mi>e</mml:mi></mml:math></inline-formula></td><td>?</td><td>?</td><td>?</td></tr></tbody></table></table-wrap></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>KC would like to thank Mr Dong Zhou for his study on published malaria data. We thank the reviewers for their comments, in particular regarding house-of-cards landscapes. This work was done in part while the authors were visiting the Simons Institute for the Theory of Computing.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Project administration, Writing—review and editing, Project design; Mathematical proofs</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.28629.015</object-id><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-28629-transrepform-v1.docx"/></supplementary-material></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name><name><surname>Pachter</surname> <given-names>L</given-names></name><name><surname>Sturmfels</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Epistasis and shapes of fitness landscapes</article-title><source>Statistica Sinica</source><volume>17</volume><fpage>1317</fpage><lpage>1342</lpage></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bershtein</surname> <given-names>S</given-names></name><name><surname>Segal</surname> <given-names>M</given-names></name><name><surname>Bekerman</surname> <given-names>R</given-names></name><name><surname>Tokuriki</surname> <given-names>N</given-names></name><name><surname>Tawfik</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Robustness-epistasis link shapes the fitness landscape of a randomly drifting protein</article-title><source>Nature</source><volume>444</volume><fpage>929</fpage><lpage>932</lpage><pub-id pub-id-type="doi">10.1038/nature05385</pub-id><pub-id pub-id-type="pmid">17122770</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonhoeffer</surname> <given-names>S</given-names></name><name><surname>Chappey</surname> <given-names>C</given-names></name><name><surname>Parkin</surname> <given-names>NT</given-names></name><name><surname>Whitcomb</surname> <given-names>JM</given-names></name><name><surname>Petropoulos</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Evidence for positive epistasis in HIV-1</article-title><source>Science</source><volume>306</volume><fpage>1547</fpage><lpage>1550</lpage><pub-id pub-id-type="doi">10.1126/science.1101786</pub-id><pub-id pub-id-type="pmid">15567861</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costanzo</surname> <given-names>M</given-names></name><name><surname>Baryshnikova</surname> <given-names>A</given-names></name><name><surname>Bellay</surname> <given-names>J</given-names></name><name><surname>Kim</surname> <given-names>Y</given-names></name><name><surname>Spear</surname> <given-names>ED</given-names></name><name><surname>Sevier</surname> <given-names>CS</given-names></name><name><surname>Ding</surname> <given-names>H</given-names></name><name><surname>Koh</surname> <given-names>JL</given-names></name><name><surname>Toufighi</surname> <given-names>K</given-names></name><name><surname>Mostafavi</surname> <given-names>S</given-names></name><name><surname>Prinz</surname> <given-names>J</given-names></name><name><surname>St Onge</surname> <given-names>RP</given-names></name><name><surname>VanderSluis</surname> <given-names>B</given-names></name><name><surname>Makhnevych</surname> <given-names>T</given-names></name><name><surname>Vizeacoumar</surname> <given-names>FJ</given-names></name><name><surname>Alizadeh</surname> <given-names>S</given-names></name><name><surname>Bahr</surname> <given-names>S</given-names></name><name><surname>Brost</surname> <given-names>RL</given-names></name><name><surname>Chen</surname> <given-names>Y</given-names></name><name><surname>Cokol</surname> <given-names>M</given-names></name><name><surname>Deshpande</surname> <given-names>R</given-names></name><name><surname>Li</surname> <given-names>Z</given-names></name><name><surname>Lin</surname> <given-names>ZY</given-names></name><name><surname>Liang</surname> <given-names>W</given-names></name><name><surname>Marback</surname> <given-names>M</given-names></name><name><surname>Paw</surname> <given-names>J</given-names></name><name><surname>San Luis</surname> <given-names>BJ</given-names></name><name><surname>Shuteriqi</surname> <given-names>E</given-names></name><name><surname>Tong</surname> <given-names>AH</given-names></name><name><surname>van Dyk</surname> <given-names>N</given-names></name><name><surname>Wallace</surname> <given-names>IM</given-names></name><name><surname>Whitney</surname> <given-names>JA</given-names></name><name><surname>Weirauch</surname> <given-names>MT</given-names></name><name><surname>Zhong</surname> <given-names>G</given-names></name><name><surname>Zhu</surname> <given-names>H</given-names></name><name><surname>Houry</surname> <given-names>WA</given-names></name><name><surname>Brudno</surname> <given-names>M</given-names></name><name><surname>Ragibizadeh</surname> <given-names>S</given-names></name><name><surname>Papp</surname> <given-names>B</given-names></name><name><surname>Pál</surname> <given-names>C</given-names></name><name><surname>Roth</surname> <given-names>FP</given-names></name><name><surname>Giaever</surname> <given-names>G</given-names></name><name><surname>Nislow</surname> <given-names>C</given-names></name><name><surname>Troyanskaya</surname> <given-names>OG</given-names></name><name><surname>Bussey</surname> <given-names>H</given-names></name><name><surname>Bader</surname> <given-names>GD</given-names></name><name><surname>Gingras</surname> <given-names>AC</given-names></name><name><surname>Morris</surname> <given-names>QD</given-names></name><name><surname>Kim</surname> <given-names>PM</given-names></name><name><surname>Kaiser</surname> <given-names>CA</given-names></name><name><surname>Myers</surname> <given-names>CL</given-names></name><name><surname>Andrews</surname> <given-names>BJ</given-names></name><name><surname>Boone</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>The genetic landscape of a cell</article-title><source>Science</source><volume>327</volume><fpage>425</fpage><lpage>431</lpage><pub-id pub-id-type="doi">10.1126/science.1180823</pub-id><pub-id pub-id-type="pmid">20093466</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coxeter</surname> <given-names>HSM</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>Regular polytopes</article-title><source>Courier Corporation</source></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Crona</surname> <given-names>K</given-names></name><name><surname>Greene</surname> <given-names>D</given-names></name><name><surname>Barlow</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The peaks and geometry of fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>317</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2012.09.028</pub-id><pub-id pub-id-type="pmid">23036916</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Crona</surname> <given-names>K</given-names></name><name><surname>Luo</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Higher order epistasis and fitness peaks</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1708.02063">https://arxiv.org/abs/1708.02063</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Crow</surname> <given-names>JF</given-names></name><name><surname>Kimura</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1970">1970</year><source>An Introduction to Population Genetics Theory</source><publisher-loc>New York</publisher-loc><publisher-name>Harper and Row</publisher-name></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>da Silva</surname> <given-names>J</given-names></name><name><surname>Coetzer</surname> <given-names>M</given-names></name><name><surname>Nedellec</surname> <given-names>R</given-names></name><name><surname>Pastore</surname> <given-names>C</given-names></name><name><surname>Mosier</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Fitness epistasis and constraints on adaptation in a human immunodeficiency virus type 1 protein region</article-title><source>Genetics</source><volume>185</volume><fpage>293</fpage><lpage>303</lpage><pub-id pub-id-type="doi">10.1534/genetics.109.112458</pub-id><pub-id pub-id-type="pmid">20157005</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Empirical fitness landscapes and the predictability of evolution</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>480</fpage><lpage>490</lpage><pub-id pub-id-type="doi">10.1038/nrg3744</pub-id><pub-id pub-id-type="pmid">24913663</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franke</surname> <given-names>J</given-names></name><name><surname>Klözer</surname> <given-names>A</given-names></name><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Evolutionary accessibility of mutational pathways</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1002134</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002134</pub-id><pub-id pub-id-type="pmid">21876664</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gong</surname> <given-names>LI</given-names></name><name><surname>Suchard</surname> <given-names>MA</given-names></name><name><surname>Bloom</surname> <given-names>JD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title><source>eLife</source><volume>2</volume><elocation-id>e00631</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id><pub-id pub-id-type="pmid">23682315</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goulart</surname> <given-names>CP</given-names></name><name><surname>Mahmudi</surname> <given-names>M</given-names></name><name><surname>Crona</surname> <given-names>KA</given-names></name><name><surname>Jacobs</surname> <given-names>SD</given-names></name><name><surname>Kallmann</surname> <given-names>M</given-names></name><name><surname>Hall</surname> <given-names>BG</given-names></name><name><surname>Greene</surname> <given-names>DC</given-names></name><name><surname>Barlow</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Designing antibiotic cycling strategies by determining and understanding local adaptive landscapes</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e56040</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0056040</pub-id><pub-id pub-id-type="pmid">23418506</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greene</surname> <given-names>D</given-names></name><name><surname>Crona</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The changing geometry of a fitness landscape along an adaptive walk</article-title><source>PLoS Computational Biology</source><volume>10</volume><elocation-id>e1003520</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003520</pub-id><pub-id pub-id-type="pmid">24853069</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Grimaldi</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Discrete and Combinatorial Mathematics, 5/e</source><publisher-name>Pearson Education India</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname> <given-names>A</given-names></name><name><surname>Adami</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Strong Selection Significantly Increases Epistatic Interactions in the Long-Term Evolution of a Protein</article-title><source>PLoS Genetics</source><volume>12</volume><elocation-id>e1005960</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pgen.1005960</pub-id><pub-id pub-id-type="pmid">27028897</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Gärtner</surname> <given-names>B</given-names></name><name><surname>Kaibel</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Abstract Objective Function Graphs on the 3-Cube: A Classification by Realizability</source><publisher-name>University of Cologne</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hallgrímsdóttir</surname> <given-names>IB</given-names></name><name><surname>Yuster</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A complete classification of epistatic two-locus models</article-title><source>BMC Genetics</source><volume>9</volume><elocation-id>17</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2156-9-17</pub-id><pub-id pub-id-type="pmid">18284682</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huggins</surname> <given-names>P</given-names></name><name><surname>Pachter</surname> <given-names>L</given-names></name><name><surname>Sturmfels</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Toward the human genotope</article-title><source>Bulletin of Mathematical Biology</source><volume>69</volume><fpage>2723</fpage><lpage>2735</lpage><pub-id pub-id-type="doi">10.1007/s11538-007-9244-7</pub-id><pub-id pub-id-type="pmid">17874271</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname> <given-names>AI</given-names></name><name><surname>Dinh</surname> <given-names>DM</given-names></name><name><surname>Schneider</surname> <given-names>D</given-names></name><name><surname>Lenski</surname> <given-names>RE</given-names></name><name><surname>Cooper</surname> <given-names>TF</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title><source>Science</source><volume>332</volume><fpage>1193</fpage><lpage>1196</lpage><pub-id pub-id-type="doi">10.1126/science.1203801</pub-id><pub-id pub-id-type="pmid">21636772</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knies</surname> <given-names>JL</given-names></name><name><surname>Cai</surname> <given-names>F</given-names></name><name><surname>Weinreich</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Enzyme Efficiency but Not Thermostability Drives Cefotaxime Resistance Evolution in TEM-1 β-Lactamase</article-title><source>Molecular Biology and Evolution</source><volume>34</volume><fpage>1040</fpage><lpage>1054</lpage><pub-id pub-id-type="doi">10.1093/molbev/msx053</pub-id><pub-id pub-id-type="pmid">28087769</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Lienkaemper</surname> <given-names>C</given-names></name><name><surname>Lamberti</surname> <given-names>L</given-names></name><name><surname>Drain</surname> <given-names>J</given-names></name><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name><name><surname>Gavryushkin</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The geometry of partial fitness orders and an efficient method for detecting genetic interactions</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/180976</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mira</surname> <given-names>PM</given-names></name><name><surname>Crona</surname> <given-names>K</given-names></name><name><surname>Greene</surname> <given-names>D</given-names></name><name><surname>Meza</surname> <given-names>JC</given-names></name><name><surname>Sturmfels</surname> <given-names>B</given-names></name><name><surname>Barlow</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Rational design of antibiotic treatment plans: a treatment strategy for managing evolution and reversing resistance</article-title><source>PLoS One</source><volume>10</volume><elocation-id>e0122283</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0122283</pub-id><pub-id pub-id-type="pmid">25946134</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moore</surname> <given-names>JH</given-names></name><name><surname>Gilbert</surname> <given-names>JC</given-names></name><name><surname>Tsai</surname> <given-names>CT</given-names></name><name><surname>Chiang</surname> <given-names>FT</given-names></name><name><surname>Holden</surname> <given-names>T</given-names></name><name><surname>Barney</surname> <given-names>N</given-names></name><name><surname>White</surname> <given-names>BC</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A flexible computational framework for detecting, characterizing, and interpreting statistical patterns of epistasis in genetic studies of human disease susceptibility</article-title><source>Journal of Theoretical Biology</source><volume>241</volume><fpage>252</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2005.11.036</pub-id><pub-id pub-id-type="pmid">16457852</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neidhart</surname> <given-names>J</given-names></name><name><surname>Szendro</surname> <given-names>IG</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Exact results for amplitude spectra of fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>332</volume><fpage>218</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2013.05.002</pub-id><pub-id pub-id-type="pmid">23685065</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nichol</surname> <given-names>D</given-names></name><name><surname>Jeavons</surname> <given-names>P</given-names></name><name><surname>Fletcher</surname> <given-names>AG</given-names></name><name><surname>Bonomo</surname> <given-names>RA</given-names></name><name><surname>Maini</surname> <given-names>PK</given-names></name><name><surname>Paul</surname> <given-names>JL</given-names></name><name><surname>Gatenby</surname> <given-names>RA</given-names></name><name><surname>Anderson</surname> <given-names>AR</given-names></name><name><surname>Scott</surname> <given-names>JG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Steering Evolution with Sequential Therapy to Prevent the Emergence of Bacterial Antibiotic Resistance</article-title><source>PLoS Computational Biology</source><volume>11</volume><elocation-id>e1004493</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004493</pub-id><pub-id pub-id-type="pmid">26360300</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogbunugafor</surname> <given-names>CB</given-names></name><name><surname>Hartl</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A pivot mutation impedes reverse evolution across an adaptive landscape for drug resistance in Plasmodium vivax</article-title><source>Malaria Journal</source><volume>15</volume><elocation-id>40</elocation-id><pub-id pub-id-type="doi">10.1186/s12936-016-1090-3</pub-id><pub-id pub-id-type="pmid">26809718</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogbunugafor</surname> <given-names>CB</given-names></name><name><surname>Wylie</surname> <given-names>CS</given-names></name><name><surname>Diakite</surname> <given-names>I</given-names></name><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Hartl</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adaptive landscape by environment interactions dictate evolutionary dynamics in models of drug resistance</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1004710</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004710</pub-id><pub-id pub-id-type="pmid">26808374</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orr</surname> <given-names>HA</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Fitness and its role in evolutionary genetics</article-title><source>Nature Reviews Genetics</source><volume>10</volume><fpage>531</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1038/nrg2603</pub-id><pub-id pub-id-type="pmid">19546856</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Kiviet</surname> <given-names>DJ</given-names></name><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Tans</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Empirical fitness landscapes reveal accessible evolutionary paths</article-title><source>Nature</source><volume>445</volume><fpage>383</fpage><lpage>386</lpage><pub-id pub-id-type="doi">10.1038/nature05451</pub-id><pub-id pub-id-type="pmid">17251971</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poelwijk</surname> <given-names>FJ</given-names></name><name><surname>Tănase-Nicola</surname> <given-names>S</given-names></name><name><surname>Kiviet</surname> <given-names>DJ</given-names></name><name><surname>Tans</surname> <given-names>SJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Reciprocal sign epistasis is a necessary condition for multi-peaked fitness landscapes</article-title><source>Journal of Theoretical Biology</source><volume>272</volume><fpage>141</fpage><lpage>144</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2010.12.015</pub-id><pub-id pub-id-type="pmid">21167837</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poon</surname> <given-names>AF</given-names></name><name><surname>Chao</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Functional origins of fitness effect-sizes of compensatory mutations in the DNA bacteriophage phiX174</article-title><source>Evolution; International Journal of Organic Evolution</source><volume>60</volume><fpage>2032</fpage><lpage>2043</lpage><pub-id pub-id-type="pmid">17133860</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sailer</surname> <given-names>ZR</given-names></name><name><surname>Harms</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Detecting high-order epistasis in nonlinear genotype-phenotype maps</article-title><source>Genetics</source><volume>205</volume><fpage>1079</fpage><lpage>1088</lpage><pub-id pub-id-type="doi">10.1534/genetics.116.195214</pub-id><pub-id pub-id-type="pmid">28100592</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sailer</surname> <given-names>ZR</given-names></name><name><surname>Harms</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>High-order epistasis shapes evolutionary trajectories</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005541</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005541</pub-id><pub-id pub-id-type="pmid">28505183</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanjuán</surname> <given-names>R</given-names></name><name><surname>Cuevas</surname> <given-names>JM</given-names></name><name><surname>Moya</surname> <given-names>A</given-names></name><name><surname>Elena</surname> <given-names>SF</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Epistasis and the adaptability of an RNA virus</article-title><source>Genetics</source><volume>170</volume><fpage>1001</fpage><lpage>1008</lpage><pub-id pub-id-type="doi">10.1534/genetics.105.040741</pub-id><pub-id pub-id-type="pmid">15879507</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanjuán</surname> <given-names>R</given-names></name><name><surname>Moya</surname> <given-names>A</given-names></name><name><surname>Elena</surname> <given-names>SF</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The distribution of fitness effects caused by single-nucleotide substitutions in an RNA virus</article-title><source>PNAS</source><volume>101</volume><fpage>8396</fpage><lpage>8401</lpage><pub-id pub-id-type="doi">10.1073/pnas.0400146101</pub-id><pub-id pub-id-type="pmid">15159545</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanjuán</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mutational fitness effects in RNA and single-stranded DNA viruses: common patterns revealed by site-directed mutagenesis studies</article-title><source>Philosophical Transactions of the Royal Society B: Biological Sciences</source><volume>365</volume><fpage>1975</fpage><lpage>1982</lpage><pub-id pub-id-type="doi">10.1098/rstb.2010.0063</pub-id><pub-id pub-id-type="pmid">20478892</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segal</surname> <given-names>MR</given-names></name><name><surname>Barbour</surname> <given-names>JD</given-names></name><name><surname>Grant</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Relating HIV-1 Sequence Variation to Replication Capacity via Trees and Forests</article-title><source>Statistical Applications in Genetics and Molecular Biology</source><volume>3</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.2202/1544-6115.1031</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seifert</surname> <given-names>D</given-names></name><name><surname>Di Giallonardo</surname> <given-names>F</given-names></name><name><surname>Metzner</surname> <given-names>KJ</given-names></name><name><surname>Günthard</surname> <given-names>HF</given-names></name><name><surname>Beerenwinkel</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A framework for inferring fitness landscapes of patient-derived viruses using quasispecies theory</article-title><source>Genetics</source><volume>199</volume><fpage>191</fpage><lpage>203</lpage><pub-id pub-id-type="doi">10.1534/genetics.114.172312</pub-id><pub-id pub-id-type="pmid">25406469</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>M</given-names></name><name><surname>Cobey</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fitness landscapes reveal simple strategies for steering evolution to minimize antibiotic resistance</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/093153</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Stanley</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="1999">1999</year><source>Enumerative combinatorics</source><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name><volume>2</volume><pub-id pub-id-type="doi">10.1017/CBO9780511609589</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stanley</surname> <given-names>RP</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Acyclic orientations of graphs</article-title><source>Discrete Mathematics</source><volume>306</volume><fpage>905</fpage><lpage>909</lpage><pub-id pub-id-type="doi">10.1016/j.disc.2006.03.010</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szendro</surname> <given-names>IG</given-names></name><name><surname>Schenk</surname> <given-names>MF</given-names></name><name><surname>Franke</surname> <given-names>J</given-names></name><name><surname>Krug</surname> <given-names>J</given-names></name><name><surname>de Visser</surname> <given-names>JAGM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantitative analyses of empirical fitness landscapes</article-title><source>Journal of Statistical Mechanics: Theory and Experiment</source><volume>2013</volume><fpage>P01005</fpage><pub-id pub-id-type="doi">10.1088/1742-5468/2013/01/P01005</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="web"><person-group person-group-type="author"><collab>The On-Line Encyclopedia of Integer Sequences</collab></person-group><year iso-8601-date="2016">2016</year><article-title>The On-Line Encyclopedia of Integer Sequences</article-title><ext-link ext-link-type="uri" xlink:href="https://oeis.org/">https://oeis.org/</ext-link><date-in-citation iso-8601-date="2016">19, 08 2016</date-in-citation></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname> <given-names>WH</given-names></name><name><surname>Hemani</surname> <given-names>G</given-names></name><name><surname>Haley</surname> <given-names>CS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Detecting epistasis in human complex traits</article-title><source>Nature Reviews Genetics</source><volume>15</volume><fpage>722</fpage><lpage>733</lpage><pub-id pub-id-type="doi">10.1038/nrg3747</pub-id><pub-id pub-id-type="pmid">25200660</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Delaney</surname> <given-names>NF</given-names></name><name><surname>Depristo</surname> <given-names>MA</given-names></name><name><surname>Hartl</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Darwinian evolution can follow only very few mutational paths to fitter proteins</article-title><source>Science</source><volume>312</volume><fpage>111</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1126/science.1123539</pub-id><pub-id pub-id-type="pmid">16601193</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Lan</surname> <given-names>Y</given-names></name><name><surname>Wylie</surname> <given-names>CS</given-names></name><name><surname>Heckendorn</surname> <given-names>RB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Should evolutionary geneticists worry about higher-order epistasis?</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>23</volume><fpage>700</fpage><lpage>707</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2013.10.007</pub-id><pub-id pub-id-type="pmid">24290990</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weinreich</surname> <given-names>DM</given-names></name><name><surname>Watson</surname> <given-names>RA</given-names></name><name><surname>Chao</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Perspective: Sign epistasis and genetic constraint on evolutionary trajectories</article-title><source>Evolution</source><volume>59</volume><fpage>1165</fpage><lpage>1174</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb01768.x</pub-id><pub-id pub-id-type="pmid">16050094</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1932">1932</year><article-title>The roles of mutation, inbreeding, crossbreeding, and selection in evolution</article-title><source>Proc 6th Int. Cong. Genet</source><volume>1</volume><fpage>356</fpage><lpage>366</lpage></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname> <given-names>NC</given-names></name><name><surname>Dai</surname> <given-names>L</given-names></name><name><surname>Olson</surname> <given-names>CA</given-names></name><name><surname>Lloyd-Smith</surname> <given-names>JO</given-names></name><name><surname>Sun</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adaptation in protein fitness landscapes is facilitated by indirect paths</article-title><source>eLife</source><volume>5</volume><elocation-id>e16965</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.16965</pub-id><pub-id pub-id-type="pmid">27391790</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wylie</surname> <given-names>CS</given-names></name><name><surname>Shakhnovich</surname> <given-names>EI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A biophysical protein folding model accounts for most mutational fitness effects in viruses</article-title><source>PNAS</source><volume>108</volume><fpage>9916</fpage><lpage>9921</lpage><pub-id pub-id-type="doi">10.1073/pnas.1017572108</pub-id><pub-id pub-id-type="pmid">21610162</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.28629.017</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Weinreich</surname><given-names>Dan</given-names></name><role>Reviewing Editor</role><aff><institution>Brown University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Inferring Genetic Interactions From Comparative Fitness Data&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Aviv Regev (Senior Editor) and three reviewers, one of whom, Dan Weinreich (Reviewer #1), is a member of our Board of Reviewing Editors. The following individuals involved in review of your submission have agreed to reveal their identity: Joachim Krug (Reviewer #2).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This is an important contribution to a very, very challenging problem: how to assess fitness interactions (epistasis) from data. The tremendous challenge derives from the exponentially large size of the problem: to fully characterize all epistasis among n mutations requires experimental measurements for all genotype defined by every combination of the mutations. And this number grows exponentially in n. Here, the authors demonstrate that much can be learned from much smaller datasets containing information only on the sign of a subset of the differences in fitness among genotypes. Their fundamental result depends on a new connection between this rank order information and a mathematical object called a Dyck word. Apart from the practical utility of the formalism presented in this manuscript, it also provides a new perspective on the geometry of high-dimensional genotypic fitness landscapes. This is thus a very innovative contribution to a highly active field with a broad potential significance.</p><p>However, several substantial concerns have been raised that must be resolved before the manuscript can be accepted.</p><p>Essential revisions:</p><p>1) Quite importantly, you appear to have misunderstood the concept of sign epistasis as it was introduced in 2005 by Weinreich, Watson and Chao. As a consequence, you underestimate the significance of this concept for your own approach and fail to properly place your work into context. You claim twice (Introduction, tenth paragraph and Discussion, sixth paragraph) that the concept of sign epistasis &quot;refers to the two-locus system&quot; and that your approach generalizes this concept to any number of loci. This is incorrect. Sign epistasis means that the (fitness) effect of a mutation at a locus can be positive or negative depending on the state of other loci (the genetic background), and this definition applies in full generality to any number of loci. Moreover, the definition evidently only relies on the rank order of genotype fitness values. It thus seems that this implies that sign epistatic interactions are exactly those that can, in principle, be inferred from rank order information: In the presence of sign epistasis the rank order is not consistent with an additive landscape.</p><p>This is evident in the two-locus example, where the red and blue rank orders in <xref ref-type="fig" rid="fig1">Figure 1</xref> are precisely those that display sign epistasis. It is well known from studies of 'house-of-cards' fitness landscapes (where fitness values are independent, identically distributed random variables) that the probability for a pair of loci to display sign epistasis is 2/3 [see e.g. Schmiegelt and Krug, J. Stat. Phys. 2014]. Since all rank orders are equally likely under this model, this is then also the fraction of rank orders that imply sign epistasis. For three loci the fraction of sign-epistatic landscapes is already 104/105 [this follows from <xref ref-type="table" rid="table2">Table 2</xref> of the paper by Schmiegelt and Krug: For sign-epistatic landscapes the number of accessible paths is less than 6, which is true with probability 104/105]. If the conjecture formulated above is correct, it follows that only 40320/105=384 rank orders are not informative about any kind of epistatic interaction (3-way epistasis, circuits or interaction coordinates). This should be easy for you to check.</p><p>Related to this, the discussion of fitness graphs that are compatible with additive fitness in the subsection “1.3. Partial orders and fitness graphs” of Mathematical framework and proofs is somewhat misleading, as it gives the impression that this characterization was first derived by Crona et al. 2013. In fact, the proof that all paths to the global maximum are accessible in a landscape without sign epistasis (which implies that all arrows in the fitness graph point up) was first given by Weinreich et al. 2005.</p><p>2) Another critical point comes in the subsection “Three-locus case”: given the Dyck word for a 3-bit rank ordering, how does one pick out the three 2-bit Dyck words to assess the presence of each of the pairwise epistases? The information must be present in the longer word, and this point seems to be a tremendous, missed opportunity. And of course, such an algorithm for dissecting sub-Dyck words should be generalized to the n-locus case. After all, current thinking on higher-order epistasis focuses not only on the highest-order component but all 2^n – n – 1 components. Such dissections should also be illustrated with the empirical data analyzed here.</p><p>3) Another commonly used framework for the characterization of fitness landscapes is the Fourier-Walsh decomposition. Again, the relevance of this framework for your approach is evident – e.g., the criterion for n-way epistasis simply implies that the highest order Walsh coefficient is nonzero; the 'interaction coordinates' are proportional to Walsh coefficients; and it seems (but perhaps not) that also the 'circuits' are essentially linear combinations of Walsh coefficients. Nevertheless, the precise relation between the two approaches remains obscure to the reader. Walsh coefficients are mentioned in the main text as if the reader were assumed to know about them, but when they finally are defined on the first page of the Materials and methods, the term does not even appear. You need to explain the concept and its relation to your approach in the main text; the repeated references to Beerenwinkel et al. 2007 are not sufficient in this respect.</p><p>(Incidentally, that the criterion for n-way epistasis simply implies that the nth-order Walsh coefficient is nonzero may suggest a direct and elegant path to dissect out the lower-order effects – see the previous point.)</p><p>4) The discussion related to fitness proxies in the Introduction is somewhat muddled and confusing. Clearly the analysis presented can be applied to any scalar trait, not just fitness, and for any such trait the method will be able to detect only those components of epistasis that are invariant under monotonic transformations (which preserve rank ordering; indeed, you acknowledge this point in the second-to-last paragraph of your Conclusions). In the terminology of Weinreich et al. 2005, the method can detect sign epistasis but not magnitude epistasis. Thus for example, in the fourth paragraph of the Introduction is a statement about non-linearity in the phenotype-&gt;fitness map, not a statement about epistasis per se. This should be corrected. See also the eighth paragraph of the Introduction.</p><p>To what extent magnitude epistasis (which may of course contribute to Walsh coefficients of arbitrary order and hence also give rise to n-way epistasis) can be removed by the choice of a suitable nonlinear scale and/or of a suitable fitness proxy is a separate issue that has recently been addressed systematically by Sailer and Harms in the cited Genetics paper (see also Szendro et al., JSTAT 2013 and Neidhart, Szendro, Krug, JTB 2013 for similar discussion and evidence for high-order epistasis). Introducing the distinction between sign and magnitude epistasis early on in the Introduction would help to clarify this point.</p><p>And perhaps of related interest here, Knies and Weinreich 2017 Molecular Biology and Evolution 34(5):1040-1054 demonstrate that comparatively small epistatic terms can still induce sufficient sign epistasis to dramatically reduce the number of selectively accessible trajectories.</p><p>5) Subsection “General n-locus case”, last paragraph: as written one is left with the sense that the github implementation can only handle n = 3. Is that correct? To be useful to the community it should work for arbitrary n (up to run-time consequences). Please clarify, and if there's a good reason why the code can't handle arbitrary n, please explain. This would be a very serious limitation to the importance of the work.</p><p>6) Finally, a consolidated and more complete development of the utility of the work for the community of end users should be added. The field has probably moved beyond the simple question &quot;Is there higher-order epistasis?&quot; but for example, can these methods help focus the experimentalist on particular subsets of mutations that exhibit anomalous interactions for further mechanistic attention? (The holy grail would of course be if you could offer even some speculation or intuition for how rank orders could contribute to the thorny problem of capturing epistasis in GWAS studies.) Some material in this vein is presently provided in the –tenth paragraph of the Introduction and in the fourth paragraph of the subsection “Analysis of empirical fitness data”, but a tremendous opportunity to more fully capitalize on the breadth of readership remains.</p><p>This line of thinking may also suggest a modified and more broadly engaging title.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Inferring Genetic Interactions From Comparative Fitness Data&quot; for further consideration at <italic>eLife</italic>. Your revised article has been evaluated by Aviv Regev as the Senior Editor and Dan Weinreich as the Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance. Chiefly, we are not yet entirely satisfied with the response to Essential revision 1: some of the statements regarding the relation between the established concept of sign epistasis and the framework presented here are, at least, misleading. In the tenth paragraph of the Introduction you say that yours is &quot;a more general approach&quot; compared to the concept of sign epistasis. This is misleading, because any instance of epistasis captured by your approach is also an instance of sign epistasis; in this sense the new approach is a refinement rather than a generalization. This is clearly stated as: &quot;Importantly, if a rank order implies that the sign of an additive dependence relation, such as a circuit or an interaction coordinate, is determined, then the system has sign epistasis.&quot; This key statement should be made (in a suitable form) in the Introduction. Similarly, you say that Weinreich et al. (2005) introduced the term sign epistasis &quot;for bialellic two-locus systems&quot;, whereas in fact this work considered arbitrary multilocus systems. In the following sentence you claim that sign epistasis &quot;is a special case of rank order-induced epistasis&quot;, which is again incorrect, because any case of rank order-induced epistasis implies sign epistasis for at least one pair of loci.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.28629.018</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Quite importantly, you appear to have misunderstood the concept of sign epistasis as it was introduced in 2005 by Weinreich, Watson and Chao. As a consequence, you underestimate the significance of this concept for your own approach and fail to properly place your work into context. You claim twice (Introduction, tenth paragraph and Discussion, sixth paragraph) that the concept of sign epistasis &quot;refers to the two-locus system&quot; and that your approach generalizes this concept to any number of loci. This is incorrect. Sign epistasis means that the (fitness) effect of a mutation at a locus can be positive or negative depending on the state of other loci (the genetic background), and this definition applies in full generality to any number of loci. Moreover, the definition evidently only relies on the rank order of genotype fitness values. It thus seems that this implies that sign epistatic interactions are exactly those that can, in principle, be inferred from rank order information: In the presence of sign epistasis the rank order is not consistent with an additive landscape.</p><p>[...]</p><p>Related to this, the discussion of fitness graphs that are compatible with additive fitness in the subsection “1.3. Partial orders and fitness graphs” of Mathematical framework and proofs is somewhat misleading, as it gives the impression that this characterization was first derived by Crona et al. 2013. In fact, the proof that all paths to the global maximum are accessible in a landscape without sign epistasis (which implies that all arrows in the fitness graph point up) was first given by Weinreich et al. 2005.</p></disp-quote><p>We recognize that the concept of sign epistasis applies to any number of loci. However, sign epistasis for a general system can be identified from 2-locus subsystems, whereas in our approach, the smallest meaningful subsystems are usually larger. In that sense we have extended the perspective to any number of loci. In fact, any epistasis concept that can be expressed in terms of a linear equation has a signed, i.e., a rank order-induced, correspondence. One can ask if a system has signed n-way epistasis, signed circuits, or signed Walsh coefficients. Clearly, sign epistasis was the first concept of this type and we have clarified and emphasized the connection in the Introduction, Results, and Discussion.</p><p>We are very grateful for the comment on the 384 rank orders that are not informative about any kind of epistatic interaction based on the Schmiegelt and Krug (2014) paper. We have included this observation in the last paragraph of the subsection “Two-locus case” and the argument in Section 1.3 of the Materials and methods.</p><p>We have also added the Weinreich et al. (2005) reference to the discussion on additive fitness and fitness graphs as suggested (Materials and methods, subsection “1.3. Partial orders and fitness graphs”, seventh paragraph).</p><disp-quote content-type="editor-comment"><p>2) Another critical point comes in the subsection “Three-locus case”: given the Dyck word for a 3-bit rank ordering, how does one pick out the three 2-bit Dyck words to assess the presence of each of the pairwise epistases? The information must be present in the longer word, and this point seems to be a tremendous, missed opportunity. And of course, such an algorithm for dissecting sub-Dyck words should be generalized to the n-locus case. After all, current thinking on higher-order epistasis focuses not only on the highest-order component but all 2^n – n – 1 components. Such dissections should also be illustrated with the empirical data analyzed here.</p></disp-quote><p>This is an interesting question. Unfortunately, the substrings of the word under consideration do, in general, not reveal information about interactions in the corresponding subsystem. Similarly, there is no obvious connection between the word used for analyzing three-way epistasis and the words representing Walsh-coefficients. We illustrate this point by way of a small example in the Results (subsection “General n-locus case”, seventh paragraph) and Materials and methods.</p><disp-quote content-type="editor-comment"><p>3) Another commonly used framework for the characterization of fitness landscapes is the Fourier-Walsh decomposition. Again, the relevance of this framework for your approach is evident – e.g., the criterion for n-way epistasis simply implies that the highest order Walsh coefficient is nonzero; the 'interaction coordinates' are proportional to Walsh coefficients; and it seems (but perhaps not) that also the 'circuits' are essentially linear combinations of Walsh coefficients. Nevertheless, the precise relation between the two approaches remains obscure to the reader. Walsh coefficients are mentioned in the main text as if the reader were assumed to know about them, but when they finally are defined on the first page of the Materials and methods, the term does not even appear. You need to explain the concept and its relation to your approach in the main text; the repeated references to Beerenwinkel et al. 2007 are not sufficient in this respect.</p><p>(Incidentally, that the criterion for n-way epistasis simply implies that the nth-order Walsh coefficient is nonzero may suggest a direct and elegant path to dissect out the lower-order effects – see the previous point.)</p></disp-quote><p>We have clarified the relation between interaction coordinates and Walsh coefficients in the fourth paragraph of Mathematical framework and proofs. As we only care about the sign of (any type of) interaction here, all statements about interaction coordinates hold for the corresponding Walsh coefficients as well. We did not see a direct path to dissect lower-order effects in this manner. We have also added a more detailed discussion on interaction coordinates and Walsh coefficients versus circuits in the Results, subsection “General n-locus case”, and Mathematical framework and proofs, subsection “1.2. Circuits”.</p><disp-quote content-type="editor-comment"><p>4) The discussion related to fitness proxies in the Introduction is somewhat muddled and confusing. Clearly the analysis presented can be applied to any scalar trait, not just fitness, and for any such trait the method will be able to detect only those components of epistasis that are invariant under monotonic transformations (which preserve rank ordering; indeed, you acknowledge this point in the second-to-last paragraph of your Conclusions). In the terminology of Weinreich et al. 2005, the method can detect sign epistasis but not magnitude epistasis. Thus for example, in the fourth paragraph of the Introduction is a statement about non-linearity in the phenotype-&gt;fitness map, not a statement about epistasis per se. This should be corrected. See also the eighth paragraph of the Introduction.</p><p>[…]</p><p>And perhaps of related interest here, Knies and Weinreich 2017 Molecular Biology and Ev1olution 34(5):1040-1054 demonstrate that comparatively small epistatic terms can still induce sufficient sign epistasis to dramatically reduce the number of selectively accessible trajectories.</p></disp-quote><p>Thank you for mentioning these additional references, which we have integrated into the Introduction, seventh paragraph. The sentence “Although it is possible to study epistasis of the proxy phenotype, additive proxy data does not in general imply absence of epistasis with respect to fitness” does not assume a phenotype-fitness map. It only says that from no epistasis in the proxy landscape one can, in general, not conclude no epistasis in the fitness landscape. To clarify this, we have removed the previous sentence and have rewritten the sentence above as follows: “Although it is possible to study epistasis of the proxy data, in general, presence or absence of epistasis in the proxy landscape does not imply presence or absence of epistasis in the fitness landscape.” avoiding the term “proxy phenotype”.</p><disp-quote content-type="editor-comment"><p>5) Subsection “General n-locus case”, last paragraph: as written one is left with the sense that the github implementation can only handle n = 3. Is that correct? To be useful to the community it should work for arbitrary n (up to run-time consequences). Please clarify, and if there's a good reason why the code can't handle arbitrary n, please explain. This would be a very serious limitation to the importance of the work.</p></disp-quote><p>Our implementation can handle the case of arbitrary <italic>n</italic>. We have rewritten the text accordingly (subsection “General <italic>n</italic>-locus case”, last paragraph). The GitHub repository contains a detailed technical description (https://github.com/gavruskin/fitlands/blob/master/Four-way_interaction_coordinates_and_total_n-way_interaction.ipynb).</p><disp-quote content-type="editor-comment"><p>6) Finally, a consolidated and more complete development of the utility of the work for the community of end users should be added. The field has probably moved beyond the simple question &quot;Is there higher-order epistasis?&quot; but for example, can these methods help focus the experimentalist on particular subsets of mutations that exhibit anomalous interactions for further mechanistic attention? (The holy grail would of course be if you could offer even some speculation or intuition for how rank orders could contribute to the thorny problem of capturing epistasis in GWAS studies.) Some material in this vein is presently provided in the –tenth paragraph of the Introduction and in the fourth paragraph of the subsection “Analysis of empirical fitness data”, but a tremendous opportunity to more fully capitalize on the breadth of readership remains.</p><p>This line of thinking may also suggest a modified and more broadly engaging title.</p></disp-quote><p>We have added a discussion on how our methods may contribute to detecting epistasis in GWAS (Discussion, eighth paragraph). We do not believe that these remarks justify a more broadly engaging title and would prefer to leave it unchanged.</p><p>[Editors' note: further revisions were requested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance. Chiefly, we are not yet entirely satisfied with the response to Essential revision 1: some of the statements regarding the relation between the established concept of sign epistasis and the framework presented here are, at least, misleading. In the tenth paragraph of the Introduction you say that yours is &quot;a more general approach&quot; compared to the concept of sign epistasis. This is misleading, because any instance of epistasis captured by your approach is also an instance of sign epistasis; in this sense the new approach is a refinement rather than a generalization. This is clearly stated as: &quot;Importantly, if a rank order implies that the sign of an additive dependence relation, such as a circuit or an interaction coordinate, is determined, then the system has sign epistasis.&quot; This key statement should be made (in a suitable form) in the Introduction. Similarly, you say that Weinreich et al. (2005) introduced the term sign epistasis &quot;for bialellic two-locus systems&quot;, whereas in fact this work considered arbitrary multilocus systems. In the following sentence you claim that sign epistasis &quot;is a special case of rank order-induced epistasis&quot;, which is again incorrect, because any case of rank order-induced epistasis implies sign epistasis for at least one pair of loci.</p></disp-quote><p>Indeed, rank order induced interactions, or signed interactions, are conceptually related to sign epistasis. There is a potential for theoretical advances on signed interactions, similar to published results on global peaks and sign epistasis. We have emphasized these facts more in the revised version. However, the exact relationship between the concept of sign epistasis and the class of signed interactions we consider here is rather involved, but the detailed exposition of this relationship goes beyond the scope of this paper and will be explored in future work.</p><p>Actions:</p><p>The manuscript has been revised accordingly. We have also removed the text that can be misinterpreted regarding sign epistasis and two-locus system. Specifically, the following changes have been made:</p><p>1) New text:</p><p>“Here, we develop a related approach based on rank orders that applies to higher order epistasis as well as other measures of gene interactions. […] The theory of sign epistasis stands as a model for development in the area, and there is a potential for understanding global properties of fitness landscapes in terms of (local) signed interactions, similar to results for sign epistasis.”</p><p>Deleted text:</p><p>“Here, we develop a more general approach that applies to higher order epistasis as well as other measures of gene interactions. […] Similarly, one can consider signed versions of other types of gene interactions.”</p><p>2) Deleted text:</p><p>“Importantly, if a rank order implies that the sign of an additive dependence relation, such as a circuit or an interaction coordinates, is determined, then the system has sign epistasis.”</p><p>3) New text:</p><p>“This distinction was pointed out by Weinreich, Watson, and Chao (2005) who introduced the term sign epistasis. […] Rank order-induced gene interactions of any type can thus be regarded as analogues to sign epistasis.”</p><p>Deleted text:</p><p>“This distinction was pointed out for biallelic two-locus systems by Weinreich, Watson, and Chao (2005) who introduced the term sign epistasis. […] Rank order-induced gene interactions of any type can thus be regarded as analogues to sign epistasis, and this new concept is meaningful in a broader context.”</p><p>4) New text:</p><p>“A very useful feature of sign epistasis is that one can identify, or rule out, sign epistasis in a system from inspection of two-locus subsystems only.”</p><p>Deleted text:</p><p>“A very useful feature of sign epistasis is that one can identify, or rule out, sign epistasis from inspection of two-locus subsystems only.”</p><p>5) Further revisions related to this issue:</p><p>New text:</p><p>“If the genotype 00 has minimal fitness in the system, then rank orders are compatible with graph (a) exactly if they satisfy this property. […] In particular, only 384 out of (2<sup>3</sup>)! = 40,320 rank orders are compatible with fitness graphs with all arrows up (after relabeling) for the three-locus system, which we consider next (Meterials and methods, Section 1.3).”</p><p>Several changes have been made after “More generally, a fitness graph implies epistasis unless it is isomorphic to a graph with all arrows up”. In most cases “additive fitness” has been replace by “fitness graphs with all arrows up”, or similarly.</p></body></sub-article></article>