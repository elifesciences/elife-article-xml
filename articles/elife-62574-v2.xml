<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">62574</article-id><article-id pub-id-type="doi">10.7554/eLife.62574</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Theory for the optimal detection of time-varying signals in cellular sensing systems</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-208577"><name><surname>Malaguti</surname><given-names>Giulia</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-204620"><name><surname>ten Wolde</surname><given-names>Pieter Rein</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9933-4016</contrib-id><email>tenwolde@amolf.nl</email><xref ref-type="aff" rid="aff1"/><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><institution>AMOLF, Science Park</institution><addr-line><named-content content-type="city">Amsterdam</named-content></addr-line><country>Netherlands</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Weigel</surname><given-names>Detlef</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Developmental Biology</institution><country>Germany</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>17</day><month>02</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e62574</elocation-id><history><date date-type="received" iso-8601-date="2020-09-24"><day>24</day><month>09</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-02-12"><day>12</day><month>02</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Malaguti and ten Wolde</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Malaguti and ten Wolde</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-62574-v2.pdf"/><abstract><p>Living cells often need to measure chemical concentrations that vary in time, yet how accurately they can do so is poorly understood. Here, we present a theory that fully specifies, without any adjustable parameters, the optimal design of a canonical sensing system in terms of two elementary design principles: (1) there exists an optimal integration time, which is determined by the input statistics and the number of receptors; and (2) in the optimally designed system, the number of independent concentration measurements as set by the number of receptors and the optimal integration time equals the number of readout molecules that store these measurements and equals the work to store these measurements reliably; no resource is then in excess and hence wasted. Applying our theory to the <italic>Escherichia coli</italic> chemotaxis system indicates that its integration time is not only optimal for sensing shallow gradients but also necessary to enable navigation in these gradients.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>sensing</kwd><kwd>information transmission</kwd><kwd>modelling</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003246</institution-id><institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Malaguti</surname><given-names>Giulia</given-names></name><name><surname>ten Wolde</surname><given-names>Pieter Rein</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A theory is presented for the optimal design of cellular sensing systems that maximizes the sensing precision given resource constraints.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Living cells continually have to respond and adapt to changes in their environment. They often do so on a timescale that is comparable to that of the environmental variations. Examples are cells that during their development differentiate in response to time-varying morphogen gradients (<xref ref-type="bibr" rid="bib12">Durrieu et al., 2018</xref>) or cells that navigate through their environment (<xref ref-type="bibr" rid="bib60">Tostevin and ten Wolde, 2009</xref>; <xref ref-type="bibr" rid="bib49">Sartori and Tu, 2011</xref>; <xref ref-type="bibr" rid="bib36">Long et al., 2016</xref>). These cells shape, via their movement, the statistics of the input signal, such that the timescale of the input fluctuations becomes comparable to that of the response. In all these cases, it is important to understand how accurately the cell can estimate chemical concentrations that vary in time.</p><p>Cells measure chemical concentrations via receptors on their surface. These measurements are inevitably corrupted by the stochastic arrival of the ligand molecules by diffusion and by the stochastic binding of the ligand to the receptor. Wiener and Kolmogorov (<xref ref-type="bibr" rid="bib14">Extrapolation, 1950</xref>; <xref ref-type="bibr" rid="bib31">Kolmogorov, 1992</xref>) and <xref ref-type="bibr" rid="bib30">Kalman, 1960</xref> have developed theories for the optimal strategy to estimate signals in the presence of noise. Their filtering theories have been employed widely in engineering, and in recent years they have also been applied to cell signaling. They have been used to show that time integration can improve the sensing of time-varying signals by reducing receptor noise, although it cannot remove this input noise completely because of signal distortion (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>). It has been shown that circadian systems can adapt their response to the statistics of the input signal, as predicted by Kalman filtering theory (<xref ref-type="bibr" rid="bib27">Husain et al., 2019</xref>). Moreover, Wiener–Kolmogorov filtering theory has been employed to derive the optimal topology of the cellular network depending on the statistics of the input signal (<xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>). Negative feedback and incoherent feedforward, which are common motifs in cell signaling (<xref ref-type="bibr" rid="bib1">Alon, 2007</xref>), make it possible to predict future signal values via signal extrapolation, which is useful when the past signal contains information about the future in addition to the current signal (<xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>).</p><p>The precision of sensing depends not only on the topology of the cellular sensing network but also on the resources required to build and operate it. Receptors and time are needed to take the concentration measurements (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>), downstream molecules are necessary to store the ligand-binding states of the receptor in the past, and energy is required to store these states reliably (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). Many studies have addressed the question how receptors and time limit the precision of sensing static concentrations that do not vary on the timescale of cellular response (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>; <xref ref-type="bibr" rid="bib6">Bialek and Setayeshgar, 2005</xref>; <xref ref-type="bibr" rid="bib63">Wang et al., 2007</xref>; <xref ref-type="bibr" rid="bib48">Rappel and Levine, 2008</xref>; <xref ref-type="bibr" rid="bib13">Endres and Wingreen, 2009</xref>; <xref ref-type="bibr" rid="bib26">Hu et al., 2010</xref>; <xref ref-type="bibr" rid="bib43">Mora and Wingreen, 2010</xref>; <xref ref-type="bibr" rid="bib20">Govern and Ten Wolde, 2012</xref>; <xref ref-type="bibr" rid="bib38">Mehta and Schwab, 2012</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>; <xref ref-type="bibr" rid="bib22">Govern and Ten Wolde, 2014b</xref>; <xref ref-type="bibr" rid="bib29">Kaizu et al., 2014</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Mugler et al., 2016</xref>; <xref ref-type="bibr" rid="bib16">Fancher and Mugler, 2017</xref>). In addition, progress has been made in understanding how the number of readout molecules and energy set the precision of sensing static signals (<xref ref-type="bibr" rid="bib38">Mehta and Schwab, 2012</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>; <xref ref-type="bibr" rid="bib22">Govern and Ten Wolde, 2014b</xref>). Yet, what the resource requirements for sensing time-varying signals are is a wide open question. In particular, it is not known how the number of receptor and readout molecules, time, and power required to maintain a desired sensing precision depend on the strength and the timescale of the input fluctuations.</p><p>In this article, we present a theory for the optimal design of cellular sensing systems as set by resource constraints and the dynamics of the input signal. The theory applies to one of the most common motifs in cell signaling, a receptor that drives a push–pull network, which consists of a cycle of protein activation and deactivation (<xref ref-type="bibr" rid="bib19">Goldbeter and Koshland, 1981</xref>, see <xref ref-type="fig" rid="fig1">Figure 1</xref>). These systems are omnipresent in prokaryotic and eukaryotic cells (<xref ref-type="bibr" rid="bib1">Alon, 2007</xref>). Examples are GTPase cycles, as in the Ras system, phosphorylation cycles, as in MAPK cascades, and two-component systems like the chemotaxis system of <italic>Escherichia coli</italic>. Push–pull networks constitute a simple exponential filter (<xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>), in which the current output depends on the current and past input (with past input values contributing to the output with a weight that decays exponentially with time back into the past). Wiener–Kolmogorov filtering theory (<xref ref-type="bibr" rid="bib14">Extrapolation, 1950</xref>; <xref ref-type="bibr" rid="bib31">Kolmogorov, 1992</xref>) shows that these networks are optimal for estimating signals that are memoryless (<xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>), meaning that the past input does not contain information that is not already present in the current input. These networks are useful because they act as low-pass filters, removing the high-frequency receptor–ligand-binding noise (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>). Push–pull networks thus enable the cell to employ the mechanism of time integration, in which the cell infers the concentration not from the instantaneous number of ligand-bound receptors, but rather from the average receptor occupancy over an integration time (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>). Our theory gives a unified description in terms of all the cellular resources, protein copies, time, and energy, that are necessary to implement this mechanism of time integration. It does not address the sensing strategy of maximum-likelihood estimation (<xref ref-type="bibr" rid="bib13">Endres and Wingreen, 2009</xref>; <xref ref-type="bibr" rid="bib43">Mora and Wingreen, 2010</xref>; <xref ref-type="bibr" rid="bib33">Lang et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Hartich and Seifert, 2016</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>) or Bayesian filtering (<xref ref-type="bibr" rid="bib42">Mora and Nemenman, 2019</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>The cell signaling network.</title><p>(<bold>a</bold>) The time-varying ligand concentration is modeled as a memoryless (Markovian) signal with mean <inline-formula><mml:math id="inf1"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, variance <inline-formula><mml:math id="inf2"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, and correlation time <inline-formula><mml:math id="inf3"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. A free ligand molecule L (light blue circle) can bind at rate <italic>k</italic><sub>1</sub> to a free receptor R (magenta protein) on the cell membrane (black line), forming the complex RL, and unbind at rate <italic>k</italic><sub>2</sub> from RL. The correlation time of the receptor state is <inline-formula><mml:math id="inf4"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. The complex RL catalyzes the phosphorylation reaction, driven by adenosine triphosphate (ATP) conversion, of a downstream readout from the unphosphorylated (inactive) state <italic>x</italic> to the phosphorylated (active) state <inline-formula><mml:math id="inf5"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, with rate <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math></inline-formula>. The phosphorylated readout then spontaneously decays to the <italic>x</italic> state with rate <inline-formula><mml:math id="inf7"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. Microscopic reverse reactions of each signaling pathway are represented by dashed arrows. The relaxation time of the push–pull network is <inline-formula><mml:math id="inf8"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>b</bold>) Free-energy landscape of a readout molecule across the activation/deactivation reactions. Fuel turnover, provided by ATP conversion, drives the activation (phosphorylation) reaction characterized by the forward rate <inline-formula><mml:math id="inf9"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub></mml:math></inline-formula> and its microscopic reverse rate <inline-formula><mml:math id="inf10"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (green arrows). Associated with this activation reaction is a free-energy drop <inline-formula><mml:math id="inf11"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>. The deactivation pathway corresponds to the spontaneous release of the inorganic phosphate; it is characterized by the rate <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and its microscopic reverse <inline-formula><mml:math id="inf13"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (blue arrows) and corresponds to a free-energy drop <inline-formula><mml:math id="inf14"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-62574-fig1-v2.tif"/></fig><p>While filtering theories are powerful tools for predicting the optimal topology and response dynamics of the cellular sensing network (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>), they do not naturally reveal the resource requirements for sensing. Our theory therefore employs the sampling framework of <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref> and extends it here to time-varying signals. This framework is based on the observation that the cell estimates the current ligand concentration not from the current number of active readout molecules directly, but rather via the receptor: the cell uses its push–pull network to estimate the receptor occupancy from which the ligand concentration is then inferred (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). To elucidate the resource requirements for time integration, the push–pull network is viewed as a device that employs the mechanism of time integration by discretely sampling, rather than continuously integrating, the state of the receptor via collisions of the readout molecules with the receptor proteins (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). During each collision, the ligand-binding state of the receptor protein is copied into the activation state of the readout molecule (<xref ref-type="bibr" rid="bib47">Ouldridge et al., 2017</xref>). The readout molecules thus constitute samples of the receptor state, and the fraction of active readout molecules provides an estimate of the average receptor occupancy. The readout activation states have, however, a finite lifetime, which means that this is an estimate of the (running) average receptor occupancy over this lifetime, which indeed sets the receptor integration time <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. The cell can estimate the current ligand concentration <italic>L</italic> from this estimate of the average receptor occupancy <inline-formula><mml:math id="inf16"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf17"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> because there is a unique one-to-one mapping between <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> and <italic>L</italic>. This mapping <inline-formula><mml:math id="inf19"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the dynamic input–output relation and differs from the conventional static input–output relations used to describe the sensing of static concentrations that do not vary on the timescale of the response (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>; <xref ref-type="bibr" rid="bib6">Bialek and Setayeshgar, 2005</xref>; <xref ref-type="bibr" rid="bib29">Kaizu et al., 2014</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>) in that it depends not only on the response time of the system but also on the dynamics of the input signal.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The precision of estimating a time-varying ligand concentration <italic>L</italic>.</title><p>(<bold>a</bold>) The cell estimates the current ligand concentration <inline-formula><mml:math id="inf20"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> by estimating the average receptor occupancy <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf22"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and by inverting the dynamic input–output relation <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (black solid line). The latter describes the mapping between the current concentration <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the time-varying signal and the average receptor occupancy <inline-formula><mml:math id="inf25"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past <inline-formula><mml:math id="inf26"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, see also (<bold>b</bold>); it depends on the timescale <inline-formula><mml:math id="inf27"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> of the input signal and hence differs from the conventional static input–output relation <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which describes the mapping between the average receptor occupancy and a static ligand concentration <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math></inline-formula> that does not vary in time (gray solid line). The squared error in the estimate of the concentration <inline-formula><mml:math id="inf30"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the variance <inline-formula><mml:math id="inf31"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in the estimate of the average receptor occupancy <inline-formula><mml:math id="inf32"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> and the dynamic gain <inline-formula><mml:math id="inf33"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, which is the slope of <inline-formula><mml:math id="inf34"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Only in the limit <inline-formula><mml:math id="inf35"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>≪</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, does <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> reduce to (the linearized form of) <inline-formula><mml:math id="inf37"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and does the dynamic gain <inline-formula><mml:math id="inf38"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> become the static gain <inline-formula><mml:math id="inf39"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which is the slope of <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at the average ligand concentration <inline-formula><mml:math id="inf41"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>. The input distribution, shown in blue, has width <inline-formula><mml:math id="inf42"><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>b</bold>) The average receptor occupancy <inline-formula><mml:math id="inf43"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf44"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is estimated via the downstream network, which is modeled as a device that discretely samples the ligand-binding state of the receptor via its readout molecules <italic>x</italic> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>); the fraction of modified readout molecules provides an estimate of <inline-formula><mml:math id="inf45"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. The sensing error has two contributions (<xref ref-type="disp-formula" rid="equ6">Equation 6)</xref>: sampling error and dynamical error. The sampling error arises from the error in the estimate of <inline-formula><mml:math id="inf46"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> that is due to the stochasticity of the sampling process; it depends on the number of samples, their independence, and their accuracy. (<bold>c</bold>) The dynamical error arises because the current ligand concentration <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is estimated via the average receptor occupancy <inline-formula><mml:math id="inf48"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf49"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>: the latter depends on the ligand concentration in the past <inline-formula><mml:math id="inf50"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, which will, in general, deviate from the current concentration. Two different input trajectories (<italic>L</italic><sub>1</sub> in blue, <italic>L</italic><sub>2</sub> in green) ending at time <italic>t</italic> at the <italic>same</italic> value <inline-formula><mml:math id="inf51"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (red dot) lead to different estimates of <inline-formula><mml:math id="inf52"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> due to their different average receptor occupancy (<inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) in the past <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-62574-fig2-v2.tif"/></fig><p>Our theory reveals that the sensing error can be decomposed into two terms, which each depend on collective variables that reveal the resource requirements for sensing. One term, the sampling error, describes the sensing error that arises from the finite accuracy by which the receptor occupancy is estimated. This error depends on the number of receptor samples, as set by the number of receptors, readout molecules, and the integration time; their independence, as given by the receptor-sampling interval and the timescale of the receptor–ligand-binding noise; and their reliability, as determined by how much the system is driven out of thermodynamic equilibrium via fuel turnover. The other term is the dynamical error and is determined by how much the concentration in the past integration time reflects the current concentration that the cell aims to estimate; it depends on the integration time and timescale of the input fluctuations.</p><p>Our theory gives a comprehensive view on the optimal design of a cellular sensing system. Firstly, it reveals that the resource allocation principle of <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref> can be generalized to time-varying signals. There exist three fundamental resource classes – receptors and their integration time, readout molecules, and power and integration time – which each fundamentally limit the accuracy of sensing; and, in an optimally designed system, each resource class is equally limiting so that none of them is in excess and thus wasted. However, in contrast to sensing static signals, time cannot be freely traded against the number of receptors and the power to achieve a desired sensing precision: there exists an optimal integration time that maximizes the sensing precision, which arises as a trade-off between the sampling error and dynamical error. Together with the resource allocation principle, it completely specifies, without any adjustable parameters, the optimal design of the system in terms of its resources protein copies, time, and energy.</p><p>Our theory also makes a number of specific predictions. The optimal integration time decreases as the number of receptors is increased because this allows for more instantaneous measurements. Moreover, the allocation principle reveals that when the input varies more rapidly both the number of receptors and the power must increase to maintain a desired sensing precision, while the number of readout molecules does not.</p><p>Finally, we apply our theory to the chemotaxis system of <italic>E. coli</italic>. This bacterium searches for food via a run-and-tumble strategy (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>), yielding a fluctuating input signal. In small gradients, the timescale of these input fluctuations is set by the typical run time of the bacterium, which is on the order of a few seconds (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib55">Taute et al., 2015</xref>), while the strength of these fluctuations is determined by the steepness of the gradient. Interestingly, experiments have revealed that <italic>E. coli</italic> can sense extremely shallow gradients, with a length scale of approximately 10<sup>4</sup>µm (<xref ref-type="bibr" rid="bib52">Shimizu et al., 2010</xref>), raising the question how accurately <italic>E. coli</italic> can measure the concentration and whether this is sufficient to determine whether during a run it has changed, even in these shallow gradients. To measure the concentration, the chemotaxis system employs a push–pull network to filter out the high-frequency receptor–ligand-binding noise (<xref ref-type="bibr" rid="bib49">Sartori and Tu, 2011</xref>). Applying our theory to this system predicts that the measured integration time, on the order of 100 ms (<xref ref-type="bibr" rid="bib54">Sourjik and Berg, 2002</xref>), is not only sufficient to enable navigation in these shallow gradients but also necessary. This suggests that this system has evolved to optimally sense shallow concentration gradients.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Theory: model</title><p>We consider a single cell that needs to sense a time-varying ligand concentration <inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1a</xref>). The ligand concentration dynamics is modeled as a stationary memoryless, or Markovian, signal specified by the mean (total) ligand concentration <inline-formula><mml:math id="inf56"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, the variance <inline-formula><mml:math id="inf57"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, and the correlation time <inline-formula><mml:math id="inf58"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which determines the timescale on which input fluctuations decay. It obeys Gaussian statistics (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>).</p><p>The concentration is measured via <inline-formula><mml:math id="inf59"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> receptor proteins on the cell surface, which independently bind the ligand (<xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>), <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:munderover><mml:mo>⇌</mml:mo><mml:mpadded lspace="0.278em" width="+0.667em"><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mpadded><mml:mpadded lspace="0.278em" width="+0.667em"><mml:mtext> </mml:mtext><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext> </mml:mtext></mml:mpadded></mml:munderover><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The correlation time of the receptor state, which is the timescale on which fluctuations in the number of ligand-bound receptors regresses to the mean, is given by <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>; <xref ref-type="bibr" rid="bib6">Bialek and Setayeshgar, 2005</xref>; <xref ref-type="bibr" rid="bib29">Kaizu et al., 2014</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>). It determines the timescale on which independent concentration measurements can be made.</p><p>The ligand-binding state of the receptor is read out via a push–pull network (<xref ref-type="bibr" rid="bib19">Goldbeter and Koshland, 1981</xref>). The most common scheme is phosphorylation fueled by the hydrolysis of adenosine triphosphate (ATP) (see <xref ref-type="fig" rid="fig1">Figure 1b</xref>). The receptor, or an enzyme associated with it such as CheA in <italic>E. coli</italic>, catalyzes the modification of the readout, <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mtext> </mml:mtext><mml:mover><mml:mo>⇌</mml:mo><mml:mpadded lspace="0.278em" width="+0.667em"><mml:mtext> </mml:mtext></mml:mpadded></mml:mover><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>A</mml:mi><mml:mi>D</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. The active readout proteins <inline-formula><mml:math id="inf63"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> can decay spontaneously or be deactivated by an enzyme, such as CheZ in <italic>E. coli</italic>, <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">⇌</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. Inside the living cell the system is maintained in a non-equilibrium steady state by keeping the concentrations of ATP, adenosine diphosphate (ADP), and inorganic phosphate (Pi) constant. We absorb their concentrations and the activities of the kinase and, if applicable, phosphatase in the (de)phosphorylation rates, coarse-graining the (de)modification reactions into instantaneous second-order reactions: <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>L</mml:mi><mml:mtext> </mml:mtext><mml:munderover><mml:mo>⇌</mml:mo><mml:mpadded lspace="0.278em" width="+0.667em"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mpadded lspace="0.278em" width="+0.667em"><mml:mspace width="1em"/><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/></mml:mpadded></mml:munderover><mml:mtext> </mml:mtext><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:munderover><mml:mo>⇌</mml:mo><mml:mpadded lspace="0.278em" width="+0.667em"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mpadded><mml:mpadded lspace="0.278em" width="+0.667em"><mml:mspace width="1em"/><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mspace width="1em"/></mml:mpadded></mml:munderover><mml:mtext> </mml:mtext><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This system has a relaxation time <inline-formula><mml:math id="inf67"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>), which describes how fast fluctuations in <inline-formula><mml:math id="inf68"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> relax. It determines how long <inline-formula><mml:math id="inf69"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> can carry information on the ligand-binding state of the receptor; <inline-formula><mml:math id="inf70"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> thus sets the integration time of the receptor state.</p></sec><sec id="s2-2"><title>Theory: inferring concentration from receptor occupancy</title><p>The central idea of our theory is illustrated in <xref ref-type="fig" rid="fig2">Figure 2a</xref>: the cell employs the push–pull network to estimate the average receptor occupancy <inline-formula><mml:math id="inf71"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf72"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. It then uses this estimate <inline-formula><mml:math id="inf73"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> to infer the current concentration <italic>L</italic> via the dynamic input–output relation <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which provides a one-to-one mapping between <inline-formula><mml:math id="inf75"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> and <italic>L</italic>.</p><sec id="s2-2-1"><title>Dynamic input–output relation</title><p>The mapping <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the <italic>dynamic input–output relation</italic>. It gives the average receptor occupancy over the past integration time <inline-formula><mml:math id="inf77"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, <italic>given</italic> that the <italic>current</italic> value of the input signal is <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2">Figure 2a</xref>). Here, the average is not only over the noise in receptor<italic>–</italic>ligand binding and readout activation (<xref ref-type="fig" rid="fig2">Figure 2b</xref>) but also over the subensemble of past input trajectories that each end at the same current concentration <italic>L</italic> (<xref ref-type="fig" rid="fig2">Figure 2c</xref>; <xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>; <xref ref-type="bibr" rid="bib24">Hilfinger and Paulsson, 2011</xref>; <xref ref-type="bibr" rid="bib7">Bowsher et al., 2013</xref>). In contrast to the conventional static input<italic>–</italic>output relation <inline-formula><mml:math id="inf79"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which gives the average receptor occupancy <italic>p</italic> for a steady-state ligand concentration <inline-formula><mml:math id="inf80"><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:math></inline-formula> that does not vary in time, the dynamic input<italic>–</italic>output relation takes into account the dynamics of the input and the finite response time of the system. It depends on all timescales in the problem: the timescale of the input, <inline-formula><mml:math id="inf81"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula>, the receptor<italic>–</italic>ligand correlation time <inline-formula><mml:math id="inf82"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, and the integration time <inline-formula><mml:math id="inf83"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. Only when <inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> does the dynamic input<italic>–</italic>output <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> become equal to the static input<italic>–</italic>output relation <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s2-2-2"><title>Sensing error</title><p>Linearizing the dynamic input–output relation <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> around the mean ligand concentration <inline-formula><mml:math id="inf88"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2">Figure 2a</xref>) and using the rules of error propagation, the expected error in the concentration estimate is<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf89"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the variance in the estimate <inline-formula><mml:math id="inf90"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> of the average receptor occupancy over the past <inline-formula><mml:math id="inf91"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, <italic>given</italic> that the current input signal is <italic>L</italic> (see <xref ref-type="fig" rid="fig2">Figure 2a</xref>). The quantity <inline-formula><mml:math id="inf92"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the <italic>dynamic</italic> gain, which is the slope of the dynamic input–output relation <inline-formula><mml:math id="inf93"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; it determines how much an error in the estimate of <inline-formula><mml:math id="inf94"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> propagates to that in <italic>L</italic>. <xref ref-type="disp-formula" rid="equ1">Equation 1</xref> generalizes the expression for the error in sensing static concentrations (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>; <xref ref-type="bibr" rid="bib6">Bialek and Setayeshgar, 2005</xref>; <xref ref-type="bibr" rid="bib63">Wang et al., 2007</xref>; <xref ref-type="bibr" rid="bib38">Mehta and Schwab, 2012</xref>; <xref ref-type="bibr" rid="bib29">Kaizu et al., 2014</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>) to that of time-varying concentrations.</p></sec><sec id="s2-2-3"><title>Signal-to-noise ratio</title><p>Together with the distribution of input states, the sensing error <inline-formula><mml:math id="inf95"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> determines how many distinct signal values the cell can resolve. The latter is quantified by the signal-to-noise ratio (SNR), which is defined as<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mo>≡</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf96"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the variance of the ligand concentration <inline-formula><mml:math id="inf97"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>; because the system is stationary and time invariant, we can omit the argument in <inline-formula><mml:math id="inf98"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and write <inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The variance <inline-formula><mml:math id="inf100"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a measure for the total number of input states, such that the SNR gives the number of distinct ligand concentrations the cell can measure. Using <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, it is given by<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mrow><mml:mtext>SNR</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mpadded width="+2.8pt"><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:mpadded><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The SNR also yields the mutual information <inline-formula><mml:math id="inf101"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>SNR</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> between the input <italic>L</italic> and output <inline-formula><mml:math id="inf102"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>).</p></sec><sec id="s2-2-4"><title>Readout system samples receptor state</title><p>Receptor time averaging is typically conceived as a scheme in which the receptor state is averaged via the mathematical operation of an integral: <inline-formula><mml:math id="inf103"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mn>0</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Yet, readout proteins are discrete components that interact with the receptor in a discrete and stochastic fashion. To derive the dynamic gain <inline-formula><mml:math id="inf104"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> and error in estimating <inline-formula><mml:math id="inf105"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf106"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), we therefore view the push–pull network as a device that discretely samples the receptor state (see <xref ref-type="fig" rid="fig2">Figure 2b</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). The principle is that cells employ the activation reaction <inline-formula><mml:math id="inf107"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to store the state of the receptor in stable chemical modification states of the readout molecules. Readout molecules that collide with a ligand-bound receptor are modified, while those that collide with an unbound receptor are not (<xref ref-type="fig" rid="fig2">Figure 2b</xref>). The readout molecules serve as samples of the receptor at the time they were created, and collectively they encode the history of the receptor: the fraction of samples that correspond to ligand-bound receptors is the cell’s estimate for <inline-formula><mml:math id="inf108"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. Indeed, this is the discrete and stochastic implementation of the mechanism of time integration. The effective number of independent samples depends not only on the creation of samples, <inline-formula><mml:math id="inf109"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, but also on their decay and accuracy. Samples decay via the deactivation reaction <inline-formula><mml:math id="inf110"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>→</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, which means that they only provide information on the receptor occupancy over the past <inline-formula><mml:math id="inf111"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. In addition, both the activation and the deactivation reaction can happen in their microscopic reverse direction, which corrupts the coding, that is, the mapping between the ligand-binding states of the receptor proteins and the activation states of the readout molecules. Energy is needed to break time reversibility and protect the coding. Furthermore, for time-varying signals, we also need to recognize that the samples correspond to the ligand concentration over the past integration time <inline-formula><mml:math id="inf112"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, which will in general differ from the current concentration <italic>L</italic> that the cell aims to estimate (see <xref ref-type="fig" rid="fig2">Figure 2c</xref>). While a finite <inline-formula><mml:math id="inf113"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is necessary for time integration, it will, as we show below, also lead to a systematic error in the estimate of the concentration that the cell cannot reduce by taking more receptor samples.</p><p>This analysis reveals that the dynamic gain is (see Appendix 1)<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Only when <inline-formula><mml:math id="inf114"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the average ligand concentration over the ensemble of trajectories ending at <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> equal to the current concentration <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2c</xref>) and does <inline-formula><mml:math id="inf117"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> become equal to its maximal value, the static gain <inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <italic>p</italic> is the average receptor occupancy averaged over all values of <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The analysis also reveals that the error in <inline-formula><mml:math id="inf120"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> can be written as (see Appendix 1, <xref ref-type="disp-formula" rid="equ27">Equation 29</xref>)<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>dyn</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf121"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is a statistical error due to the stochastic sampling of the receptor and <inline-formula><mml:math id="inf122"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>dyn</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is a systematic error arising from the dynamics of the input, as elucidated in <xref ref-type="fig" rid="fig2">Figure 2b, c</xref>.</p></sec><sec id="s2-2-5"><title>Central result</title><p>To know how the error <inline-formula><mml:math id="inf123"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in the estimate of <inline-formula><mml:math id="inf124"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> propagates to the error <inline-formula><mml:math id="inf125"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> in the estimate of the current ligand concentration, we divide <inline-formula><mml:math id="inf126"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> by the dynamic gain <inline-formula><mml:math id="inf127"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> (see <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>). For the full system, the reversible push–pull network, this yields via <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> the central result of our article, the SNR in terms of the total number of receptor samples, their independence, their accuracy, and the timescale on which they are generated:<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:munder><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This expression shows that the sensing error <inline-formula><mml:math id="inf128"><mml:msup><mml:mi>SNR</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> can be decomposed into two distinct contributions, which each have a clear interpretation: the <italic>sampling error</italic>, arising from the stochasticity in the sampling of the receptor state, and the <italic>dynamical error</italic>, arising from the dynamics of the input.</p><p>When the timescale of the ligand fluctuations <inline-formula><mml:math id="inf129"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> is much longer than the receptor correlation time <inline-formula><mml:math id="inf130"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> and the integration time <inline-formula><mml:math id="inf131"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf132"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the dynamical error reduces to zero and only the sampling error remains. Here, <inline-formula><mml:math id="inf133"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:math></inline-formula> is the total number of effective samples and <inline-formula><mml:math id="inf134"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> is the number of these that are independent (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). For the full system, they are given by<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mover><mml:mrow><mml:mover><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>⏞</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:mover><mml:mover><mml:mrow><mml:mover><mml:mfrac><mml:mrow><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>p</mml:mi></mml:mfrac><mml:mo>⏞</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mover></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The quantity <inline-formula><mml:math id="inf135"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the net flux of <italic>x</italic> around the cycle of activation and deactivation, with <inline-formula><mml:math id="inf136"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> the total number of receptor proteins and <inline-formula><mml:math id="inf137"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf138"><mml:msup><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> the average number of inactive and active readout molecules, respectively. It equals the rate at which <italic>x</italic> is modified by the ligand-bound receptor; the quantity <inline-formula><mml:math id="inf139"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> is thus the sampling rate of the receptor, be it ligand bound or not. Multiplied with the relaxation rate <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, it yields the total number of receptor samples <inline-formula><mml:math id="inf141"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> obtained during <inline-formula><mml:math id="inf142"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. However, not all these samples are reliable. The effective number of samples is <inline-formula><mml:math id="inf143"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf144"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> quantifies the quality of the sample. Here, <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the inverse temperature, <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are the free-energy drops over the activation and deactivation reaction, respectively, with <inline-formula><mml:math id="inf148"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> the total drop, determined by the fuel turnover (see <xref ref-type="fig" rid="fig1">Figure 1b</xref>). If the system is in thermodynamic equilibrium, <inline-formula><mml:math id="inf149"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf150"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and the system cannot sense because the ligand-binding state of the receptor is equally likely to be copied into the correct modification state of the readout as into the incorrect one. In contrast, if the system is strongly driven out of equilibrium and <inline-formula><mml:math id="inf151"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, then, during each receptor–readout interaction, the receptor state is always copied into the correct activation state of the readout; the sample quality parameter <italic>q</italic> thus approaches unity and <inline-formula><mml:math id="inf152"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. Yet, even when all samples are reliable, they may contain redundant information on the receptor state. The factor <inline-formula><mml:math id="inf153"><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula> is the fraction of the <inline-formula><mml:math id="inf154"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:math></inline-formula> samples that are independent. It reaches unity when the receptor sampling interval <inline-formula><mml:math id="inf155"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> becomes larger than the receptor correlation time <inline-formula><mml:math id="inf156"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>When the number of samples becomes very large, <inline-formula><mml:math id="inf157"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, the sampling error reduces to zero. However, the sensing error still contains a second contribution, which, following <xref ref-type="bibr" rid="bib7">Bowsher et al., 2013</xref>, we call the dynamical error. This contribution only depends on timescales. It arises from the fact that the samples encode the receptor history and hence the ligand concentration over the past <inline-formula><mml:math id="inf158"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, which will, in general, deviate from the quantity that the cell aims to predict – the current concentration <italic>L</italic>. This contribution yields a systematic error, which cannot be eliminated by increasing the number of receptor samples, their independence, or their accuracy. It can only be reduced to zero by making the integration time <inline-formula><mml:math id="inf159"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> much smaller than the ligand timescale <inline-formula><mml:math id="inf160"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> (assuming <inline-formula><mml:math id="inf161"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> is typically much smaller than <inline-formula><mml:math id="inf162"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). Only in this regime will the ligand concentration in the past <inline-formula><mml:math id="inf163"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> be similar to the current concentration and can the latter be reliably inferred from the receptor occupancy, provided the latter has been estimated accurately by taking enough samples.</p><p>Importantly, the dynamics of the input signal not only affects the sensing precision via the dynamical error but also via the sampling error. This effect is contained in the prefactor of the sampling error, <inline-formula><mml:math id="inf164"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, which has its origin in the dynamic gain <inline-formula><mml:math id="inf165"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>). It determines how the sampling error <inline-formula><mml:math id="inf166"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in the estimate of <inline-formula><mml:math id="inf167"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> propagates to the error in the estimate of <italic>L</italic> (see <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>). Only when <inline-formula><mml:math id="inf168"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>≪</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can the readout system closely track the input signal and does <inline-formula><mml:math id="inf169"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> reach its maximal value, the static gain <inline-formula><mml:math id="inf170"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, thus minimizing the error propagation from <inline-formula><mml:math id="inf171"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> to <italic>L</italic>.</p></sec></sec><sec id="s2-3"><title>Fundamental resources</title><p>We can use <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> to identify the <italic>fundamental</italic> resources for cell sensing (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>) and derive Pareto fronts that quantify the trade-offs between the maximal sensing precision and these resources. A fundamental resource is a (collective) variable <inline-formula><mml:math id="inf172"><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> that, when fixed to a constant, puts a non-zero lower bound on <inline-formula><mml:math id="inf173"><mml:msup><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, no matter how the other variables are varied. It is thus mathematically defined as <inline-formula><mml:math id="inf174"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>MIN</mml:mi><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>const</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>const</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> To find these collective variables, we numerically or analytically minimized <inline-formula><mml:math id="inf175"><mml:msup><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, constraining (combinations of) variables yet optimizing over the other variables. This reveals that the SNR is bounded by (see Appendix 2)<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mrow><mml:msup><mml:mtext>SNR</mml:mtext><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>h</mml:mi></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mi>MIN</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ8 equ9">Equations 8 and 9</xref> show that the fundamental resources are the number of receptors <inline-formula><mml:math id="inf176"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, the integration time <inline-formula><mml:math id="inf177"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, the number of readouts <inline-formula><mml:math id="inf178"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, and the power <inline-formula><mml:math id="inf179"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig3">Figure 3a, b</xref> illustrates that <inline-formula><mml:math id="inf180"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> are indeed fundamental: the sensing precision is bounded by the limiting resource and cannot be enhanced by increasing another resource. Panel (a) shows that when <inline-formula><mml:math id="inf181"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is small, the maximum mutual information <inline-formula><mml:math id="inf182"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> cannot be increased by raising <inline-formula><mml:math id="inf183"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>: no matter how many receptors the system has, the sensing precision is limited by the pool of readout molecules and only increasing this pool can raise <inline-formula><mml:math id="inf184"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula>. Yet, when <inline-formula><mml:math id="inf185"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is large, <inline-formula><mml:math id="inf186"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> becomes independent of <inline-formula><mml:math id="inf187"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. In this regime, the number of receptors <inline-formula><mml:math id="inf188"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> limits the number of independent concentration measurements and only increasing <inline-formula><mml:math id="inf189"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> can raise <inline-formula><mml:math id="inf190"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula>. Similarly, panel (b) shows that when the power <inline-formula><mml:math id="inf191"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is limiting, <inline-formula><mml:math id="inf192"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> cannot be increased by <inline-formula><mml:math id="inf193"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> but only by increasing <inline-formula><mml:math id="inf194"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>. Clearly, the resources receptors, readout molecules, and energy cannot compensate each other: the sensing precision is bounded by the limiting resource.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Receptors <inline-formula><mml:math id="inf195"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, readout molecules <inline-formula><mml:math id="inf196"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf197"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo mathvariant="normal">˙</mml:mo></mml:mover></mml:math></inline-formula> fundamentally limit sensing, and there exists an optimal integration time <inline-formula><mml:math id="inf198"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> that depends on which of the resources is limiting.</title><p>(<bold>a</bold>, <bold>b</bold>) <inline-formula><mml:math id="inf199"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf200"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf201"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> are fundamental resources, with no trade-offs between them. Plotted is the maximum mutual information <inline-formula><mml:math id="inf202"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>SNR</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, obtained by minimizing <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> over <italic>p</italic> and <inline-formula><mml:math id="inf203"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, for different combinations of (<bold>a</bold>) <inline-formula><mml:math id="inf204"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf205"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> in the irreversible limit <inline-formula><mml:math id="inf206"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and (<bold>b</bold>) <inline-formula><mml:math id="inf207"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf208"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> for two different values of <inline-formula><mml:math id="inf209"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. The sensing precision is bounded by the limiting resource, <inline-formula><mml:math id="inf210"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> (solid gray lines, <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf211"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>), <inline-formula><mml:math id="inf212"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> (dashed gray line, <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, panel <bold>a</bold>), or <inline-formula><mml:math id="inf214"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> (dashed gray lines, <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf215"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf216"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, panel <bold>b</bold>). (<bold>c</bold>) <inline-formula><mml:math id="inf217"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf218"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> for different values of <inline-formula><mml:math id="inf219"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> in the Berg–Purcell limit (<inline-formula><mml:math id="inf220"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf221"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>). There exists an optimal integration time <inline-formula><mml:math id="inf222"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> that maximizes the sensing precision; <inline-formula><mml:math id="inf223"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases with <inline-formula><mml:math id="inf224"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. (<bold>d</bold>) In this limit, <inline-formula><mml:math id="inf225"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> depends non-monotonically on the receptor–ligand correlation time <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>: it first increases with <inline-formula><mml:math id="inf227"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> to sustain time-averaging, but then drops when <inline-formula><mml:math id="inf228"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> becomes of order unity and time-averaging is no longer effective (see inset). (<bold>e</bold>) <inline-formula><mml:math id="inf229"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf230"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> for different values of <inline-formula><mml:math id="inf231"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. When <inline-formula><mml:math id="inf232"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, time averaging is not possible and the optimal system is an instantaneous responder, <inline-formula><mml:math id="inf233"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>; when <inline-formula><mml:math id="inf234"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the system reaches the Berg–Purcell regime in which <inline-formula><mml:math id="inf235"><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub></mml:math></inline-formula> is limited by <inline-formula><mml:math id="inf236"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> rather than <inline-formula><mml:math id="inf237"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> (see panel <bold>a</bold>). (<bold>f</bold>) <inline-formula><mml:math id="inf238"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> and <inline-formula><mml:math id="inf239"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf240"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>. When the power <inline-formula><mml:math id="inf241"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is limiting, the sampling error dominates and <inline-formula><mml:math id="inf242"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> equals <inline-formula><mml:math id="inf243"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> to maximize <inline-formula><mml:math id="inf244"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, minimizing the sampling error; <inline-formula><mml:math id="inf245"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> then decreases to trade part of the decrease in the sampling error for a reduction in the dynamical error such that both decrease; when the sampling interval <inline-formula><mml:math id="inf246"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> becomes comparable to <inline-formula><mml:math id="inf247"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, in the region marked by the yellow bar, the sampling error is no longer limited by <inline-formula><mml:math id="inf248"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, such that <inline-formula><mml:math id="inf249"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> now limits both sources of error; the two sources can therefore no longer be decreased simultaneously by increasing <inline-formula><mml:math id="inf250"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>; the system has entered the Berg–Purcell regime, where <inline-formula><mml:math id="inf251"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> is determined by <inline-formula><mml:math id="inf252"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> rather than <inline-formula><mml:math id="inf253"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> (see panel <bold>b</bold>). Parameter values unless specified: <inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-62574-fig3-v2.tif"/></fig><p>Importantly, while for sensing static concentrations the products <inline-formula><mml:math id="inf255"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf256"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are fundamental (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>), for time-varying signals <inline-formula><mml:math id="inf257"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf258"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>, and <inline-formula><mml:math id="inf259"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> separately limit sensing. Consequently, neither receptors <inline-formula><mml:math id="inf260"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> nor power <inline-formula><mml:math id="inf261"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> can be traded freely against time <inline-formula><mml:math id="inf262"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> to reach a desired precision, as is possible for static signals. In line with the predictions of signal filtering theories (<xref ref-type="bibr" rid="bib14">Extrapolation, 1950</xref>; <xref ref-type="bibr" rid="bib31">Kolmogorov, 1992</xref>; <xref ref-type="bibr" rid="bib30">Kalman, 1960</xref>), there exists an optimal integration time <inline-formula><mml:math id="inf263"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> that maximizes the sensing precision (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib40">Monti et al., 2018b</xref>; <xref ref-type="bibr" rid="bib42">Mora and Nemenman, 2019</xref>). Interestingly, its value depends on which of the resources <inline-formula><mml:math id="inf264"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf265"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf266"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is limiting (<xref ref-type="fig" rid="fig3">Figure 3c–f</xref>). We now discuss these three regimes in turn.</p><sec id="s2-3-1"><title>Receptors</title><p><xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref> pointed out that cells can reduce the sensing error by either increasing the number of receptors or taking more measurements per receptor via the mechanism of time integration. However, <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> reveals that for sensing time-varying signals time integration can never eliminate the sensing error completely, as predicted also by filtering theories (<xref ref-type="bibr" rid="bib14">Extrapolation, 1950</xref>; <xref ref-type="bibr" rid="bib31">Kolmogorov, 1992</xref>; <xref ref-type="bibr" rid="bib30">Kalman, 1960</xref>). <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> shows that in the <italic>Berg–Purcell</italic> regime, where receptors and their integration time are limiting and <inline-formula><mml:math id="inf267"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the sensing precision does not depend on <inline-formula><mml:math id="inf268"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, as for static signals (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>), but on <inline-formula><mml:math id="inf269"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> separately, such that an optimal integration time <inline-formula><mml:math id="inf271"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> emerges that maximizes the sensing precision (see <xref ref-type="fig" rid="fig3">Figure 3c</xref>). Increasing <inline-formula><mml:math id="inf272"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> improves the mechanism of time integration by increasing the number of independent samples per receptor, <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, thus reducing the sampling error (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>). However, increasing <inline-formula><mml:math id="inf274"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> raises the dynamical error. Moreover, it lowers the dynamical gain <inline-formula><mml:math id="inf275"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, which increases the propagation of the error in the estimate of the receptor occupancy to that of the ligand concentration. The optimal integration time <inline-formula><mml:math id="inf276"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> arises as a trade-off between these three factors.</p><p><xref ref-type="fig" rid="fig3">Figure 3c</xref> also shows that the optimal integration time <inline-formula><mml:math id="inf277"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases with the number of receptors <inline-formula><mml:math id="inf278"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. The total number of independent concentration measurements is the number of independent measurements per receptor, <inline-formula><mml:math id="inf279"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, times the number <inline-formula><mml:math id="inf280"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> of receptors, <inline-formula><mml:math id="inf281"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. As <inline-formula><mml:math id="inf282"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> increases, less measurements <inline-formula><mml:math id="inf283"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> per receptor have to be taken to remove the receptor–ligand-binding noise, explaining why <inline-formula><mml:math id="inf284"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases as <inline-formula><mml:math id="inf285"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> increases – time integration becomes less important.</p><p>Interestingly, <inline-formula><mml:math id="inf286"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> depends non-monotonically on the receptor–ligand correlation time <inline-formula><mml:math id="inf287"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). When <inline-formula><mml:math id="inf288"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> increases at fixed <inline-formula><mml:math id="inf289"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, the receptor samples become more correlated. To keep the mechanism of time integration effective, <inline-formula><mml:math id="inf290"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> must increase with <inline-formula><mml:math id="inf291"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. However, to avoid too strong signal distortion the cell compromises on time integration by decreasing the <italic>ratio </italic><inline-formula><mml:math id="inf292"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see inset). When <inline-formula><mml:math id="inf293"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> becomes too large, the benefit of time integration no longer pays off the cost of signal distortion. Now not only the ratio <inline-formula><mml:math id="inf294"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> decreases but also <inline-formula><mml:math id="inf295"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> itself. The sensing system switches to a different strategy: it no longer employs time integration but becomes an instantaneous sensor.</p></sec><sec id="s2-3-2"><title>Readout molecules</title><p>To implement time integration, the cell needs to store the receptor states in the readout molecules. When the number of readout molecules <inline-formula><mml:math id="inf296"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is limiting, the sensing precision is given by <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf297"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This bound is saturated when <inline-formula><mml:math id="inf298"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. This is in marked contrast to the non-zero optimal integration <inline-formula><mml:math id="inf299"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> in the Berg–Purcell regime (see <xref ref-type="fig" rid="fig3">Figure 3c</xref>).</p><p>To elucidate the non-trivial behavior of <inline-formula><mml:math id="inf300"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3e</xref> shows <inline-formula><mml:math id="inf301"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> as a function of <inline-formula><mml:math id="inf302"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. When <inline-formula><mml:math id="inf303"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is smaller than <inline-formula><mml:math id="inf304"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, the average number of samples per receptor is less than unity. In this regime, the system cannot time integrate the receptor, and to minimize signal distortion <inline-formula><mml:math id="inf305"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Yet, when <inline-formula><mml:math id="inf306"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is increased, the likelihood that two or more readout molecules provide a sample of the same receptor molecule rises, and time averaging becomes possible. Yet to obtain receptor samples that are independent, the integration time <inline-formula><mml:math id="inf307"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> must be increased to make the sampling interval <inline-formula><mml:math id="inf308"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> larger than the receptor correlation time <inline-formula><mml:math id="inf309"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>. As <inline-formula><mml:math id="inf310"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and hence the total number of samples <inline-formula><mml:math id="inf311"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> are increased further, the number of samples that are independent, <inline-formula><mml:math id="inf312"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub></mml:math></inline-formula>, only continues to rise when <inline-formula><mml:math id="inf313"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> increases with <inline-formula><mml:math id="inf314"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> further. However, while this reduces the sampling error, it also increases the dynamical error. When the decrease in the sampling error no longer outweighs the increase in the dynamical error, <inline-formula><mml:math id="inf315"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> and the mutual information no longer change with <inline-formula><mml:math id="inf316"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig3">Figure 3a</xref>). The system has entered the Berg–Purcell regime in which <inline-formula><mml:math id="inf317"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> and the mutual information are given by the optimization of <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf318"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (gray dashed line). In this regime, increasing <inline-formula><mml:math id="inf319"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> merely adds redundant samples: the number of independent samples remains <inline-formula><mml:math id="inf320"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s2-3-3"><title>Power</title><p>Time integration relies on copying the ligand-binding state of the receptor into the chemical modification states of the readout molecules (<xref ref-type="bibr" rid="bib38">Mehta and Schwab, 2012</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). This copy process correlates the state of the receptor with that of the readout, which requires work input (<xref ref-type="bibr" rid="bib47">Ouldridge et al., 2017</xref>).</p><p>The free-energy <inline-formula><mml:math id="inf321"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> provided by the fuel turnover drives the readout around the cycle of modification and demodification (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The rate at which the fuel molecules do work is the power <inline-formula><mml:math id="inf322"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and the total work performed during the integration time <inline-formula><mml:math id="inf323"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf324"><mml:mrow><mml:mi>w</mml:mi><mml:mo>≡</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This work is spent on taking samples of receptor molecules that are bound to ligand because only they can modify the readout. The total number of effective samples of ligand-bound receptors during <inline-formula><mml:math id="inf325"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf326"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>), which means that the work per effective sample of a ligand-bound receptor is <inline-formula><mml:math id="inf327"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>).</p><p>To understand how energy limits the sensing precision, we can distinguish between two limiting regimes (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). When <inline-formula><mml:math id="inf328"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the quality parameter <inline-formula><mml:math id="inf329"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ7">Equation 7</xref>) and the work per sample of a ligand-bound receptor is <inline-formula><mml:math id="inf330"><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). In this irreversible regime, the SNR bound is given by <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf331"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. The power limits the sensing accuracy not because it limits the reliability of each sample but because it limits the rate <inline-formula><mml:math id="inf332"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> at which the receptor is sampled.</p><p>When <inline-formula><mml:math id="inf333"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the system enters the quasi-equilibrium regime in which the quality parameter <inline-formula><mml:math id="inf334"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>, noting that in the optimal system <inline-formula><mml:math id="inf335"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>). The sensing bound is now given by <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf336"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which is larger than <inline-formula><mml:math id="inf337"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> in the irreversible regime (where <inline-formula><mml:math id="inf338"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>). The quasi-equilibrium regime minimizes the sensing error for a given power constraint (<xref ref-type="fig" rid="fig3">Figure 3b</xref>) because this regime maximizes the number of effective measurements per work input <inline-formula><mml:math id="inf339"><mml:mrow><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>).</p><p>While the sensing precision for a given power and time constraint is higher in the quasi-reversible regime, more readout molecules are required to store the concentration measurements in this regime. Noting that the flux <inline-formula><mml:math id="inf340"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, it follows that in the irreversible regime (<inline-formula><mml:math id="inf341"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) the number of readout molecules consuming energy at a rate <inline-formula><mml:math id="inf342"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>irr</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>while in the quasi-equilibrium regime (<inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>) it is<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>qeq</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Since in the quasi-equilibrium regime <inline-formula><mml:math id="inf344"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf345"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>qeq</mml:mi></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>irr</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="disp-formula" rid="equ8">Equation 8</xref> shows that the sensing precision is fundamentally bounded not by the work <inline-formula><mml:math id="inf346"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, as observed for static signals (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>), but rather by the power <inline-formula><mml:math id="inf347"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> and the integration time <inline-formula><mml:math id="inf348"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> separately such that an optimal integration time <inline-formula><mml:math id="inf349"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> emerges. <xref ref-type="fig" rid="fig3">Figure 3f</xref> shows how <inline-formula><mml:math id="inf350"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> depends on <inline-formula><mml:math id="inf351"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>. Since the system cannot sense without any readout molecules, in the low-power regime the system maximizes <inline-formula><mml:math id="inf352"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> subject to the power constraint <inline-formula><mml:math id="inf353"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ10 equ11">Equations 10 and 11</xref>) by making <inline-formula><mml:math id="inf354"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> as large as possible, which is the signal correlation time <inline-formula><mml:math id="inf355"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> – increasing <inline-formula><mml:math id="inf356"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> further would average out the signal itself. As <inline-formula><mml:math id="inf357"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is increased, <inline-formula><mml:math id="inf358"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> rises and the sampling error decreases. When the sampling error becomes comparable to the dynamical error (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>), the system starts to trade a further reduction in the sampling error for a reduction in the dynamical error by decreasing <inline-formula><mml:math id="inf359"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula>. The sampling error and dynamical error are now reduced simultaneously by increasing <inline-formula><mml:math id="inf360"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and decreasing <inline-formula><mml:math id="inf361"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula>. This continues until the sampling interval <inline-formula><mml:math id="inf362"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> becomes comparable to the receptor correlation time <inline-formula><mml:math id="inf363"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, as marked by the yellow bar. Beyond this point, <inline-formula><mml:math id="inf364"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the sampling error is no longer limited by <inline-formula><mml:math id="inf365"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> but rather by <inline-formula><mml:math id="inf366"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> since <inline-formula><mml:math id="inf367"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> bounds the number of <italic>independent</italic> samples per receptor, <inline-formula><mml:math id="inf368"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The system has entered the Berg–Purcell regime, where <inline-formula><mml:math id="inf369"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> is determined by the trade-off between the dynamical error and the sampling error as set by the maximum number of independent samples, <inline-formula><mml:math id="inf370"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3c</xref>).</p></sec></sec><sec id="s2-4"><title>Optimal design</title><p>In sensing time-varying signals, a trade-off between time averaging and signal tracking is inevitable. Moreover, the optimal integration time depends on which resource is limiting, being zero when <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is limiting and finite when <inline-formula><mml:math id="inf372"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf373"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> is limiting (<xref ref-type="fig" rid="fig3">Figure 3</xref>). It is therefore not obvious whether these sensing systems still obey the optimal resource allocation principle as observed for systems sensing static concentrations (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>).</p><p>However, <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> shows that when for a <italic>given</italic> integration time <inline-formula><mml:math id="inf374"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf375"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the bounds on the sensing precision as set by, respectively, the number of receptors <inline-formula><mml:math id="inf376"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, the number of readout molecules <inline-formula><mml:math id="inf377"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, and the power <inline-formula><mml:math id="inf378"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> are equal. Each of these resources is then equally limiting sensing and no resource is in excess. We thus recover the optimal resource allocation principle:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Irrespective of whether the concentration fluctuates in time, the number of independent concentration measurements at the receptor level is <inline-formula><mml:math id="inf379"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which in an optimally designed system also equals the number of readout molecules <inline-formula><mml:math id="inf380"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and the energy <inline-formula><mml:math id="inf381"><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that are both necessary and sufficient to store these measurements reliably.</p><p>The design principle <inline-formula><mml:math id="inf382"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ12">Equation 12</xref>) predicts that there exists a driving force <inline-formula><mml:math id="inf383"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> that optimizes the trade-off between the number of samples and their accuracy. Noting that <inline-formula><mml:math id="inf384"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> reveals that the principle <inline-formula><mml:math id="inf385"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ12">Equation 12</xref>) specifies <inline-formula><mml:math id="inf386"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> for the optimal system in which <inline-formula><mml:math id="inf387"><mml:mrow><mml:mi>f</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf388"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> via the equation <inline-formula><mml:math id="inf389"><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf390"><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is defined in <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>. A numerical inspection shows that to a good approximation the solution of this equation is precisely given by the crossover from the quasi-equilibrium regime to the irreversible one: <inline-formula><mml:math id="inf391"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This can be understood by noting that in the quasi-equilibrium regime <inline-formula><mml:math id="inf392"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> can, for a given power and time constraint, be reduced by increasing <inline-formula><mml:math id="inf393"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>) <italic>without compromising the sensing precision</italic> (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf394"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>); in this regime, increasing <inline-formula><mml:math id="inf395"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> increases the reliability of each sample, and a smaller number of more reliable samples precisely compensates for a larger number of less reliable ones. Yet, when <inline-formula><mml:math id="inf396"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> becomes larger than <inline-formula><mml:math id="inf397"><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, the system enters the irreversible regime. Here, <inline-formula><mml:math id="inf398"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> corresponding to a given <inline-formula><mml:math id="inf399"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf400"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> constraint still decreases with <inline-formula><mml:math id="inf401"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ10">Equation 10</xref>), but the sensing error now increases (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf402"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>) because each sample has become (essentially) perfect in this regime – hence, the samples’ accuracy cannot (sufficiently) increase further to compensate for the reduction in the sampling rate <inline-formula><mml:math id="inf403"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="disp-formula" rid="equ12">Equation 12</xref> holds for any integration time <inline-formula><mml:math id="inf404"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, yet it does not specify <inline-formula><mml:math id="inf405"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. The cell membrane is highly crowded, and many systems employ time integration (<xref ref-type="bibr" rid="bib5">Berg and Purcell, 1977</xref>; <xref ref-type="bibr" rid="bib6">Bialek and Setayeshgar, 2005</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). This suggests that these systems employ time integration and accept the signal distortion that comes with it simply because there is not enough space on the membrane to increase <inline-formula><mml:math id="inf406"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. Our theory then allows us to predict the optimal integration time <inline-formula><mml:math id="inf407"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> based on the premise that <inline-formula><mml:math id="inf408"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is limiting. As <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> reveals, in this limit <inline-formula><mml:math id="inf409"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> does not only depend on <inline-formula><mml:math id="inf410"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> but also on <inline-formula><mml:math id="inf411"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf412"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf413"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. The optimal design of the system is then given by <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> but with <inline-formula><mml:math id="inf414"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> given by <inline-formula><mml:math id="inf415"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>opt</mml:mi></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>opt</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This design principle maximizes for a given number of receptors <inline-formula><mml:math id="inf416"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> the sensing precision and minimizes the number of readout molecules <inline-formula><mml:math id="inf417"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and power <inline-formula><mml:math id="inf418"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> needed to reach that precision.</p></sec><sec id="s2-5"><title>Comparison with experiment</title><p>To test our theory, we turn to the chemotaxis system of <italic>E. coli</italic>. This system contains a receptor that forms a complex with the kinase CheA. This complex, which is coarse-grained into <italic>R</italic> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>), can bind the ligand L and activate the intracellular messenger protein CheY (<italic>x</italic>) by phosphorylating it. Deactivation of CheY is catalyzed by CheZ, the effect of which is coarse-grained into the deactivation rate. This push–pull network allows <italic>E. coli</italic> to measure the current concentration, and the relaxation time of this network sets the integration time for the receptor (<xref ref-type="bibr" rid="bib49">Sartori and Tu, 2011</xref>). The system also exhibits adaptation on longer timescales due to receptor methylation and demethylation. The push–pull network and the adaptation system together allow the cell to measure concentration gradients via a temporal derivative, taking the difference between the current concentration and the past concentration as set by the adaptation time (<xref ref-type="bibr" rid="bib51">Segall et al., 1986</xref>). A <italic>lower</italic> bound for the error in the estimate of this difference is given by the error in the estimate of the current concentration, the central quantity of our theory. Here, we ask how accurately <italic>E. coli</italic> can estimate the latter and whether the sensing precision is sufficient to determine whether during a run the concentration has changed.</p><p>Our theory predicts that if the number of receptors is limiting then the optimal integration time <inline-formula><mml:math id="inf419"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is given by minimizing <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf420"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The number of receptor–CheA complexes depends on the growth rate and varies between <inline-formula><mml:math id="inf421"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf422"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib35">Li and Hazelbauer, 2004</xref>). The receptor correlation time for the binding of aspartate to the Tar receptor can be estimated from the measured dissociation constant (<xref ref-type="bibr" rid="bib62">Vaknin and Berg, 2007</xref>) and the association rate (<xref ref-type="bibr" rid="bib10">Danielson et al., 1994</xref>), <inline-formula><mml:math id="inf423"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mn>10</mml:mn><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). The timescale <inline-formula><mml:math id="inf424"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> of the input fluctuations is set by the typical run time, which is on the order of a few seconds, <inline-formula><mml:math id="inf425"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib55">Taute et al., 2015</xref>).</p><p>This leaves one parameter to be determined, <inline-formula><mml:math id="inf426"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. This is set by the spatial ligand–concentration profile and the typical length of a run. We have a good estimate of the latter. In shallow gradients, it is on the order of <inline-formula><mml:math id="inf427"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi><mml:mo>≈</mml:mo><mml:mn>50</mml:mn><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib55">Taute et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Jiang et al., 2010</xref>; <xref ref-type="bibr" rid="bib17">Flores et al., 2012</xref>); specifically, Figure 4 of <xref ref-type="bibr" rid="bib55">Taute et al., 2015</xref> shows that the typical run times are 1–2 s while the typical run speeds are <inline-formula><mml:math id="inf428"><mml:mrow><mml:mn>20</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>60</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ms</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, yielding a run length on the order of indeed 50 µm. We do not know the spatial concentration profiles that <italic>E. coli</italic> has experienced during its evolution. We can however get a sense of the scale by considering an exponential ligand–concentration gradient. For a profile <inline-formula><mml:math id="inf429"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> with length scale <italic>x</italic><sub>0</sub>, the relative change in the signal over the length of a run is <inline-formula><mml:math id="inf430"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>/</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We consider the range <inline-formula><mml:math id="inf431"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf432"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to shallow gradients with <inline-formula><mml:math id="inf433"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≳</mml:mo><mml:mn>500</mml:mn><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> in which cells move with a constant drift velocity (<xref ref-type="bibr" rid="bib52">Shimizu et al., 2010</xref>; <xref ref-type="bibr" rid="bib17">Flores et al., 2012</xref>).</p><p><xref ref-type="fig" rid="fig4">Figure 4a</xref> shows that as the gradient becomes steeper and <inline-formula><mml:math id="inf434"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> increases the optimal integration time <inline-formula><mml:math id="inf435"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases. This can be understood by noting that the relative importance of the dynamical error compared to the sampling error scales with <inline-formula><mml:math id="inf436"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>). Shallow ingredients thus allow for a larger integration time while steep gradients necessitate a shorter one.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The optimal integration time for the chemotaxis system of <italic>E. coli</italic>.</title><p>(<bold>a</bold>) The optimal integration time <inline-formula><mml:math id="inf437"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula>, obtained by numerically optimizing <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf438"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, as a function of the relative strength of the input noise, <inline-formula><mml:math id="inf439"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, for two different copy numbers <inline-formula><mml:math id="inf440"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> of the receptor–CheA complexes; for an exponential gradient with length scale <italic>x</italic><sub>0</sub>, the relative noise strength <inline-formula><mml:math id="inf441"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf442"><mml:mrow><mml:mi>l</mml:mi><mml:mo>≈</mml:mo><mml:mrow><mml:mn>50</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the run length of <italic>E. coli</italic>. It is seen that <inline-formula><mml:math id="inf443"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> increases as <inline-formula><mml:math id="inf444"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> decreases because the relative importance of the sampling error compared to the dynamical error increases. The figure also shows that <inline-formula><mml:math id="inf445"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases as <inline-formula><mml:math id="inf446"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is increased because that allows for more instantaneous measurements (see also <xref ref-type="fig" rid="fig3">Figure 3</xref>). The red bar indicates the range of the estimated integration time of <italic>E. coli</italic>, <inline-formula><mml:math id="inf447"><mml:mrow><mml:mrow><mml:mn>50</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>500</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, based on its attractant and repellent response, respectively (<xref ref-type="bibr" rid="bib54">Sourjik and Berg, 2002</xref>), divided by the input timescale <inline-formula><mml:math id="inf448"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> based on its typical run time of about a second (<xref ref-type="bibr" rid="bib4">Berg and Brown, 1972</xref>; <xref ref-type="bibr" rid="bib55">Taute et al., 2015</xref>). The panel indicates that <italic>E. coli</italic> has been optimized to detect shallow concentration gradients. (<bold>b</bold>) The signal-to-noise ratio <inline-formula><mml:math id="inf449"><mml:mrow><mml:msub><mml:mtext>SNR</mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf450"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mtext>SNR</mml:mtext></mml:mrow></mml:math></inline-formula> given by <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>, as a function of <inline-formula><mml:math id="inf451"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≃</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. To be able to detect the gradient, the <inline-formula><mml:math id="inf452"><mml:msub><mml:mtext>SNR</mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> must exceed unity. The panel shows that the shallowest gradient that <italic>E. coli</italic> can detect (marked with dashed red line) has, for <inline-formula><mml:math id="inf453"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, a length scale of <inline-formula><mml:math id="inf454"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>25000</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (corresponding to <inline-formula><mml:math id="inf455"><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>), which is consistent with experiments based on ramp responses (<xref ref-type="bibr" rid="bib52">Shimizu et al., 2010</xref>). Other parameter: receptor–ligand-binding correlation time <inline-formula><mml:math id="inf456"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib62">Vaknin and Berg, 2007</xref>; <xref ref-type="bibr" rid="bib10">Danielson et al., 1994</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-62574-fig4-v2.tif"/></fig><p>Experiments indicate that the relaxation rate of CheY is <inline-formula><mml:math id="inf457"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mmultiscripts><mml:mo>≈</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> for the attractant response and <inline-formula><mml:math id="inf458"><mml:mrow><mml:mi/><mml:mo>≈</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> for the repellent response (<xref ref-type="bibr" rid="bib54">Sourjik and Berg, 2002</xref>), such that the integration time <inline-formula><mml:math id="inf459"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>50</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mn>500</mml:mn><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib54">Sourjik and Berg, 2002</xref>; <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). <xref ref-type="fig" rid="fig4">Figure 4a</xref> shows that this integration time is optimal for detecting shallow gradients. Our theory thus predicts that the <italic>E. coli</italic> chemotaxis system has been optimized for sensing shallow gradients.</p><p>To navigate, the cells must be able to resolve the signal change over a run. During a run of duration <inline-formula><mml:math id="inf460"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula>, the system performs <inline-formula><mml:math id="inf461"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> independent concentration measurements. The effective error for these measurements is the instantaneous sensing error <inline-formula><mml:math id="inf462"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> divided by the number of independent measurements <inline-formula><mml:math id="inf463"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. Hence, the SNR for these concentration measurements is <inline-formula><mml:math id="inf464"><mml:mrow><mml:msub><mml:mtext>SNR</mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><xref ref-type="fig" rid="fig4">Figure 4b</xref> shows that our theory predicts that when <inline-formula><mml:math id="inf465"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, the shallowest gradient that cells can resolve, defined by <inline-formula><mml:math id="inf466"><mml:mrow><mml:msub><mml:mtext>SNR</mml:mtext><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, is <inline-formula><mml:math id="inf467"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, corresponding to <inline-formula><mml:math id="inf468"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>7500</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, while when <inline-formula><mml:math id="inf469"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf470"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf471"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mn>25000</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. The shallowest gradient is thus on the order of <inline-formula><mml:math id="inf472"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="bibr" rid="bib52">Shimizu et al., 2010</xref> show that <italic>E. coli</italic> cells are indeed able to sense such very shallow gradients: Figure 2A of <xref ref-type="bibr" rid="bib52">Shimizu et al., 2010</xref> shows that <italic>E. coli</italic> cells can detect exponential up ramps with rate <inline-formula><mml:math id="inf473"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.001</mml:mn><mml:mo>/</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>; using <inline-formula><mml:math id="inf474"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf475"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the run speed (<xref ref-type="bibr" rid="bib28">Jiang et al., 2010</xref>), this corresponds to <inline-formula><mml:math id="inf476"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≈</mml:mo><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Importantly, the predictions of our theory (<xref ref-type="fig" rid="fig4">Figure 4</xref>) concern the shallowest gradient that the system with the optimal integration time can resolve. These observations indicate that the optimal integration time is not only sufficient to make navigation in these very shallow gradients possible but also necessary.</p><p><xref ref-type="fig" rid="fig4">Figure 4</xref> also shows that <inline-formula><mml:math id="inf477"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> decreases as the number of receptor–CheA complex, <inline-formula><mml:math id="inf478"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, increases because the latter allows for more instantaneous measurements, reducing the need for time integration (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). Interestingly, the data of <xref ref-type="bibr" rid="bib35">Li and Hazelbauer, 2004</xref> shows that the copy numbers of the chemotaxis proteins vary with the growth rate. Clearly, it would be of interest to directly measure the response time in different strains under different growth conditions.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Here, we have integrated ideas from <xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>; <xref ref-type="bibr" rid="bib24">Hilfinger and Paulsson, 2011</xref>; and <xref ref-type="bibr" rid="bib7">Bowsher et al., 2013</xref> on information transmission via time-varying signals with the sampling framework of <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref> to develop a unified theory of cellular sensing. The theory is founded on the concept of the dynamic input–output relation <inline-formula><mml:math id="inf479"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. It allows us to develop the idea that the cell employs the readout system to estimate the average receptor occupancy <inline-formula><mml:math id="inf480"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf481"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and then exploits the mapping <inline-formula><mml:math id="inf482"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to estimate the current ligand concentration <italic>L</italic> from <inline-formula><mml:math id="inf483"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>. The theory reveals that the error in the estimate of <italic>L</italic> depends on how accurately the cell samples the receptor state to estimate <inline-formula><mml:math id="inf484"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, and on how much <inline-formula><mml:math id="inf485"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, which is determined by the concentration in the past <inline-formula><mml:math id="inf486"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, reflects the current ligand concentration. These two distinct sources of error give rise to the sampling error and dynamical error in <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>, respectively.</p><p>While the system contains no less than 11 parameters, <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> provides an intuitive expression for the sensing error in terms of collective variables that have a clear interpretation. The dynamical error depends only on the timescales in the problem, most notably <inline-formula><mml:math id="inf487"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The sampling error depends on how accurately the readout system estimates <inline-formula><mml:math id="inf488"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, which is determined by the number of receptor samples, their independence, and their accuracy; yet it also depends on <inline-formula><mml:math id="inf489"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> via the dynamic gain, which determines how the error in the estimate of <inline-formula><mml:math id="inf490"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> propagates to that of <italic>L</italic>. The trade-off between the sampling error and dynamical error yields an optimal integration time.</p><p>Our study reveals that the optimal integration time <inline-formula><mml:math id="inf491"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> depends in a non-trivial manner on the design of the system. When the number of readout molecules <inline-formula><mml:math id="inf492"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is smaller than the number of receptors <inline-formula><mml:math id="inf493"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, time integration is not possible and the optimal system is an instantaneous responder with <inline-formula><mml:math id="inf494"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. When the power <inline-formula><mml:math id="inf495"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, rather than <inline-formula><mml:math id="inf496"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, is limiting, <inline-formula><mml:math id="inf497"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> is determined by the trade-off between the sampling error and dynamical error. In both scenarios, however, one resource, <inline-formula><mml:math id="inf498"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf499"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>, is limiting the sensing precision. In an optimally designed system, all resources are equally limiting so that no resource is wasted. This yields the resource allocation principle (<xref ref-type="disp-formula" rid="equ12">Equation 12)</xref>, first identified in <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>, for sensing static concentrations. The reason it can be generalized to time-varying signals is that the principle concerns the optimal design of the readout system for estimating the receptor occupancy over a given integration time <inline-formula><mml:math id="inf500"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, which holds for any type of input: the number of independent concentration measurements at the receptor level is <inline-formula><mml:math id="inf501"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, irrespective of how the input varies, and in an optimally designed system this also equals the number of readout molecules <inline-formula><mml:math id="inf502"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and energy <inline-formula><mml:math id="inf503"><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to store these measurements reliably. We thus expect that the design principle also holds for systems that sense signals that vary more strongly in time (<xref ref-type="bibr" rid="bib42">Mora and Nemenman, 2019</xref>).</p><p>While the allocation principle <xref ref-type="disp-formula" rid="equ12">Equation 12</xref> holds for any <inline-formula><mml:math id="inf504"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, it does not specify the optimal integration time <inline-formula><mml:math id="inf505"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula>. However, our theory predicts that if the number of receptors <inline-formula><mml:math id="inf506"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is limiting, then there exists a <inline-formula><mml:math id="inf507"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> that maximizes the sensing precision for that <inline-formula><mml:math id="inf508"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf509"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>). Via the allocation principle <xref ref-type="disp-formula" rid="equ13">Equation 13</xref>, <inline-formula><mml:math id="inf510"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf511"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> then together determine the minimal number of readout molecules <inline-formula><mml:math id="inf512"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and power <inline-formula><mml:math id="inf513"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> to reach that precision. The resource allocation principle, together with the optimal integration time, thus completely specifies the optimal design of the sensing system.</p><p>Applying our theory to the <italic>E. coli</italic> chemotaxis system shows that this system not only obeys the resource allocation principle (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>) but also that the predicted optimal integration time to measure shallow gradients is in agreement with that measured experimentally (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). This is remarkable because there is not a single fit parameter in our theory. Moreover, <xref ref-type="fig" rid="fig4">Figure 4b</xref> shows that the optimal integration time is not only sufficient to enable the sensing of these shallow gradients but also necessary. This is interesting because the sensing precision could also be increased by increasing the number of receptors, readout molecules, and energy devoted to sensing – but this would be costly. Our results thus demonstrate not only that the chemotaxis system obeys the design principles as revealed by our theory but also that there is a strong selection pressure to design sensing systems optimally, that is, to maximize the sensing precision given the resource constraints.</p><p>Our theory is based on a Gaussian model and describes the optimal sensing system that minimizes the mean square error in the estimate of the ligand concentration (see <xref ref-type="disp-formula" rid="equ1">Equation 1)</xref>. The latter is precisely the performance criterion of Wiener–Kolmogorov (<xref ref-type="bibr" rid="bib14">Extrapolation, 1950</xref>; <xref ref-type="bibr" rid="bib31">Kolmogorov, 1992</xref>) and <xref ref-type="bibr" rid="bib30">Kalman, 1960</xref> filtering theory, which, moreover, become exact for systems that obey Gaussian statistics. In fact, since our system (including the input signal) is stationary, they predict the same optimal filter, which is an exponential filter for signals that are memoryless. The signals studied here belong to this class, and the push–pull network forms an exponential filter (<xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>). This underscores the idea that our theory gives a complete description, in terms of all the required resources, for the optimal design of cellular sensing systems that need to estimate this type of signals. Furthermore, because our model is Gaussian, the goal of minimizing the mean-square error in the estimate of the input signal is equivalent to maximizing the mutual information between the input (the ligand concentration) and the output (the readout <inline-formula><mml:math id="inf514"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>).</p><p>In recent years, filtering theories and information theory have been applied increasingly to neuronal and cellular systems (<xref ref-type="bibr" rid="bib34">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib8">Brenner et al., 2000</xref>; <xref ref-type="bibr" rid="bib15">Fairhall et al., 2001</xref>; <xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib64">Ziv et al., 2007</xref>; <xref ref-type="bibr" rid="bib45">Nemenman et al., 2008</xref>; <xref ref-type="bibr" rid="bib9">Cheong et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Nemenman, 2012</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Husain et al., 2019</xref>; <xref ref-type="bibr" rid="bib57">Tkacik et al., 2008</xref>; <xref ref-type="bibr" rid="bib59">Tkačik and Walczak, 2011</xref>; <xref ref-type="bibr" rid="bib11">Dubuis et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Monti and Wolde, 2016</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>). A key concept in these theories is that optimal sensing systems match the response to the statistics of the input. When the noise is weak, maximizing the entropy of the output distribution becomes paramount, which entails matching the shape of the input–output relation to the shape of the input distribution to generate a flat output distribution (<xref ref-type="bibr" rid="bib34">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib57">Tkacik et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>). Yet, when the noise is large, the optimal response is also shaped by the requirement to tame the propagation of noise in the input signal (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>; <xref ref-type="bibr" rid="bib40">Monti et al., 2018b</xref>; <xref ref-type="bibr" rid="bib42">Mora and Nemenman, 2019</xref>) or to lift the signal above the intrinsic noise in the response system (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>; <xref ref-type="bibr" rid="bib7">Bowsher et al., 2013</xref>). In Appendix 3, we show that estimating the concentration from <inline-formula><mml:math id="inf515"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is equivalent to that via readout <inline-formula><mml:math id="inf516"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. This makes it possible to connect our sampling framework, which is based on <inline-formula><mml:math id="inf517"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, to filtering and information theory, which are based on <inline-formula><mml:math id="inf518"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. In particular, we show in this appendix how the optimal integration and dynamic gain can be understood from these ideas on matching the response to the input. We also briefly discuss in Appendix 3 the concepts from information theory that are beyond the scope of the Gaussian model considered here.</p><p>Yet, our discrete sampling framework gives a detailed description of how the optimal design of sensing systems depends on the statistics of the input signal in terms of all the required cellular resources: protein copies, time, and energy. In an optimal system, each receptor is sampled once every receptor–ligand correlation time <inline-formula><mml:math id="inf519"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf520"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>≈</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the number of samples per receptor is <inline-formula><mml:math id="inf521"><mml:mrow><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The optimal integration time <inline-formula><mml:math id="inf522"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> for a given <inline-formula><mml:math id="inf523"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is determined by the trade-off between the age of the samples and the number required for averaging the receptor state. When the input varies more rapidly, the samples need to be refreshed more regularly: to keep the dynamical error and the dynamic gain constant, <inline-formula><mml:math id="inf524"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> must decrease linearly with <inline-formula><mml:math id="inf525"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ6">Equation 6)</xref>. Yet, only decreasing <inline-formula><mml:math id="inf526"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:math></inline-formula> would inevitably increase the sampling error <inline-formula><mml:math id="inf527"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in estimating the receptor occupancy because the sampling interval <inline-formula><mml:math id="inf528"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>opt</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> would become smaller than <inline-formula><mml:math id="inf529"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula>, creating redundant samples. To keep the sensing precision constant, the number of receptors <inline-formula><mml:math id="inf530"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> needs to be raised with <inline-formula><mml:math id="inf531"><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:none/><mml:none/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mmultiscripts></mml:math></inline-formula>, such that the sampling interval <inline-formula><mml:math id="inf532"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow><mml:mo>/</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>opt</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> remains of order <inline-formula><mml:math id="inf533"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> and the decrease in the number of samples per receptor, <inline-formula><mml:math id="inf534"><mml:mrow><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is precisely compensated for by the increase in <inline-formula><mml:math id="inf535"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. The total number of independent concentration measurements, <inline-formula><mml:math id="inf536"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and hence the number of readout molecules <inline-formula><mml:math id="inf537"><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>opt</mml:mi></mml:msubsup></mml:math></inline-formula> to store these, does indeed not change. In contrast, the required power <inline-formula><mml:math id="inf538"><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>opt</mml:mi></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> rises (<xref ref-type="disp-formula" rid="equ12">Equation 12</xref>): each receptor molecule is sampled each <inline-formula><mml:math id="inf539"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> at <inline-formula><mml:math id="inf540"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow><mml:mo>≈</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and the increase in <inline-formula><mml:math id="inf541"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> raises the sampling rate <inline-formula><mml:math id="inf542"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>opt</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mi>opt</mml:mi></mml:msup></mml:mrow><mml:mo>∼</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi>opt</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:none/><mml:none/><mml:mi>opt</mml:mi></mml:mmultiscripts></mml:mrow></mml:mrow></mml:math></inline-formula>. Our theory thus predicts that when the input varies more rapidly the number of receptors and the power must rise to maintain a required sensing precision, while the number of readout molecules does not.</p><p>The fitness benefit of a sensing system does not only depend on the sensing precision but also on the energetic cost of maintaining and running the system. In principle, the cell can reduce the sensing error arbitrarily by increasing <inline-formula><mml:math id="inf543"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and decreasing <inline-formula><mml:math id="inf544"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. Our resource allocation principle (<xref ref-type="disp-formula" rid="equ12">Equation 12</xref>) shows that then not only the number of readout molecules needs to be raised but also the power. Clearly, improving the sensing precision comes at a cost: more copies of the components of the sensing system need to be synthesized every cell cycle, and more energy is needed to run the system. Our theory (i.e., <xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) makes it possible to derive the Pareto front that quantifies the trade-off between the maximal sensing precision and the cost of making the sensing system (see <xref ref-type="fig" rid="fig5">Figure 5</xref>). Importantly, the design of the optimal system at the Pareto front obeys, to a good approximation, our resource allocation principle (<xref ref-type="disp-formula" rid="equ12">Equation 12)</xref>. This is because this principle specifies the optimal <italic>ratios</italic> of <inline-formula><mml:math id="inf545"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf546"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf547"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>, and <inline-formula><mml:math id="inf548"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> given the input statistics, and these ratios are fairly insensitive to the costs of the respective resources: resources that are in excess cannot improve sensing and are thus wasted, no matter how cheap they are. It probably explains why our theory, without any fit parameters, not only predicts the integration time that allows <italic>E. coli</italic> to sense shallow gradients (<xref ref-type="fig" rid="fig4">Figure 4</xref>) but also the number of receptor and readout molecules (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>The benefit of a sensing system depends on the sensing precision it can achieve and the cost of making it.</title><p>The Pareto front characterizes the trade-off between the maximal sensing precision, quantified by the maximal mutual information <inline-formula><mml:math id="inf549"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the cost of making the sensing system, <inline-formula><mml:math id="inf550"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">X</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf551"><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">X</mml:mi></mml:msub></mml:math></inline-formula> is the relative cost of making a readout versus a receptor protein, here taken to be <inline-formula><mml:math id="inf552"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi mathvariant="normal">X</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. System designs below the Pareto front are suboptimal and can be improved by reducing the cost, that is, the number of proteins, and / or increasing the sensing precision. The optimal systems at the Pareto front obey, to a good approximation, the allocation principle <xref ref-type="disp-formula" rid="equ12">Equation 12</xref>. The Pareto front, formed by the maximal value <inline-formula><mml:math id="inf553"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>max</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="inf554"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>SNR</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of <italic>C</italic>, is obtained by minimizing <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> over <inline-formula><mml:math id="inf555"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> subject to the constraint <inline-formula><mml:math id="inf556"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>; the quality parameter is <inline-formula><mml:math id="inf557"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mi>opt</mml:mi></mml:msup><mml:mo>≈</mml:mo><mml:mn>0.76</mml:mn></mml:mrow></mml:math></inline-formula> corresponding to <inline-formula><mml:math id="inf558"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msup><mml:mo>≈</mml:mo><mml:mn>4</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf559"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf560"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-62574-fig5-v2.tif"/></fig><p>In our study, we have limited ourselves to a canonical push–pull motif. Yet, the work of <xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref> indicates that our results hold more generally, pertaining also to systems that employ cooperativity, negative or positive feedback, or multiple layers, as the MAPK cascade. While multiple layers and feedback change the response time, they do not make time integration more efficient in terms of readout molecules or energy (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). And provided it does not increase the input correlation time (<xref ref-type="bibr" rid="bib53">Skoge et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Ten Wolde et al., 2016</xref>), cooperative ligand binding can reduce the sensing error per sample, but the resource requirements in terms of readout molecules and energy per sample do not change (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). In all these systems, time integration requires that the history of the receptor is stored, which demands protein copies and energy.</p><p>Lastly, in this article we have studied the resource requirements for estimating the current concentration via the mechanism of time integration. However, to understand how <italic>E. coli</italic> navigates in a concentration gradient, we do not only have to understand how the system filters the high-frequency ligand-binding noise via time averaging but also how on longer timescales the system adapts to changes in the ligand concentration (<xref ref-type="bibr" rid="bib49">Sartori and Tu, 2011</xref>). This adaptation system also exhibits a trade-off between accuracy, speed, and power (<xref ref-type="bibr" rid="bib32">Lan et al., 2012</xref>; <xref ref-type="bibr" rid="bib50">Sartori and Tu, 2015</xref>). Intriguingly, simulations indicate that the combination of sensing and adaptation allows <italic>E. coli</italic> not only to accurately estimate the current concentration but also the future ligand concentration (<xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>). It will be interesting to see whether an optimal resource allocation principle can be formulated for systems that need to predict future ligand concentrations.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>Methods are described in Appendices 1–3. Appendix 1 derives the central result of our article (<xref ref-type="disp-formula" rid="equ6">Equation 6)</xref>. Appendix 2 derives the fundamental resources and the corresponding sensing limits (<xref ref-type="disp-formula" rid="equ8 equ9">Equations 8 and 9)</xref>. Appendix 3 describes how the optimal gain and integration time can be understood using ideas from filtering and information theory.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We wish to acknowledge Bela Mulder, Tom Shimizu, and Tom Ouldridge for many fruitful discussions and a careful reading of the manuscript. This work is part of the research program of the Netherlands Organisation for Scientific Research (NWO) and was performed at the research institute AMOLF.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Investigation, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Funding acquisition, Investigation, Methodology, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-62574-transrepform-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Alon</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><source>Introduction to Systems Biology: Design Principles of Biological Networks</source><publisher-loc>Boca Raton, FL</publisher-loc><publisher-name>CRC press</publisher-name><pub-id pub-id-type="doi">10.1016/j.mbs.2008.07.002</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andrews</surname> <given-names>BW</given-names></name><name><surname>Yi</surname> <given-names>TM</given-names></name><name><surname>Iglesias</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Optimal noise filtering in the chemotactic response of <italic>Escherichia coli</italic></article-title><source>PLOS Computational Biology</source><volume>2</volume><elocation-id>e154</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.0020154</pub-id><pub-id pub-id-type="pmid">17112312</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname> <given-names>NB</given-names></name><name><surname>Mugler</surname> <given-names>A</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Optimal prediction by cellular signaling networks</article-title><source>Physical Review Letters</source><volume>115</volume><elocation-id>258103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.115.258103</pub-id><pub-id pub-id-type="pmid">26722947</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name><name><surname>Brown</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>Chemotaxis in <italic>Escherichia coli</italic> analysed by three-dimensional tracking</article-title><source>Nature</source><volume>239</volume><fpage>500</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1038/239500a0</pub-id><pub-id pub-id-type="pmid">4563019</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname> <given-names>HC</given-names></name><name><surname>Purcell</surname> <given-names>EM</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Physics of chemoreception</article-title><source>Biophysical Journal</source><volume>20</volume><fpage>193</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1016/S0006-3495(77)85544-6</pub-id><pub-id pub-id-type="pmid">911982</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>Setayeshgar</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Physical limits to biochemical signaling</article-title><source>PNAS</source><volume>102</volume><fpage>10040</fpage><lpage>10045</lpage><pub-id pub-id-type="doi">10.1073/pnas.0504321102</pub-id><pub-id pub-id-type="pmid">16006514</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bowsher</surname> <given-names>CG</given-names></name><name><surname>Voliotis</surname> <given-names>M</given-names></name><name><surname>Swain</surname> <given-names>PS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The fidelity of dynamic signaling by noisy biomolecular networks</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1002965</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002965</pub-id><pub-id pub-id-type="pmid">23555208</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brenner</surname> <given-names>N</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>de Ruyter van Steveninck</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Adaptive rescaling maximizes information transmission</article-title><source>Neuron</source><volume>26</volume><fpage>695</fpage><lpage>702</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)81205-2</pub-id><pub-id pub-id-type="pmid">10896164</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheong</surname> <given-names>R</given-names></name><name><surname>Rhee</surname> <given-names>A</given-names></name><name><surname>Wang</surname> <given-names>CJ</given-names></name><name><surname>Nemenman</surname> <given-names>I</given-names></name><name><surname>Levchenko</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Information transduction capacity of noisy biochemical signaling networks</article-title><source>Science</source><volume>334</volume><fpage>354</fpage><lpage>358</lpage><pub-id pub-id-type="doi">10.1126/science.1204553</pub-id><pub-id pub-id-type="pmid">21921160</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danielson</surname> <given-names>MA</given-names></name><name><surname>Biemann</surname> <given-names>HP</given-names></name><name><surname>Koshland</surname> <given-names>DE</given-names></name><name><surname>Falke</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Attractant- and disulfide-induced conformational changes in the ligand binding domain of the chemotaxis aspartate receptor: a 19F NMR study</article-title><source>Biochemistry</source><volume>33</volume><fpage>6100</fpage><lpage>6109</lpage><pub-id pub-id-type="doi">10.1021/bi00186a009</pub-id><pub-id pub-id-type="pmid">7910759</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dubuis</surname> <given-names>JO</given-names></name><name><surname>Tkacik</surname> <given-names>G</given-names></name><name><surname>Wieschaus</surname> <given-names>EF</given-names></name><name><surname>Gregor</surname> <given-names>T</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Positional information, in bits</article-title><source>PNAS</source><volume>110</volume><fpage>16301</fpage><lpage>16308</lpage><pub-id pub-id-type="doi">10.1073/pnas.1315642110</pub-id><pub-id pub-id-type="pmid">24089448</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durrieu</surname> <given-names>L</given-names></name><name><surname>Kirrmaier</surname> <given-names>D</given-names></name><name><surname>Schneidt</surname> <given-names>T</given-names></name><name><surname>Kats</surname> <given-names>I</given-names></name><name><surname>Raghavan</surname> <given-names>S</given-names></name><name><surname>Hufnagel</surname> <given-names>L</given-names></name><name><surname>Saunders</surname> <given-names>TE</given-names></name><name><surname>Knop</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Bicoid gradient formation mechanism and dynamics revealed by protein lifetime analysis</article-title><source>Molecular Systems Biology</source><volume>14</volume><elocation-id>e8355</elocation-id><pub-id pub-id-type="doi">10.15252/msb.20188355</pub-id><pub-id pub-id-type="pmid">30181144</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Endres</surname> <given-names>RG</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Maximum likelihood and the single receptor</article-title><source>Physical Review Letters</source><volume>103</volume><elocation-id>158101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.103.158101</pub-id><pub-id pub-id-type="pmid">19905667</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Extrapolation</surname> <given-names>WN</given-names></name></person-group><year iso-8601-date="1950">1950</year><source>Extrapolation, Interpolation, and Smoothing of Stationary Time Series: With Engineering Applications</source><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fairhall</surname> <given-names>AL</given-names></name><name><surname>Lewen</surname> <given-names>GD</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>de Ruyter Van Steveninck</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Efficiency and ambiguity in an adaptive neural code</article-title><source>Nature</source><volume>412</volume><fpage>787</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1038/35090500</pub-id><pub-id pub-id-type="pmid">11518957</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fancher</surname> <given-names>S</given-names></name><name><surname>Mugler</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Fundamental limits to collective concentration sensing in cell populations</article-title><source>Physical Review Letters</source><volume>118</volume><elocation-id>078101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.118.078101</pub-id><pub-id pub-id-type="pmid">28256844</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flores</surname> <given-names>M</given-names></name><name><surname>Shimizu</surname> <given-names>TS</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name><name><surname>Tostevin</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Signaling noise enhances chemotactic drift of <italic>E. coli</italic></article-title><source>Physical Review Letters</source><volume>109</volume><elocation-id>148101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.148101</pub-id><pub-id pub-id-type="pmid">23083290</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gardiner</surname> <given-names>CW</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Stochastic Methods: A Handbook for the Natural and Social Sciences</source><publisher-loc>Berlin</publisher-loc><publisher-name>Springer-Verlag</publisher-name></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldbeter</surname> <given-names>A</given-names></name><name><surname>Koshland</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>An amplified sensitivity arising from covalent modification in biological systems</article-title><source>PNAS</source><volume>78</volume><fpage>6840</fpage><lpage>6844</lpage><pub-id pub-id-type="doi">10.1073/pnas.78.11.6840</pub-id><pub-id pub-id-type="pmid">6947258</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Govern</surname> <given-names>CC</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Fundamental limits on sensing chemical concentrations with linear biochemical networks</article-title><source>Physical Review Letters</source><volume>109</volume><elocation-id>218103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.109.218103</pub-id><pub-id pub-id-type="pmid">23215617</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Govern</surname> <given-names>CC</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2014">2014a</year><article-title>Energy dissipation and noise correlations in biochemical sensing</article-title><source>Physical Review Letters</source><volume>113</volume><elocation-id>258102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.258102</pub-id><pub-id pub-id-type="pmid">25554909</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Govern</surname> <given-names>CC</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2014">2014b</year><article-title>Optimal resource allocation in cellular sensing systems</article-title><source>PNAS</source><volume>111</volume><fpage>17486</fpage><lpage>17491</lpage><pub-id pub-id-type="doi">10.1073/pnas.1411524111</pub-id><pub-id pub-id-type="pmid">25422473</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartich</surname> <given-names>D</given-names></name><name><surname>Seifert</surname> <given-names>U</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Optimal inference strategies and their implications for the linear noise approximation</article-title><source>Physical Review E</source><volume>94</volume><elocation-id>042416</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.94.042416</pub-id><pub-id pub-id-type="pmid">27841626</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hilfinger</surname> <given-names>A</given-names></name><name><surname>Paulsson</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Separating intrinsic from extrinsic fluctuations in dynamic biological systems</article-title><source>PNAS</source><volume>108</volume><fpage>12167</fpage><lpage>12172</lpage><pub-id pub-id-type="doi">10.1073/pnas.1018832108</pub-id><pub-id pub-id-type="pmid">21730172</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinczewski</surname> <given-names>M</given-names></name><name><surname>Thirumalai</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cellular signaling networks function as generalized Wiener-Kolmogorov filters to suppress noise</article-title><source>Physical Review X</source><volume>4</volume><fpage>3</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1103/PhysRevX.4.041017</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname> <given-names>B</given-names></name><name><surname>Chen</surname> <given-names>W</given-names></name><name><surname>Rappel</surname> <given-names>WJ</given-names></name><name><surname>Levine</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Physical limits on cellular sensing of spatial gradients</article-title><source>Physical Review Letters</source><volume>105</volume><elocation-id>048104</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.105.048104</pub-id><pub-id pub-id-type="pmid">20867888</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husain</surname> <given-names>K</given-names></name><name><surname>Pittayakanchit</surname> <given-names>W</given-names></name><name><surname>Pattanayak</surname> <given-names>G</given-names></name><name><surname>Rust</surname> <given-names>MJ</given-names></name><name><surname>Murugan</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Kalman-like Self-Tuned sensitivity in biophysical sensing</article-title><source>Cell Systems</source><volume>9</volume><fpage>459</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2019.08.008</pub-id><pub-id pub-id-type="pmid">31563474</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname> <given-names>L</given-names></name><name><surname>Ouyang</surname> <given-names>Q</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Quantitative modeling of <italic>Escherichia coli</italic> chemotactic motion in environments varying in space and time</article-title><source>PLOS Computational Biology</source><volume>6</volume><elocation-id>e1000735</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000735</pub-id><pub-id pub-id-type="pmid">20386737</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaizu</surname> <given-names>K</given-names></name><name><surname>de Ronde</surname> <given-names>W</given-names></name><name><surname>Paijmans</surname> <given-names>J</given-names></name><name><surname>Takahashi</surname> <given-names>K</given-names></name><name><surname>Tostevin</surname> <given-names>F</given-names></name><name><surname>ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The Berg-Purcell limit revisited</article-title><source>Biophysical Journal</source><volume>106</volume><fpage>976</fpage><lpage>985</lpage><pub-id pub-id-type="doi">10.1016/j.bpj.2013.12.030</pub-id><pub-id pub-id-type="pmid">24560000</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalman</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1960">1960</year><article-title>A new approach to linear filtering and prediction problems</article-title><source>Journal of Basic Engineering</source><volume>82</volume><fpage>35</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1115/1.3662552</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kolmogorov</surname> <given-names>AN</given-names></name></person-group><year iso-8601-date="1992">1992</year><chapter-title>Probability theory and mathematical statistics</chapter-title><person-group person-group-type="editor"><name><surname>Watanabe</surname> <given-names>S</given-names></name><name><surname>Prokhorov</surname> <given-names>J. V</given-names></name></person-group><source>Selected Works of A. N. Kolmogorov</source><publisher-loc>Netherlands</publisher-loc><publisher-name>Springer Science &amp; Business Media</publisher-name><fpage>8</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1007/BFb0078455</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lan</surname> <given-names>G</given-names></name><name><surname>Sartori</surname> <given-names>P</given-names></name><name><surname>Neumann</surname> <given-names>S</given-names></name><name><surname>Sourjik</surname> <given-names>V</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The energy-speed-accuracy tradeoff in sensory adaptation</article-title><source>Nature Physics</source><volume>8</volume><fpage>422</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1038/nphys2276</pub-id><pub-id pub-id-type="pmid">22737175</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lang</surname> <given-names>AH</given-names></name><name><surname>Fisher</surname> <given-names>CK</given-names></name><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Mehta</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Thermodynamics of statistical inference by cells</article-title><source>Physical Review Letters</source><volume>113</volume><elocation-id>148103</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.113.148103</pub-id><pub-id pub-id-type="pmid">25325665</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laughlin</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>A simple coding procedure enhances a neuron's information capacity</article-title><source>Zeitschrift Für Naturforschung C</source><volume>36</volume><fpage>910</fpage><lpage>912</lpage><pub-id pub-id-type="doi">10.1515/znc-1981-9-1040</pub-id><pub-id pub-id-type="pmid">7303823</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Hazelbauer</surname> <given-names>GL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Cellular stoichiometry of the components of the chemotaxis signaling complex</article-title><source>Journal of Bacteriology</source><volume>186</volume><fpage>3687</fpage><lpage>3694</lpage><pub-id pub-id-type="doi">10.1128/JB.186.12.3687-3694.2004</pub-id><pub-id pub-id-type="pmid">15175281</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname> <given-names>J</given-names></name><name><surname>Zucker</surname> <given-names>SW</given-names></name><name><surname>Emonet</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Feedback between motion and sensation provides nonlinear boost in run-and-tumble navigation</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005429</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005429</pub-id><pub-id pub-id-type="pmid">28264023</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Malaguti</surname> <given-names>G</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Theory for the optimal detection of time-varying signals in cellular sensing systems</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1902.09332">https://arxiv.org/abs/1902.09332</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mehta</surname> <given-names>P</given-names></name><name><surname>Schwab</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Energetic costs of cellular computation</article-title><source>PNAS</source><volume>109</volume><fpage>17978</fpage><lpage>17982</lpage><pub-id pub-id-type="doi">10.1073/pnas.1207814109</pub-id><pub-id pub-id-type="pmid">23045633</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monti</surname> <given-names>M</given-names></name><name><surname>Lubensky</surname> <given-names>DK</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2018">2018a</year><article-title>Optimal entrainment of circadian clocks in the presence of noise</article-title><source>Physical Review E</source><volume>97</volume><elocation-id>032405</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.97.032405</pub-id><pub-id pub-id-type="pmid">29776095</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monti</surname> <given-names>M</given-names></name><name><surname>Lubensky</surname> <given-names>DK</given-names></name><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2018">2018b</year><article-title>Robustness of clocks to input noise</article-title><source>Physical Review Letters</source><volume>121</volume><elocation-id>078101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.121.078101</pub-id><pub-id pub-id-type="pmid">30169070</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Monti</surname> <given-names>M</given-names></name><name><surname>Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The accuracy of telling time via oscillatory signals</article-title><source>Physical Biology</source><volume>13</volume><fpage>035005</fpage><lpage>035014</lpage><pub-id pub-id-type="doi">10.1088/1478-3975/13/3/035005</pub-id><pub-id pub-id-type="pmid">27203353</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Nemenman</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Physical limit to concentration sensing in a changing environment</article-title><source>Physical Review Letters</source><volume>123</volume><elocation-id>198101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.123.198101</pub-id><pub-id pub-id-type="pmid">31765216</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mora</surname> <given-names>T</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Limits of sensing temporal concentration changes by single cells</article-title><source>Physical Review Letters</source><volume>104</volume><elocation-id>248101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.104.248101</pub-id><pub-id pub-id-type="pmid">20867338</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mugler</surname> <given-names>A</given-names></name><name><surname>Levchenko</surname> <given-names>A</given-names></name><name><surname>Nemenman</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Limits to the precision of gradient sensing with spatial communication and temporal integration</article-title><source>PNAS</source><volume>113</volume><fpage>E689</fpage><lpage>E695</lpage><pub-id pub-id-type="doi">10.1073/pnas.1509597112</pub-id><pub-id pub-id-type="pmid">26792517</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nemenman</surname> <given-names>I</given-names></name><name><surname>Lewen</surname> <given-names>GD</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name><name><surname>de Ruyter van Steveninck</surname> <given-names>RR</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural coding of natural stimuli: information at sub-millisecond resolution</article-title><source>PLOS Computational Biology</source><volume>4</volume><elocation-id>e1000025</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000025</pub-id><pub-id pub-id-type="pmid">18369423</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nemenman</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Gain control in molecular information processing: lessons from neuroscience</article-title><source>Physical Biology</source><volume>9</volume><fpage>026003</fpage><lpage>026008</lpage><pub-id pub-id-type="doi">10.1088/1478-3975/9/2/026003</pub-id><pub-id pub-id-type="pmid">22475952</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ouldridge</surname> <given-names>TE</given-names></name><name><surname>Govern</surname> <given-names>CC</given-names></name><name><surname>ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Thermodynamics of computational copying in biochemical systems</article-title><source>Physical Review X</source><volume>7</volume><elocation-id>021004</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevX.7.021004</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rappel</surname> <given-names>WJ</given-names></name><name><surname>Levine</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Receptor noise and directional sensing in eukaryotic chemotaxis</article-title><source>Physical Review Letters</source><volume>100</volume><elocation-id>228101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.100.228101</pub-id><pub-id pub-id-type="pmid">18643461</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sartori</surname> <given-names>P</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Noise filtering strategies in adaptive biochemical signaling networks: application to <italic>E. coli</italic> chemotaxis</article-title><source>Journal of Statistical Physics</source><volume>142</volume><fpage>1206</fpage><lpage>1217</lpage><pub-id pub-id-type="doi">10.1007/s10955-011-0169-z</pub-id><pub-id pub-id-type="pmid">22977289</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sartori</surname> <given-names>P</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Free energy cost of reducing noise while maintaining a high sensitivity</article-title><source>Physical Review Letters</source><volume>115</volume><elocation-id>118102</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.115.118102</pub-id><pub-id pub-id-type="pmid">26406857</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segall</surname> <given-names>JE</given-names></name><name><surname>Block</surname> <given-names>SM</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Temporal comparisons in bacterial chemotaxis</article-title><source>PNAS</source><volume>83</volume><fpage>8987</fpage><lpage>8991</lpage><pub-id pub-id-type="doi">10.1073/pnas.83.23.8987</pub-id><pub-id pub-id-type="pmid">3024160</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shimizu</surname> <given-names>TS</given-names></name><name><surname>Tu</surname> <given-names>Y</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A modular gradient-sensing network for chemotaxis in <italic>Escherichia coli</italic> revealed by responses to time-varying stimuli</article-title><source>Molecular Systems Biology</source><volume>6</volume><elocation-id>382</elocation-id><pub-id pub-id-type="doi">10.1038/msb.2010.37</pub-id><pub-id pub-id-type="pmid">20571531</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skoge</surname> <given-names>M</given-names></name><name><surname>Meir</surname> <given-names>Y</given-names></name><name><surname>Wingreen</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dynamics of cooperativity in chemical sensing among cell-surface receptors</article-title><source>Physical Review Letters</source><volume>107</volume><elocation-id>178101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.107.178101</pub-id><pub-id pub-id-type="pmid">22107586</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sourjik</surname> <given-names>V</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Binding of the <italic>Escherichia coli</italic> response regulator CheY to its target measured in vivo by fluorescence resonance energy transfer</article-title><source>PNAS</source><volume>99</volume><fpage>12669</fpage><lpage>12674</lpage><pub-id pub-id-type="doi">10.1073/pnas.192463199</pub-id><pub-id pub-id-type="pmid">12232047</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taute</surname> <given-names>KM</given-names></name><name><surname>Gude</surname> <given-names>S</given-names></name><name><surname>Tans</surname> <given-names>SJ</given-names></name><name><surname>Shimizu</surname> <given-names>TS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>High-throughput 3D tracking of Bacteria on a standard phase contrast microscope</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>8776</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms9776</pub-id><pub-id pub-id-type="pmid">26522289</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ten Wolde</surname> <given-names>PR</given-names></name><name><surname>Becker</surname> <given-names>NB</given-names></name><name><surname>Ouldridge</surname> <given-names>TE</given-names></name><name><surname>Mugler</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fundamental limits to cellular sensing</article-title><source>Journal of Statistical Physics</source><volume>162</volume><fpage>1395</fpage><lpage>1424</lpage><pub-id pub-id-type="doi">10.1007/s10955-015-1440-5</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkacik</surname> <given-names>G</given-names></name><name><surname>Callan</surname> <given-names>CG</given-names></name><name><surname>Bialek</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Information flow and optimization in transcriptional regulation</article-title><source>PNAS</source><volume>105</volume><fpage>12265</fpage><lpage>12270</lpage><pub-id pub-id-type="doi">10.1073/pnas.0806077105</pub-id><pub-id pub-id-type="pmid">18719112</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkacik</surname> <given-names>G</given-names></name><name><surname>Prentice</surname> <given-names>JS</given-names></name><name><surname>Balasubramanian</surname> <given-names>V</given-names></name><name><surname>Schneidman</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Optimal population coding by noisy spiking neurons</article-title><source>PNAS</source><volume>107</volume><fpage>14419</fpage><lpage>14424</lpage><pub-id pub-id-type="doi">10.1073/pnas.1004906107</pub-id><pub-id pub-id-type="pmid">20660781</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tkačik</surname> <given-names>G</given-names></name><name><surname>Walczak</surname> <given-names>AM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Information transmission in genetic regulatory networks: a review</article-title><source>Journal of Physics: Condensed Matter</source><volume>23</volume><elocation-id>153102</elocation-id><pub-id pub-id-type="doi">10.1088/0953-8984/23/15/153102</pub-id><pub-id pub-id-type="pmid">21460423</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tostevin</surname> <given-names>F</given-names></name><name><surname>ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Mutual information between input and output trajectories of biochemical networks</article-title><source>Physical Review Letters</source><volume>102</volume><elocation-id>218101</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevLett.102.218101</pub-id><pub-id pub-id-type="pmid">19519137</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tostevin</surname> <given-names>F</given-names></name><name><surname>ten Wolde</surname> <given-names>PR</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mutual information in time-varying biochemical systems</article-title><source>Physical Review E</source><volume>81</volume><elocation-id>061917</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.81.061917</pub-id><pub-id pub-id-type="pmid">20866450</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vaknin</surname> <given-names>A</given-names></name><name><surname>Berg</surname> <given-names>HC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Physical responses of bacterial chemoreceptors</article-title><source>Journal of Molecular Biology</source><volume>366</volume><fpage>1416</fpage><lpage>1423</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2006.12.024</pub-id><pub-id pub-id-type="pmid">17217957</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname> <given-names>K</given-names></name><name><surname>Rappel</surname> <given-names>WJ</given-names></name><name><surname>Kerr</surname> <given-names>R</given-names></name><name><surname>Levine</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Quantifying noise levels of intercellular signals</article-title><source>Physical Review E</source><volume>75</volume><elocation-id>061905</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.75.061905</pub-id><pub-id pub-id-type="pmid">17677298</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ziv</surname> <given-names>E</given-names></name><name><surname>Nemenman</surname> <given-names>I</given-names></name><name><surname>Wiggins</surname> <given-names>CH</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Optimal signal processing in small stochastic biochemical networks</article-title><source>PLOS ONE</source><volume>2</volume><elocation-id>e1077</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0001077</pub-id><pub-id pub-id-type="pmid">17957259</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Signal-to-noise ratio</title><p>Here, we provide the derivation of the central result of this article, <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> of the main text. The derivation starts from the SNR, given in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. Here, <inline-formula><mml:math id="inf561"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the width of the input distribution, while <inline-formula><mml:math id="inf562"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is the error in the estimate of the concentration. The latter is derived from the dynamic input–output relation <inline-formula><mml:math id="inf563"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which is the mapping between the average receptor occupancy over the past integration time <inline-formula><mml:math id="inf564"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and the current ligand concentration <italic>L</italic> (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Concretely, the error <inline-formula><mml:math id="inf565"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is given by <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, where <inline-formula><mml:math id="inf566"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the error in the estimate of the average receptor occupancy over the past integration time <inline-formula><mml:math id="inf567"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf568"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the dynamic gain, which is the slope of the dynamic input–output relation <inline-formula><mml:math id="inf569"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Below, we first derive the dynamic gain <inline-formula><mml:math id="inf570"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> and then the error in the estimate of the receptor occupancy <inline-formula><mml:math id="inf571"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>.</p></sec><sec id="s9" sec-type="appendix"><title>Dynamic input–output relation</title><p>The dynamic input–output relation <inline-formula><mml:math id="inf572"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the average receptor occupancy <inline-formula><mml:math id="inf573"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf574"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, given that the current ligand concentration <inline-formula><mml:math id="inf575"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The cell estimates <inline-formula><mml:math id="inf576"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> via its receptor readout system, which is a device that takes samples of the receptor: the readout molecules at time <italic>t</italic> constitute samples of the ligand-binding state of the receptor at earlier sampling times <italic>t</italic><sub><italic>i</italic></sub> (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). More specifically, the cell estimates <inline-formula><mml:math id="inf577"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> from the number of active readout molecules <inline-formula><mml:math id="inf578"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf579"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is the average of the number of samples <italic>N</italic> taken during the integration time <inline-formula><mml:math id="inf580"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>. Hence, the dynamic input–output relation is<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf581"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> is the receptor occupancy at time <italic>t</italic><sub><italic>i</italic></sub>, <italic>E</italic> denotes the expectation over the sampling times <italic>t</italic><sub><italic>i</italic></sub>, and <inline-formula><mml:math id="inf582"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> denotes an average over receptor–ligand binding noise and the subensemble of ligand trajectories that each end at <inline-formula><mml:math id="inf583"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2">Figure 2c</xref>); the quantity <inline-formula><mml:math id="inf584"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> is indeed the average receptor occupancy at time <italic>t</italic><sub><italic>i</italic></sub><italic>, given that the ligand concentration at time t is</italic> <inline-formula><mml:math id="inf585"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. Importantly, the receptor samples can also decay via the deactivation of <inline-formula><mml:math id="inf586"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. Taking this into account, the probability that a readout molecule at time <italic>t</italic> provides a sample of the receptor at an earlier time <italic>t</italic><sub><italic>i</italic></sub> is <inline-formula><mml:math id="inf587"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>sample</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>). Averaging the receptor occupancy over the sampling times <italic>t</italic><sub><italic>i</italic></sub> then yields<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>𝑑</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s10" sec-type="appendix"><title>Dynamic gain</title><p>When the current ligand concentration <inline-formula><mml:math id="inf588"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> deviates from its mean <inline-formula><mml:math id="inf589"><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> by <inline-formula><mml:math id="inf590"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="inf591"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> deviates on average from its mean <italic>p</italic> (the average receptor occupancy over all <inline-formula><mml:math id="inf592"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) by<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo>𝑑</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <italic>E</italic> denotes again the expectation over the sampling times <italic>t</italic><sub><italic>i</italic></sub>, and <inline-formula><mml:math id="inf593"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the average deviation in the receptor occupancy <inline-formula><mml:math id="inf594"><mml:mrow><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> at time <italic>t</italic><sub><italic>i</italic></sub> from its mean <italic>p,</italic> given that the ligand concentration at time <italic>t</italic> is <inline-formula><mml:math id="inf595"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2">Figure 2c</xref>). We can compute it within the linear-noise approximation (<xref ref-type="bibr" rid="bib18">Gardiner, 2009</xref>):<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mrow><mml:mo>𝑑</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf596"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf597"><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> is the average ligand concentration at time <inline-formula><mml:math id="inf598"><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math></inline-formula>, given that the ligand concentration at time <italic>t</italic> is <inline-formula><mml:math id="inf599"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The latter is given by <xref ref-type="bibr" rid="bib7">Bowsher et al., 2013</xref><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Combining <xref ref-type="disp-formula" rid="equ17 equ18 equ19">Equations 17–19</xref> yields the following expression for the average change in the average receptor occupancy <inline-formula><mml:math id="inf600"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, given that the ligand at time <italic>t</italic> is <inline-formula><mml:math id="inf601"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(20)</mml:mtext></mml:mtd><mml:mtd><mml:mi>δ</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(21)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>≡</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>δ</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Hence, the dynamic gain is<disp-formula id="equ21"><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mlabeledtr><mml:mtd><mml:mtext>(22)</mml:mtext></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mlabeledtr><mml:mtd><mml:mtext>(23)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The dynamic gain is the slope of the dynamic input–output relation <inline-formula><mml:math id="inf602"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig2">Figure 2a</xref>). It yields the average change in the receptor occupancy <inline-formula><mml:math id="inf603"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past integration time <inline-formula><mml:math id="inf604"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> when the change in the ligand concentration at time <italic>t</italic> is <inline-formula><mml:math id="inf605"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. It depends on all the timescales in the problem and only reduces to the static gain <inline-formula><mml:math id="inf606"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> when the integration time <inline-formula><mml:math id="inf607"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and the receptor correlation time <inline-formula><mml:math id="inf608"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:math></inline-formula> are both much shorter than the ligand correlation time <inline-formula><mml:math id="inf609"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:math></inline-formula>. The dynamic gain determines how much an error in the estimate of <inline-formula><mml:math id="inf610"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> propagates to the estimate of <inline-formula><mml:math id="inf611"><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s11" sec-type="appendix"><title>Error in receptor occupancy</title><p>We can derive the variance in the estimate of the receptor occupancy over the past integration time <inline-formula><mml:math id="inf612"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf613"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, directly from <xref ref-type="disp-formula" rid="equ14">Equation 14</xref> for the system in the irreversible limit (<xref ref-type="bibr" rid="bib37">Malaguti and Ten Wolde, 2019</xref>). While this derivation is illuminating, it is also lengthy. For the fully reversible system studied here, we follow a simpler route. Since the average number of samples <inline-formula><mml:math id="inf614"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> over the integration time <inline-formula><mml:math id="inf615"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is constant, it follows from <xref ref-type="disp-formula" rid="equ14">Equation 14</xref> that<disp-formula id="equ22"><label>(24)</label><mml:math id="m22"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="inf616"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the variance in the number of phosphorylated readout molecules, conditioned on the signal at time <italic>t</italic> being <inline-formula><mml:math id="inf617"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula>. The conditional variance (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>)<disp-formula id="equ23"><label>(25)</label><mml:math id="m23"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>is the full variance <inline-formula><mml:math id="inf618"><mml:msubsup><mml:mi>σ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> of <inline-formula><mml:math id="inf619"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> minus the variance <inline-formula><mml:math id="inf620"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> that is due to the signal variations, given by the dynamic gain <inline-formula><mml:math id="inf621"><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> from <italic>L</italic> to <inline-formula><mml:math id="inf622"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> times the signal variance <inline-formula><mml:math id="inf623"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>.</p><p>The full variance of the readout <inline-formula><mml:math id="inf624"><mml:msubsup><mml:mi>σ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ23">Equation 25</xref> can be obtained from the linear-noise approximation (<xref ref-type="bibr" rid="bib18">Gardiner, 2009</xref>), see <xref ref-type="bibr" rid="bib37">Malaguti and Ten Wolde, 2019</xref>:<disp-formula id="equ24"><label>(26)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:msup><mml:mi mathvariant="normal">′</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>μ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>In this expression, <inline-formula><mml:math id="inf625"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:none/><mml:none/><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the inverse of the receptor correlation time <inline-formula><mml:math id="inf626"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>R</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the probability that a receptor is bound to ligand; <inline-formula><mml:math id="inf627"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf628"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the inverse of the integration time <inline-formula><mml:math id="inf629"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; <inline-formula><mml:math id="inf630"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:msup><mml:mi>x</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the fraction of phosphorylated readout; and <inline-formula><mml:math id="inf631"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the total flux <inline-formula><mml:math id="inf632"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> around the cycle of readout activation and deactivation divided by the total number <inline-formula><mml:math id="inf633"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of ligand-bound receptors: it is the rate at which each receptor is sampled, be it ligand bound or not. For what follows below, we note that the quality parameter <inline-formula><mml:math id="inf634"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To get <inline-formula><mml:math id="inf635"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="equ22 equ23">Equations 24 and 25,</xref> we need not only <inline-formula><mml:math id="inf636"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ24">Equation 26</xref>) but also the average number of samples <inline-formula><mml:math id="inf637"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> and the dynamic gain <inline-formula><mml:math id="inf638"><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>. The average number of samples taken during the integration time <inline-formula><mml:math id="inf639"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> is <inline-formula><mml:math id="inf640"><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and the effective number of reliable samples is <inline-formula><mml:math id="inf641"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf642"><mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf643"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the average number of active readout molecules for a given input <inline-formula><mml:math id="inf644"><mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf645"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is a constant independent of <italic>L</italic>, it follows that<disp-formula id="equ25"><label>(27)</label><mml:math id="m25"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mfrac></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf646"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> the dynamic gain from <italic>L</italic> to <inline-formula><mml:math id="inf647"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula>, given by <xref ref-type="disp-formula" rid="equ21">Equation 22</xref>. <xref ref-type="disp-formula" rid="equ25">Equation 27</xref> can be verified via another route that does not rely on the sampling framework because we also know that <inline-formula><mml:math id="inf648"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>), where the co-variance <inline-formula><mml:math id="inf649"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> can be obtained from the linear-noise approximation (<xref ref-type="bibr" rid="bib37">Malaguti and Ten Wolde, 2019</xref>; <xref ref-type="bibr" rid="bib18">Gardiner, 2009</xref>). Combining <xref ref-type="disp-formula" rid="equ22 equ23 equ24 equ25">Equations 24–27</xref> yields<disp-formula id="equ26"><label>(28)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>This can be rewritten using the expression for the fraction of independent samples, which, assuming that <inline-formula><mml:math id="inf650"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>≫</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is <inline-formula><mml:math id="inf651"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf652"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mtext>eff</mml:mtext></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> the effective spacing between the samples (<xref ref-type="bibr" rid="bib21">Govern and Ten Wolde, 2014a</xref>):<disp-formula id="equ27"><label>(29)</label><mml:math id="m27"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false" stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo movablelimits="false">-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo movablelimits="false" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo movablelimits="false">⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo movablelimits="false">¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo movablelimits="false">+</mml:mo><mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo movablelimits="false">¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo movablelimits="false">⏟</mml:mo></mml:munder><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo movablelimits="false" stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo movablelimits="false">→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo movablelimits="false">⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false">[</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo movablelimits="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo movablelimits="false">+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo movablelimits="false">)</mml:mo></mml:mrow><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo movablelimits="false">+</mml:mo><mml:mfrac><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mfrac></mml:mrow><mml:mo movablelimits="false">)</mml:mo></mml:mrow><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo movablelimits="false">+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo movablelimits="false">⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub><mml:mo movablelimits="false">⁢</mml:mo><mml:mrow><mml:mo movablelimits="false" stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo movablelimits="false">+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo movablelimits="false" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo movablelimits="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo movablelimits="false">-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo movablelimits="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo movablelimits="false">⏟</mml:mo></mml:munder><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>dyn</mml:mi></mml:mrow></mml:msubsup></mml:munder></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf653"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>samp</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the sampling error in the estimate of <inline-formula><mml:math id="inf654"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib37">Malaguti and Ten Wolde, 2019</xref>); it is a statistical error, which arises from the finite cellular resources to sample the state of the receptor, protein copies, time, and energy (see <xref ref-type="fig" rid="fig2">Figure 2b</xref>). The other contribution, <inline-formula><mml:math id="inf655"><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mo rspace="5.9pt">,</mml:mo><mml:mi>dyn</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, is the dynamical error in the estimate of <inline-formula><mml:math id="inf656"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib37">Malaguti and Ten Wolde, 2019</xref>); it is a systematic error that arises from the input dynamics and only depends on the average receptor occupancy and the timescales of the input, receptor, and readout (see <xref ref-type="fig" rid="fig2">Figure 2c</xref>); it neither depends on the number of protein copies nor on the energy necessary to sample the receptor.</p></sec><sec id="s12" sec-type="appendix"><title>Final result: SNR</title><p>Combining <xref ref-type="disp-formula" rid="equ27">Equations 29</xref> and <xref ref-type="disp-formula" rid="equ21">22</xref> with <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> yields the principal result of our work (<xref ref-type="disp-formula" rid="equ6">Equation 6)</xref> of the main text.</p></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s13" sec-type="appendix"><title>Fundamental resources</title><p>To identify the fundamental resources limiting the sensing accuracy and derive the corresponding sensing limits (<xref ref-type="disp-formula" rid="equ8 equ9">Equations 8 and 9)</xref>, it is helpful to rewrite the SNR in terms of collective variables that illuminate the cellular resources. For that, we start from <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> of the main text and split the first term on the right-hand side and exploit the expression for the effective number of independent samples <inline-formula><mml:math id="inf657"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi mathvariant="normal">I</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="inf658"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We then sum up the last two terms on the right-hand side and use that <inline-formula><mml:math id="inf659"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>eff</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ28"><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left right left right left right left right left right left" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true" rowspacing="3pt"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:msup><mml:mi mathvariant="normal">R</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:msub><mml:mover><mml:mi>N</mml:mi><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(30)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd/></mml:mlabeledtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>q</mml:mi><mml:mrow><mml:mover><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo accent="false">¯</mml:mo></mml:mover><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mlabeledtr><mml:mtd><mml:mtext>(31)</mml:mtext></mml:mtd><mml:mtd/><mml:mtd><mml:mi/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:munder><mml:mo>.</mml:mo></mml:mtd><mml:mtd/></mml:mlabeledtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The second term in between the square brackets describes the contribution to the sensing error that comes from the stochasticity in the concentration measurements at the receptor level. The first term in between the square brackets, the coding noise, describes the contribution that arises in storing these measurements into the readout molecules.</p><p>From <xref ref-type="disp-formula" rid="equ28">Equation 30,</xref> the fundamental resources and the corresponding sensing limits (<xref ref-type="disp-formula" rid="equ8 equ9">Equations 8 and 9)</xref> can be derived. Specifically, when the number of receptors and their integration are limiting, the coding noise in <xref ref-type="disp-formula" rid="equ28">Equation 30</xref> is zero; exploiting that typically <inline-formula><mml:math id="inf660"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and that the contribution to the sensing error from the receptor input noise is minimized for <inline-formula><mml:math id="inf661"><mml:mrow><mml:mi>p</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, this yields <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf662"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. When the number of readout molecules <inline-formula><mml:math id="inf663"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> is limiting, the receptor input noise is zero and <inline-formula><mml:math id="inf664"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; noting that <inline-formula><mml:math id="inf665"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and that the contribution from the coding noise is minimized when <inline-formula><mml:math id="inf666"><mml:mrow><mml:mi>f</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf667"><mml:mrow><mml:mi>p</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and again exploiting that <inline-formula><mml:math id="inf668"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, this yields <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf669"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. When the power <inline-formula><mml:math id="inf670"><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is limiting, then the receptor input noise is (again) zero. The coding noise is minimized for a given power constraint <inline-formula><mml:math id="inf671"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> when <inline-formula><mml:math id="inf672"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, but two regimes can be distinguished based on the total free-energy drop <inline-formula><mml:math id="inf673"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow></mml:math></inline-formula>. When <inline-formula><mml:math id="inf674"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the system is in the irreversible regime and <inline-formula><mml:math id="inf675"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ7">Equation 7</xref>); <xref ref-type="disp-formula" rid="equ28">Equation 30</xref> shows that the error is then bounded by <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf676"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, using <inline-formula><mml:math id="inf677"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf678"><mml:mrow><mml:mi>p</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Yet, the sensing error is minimized in the quasi-equilibrium regime, where <inline-formula><mml:math id="inf679"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf680"><mml:mrow><mml:mi>q</mml:mi><mml:mo>→</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, yielding <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> with <inline-formula><mml:math id="inf681"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s14" sec-type="appendix"><title>The optimal gain and optimal integration time</title><p>The theory of the main text (<xref ref-type="disp-formula" rid="equ6">Equation 6</xref>) is based on the idea that the cell uses its push–pull network to estimate the receptor occupancy <inline-formula><mml:math id="inf682"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> from which the current ligand concentration <italic>L</italic> is then inferred by inverting the dynamic input–output relation <inline-formula><mml:math id="inf683"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Yet, as we show here, this framework is equivalent to the idea that the cell estimates the concentration from the output <inline-formula><mml:math id="inf684"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, using the dynamic input–output relation <inline-formula><mml:math id="inf685"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, we use this observation to analyze our system using ideas from filtering and information theory. But first we demonstrate this correspondence.</p><p>To show that estimating the concentration from <inline-formula><mml:math id="inf686"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> is equivalent to that from estimating it from <inline-formula><mml:math id="inf687"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, we first note that because the average number of samples <inline-formula><mml:math id="inf688"><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is constant, <inline-formula><mml:math id="inf689"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> while the gain from <italic>L</italic> to <inline-formula><mml:math id="inf690"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is <inline-formula><mml:math id="inf691"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Consequently, the absolute error <inline-formula><mml:math id="inf692"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> in estimating the concentration via <inline-formula><mml:math id="inf693"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="inf694"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, is the same as that of <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>: because the instantaneous number of active readout molecules <inline-formula><mml:math id="inf695"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> reflects the average receptor occupancy <inline-formula><mml:math id="inf696"><mml:msub><mml:mi>p</mml:mi><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:msub></mml:math></inline-formula> over the past <inline-formula><mml:math id="inf697"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula>, estimating the ligand concentration from <inline-formula><mml:math id="inf698"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> is no different from inferring it from the average receptor occupancy <inline-formula><mml:math id="inf699"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>τ</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>To make the connection with information and filtering theory, we note that in our Gaussian model the conditional distribution of <inline-formula><mml:math id="inf700"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> given <inline-formula><mml:math id="inf701"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> is given by <xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref><disp-formula id="equ29"><label>(32)</label><mml:math id="m29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf702"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">⟨</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">⟩</mml:mo></mml:mrow><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the average value of <inline-formula><mml:math id="inf703"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> given that <inline-formula><mml:math id="inf704"><mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf705"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the variance of this distribution (see also <xref ref-type="disp-formula" rid="equ23">Equation 25)</xref>.</p><p>The relative error, the inverse of the SNR (see <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), is<disp-formula id="equ30"><label>(33)</label><mml:math id="m30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mover><mml:mi>L</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>As mentioned in the main text, the SNR also yields the mutual information <inline-formula><mml:math id="inf706"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>SNR</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> between the input <italic>L</italic> and output <inline-formula><mml:math id="inf707"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib61">Tostevin and ten Wolde, 2010</xref>).</p><p>The notion of an optimal integration time or optimal dynamic gain is well known from filtering and information theory (<xref ref-type="bibr" rid="bib2">Andrews et al., 2006</xref>; <xref ref-type="bibr" rid="bib25">Hinczewski and Thirumalai, 2014</xref>; <xref ref-type="bibr" rid="bib3">Becker et al., 2015</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>; <xref ref-type="bibr" rid="bib40">Monti et al., 2018b</xref>; <xref ref-type="bibr" rid="bib42">Mora and Nemenman, 2019</xref>). To elucidate the optimal gain and integration time in our system, we combine the above equation with <xref ref-type="disp-formula" rid="equ23 equ24">Equations 25 and 26</xref> to write the relative error as<disp-formula id="equ31"><label>(34)</label><mml:math id="m31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="right left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mspace width="2em"/><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:munder><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:munder><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf708"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is the static gain from <inline-formula><mml:math id="inf709"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf710"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. Written in this form, the trade-offs in maximizing the mutual information <inline-formula><mml:math id="inf711"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (and minimizing the relative error in estimating the concentration) become apparent: increasing the dynamic gain <inline-formula><mml:math id="inf712"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> by decreasing the integration time <inline-formula><mml:math id="inf713"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> raises the slope of the input–output relation <inline-formula><mml:math id="inf714"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which helps to lift the transmitted signal above the intrinsic binomial switching noise of the readout, <inline-formula><mml:math id="inf715"><mml:mrow><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Also, the dynamical error is minimized by minimizing <inline-formula><mml:math id="inf716"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> and maximizing <inline-formula><mml:math id="inf717"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>. Yet, for the second term, which describes how noise in the input signal arising from receptor switching, <inline-formula><mml:math id="inf718"><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is propagated to the output <inline-formula><mml:math id="inf719"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, there exists an optimal integration time that minimizes this term: while decreasing <inline-formula><mml:math id="inf720"><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:math></inline-formula> increases the dynamic gain, which helps to raise the signal above the noise, it also impedes time averaging of this switching noise, described by the factor <inline-formula><mml:math id="inf721"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The mutual information is <inline-formula><mml:math id="inf722"><mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf723"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the entropy of the marginal output distribution and <inline-formula><mml:math id="inf724"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo lspace="2.5pt" rspace="2.5pt" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the entropy of the output distribution conditioned on the input. Hence, information theory shows that in the weak noise limit, information transmission is optimal when the entropy of the output distribution is maximized (<xref ref-type="bibr" rid="bib34">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib57">Tkacik et al., 2008</xref>). Our system obeys this principle. Since the dynamic gain <inline-formula><mml:math id="inf725"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mmultiscripts><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:none/><mml:none/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>∝</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, the amplification of the signal rises with <inline-formula><mml:math id="inf726"><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf727"><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:math></inline-formula>. Since the standard deviation of the noise added to the transmitted signal coming from the stochastic receptor and readout activation scales with <inline-formula><mml:math id="inf728"><mml:msqrt><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:msqrt></mml:math></inline-formula> and <inline-formula><mml:math id="inf729"><mml:msqrt><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:msqrt></mml:math></inline-formula>, respectively, it is clear that the <italic>SNR</italic> increases with <inline-formula><mml:math id="inf730"><mml:msqrt><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:msqrt></mml:math></inline-formula> and <inline-formula><mml:math id="inf731"><mml:msqrt><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:msqrt></mml:math></inline-formula>. In the limit that <inline-formula><mml:math id="inf732"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula>, the relative error <inline-formula><mml:math id="inf733"><mml:msup><mml:mi>SNR</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> is only set by the dynamical error, which can be reduced to zero by <inline-formula><mml:math id="inf734"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, exploiting that typically <inline-formula><mml:math id="inf735"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:msub><mml:mo>≪</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. This is the weak-noise limit in which the mutual information <inline-formula><mml:math id="inf736"><mml:mrow><mml:mi>I</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is maximized by maximizing the entropy of the output distribution <inline-formula><mml:math id="inf737"><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Indeed, <inline-formula><mml:math id="inf738"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> corresponds to maximizing the gain, which maximizes the width of the output distribution, in this limit equal to <inline-formula><mml:math id="inf739"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mrow><mml:mi>L</mml:mi><mml:mo>→</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> (see <xref ref-type="disp-formula" rid="equ23">Equation 25</xref>), and thereby the entropy of the output distribution <inline-formula><mml:math id="inf740"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>π</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Finally, we note that our Gaussian model is linear such that the central control parameter, besides protein copies and energy, is the integration time or the dynamic gain, which sets the slope of the linear input–output relation. While Wiener–Kolmogorov and Kalman filtering are exact only for these Gaussian models, information theory also applies to non-linear systems with non-Gaussian statistics. It has been used to show that neuronal systems (<xref ref-type="bibr" rid="bib34">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib8">Brenner et al., 2000</xref>; <xref ref-type="bibr" rid="bib15">Fairhall et al., 2001</xref>; <xref ref-type="bibr" rid="bib45">Nemenman et al., 2008</xref>; <xref ref-type="bibr" rid="bib58">Tkacik et al., 2010</xref>), signaling and gene networks (<xref ref-type="bibr" rid="bib51">Segall et al., 1986</xref>; <xref ref-type="bibr" rid="bib57">Tkacik et al., 2008</xref>; <xref ref-type="bibr" rid="bib59">Tkačik and Walczak, 2011</xref>; <xref ref-type="bibr" rid="bib46">Nemenman, 2012</xref>; <xref ref-type="bibr" rid="bib11">Dubuis et al., 2013</xref>), and circadian systems (<xref ref-type="bibr" rid="bib41">Monti and Wolde, 2016</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>) can maximize information transmission by optimizing the shape of the input–output relation (<xref ref-type="bibr" rid="bib34">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib8">Brenner et al., 2000</xref>; <xref ref-type="bibr" rid="bib15">Fairhall et al., 2001</xref>; <xref ref-type="bibr" rid="bib57">Tkacik et al., 2008</xref>; <xref ref-type="bibr" rid="bib39">Monti et al., 2018a</xref>); by desensitization, that is, adapting the output to the mean input via incoherent feedforward or negative feedback (<xref ref-type="bibr" rid="bib51">Segall et al., 1986</xref>); by gain control, that is, adapting the output to the variance of the input by capitalizing on a steep response function and temporal correlations in the input (<xref ref-type="bibr" rid="bib46">Nemenman, 2012</xref>); by removing coding redundancy via temporal decorrelation (<xref ref-type="bibr" rid="bib45">Nemenman et al., 2008</xref>); by optimizing the tiling of the output space via the topology of the network (<xref ref-type="bibr" rid="bib59">Tkačik and Walczak, 2011</xref>; <xref ref-type="bibr" rid="bib11">Dubuis et al., 2013</xref>); or by exploiting cross-correlations between the signals (<xref ref-type="bibr" rid="bib58">Tkacik et al., 2010</xref>; <xref ref-type="bibr" rid="bib41">Monti and Wolde, 2016</xref>).</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.62574.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Goldstein</surname><given-names>Raymond E</given-names></name><role>Reviewing Editor</role><aff><institution>University of Cambridge</institution><country>United Kingdom</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Malaguti and ten Wolde combine analysis of sensing limits for time-varying signals with previous work on resource allocation to minimize the costs of sensing. The work makes a solid contribution towards understanding the principles of resource allocation, and the conclusion that <italic>E. coli</italic> chemotaxis is optimized for shallow gradients should stimulate further discussion and work.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Theory for the optimal detection of time-varying signals in cellular sensing systems&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by two peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Detlef Weigel as the Senior Editor. The reviewers have opted to remain anonymous.</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Malaguti and ten Wolde combine analysis of Mora-Nemenman (PRL 2019) on Berg-Purcell type sensing limits for time-varying signals with previous work of one of the authors (ten Wolde, PNAS 2014) on resource allocation to minimize the costs of sensing. The previous work discussed tradeoffs for the costs of sensing a constant signal. Here it is extended to time-varying signals (modeled as colored-noise Gaussian). Although the authors exaggerate the novelty of their analysis, they make a solid contribution towards understanding the principles of resource allocation. The conclusion that <italic>E. coli</italic> chemotaxis is optimized for shallow gradients seems reasonable and should stimulate further discussion and work. Despite flaws in establishing context, the paper deserves publication</p><p>Revisions for this paper:</p><p>While enthusiastic about the results in the manuscript, the reviewers found that there are issues involving claims of novelty, and the overall presentation of mathematical results that will need considerable revision.</p><p>1) The novelty of their analysis is exaggerated.</p><p>The basic problem of optimally estimating the state of a time-varying signal probed by noisy measurements is textbook material for engineers. Here, because everything is linearized about an operating point and because noise is approximated as Gaussian, there is an exact analytic theory going back to Kalman and Bucy in 1961. The result underlies the Mora-Nemenman analysis (although they, too, did not reference that work for the Gaussian approximation used for their concrete results) and that done here. In engineering, the general problem optimally estimating a stochastic signal via noisy measurements was already considered by Kolmogorov and Wiener in the 1940s and formulated in the time domain, for linear systems driven by white noise (the approximation used here) by Kalman and Bucy.</p><p>It is a weakness that the connections are not mentioned specifically by referencing. Appealing to known results not only underlines how different disciplines often need to tackle the same problems, it allows for the use of textbook results and can shorten a paper. As a corollary, authors who map their problem onto known results should not be penalized for doing so, when the application is new and important (as here).</p><p>2) Specific sentences have language that seems exaggerated, in the light of historical work on filtering theory:</p><p>&quot;Our theory is based on a new concept, the dynamic input-output relation p<sub>τr</sub>(L).&quot;</p><p>- Dynamical models (with dynamical input-output relations) are a central element of filtering theory.</p><p>&quot;.Our theory reveals that the sensing error can be decomposed into two terms [sampling (sensing) error and dynamical error].&quot;</p><p>- The framework of filtering theory assumes noisy measurements of stochastic signals.</p><p>&quot;Our theory illuminates how the optimal design depends on the timescale of the input τ<sub>L</sub>.&quot;</p><p>- The statement is true but should be framed in the context of other work, including in systems biology / biophysics, which comes to the same conclusion. For example, the work of Laughlin in 1981, and later Nemenman and Bialek, show that the input-output &quot;gain function&quot; should be adapted to the statistics of the input (including time scales of variation). Bialek's 2012 Biophysics book discusses many examples.</p><p>3) In its present form, the paper will be essentially unreadable by the vast majority of the <italic>eLife</italic> readership; the writing style is more appropriate to the Physical Review than to <italic>eLife</italic>. Indeed, much of the paper is written like a technical note that builds on previous work (Berg/Purcell, etc.) without sufficient explanation for the general reader. This criticism extends to the explanations of the underlying model, the lack of definition of terminology, and the notation.</p><p>Here are but a few examples of the points above. The authors are encouraged to rethink the entire presentation de novo for maximum improvement.</p><p>a) The definition of a &quot;push-pull&quot; network should be given in the paper.</p><p>b) For the purpose of readability by a diverse audience some care should be taken to define technical terms explicitly (e.g. &quot;Markovian&quot;), and to explain various statements more clearly. Appearing so early in the paper, such condensed statements will be off-putting to the general reader.</p><p>c) The whole notation of &quot;inverting the mapping&quot; that is central to the theory is not well-explained.</p><p>d) Regarding notation: consider, for example, the caption of Figure 2 and Equation 1, in which there is the quantity <inline-formula><mml:math id="inf741"><mml:mrow><mml:mi>σ</mml:mi><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> . This is simply too complicated, and its meaning will be utterly opaque to the general reader.</p><p>4) In many ways it seems that if the authors presaged the development of the theory by indicating the run-and-tumble context early on it would help the reader to understand the precise motivations behind their lengthy calculations, and to give an idea of the time scales.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.62574.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Revisions for this paper:</p><p>While enthusiastic about the results in the manuscript, the reviewers found that there are issues involving claims of novelty, and the overall presentation of mathematical results that will need considerable revision.</p><p>1) The novelty of their analysis is exaggerated.</p><p>The basic problem of optimally estimating the state of a time-varying signal probed by noisy measurements is textbook material for engineers. Here, because everything is linearized about an operating point and because noise is approximated as Gaussian, there is an exact analytic theory going back to Kalman and Bucy in 1961. The result underlies the Mora-Nemenman analysis (although they, too, did not reference that work for the Gaussian approximation used for their concrete results) and that done here. In engineering, the general problem optimally estimating a stochastic signal via noisy measurements was already considered by Kolmogorov and Wiener in the 1940s and formulated in the time domain, for linear systems driven by white noise (the approximation used here) by Kalman and Bucy.</p><p>It is a weakness that the connections are not mentioned specifically by referencing. Appealing to known results not only underlines how different disciplines often need to tackle the same problems, it allows for the use of textbook results and can shorten a paper. As a corollary, authors who map their problem onto known results should not be penalized for doing so, when the application is new and important (as here).</p></disp-quote><p>We fully acknowledge the point that is made here and we agree that we should have described the connection with filtering theory much more clearly, especially given the fact that we have applied filtering theory ourselves to biochemical signalling before (Becker, Mugler, Ten Wolde, 2015).</p><p>We indeed employ a Gaussian model, and for such a Gaussian model Kalman and Wiener-Kolmogorov filtering theory become exact, as the reviewers correctly point out. In our previous work, we studied different types of input signals (Markovian and non-Markovian), and then used Wiener-Kolmogorov filtering theory to derive the optimal topology of the sensing network for the different types of input signals (Becker et al., 2015). In our current work, we consider one type of input signal—a stationary Markovian signal. The optimal filter for this type of input signal is a low-pass, exponential filter and the canonical network motif studied in our current study implements precisely such a filter (see Becker et al., 2015). This filter is useful, because it allows the system to time integrate the input signal and hence filter out the high-frequency input noise arising here from receptor-ligand binding. We agree with the reviewers that these ideas are well established and that we should describe them more clearly in our manuscript.</p><p>Yet, while filtering theory provides a powerful approach to elucidating the optimal topology and response dynamics of the sensing network, as determined by the statistics of the input signal, it does not naturally reveal the resource requirements for sensing. To this end, we have generalised the sampling framework that we have developed previously (Govern and Ten Wolde, 2014). This framework is particularly well suited for elucidating the resource requirements for time integration, because it starts from the observation that the receptor-readout system consists of discrete molecules that interact with the receptor in a stochastic fashion: our description is thus based on the idea that the readout system is a sampling device that implements the mechanism of time integration not by continuously integrating the state of the receptor, but rather by discretely and stochastically sampling it, via the collisions of the readout molecules with the receptor proteins. The novelty of this manuscript is that we have now extended this sampling framework, for the first time, to time-varying signals.</p><p>In the revised manuscript, we have thoroughly rewritten the Introduction and added two new paragraphs to the Discussion. In the Introduction, we now mention that the problem of optimally predicting time-varying signals is a classic problem, for which different theories have been developed. We then also briefly review the application of filtering theories to biochemical signalling, adding relevant references. We then emphasise that we consider one class of input signals and one canonical network motif, which is known to implement a filter that is optimal for this type of signals, and raise the central question of our manuscript, which is what the cellular resource requirements are for optimally implementing such a network. We end the Introduction with a brief discussion of the main ideas of our theory and our findings.</p><p>In the revised Introduction, we also note that our theory applies to systems that employ the mechanism of time integration, and not to systems that employ Maximum-Likelihood sensing or Bayesian filtering, which underlies the analysis of Mora and Nemenman, 2019.</p><p>In the new paragraphs in the Discussion section, we first emphasise that our model is Gaussian and that the performance criterion of our theory, minimizing the mean-square error, is identical to that of Wiener and Kalman filtering theory, which are exact for Gaussian models. We then mention that for our Gaussian model minimizing the mean-square error is equivalent to maximizing the mutual information, thus making a connection between our theory, filtering theories, and information theory. In the next paragraph, we then discuss the concepts that have emerged from these theories and we describe how our findings relate to these concepts; here we have also added a new Appendix 3, where we work out this connection in more mathematical detail.</p><p>We thank the reviewers and the editor for this important comment, because we agree that addressing it puts our work into a broader context.</p><disp-quote content-type="editor-comment"><p>2) Specific sentences have language that seems exaggerated, in the light of historical work on filtering theory:</p><p>&quot;Our theory is based on a new concept, the dynamic input-output relation p<sub>τr</sub>(L).&quot;</p><p>- Dynamical models (with dynamical input-output relations) are a central element of filtering theory.</p></disp-quote><p>We fully agree that dynamic input-output relations are a key concept in filtering theory and we acknowledge that similar input-output relations have been studied before in the biophysics literature (Bialek et al., IEEE, 2006; Tostevin and Ten Wolde, 2010; Nemenman, 2012; Hinczewski and Thirumalai, 2014; Becker et al., 2015). We merely wanted to emphasise that our dynamic input-output relation <italic>p<sub>τr</sub></italic>(<italic>L</italic>) differs fundamentally from the conventional static input-output relations that are typically considered in the context of sensing static signals (Berg and Purcell, 1977; Bialek and Setayesghar, 2005; Kaizu et al., 2014; Mugler et al., 2016).</p><p>We have completely rewritten this paragraph. As we describe in our response to the previous point, we now first introduce filtering theory, then describe the novel aspect of the current manuscript, which is the extension of our sampling framework to time-varying signals, and then mention the dynamic input-output relation, contrasting it with the static input-output relation used to describe the sensing of static signals.</p><disp-quote content-type="editor-comment"><p>&quot;Our theory reveals that the sensing error can be decomposed into two terms [sampling (sensing) error and dynamical error].&quot;</p><p>- The framework of filtering theory assumes noisy measurements of stochastic signals.</p></disp-quote><p>We agree with this, but our decomposition is more specific, showing how the sampling error and the dynamical error depend on the cellular resources protein copies, time, and energy. Our decomposition identifies the combinations of cellular resources, the “collective variables”, that control the sensing precision. It is this decomposition that allows us to make specific predictions on the optimal design of sensing systems that maximize the sensing precision given resource constraints. This is the novel contribution of our paper.</p><p>We now emphasise this more clearly.</p><disp-quote content-type="editor-comment"><p>&quot;Our theory illuminates how the optimal design depends on the timescale of the input τ<sub>L</sub>.&quot;</p><p>- The statement is true but should be framed in the context of other work, including in systems biology / biophysics, which comes to the same conclusion. For example, the work of Laughlin in 1981, and later Nemenman and Bialek, show that the input-output &quot;gain function&quot; should be adapted to the statistics of the input (including time scales of variation). Bialek's 2012 Biophysics book discusses many examples.</p></disp-quote><p>The idea of an optimal integration time, and the related ideas of matching the gain and the input-output relation to the statistics of the input, are indeed well known. In fact, we had cited a number of papers that also show the existence of an optimal integration time (Becker et al., 2015; Monti et al., 2018; Mora and Nemenman, 2019). The aim of our paragraph in the Discussion, was to discuss how the input timescale governs the optimal design in terms of the cellular resources receptors, readout molecules, and energy—this is the novel aspect of our work. But we agree with the reviewers that it is important to connect our observations to previous ideas on the optimal gain and input-output relations that are matched to the statistics of the input. We therefore now first discuss here, in the Discussion section, these ideas and then describe how our findings relate to them. After we have discussed this connection, we emphasise that our sampling framework gives a detailed description of the optimal design in terms of the required cellular resources, and then discuss how this depends on the statistics of the input signal.</p><p>More concretely, we first point out that our model is Gaussian and that the performance criterion of our theory is minimizing the mean-squared error, which is precisely the performance criterion of Wiener and Kalman filtering. We emphasise that the push-pull network is an exponential filter and that this is the optimal filter for the memoryless (Markovian) signals as studied here. We also point out that for our Gaussian model minimizing the mean-square error is equivalent to maximizing the mutual information, thus making the connection between our work, filtering theory, and information theory. In the next paragraph, we then describe concepts that have emerged from filtering and information theory, and describe how our findings relate to these concepts. Here, we also refer to a new Appendix 3, in which we work this connection out in more (mathematical) detail. In this appendix we also discuss concepts for optimizing information transmission in non-linear systems, which are beyond the scope of the current model.</p><disp-quote content-type="editor-comment"><p>3) In its present form, the paper will be essentially unreadable by the vast majority of the eLife readership; the writing style is more appropriate to the Physical Review than to eLife. Indeed, much of the paper is written like a technical note that builds on previous work (Berg/Purcell, etc.) without sufficient explanation for the general reader. This criticism extends to the explanations of the underlying model, the lack of definition of terminology, and the notation.</p><p>Here are but a few examples of the points above. The authors are encouraged to rethink the entire presentation de novo for maximum improvement.</p></disp-quote><p>We acknowledge that the audience of <italic>eLife</italic> is broader than that of Physical Review and we have rewritten the manuscript drastically. We now try to avoid technical terms like “Markovian”, “mapping”, “push-pull” network as much as possible, and where this cannot be avoided we have explained them for a broader audience. Indeed, we have carefully verified whether <italic>all</italic> the necessary concepts that are needed to follow our analysis are explained for a broad audience. For example, in the description of our model and our theory we now describe in more detail the concept of the input correlation time, receptor correlation time, readout relaxation time, the idea of time integration via discrete sampling of the receptor state. We have also simplified notation. Most importantly, perhaps, we have tried to rewrite the manuscript in a more lucid style so that it is easier to follow for a broad audience (see, for example, the description of the optimal design principle, Equation 12). With these improvements, we strongly believe that the revised manuscript is accessible for the broad readership of <italic>eLife</italic>, also because the previous, well cited, paper on which the current manuscript builds, is written with a similar level of detail and published in a journal with a similarly broad audience (Govern and Ten Wolde, 2014).</p><disp-quote content-type="editor-comment"><p>a) The definition of a &quot;push-pull&quot; network should be given in the paper.</p></disp-quote><p>While we could replace “push-pull network” with “cellular network” or simply “network”, we think it does help to keep this term, because it specifically refers to the cycle of readout phosphorylation and dephosphorylation downstream of the receptor. We have therefore decided to keep this term. We do, however, now explain it in the Introduction when we introduce it for the first time.</p><disp-quote content-type="editor-comment"><p>b) For the purpose of readability by a diverse audience some care should be taken to define technical terms explicitly (e.g. &quot;Markovian&quot;), and to explain various statements more clearly. Appearing so early in the paper, such condensed statements will be off-putting to the general reader.</p></disp-quote><p>Since “Markovian” only appears twice in the manuscript, we have changed “Markovian” by “memoryless” with an explanation. The concepts of “correlation time”, “integration time”, and “relaxation time”, are important and used widely in the manuscript; we have therefore added explanations the first time we introduce these, see Section “Theory: Model”. We have also clarified other technical terms, such as time averaging, sampling device, coding.</p><disp-quote content-type="editor-comment"><p>c) The whole notation of &quot;inverting the mapping&quot; that is central to the theory is not well-explained.</p></disp-quote><p>We have clarified that.</p><disp-quote content-type="editor-comment"><p>d) Regarding notation: consider, for example, the caption of Figure 2 and Equation 1, in which there is the quantity <inline-formula><mml:math id="inf742"><mml:mrow><mml:mi>σ</mml:mi><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> This is simply too complicated, and its meaning will be utterly opaque to the general reader.</p></disp-quote><p>We have now simplified the notation as much as possible, while trying to keep clear to what specific quantity the symbol actually refers. For example, we have simplified <inline-formula><mml:math id="inf743"><mml:mrow><mml:mrow><mml:mspace width="0.333em"/> <mml:mtext mathvariant="normal">σ</mml:mtext></mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo form="prefix" stretchy="false">|</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf744"><mml:mrow><mml:mrow><mml:mspace width="0.333em"/> <mml:mtext mathvariant="normal">σ</mml:mtext></mml:mrow><mml:mfrac><mml:mn>2</mml:mn><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:msub></mml:mfrac></mml:mrow></mml:math></inline-formula>; we needed to retain the subscript <italic>τ<sub>r</sub> </italic>because this quantity denotes the variance not of the receptor occupancy <italic>p</italic> but rather that of the receptor occupancy <italic>p<sub>τr</sub> </italic>over the integration time <italic>τ<sub>r</sub></italic>.</p><disp-quote content-type="editor-comment"><p>4) In many ways it seems that if the authors presaged the development of the theory by indicating the run-and-tumble context early on it would help the reader to understand the precise motivations behind their lengthy calculations, and to give an idea of the time scales.</p></disp-quote><p>We would like to emphasise that the analysis is much more generic than the specific application to the <italic>E. coli</italic> chemotaxis system. We therefore would like to maintain the distinction between the general theory and the application of it to <italic>E. coli</italic> chemotaxis. However, we also agree that introducing this system earlier helps to understand the motivation and main ideas behind our theory. We have therefore expanded the discussion of this system in the Introduction.</p></body></sub-article></article>