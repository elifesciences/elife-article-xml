<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">65878</article-id><article-id pub-id-type="doi">10.7554/eLife.65878</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title><italic>Drosophila</italic> uses a tripod gait across all walking speeds, and the geometry of the tripod is important for speed control</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-136234"><name><surname>Chun</surname><given-names>Chanwoo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0759-6727</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-172398"><name><surname>Biswas</surname><given-names>Tirthabir</given-names></name><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-16097"><name><surname>Bhandawat</surname><given-names>Vikas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-2608-0403</contrib-id><email>vb468@drexel.edu</email><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Department of Biology, Duke University</institution><addr-line><named-content content-type="city">Durham</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Department of Physics, Loyola University</institution><addr-line><named-content content-type="city">New Orleans</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Janelia Research Campus, Howard Medical Institute</institution><addr-line><named-content content-type="city">Ashburn</named-content></addr-line><country>United States</country></aff><aff id="aff4"><label>4</label><institution>School of Biomedical Engineering, Sciences and Health Systems, Drexel University, Duke Institute for Brain Sciences, Duke University</institution><addr-line><named-content content-type="city">Durham</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>03</day><month>02</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e65878</elocation-id><history><date date-type="received" iso-8601-date="2020-12-17"><day>17</day><month>12</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-01-22"><day>22</day><month>01</month><year>2021</year></date></history><permissions><copyright-statement>© 2021, Chun et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Chun et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-65878-v2.pdf"/><abstract><p>Changes in walking speed are characterized by changes in both the animal’s gait and the mechanics of its interaction with the ground. Here we study these changes in walking <italic>Drosophila</italic>. We measured the fly’s center of mass movement with high spatial resolution and the position of its footprints. Flies predominantly employ a modified tripod gait that only changes marginally with speed. The mechanics of a tripod gait can be approximated with a simple model – angular and radial spring-loaded inverted pendulum (ARSLIP) – which is characterized by two springs of an effective leg that become stiffer as the speed increases. Surprisingly, the change in the stiffness of the spring is mediated by the change in tripod shape rather than a change in stiffness of individual legs. The effect of tripod shape on mechanics can also explain the large variation in kinematics among insects, and ARSLIP can model these variations.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>locomotion</kwd><kwd>biomechanics</kwd><kwd>walking</kwd><kwd>model</kwd><kwd>kinematics</kwd><kwd><italic>Drosophila</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IOS-1652647</award-id><principal-award-recipient><name><surname>Bhandawat</surname><given-names>Vikas</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000055</institution-id><institution>National Institute on Deafness and Other Communication Disorders</institution></institution-wrap></funding-source><award-id>RO1DC015827</award-id><principal-award-recipient><name><surname>Bhandawat</surname><given-names>Vikas</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>RO1NS097881</award-id><principal-award-recipient><name><surname>Bhandawat</surname><given-names>Vikas</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value><italic>Drosophila</italic> uses a gait close to the tripod throughout its speed range, and changes in speed are accompanied by changes in the geometry of the tripod.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Behavior, including locomotion, results from interactions between the nervous system, the body, and the environment (<xref ref-type="bibr" rid="bib11">Chiel and Beer, 1997</xref>; <xref ref-type="bibr" rid="bib20">Full and Koditschek, 1999</xref>). Despite a history of research in both neurobiology (<xref ref-type="bibr" rid="bib9">Büschges et al., 2008</xref>; <xref ref-type="bibr" rid="bib13">Cruse, 1990</xref>; <xref ref-type="bibr" rid="bib16">Delcomyn, 1985</xref>; <xref ref-type="bibr" rid="bib19">Dürr et al., 2004</xref>; <xref ref-type="bibr" rid="bib26">Graham, 1985</xref>) and biomechanics (<xref ref-type="bibr" rid="bib20">Full and Koditschek, 1999</xref>; <xref ref-type="bibr" rid="bib21">Full and Tu, 1990</xref>), a complete integration of neural and mechanical systems for legged locomotion remains elusive. Recent developments in both methods for assessing neural activity (<xref ref-type="bibr" rid="bib32">Maimon et al., 2010</xref>; <xref ref-type="bibr" rid="bib42">Seelig et al., 2011</xref>; <xref ref-type="bibr" rid="bib56">Wilson et al., 2004</xref>) and the vast and ever-improving genetic toolkit <xref ref-type="bibr" rid="bib51">Venken et al., 2011</xref> have made <italic>Drosophila</italic> a vital model system for the study of neural control of behavior. In contrast, the mechanics of legged locomotion in flies remains understudied. In this study, we will focus on changes in speed during walking: we will first describe interleg coordination (used interchangeably with gait in this article), a necessary first step toward understanding mechanics, and then the mechanics of body–environment interaction that accompany changes in speed.</p><p>In insects, changes in interleg coordination with change in speed are strikingly different from mammals: mammals undergo transition from walking to other coordination patterns such as run, trot, or gallop at precise speeds. Moreover, in mammals, gait transitions measured in terms of speeds relative to their size defined as Froude number (<italic>Fr</italic>) occur at specific <italic>Fr</italic> (<xref ref-type="bibr" rid="bib1">Alexander, 1989</xref>). They walk below <italic>Fr</italic> of 0.3 while choosing other gaits at higher <italic>Fr</italic>. In contrast, insects employ a tripod gait at a wide range of <italic>Fr</italic> from 0.001 in flies (<xref ref-type="bibr" rid="bib4">Biswas et al., 2018</xref>), <italic>Fr</italic> of 0.25 in ants (<xref ref-type="bibr" rid="bib39">Reinhardt et al., 2009</xref>), and <italic>Fr</italic> &gt; 1 in cockroaches. Insects do change their gaits (<xref ref-type="bibr" rid="bib53">Wendler, 1966</xref>); when insects change gait, the gait selection in insects appears to be probabilistic, that is, different gaits can be employed at the same speed. Regardless, tripod is the most common gait in insects and why a tripod coordination can support a large range of speed is not well understood.</p><p>Changes in speed are also accompanied by changes in mechanics and are particularly well understood in mammalian locomotion. In particular, the mechanics of the center of mass (CoM) during locomotion are relatively simple, and models to explain CoM mechanics have provided many insights (<xref ref-type="bibr" rid="bib17">Dickinson et al., 2000</xref>; <xref ref-type="bibr" rid="bib20">Full and Koditschek, 1999</xref>). During mammalian walking, the CoM is at its highest position at mid-stance, and the horizontal speed of the CoM is lowest at mid-stance (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Running in humans or galloping in quadrupeds displays different kinematics from walking that is characterized by a minimum in CoM height (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Both the walking and running CoM kinematics can be explained by a simple mechanical model called the spring-loaded inverted pendulum (SLIP). In the SLIP model, the mass of the animal is concentrated into a point mass, which is supported by a single, massless effective leg (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). During the first half of stance, the spring is compressed as the body moves through the stance phase, converting kinetic energy into elastic energy stored by leg muscles and tendons. During the second half of stance, the stored elastic energy is converted back into kinetic energy. Thus, the kinetic energy, and therefore the speed, reaches its lowest value at mid-stance, as does the height in most cases. These mid-stance minimum in speed and height are also observed during running in many different mammals (<xref ref-type="bibr" rid="bib5">Blickhan, 1989</xref>; <xref ref-type="bibr" rid="bib6">Blickhan and Full, 1993</xref>; <xref ref-type="bibr" rid="bib10">Cavagna et al., 1977</xref>; <xref ref-type="bibr" rid="bib34">McMahon, 1984</xref>; <xref ref-type="bibr" rid="bib35">McMahon and Cheng, 1990</xref>), making SLIP an effective model for running. More recently, it has been appreciated that SLIP can also serve as a model for walking by producing a speed minimum and height maximum at mid-stance (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) when the spring is stiff (<xref ref-type="bibr" rid="bib23">Geyer et al., 2006</xref>). That SLIP can serve as a model for both walking and running has proven useful as a unifying model for mammalian locomotion.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>A new mechanical model for a tripod gait.</title><p>(<bold>A</bold>) Schematic showing a simple model for the center of mass (CoM) movement during locomotion. In this model (spring-loaded inverted pendulum [SLIP]), the mass of the animal is concentrated into a point that is supported by a single massless spring. The arrow represents the direction of locomotion. This model can capture the basic features of the CoM movement during walking (in humans) and running (in both humans and cockroaches). (<bold>B</bold>) SLIP cannot describe the fly’s CoM movement, which has a mid-stance maxima in speed. (<bold>C</bold>) A fly walking on three legs can be described by a springy tripod. The sagittal plane mechanics is governed by the sagittal plane projection of the springy tripod (see rectangle). (<bold>D</bold>) A springy tripod will produce angular restorative forces. Any movement away from the mid-stance position will produce restorative forces (represented by thin arrows). The thick arrows represent forces from front and back legs; thickness of the arrow indicates the magnitude of the force. Top: before mid-stance, the front leg is stretched and the back leg is compressed, leading to larger forces from the back leg. Bottom: after mid-stance, the front leg is compressed and exerts larger tangential forces. Net result is restorative forces. (<bold>E</bold>) The sagittal projection of a springy tripod can be modeled as the angular and radial spring-loaded inverted pendulum (ARSLIP) model. The angular springs expand as the CoM moves away from the mid-stance position and thereby generate restorative forces. The restorative forces can produce the mid-stance maximum in speed observed in flies in addition to the CoM movement pattern in human walking and running.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig1-v2.tif"/></fig><p>SLIP can also serve as a model for running in cockroaches. An elegant series of studies on running cockroaches has shown a striking similarity to mammalian running; in both cases, the CoM reaches a minimum in speed and height at mid-stance (<xref ref-type="bibr" rid="bib21">Full and Tu, 1990</xref>, <xref ref-type="bibr" rid="bib22">Full and Tu, 1991</xref>) and can be modeled by SLIP. The three legs of a tripod can be replaced by a single spring-loaded effective leg. However, by its very nature, SLIP cannot generate the CoM kinematics of many insects including <italic>Drosophila</italic> (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) because a fly’s horizontal speed during walking is at its maximum at mid-stance (<xref ref-type="bibr" rid="bib25">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>). Therefore, a mechanical framework consistent with both the CoM kinematics in flies and cockroaches is necessary.</p><p>A qualitative consideration of the mechanics of an animal walking on three legs shows that SLIP might be an oversimplified model: an animal walking with a tripod gait can be approximated as a point mass supported by three massless springs or a springy tripod (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). The sagittal plane projection of the springy tripod shown in the red box in <xref ref-type="fig" rid="fig1">Figure 1C</xref> is the mechanical system that governs the CoM movement in the sagittal plane. A springy tripod cannot be approximated by SLIP because the springy tripod is stable while SLIP is unstable. An animal supported by a single SLIP-like leg will fall. As the CoM moves away from the vertical (say toward the front of the fly), the front leg compresses and tends to push the fly backward (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). Similarly, if the CoM moves back, the hind leg will push it forward. These restorative forces cannot be modeled by SLIP but can be modeled by a simple extension to SLIP through the addition of an angular spring to model restorative forces. In other words, the three legs of a tripod act like a single leg whose behavior is described by a new biomechanical model – angular and radial spring-loaded pendulum (ARSLIP; <xref ref-type="fig" rid="fig1">Figure 1E</xref>). This model would enable the modeling of both the cockroach-like and fly-like kinematic patterns.</p><p>The mechanics of a springy tripod is not only affected by the stiffness of individual legs but also by its geometry (or where the legs are positioned on the ground). Changes in geometry can be a mechanism to accommodate large variation in speed supported by the tripod gait and have the potential to explain why tripod gaits can support a large range of speeds. The effect of geometry on mechanics can also be modeled by the ARSLIP model through the differential effects of the geometry on the two spring constants – the radial and angular spring constants (<xref ref-type="fig" rid="fig1">Figure 1E</xref>) – which describe the ARSLIP model.</p><p>In this study, we created an automated method for measuring the movement of a fly’s CoM in all three dimensions while also tracking the position of the fly’s stance legs. Using this method, we analyzed a fly’s gait over &gt;500 steps during which the fly is always walking straight. Flies employ a modified tripod (M-tripod) gait throughout their entire speed range with only a small dependence on speed. The proposed ARSLIP model can explain how tripod geometry affects the nature of forces that act on the fly, and ultimately defines its dynamics and can provide an elegant explanation for why insects do not change their gait over a wide speed range.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>An automated method for obtaining a fly’s walking kinematics with high spatial resolution</title><p>We designed an automated data acquisition system that generates a large positional dataset with high spatial resolution to investigate the fly’s gait and CoM kinematics. Similar to an approach employed previously (<xref ref-type="bibr" rid="bib37">Nye and Ritzmann, 1992</xref>; <xref ref-type="bibr" rid="bib57">Wosnitza et al., 2013</xref>), we recorded the side and the bottom (reflected off a mirror) view of a fly walking in a clear, closed cuboid chamber (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). We extracted all the steps during which a fly walked straight for more than one step. The fly’s CoM was extracted using the Kanade–Lucas–Tomasi (KLT) (<xref ref-type="bibr" rid="bib50">Tomasi and Kanade, 1991</xref>) algorithm and produced low-noise estimates of the CoM position; the vertical resolution being 20 μm (see 'Materials and methods', 'Tracking CoM and foothold positions', <xref ref-type="video" rid="video1">Video 1</xref>), which makes the rhythmic up-and-down movement of the CoM apparent (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). The positions of the leg tips during stance were extracted using a custom algorithm (see 'Materials and methods', 'Tracking CoM and foothold positions', <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). The legs were labeled according to an established convention (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), and the gait map (<xref ref-type="fig" rid="fig2">Figure 2C</xref>) was put together such that the legs that constitute a tripod – right prothoracic (R1), left mesothoracic (L2), and right metathoracic (R3) – are plotted on consecutive rows (orange); and those of the other tripod (L1–R2–L3) are plotted in another set of consecutive rows (marked in blue), to allow a direct assessment of the presence or absence of the tripod gait.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Experimental setup.</title><p>(<bold>A</bold>) Schematic of the arena. (<bold>B</bold>) A frame from a typical processed video of a fly walking in the chamber. The white traces track a point on the thorax and are a proxy for the center of mass. Yellow labels denote feet that are in stance, or the footholds. (<bold>C</bold>) Leg numbering and color coding (top), and gait maps (bottom) showing footfall patterns of individual legs in the R1–L2–R3 (orange) and L1–R2–L3 tripods (blue). Each row corresponds to a single leg. Black bars represent stance. (<bold>D</bold>) Stance and swing durations as functions of speed. The top dark gray line is the best fit of the reciprocal function to stance durations. The bottom lighter gray line is a best fit of linear regression to swing durations and shows a small decrease (a: −0.00018, p&lt;0.00001, b = 0.03).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Image processing used to obtain the 3D coordinates of the center of mass (CoM) and the time series of footholds in the body coordinate system (referred to from 'Materials and methods').</title><p>Yellow box denotes input, and blue boxes denote output. Rectangular elements with thick edges denote processed output. Rectangular elements with thin edges denote processes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Size of experimental tracking error compared to height change and speed change values (referred to from 'Materials and methods').</title><p>Height change and speed change values were divided by root mean squared error of tracking. Height change and speed change values are similar but different to the metric defined in 'Materials and methods', 'Definition of M-tripod'. Here, after detrending a trajectory, we are subtracting minimum from maximum instead of summing. This quantity indicates the overall amplitude of fluctuation. Red lines are means of the ratios.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig2-figsupp2-v2.tif"/></fig></fig-group><media id="video1" mime-subtype="mp4" mimetype="video" xlink:href="elife-65878-video1.mp4"><label>Video 1.</label><caption><title>Video of the fly showing the top and side views.</title><p>The center of mass is marked on both the top and side views. The rhythmic up and down movement of the center of mass can be seen on the top view. The stance legs are also marked.</p></caption></media><p>As a means of corroborating previous findings, we plotted stance and swing duration as a function of speed (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Consistent with previous studies (<xref ref-type="bibr" rid="bib25">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib38">Pearson, 1976</xref>; <xref ref-type="bibr" rid="bib46">Strauss and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib55">Wilson, 1966</xref>), the stance duration is inversely proportional to speed. The swing duration also changes with speed but to a smaller extent than the changes in stance duration.</p></sec><sec id="s2-2"><title>Flies employ interleg coordination close to tripod across speeds</title><p>We used two methods to characterize the speed-dependent change in coordination between legs: first, to facilitate comparison with previous work, interleg coordination was defined based on delays between the times at which the legs start either a swing or a stance phase. To visualize a fly’s gait, the times that a fly’s legs start the stance phase in relation to the time that the right front leg (R1) entered the stance phase were plotted. Legs that form the first set (R1–L2–R3) of tripod legs enter stance phase with a short interleg delay (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). The legs that form the other tripod (L1–R2–L3) enter the stance phase with a short interleg delay with each other but out of phase with the first set. The coordination pattern did not change noticeably as a function of speed (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This raw gait map (<xref ref-type="fig" rid="fig3">Figure 3A</xref>) suggests that the flies predominantly employ a tripod gait across all speeds. This trend (in <xref ref-type="fig" rid="fig3">Figure 3A</xref>) was quantified by calculating the delays relative to the cycle period (the time it takes a leg to complete both a swing and a stance, <xref ref-type="fig" rid="fig3">Figure 3B</xref>) or normalized delay. The normalized delays between the legs of the same tripod were small throughout the entire speed range; the within tripod delays became even smaller with speed. The prothoracic leg led the other legs in its tripod with a small but significant negative delay consistent with previous observations in cockroaches (<xref ref-type="bibr" rid="bib3">Bender et al., 2011</xref>; <xref ref-type="bibr" rid="bib15">Delcomyn, 1971</xref>). On the other hand, the normalized delays across legs in the opposing tripods were 0.5 (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). These analyses suggest that the gait – as defined by phase differences between legs – employed by flies during forward walking across the entire range of speeds is close to a tripod.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Interleg coordination pattern is consistent with a modified tripod (M-tripod) gait.</title><p>(<bold>A</bold>) Stance for all steps relative to R1 sorted by speed. (<bold>B</bold>) Normalized time delays of stance start times between legs within a tripod (R1 and L2, L2 and R3) and legs in the opposing tripod (R1 and L1). The time delays were normalized by cycle duration. R1–L2 and L2–R3 delays are small at low speeds and become even smaller as the walking speed increases (Wilcoxon sign-rank test). R1–L1 delays are unchanged. (<bold>C</bold>) The phase difference between legs is consistent with a single gait, which is a modified version of a tripod (M-tripod) in which the front leg of the tripod leads the middle leg that in turn leads the back leg. The delay between the legs has a small dependence on speed (v). (<bold>D</bold>) Definition of leg phase angles. Stances start and end at 0 and π, respectively; swings start and end at –π and 0, respectively. (<bold>E</bold>) The leg phases relative to R1 show that interleg coordinations at different speeds all consistent with M-tripod. The delays between tripod legs do become smaller with speed (Wilcoxon sign-rank test) while the delays between R1 and L1 leg remain unchanged. (<bold>F</bold>) The M-tripod based on phase lag (v=speed).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig3-v2.tif"/></fig><p>The normalized delays between different legs are consistent with that of a single gait that is close to a tripod but in which the front leg of the tripod is ahead of the middle leg, which in turn is ahead of the rear leg; we will refer to this gait as M-tripod (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The delays between legs within a tripod do decrease slightly with speed (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The small dependence means that there is no qualitative change in gait. This small dependence on speed is consistent with the continuum of coordination patterns observed in a recent study (<xref ref-type="bibr" rid="bib14">DeAngelis et al., 2019</xref>).</p><p>A second method to quantify leg coordination is to use instantaneous phase lags between legs (<xref ref-type="fig" rid="fig3">Figure 3D</xref>) averaged over a gait cycle (<xref ref-type="bibr" rid="bib12">Couzin-Fuchs et al., 2015</xref>; <xref ref-type="bibr" rid="bib41">Revzen and Guckenheimer, 2008</xref>). Although time delays are easier to visualize and phase lag more abstract, the latter provides a more accurate measure of coordination because it takes the entire step into account instead of only the beginning of stance (see 'Materials and methods' 'Gait analysis based on leg phases'). As in the case of stance start times, the distribution of phase lags between the reference leg (R1) and the other legs show small phase differences between the legs within a tripod and large phase differences between the legs in the opposing tripod (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). The phase plots also reveal that the front leg of the tripod leads the middle and back legs. As the speed increases, the phase difference between the tripod leg decreases, and the spread of the phase difference also becomes smaller (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). The analysis using instantaneous phases is consistent with a single gait – M-tripod – across the entire range of speed; the exact speed dependence of M-tripod gait using phase difference (<xref ref-type="fig" rid="fig3">Figure 3F</xref>) is slightly different from the speed dependence calculated from stance start times (<xref ref-type="fig" rid="fig3">Figure 3C</xref>).</p><p>A small percentage (about 4%) of steps at very low speeds did not conform to any gait, and a few steps had a tetrapod coordination pattern, but an overwhelming majority of the steps have a tripodal coordination. The rest of the study will focus on steps that have a tripodal coordination.</p></sec><sec id="s2-3"><title>Kinematic changes associated with changes in speed</title><p>Given that flies can walk over their entire speed range using a M-tripod gait implies that a change in gait is not essential for a change in speed. To better understand the mechanism underlying change in speed, we focused on the tripodal steps and asked how the movement of the fly’s CoM over the tripod gait cycle changed with speed. Because the tripod legs are not perfectly in sync, we defined the tripod start as the halfway time point between the time that the very first foot of the current tripod lands and the last foot of the preceding tripod is lifted (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Similarly, we set the tripod end as the halfway point between the very first foot landing time of the following tripod and the last lift-off time of the tripod of interest (dotted blue lines in <xref ref-type="fig" rid="fig4">Figure 4A</xref> mark the start and end of each tripod). We will refer to the tripod stance as a step.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Mechanical changes associated with changes in speed.</title><p>(<bold>A</bold>) Example trace showing the changes in center of mass (CoM) speed and height. Dotted blue lines are the boundaries between consecutive tripod stance (see text). The CoM shows clear mid-stance maxima in height and speed. (<bold>B</bold>) A slower step is characterized by smaller initial speed, smaller speed changes, and lower height. (<bold>C</bold>) Within step speed changes increase with speed (p&lt;0.0001). Line is the best fit of y=ax to the data. a = 0.32. (<bold>D</bold>) The initial speed increases as the fly walks faster, but this increased speed makes a smaller contribution at higher speed reflected by the increased deviation (gray line is the best fit) from the line of unity (dotted red line). a = 0.9438; 95% confidence bounds (0.9393, 0.9484). (<bold>E</bold>) Distance traveled during tripod stance increases with speed (p&lt;0.0001). a = 0.026, b = 0.39. (<bold>F</bold>) Tripod stance duration decreases with speed. a = 187.8, b = −1.056, c = 15.45.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Calculation for height and speed change.</title><p>(<bold>A</bold>) Algorithm for height and speed change calculation. (<bold>B</bold>). Example calculation on the experimental data (referred to from 'Materials and methods').</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig4-figsupp1-v2.tif"/></fig></fig-group><p><xref ref-type="fig" rid="fig4">Figure 4A</xref> shows the speed profile during a fast step. As previously reported for stick insects (<xref ref-type="bibr" rid="bib26">Graham, 1985</xref>) and <italic>Drosophila</italic> (<xref ref-type="bibr" rid="bib25">Graham, 1972</xref>; <xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>), the CoM typically reached a maximum horizontal speed at mid-stance (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). <xref ref-type="fig" rid="fig4">Figure 4B</xref> shows the speed for a slower step. A slow step is characterized by both a lower initial speed and a smaller speed increase.</p><p>It is important to note that there is a mid-stance maximum in the height of the fly and that the flies are more erect when they are walking faster (<xref ref-type="fig" rid="fig4">Figure 4A, B</xref>). We will show later that this change in height is partially responsible for the increase in speed.</p><p>The change in speed within a step increased with the average speed during the step. (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). At low walking speed, much of the change in speed was due to the increased initial speed. At higher walking speed, the mid-stance increases in speed made a greater contribution (<xref ref-type="fig" rid="fig4">Figure 4D</xref>).</p><p>The distance traveled over the tripod gait cycle also increases with speed (<xref ref-type="fig" rid="fig4">Figure 4E</xref>), and the duration of the tripod gait cycle decreases (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Thus, the increase in speed is due to both the greater distance travelled during the step, and faster steps. The longer and faster steps result both from a faster speed at the beginning of the step and a greater increase in speed during the step.</p><p>In the rest of the article, we will describe a simple mechanical model that not only describes the mid-stance maximum in speed during a step but also describes the changes in mechanics underlying changes in speed.</p></sec><sec id="s2-4"><title>A new mechanical model for locomotion in insects</title><p>As described in the 'Introduction', an animal walking with a tripod coordination can be modeled as a springy tripod where a point mass is supported by three legs. For symmetry, in our model, these legs were of equal natural length, and the body’s movement within a step can be described as an arc about the middle leg. The body’s position at any instant is described by <inline-formula><mml:math id="inf1"><mml:mi>θ</mml:mi></mml:math></inline-formula>, the angle the body makes with the vertical, and <italic>r</italic> is the length of the middle leg. The behavior of this mechanical system can be described by its elastic potential energy. As the body moves through its stance phase, this elastic potential energy changes as some legs stretch and others compress. The total elastic potential energy of a springy tripod (<xref ref-type="fig" rid="fig5">Figure 5</xref>) is simply the sum of the potential energies due to the three legs.<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>The angular and radial spring-loaded inverted pendulum (ARSLIP) model is equivalent to the springy tripod model.</title><p>(<bold>A</bold>) The sagittal plane mechanics is governed by the sagittal plane projection of the springy tripod. The arrow denotes the direction of motion. The parameters that define the springy tripod model are shown. The overall stiffness of the springy tripod is determined by the spring constant of individual legs, <italic>k</italic>, the height of the tripod (<italic>r<sub>m</sub></italic>), and the distance between the front and back legs (2L). See <xref ref-type="table" rid="table1">Table 1</xref> as well. The behavior of the springy tripod is described by how the coordinates of the point mass – <italic>r</italic> and <inline-formula><mml:math id="inf2"><mml:mi>θ</mml:mi></mml:math></inline-formula> – change with time. (<bold>B</bold>) The sagittal plane projection of a springy tripod can be modeled as the ARSLIP model. The parameters that describe the ARSLP model are shown. Just like the springy tripod, ARSLIP is described by how the coordinates of the point mass – <italic>r</italic> and <inline-formula><mml:math id="inf3"><mml:mi>θ</mml:mi></mml:math></inline-formula> – change with time. The potential energy of the tripod can be derived as a sum of the elastic energies of the three legs. The ARSLIP potential energy can be derived by summing radial and angular potential energies. The equivalence of the two models is shown by finding parameter set for ARSLIP where the potential energies as a function of <italic>r</italic> and <inline-formula><mml:math id="inf4"><mml:mi>θ</mml:mi></mml:math></inline-formula> are similar when <inline-formula><mml:math id="inf5"><mml:mi>θ</mml:mi></mml:math></inline-formula> is small and changes in <italic>r</italic> are small (derived in 'Materials and methods').</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig5-v2.tif"/></fig><p>where <inline-formula><mml:math id="inf6"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the natural length of the springy tripod; <inline-formula><mml:math id="inf7"><mml:mi>r</mml:mi> <mml:mi/></mml:math></inline-formula> is the length of the middle leg; <inline-formula><mml:math id="inf8"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the angle that it makes with the vertical axis, which are also identified with the radial and angular coordinate of ARSLIP; 2<italic>L</italic> is the spread of the tripod or the distance between the prothoracic and metathoracic legs of the tripod in the direction of walking; and <italic>k</italic> is the stiffness of each leg. The variables are also enumerated in <xref ref-type="table" rid="table1">Table 1</xref> and shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Notations used in the article.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="top">Symbol</th><th valign="top">Definition and units</th><th valign="top">Other explanation</th></tr></thead><tbody><tr><td valign="top"><italic>r</italic></td><td valign="top">Radial coordinate</td><td valign="top">Variable in ARSLIP and SLIP models</td></tr><tr><td valign="top"><italic>θ</italic></td><td valign="top">Angular coordinate</td><td valign="top">Variable in ARSLIP and SLIP models</td></tr><tr><td valign="top"><italic>R</italic></td><td valign="top">(AR)SLIP spring natural length</td><td valign="top">Optimized for each fly. Set to be within 10% of the measured mesothoracic leg</td></tr><tr><td valign="top"><italic>R<sub>tri</sub></italic></td><td valign="top">Tripod spring natural length</td><td valign="top">Optimized for each fly</td></tr><tr><td valign="top"><italic>k<sub>s</sub></italic></td><td valign="top">Radial spring constant</td><td valign="top">Variable in ARSLIP and SLIP models</td></tr><tr><td valign="top"><italic>k<sub>a</sub></italic></td><td valign="top">Angular spring constant</td><td valign="top">Variable in ARSLIP and SLIP models</td></tr><tr><td valign="top"><italic>k</italic></td><td valign="top">Spring constant for individual legs</td><td valign="top">Variable in springy tripod</td></tr><tr><td valign="top"><italic>r<sub>m</sub></italic></td><td valign="top">Mid-stance height</td><td valign="top">Experimentally determined for each step (see <xref ref-type="fig" rid="fig7">Figure 7A</xref>)</td></tr><tr><td valign="top"><italic>v</italic></td><td valign="top">Speed or horizontal velocity</td><td valign="top"/></tr><tr><td valign="top"><italic>V</italic></td><td valign="top">ARSLIP potential energy</td><td valign="top"/></tr><tr><td valign="top"><inline-formula><mml:math id="inf9"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></inline-formula> <italic>≡ r/ R</italic></td><td valign="top">Nondimensional radial coordinate</td><td valign="top"/></tr><tr><td valign="top"><italic>γ<sub>s</sub></italic></td><td valign="top">Nondimensional radial spring constant</td><td><inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td></tr><tr><td valign="top"><italic>γ<sub>a</sub></italic></td><td valign="top">Nondimensional angular spring constant</td><td><inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf12"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula></td><td valign="top">Nondimensional mid-stance height</td><td valign="top"><italic>r<sub>m</sub> / R</italic></td></tr><tr><td valign="top"><italic>Ω</italic></td><td valign="top">Nondimensional mid-stance angular speed</td><td valign="top"/></tr><tr><td valign="top"><italic>Fr</italic></td><td valign="top">Froude number – nondimensionalized speed</td><td valign="top"><italic>v <sup>2</sup>/(g*leg length)</italic></td></tr><tr><td valign="top"><italic>L</italic></td><td valign="top">Tripod spread</td><td valign="top">Experimentally determined for each step (see <xref ref-type="fig" rid="fig7">Figure 7A</xref>)</td></tr><tr><td valign="top"><italic>V<sub>tri</sub></italic></td><td valign="top">Tripod potential energy</td><td valign="top"/></tr><tr><td valign="top"><italic>g</italic></td><td valign="top">Gravitational constant</td><td valign="top"/></tr><tr><td valign="top"><italic>m</italic></td><td valign="top">Mass of the fly</td><td valign="top">Mass was kept fixed; average mass of flies of a particular sex and genotype was measured</td></tr><tr><td valign="top">ARSLIP</td><td valign="top">Angular and radial spring-loaded inverted pendulum</td><td valign="top"/></tr></tbody></table></table-wrap><p>We can show through a formal analysis using a Taylor series expansion of the Lagrangian for the springy tripod (see 'Materials and methods' 'Derivation of the formula relating tripod model to ARSLIP') that springy tripod approximately reduces to the ARSLIP model (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). As a reminder, in the ARSLIP model, the three legs of the springy tripod are replaced by a single effective leg with a radial and an angular spring. Specifically, <inline-formula><mml:math id="inf13"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> is equivalent to the ARSLIP potential energy, <italic>V</italic> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>), for evolution that is close to the midpoint <inline-formula><mml:math id="inf14"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and <inline-formula><mml:math id="inf15"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>.<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The <inline-formula><mml:math id="inf16"><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>r</mml:mi><mml:mo>-</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> term corresponds to potential energy due to the radial spring aligned along the effective leg connecting the middle tripod leg to the CoM, and the <inline-formula><mml:math id="inf17"><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> term corresponds to the potential energy from an angular spring capturing the tangential restorative forces exerted by the front and back legs. In this model, the mechanics of an animal is controlled by the two spring constants, <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, which describe the stiffness of the radial and the angular spring, respectively, and the natural spring length, <italic>R</italic>.</p><p>In essence, the mechanics of the fly walking on a springy tripod can be described by the ARSLIP model. An important point that we will elaborate on later is that the springy tripod is a simplification of the actual configuration of the fly while it is walking, but the ARSLIP model is a more general model and can serve as an accurate model even without making the assumptions of the springy tripod.</p><p>The approach above is based on potential energy. The distinction between SLIP and ARSLIP is clearer when considering forces modeled in the two cases. In SLIP, forces are always along the leg. The ARSLIP model provides a mechanism by which tangential forces can also be transmitted to the body. Importantly, the angular spring forces switch direction at mid-stance, which means that they aid forward progression during the first half of the stance and oppose forward progression during the second half of the stance. This pattern is exactly opposite to the pattern created by SLIP. Depending on whether the leg spring dominates, or the angular spring, one can get a cockroach-like speed minimum or fly-like speed maximum at mid-stance.</p></sec><sec id="s2-5"><title>ARSLIP models the kinematics of a fly’s CoM during walking</title><p>We evaluated the performance of the SLIP and ARSLIP models by fitting them to the fly’s CoM kinematics. Because the stance times of two consecutive tripods can overlap substantially, a complete model would involve two effective legs, each of which functions as either SLIP or ARSLIP; this complete model with two effective legs would have too many parameters and might obscure many of the insights that we obtain from modeling. Therefore, we modeled the CoM kinematics of a tripod stance (as defined in <xref ref-type="fig" rid="fig4">Figure 4A</xref>) using a single effective leg. The model parameters approximate the control exerted by the fly at each step. In the ARSLIP model, the fly chooses as its initial condition the angle of attack (<inline-formula><mml:math id="inf20"><mml:mi>α</mml:mi></mml:math></inline-formula>), angular speed (<inline-formula><mml:math id="inf21"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>), leg length (<inline-formula><mml:math id="inf22"><mml:mi>r</mml:mi></mml:math></inline-formula>), and radial speed (<inline-formula><mml:math id="inf23"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula>) at the beginning of the step. The evolution of the CoM depends on the angular spring constant (<inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), leg spring constant (<inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and the natural leg length of the effective leg (<inline-formula><mml:math id="inf26"><mml:mi>R</mml:mi></mml:math></inline-formula>). The only difference between ARSLIP and SLIP is the absence of the angular spring, and hence there is no <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in SLIP.</p><p>We minimized the root mean squared error (RMSE) between the SLIP and ARSLIP-predicted position of the CoM, and the experimentally measured position using an optimization algorithm (see 'Materials and methods', 'System of ordinary differential equations for SLIP and ARSLIP and details regarding fitting ordinary differential equations to individual steps'). SLIP can model the small increase in the vertical position of the CoM, which results from two competing effects: height increase due to the progression of the CoM from its extremum to the vertical mid-stance position and a height decrease due to the compression of the leg spring (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). However, as reported previously (<xref ref-type="bibr" rid="bib4">Biswas et al., 2018</xref>), SLIP fails to describe the horizontal progression of the CoM. This failure is clear from a comparison of the experimental horizontal speed profile and the theoretical speed profile (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, bottom panel). In contrast, ARSLIP can describe both the horizontal and vertical progression of the CoM (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). In ARSLIP, the angular spring accelerates the CoM during the first half of the stance phase. It can, therefore, compensate for, or even overcome, the decelerating effects of the radial spring and gravity, and can model the mid-stance maximum in speed. ARSLIP presented significantly smaller RMSEs for both horizontal and vertical CoM displacements than SLIP (<xref ref-type="fig" rid="fig6">Figure 6C</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Angular and radial spring-loaded inverted pendulum (ARSLIP) describes the kinematics of a fly’s center of mass (CoM).</title><p>(<bold>A</bold>) The best fit of SLIP (green) and (<bold>B</bold>) ARSLIP models – to the height (top) and horizontal position of the CoM (middle). Speed (bottom) was not used to fit but is plotted to simply show why SLIP fails. Gait maps are shown with CoM height. (<bold>C</bold>) ARSLIP is a significantly better model than SLIP (Wilcoxon rank-sum test; p&lt;0.001 for both horizontal and vertical movement). Each dot is the root mean squared error (RMSE) for the best fit to a single tripod stance. The example step presented in (A) and (B) is marked as a black dot and was chosen close to the SLIP median RMSE. Black horizontal line is the median. (<bold>D</bold>) γ<sub>s</sub> (left) and γ<sub>a</sub> (right), which are nondimensionalized spring constants, increase with speed in most flies. Each line is a fit to the steps from a single fly. Black dots (n = 74) show values corresponding to individual steps for one fly and the fit corresponding to that fly. Solid lines are the regressions with p&lt;0.05 from F-test, and dotted lines are p&gt;0.05.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Fit parameters of the angular and radial spring-loaded inverted pendulum model.</title><p>Each dot is the the best fit parameter for a single tripod stance.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig6-figsupp1-v2.tif"/></fig></fig-group><p>That the ARSLIP model describes the CoM kinematics well means that two linear springs defined by their spring constants – <inline-formula><mml:math id="inf28"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>– are sufficient to describe the fly’s CoM kinematics during a step. The range of parameter values for all the fitted steps in our dataset is shown in <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>. The median <inline-formula><mml:math id="inf30"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> was 0.009 N/m. This spring constant implies that to support its mass of 1 mg or 10 μN weight, the fly compresses this effective spring by about 1 mm or approximately 50% of its length. During a step, the spring is always compressed such that its length is close to the fixed point of the spring (length at which the spring forces cancel gravitational forces) and oscillates about this fixed point without reaching its natural length. The magnitude of these oscillations is small and reaches a maximum of 10% (of its length at fixed point) about the fixed point. The nondimensional radial spring constant <inline-formula><mml:math id="inf31"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see 'Materials and methods' for definition) is ~2 compared to &gt;10 for humans (<xref ref-type="bibr" rid="bib2">Antoniak et al., 2019</xref>). The median <inline-formula><mml:math id="inf32"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> was 1.1 × 10<sup>−8</sup> Nm/radian. In nondimensional terms, the angular spring constant <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was ~0.5, which is like the values obtained in humans. Therefore, compared to humans, the relative role of angular spring in flies is much larger.</p><p>Most animals increase their walking speed by decreasing the stance duration (<xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib38">Pearson, 1976</xref>). Modeling stance using an effective limb that functions as a spring provides a simple explanation for the mechanical changes that accompany this decrease: in any two-dimensional motion – including walking in the sagittal plane discussed here – the vertical and horizontal motion must be synchronized by relating parameters governing the vertical and horizontal time scale. The vertical oscillatory motion is controlled by the radial spring constant, and the horizontal motion by the angular speed. As the walking speed increases and the stance duration decreases, the vertical oscillations must occur faster by making the effective leg stiffer (because the time needed for vertical oscillation decreases with increases in spring stiffness). This increase in stiffness has indeed been observed in humans (<xref ref-type="bibr" rid="bib2">Antoniak et al., 2019</xref>). We found a similar increase in stiffness in flies (<xref ref-type="fig" rid="fig6">Figure 6D</xref>). As the fly’s walking speed increases, <inline-formula><mml:math id="inf34"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, the nondimensionalized version of <italic>k<bold><sub>s</sub></bold></italic> increases. The nondimensional angular spring constant, <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, increases as well; this increase accounts for the greater within-step increases in speed observed at higher speed (see <xref ref-type="fig" rid="fig4">Figure 4C</xref>).</p><p>In the next section, we will show that the mechanism underlying the change in spring constant is surprisingly a result of the change in the geometry of the tripod with speed rather than the change in spring constant of the individual legs.</p></sec><sec id="s2-6"><title>Change in tripod geometry increases spring stiffness necessary for change in speed</title><p>In bipedal walkers, the only mechanism for increasing the overall stiffness of the system is to increase the stiffness of each leg. In the case of polypedal walkers such as insects, including flies, the geometry of the tripod itself is a parameter that can be adjusted to alter the stiffness of the overall system. To test the extent to which the geometry of the tripod on a given step influences its kinematics on that step, we derived the equivalent ARSLIP model that displays the same dynamics as the springy tripod around its mid-stance position using the empirically obtained tripod geometry (determined by the tripod spread, <inline-formula><mml:math id="inf36"><mml:mi>L</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> and mid-stance height, <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, in <xref ref-type="fig" rid="fig7">Figure 7A</xref>) and mass of the fly (see 'Materials and methods' for details). Specifically, using the following equations:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>R</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula></p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Flies increase their height and decrease the extent of their tripod as they increase their speed.</title><p>(<bold>A</bold>) We measure <italic>r<sub>m</sub></italic> and L for each step which describe the tripod geometry during a step. The tripod geometry can be used to predict γ<sub>a</sub> and γ<sub>s</sub> using <xref ref-type="disp-formula" rid="equ3 equ4 equ5">Equations 3–5</xref>. (<bold>B</bold>) γ<sub>a</sub> (top) and γ<sub>s</sub> (bottom) decrease as L/r<sub>m</sub> increases. Narrow and high tripods are stiffer (see red cartoons atop). (<bold>C</bold>) The spring constants predicted from geometry closely correlate to the optimal spring constants calculated in <xref ref-type="fig" rid="fig6">Figure 6</xref> (γ<sub>a</sub>: left and γ<sub>s</sub>: right). The red line is the line of unity. (<bold>D</bold>) γ<sub>a</sub> (left) and γ<sub>s</sub> (right) replotted from <xref ref-type="fig" rid="fig6">Figure 6</xref> show increase with speed. (<bold>E</bold>) Increases in Fr in most flies are concomitant with decrease in L/r<sub>m</sub>. Each line is a fit to a different fly. Solid lines are the regressions with p&lt;0.05 from F-test, and dotted lines are p&gt;0.05. Black dots (n = 74) show values corresponding to individual steps for one fly, and black line is a fit for that fly.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig7-v2.tif"/></fig><p>We can relate the ARSLIP spring constants – <inline-formula><mml:math id="inf38"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and R (the natural length of the ARSLIP spring) to <inline-formula><mml:math id="inf40"><mml:mi>k</mml:mi></mml:math></inline-formula>, the spring constant of individual legs, <italic>R<sub>tri</sub></italic>, the natural length of individual legs, and the tripod geometry (determined by <inline-formula><mml:math id="inf41"><mml:mi>L</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in <xref ref-type="fig" rid="fig7">Figure 7A</xref>).</p><p>If the spring constant of individual legs remains the same, the springy tripod model predicts that <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf44"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula>(nondimensionalized versions of <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) will both vary over a twofold range due to the variation in the observed geometry of the tripod. Specifically, in the range of values observed in flies, as <inline-formula><mml:math id="inf47"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio decreases or the tripod becomes narrow and tall, both <inline-formula><mml:math id="inf48"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increase (<xref ref-type="fig" rid="fig7">Figure 7B</xref>).</p><p>We can exploit this dependence of <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf51"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> on the tripod geometry to examine how well the change in tripod geometry from one step to the next predicts the best fit <inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf53"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values from <xref ref-type="fig" rid="fig6">Figure 6</xref>. To this end, we determined a single <inline-formula><mml:math id="inf54"><mml:mi>k</mml:mi> <mml:mi/></mml:math></inline-formula> and <italic>R<sub>tri</sub></italic> for each fly, which best satisfies <xref ref-type="disp-formula" rid="equ3 equ4 equ5">Equations 3–5</xref> for all the steps fitted with the ARSLIP model for that fly. To compare across flies, we converted the <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values to their nondimensionalized versions <inline-formula><mml:math id="inf57"> <mml:mi/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></inline-formula> We found that, despite all the simplifying assumptions, the predicted <inline-formula><mml:math id="inf59"> <mml:mi/><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> derived from the tripod geometry were close to the optimal <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf62"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> obtained from the best fit to the CoM kinematics (<xref ref-type="fig" rid="fig7">Figure 7C</xref>). The similarity between predicted and fitted spring constants is particularly significant because the prediction for all the steps of a given fly was made with a single parameter set while fits were optimized for each step representing a large decrease in the number of parameters. These results show that the tripod geometry plays a critical role in governing the spring constants.</p><p>The strong correlation between spring constants predicted from the geometry and those from optimization suggests that changes in tripod geometry are employed by the fly to change speed. Since <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increase with speed (replotted in <xref ref-type="fig" rid="fig7">Figure 7D</xref>), we anticipate that the increase in speed is usually reflected as a change in <inline-formula><mml:math id="inf65"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio (<xref ref-type="fig" rid="fig7">Figure 7E</xref>), implying that the change in tripod geometry is an important mechanism for the control of speed during walking.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>There are four main findings in this study:</p><list list-type="bullet"><list-item><p>Flies use a M-tripod gait across all speeds.</p></list-item><list-item><p>Faster steps are accompanied by higher initial speed and larger increases in speed during the step, resulting in the fly covering longer distances in a shorter time. The kinematic pattern during a step and its changes with speed are explained by a new model – ARSLIP – within which the dynamics are described by two spring constants. An increase in speed is accompanied by an increase in the spring constants that characterize the ARSLIP model. This increase in stiffness is an important biomechanical adaptation necessary for change in speed.</p></list-item><list-item><p>The increased stiffness is not a result of each leg becoming stiff but results from a change in the geometry of the tripod and the height of the fly: flies locomote with a narrower and higher posture, resulting in increased stiffness at a higher speed.</p></list-item><list-item><p>To our knowledge, the effect of tripod geometry on insect locomotion has not been investigated. Because the tripod geometry varies widely between insects, the tripod geometry might be an important determinant of an insect’s walking kinematics and has the potential to explain many features of insect locomotion (see last section of 'Discussion') including the fact that insects can walk with a tripod gait across a large range of speeds.</p><p>These findings are discussed below.</p></list-item></list><sec id="s3-1"><title>Flies employ a tripod coordination during forward walking</title><p>Flies appear to predominantly employ a gait close to a tripod gait – M-tripod – across their entire range of speeds. These results are consistent with other studies in flies (<xref ref-type="bibr" rid="bib14">DeAngelis et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Strauss and Heisenberg, 1990</xref>). Similar observations have been made during free walking in other insects such as cockroaches (<xref ref-type="bibr" rid="bib16">Delcomyn, 1985</xref>; <xref ref-type="bibr" rid="bib27">Hughes, 1952</xref>; <xref ref-type="bibr" rid="bib45">Spirito and Mushrush, 1979</xref>), ants (<xref ref-type="bibr" rid="bib40">Reinhardt and Blickhan, 2014</xref>; <xref ref-type="bibr" rid="bib52">Wahl et al., 2015</xref>; <xref ref-type="bibr" rid="bib58">Zollikofer, 1994</xref>), and locusts (<xref ref-type="bibr" rid="bib8">Burns, 1973</xref>).</p><p>The M-tripod gait itself is not fixed but has a small dependence on speed. This small dependence on speed as well as the increase in duty factor as the speed decreases implies that the average number of legs on the ground at any given time will decrease with speed. This increase in the number of legs has been shown to be important for stability (<xref ref-type="bibr" rid="bib47">Szczecinski et al., 2018</xref>).</p><p>The M-tripod gait only applies to forward walking at a fixed speed. The entire complement of gaits that the fly employs to turn, accelerate, and decelerate remains to be determined. It is important to note too that our findings do not imply that the flies are only capable of a fixed gait. There is evidence that flies change their gait upon amputation (<xref ref-type="bibr" rid="bib28">Isakov et al., 2016</xref>). In our dataset as well, there is clear evidence for tetrapod gait; however, the fraction of steps during which flies adopt a tetrapod gait is very small.</p></sec><sec id="s3-2"><title>The geometry of the tripod is an important determinant of walking speed</title><p>An unexpected result was the extent to which the shape of the tripod formed by the three tripod legs – particularly the ratio of the height of the tripod to its anterior-posterior spread – can explain a fly’s CoM kinematics during a step. Previous studies have shown that neither the swing duration nor the swing amplitude (the distance that a leg travels during the swing) changes much as the fly’s walking speed changes (<xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Strauss and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib57">Wosnitza et al., 2013</xref>), a result that is confirmed in this study. Much of the change in speed results from a decrease in stance duration (<xref ref-type="bibr" rid="bib36">Mendes et al., 2013</xref>; <xref ref-type="bibr" rid="bib46">Strauss and Heisenberg, 1990</xref>; <xref ref-type="bibr" rid="bib57">Wosnitza et al., 2013</xref>), another result consistent with this study. In other words, increase in walking speed results from an increase in the angular speed of the body about its stance legs. This increase requires two elements: a neural element whereby increasing the drive into the central pattern generators would cause them to cycle faster, as has been demonstrated in stick insects (<xref ref-type="bibr" rid="bib9">Büschges et al., 2008</xref>). A biomechanical element: moving faster also requires larger forces from the ground, and a mechanically stiffer system (in this case, the mechanical system consists of the fly and the legs that support the fly) would be able to transmit more forces from the ground to the body. There are two mechanisms by which the system can become mechanically stiffer. Either a fly could make each leg stiffer just as has been shown in humans (<xref ref-type="bibr" rid="bib2">Antoniak et al., 2019</xref>; <xref ref-type="bibr" rid="bib30">Kim and Park, 2011</xref>) or it could change the geometry of the tripod to make the overall system stiffer. The data in <xref ref-type="fig" rid="fig7">Figure 7</xref> is consistent with the second idea that the changes in the geometry of the tripod are the dominant component by which flies control the stiffness of γ<sub>a</sub> and γ<sub>s</sub> and thereby change their walking speed. Changes in γ<sub>s</sub> allow the fly to adjust the stiffness of its mechanical system to the stance duration; a stiffer γ<sub>s</sub> means shorter time period of oscillation. Changing γ<sub>s</sub> through changes in geometry would also change γ<sub>a</sub>. We regard the changes in γ<sub>a</sub> as an inevitable consequence of the changes in γ<sub>s</sub>; nonetheless, the increase does provide a parsimonious explanation for the greater mid-stance maximum in speed observed when the fly walks faster.</p><p>To our knowledge, the control of speed through tripod geometry has never been explored in any insect. One reason for this deficiency is methodological. Researchers usually collate their data across steps, trials, and individuals. This process is bound to obscure any trends in tripod shape; analysis at the level of single steps is necessary, and trends within an individual must be compared. Another methodological issue is that the height of the animal during locomotion is rarely measured.</p></sec><sec id="s3-3"><title>The large variation in tripod geometry can explain the broad range of kinematics observed among insects</title><p>In flies, the <inline-formula><mml:math id="inf66"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio varies between 1 and 2. How about other insects? We could obtain a rough estimation of the <inline-formula><mml:math id="inf67"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio for a few insects by piecing together information from some manuscripts or by measuring these ratios from the figures in the papers: for three species of stick insects, the ratio ranges between 2 and 3 (<xref ref-type="bibr" rid="bib48">Theunissen et al., 2015</xref>), wood ants have a <inline-formula><mml:math id="inf68"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio of closer to 1 (<xref ref-type="bibr" rid="bib40">Reinhardt and Blickhan, 2014</xref>), and cockroaches have a <inline-formula><mml:math id="inf69"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio closer to 6 (<xref ref-type="bibr" rid="bib49">Ting et al., 1994</xref>). This large variation in the <inline-formula><mml:math id="inf70"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio will have a large effect on the CoM kinematics within a step. Given a leg stiffness γ, at low <inline-formula><mml:math id="inf71"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio, that is, when the legs are almost vertical, γ<sub>s</sub> is large in comparison to γ<sub>a</sub>; therefore, the deceleration due to γ<sub>s</sub> as the fly approaches mid-stance cannot be compensated by the acceleration due to γ<sub>a.</sub> As the <inline-formula><mml:math id="inf72"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio increases, the effects due to γ<sub>a</sub> and γ<sub>s</sub> are comparable for a range of <inline-formula><mml:math id="inf73"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values. At very large <inline-formula><mml:math id="inf74"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratios, γ<sub>s</sub> again dominates. These ideas can be formalized by deriving conditions for which the gait is cockroach-like versus fly-like (Appendix): whether the gait is cockroach-like or fly-like depends on the interplay between γ<sub>a</sub> and γ<sub>s</sub>, which in turn depends on the stiffness of individual legs and the geometry of the tripod. For a given <inline-formula><mml:math id="inf75"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, there is a leg stiffness γ above which the kinematics change from a cockroach-like gait to a fly-like gait (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). As expected, the data points for each of the fitted steps for the fly lie above the function that demarcates the two kinematic types. Importantly, the <inline-formula><mml:math id="inf76"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio for flies and several other insects places them in a regime in which the leg stiffness required for a fly-like gait is at a minimum (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). Indeed, ants, stick insects, and flies all have fly-like kinematics. On the other hand, cockroaches have <inline-formula><mml:math id="inf77"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> values that predispose them toward a mid-stance minimum velocity profile.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>The large variation in tripod geometry can explain why insects that employ a tripod gait have varying speed and kinematics.</title><p>Two parameters that affect the stiffness of an animal walking on a tripod are the nondimensionalized stiffness of each leg (γ) and the geometry of the tripod defined by the ratio L/r<sub>m</sub>. (<bold>A</bold>) The curve divides the γ-L/r<sub>m</sub> plane into two regions with either fly-like or cockroach-like kinematics. The data points show the values from fits to the fly data. The alphabets represent approximate L/r<sub>m</sub> ratio for a few insects as noted below. Most insects have an L/r<sub>m</sub> ratio near the minimum of the curve, making it more likely that they can achieve an inverted fly-like kinematic profile. (<bold>B</bold>) Plot of leg spring constant as a function of L/r<sub>m</sub> ratio. Many insects have L/r<sub>m</sub> ratio such that changes in L/r<sub>m</sub> ratio can affect γ<sub>s</sub>. Cockroaches have L/r<sub>m</sub> ratio where changes in geometry would have little effect on the spring constant.</p><p><italic>a=Formica polyctena; b=Formica pratensis; c=Carausius morosus; d=Aretaon asperrimus; e=Medauroidea extradentata; f=Periplaneta americana; g=Blaberus discoidalis.</italic></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65878-fig8-v2.tif"/></fig><p>Another important insight from this analysis comes from the dependence of γ<sub>s</sub> on <inline-formula><mml:math id="inf78"> <mml:mi/><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). At the <inline-formula><mml:math id="inf79"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratios observed in flies and other insects such as ants and stick insects, small changes in <inline-formula><mml:math id="inf80"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> will produce a corresponding change in γ<sub>s</sub> (<xref ref-type="fig" rid="fig8">Figure 8B</xref>). On the other hand, at large <inline-formula><mml:math id="inf81"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio, such as those employed by a cockroach, the γ<sub>s</sub> is constant and does not depend on the <inline-formula><mml:math id="inf82"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio. This difference makes sense. At the large <italic>Fr</italic> numbers employed by cockroaches, the CoM kinematics is dominated by the angular speed with which the body moves about its leg (<xref ref-type="bibr" rid="bib2">Antoniak et al., 2019</xref>), and it is rather insensitive to the magnitude of γ<sub>s</sub>. On the other hand, and as demonstrated for flies in this study, at lower speeds the mechanics is dominated by the spring constants γ<sub>a</sub> and γ<sub>s.</sub></p><p>In sum, the strong dependence of mechanics on the <inline-formula><mml:math id="inf83"><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> ratio or tripod geometry can explain both why tripod gait can be employed across a range of speeds observed among different insects and that a given insect can control its speed in part by changing the geometry of its tripod.</p></sec><sec id="s3-4"><title>ARSLIP as a general model for multilegged locomotion</title><p>The finding that the SLIP model employed in mammalian locomotion is also adequate as a model for cockroach running led to the idea that SLIP is a general model for locomotion regardless of how many legs are on the ground. However, it has been well known before the recent studies in flies that CoM kinematics for other insects are dramatically different from cockroach (<xref ref-type="bibr" rid="bib26">Graham, 1985</xref>; <xref ref-type="bibr" rid="bib40">Reinhardt and Blickhan, 2014</xref>), and cannot be explained by the SLIP model. To our knowledge, there have not been many attempts at arriving at a single model that can serve as a conceptual model that explains the diverse kinematics observed across the insect world.</p><p>The development of a general model will be aided by two important insights in this study: first, we show that the geometry of the tripod plays an important role in determining the mechanics of the CoM. It appears that cockroaches do walk with a particularly wide and low tripod where the mechanics are closest to being described by the SLIP model. But the wide and low tripod observed for cockroaches appear to be an exception rather than a rule. The tripod geometries of other insects are different, and as shown in <xref ref-type="fig" rid="fig8">Figure 8</xref>, at least some of the kinematic variations observed in insects result from these differing tripod geometries.</p><p>Second, the effect of the different tripod geometries can be captured through a simple extension of the SLIP model – the ARSLIP model. The ARSLIP model is simple enough that it retains much of the elegant simplicity that makes SLIP such a powerful model while being better equipped to capture the greater diversity of kinematics observed in insects.</p><p>Future experiments aimed at exploiting the natural diversity of the insect world to rigorously test the relationship between the geometry of the stance legs and CoM kinematics, and the ability of ARSLIP to describe this relationship will prove to be a powerful toolkit for developing a general model for hexapedal locomotion.</p><p>It is obvious but still important to note that the springy tripod presented here is a simplification for the actual dynamics of locomotion in insects. In the case of fly, the springy tripod is a decent model of the fly’s walking as shown by its ability to predict the optimized ARSLIP spring constants from geometry (<xref ref-type="fig" rid="fig7">Figure 7</xref>). However, the ARSLIP model itself is more general and can model other known features of insect legged locomotion that we have not considered here:</p><list list-type="simple"><list-item><p>First, here we have modeled each leg as a linear spring, the angular spring results from a combined action of the three legs. In the most general case, each leg itself can function as both linear and angular spring. The resulting model will still be the ARSLIP model; however, the expressions relating <inline-formula><mml:math id="inf84"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to tripod geometry and stiffness of a given leg will be different from what we have derived here.</p></list-item><list-item><p>Second, and like the first point above, apart from spring forces, insect legs can produce attachment forces (<xref ref-type="bibr" rid="bib24">Gorb et al., 2002</xref>). Once again, attachment forces do not invalidate the utility of ARSLIP as a model, but will affect the values of <inline-formula><mml:math id="inf86"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> and <inline-formula><mml:math id="inf87"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> differentially and represent an important mechanism that can explain the difference in kinematics for different insects.</p></list-item><list-item><p>Third, for many insects, the hind leg is much longer than the other legs. The longer length of the hind legs might make a third term in the Taylor series expansion necessary (the first two terms being the leg spring and the angular spring, respectively). This third term may act as an asymmetric propulsive force.</p></list-item><list-item><p>Finally, ARSLIP does not necessarily need three legs. The ARSLIP model can also model an insect employing more legs on the ground. In fact, one important insight in this study is that whenever there is more than one leg on the ground, SLIP is unlikely to work as a model. This is because SLIP assumes that the net forces on the CoM act along the single effective leg. When there are more than one leg of the ground, this constraint – forces only along the leg – severely limits the ability of a model to describe locomotion. ARSLIP removes this constraint and allows the description of forces perpendicular to the leg. Thus, the ARSLIP model is the more natural take-off point for efforts to obtain a truly general model for locomotion not only in insects but in multilegged animals in general.</p></list-item></list></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Flies</title><p>The flies were reared at 25°C, and 12 hr:12 hr light:dark cycle. Ten minutes before the experiment the flies were removed from a vial and placed under CO<sub>2</sub> anesthesia , and their wings were detached using forceps.</p><p>We experimented with different wild-type strains to record steps at a range of walking speeds and to ensure that any general principle we discover is indeed general (at least across a range of inbred strains). These wild-type strains were <italic>w1118</italic>, <italic>Berlin K</italic>, and <italic>Oregon-R-C</italic> (or Oregon C) (Bloomington stock numbers: 5905, 8522, and 5, respectively). <xref ref-type="table" rid="table2">Table 2</xref> shows all of the flies in our dataset and the data each fly contributed to the analyses in each figure.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Number of data points in the plots.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom"/><th valign="bottom"/><th colspan="7" valign="bottom">Figures</th></tr><tr><th valign="bottom"/><th valign="bottom"/><th colspan="2" valign="bottom"><xref ref-type="fig" rid="fig2">Figure 2D</xref></th><th valign="bottom"><xref ref-type="fig" rid="fig3">Figure 3A</xref></th><th valign="bottom"><xref ref-type="fig" rid="fig3">Figure 3B,E</xref></th><th valign="bottom"><xref ref-type="fig" rid="fig4">Figure 4C–F</xref></th><th valign="bottom"><xref ref-type="fig" rid="fig6">Figure 6C</xref></th><th valign="bottom"><xref ref-type="fig" rid="fig6">Figures 6D</xref>, <xref ref-type="fig" rid="fig7">7C,D</xref></th></tr></thead><tbody><tr><td style="author-callout-style-b1" valign="bottom">Fly</td><td style="author-callout-style-b1" valign="bottom">Genotype</td><td style="author-callout-style-b1" valign="bottom">Stance</td><td style="author-callout-style-b1" valign="bottom">Swing</td><td style="author-callout-style-b1" valign="bottom"/><td style="author-callout-style-b1" valign="bottom"/><td style="author-callout-style-b1" valign="bottom"/><td style="author-callout-style-b1" valign="bottom"/><td style="author-callout-style-b1" valign="bottom"/></tr><tr><td valign="bottom">1</td><td valign="bottom">Berlin K</td><td valign="bottom">8</td><td valign="bottom">9</td><td valign="bottom">1</td><td valign="bottom">0</td><td valign="bottom">2</td><td valign="bottom">2</td><td valign="bottom">0</td></tr><tr><td valign="bottom">2</td><td valign="bottom">Berlin K</td><td valign="bottom">4</td><td valign="bottom">9</td><td valign="bottom">0</td><td valign="bottom">0</td><td valign="bottom">0</td><td valign="bottom">0</td><td valign="bottom">0</td></tr><tr><td valign="bottom">3</td><td valign="bottom">Berlin K</td><td valign="bottom">152</td><td valign="bottom">194</td><td valign="bottom">20</td><td valign="bottom">15</td><td valign="bottom">42</td><td valign="bottom">14</td><td valign="bottom">6</td></tr><tr><td valign="bottom">4</td><td valign="bottom">Berlin K</td><td valign="bottom">284</td><td valign="bottom">330</td><td valign="bottom">40</td><td valign="bottom">46</td><td valign="bottom">82</td><td valign="bottom">78</td><td valign="bottom">78</td></tr><tr><td valign="bottom">5</td><td valign="bottom">Berlin K</td><td valign="bottom">72</td><td valign="bottom">90</td><td valign="bottom">10</td><td valign="bottom">12</td><td valign="bottom">21</td><td valign="bottom">18</td><td valign="bottom">18</td></tr><tr><td valign="bottom">6</td><td valign="bottom">Berlin K</td><td valign="bottom">108</td><td valign="bottom">114</td><td valign="bottom">16</td><td valign="bottom">17</td><td valign="bottom">31</td><td valign="bottom">28</td><td valign="bottom">28</td></tr><tr><td valign="bottom">7</td><td valign="bottom">Berlin K</td><td valign="bottom">367</td><td valign="bottom">458</td><td valign="bottom">43</td><td valign="bottom">53</td><td valign="bottom">97</td><td valign="bottom">74</td><td valign="bottom">74</td></tr><tr><td valign="bottom">8</td><td valign="bottom">Berlin K</td><td valign="bottom">388</td><td valign="bottom">454</td><td valign="bottom">47</td><td valign="bottom">59</td><td valign="bottom">102</td><td valign="bottom">44</td><td valign="bottom">44</td></tr><tr><td valign="bottom">9</td><td valign="bottom">Berlin K</td><td valign="bottom">50</td><td valign="bottom">63</td><td valign="bottom">5</td><td valign="bottom">7</td><td valign="bottom">9</td><td valign="bottom">0</td><td valign="bottom">0</td></tr><tr><td valign="bottom">10</td><td valign="bottom">W1118</td><td valign="bottom">1496</td><td valign="bottom">1564</td><td valign="bottom">202</td><td valign="bottom">227</td><td valign="bottom">390</td><td valign="bottom">90</td><td valign="bottom">90</td></tr><tr><td valign="bottom">11</td><td valign="bottom">Oregon RC</td><td valign="bottom">45</td><td valign="bottom">53</td><td valign="bottom">5</td><td valign="bottom">6</td><td valign="bottom">5</td><td valign="bottom">0</td><td valign="bottom">0</td></tr><tr><td valign="bottom">12</td><td valign="bottom">Tac 3</td><td valign="bottom">265</td><td valign="bottom">325</td><td valign="bottom">32</td><td valign="bottom">42</td><td valign="bottom">63</td><td valign="bottom">5</td><td valign="bottom">0</td></tr><tr><td valign="bottom">13</td><td valign="bottom">Berlin K</td><td valign="bottom">165</td><td valign="bottom">209</td><td valign="bottom">17</td><td valign="bottom">26</td><td valign="bottom">38</td><td valign="bottom">9</td><td valign="bottom">9</td></tr><tr><td valign="bottom">14</td><td valign="bottom">Berlin K</td><td valign="bottom">53</td><td valign="bottom">63</td><td valign="bottom">5</td><td valign="bottom">9</td><td valign="bottom">14</td><td valign="bottom">4</td><td valign="bottom">0</td></tr><tr><td valign="bottom"/><td valign="bottom">Total</td><td valign="bottom">3457</td><td valign="bottom">3935</td><td valign="bottom">443</td><td valign="bottom">519</td><td valign="bottom">896</td><td valign="bottom">366</td><td valign="bottom">347</td></tr></tbody></table><table-wrap-foot><fn><p>Data used for <xref ref-type="fig" rid="fig2">Figure 2D</xref> were stance and swing durations for each of the six legs. Data used for <xref ref-type="fig" rid="fig3">Figure 3A,B and E</xref> were derived from all complete gait cycles that include at least one frame of the last leg’s stance phase. Data for <xref ref-type="fig" rid="fig3">Figure 3A</xref> had an additional constraint that required a cycle data to have complete observation of the last leg’s stance phase from start to end. Data used for <xref ref-type="fig" rid="fig4">Figure 4</xref> were derived from all tripod stance phase. Data used for <xref ref-type="fig" rid="fig6">Figure 6</xref> and <xref ref-type="fig" rid="fig7">7</xref> were derived from tripod stance phases in which the single support phase constitutes at least 25% of stance. However, additional constraints were added to <xref ref-type="fig" rid="fig6">Figure 6D</xref> and <xref ref-type="fig" rid="fig7">7</xref>: data with erroneous leg position tracks were eliminated, and then flies with less than six steps were eliminated.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4-2"><title>Data acquisition and processing</title><p>Our experimental data consisted of the CoM position of the fly in all three dimensions and the position of the fly’s footholds in the horizontal plane. This section describes the acquisition and processing procedures that yield this dataset.</p><sec id="s4-2-1"><title>Recording chamber</title><p>The chamber side walls and ceiling (inner <inline-formula><mml:math id="inf88"><mml:mi>L</mml:mi> <mml:mi/><mml:mo>×</mml:mo><mml:mi>W</mml:mi><mml:mo>×</mml:mo><mml:mi>H</mml:mi></mml:math></inline-formula>: 21 × 7 × 17 mm) were built from microscope slides and held together using an instant adhesive (Loctite 495). A hole was drilled in one of the side walls 10 mm from the floor to provide an air jet nozzle for the initiation of walking. A 0.13–0.17-mm-thick coverslip was used as the chamber floor to minimize the distance between the side view and bottom view, and therefore the frame size; the frame size was kept to a minimum to increase the frame rate. After a fly was placed inside the chamber, the chamber was secured on the coverslip using a tape. The chamber–coverslip assembly was then held horizontally using clamps. Below the assembly a mirror was tilted at 45° to the coverslip. The mirror reflected the bottom view of the chamber to the camera (see <xref ref-type="fig" rid="fig2">Figure 2</xref> for schematic). The bottom and the side of the chamber were lit with infrared light.</p></sec><sec id="s4-2-2"><title>Data acquisition</title><p>Data acquisition and processing were fully automated, except for manual screening of raw videos before the processing step. A USB 3.0 camera Basler acA1920-150 um (380 Hz at 1024 × 779) and a telecentric lens (Edmund Optics, Barrington, NJ 0.40x SilverTL, part number 56–677) were used to record the video at 380 fps at 1024 × 779 resolution. Exposure was set at 2.5 ms. This setup had a modulation transfer function of 10% in the vertical direction and 6% in the horizontal direction at 25.39 line pairs/mm. The camera monitored the chamber at 30 Hz in real time until any motion within the field of view triggered acquisition at 380 Hz for 1.2 s. The motion was detected by measuring the change in intensity between the total pixel intensity values of the two most recent frames. After each acquisition, the recorded video was saved to disk if and only if the fly walked more than 5 mm across the floor. This automated procedure could monitor and record a single fly for more than 10 hr.</p></sec><sec id="s4-2-3"><title>Tracking CoM and foothold positions</title><p>The fly’s CoM was estimated by using the most prominent features of the fly as fiducial markers. The features were extracted on the first frame by using the minimum eigenvalue algorithm and following the extracted points throughout the video using KLT (KLT feature tracker in MATLAB [<xref ref-type="bibr" rid="bib31">Lucas and Kanade, 1981</xref>; <xref ref-type="bibr" rid="bib43">Shi and Tomasi, 1993</xref>; <xref ref-type="bibr" rid="bib50">Tomasi and Kanade, 1991</xref>]). An estimated affine transformation matrix between the sets of feature points of consecutive frames was multiplied to the CoM position in the previous frame to evaluate the CoM position in the current frame (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Next, between every pair of consecutive frames, CoM was backtracked one step. The distance between original and backtracked CoMs is a reliable measurement of the so-called forward–backward tracking error (<xref ref-type="bibr" rid="bib29">Kalal et al., 2010</xref>). The error was small enough that we could evaluate the SLIP and ARSLIP models. The errors were also much smaller than the change in CoM position during a step (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Therefore, the noise of the estimated CoM trajectories was small, so numerical derivations of the trajectories returned velocity trends with a small noise (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>).</p><p>Foothold location was automatically detected using a series of image processing algorithms detailed in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>. The basic idea was to binarize the bottom view and thin the resulting image to yield a skeleton. The end points of the resulting skeleton returned points, including the actual footholds, along with other noisy or random points. The actual footholds were robustly detected by filtering out the noisy points and extracting points that are located the furthest away from the CoM. The noise filtering was performed by removing small objects composed of fewer than 100 pixels. The legs were labeled based on the mean of each foothold trajectory in the CoM frame (see details in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>All the processing steps are shown in <xref ref-type="video" rid="video2">Video 2</xref>.</p><media id="video2" mime-subtype="mp4" mimetype="video" xlink:href="elife-65878-video2.mp4"><label>Video 2.</label><caption><title>The output of each processing step is plotted.</title></caption></media></sec></sec><sec id="s4-3"><title>Gait analysis</title><p>We performed gait analysis using either the stance start times or the instantaneous phase.</p><sec id="s4-3-1"><title>Gait analysis based on stance start times</title><p>For quantifying gait based on stance start times, the time at which the R1 leg starts its stance denoted the beginning of the cycle. The cycle lasted until the R1 leg entered the next stance. The time between R1 entering two consecutive stances was the cycle period. The time delay between R1 and other legs was calculated by taking the time difference between the stance times of the other legs, allowing for the fact that some of the legs would start their stance before the R1 leg. To normalize the time delays, these delays were divided by the cycle period.</p></sec><sec id="s4-3-2"><title>Gait analysis based on leg phases</title><p>The position of legs, <inline-formula><mml:math id="inf89"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, was measured in a body coordinate system, and the positive <italic>y</italic>-axis points toward the anterior part of the body. Because we only knew leg position during stance, we performed a linear interpolation of <inline-formula><mml:math id="inf90"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> during swing. The instantaneous phase angles of the legs were obtained by applying Hilbert transform on <inline-formula><mml:math id="inf91"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> (<xref ref-type="fig" rid="fig3">Figure 3</xref>; <xref ref-type="bibr" rid="bib12">Couzin-Fuchs et al., 2015</xref>; <xref ref-type="bibr" rid="bib41">Revzen and Guckenheimer, 2008</xref>; <xref ref-type="bibr" rid="bib54">Wilshin et al., 2017</xref>). Hilbert transform turns a real-valued signal into a complex-valued analytic signal, which provides accurate instantaneous magnitude and frequency of the real-valued signal (<xref ref-type="bibr" rid="bib7">Boashash, 1992</xref>; <xref ref-type="bibr" rid="bib33">Marple, 1999</xref>; <xref ref-type="bibr" rid="bib44">Smith, 2007</xref>). The time-dependent angle of complex-valued analytical signal is the instantaneous phase angle. The phases were between [–π, +π] (see <xref ref-type="fig" rid="fig3">Figure 3D</xref> for definition). For the phase delay analyses (<xref ref-type="fig" rid="fig3">Figure 3D–F</xref>), the phase delay was normalized to [−0.5, 0.5] by dividing the instantaneous delays by 2π. This normalized phase delay for each leg relative to R1 was averaged over the entire stance phase of the R1 leg (touch-down to lift-off).</p></sec><sec id="s4-3-3"><title>Definition of M-tripod</title><p>Median values of delays between mesothoracic and contralateral metathoracic legs <inline-formula><mml:math id="inf92"><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and delays between prothoracic and contralateral mesothoracic legs <inline-formula><mml:math id="inf93"><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are used to determine delays within tripod legs of a synthetic M-tripod.</p></sec></sec><sec id="s4-4"><title>The calculation for change in height and velocity</title><p>A time series of height or speed over a tripod stance was detrended by a line that connected the values at the beginning and end of the stance phase. Finally, the maximum and minimum values of the detrended data were summed to calculate height or speed changes (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p></sec><sec id="s4-5"><title>Nondimensional parameters</title><p>We chose to nondimensionalize a unit of mass by an animal’s body mass (<inline-formula><mml:math id="inf94"><mml:mi>m</mml:mi></mml:math></inline-formula>), length by an animal’s natural leg length (<inline-formula><mml:math id="inf95"><mml:mi>R</mml:mi></mml:math></inline-formula>), and acceleration by gravitational acceleration at the surface of the earth (<inline-formula><mml:math id="inf96"><mml:mi>g</mml:mi></mml:math></inline-formula>). Following this rule, we could nondimensionalize speed and spring constants as shown below:<disp-formula id="equ6"><mml:math id="m6"><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ7"><mml:math id="m7"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ8"><mml:math id="m8"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s4-6"><title>System of ordinary differential equations for SLIP and ARSLIP and details regarding fitting ordinary differential equations to individual steps</title><p>The following system of ordinary differential equations (ODEs) (<xref ref-type="disp-formula" rid="equ9 equ10">Equations 6 and 7)</xref> is derived using Euler–Lagrange equations to describe ARSLIP. A polar coordinate system was chosen for simplicity.<disp-formula id="equ9"><label>(6)</label><mml:math id="m9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:msup><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ10"><label>(7)</label><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>g</mml:mi><mml:mi>r</mml:mi></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf97"><mml:mi>r</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the length of the single effective leg used in SLIP and ARSLIP models, <inline-formula><mml:math id="inf98"><mml:mi>θ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the leg angle from the vertical axis, <inline-formula><mml:math id="inf99"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the leg spring constant, <inline-formula><mml:math id="inf100"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an angular spring constant, <inline-formula><mml:math id="inf101"><mml:mi>m</mml:mi></mml:math></inline-formula> is the total mass of a fly, and <inline-formula><mml:math id="inf102"><mml:mi>R</mml:mi></mml:math></inline-formula> is the natural leg length. Dot denotes time derivative. A detailed derivation of the ODE is presented in the supplementary section of <xref ref-type="bibr" rid="bib2">Antoniak et al., 2019</xref>.</p><p>The best fit of ARSLIP to a given experimental trajectory was found using the Global Search algorithm (<xref ref-type="bibr" rid="bib18">Dixon, 1978</xref>) (MATLAB Global Optimization Toolbox). The RMSEs for height and distance were individually evaluated, and the sum was used as the objective function.</p><p><inline-formula><mml:math id="inf103"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf104"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were searched within the range below (<xref ref-type="disp-formula" rid="equ11 equ12">Equations 8 and 9</xref>):<disp-formula id="equ11"><label>(8)</label><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>50</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mi>N</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ12"><label>(9)</label><mml:math id="m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>50</mml:mn><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mo>⋅</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These bounds were chosen empirically. <inline-formula><mml:math id="inf105"><mml:mi>R</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf106"><mml:mi>m</mml:mi></mml:math></inline-formula> were experimentally measured for the various strains (<xref ref-type="table" rid="table3">Table 3</xref>). The length of the middle leg was measured from the still frames of the fly. Multiple measurements of a fly were averaged (<inline-formula><mml:math id="inf107"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and then based on the average value optimal <inline-formula><mml:math id="inf108"><mml:mi>R</mml:mi></mml:math></inline-formula> was estimated by searching within ±10% boundary of <inline-formula><mml:math id="inf109"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Mass (m) was measured by averaging the mass of 10 individuals from the same genotype and gender.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Measured parameter values for each species and gender.</title></caption><table frame="hsides" rules="groups"><thead><tr><th valign="bottom">Fly number</th><th valign="bottom">Gender</th><th valign="bottom">Strain</th><th valign="bottom"><inline-formula><mml:math id="inf110"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (mm)</th><th valign="bottom">Mass (mg)</th></tr></thead><tbody><tr><td valign="bottom">1</td><td valign="bottom">Female</td><td valign="bottom">Berlin K</td><td valign="bottom">2.1032</td><td rowspan="5">1.0809</td></tr><tr><td valign="bottom">2</td><td valign="bottom">Female</td><td valign="bottom">Berlin K</td><td valign="bottom">2.184</td></tr><tr><td valign="bottom">3</td><td valign="bottom">Female</td><td valign="bottom">Berlin K</td><td valign="bottom">2.1031</td></tr><tr><td valign="bottom">4</td><td valign="bottom">Female</td><td valign="bottom">Berlin K</td><td valign="bottom">1.9988</td></tr><tr><td valign="bottom">5</td><td valign="bottom">Female</td><td valign="bottom">Berlin K</td><td valign="bottom">1.9869</td></tr><tr><td valign="bottom">6</td><td valign="bottom">Male</td><td valign="bottom">Berlin K</td><td valign="bottom">1.8888</td><td rowspan="4">0.6798</td></tr><tr><td valign="bottom">7</td><td valign="bottom">Male</td><td valign="bottom">Berlin K</td><td valign="bottom">1.9272</td></tr><tr><td valign="bottom">8</td><td valign="bottom">Male</td><td valign="bottom">Berlin K</td><td valign="bottom">2.0646</td></tr><tr><td valign="bottom">9</td><td valign="bottom">Male</td><td valign="bottom">Berlin K</td><td valign="bottom">2.0404</td></tr><tr><td valign="bottom">10</td><td valign="bottom">Female</td><td valign="bottom">W1118</td><td valign="bottom">2.042</td><td>1.123</td></tr></tbody></table></table-wrap><p>Because a model with two effective legs would have too many parameters and would obscure many of the clear insights gained from modeling, we chose steps for which the duration of support by a single tripod was at least 25% of the tripod stance. This criterion does not mean that 75% of the step is spent with both tripods on the ground. Because the tripod legs are not synchronized, much of the time spent with both tripods on the substrate is the time it takes for legs from the second tripod to leave the ground. The experimentally measured initial conditions of <inline-formula><mml:math id="inf111"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:math></inline-formula> were used to constrain the optimal initial condition. The optimal initial condition was constrained to be within ±10% of the measurements. Because we set the foothold location of ARSLIP as the middle of the front and hind leg foothold positions, initial conditions of <inline-formula><mml:math id="inf113"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf114"><mml:mi>r</mml:mi></mml:math></inline-formula> could be determined from experimental data.</p><p>The SLIP model was fitted using a similar method under the same parameter conditions except for the absence of <inline-formula><mml:math id="inf115"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> due to the lack of angular spring in SLIP. The system of ODEs for SLIP is given by<disp-formula id="equ13"><label>(10)</label><mml:math id="m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:msup><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>g</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ14"><label>(11)</label><mml:math id="m14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo>¨</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>θ</mml:mi><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>r</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mi>g</mml:mi><mml:mi>r</mml:mi></mml:mfrac><mml:mi>sin</mml:mi><mml:mo>⁡</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>For both models, the gravitational constant <inline-formula><mml:math id="inf116"><mml:mi>g</mml:mi></mml:math></inline-formula> had a value of <inline-formula><mml:math id="inf117"><mml:mn>9.807</mml:mn><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>.</p></sec><sec id="s4-7"><title>Derivation of the formula relating tripod model to ARSLIP</title><p>The total elastic potential energy of a springy tripod (<xref ref-type="fig" rid="fig5">Figure 5</xref>) is given by<disp-formula id="equ15"><label>(12)</label><mml:math id="m15"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></disp-formula></p><p>The variables are also enumerated in <xref ref-type="table" rid="table1">Table 1</xref> and shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. In this equation, <inline-formula><mml:math id="inf118"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the natural length of the springy tripod that is optimized for each fly; <inline-formula><mml:math id="inf119"><mml:mi>r</mml:mi> <mml:mi/></mml:math></inline-formula> is the height of the middle leg; <inline-formula><mml:math id="inf120"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the angle that it makes with the vertical axis, which is identified with the radial and angular coordinate of ARSLIP; <italic>L</italic> is the measured spread of the tripod (<xref ref-type="fig" rid="fig7">Figure 7A</xref>); and <italic>k</italic> is the stiffness of a given leg. The total elastic potential energy is simply a sum of the potential energies due to each individual leg. We claim that <inline-formula><mml:math id="inf121"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mi/></mml:math></inline-formula> is equivalent to the ARSLIP potential energy, <italic>V</italic> (<xref ref-type="disp-formula" rid="equ15">Equation 12</xref>), for evolution that is close to the midpoint <inline-formula><mml:math id="inf122"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and <inline-formula><mml:math id="inf123"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>.<disp-formula id="equ16"><label>(13)</label><mml:math id="m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Because <inline-formula><mml:math id="inf124"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mo>∆</mml:mo><mml:mi>r</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>~</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mfenced close="|" open="|" separators="|"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>~</mml:mo><mml:mn>0.2</mml:mn></mml:math></inline-formula>, it should be sufficient to show that the two potential energies agree with each other up to the quadratic order in fluctuations around the fixed point. This means that the first and second derivatives with respect to <inline-formula><mml:math id="inf126"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf127"><mml:mi>θ</mml:mi></mml:math></inline-formula> at <inline-formula><mml:math id="inf128"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf129"><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> are the same for both the potential energies. Specifically,<disp-formula id="equ17"><label>(14)</label><mml:math id="m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ18"><label>(15)</label><mml:math id="m18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ19"><label>(16)</label><mml:math id="m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ20"><label>(17)</label><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msup><mml:mi>θ</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula><disp-formula id="equ21"><label>(18)</label><mml:math id="m21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>θ</mml:mi><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>are the same for both the potential energies. The relations involving the first derivative of <inline-formula><mml:math id="inf130"><mml:mi>θ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ18">Equation 15</xref>) and cross-double derivative involving both <inline-formula><mml:math id="inf131"><mml:mi>θ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:mi>r</mml:mi></mml:math></inline-formula> are automatically satisfied because of symmetry (<xref ref-type="disp-formula" rid="equ21">Equation 18</xref>), the latter demonstrating the independence of the radial and angular springy forces that are assumed in the ARSLIP model.</p><p>We are then left with three equations, including the first derivative of <inline-formula><mml:math id="inf133"><mml:mi>r</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ17">Equation 14</xref>), and the two double derivatives w.r.t. <inline-formula><mml:math id="inf134"><mml:mi>r</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf135"><mml:mi>θ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ19 equ20">Equations 16 and 17</xref>). The effective ARSLIP potential energy involves the parameters <inline-formula><mml:math id="inf136"><mml:mi>R</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf137"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf138"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Consequently, it is possible to relate ARSLIP and springy tripod using the following equations:<disp-formula id="equ22"><label>(19)</label><mml:math id="m22"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>R</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></disp-formula><disp-formula id="equ23"><label>(20)</label><mml:math id="m23"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></disp-formula><disp-formula id="equ24"><label>(21)</label><mml:math id="m24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Thus, the parameters, <inline-formula><mml:math id="inf139"> <mml:mi/><mml:mi>R</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf140"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf141"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be determined from the tripod potential energy parameters, <inline-formula><mml:math id="inf142"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf143"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi> <mml:mi/></mml:mrow></mml:msub></mml:math></inline-formula>, and the geometric quantities <inline-formula><mml:math id="inf144"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf145"> <mml:mi/><mml:mi>L</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ22 equ23 equ24">Equations 19–21</xref>). We obtained <inline-formula><mml:math id="inf146"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf147"><mml:mi>L</mml:mi></mml:math></inline-formula> from the geometric data for each step. We assumed that a given fly has the same <inline-formula><mml:math id="inf148"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf149"><mml:mi>k</mml:mi><mml:mo>,</mml:mo></mml:math></inline-formula> and fit <inline-formula><mml:math id="inf150"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf151"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for all the steps of the given fly. This assumption led to a best fit value of <inline-formula><mml:math id="inf152"><mml:mi>k</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf153"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We would like to acknowledge the members of Bhandawat lab and Sanjay Sane and his lab, and Michael Dickinson for critical comments on earlier versions of the manuscript. This research was supported by NIDCD (VB), NINDS (VB), and an NSF CAREER award (VB).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Validation, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Resources, Data curation, Supervision, Funding acquisition, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>Data are available on Dryad under doi:10.5061/dryad.m63xsj41g and Github <ext-link ext-link-type="uri" xlink:href="https://github.com/vbhandawat/FlyTripod_eLife_2021/">https://github.com/vbhandawat/FlyTripod_eLife_2021/</ext-link> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:rev:1dc429fc0da4cc5ff4f62617760447613f85980b/">https://archive.softwareheritage.org/swh:1:rev:1dc429fc0da4cc5ff4f62617760447613f85980b/</ext-link>.</p><p>The following datasets were generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Chun</surname><given-names>C</given-names></name><name><surname>Biswas</surname><given-names>T</given-names></name><name><surname>Bhandawat</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Data from: Drosophila uses a tripod gait across all walking speeds, and the geometry of the tripod is important for speed control</data-title><source>Dryad Digital Repository</source><pub-id assigning-authority="Dryad" pub-id-type="doi">10.5061/dryad.m63xsj41g</pub-id></element-citation></p><p><element-citation id="dataset2" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Chun</surname><given-names>C</given-names></name><name><surname>Biswas</surname><given-names>T</given-names></name><name><surname>Bhandawat</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>FlyTripod_eLife_2021</data-title><source>Github</source><pub-id assigning-authority="other" pub-id-type="accession" xlink:href="https://github.com/vbhandawat/FlyTripod_eLife_2021/">FlyTripod_eLife_2021</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname> <given-names>RM</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Optimization and gaits in the locomotion of vertebrates</article-title><source>Physiological Reviews</source><volume>69</volume><fpage>1199</fpage><lpage>1227</lpage><pub-id pub-id-type="doi">10.1152/physrev.1989.69.4.1199</pub-id><pub-id pub-id-type="pmid">2678167</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antoniak</surname> <given-names>G</given-names></name><name><surname>Biswas</surname> <given-names>T</given-names></name><name><surname>Cortes</surname> <given-names>N</given-names></name><name><surname>Sikdar</surname> <given-names>S</given-names></name><name><surname>Chun</surname> <given-names>C</given-names></name><name><surname>Bhandawat</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spring-loaded inverted pendulum goes through two contraction-extension cycles during the single-support phase of walking</article-title><source>Biology Open</source><volume>8</volume><elocation-id>bio043695</elocation-id><pub-id pub-id-type="doi">10.1242/bio.043695</pub-id><pub-id pub-id-type="pmid">31097445</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bender</surname> <given-names>JA</given-names></name><name><surname>Simpson</surname> <given-names>EM</given-names></name><name><surname>Tietz</surname> <given-names>BR</given-names></name><name><surname>Daltorio</surname> <given-names>KA</given-names></name><name><surname>Quinn</surname> <given-names>RD</given-names></name><name><surname>Ritzmann</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Kinematic and behavioral evidence for a distinction between trotting and ambling gaits in the cockroach Blaberus discoidalis</article-title><source>Journal of Experimental Biology</source><volume>214</volume><fpage>2057</fpage><lpage>2064</lpage><pub-id pub-id-type="doi">10.1242/jeb.056481</pub-id><pub-id pub-id-type="pmid">21613522</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biswas</surname> <given-names>T</given-names></name><name><surname>Rao</surname> <given-names>S</given-names></name><name><surname>Bhandawat</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A simple extension of inverted pendulum template to explain features of slow walking</article-title><source>Journal of Theoretical Biology</source><volume>457</volume><fpage>112</fpage><lpage>123</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2018.08.027</pub-id><pub-id pub-id-type="pmid">30138629</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blickhan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>The spring-mass model for running and hopping</article-title><source>Journal of Biomechanics</source><volume>22</volume><fpage>1217</fpage><lpage>1227</lpage><pub-id pub-id-type="doi">10.1016/0021-9290(89)90224-8</pub-id><pub-id pub-id-type="pmid">2625422</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blickhan</surname> <given-names>R</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Similarity in multilegged locomotion: bouncing like a monopode</article-title><source>Journal of Comparative Physiology A</source><volume>173</volume><fpage>509</fpage><lpage>517</lpage><pub-id pub-id-type="doi">10.1007/BF00197760</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boashash</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Estimating and interpreting the instantaneous frequency of a signal. II. Algorithms and applications</article-title><source>Proceedings of the IEEE</source><volume>80</volume><fpage>540</fpage><lpage>568</lpage><pub-id pub-id-type="doi">10.1109/5.135378</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burns</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1973">1973</year><article-title>The control of walking in Orthoptera: I. Leg movements in normal walking</article-title><source>The Journal of Experimental Biology</source><volume>58</volume><fpage>45</fpage><lpage>58</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Büschges</surname> <given-names>A</given-names></name><name><surname>Akay</surname> <given-names>T</given-names></name><name><surname>Gabriel</surname> <given-names>JP</given-names></name><name><surname>Schmidt</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Organizing network action for locomotion: insights from studying insect walking</article-title><source>Brain Research Reviews</source><volume>57</volume><fpage>162</fpage><lpage>171</lpage><pub-id pub-id-type="doi">10.1016/j.brainresrev.2007.06.028</pub-id><pub-id pub-id-type="pmid">17888515</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cavagna</surname> <given-names>GA</given-names></name><name><surname>Heglund</surname> <given-names>NC</given-names></name><name><surname>Taylor</surname> <given-names>CR</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Mechanical work in terrestrial locomotion: two basic mechanisms for minimizing energy expenditure</article-title><source>American Journal of Physiology-Regulatory, Integrative and Comparative Physiology</source><volume>233</volume><fpage>R243</fpage><lpage>R261</lpage><pub-id pub-id-type="doi">10.1152/ajpregu.1977.233.5.R243</pub-id><pub-id pub-id-type="pmid">411381</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiel</surname> <given-names>HJ</given-names></name><name><surname>Beer</surname> <given-names>RD</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>The brain has a body: adaptive behavior emerges from interactions of nervous system, body and environment</article-title><source>Trends in Neurosciences</source><volume>20</volume><fpage>553</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1016/S0166-2236(97)01149-1</pub-id><pub-id pub-id-type="pmid">9416664</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Couzin-Fuchs</surname> <given-names>E</given-names></name><name><surname>Kiemel</surname> <given-names>T</given-names></name><name><surname>Gal</surname> <given-names>O</given-names></name><name><surname>Ayali</surname> <given-names>A</given-names></name><name><surname>Holmes</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Intersegmental coupling and recovery from perturbations in freely running cockroaches</article-title><source>Journal of Experimental Biology</source><volume>218</volume><fpage>285</fpage><lpage>297</lpage><pub-id pub-id-type="doi">10.1242/jeb.112805</pub-id><pub-id pub-id-type="pmid">25609786</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>What mechanisms coordinate leg movement in walking arthropods?</article-title><source>Trends in Neurosciences</source><volume>13</volume><fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(90)90057-H</pub-id><pub-id pub-id-type="pmid">1688670</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DeAngelis</surname> <given-names>BD</given-names></name><name><surname>Zavatone-Veth</surname> <given-names>JA</given-names></name><name><surname>Clark</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The manifold structure of limb coordination in walking <italic>Drosophila</italic></article-title><source>eLife</source><volume>8</volume><elocation-id>e46409</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.46409</pub-id><pub-id pub-id-type="pmid">31250807</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delcomyn</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1971">1971</year><article-title>The locomotion of the cockroach Periplaneta americana</article-title><source>The Journal of Experimental Biology</source><volume>54</volume><fpage>443</fpage><lpage>452</lpage></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Delcomyn</surname> <given-names>F</given-names></name></person-group><year iso-8601-date="1985">1985</year><source>Walking and running</source><publisher-loc>London</publisher-loc><publisher-name>Pergamon Press</publisher-name></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dickinson</surname> <given-names>MH</given-names></name><name><surname>Farley</surname> <given-names>CT</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Koehl</surname> <given-names>MA</given-names></name><name><surname>Kram</surname> <given-names>R</given-names></name><name><surname>Lehman</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>How animals move: an integrative view</article-title><source>Science</source><volume>288</volume><fpage>100</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1126/science.288.5463.100</pub-id><pub-id pub-id-type="pmid">10753108</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dixon</surname> <given-names>LCW</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>The global optimization problem</article-title><source>An Introduction. Toward Global Optimization</source><volume>2</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1002/zamm.19790590220</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dürr</surname> <given-names>V</given-names></name><name><surname>Schmitz</surname> <given-names>J</given-names></name><name><surname>Cruse</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Behaviour-based modelling of hexapod locomotion: linking biology and technical application</article-title><source>Arthropod Structure &amp; Development</source><volume>33</volume><fpage>237</fpage><lpage>250</lpage><pub-id pub-id-type="doi">10.1016/j.asd.2004.05.004</pub-id><pub-id pub-id-type="pmid">18089037</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Koditschek</surname> <given-names>DE</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Templates and anchors: neuromechanical hypotheses of legged locomotion on land</article-title><source>The Journal of Experimental Biology</source><volume>202</volume><fpage>3325</fpage><lpage>3332</lpage><pub-id pub-id-type="pmid">10562515</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Tu</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Mechanics of six-legged runners</article-title><source>The Journal of Experimental Biology</source><volume>148</volume><fpage>129</fpage><lpage>146</lpage><pub-id pub-id-type="pmid">2307925</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Full</surname> <given-names>RJ</given-names></name><name><surname>Tu</surname> <given-names>MS</given-names></name></person-group><year iso-8601-date="1991">1991</year><article-title>Mechanics of a rapid running insect: two-, four- and six-legged locomotion</article-title><source>The Journal of Experimental Biology</source><volume>156</volume><fpage>215</fpage><lpage>231</lpage><pub-id pub-id-type="pmid">2051129</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geyer</surname> <given-names>H</given-names></name><name><surname>Seyfarth</surname> <given-names>A</given-names></name><name><surname>Blickhan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Compliant leg behaviour explains basic dynamics of walking and running</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>273</volume><fpage>2861</fpage><lpage>2867</lpage><pub-id pub-id-type="doi">10.1098/rspb.2006.3637</pub-id><pub-id pub-id-type="pmid">17015312</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorb</surname> <given-names>SN</given-names></name><name><surname>Beutel</surname> <given-names>RG</given-names></name><name><surname>Gorb</surname> <given-names>EV</given-names></name><name><surname>Jiao</surname> <given-names>Y</given-names></name><name><surname>Kastner</surname> <given-names>V</given-names></name><name><surname>Niederegger</surname> <given-names>S</given-names></name><name><surname>Popov</surname> <given-names>VL</given-names></name><name><surname>Scherge</surname> <given-names>M</given-names></name><name><surname>Schwarz</surname> <given-names>U</given-names></name><name><surname>Vötsch</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Structural design and biomechanics of friction-based releasable attachment devices in insects</article-title><source>Integrative and Comparative Biology</source><volume>42</volume><fpage>1127</fpage><lpage>1139</lpage><pub-id pub-id-type="doi">10.1093/icb/42.6.1127</pub-id><pub-id pub-id-type="pmid">21680397</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1972">1972</year><article-title>A behavioural analysis of the temporal organisation of walking movements in the 1st instar and adult stick insect (Carausius morosus)</article-title><source>Journal of Comparative Physiology</source><volume>81</volume><fpage>23</fpage><lpage>52</lpage><pub-id pub-id-type="doi">10.1007/BF00693548</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graham</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>Pattern and control of walking in insects</article-title><source>Advances in Insect Physiology</source><volume>18</volume><fpage>31</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1016/S0065-2806(08)60039-9</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hughes</surname> <given-names>GM</given-names></name></person-group><year iso-8601-date="1952">1952</year><article-title>The co-ordination of insect movements: i. The walking movements of insects</article-title><source>The Journal of Experimental Biology</source><volume>29</volume><fpage>267</fpage><lpage>285</lpage></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Isakov</surname> <given-names>A</given-names></name><name><surname>Buchanan</surname> <given-names>SM</given-names></name><name><surname>Sullivan</surname> <given-names>B</given-names></name><name><surname>Ramachandran</surname> <given-names>A</given-names></name><name><surname>Chapman</surname> <given-names>JK</given-names></name><name><surname>Lu</surname> <given-names>ES</given-names></name><name><surname>Mahadevan</surname> <given-names>L</given-names></name><name><surname>de Bivort</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Recovery of locomotion after injury in <italic>Drosophila melanogaster</italic> depends on proprioception</article-title><source>The Journal of Experimental Biology</source><volume>219</volume><fpage>1760</fpage><lpage>1771</lpage><pub-id pub-id-type="doi">10.1242/jeb.133652</pub-id><pub-id pub-id-type="pmid">26994176</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Kalal</surname> <given-names>Z</given-names></name><name><surname>Mikolajczyk</surname> <given-names>K</given-names></name><name><surname>Matas</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Forward-backward error: automatic detection of tracking failures</article-title><conf-name>Paper Presented At: Pattern Recognition (ICPR), 2010 20th International Conference On</conf-name></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname> <given-names>S</given-names></name><name><surname>Park</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Leg stiffness increases with speed to modulate gait frequency and propulsion energy</article-title><source>Journal of Biomechanics</source><volume>44</volume><fpage>1253</fpage><lpage>1258</lpage><pub-id pub-id-type="doi">10.1016/j.jbiomech.2011.02.072</pub-id><pub-id pub-id-type="pmid">21396646</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Lucas</surname> <given-names>BD</given-names></name><name><surname>Kanade</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1981">1981</year><source>An Iterative Image Registration Technique with an Application to Stereo Vision</source><ext-link ext-link-type="uri" xlink:href="https://ri.cmu.edu/pub_files/pub3/lucas_bruce_d_1981_2/lucas_bruce_d_1981_2.pdf">https://ri.cmu.edu/pub_files/pub3/lucas_bruce_d_1981_2/lucas_bruce_d_1981_2.pdf</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maimon</surname> <given-names>G</given-names></name><name><surname>Straw</surname> <given-names>AD</given-names></name><name><surname>Dickinson</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Active flight increases the gain of visual motion processing in <italic>Drosophila</italic></article-title><source>Nature Neuroscience</source><volume>13</volume><fpage>393</fpage><lpage>399</lpage><pub-id pub-id-type="doi">10.1038/nn.2492</pub-id><pub-id pub-id-type="pmid">20154683</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marple</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Computing the discrete-time &quot;analytic&quot; signal via FFT</article-title><source>IEEE Transactions on Signal Processing</source><volume>47</volume><fpage>2600</fpage><lpage>2603</lpage><pub-id pub-id-type="doi">10.1109/78.782222</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>McMahon</surname> <given-names>TA</given-names></name></person-group><year iso-8601-date="1984">1984</year><source>Muscles, Reflexes, and Locomotion</source><publisher-loc>Princeton, NJ</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMahon</surname> <given-names>TA</given-names></name><name><surname>Cheng</surname> <given-names>GC</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>The mechanics of running: how does stiffness couple with speed?</article-title><source>Journal of Biomechanics</source><volume>23 Suppl 1</volume><fpage>65</fpage><lpage>78</lpage><pub-id pub-id-type="doi">10.1016/0021-9290(90)90042-2</pub-id><pub-id pub-id-type="pmid">2081746</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendes</surname> <given-names>CS</given-names></name><name><surname>Bartos</surname> <given-names>I</given-names></name><name><surname>Akay</surname> <given-names>T</given-names></name><name><surname>Márka</surname> <given-names>S</given-names></name><name><surname>Mann</surname> <given-names>RS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Quantification of gait parameters in freely walking wild type and sensory deprived <italic>Drosophila melanogaster</italic></article-title><source>eLife</source><volume>2</volume><elocation-id>e00231</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00231</pub-id><pub-id pub-id-type="pmid">23326642</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nye</surname> <given-names>SW</given-names></name><name><surname>Ritzmann</surname> <given-names>RE</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Motion analysis of leg joints associated with escape turns of the cockroach, Periplaneta americana</article-title><source>Journal of Comparative Physiology A</source><volume>171</volume><fpage>183</fpage><lpage>194</lpage><pub-id pub-id-type="doi">10.1007/BF00188926</pub-id><pub-id pub-id-type="pmid">1432854</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pearson</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>The control of walking</article-title><source>Scientific American</source><volume>235</volume><fpage>72</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1038/scientificamerican1276-72</pub-id><pub-id pub-id-type="pmid">1006306</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinhardt</surname> <given-names>L</given-names></name><name><surname>Weihmann</surname> <given-names>T</given-names></name><name><surname>Blickhan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Dynamics and kinematics of ant locomotion: do wood ants climb on level surfaces?</article-title><source>Journal of Experimental Biology</source><volume>212</volume><fpage>2426</fpage><lpage>2435</lpage><pub-id pub-id-type="doi">10.1242/jeb.026880</pub-id><pub-id pub-id-type="pmid">19617436</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinhardt</surname> <given-names>L</given-names></name><name><surname>Blickhan</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Level locomotion in wood ants: evidence for grounded running</article-title><source>Journal of Experimental Biology</source><volume>217</volume><fpage>2358</fpage><lpage>2370</lpage><pub-id pub-id-type="doi">10.1242/jeb.098426</pub-id><pub-id pub-id-type="pmid">24744414</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Revzen</surname> <given-names>S</given-names></name><name><surname>Guckenheimer</surname> <given-names>JM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Estimating the phase of synchronized oscillators</article-title><source>Physical Review E</source><volume>78</volume><elocation-id>051907</elocation-id><pub-id pub-id-type="doi">10.1103/PhysRevE.78.051907</pub-id><pub-id pub-id-type="pmid">19113155</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seelig</surname> <given-names>JD</given-names></name><name><surname>Chiappe</surname> <given-names>ME</given-names></name><name><surname>Lott</surname> <given-names>GK</given-names></name><name><surname>Reiser</surname> <given-names>MB</given-names></name><name><surname>Jayaraman</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Calcium imaging in <italic>Drosophila</italic> during walking and flight behavior</article-title><source>Biophysical Journal</source><volume>100</volume><elocation-id>97a</elocation-id><pub-id pub-id-type="doi">10.1016/j.bpj.2010.12.735</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Shi</surname> <given-names>J</given-names></name><name><surname>Tomasi</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1993">1993</year><source>Good Features to Track</source><publisher-loc>Ithaca, NY</publisher-loc><publisher-name>Cornell University</publisher-name></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>JO</given-names></name></person-group><year iso-8601-date="2007">2007</year><edition>Second edition</edition><source>Mathematics of the Discrete Fourier Transform (DFT) with audio applications</source><publisher-name>W3K Publishing</publisher-name></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Spirito</surname> <given-names>CP</given-names></name><name><surname>Mushrush</surname> <given-names>DL</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Interlimb coordination during slow walking in the cockroach: I. Effects of substrate alterations</article-title><source>The Journal of Experimental Biology</source><volume>78</volume><fpage>233</fpage><lpage>243</lpage></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Strauss</surname> <given-names>R</given-names></name><name><surname>Heisenberg</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Coordination of legs during straight walking and turning in <italic>Drosophila melanogaster</italic></article-title><source>Journal of Comparative Physiology A</source><volume>167</volume><fpage>403</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1007/BF00192575</pub-id><pub-id pub-id-type="pmid">2121965</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Szczecinski</surname> <given-names>NS</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name><name><surname>Chockley</surname> <given-names>AS</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Static stability predicts the continuum of interleg coordination patterns in <italic>Drosophila</italic></article-title><source>The Journal of Experimental Biology</source><volume>221</volume><elocation-id>jeb189142</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.189142</pub-id><pub-id pub-id-type="pmid">30274987</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Theunissen</surname> <given-names>LM</given-names></name><name><surname>Bekemeier</surname> <given-names>HH</given-names></name><name><surname>Durr</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Comparative whole-body kinematics of closely related insect species with different body morphology</article-title><source>Journal of Experimental Biology</source><volume>218</volume><fpage>340</fpage><lpage>352</lpage><pub-id pub-id-type="doi">10.1242/jeb.114173</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ting</surname> <given-names>LH</given-names></name><name><surname>Blickhan</surname> <given-names>R</given-names></name><name><surname>Full</surname> <given-names>RJ</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Dynamic and static stability in hexapedal runners</article-title><source>The Journal of Experimental Biology</source><volume>197</volume><fpage>251</fpage><lpage>269</lpage><pub-id pub-id-type="pmid">7852905</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tomasi</surname> <given-names>C</given-names></name><name><surname>Kanade</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1991">1991</year><source>Detection and Tracking of Point Features</source><publisher-name>International Journal of Computer Vision</publisher-name></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venken</surname> <given-names>KJ</given-names></name><name><surname>Simpson</surname> <given-names>JH</given-names></name><name><surname>Bellen</surname> <given-names>HJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Genetic manipulation of genes and cells in the nervous system of the fruit fly</article-title><source>Neuron</source><volume>72</volume><fpage>202</fpage><lpage>230</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2011.09.021</pub-id><pub-id pub-id-type="pmid">22017985</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wahl</surname> <given-names>V</given-names></name><name><surname>Pfeffer</surname> <given-names>SE</given-names></name><name><surname>Wittlinger</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Walking and running in the desert ant Cataglyphis fortis</article-title><source>Journal of Comparative Physiology A</source><volume>201</volume><fpage>645</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1007/s00359-015-0999-2</pub-id><pub-id pub-id-type="pmid">25829304</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Wendler</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>The co-ordination of walking movements in arthropods</article-title><conf-name>Symposia of the Society for Experimental Biology</conf-name><fpage>229</fpage><lpage>249</lpage></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilshin</surname> <given-names>S</given-names></name><name><surname>Reeve</surname> <given-names>MA</given-names></name><name><surname>Haynes</surname> <given-names>GC</given-names></name><name><surname>Revzen</surname> <given-names>S</given-names></name><name><surname>Koditschek</surname> <given-names>DE</given-names></name><name><surname>Spence</surname> <given-names>AJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Longitudinal quasi-static stability predicts changes in dog gait on rough terrain</article-title><source>The Journal of Experimental Biology</source><volume>220</volume><fpage>1864</fpage><lpage>1874</lpage><pub-id pub-id-type="doi">10.1242/jeb.149112</pub-id><pub-id pub-id-type="pmid">28264903</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DM</given-names></name></person-group><year iso-8601-date="1966">1966</year><article-title>Insect walking</article-title><source>Annual Review of Entomology</source><volume>11</volume><fpage>103</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1146/annurev.en.11.010166.000535</pub-id><pub-id pub-id-type="pmid">5321575</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>RI</given-names></name><name><surname>Turner</surname> <given-names>GC</given-names></name><name><surname>Laurent</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Transformation of olfactory representations in the <italic>Drosophila</italic> antennal lobe</article-title><source>Science</source><volume>303</volume><fpage>366</fpage><lpage>370</lpage><pub-id pub-id-type="doi">10.1126/science.1090782</pub-id><pub-id pub-id-type="pmid">14684826</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wosnitza</surname> <given-names>A</given-names></name><name><surname>Bockemühl</surname> <given-names>T</given-names></name><name><surname>Dübbert</surname> <given-names>M</given-names></name><name><surname>Scholz</surname> <given-names>H</given-names></name><name><surname>Büschges</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Inter-leg coordination in the control of walking speed in <italic>Drosophila</italic></article-title><source>Journal of Experimental Biology</source><volume>216</volume><fpage>480</fpage><lpage>491</lpage><pub-id pub-id-type="doi">10.1242/jeb.078139</pub-id><pub-id pub-id-type="pmid">23038731</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zollikofer</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Stepping patterns in ants. 1. influence of speed and curvature</article-title><source>The Journal of Experimental Biology</source><volume>192</volume><fpage>95</fpage><lpage>106</lpage><pub-id pub-id-type="pmid">9317406</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix</title><sec id="s7" sec-type="appendix"><title>What determines whether the gait will be fly-like or cockroach-like?</title><boxed-text><p>Whether the gait will be fly-like or cockroach-like is determined by the relative strengths of the radial and angular springs, which in turn depend on the tripod geometry and stiffness of the leg. In this Appendix, we will derive an expression that predicts fly-like versus cockroach-like gait based on the leg stiffness and tripod geometry.</p><p>From the ARSLIP model, we arrive at the following condition for negative horizontal acceleration at the midpoint, a characteristic of mid-stance velocity maxima:<disp-formula id="equ25"><mml:math id="m25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf155"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the mid-stance height, and <inline-formula><mml:math id="inf156"> <mml:mi/><mml:mi>R</mml:mi></mml:math></inline-formula> is the natural length of the effective SLIP spring. This equation is derived from a consideration of forces at mid-stance. This is derived in the Antoniak et al. manuscript.</p><p>Assuming the empirical observation that while walking the mid-stance height of the fruit flies is very close to the leg lengths that balance gravity, we have<disp-formula id="equ26"><label>(A2)</label><mml:math id="m26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Equation A2 simply means that the forces due to radial spring are close to the weight of the fly. <xref ref-type="disp-formula" rid="equ26">Equation A2</xref>, in turn, implies that for the fly-like mid-stance maximum velocity profiles we must have<disp-formula id="equ27"><label>(A3)</label><mml:math id="m27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo stretchy="false">⇒</mml:mo><mml:mrow><mml:mtext> </mml:mtext></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To understand what this implies in terms of tripod leg characteristics and geometry, we need to rewrite the above inequality in terms of tripod quantities. Substituting <italic>k<sub>a</sub></italic> from <xref ref-type="disp-formula" rid="equ23">Equation 20,</xref> we have<disp-formula id="equ28"><label>(A4)</label><mml:math id="m28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mi>m</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">⇒</mml:mo><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi><mml:mo>&gt;</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>η</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></disp-formula>where <inline-formula><mml:math id="inf157"><mml:mi>η</mml:mi><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mi>γ</mml:mi><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p><p>Thus, the above inequality (<xref ref-type="disp-formula" rid="equ28">Equation A4</xref>) provides a dividing curve in the <inline-formula><mml:math id="inf159"><mml:mi>η</mml:mi><mml:mo>-</mml:mo><mml:mi>γ</mml:mi></mml:math></inline-formula> plane between velocity maxima (like flies) versus velocity minima (like cockroaches).</p><p>It is also illuminating to see how geometry shapes the angular and radial spring constants. From <xref ref-type="disp-formula" rid="equ26">Equations A2</xref> and <xref ref-type="disp-formula" rid="equ24">21</xref>, we have<disp-formula id="equ29"><label>(A5)</label><mml:math id="m29"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula>after some algebraic manipulations. From <xref ref-type="disp-formula" rid="equ23">Equation 20,</xref> we then have<disp-formula id="equ30"><label>(A6)</label><mml:math id="m30"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>γ</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mfenced close="]" open="[" separators="|"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></disp-formula></p><p>Therefore, <inline-formula><mml:math id="inf160"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> depends on <inline-formula><mml:math id="inf161"> <mml:mi/><mml:mi>η</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf162"><mml:mi>γ</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf163"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, and <inline-formula><mml:math id="inf164"><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mo>≡</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p></boxed-text></sec></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65878.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Berman</surname><given-names>Gordon J</given-names></name><role>Reviewer</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Understanding the biomechanics of movement across species - especially legged locomotion - has proven to be a challenging endeavor. This manuscript shows how relatively simple modifications to a classic model in the field can lead to an understanding of legged locomotion in fruit flies, whose center-of-mass dynamics during movement were previously unexplained, allowing for a re-evaluation of cross-species locomotion studies. In all, this is a carefully done study that will be of interest to researchers studying legged locomotion, and motor control more broadly.</p><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting your work entitled &quot;<italic>Drosophila</italic> walks with a tripod gait, and the geometry of the tripod is important for the control of walking speed&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Gordon Berman as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Senior Editor.</p><p>Our decision has been reached after consultation between the reviewers. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>Although the reviewers felt that there was a great deal of merit in the ideas presented (particularly, using the ARSLIP model to understand the within-gait velocity profile), there was a general agreement that the manuscript was somewhat disjointed between the two halves - the gait distance metric and the ARSLIP model - and that the paper would be better suited for a more specialized journal, and perhaps even split into two different papers. Moreover, there were some systematic critiques of the gait distance metric implementation (in particular, see reviewer 2 and 3's comments), and the paper definitely needed to be put in the context of DeAngelis et al., 2019, which came to some similar conclusions with a different methodology.</p><p><italic>Reviewer #1:</italic></p><p>In this work, the authors use data from an automated tracking system to assess gait dynamics in <italic>Drosophila</italic>. In the first part of the paper, they claim that all of the locomotion dynamics can be explained via a modified tripod gait (introducing a Gait Distance metric), and in the second part, they introduce a new model, ARSLIP, for explaining the inverted speed profile seen in <italic>Drosophila</italic> locomotion (compared to cockroaches, for example).</p><p>In general, I thought that the second portion of the manuscript was model compelling than the first.</p><p>1) Specifically, the first part seems to cover similar intellectual terrain as DeAngelis et al., 2019, and so the authors need to place this work in the context of that paper's findings.</p><p>2) For the Gait Distance metric, I find it somewhat problematic that any noise will necessarily increase the value, but this is likely a minor concern.</p><p>3) In Figure 3C, although it is clear that any two pairs of speeds show no difference in L1-R3, it looks like there might be a trend going from low to high speeds. What does a linear regression show?</p><p>4) In Figure 3–S2, just because the real-time delays increase with cycle period doesn't by itself keep the phase delay constant – the delay should fall along a line with the same slope for all curves, no? If you do a best-fit slope to all four plots simultaneously (allowing for varying intercepts), what value do you get?</p><p>5) In general, I thought that the portion of the manuscript that explained the ARSLIP model was much stronger and clearer. A key scientific discrepancy was identified, and a plausible model was presented.</p><p>6) In Figure 6C, since it's predicted vs. actual, should the comparison not be to a linear fit, but instead to the line y = x?</p><p><italic>Reviewer #2:</italic></p><p>This manuscript from Chun and colleagues focuses on two key claims based on limb and body tracking in walking <italic>Drosophila</italic>. First, they analyze limb coordination patterns and propose that their data that supports a single, continuously modulated tripod gait being used over many walking speeds. Second, they propose a new biomechanical model for walking, which adds an angular restoring force to a widely used inverted spring model for walking. This new model explains a key aspect of their center of mass tracking data, in which forward velocity peaks as height also peaks, which cannot be explained by previous models.</p><p>I had a few concerns about this work. The first is related to the Materials and methods, where the authors describe their distance metric. My reading is that this branch cut choice means that phase a difference of +0.45 cycles and one of +0.55 cycles (goes to -0.45) would look further apart than +.45 and 0 cycles (distance = 0.9 vs. 0.45). This is a pretty worrisome property of this analysis metric, and I would think that it could cause serious issues. I understand that this was chosen for computing distances expected to be 0 for tripod, but wouldn't it create some large, unintended errors in some plausible non-tripod cases? Much of the paper is based on this distance metric, so it's critical that it have properties that don't lead to interpretation errors. I don't even see why one needs a branch cut – isn't it possible to use a trigonometric function to compute distances to eliminate this issue? For instance, cos(\δ \phi) goes from 1 to -1, depending on how far out of phase limbs are, but has no branch cut issues.</p><p>Secondly, I'm not sure that the claims in the first portion of the paper need to be so strong in order to support the second half of the paper. For instance, and the authors say as much, wouldn't a putative tetrapod gait support much the same model? I just don't know what to say about example traces, like those in Mendes et al. Figure 4B, which look pretty different from tripod, over time, for many steps. It seems clearly not tripod. Perhaps it's not typical, but it seems different from just sloppy, since the phase differences among limbs are retained over many steps. It does not appear to me to be tripod with longer stances, as this paper would seem to argue.</p><p>Last, some of the ground in the first portion of this paper has been covered by a study on similar topics that was unreferenced here (DeAngelis et al., 2019). Like this study, that paper looked at gaits using phase relationships rather than swing/stance counts and found (from my reading) some similar results. However, the 2019 paper had a quite different explanation than &quot;always tripod&quot;. How do these results fit together? The 2019 paper suggests a model for generating gaits that can produce tripod-like, wave-like, and tetrapod-like patterns, but is not just a sloppy tripod at slow walking speeds. How does that claim relate to the claims made here?</p><p>This paper also did not reference Szczecinski et al., 2018, which showed how a continuum of walking coordination patterns in <italic>Drosophila</italic> might benefit stability. Given that the second portion of this manuscript is biomechanical and the restoring force is related to stability, it would be important to mention this and discuss how these results relate to those ones.</p><p><italic>Reviewer #3:</italic></p><p>In this work, the authors introduce a metric based on phase deviation from a set of “template” gaits to robustly classify the walking gaits. Many classical, as well as more recent, works in the literature have employed gait diagrams, which indicate the number of legs in contact with the ground, as the metric to characterise and classify locomotor behaviors. It has been a timely contribution to point out that these metrics fall short in robustly classifying gaits and being sensitive to dynamical variations in leg coordination patterns. However, I have concerns regarding the authors' incomplete assessment of the literature.</p><p>1) One crucial reference is the recent e<italic>Life</italic> paper by DeAngelis et al. (2019) which presents a rather exhaustive analysis of <italic>Drosophila</italic> walking. Importantly, DeAngelis et al. classify gait based on the distance of leg phases from a “template phase”, as quantified by a modified Kuramoto coherence index, see Equation 5 in their Materials and methods. This is very similar to the proposed “gait distance”, the only difference being that Equation 5 in DeAngelis et al. quantifies phase distance on the unit sphere, whereas the “gait distance” uses the Euclidean distance. Thus, the authors should demonstrate how the metric of DeAngelis performs in comparison to the “gait distance” on the same dataset. This would either justify or call into question the utility of the “gait distance” metric rather than the metric used by DeAngelis et al.</p><p>2) Another critique is that it seems in the “gait distance” one should a priori know the phases of which legs are to be compared against which legs of the template. This could make the metric difficult to apply in an unbiased way and may introduce a variation in the results as well as change the sensitivity of the metric when the phases of additional (perhaps all) leg pairs are compared simultaneously. The second claim of the authors' is that the only coordinated walking pattern that <italic>Drosophila</italic> adopts at a wide range of walking speeds is consistent with the tripod gait and slight phase-perturbations thereof. This raises another concern. Although DeAngelis et al. also concludes the abundance of the tripod gait (based on their independent dataset), their metric also detects other canonical gaits as the speed is varied. Such sensitivity is a desirable feature of any useful metric. Thus, the fact that the “gait distance” does not detect other gaits can also be explained by its lack of sensitivity in addition to those gaits not being present in the data. For it to be a useful metric, the authors should demonstrate that “gait distance” generalizes to other gaits and detect gait transitions.</p><p>3) In my view, the main contribution of the paper is the parsimonious kinetic model ARSLIP to describe the tripod gait. A large part of the <italic>Drosophila</italic> literature assumes that (not just) walking behaviors follow feedforward, central pattern generator driven dynamics, giving little importance to mechanical inputs. That the motion of the CoM can be described by a purely reaction-based, lossless spring model is a useful advance. However, I would like to see the authors perform a more careful analysis of the ARSLIP model and consider its predictions. For example, the model hinges the fact that the dynamics of the springy tripod (Figure 7) can be reduced to an effective angular-radial spring pair. However, the springy tripod can have multiple dynamical modes of vibration, including lateral and longitudinal components, and moreover, due to its lateral asymmetry these modes can have strong lateral components. It is unclear to me whether the authors study these steady state vibration modes and how they are consistent with the CoM motion during stable locomotor patterns, or just consider the motion of the suspended mass in the initial transient phase. Thus, the authors should consider predictions in the X and Y planes (not just Z). This assumption could be justified through simple simulations. Second, the ARSLIP model is only valid at small perturbations from the stable state. However, the authors say that CoM motion during locomotion yields a 50% compression of the spring, which is no longer in the regime of validity. Third, although the authors claim that this simplified model describes fly locomotion, they only demonstrate it on the motion of the CoM. One prediction the authors could make is taking the model fitted to the CoM motion and using it to predict resulting changes in leg coxa-to-pretarsus distance, which could be verified from their experimental data. Fourth, it would be useful to describe how the model could be generalized to generate multiple gaits.</p><p>4) Finally, the paper could be improved dramatically by carefully defining model parameters where they are used and describing the model fitting procedure with more clarity. This would ensure reproducibility for future studies by the community.</p><p>[Editors’ note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for submitting your work entitled &quot;<italic>Drosophila</italic> walks with a tripod gait across all speeds, and the geometry of the tripod is important for speed control&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Gordon J Berman as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Senior Editor.</p><p>Our decision has been reached after consultation between the reviewers. Based on these discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic>.</p><p>While the reviewers all thought there was strength in the second half of the paper involving the ARSLIP model, they also all agreed that the first portion of the paper involving the gait distance metric was better suited for a more specialized journal. In particular, the detailed technical analyses and arguments around gait definition appear not reader-oriented and a bit defensive, more an argument made with a crowd of experts rather than to a general scientific readership.</p><p>We suggest that the authors submit a new paper containing a very brief section on kinematic analysis (just showing that the tripod leg coordination is largely conserved and helping to motivate and set up the potential generality of the ARSLIP model), and an expanded modeling analysis that includes additional comparisons to the previous literature to better show the potential generality of the model. A paper of this nature would make a significant contribution and could potentially be accepted at <italic>eLife</italic>.</p><p><italic>Reviewer #1:</italic></p><p>I think that this submission improves many aspects over the previous iteration, although I would have like to have seen the focus much more on the AR-SLIP model, which, in my opinion, is the key contribution of this article. Accordingly, I will focus my comments on the Introduction and the Gait Distance portion of the article, which I still believe needs some re-framing.</p><p>1) The Introduction is far too long and it is difficult to isolate the key findings/context of the paper. I have now read versions of this manuscript several times, and I still had difficultly parsing through all of the text. While I think that many of the aspects here would make parts of an excellent review article, I encourage the authors to consider shortening the Introduction by a factor of two or more.</p><p>2) Although I think that the authors are correct in their critique of trying to use the DeAngelis gait metric for tetrapod and metachronal gaits, I think that it's somewhat missing the point. The point of DeAngelis et al. is not that all gaits are tripod, but that there is a continuous manifold underlying gait coordination in forward walking. The authors arrive at a similar conclusion here, but through different means. To be clear, given that the two articles were initially submitted around the same time, I don't consider this a &quot;primacy&quot; issue, but I think that it would be far more effective and useful to the community to discuss the result in this light.</p><p>3) More broadly, I think that the argument about tripod/tetrapod/metachronal definitions to be a bit too specific for an <italic>eLife</italic> audience. I recognize that this is the language that has been used in past articles (including <italic>eLife</italic> articles), but these are just words, and the authors correctly point out here that the words can alter their meaning depending on their precise mathematical definition. Instead of focusing on this field-focused argument (which would be more suited for a more biomechanics-focused journal), I ask the authors to focus more on the geometry of the space of movements, rather than on the nomenclature.</p><p>4) A more technical question I had is that I was not sure why only four phase differences are used in the gait distance measure. Why not use all 21 potential comparisons?</p><p>5) In Figure 6F (caption), do you mean that b = -0.55? Also, when fitting a power law, this should always be done on a log-log plot, and given that there is only one order of magnitude in each direction, it is very difficult to distinguish between even an exponential and a power law with these data (let alone measure an exponent). Also, why is there no constant term (y = ax<sup>b</sup> +c)? It is not clear to me that the stance time necessarily needs to go to zero at very fast speeds.</p><p>6) Similarly, in Figures 6C-D, is there any evidence that a quadratic/power law fit is more suitable than a linear fit? Some type of model selection criterion should be used.</p><p><italic>Reviewer #2:</italic></p><p>We would like to thank the authors for making an effort to improve their manuscript. The content is now better motivated, and the contribution is sharpened. Although we appreciate the increased quality of the writing as well as the better coherence between the first and second sections, the readability could be substantially improved by condensing the writing and eliminating repetition. In particular, the Introduction is very long, and should be focused.</p><p>We still feel that the main contribution of the paper is in the second section describing the ARSLIP model. Parsimonious models are extremely valuable for a qualitative understanding of dynamics. The ARSLIP model is novel and provides useful thought experiments, some of which the authors touch upon in the Discussion.</p><p>The remainder of this review refers to the first section, analyzing gaits.</p><p>Regarding DeAngelis et al. we can corroborate that there is a sign error in their coherence metric; the plus (+) sign should be a minus (-) sign, i.e., the formula should measure phase differences between template and measures phases. So, we agree it would be difficult to make any objective comparison. However, we still have two major concerns.</p><p>First, we noticed that the coherence metric of DeAngelis, with the sign corrected, is exactly the same at the &quot;gait angle&quot; that the authors now propose as their own (i.e., without citation) in the revised manuscript (Equation 10 here vs Equation 5 in DeAngelis). There does not seem to be any basis for introducing this metric, or any reference to its original description-however erroneous. We therefore urge the authors to omit this section altogether.</p><p>Second, we previously raised the concern that &quot;one should a priori know the phases of which legs are to be compared to which legs of the template.&quot; This has not been addressed. For the authors' metric to be useful for a broad range of animals and gaits, one would ideally compare as many leg pairs as possible (or all) since not accounting for phase differences between some relevant leg pairs may fail to distinguish some gaits. But doing so can decrease the sensitivity of their gait distance metric. This is because gait distance (Equation 5) measures the straight-line distance between phases (by Euclidean metric) and not the geodesic (manifold) distance along the natural manifold on the unit sphere (like the DeAngelis metric or the gait angle, Equation 12). Another way to see this is that Taylor expanding Equation 12 leads to Equation 5 – thus the gait distance (5) is a special case for small phase differences of (12), which is when straight-line distance is approximately equal the manifold distance. We therefore expect that increasing the dimensionality (including more leg pairs) would reduce sensitivity of the metric for large phase differences. In their response, the authors presented a comparison between two metrics; the gait distance (5) with specific leg pairs and the gait angle (10) with all leg pairs. But this is not relevant because two different metrics are being compared. We would like to ask the authors to explore the above potential limitation by simply including progressively more leg pairs in the computation of the gait distance – same metric – and focusing on the statistical significance between distinguishing tetrapod and a tripod gaits where large phase differences are to be expected.</p><p><italic>Reviewer #3:</italic></p><p>This study carefully investigated the gait of fruit fly terrestrial locomotion, focusing on how stance and swing patterns of the six legs change as locomotion speed varies. It was found that the animal predominantly uses a tripod gait at all but the lowest speeds. The authors proposed a gait distance metric to quantify the gait. In addition, they developed a novel angular and radial SLIP model (ARSLIP) as a simple template to explain the mechanics of the tripod gait. A surprising insight from the simple model is that flies can simply change the geometry of its leg tripod to achieve control of effective leg stiffness, without having to stiffen up each leg.</p><p>Overall, this is a comprehensive study on the subject and the manuscript is well written. I am most excited about the ARSLIP model, which, with further testing and validation in other species with rigorous experiments and quantitative data, can potentially provide a general model to explain terrestrial locomotion of a diversity of insects. I am supportive that the paper should be further considered for publication in <italic>eLife</italic>, but I do have one major comment that the authors should address or argue against.</p><p>The authors should make it very clear up front what they mean by &quot;gait&quot;. It appears that, when the authors stated that fruit fly uses pretty much the same tripod gait across speeds, they are really just stating that the fruit fly uses basically the same leg coordination to move (which even the authors acknowledged) regardless of what speed they move at and how their legs come in contact with the ground. I think this is true and well supported by their data. However, I am not sure if it is really that important to stress and try to convince everyone that this is THE best/right way to define gait. Frankly, I think the authors should simply state that they found leg &quot;coordination&quot; to be relatively constant, not &quot;gait&quot;, which can be defined/interpreted differently by different people or for different purposes.</p><p>It is well known that there are different ways of defining gait for terrestrial locomotion. For example, a commonplace definition is by the sequence/phase and duty factor that the feet are in contact with the ground. Alternatively, center of mass (CoM) dynamics can be used to define gait instead. With these different ways, what appear as walking (e.g., cockroach using an alternating tripod footfall pattern with a &gt;0.5 duty factor) using the first definition may in fact be classified as SLIP-like running when CoM dynamics are evaluated.</p><p>The authors have carefully compared their definition of gait with that in a few closely-related recent studies. The authors' gait definition is mainly based on kinematics (coordination to be exact) of the legs themselves, whereas the other studies used stance and swing phase patterns (which are footfall patterns on the ground). These are different ways of defining gait from kinematics. While I agree with the technical aspects of the comparisons, as well as some flaws that the authors have identified in the other studies, I am not sure if leg coordination alone is THE best/right way of defining gait.</p><p>As an example, we can again consider the cockroach case above. Using the author's definition, cockroaches also only demonstrates a single tripod &quot;gait&quot; in terms of leg coordination when speed increase from very small to very large. Does this mean that all the work defining cockroach walking at low speeds and running at high speeds using CoM dynamics are wrong in having such definitions?</p><p>In my opinion, the authors have shown convincing evidence that leg coordination (which they refer to as &quot;gait&quot;) does not change significantly as speed increases. The resulting kinematics of stance and swing phases do vary with speed, and other researchers (or the authors hypothetically) may choose to use those instead to define gait. Frankly, I do not think this is the key advancement of the study and am not sure it is worth this much effort to try to convince people of different opinions (although I certainly understand that the authors may be choosing to emphasize this in order to address the reviewers' comments).</p><p>I think the authors should highlight the contribution they are making with the ARSLIP model. Again, as I said above, this can potentially be a general model and a major advancement of the field of terrestrial animal locomotion. I see this model (with further validation and generalization beyond this study) as the equivalent of seminal work on bipedal compliant leg template model, which unifies SLIP running and inverted pendulum walking for bipedal locomotion (Geyer, Seyfarth and Blickhan, 2006). The authors cited this work, but do not seem to appreciate its importance in the area of bipedal locomotion, or how their own work has the potential of being the same. The authors' model provides initial insight why hexapedal animals can use the same set of legs to achieve dynamic locomotion over a wide range of speeds.</p><p>The authors do provide evidence that the velocity profile of CoM dynamics are opposite to SLIP-like, which is another thing that motivates the ARSLIP model. I think this should be also emphasized more to set up the model.</p><p>I think the authors are missing an opportunity not to discuss this more, and their paper will improve substantially by building around this central idea, which the kinematic data and analysis provide compelling evidence for. I think this will significantly increase the impact of the paper beyond the field of animal locomotion. It is these kinds of simple, general biomechanical/dynamic models that have provided the foundation for simple yet robust robots such as RHex, Atlas, BigDog, etc. Personally, I think that this is something that many people will remember the study for, not so much the technical debate on which way of defining &quot;gait&quot; from pure kinematics is better, which are concerns more for the specialists.</p><p>Therefore, I strongly encourage the authors to cut down on the debate of &quot;gait&quot; and highlight the modeling contributions and elaborate (at least speculate) what should be done in future to test and validate it as a general model.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65878.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>In this work, the authors use data from an automated tracking system to assess gait dynamics in <italic>Drosophila</italic>. In the first part of the paper, they claim that all of the locomotion dynamics can be explained via a modified tripod gait (introducing a Gait Distance metric), and in the second part, they introduce a new model, ARSLIP, for explaining the inverted speed profile seen in <italic>Drosophila</italic> locomotion (compared to cockroaches, for example).</p><p>In general, I thought that the second portion of the manuscript was model compelling than the first.</p><p>1) Specifically, the first part seems to cover similar intellectual terrain as DeAngelis et al., 2019, and so the authors need to place this work in the context of that paper's findings.</p></disp-quote><p>As noted earlier, our manuscript has been in the public domain for more than a year, and we think of our work as contemporaneous to the DeAngelis work. Moreover the DeAngelis work has basic issues that make it difficult for us to compare their study to ours.</p><disp-quote content-type="editor-comment"><p>2) For the Gait Distance metric, I find it somewhat problematic that any noise will necessarily increase the value, but this is likely a minor concern.</p></disp-quote><p>We can understand the reviewer’s viewpoint. But we believe the increase is a useful feature because it quantifies how close to the ideal gait, a metric is.</p><disp-quote content-type="editor-comment"><p>3) In Figure 3C, although it is clear that any two pairs of speeds show no difference in L1-R3, it looks like there might be a trend going from low to high speeds. What does a linear regression show?</p></disp-quote><p>Yes. This is an excellent point. We have changed our analysis. Instead of making comparisons between neighboring bins, we are performing linear regression. The linear regression shows a small but significant change in phase.</p><disp-quote content-type="editor-comment"><p>4) In Figure 3–S2, just because the real-time delays increase with cycle period doesn't by itself keep the phase delay constant – the delay should fall along a line with the same slope for all curves, no? If you do a best-fit slope to all four plots simultaneously (allowing for varying intercepts), what value do you get?</p></disp-quote><p>Yes. This is another excellent point. We now show that the time difference between legs changes in a manner consistent with phase changes.</p><disp-quote content-type="editor-comment"><p>5) In general, I thought that the portion of the manuscript that explained the ARSLIP model was much stronger and clearer. A key scientific discrepancy was identified, and a plausible model was presented.</p></disp-quote><p>Thanks! We have worked hard to connect the two parts of the manuscript.</p><disp-quote content-type="editor-comment"><p>6) In Figure 6C, since it's predicted vs. actual, should the comparison not be to a linear fit, but instead to the line y = x?</p></disp-quote><p>We think that the reviewer is referring to Figure 9C. If so, yes, the line is not a fit but the line of unity or x=y.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>This manuscript from Chun and colleagues focuses on two key claims based on limb and body tracking in walking <italic>Drosophila</italic>. First, they analyze limb coordination patterns and propose that their data that supports a single, continuously modulated tripod gait being used over many walking speeds. Second, they propose a new biomechanical model for walking, which adds an angular restoring force to a widely used inverted spring model for walking. This new model explains a key aspect of their center of mass tracking data, in which forward velocity peaks as height also peaks, which cannot be explained by previous models.</p><p>I had a few concerns about this work. The first is related to the Materials and methods, where the authors describe their distance metric. My reading is that this branch cut choice means that phase a difference of +0.45 cycles and one of +0.55 cycles (goes to -0.45) would look further apart than +.45 and 0 cycles (distance = 0.9 vs. 0.45). This is a pretty worrisome property of this analysis metric, and I would think that it could cause serious issues. I understand that this was chosen for computing distances expected to be 0 for tripod, but wouldn't it create some large, unintended errors in some plausible non-tripod cases? Much of the paper is based on this distance metric, so it's critical that it have properties that don't lead to interpretation errors. I don't even see why one needs a branch cut – isn't it possible to use a trigonometric function to compute distances to eliminate this issue? For instance, cos(\δ \phi) goes from 1 to -1, depending on how far out of phase limbs are, but has no branch cut issues.</p></disp-quote><p>The reviewer is correct regarding the problem with the branchpoint. But, the branchpoint issue only relates to gait distance measures using stance start times. There are no such issues with the gait distance metric using phases. In response to the reviewer’s comment, we have now used the gait distance metric using phases as the primary measure of gait.</p><disp-quote content-type="editor-comment"><p>Secondly, I'm not sure that the claims in the first portion of the paper need to be so strong in order to support the second half of the paper. For instance, and the authors say as much, wouldn't a putative tetrapod gait support much the same model? I just don't know what to say about example traces, like those in Mendes et al. Figure 4B, which look pretty different from tripod, over time, for many steps. It seems clearly not tripod. Perhaps it's not typical, but it seems different from just sloppy, since the phase differences among limbs are retained over many steps. It does not appear to me to be tripod with longer stances, as this paper would seem to argue.</p></disp-quote><p>This is an excellent point. The reviewer is correct that we don’t need the gait to be tripod to perform the analysis in the second part of the manuscript. More importantly, the figure that the reviewer refers to convinced us to take another look at our gait analysis. Thank you! We do find examples of tetrapods in our data. Our overall conclusion remains the same – that tripod is the predominant gait, but our gait analysis is more complete with the inclusion of the tripod.</p><disp-quote content-type="editor-comment"><p>This paper also did not reference Szczecinski et al., 2018, which showed how a continuum of walking coordination patterns in <italic>Drosophila</italic> might benefit stability. Given that the second portion of this manuscript is biomechanical and the restoring force is related to stability, it would be important to mention this and discuss how these results relate to those ones.</p></disp-quote><p>We did discuss the Szczecinski study. This discussion has been further clarified. But we cannot go further into the question of stability because it is somewhat tangential to this study. The issue of stability is important to consider in future work.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>In this work, the authors introduce a metric based on phase deviation from a set of “template” gaits to robustly classify the walking gaits. Many classical, as well as more recent, works in the literature have employed gait diagrams, which indicate the number of legs in contact with the ground, as the metric to characterise and classify locomotor behaviors. It has been a timely contribution to point out that these metrics fall short in robustly classifying gaits and being sensitive to dynamical variations in leg coordination patterns. However, I have concerns regarding the authors' incomplete assessment of the literature.</p><p>1) One crucial reference is the recent eLife paper by DeAngelis et al. (2019) which presents a rather exhaustive analysis of <italic>Drosophila</italic> walking. Importantly, DeAngelis et al. classify gait based on the distance of leg phases from a “template phase”, as quantified by a modified Kuramoto coherence index, see Equation 5 in their Materials and methods. This is very similar to the proposed “gait distance”, the only difference being that Equation 5 in DeAngelis et al. quantifies phase distance on the unit sphere, whereas the “gait distance” uses the Euclidean distance. Thus, the authors should demonstrate how the metric of DeAngelis performs in comparison to the “gait distance” on the same dataset. This would either justify or call into question the utility of the “gait distance” metric rather than the metric used by DeAngelis et al.</p></disp-quote><p>Our manuscript has been in the public domain for more than a year and was first submitted to <italic>eLife</italic> in March 2019 – well before the DeAngelis manuscript. Moreover, the two metrics produce the same results. This similarity is further demonstrated in our manuscript.</p><disp-quote content-type="editor-comment"><p>2) Another critique is that it seems in the “gait distance” one should a priori know the phases of which legs are to be compared against which legs of the template. This could make the metric difficult to apply in an unbiased way and may introduce a variation in the results as well as change the sensitivity of the metric when the phases of additional (perhaps all) leg pairs are compared simultaneously. The second claim of the authors' is that the only coordinated walking pattern that <italic>Drosophila</italic> adopts at a wide range of walking speeds is consistent with the tripod gait and slight phase-perturbations thereof. This raises another concern. Although DeAngelis et al. also concludes the abundance of the tripod gait (based on their independent dataset), their metric also detects other canonical gaits as the speed is varied. Such sensitivity is a desirable feature of any useful metric. Thus, the fact that the “gait distance” does not detect other gaits can also be explained by its lack of sensitivity in addition to those gaits not being present in the data. For it to be a useful metric, the authors should demonstrate that “gait distance” generalizes to other gaits and detect gait transitions.</p></disp-quote><p>There are three points here: 1. Choosing legs is a feature, not a bug. It makes sense to choose legs whose phases are expected to change with a given gait transition. Choosing the legs does not predetermine the outcome in any way. In any case, one does not have to choose particular legs when calculating gait distance; all five phase differences can be employed.</p><p>We have also shown that whether we employ gait distance with a subset of legs (Figure 5), or gait angle with all the legs, the result is very similar.</p><p>We have discussed the results in the DeAngelis manuscript vs. our manuscript at length at the beginning of this critique. Briefly, there is no “sensitivity” issue with our gait metric. Our gait metric detects a tetrapod just fine. It is just that 96% of the steps are tripod. We have demonstrated this point in the current version of the manuscript by explicitly investigating steps that are not tripod.</p><disp-quote content-type="editor-comment"><p>3) In my view, the main contribution of the paper is the parsimonious kinetic model ARSLIP to describe the tripod gait. A large part of the <italic>Drosophila</italic> literature assumes that (not just) walking behaviors follow feedforward, central pattern generator driven dynamics, giving little importance to mechanical inputs. That the motion of the CoM can be described by a purely reaction-based, lossless spring model is a useful advance. However, I would like to see the authors perform a more careful analysis of the ARSLIP model and consider its predictions. For example, the model hinges the fact that the dynamics of the springy tripod (Figure 7) can be reduced to an effective angular-radial spring pair. However, the springy tripod can have multiple dynamical modes of vibration, including lateral and longitudinal components, and moreover, due to its lateral asymmetry these modes can have strong lateral components. It is unclear to me whether the authors study these steady state vibration modes and how they are consistent with the CoM motion during stable locomotor patterns, or just consider the motion of the suspended mass in the initial transient phase. Thus, the authors should consider predictions in the X and Y planes (not just Z). This assumption could be justified through simple simulations. Second, the ARSLIP model is only valid at small perturbations from the stable state. However, the authors say that CoM motion during locomotion yields a 50% compression of the spring, which is no longer in the regime of validity. Third, although the authors claim that this simplified model describes fly locomotion, they only demonstrate it on the motion of the CoM. One prediction the authors could make is taking the model fitted to the CoM motion and using it to predict resulting changes in leg coxa-to-pretarsus distance, which could be verified from their experimental data. Fourth, it would be useful to describe how the model could be generalized to generate multiple gaits.</p></disp-quote><p>The reviewer makes several important points here. We agree with some of these points and do not agree with others. One broader point is that a detailed mechanical analysis of every aspect of the model is beyond the scope of this study. We think that this model is a useful one and will continue to inform the links between neuroscience and mechanics and hopefully will inform many other studies. Regarding the specific issues raised:</p><p>1) Various modes of the springy tripod: There might be some utility in this analysis, but they must be data-driven. We have not only shown that ARLSIP is an accurate approximation, but also demonstrated that the shape of the tripod influences the mechanical stiffness of the system. We have also demonstrated (See Section 3.11 of the Materials and methods) that the radial and angular components are independent. The same holds for movement in the horizontal plane. This independence has already been demonstrated in the LLS model employed in the cockroach (J. Schmitt and P. Holmes. Mechanical models for insect locomotion: dynamics and stability in the horizontal plane I. Theory. <italic>Biol Cybern</italic>, 83:501–515, 2000.). This independence is likely to hold even more in flies because the lateral movement is relatively small.</p><p>2) Small perturbation limits: The 50% number comes from how much compression occurs through the weight of the fly. During walking, the ARSLIP radial spring is not compressing to its natural length. Rather it is oscillating a small amount &lt;10% about its fixed point (<italic>R</italic>- mg/k<sub>s</sub>). So, the small perturbation limits very much hold.</p><p>3) Leg to pre-tarsus distance: This is an interesting idea, but for this analysis we will have to track the coxa-body joint, which is impossible to do with our current dataset because that joint is not visible on both camera views. However, we would like to explore this in future work.</p><p>4) Multiple gaits: Yes, we have done so in the last section of the Discussion. This investigation is going to be an important future direction. We will be exploring this idea in the future.</p><disp-quote content-type="editor-comment"><p>4) Finally, the paper could be improved dramatically by carefully defining model parameters where they are used and describing the model fitting procedure with more clarity. This would ensure reproducibility for future studies by the community.</p></disp-quote><p>Thank you for this suggestion. We have included a table with model parameters and beefed up our discussion of the model.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>Reviewer #1:</p><p>I think that this submission improves many aspects over the previous iteration, although I would have like to have seen the focus much more on the AR-SLIP model, which, in my opinion, is the key contribution of this article. Accordingly, I will focus my comments on the Introduction and the Gait Distance portion of the article, which I still believe needs some re-framing.</p></disp-quote><p>We thank the reviewer for his careful reading of the manuscript. We have now focused primarily on the ARSLIP model.</p><disp-quote content-type="editor-comment"><p>1) The Introduction is far too long and it is difficult to isolate the key findings/context of the paper. I have now read versions of this manuscript several times, and I still had difficultly parsing through all of the text. While I think that many of the aspects here would make parts of an excellent review article, I encourage the authors to consider shortening the Introduction by a factor of two or more.</p></disp-quote><p>The Introduction has been reformatted and reduced by a factor of two.</p><disp-quote content-type="editor-comment"><p>2) Although I think that the authors are correct in their critique of trying to use the DeAngelis gait metric for tetrapod and metachronal gaits, I think that it's somewhat missing the point. The point of DeAngelis et al. is not that all gaits are tripod, but that there is a continuous manifold underlying gait coordination in forward walking. The authors arrive at a similar conclusion here, but through different means. To be clear, given that the two articles were initially submitted around the same time, I don't consider this a &quot;primacy&quot; issue, but I think that it would be far more effective and useful to the community to discuss the result in this light.</p></disp-quote><p>All the gait analysis has been deleted in the reformatting of the manuscript.</p><disp-quote content-type="editor-comment"><p>3) More broadly, I think that the argument about tripod/tetrapod/metachronal definitions to be a bit too specific for an eLife audience. I recognize that this is the language that has been used in past articles (including eLife articles), but these are just words, and the authors correctly point out here that the words can alter their meaning depending on their precise mathematical definition. Instead of focusing on this field-focused argument (which would be more suited for a more biomechanics-focused journal), I ask the authors to focus more on the geometry of the space of movements, rather than on the nomenclature.</p></disp-quote><p>All the gait analysis material has been removed. We will keep the reviewer’s critique in mind when publishing a detailed gait analysis in a separate manuscript.</p><disp-quote content-type="editor-comment"><p>4) A more technical question I had is that I was not sure why only four phase differences are used in the gait distance measure. Why not use all 21 potential comparisons?</p></disp-quote><p>All the gait analysis stuff has been removed. We have done this analysis and shown it in one of previous version of the manuscript. Once again, we might revisit this idea in the future.</p><disp-quote content-type="editor-comment"><p>5) In Figure 6F (caption), do you mean that b = -0.55? Also, when fitting a power law, this should always be done on a log-log plot, and given that there is only one order of magnitude in each direction, it is very difficult to distinguish between even an exponential and a power law with these data (let alone measure an exponent). Also, why is there no constant term (y = ax<sup>b</sup> +c)? It is not clear to me that the stance time necessarily needs to go to zero at very fast speeds.</p></disp-quote><p>Thanks for this suggestion. We have indeed fit the data in Figure 6F (Now Figure 4F) using the expression suggested by the reviewer above.</p><disp-quote content-type="editor-comment"><p>6) Similarly, in Figures 6C-D, is there any evidence that a quadratic/power law fit is more suitable than a linear fit? Some type of model selection criterion should be used.</p></disp-quote><p>Thanks for this suggestion. Yes, there is no need for a quadratic fit in Figure 6C (Now Figure 4C), we have replaced this with a linear fit. A power law form is more appropriate for Figure 6D (now Figure 4D), and we have shown that form is warranted.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>We would like to thank the authors for making an effort to improve their manuscript. The content is now better motivated, and the contribution is sharpened. Although we appreciate the increased quality of the writing as well as the better coherence between the first and second sections, the readability could be substantially improved by condensing the writing and eliminating repetition. In particular, the Introduction is very long, and should be focused.</p></disp-quote><p>We thank the reviewer for his careful reading. We have completely reformatted the Introduction making it almost half the number of words as before.</p><disp-quote content-type="editor-comment"><p>We still feel that the main contribution of the paper is in the second section describing the ARSLIP model. Parsimonious models are extremely valuable for a qualitative understanding of dynamics. The ARSLIP model is novel and provides useful thought experiments, some of which the authors touch upon in the Discussion.</p></disp-quote><p>We have taken the reviewer’s advice and limited our description of our work on gait.</p><disp-quote content-type="editor-comment"><p>The remainder of this review refers to the first section, analyzing gaits.</p><p>Regarding DeAngelis et al. we can corroborate that there is a sign error in their coherence metric; the plus (+) sign should be a minus (-) sign, i.e., the formula should measure phase differences between template and measures phases. So, we agree it would be difficult to make any objective comparison. However, we still have two major concerns.</p></disp-quote><p>Thanks for corroborating the sign error.</p><disp-quote content-type="editor-comment"><p>First, we noticed that the coherence metric of DeAngelis, with the sign corrected, is exactly the same at the &quot;gait angle&quot; that the authors now propose as their own (i.e., without citation) in the revised manuscript (Equation 10 here vs Equation 5 in DeAngelis). There does not seem to be any basis for introducing this metric, or any reference to its original description-however erroneous. We therefore urge the authors to omit this section altogether.</p></disp-quote><p>Thanks for this comment. It is useful to us for the future. Dealing with the DeAngelis gait metric was difficult for us. It was not clear whether the sign error was a mistake or whether they were trying something different. Moreover, we did not think that we needed to explain this because distance and angle are obvious choices when comparing high-dimensional vectors. In neural coding, one does analysis both ways just to show robustness of the conclusion. But we will keep the reviewer’s comment in mind when we discuss this issue in the future.</p><disp-quote content-type="editor-comment"><p>Second, we previously raised the concern that &quot;one should a priori know the phases of which legs are to be compared to which legs of the template.&quot; This has not been addressed. For the authors' metric to be useful for a broad range of animals and gaits, one would ideally compare as many leg pairs as possible (or all) since not accounting for phase differences between some relevant leg pairs may fail to distinguish some gaits. But doing so can decrease the sensitivity of their gait distance metric. This is because gait distance (Equation 5) measures the straight-line distance between phases (by Euclidean metric) and not the geodesic (manifold) distance along the natural manifold on the unit sphere (like the DeAngelis metric or the gait angle, Equation 12). Another way to see this is that Taylor expanding Equation 12 leads to Equation 5 – thus the gait distance (5) is a special case for small phase differences of (12), which is when straight-line distance is approximately equal the manifold distance. We therefore expect that increasing the dimensionality (including more leg pairs) would reduce sensitivity of the metric for large phase differences. In their response, the authors presented a comparison between two metrics; the gait distance (5) with specific leg pairs and the gait angle (10) with all leg pairs. But this is not relevant because two different metrics are being compared. We would like to ask the authors to explore the above potential limitation by simply including progressively more leg pairs in the computation of the gait distance – same metric – and focusing on the statistical significance between distinguishing tetrapod and a tripod gaits where large phase differences are to be expected.</p></disp-quote><p>This is an excellent point that we will definitely explore this point in the future.</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This study carefully investigated the gait of fruit fly terrestrial locomotion, focusing on how stance and swing patterns of the six legs change as locomotion speed varies. It was found that the animal predominantly uses a tripod gait at all but the lowest speeds. The authors proposed a gait distance metric to quantify the gait. In addition, they developed a novel angular and radial SLIP model (ARSLIP) as a simple template to explain the mechanics of the tripod gait. A surprising insight from the simple model is that flies can simply change the geometry of its leg tripod to achieve control of effective leg stiffness, without having to stiffen up each leg.</p><p>Overall, this is a comprehensive study on the subject and the manuscript is well written. I am most excited about the ARSLIP model, which, with further testing and validation in other species with rigorous experiments and quantitative data, can potentially provide a general model to explain terrestrial locomotion of a diversity of insects. I am supportive that the paper should be further considered for publication in eLife, but I do have one major comment that the authors should address or argue against.</p></disp-quote><p>We thank the reviewer for recognizing the potential importance of ARSLIP model.</p><disp-quote content-type="editor-comment"><p>The authors should make it very clear up front what they mean by &quot;gait&quot;. It appears that, when the authors stated that fruit fly uses pretty much the same tripod gait across speeds, they are really just stating that the fruit fly uses basically the same leg coordination to move (which even the authors acknowledged) regardless of what speed they move at and how their legs come in contact with the ground. I think this is true and well supported by their data. However, I am not sure if it is really that important to stress and try to convince everyone that this is THE best/right way to define gait. Frankly, I think the authors should simply state that they found leg &quot;coordination&quot; to be relatively constant, not &quot;gait&quot;, which can be defined/interpreted differently by different people or for different purposes.</p><p>It is well known that there are different ways of defining gait for terrestrial locomotion. For example, a commonplace definition is by the sequence/phase and duty factor that the feet are in contact with the ground. Alternatively, center of mass (CoM) dynamics can be used to define gait instead. With these different ways, what appear as walking (e.g., cockroach using an alternating tripod footfall pattern with a &gt;0.5 duty factor) using the first definition may in fact be classified as SLIP-like running when CoM dynamics are evaluated.</p><p>The authors have carefully compared their definition of gait with that in a few closely-related recent studies. The authors' gait definition is mainly based on kinematics (coordination to be exact) of the legs themselves, whereas the other studies used stance and swing phase patterns (which are footfall patterns on the ground). These are different ways of defining gait from kinematics. While I agree with the technical aspects of the comparisons, as well as some flaws that the authors have identified in the other studies, I am not sure if leg coordination alone is THE best/right way of defining gait.</p><p>As an example, we can again consider the cockroach case above. Using the author's definition, cockroaches also only demonstrates a single tripod &quot;gait&quot; in terms of leg coordination when speed increase from very small to very large. Does this mean that all the work defining cockroach walking at low speeds and running at high speeds using CoM dynamics are wrong in having such definitions?</p><p>In my opinion, the authors have shown convincing evidence that leg coordination (which they refer to as &quot;gait&quot;) does not change significantly as speed increases. The resulting kinematics of stance and swing phases do vary with speed, and other researchers (or the authors hypothetically) may choose to use those instead to define gait. Frankly, I do not think this is the key advancement of the study and am not sure it is worth this much effort to try to convince people of different opinions (although I certainly understand that the authors may be choosing to emphasize this in order to address the reviewers' comments).</p></disp-quote><p>We completely agree with the reviewer. As such we have stated in the first paragraph itself that we are using gait interchangeably with inter-leg coordination. We have reformatted the manuscript to remove much of the description of gait.</p><disp-quote content-type="editor-comment"><p>I think the authors should highlight the contribution they are making with the ARSLIP model. Again, as I said above, this can potentially be a general model and a major advancement of the field of terrestrial animal locomotion. I see this model (with further validation and generalization beyond this study) as the equivalent of seminal work on bipedal compliant leg template model, which unifies SLIP running and inverted pendulum walking for bipedal locomotion (Geyer, Seyfarth and Blickhan, 2006). The authors cited this work, but do not seem to appreciate its importance in the area of bipedal locomotion, or how their own work has the potential of being the same. The authors' model provides initial insight why hexapedal animals can use the same set of legs to achieve dynamic locomotion over a wide range of speeds.</p><p>The authors do provide evidence that the velocity profile of CoM dynamics are opposite to SLIP-like, which is another thing that motivates the ARSLIP model. I think this should be also emphasized more to set up the model.</p><p>I think the authors are missing an opportunity not to discuss this more, and their paper will improve substantially by building around this central idea, which the kinematic data and analysis provide compelling evidence for. I think this will significantly increase the impact of the paper beyond the field of animal locomotion. It is these kinds of simple, general biomechanical/dynamic models that have provided the foundation for simple yet robust robots such as RHex, Atlas, BigDog, etc. Personally, I think that this is something that many people will remember the study for, not so much the technical debate on which way of defining &quot;gait&quot; from pure kinematics is better, which are concerns more for the specialists.</p><p>Therefore, I strongly encourage the authors to cut down on the debate of &quot;gait&quot; and highlight the modeling contributions and elaborate (at least speculate) what should be done in future to test and validate it as a general model.</p></disp-quote><p>We have addressed this point by embracing the idea that ARLSIP could be a general model for multi-legged locomotion (this includes the double stance phase of bipedal locomotion to quadrupeds to hexapods and polypeds) through a more detailed discussion in both the Introduction and Discussion.</p></body></sub-article></article>