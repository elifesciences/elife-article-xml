<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">44032</article-id><article-id pub-id-type="doi">10.7554/eLife.44032</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Generalization of learned responses in the mormyrid electrosensory lobe</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-127024"><name><surname>Dempsey</surname><given-names>Conor</given-names></name><email>codiomsaigh@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-18458"><name><surname>Abbott</surname><given-names>LF</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-8693"><name><surname>Sawtell</surname><given-names>Nathaniel B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1859-8026</contrib-id><email>ns2635@columbia.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Department of Neuroscience, Zuckerman Mind Brain Behavior Institute</institution><institution>Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Department of Physiology and Cellular Biophysics</institution><institution>Columbia University</institution><addr-line><named-content content-type="city">New York</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Carr</surname><given-names>Catherine Emily</given-names></name><role>Reviewing Editor</role><aff><institution>University of Maryland</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Marder</surname><given-names>Eve</given-names></name><role>Senior Editor</role><aff><institution>Brandeis University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>14</day><month>03</month><year>2019</year></pub-date><pub-date pub-type="collection"><year>2019</year></pub-date><volume>8</volume><elocation-id>e44032</elocation-id><history><date date-type="received" iso-8601-date="2018-11-29"><day>29</day><month>11</month><year>2018</year></date><date date-type="accepted" iso-8601-date="2019-02-21"><day>21</day><month>02</month><year>2019</year></date></history><permissions><copyright-statement>© 2019, Dempsey et al</copyright-statement><copyright-year>2019</copyright-year><copyright-holder>Dempsey et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-44032-v3.pdf"/><related-article ext-link-type="doi" id="ra1" related-article-type="commentary" xlink:href="10.7554/eLife.46651"/><abstract><object-id pub-id-type="doi">10.7554/eLife.44032.001</object-id><p>Appropriate generalization of learned responses to new situations is vital for adaptive behavior. We provide a circuit-level account of generalization in the electrosensory lobe (ELL) of weakly electric mormyrid fish. Much is already known in this system about a form of learning in which motor corollary discharge signals cancel responses to the uninformative input evoked by the fish’s own electric pulses. However, for this cancellation to be useful under natural circumstances, it must generalize accurately across behavioral regimes, specifically different electric pulse rates. We show that such generalization indeed occurs in ELL neurons, and develop a circuit-level model explaining how this may be achieved. The mechanism involves regularized synaptic plasticity and an approximate matching of the temporal dynamics of motor corollary discharge and electrosensory inputs. Recordings of motor corollary discharge signals in mossy fibers and granule cells provide direct evidence for such matching.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>electric fish</kwd><kwd>corollary discharge</kwd><kwd>generalization</kwd><kwd>synaptic plasticity</kwd><kwd>cerebellum</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1025849</award-id><principal-award-recipient><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Sawtell</surname><given-names>Nathaniel B</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000065</institution-id><institution>National Institute of Neurological Disorders and Stroke</institution></institution-wrap></funding-source><award-id>NS075023</award-id><principal-award-recipient><name><surname>Sawtell</surname><given-names>Nathaniel B</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006984</institution-id><institution>Irma T. Hirschl Trust</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Sawtell</surname><given-names>Nathaniel B</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000893</institution-id><institution>Simons Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Abbott</surname><given-names>LF</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000324</institution-id><institution>Gatsby Charitable Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Abbott</surname><given-names>LF</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1707398</award-id><principal-award-recipient><name><surname>Abbott</surname><given-names>Larry F</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>In vivo recordings and computational modeling of the electrosensory lobe of mormyrid fish provide a circuit-level description of how learning generalizes to new situations.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>A learned response that is adaptive only in the precise context in which it was learned is of limited value in the real world. Though cellular and synaptic underpinnings of learning have been elucidated in many systems, less is known about the mechanisms that allow learning to generalize appropriately to conditions different from those in which the learning originally took place (<xref ref-type="bibr" rid="bib25">Censor, 2013</xref>; <xref ref-type="bibr" rid="bib35">Fahle, 2005</xref>; <xref ref-type="bibr" rid="bib53">Poggio and Bizzi, 2004</xref>). We address the question of generalization of learned responses in the passive electrosensory system of weakly electric mormyrid fish. These fish, like a number of other aquatic animals, possess a specialized class of electroreceptors on their skin that are sensitive to minute, low-frequency electrical fields, such as those emitted by other animals in the water (<xref ref-type="bibr" rid="bib32">Engelmann et al., 2010</xref>; <xref ref-type="bibr" rid="bib34">Enikolopov et al., 2018</xref>; <xref ref-type="bibr" rid="bib66">von der Emde and Bleckmann, 1998</xref>). However, the detection and processing of such signals is complicated by the fact that mormyrid fish also emit their own pulsed electric fields, known as electric organ discharges (EODs). Though EODs are used for sensing nearby objects through active electrolocation as well as for communication with conspecifics (processes mediated by separate classes of electroreceptors), they also strongly activate the receptors subserving passive electrolocation, inducing a ringing pattern of activation that persists for ~200 ms (<xref ref-type="bibr" rid="bib18">Bell and Russell, 1978</xref>). If left uncancelled, these responses to the fish’s own EOD could impede the detection and processing of behaviorally-relevant signals such as prey (<xref ref-type="bibr" rid="bib34">Enikolopov et al., 2018</xref>).</p><p>Past work has suggested that this problem is solved in ELL neurons through the integration of electrosensory input and corollary signals (CD) related to the motor command to discharge the electric organ (<xref ref-type="bibr" rid="bib9">Bell et al., 1981</xref>). CD signals are conveyed to ELL neurons by granule cells, similar to the granule cells of the cerebellum (<xref ref-type="bibr" rid="bib17">Bell et al., 2008</xref>). Anti-Hebbian plasticity at synapses between granule cells and ELL neurons generates negative images that serve to cancel the effects of the EOD on ELL output (<xref ref-type="bibr" rid="bib8">Bell, 1981</xref>; <xref ref-type="bibr" rid="bib13">Bell et al., 1993</xref>; <xref ref-type="bibr" rid="bib14">Bell et al., 1997a</xref>) (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). However, all past studies of negative image formation and sensory cancellation were restricted to periods when fish emitted EOD commands at low, regular rates (~5 Hz). Although this pattern is typical of paralyzed preparations, the fish’s actual electromotor behavior is far more dynamic. For example, in freely behaving fish it is common to observe prolonged periods of discharge at low rates (1–5 Hz), while resting or hiding, followed by abrupt transitions to much higher rates (up to 60 Hz) when foraging for prey or exploring a novel object (<xref ref-type="fig" rid="fig1">Figure 1B</xref>); (<xref ref-type="bibr" rid="bib39">Hofmann et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Moller et al., 1989</xref>; <xref ref-type="bibr" rid="bib60">Schwarz and von der Emde, 2001</xref>; <xref ref-type="bibr" rid="bib63">Toerring and Moller, 1984</xref>).</p><fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.002</object-id><label>Figure 1.</label><caption><title>Cancelling the effects of the EOD under natural conditions requires generalization.</title><p>(<bold>A</bold>) Schematic of ELL circuit elements responsible for cancellation of self-generated electrosensory responses. Granule cell corollary discharge responses form a temporal basis (blue trace at left) that is shaped by an anti-Hebbian spike-timing dependent synaptic plasticity rule into a negative image of the predictable sensory response to an EOD (blue trace at right). Signals related to the EOD (orange traces, left and right), along with behaviorally relevant stimuli that the system is meant to detect (not shown), are conveyed by afferent fibers (orange) originating from electroreceptors on the skin. Question mark indicates the process of sensory cancellation being studied. (<bold>B</bold>) A sequence of inter-EOD intervals recorded in a freely swimming mormyrid fish, adapted with permission from <xref ref-type="bibr" rid="bib63">Toerring and Moller (1984)</xref>. Note the wide range of discharge rates and abrupt transition from lower, irregular rates to a high regular rate (arrow). Such transitions highlight the need for negative images to generalize across different EOD rate regimes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig1-v3.tif"/></fig><p>During such transitions, negative images learned during low-frequency resting periods should generalize to higher EOD rates. If they do not, passive electrolocation would be degraded at precisely the moment when it would seemingly be most needed. Furthermore, this generalization must be accurate because, at high frequencies, the ringing sensory receptor responses to EODs overlap and, if uncancelled, would continuously interfere with the detection of external stimuli such as prey. Using microstimulation of the EOD motor command pathway to control EOD rate, we show that, indeed, sensory cancellation in ELL output neurons generalizes across EOD rates. In theory, such generalization is expected if electrosensory and corollary discharge responses at high rates were simply the linear sum of the responses at low rates. We show that this is not the case and, instead, identify two key features that, when added to existing models of sensory cancellation in ELL, account for generalization. The first is regularization of synaptic plasticity between granule cells and ELL neurons to prevent overfitting, which is closely related to machine learning approaches to generalization. The second feature, which we support directly by recordings from granule cells and their mossy fiber inputs, involves an approximate matching between the EOD rate-dependence of corollary discharge and electrosensory inputs to ELL neurons.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Sensory cancellation in ELL output cells generalizes from low to high EOD rates</title><p>We first tested whether sensory cancellation in ELL output cells generalizes across different EOD rates. As in past studies, we used a preparation in which the EOD is blocked by a paralytic, but in which fish are alert and continue to generate the motor commands that normally evoke EODs. The electric field normally generated by the EOD is mimicked experimentally. This preparation permits study of the responses to motor corollary discharge inputs triggered by the EOD command (by turning off the mimic), the sensory response to the artificially produced EOD mimic (by generating the mimic in the absence of an EOD command), and the response to EOD mimics paired with the EOD command. The paired condition replicates the natural situation in which the EOD command evokes an EOD pulse and both electrosensory and corollary discharge pathways are engaged together.</p><p>Past studies have shown that the response to locally delivered EOD mimics triggered by the EOD command are cancelled if mimics are paired with commands in this way over ~15 min. For this reason, we will use the term ‘learning’ to refer to extended periods when EOD mimics are triggered by, and hence paired with, commands. Turning the mimic off after learning reveals that the response to the command alone resembles a negative image of the response to the mimic in the absence of a command (<xref ref-type="bibr" rid="bib8">Bell, 1981</xref>, <xref ref-type="bibr" rid="bib10">Bell, 1982</xref>). As discussed in the Introduction, a limitation of past studies is that cancellation and negative images were only studied at the low EOD command rates (~5 Hz) typical of the paralyzed preparation. We overcame this limitation by using microstimulation of the electromotor command pathway (see Materials and methods) to control the timing and rate of EOD commands (<xref ref-type="bibr" rid="bib65">von der Emde et al., 2000</xref>). Using this approach, we could achieve almost perfect control over the timing of EOD commands at rates up to 50 or 60 Hz.</p><p>Extracellular single-unit recordings were made from output cells in the region of the ELL dedicated to passive electrosensory processing—the ventrolateral zone (VLZ). These output neurons are classified into two types, known as E and I cells, according to the polarity of their response to electrosensory stimuli (<xref ref-type="bibr" rid="bib8">Bell, 1981</xref>, <xref ref-type="bibr" rid="bib10">Bell, 1982</xref>). To avoid firing-rate rectification, which complicates quantitative measurements of sensory cancellation, we adjusted the polarity of the EOD mimic to evoke excitatory responses in both E and I cells (see Materials and methods). Consistent with previous findings (<xref ref-type="bibr" rid="bib10">Bell, 1982</xref>; <xref ref-type="bibr" rid="bib34">Enikolopov et al., 2018</xref>), no obvious differences in plasticity were observed between E and I cells and responses were pooled.</p><p>To test generalization, we paired evoked commands with EOD mimics at a single constant rate (10 Hz) for a 10–20 min learning period (by which time significant cancellation had occurred; <xref ref-type="fig" rid="fig2">Figure 2A</xref>, top row) and then probed responses to EOD mimics paired across a range of rates (10, 40, and 60 Hz or 10, 30, and 50 Hz). Responses after learning are reduced across rates even though learning occurred at only the lowest rate, consistent with generalization of cancellation (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, bottom row, solid lines). An additional set of experiments were performed to provide a benchmark for evaluating the quality of generalization. In this case, the EOD mimic was paired for the same duration but this time learning took place at all the different frequencies that were subsequently tested for cancellation (10, 40, and 60 Hz or 10, 30, and 50 Hz; <xref ref-type="fig" rid="fig2">Figure 2B</xref>). In this scenario, for which no generalization is required, we expect the system to achieve the best level of cancellation across all rates that can be achieved on the timescale of these experiments. The degree of cancellation, measured as the residual power in the response after learning divided by the power before learning, was comparable in the two sets of experiments (<xref ref-type="fig" rid="fig2">Figure 2C,D</xref>), indicating excellent generalization.</p><fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.003</object-id><label>Figure 2.</label><caption><title>Sensory cancellation in ELL output cells generalizes from low to high EOD rates.</title><p>(<bold>A</bold>) Top, pre-learning response of an ELL output cell to a sequence of mimics triggered by EOD commands at 10 Hz. Shaded box indicates the learning condition. Empty dashed box indicates that no learning was performed at 60 Hz in this series of experiments. Red ticks show the times of EOD commands and black ticks show the times of EOD mimics. Bottom, response of the same cell after learning at 10 Hz. Dashed line is the response of the cell to the EOD mimic presented independent of the command after learning. Note, the response to the mimic is largely cancelled at both 10 and 60 Hz even though learning occurred only at 10 Hz. Responses were also probed at 40 Hz in this cell with similar results (not shown). Scale bar is 1 s. (<bold>B</bold>) Top, pre-learning responses of an ELL output cell to paired EOD command and mimic sequences at 10 and 60 Hz. Shaded boxes indicate that learning took place at both 10 Hz and 60 Hz. Bottom, the response of the same cell after learning. Learning was also conducted at 40 Hz in this cell with similar results (not shown). (<bold>C</bold>) Degree of cancellation at each rate for learning only at 10 Hz, expressed as the ratio of the power of the residual response after learning to the power of the pre-learning response (<italic>n</italic> = 17, median residual power ratios are 0.34, 0.48, 0.63 at 10, 40, and 60 Hz respectively). (<bold>D</bold>) Degree of cancellation at each rate when learning and testing were at the same frequencies of 10, 40, and 60 Hz, expressed as in C (<italic>n</italic> = 12, median residual power ratios are 0.36, 0.49, 0.61 at 10, 40, and 60 Hz respectively).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig2-v3.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.004</object-id><label>Figure 2—figure supplement 1.</label><caption><title>ELL neurons form negative images that generalize across EOD rates.</title><p>(<bold>A</bold>) <italic>Top</italic>, responses of an ELL output cell at 10, 40, and 60 Hz, after pairing only at 10 Hz.</p><p>Blue shows the response to the mimic alone, black shows the response to the command alone after pairing. Responses in the latter period are due to corollary discharge inputs and resemble an approximate negative image of the response to the mimic across rates, despite pairing being conducted only at 10 Hz. Periods of high firing evoked by the command alone (red arrows) correspond to periods of low firing induced by the EOD mimic. <italic>Bottom,</italic> responses of the same cell after pairing with an opposite-polarity mimic at 10 Hz. Purple shows the response to the mimic alone, black shows the response to the command alone. Note that the corollary discharge response has completely changed (compare black trace in top panel), generalizing appropriately, despite pairing with the new stimulus only at 10 Hz. (<bold>B</bold>) Similar to (<bold>A</bold>) but for a different cell, this time paired at all rates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig2-figsupp1-v3.tif"/></fig></fig-group><p>Past studies have shown that cancellation of predictable electrosensory responses is due to the generation and subtraction of negative images (<xref ref-type="bibr" rid="bib8">Bell, 1981</xref>, <xref ref-type="bibr" rid="bib10">Bell, 1982</xref>). Several observations suggest that the cancellation observed in <xref ref-type="fig" rid="fig2">Figure 2</xref> is likewise due to the formation of negative images. First, cancellation is unlikely to be due to adaptation of peripheral receptors or neuronal fatigue as we routinely probed responses to the EOD mimic delivered independently of the command both before and after learning (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, bottom, dashed lines). Reductions in the response to the mimic alone were never observed. Second, in a subset of experiments we probed responses to the command alone across EOD rates after learning only at a low rate. Changes in the response to the command alone resembled a negative image of the response to the mimic sequence (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p></sec><sec id="s2-2"><title>Regularized synaptic plasticity partially explains generalization</title><p>To gain insights into the mechanisms that support generalization, we adapted a previously developed model of negative image formation and sensory cancellation in the ELL (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). The model ELL neuron receives two classes of inputs. The first is a non-plastic electrosensory input that we simulated by using the recorded response of an ELL output cell to an EOD mimic sequence. This corresponds anatomically to the input onto the basilar dendrites of ELL neurons from interneurons in the deep layers of ELL receiving somatotopic input from ampullary electroreceptor afferents (<xref ref-type="bibr" rid="bib45">Meek et al., 1999</xref>). The second class of inputs consists of a set of ~20,000 model granule cell responses conveying corollary discharge signals related to the EOD command. This corresponds anatomically to excitatory granule cell-parallel fiber synapses onto the apical dendrites of ELL neurons. The model is simplified in that it does not differentiate between two distinct classes of ELL neurons: output cells and medium ganglion (MG) cells (see Discussion). Granule cells are modeled as integrate-and-fire units receiving inputs generated from recorded responses of mossy fibers and unipolar brush cells (the main excitatory inputs to granule cells) to isolated EOD commands (&gt;200 ms intervals between commands (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). This granule cell model is one component of the full model; the other is a mathematical description of the plasticity of synapses from granule cells to ELL neurons (<xref ref-type="bibr" rid="bib14">Bell et al., 1997a</xref>; <xref ref-type="bibr" rid="bib37">Han et al., 2000</xref>). The anti-Hebbian spike timing-dependent plasticity rule used in the model includes a regularization mechanism to prevent excessively large synaptic weights. Regularization consists of having the synaptic weights decay exponentially toward a baseline value with a time constant of 1000 s, in addition to their modification due to anti-Hebbian plasticity. We refer to this version of the plasticity rule as minimally regularized (see Materials and methods).</p><p>To explore mechanisms of generalization using this model, we first needed to extend its granule cell component to simulate high EOD command rates. To begin, we made simple assumptions about how the previously recorded mossy fibers and unipolar brush cells would respond at higher command rates (see Materials and methods). For example, the most common class of mossy fiber inputs, known as early, fire a precisely-timed burst of spikes (duration ~12 ms) at a short delay after each EOD command. To create early mossy fibers responses to command sequences at different EOD rates, we simply repeated the same burst pattern and timing for each command in the sequence (see Materials and methods for assumptions used for other response types; <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Later, we will replace these simple assumptions with results derived from experimental measurements of the true EOD-rate dependence of mossy fiber and other inputs. We refer to the granule cell model without these later modifications as the original model.</p><p>Using the original model with minimal regularization, we first simulated the generalization experiment in which the system is repeatedly exposed to 10 Hz sequences of EODs for learning and cancellation and then tested at various rates. In agreement with the experimental results, plasticity in the model gradually reduces ELL neuron responses to the EOD, and cancellation is accurate when it is subsequently tested at 10 Hz (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, lower left). However, in contrast to the experimental results, the model exhibits a dramatic over-cancellation when tested at higher EOD rates (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, lower right). To determine whether this resulted from a failure of learning or generalization, we simulated the experiments in which the system was trained at all the rates at which it is tested. Under these conditions, the model ELL neuron learns to cancel sensory responses at all the rates tested (<xref ref-type="fig" rid="fig3">Figure 3B</xref>, lower panels). This indicates that the model can learn to cancel at different EOD rates but fails to generalize low-frequency learning to high EOD rates.</p><fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.005</object-id><label>Figure 3.</label><caption><title>Regularization of synaptic plasticity improves but does not fully account for generalization.</title><p>(<bold>A</bold>) Top, pre-learning response of a model ELL neuron to paired EOD command and mimic sequences delivered at 10 Hz. Shaded box indicates the learning condition. Red ticks show the times of EOD commands and black ticks show the times of EOD mimics. Bottom, response of the model cell after learning. The response to the mimic is largely cancelled at 10 Hz but is dramatically over-cancelled at 60 Hz. (<bold>B</bold>) Top, pre-learning response of a model ELL neuron to paired EOD command and mimic sequences at 10 and 60 Hz. Shaded boxes indicate the learning conditions. Bottom, response after learning. The response is largely cancelled at both 10 and 60 Hz. (<bold>C</bold>) Degree of cancellation at 10 Hz and 60 Hz for model and real cells across rates when training occurred at both rates. (<bold>D</bold>) Degree of cancellation at 10 Hz for real cells and model cells, with full and minimal regularization, when learning was only at 10 Hz. (<bold>E</bold>) Degree of cancellation at 60 Hz for real and model cells, with full and minimal regularization, when learning was only at 10 Hz.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig3-v3.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.006</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Modeling the responses of late mossy fibers across EOD command rates.</title><p>(<bold>A</bold>) Schematic of the spiking response of a late mossy fiber evoked by an isolated EOD command. The response consists of a delay followed by a period of spikes, as shown. (<bold>B</bold>) Schematic of the modeled response of the same mossy fiber to a sequence of two EOD commands. The pattern of delay and spiking is copied after each EOD command, but the delay following each EOD command erases any spikes caused by the previous command that fall within the delay period following the current command, as shown.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig3-figsupp1-v3.tif"/></fig></fig-group><p>Cancellation performance is comparable between model and data when generalization is not required because training is at both 10 Hz and 60 Hz (<xref ref-type="fig" rid="fig3">Figure 3C</xref>, data and minimal regularization). Interestingly, when learning is only at 10 Hz, cancelation at 10 Hz is actually better in the minimally regularized model than in the data (<xref ref-type="fig" rid="fig3">Figure 3D</xref>, data and minimal regularization). This is consistent with overfitting, a feature that is expected to limit generalization. Indeed, when generalization is required, real neurons outperform the minimally regularized model by a large margin (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, data and minimal regularization). These results show that: (1) our current understanding of ELL circuitry cannot explain the ability of the system to cancel the sensory consequences of EOD sequences in a manner that generalizes from low to high rates and (2) this is not due to an inability of the model system to cancel across rates but is specifically a failure of generalization.</p><p>One strategy for improving generalization that is commonly used in machine learning is regularization (<xref ref-type="bibr" rid="bib19">Bishop, 2006</xref>). To enhance regularization, we decreased the decay time constant for the synaptic weights from 1000 s to 10 s. We also changed the value toward which the weights decay from zero to a non-zero baseline (see Materials and methods). The utility of this latter change will be discussed in a later section. We refer to this modified plasticity rule as fully regularized.</p><p>When training is performed at both 10 Hz and 60 Hz, cancellation in the fully regularized model is similar to the data and to the minimally regularized model (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). When trained only at 10 Hz, the fully regularized model matches the data better than the minimally regularized model, presumably by avoiding overfitting (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Consistent with this, the fully regularized model exhibits substantially improved generalization across rates compared to the minimally regularized model (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, minimal and full regularization). However, the fully regularized model still fails to match the generalization performance seen in the data (<xref ref-type="fig" rid="fig3">Figure 3E</xref>, data and full regularization). These results suggest that the original model is subject to overfitting and that regularization provides a partial solution. However, additional mechanisms are required to match the data. We reasoned that this failure likely reflects the inadequacy of the assumptions we made about how granule cells respond to high-rate EOD commands.</p></sec><sec id="s2-3"><title>Rate dependence of granule cell corollary discharge responses in vivo</title><p>The corollary discharge responses of granule cells provide the ‘raw material’ from which negative images are sculpted via synaptic plasticity, and hence they are critical for sensory cancellation. Although the granule cell corollary discharge responses used in our model are based on an extensive set of recordings, all of the data was collected in the context of isolated EOD commands (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). As mentioned above, we modeled cancellation at high rates based on assumptions about how mossy fiber inputs to granule cells respond at high command rates. The failure of our original model to match the generalization performance seen in the data, even with full regularization, may indicate that these assumptions are incorrect. To test this, we used whole-cell recordings to characterize corollary discharge responses across EOD rates for 28 granule cells (see Materials and methods).</p><p>Most recorded granule cells (21 of 28) exhibited a prominent (~8 mV), short-latency (~2.5 ms) depolarization in response to spontaneously emitted EOD commands. Previous studies have shown that this response type, known as early, is due to mossy fiber input originating from a specific midbrain nucleus that relays electric corollary discharge information (<xref ref-type="bibr" rid="bib11">Bell et al., 1983</xref>). Command-locked hyperpolarizations, indicative of inhibition, were rarely observed, also consistent with past studies. After characterizing responses to spontaneous commands, microstimulation of the electromotor command pathway was used to evoke trains of 25 commands at rates of 10–60 Hz (for clarity, only responses to low and high rates are shown in the figures). As can be seen in the example traces in <xref ref-type="fig" rid="fig4">Figure 4A</xref>, command-evoked depolarizations show little or no temporal summation at high command rates, with some cells even exhibiting a relatively hyperpolarized membrane potential at high versus low rates (not shown). Additional examples are shown in <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>. The responses of recorded granule cells contrast with those of the original model, which show pronounced summation and membrane potential depolarization at high rates (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>, <xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.007</object-id><label>Figure 4.</label><caption><title>Command rate-dependence of granule cells and their mossy fiber inputs.</title><p>(<bold>A</bold>) Membrane potential of a granule cell in response to a 60 Hz sequence of 25 EOD commands, with stimulus artifacts removed. Red ticks show the times of EOD commands. (<bold>B</bold>) The response to a single command at 10 Hz along with the time at which a subsequent command would occur at a rate of 60 Hz (red arrow). Bottom trace is the electromotoneuron volley recorded near the electric organ. Same cell as in (<bold>A</bold>). (<bold>C</bold>) Distribution of median percentage increase in maximum membrane voltage from 10 Hz to 60 Hz command rates across <italic>n</italic> = 28 model granule cells. Dashed line shows the experimental value of 0.006 (p=0.03). (<bold>D</bold>) Distribution of median slope of membrane voltage in response to a 60 Hz sequence for model granule cells, dashed line shows value from the data, −0.43 mV/s (p&lt;0.002). (<bold>E</bold>) Initial portion of the response of the granule cell shown in panel (<bold>A</bold>). Black lines are data with stimulus artifacts removed, blue dashed line shows a fit using a model granule cell with input spike times inferred from the recorded membrane voltage. (<bold>F</bold>) Example traces from an early mossy fiber recorded extracellularly in the granular layer. Responses to 25 commands in a 10 Hz (top), 40 Hz (middle), or 60 Hz (bottom) sequence are overlaid. Note the ‘dropping’ of spikes in the burst at high rates. Bottom trace is the electromotoneuron volley recorded near the electric organ. (<bold>G</bold>) Average number of spikes fired per EOD command by early mossy fibers (gray, <italic>n</italic> = 9). Symbols show the mean ±S.D. (<bold>H</bold>) Average firing rate across all inferred tonic mossy fiber inputs to granule cells across EOD command frequencies (mean ±SEM, <italic>n</italic> = 19).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-v3.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.008</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Example recorded granule cells receiving early input.</title><p>Membrane voltage of two granule cells receiving early mossy fiber input (<bold>i-ii</bold>) in response to a 60 Hz sequence of EOD commands, with stimulus artifacts removed. An action potential at ~300 ms in (<bold>i</bold>) is truncated. Red ticks show the times of EOD commands. Black lines are data. Blue lines show model fits. Expanded traces reveal a decrement over time in the number of inflections (bumps) on the depolarizing responses for successive commands at high rates, indicative of early mossy fiber input spikes dropping out. Arrow indicates a rare case in which a microstimulation pulse failed to evoke a command.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-figsupp1-v3.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.009</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Granule cells in the original model fire nonlinearly and this nonlinearity is greater for cells with slower inputs.</title><p>(<bold>Ai-v</bold>) Example model granule cells showing the response to EOD sequences at three different rates (10, 40, 60 Hz), colored lines. Grey lines show the predicted response if each cell were linear. (<bold>B</bold>) EPSPs for the model cells in (<bold>A</bold>), showing that there is significant variability in real and model granule cell EPSP time constants and that cells with longer EPSP time constants fire more nonlinearly due to greater temporal summation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-figsupp2-v3.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.010</object-id><label>Figure 4—figure supplement 3.</label><caption><title>Tonic mossy fibers decrease their firing rate at high EOD command rates.</title><p>In all panels, vertical red lines show EOD command times. (<bold>A</bold>) Example membrane voltage (four trials overlaid) of a putative unipolar brush cell exhibiting command rate-dependent inhibition of tonic firing in response to command sequences from 10 to 60 Hz. (<bold>B</bold>) Example membrane voltage of a granule cell receiving tonic mossy fiber input (black lines show times of inferred input spikes) in response to EOD command sequences from 10 to 60 Hz.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-figsupp3-v3.tif"/></fig><fig id="fig4s4" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.011</object-id><label>Figure 4—figure supplement 4.</label><caption><title>Pause mossy fibers cease firing at high command rates.</title><p>(<bold>i-iii</bold>) Show the firing rate of three example pause mossy fibers in response to a single EOD command (left), a 10 Hz sequence of 25 EOD commands (center), and a 60 Hz sequence of 25 EOD commands (right). Pause mossy fibers show tonic firing with a pause in response to a single EOD command, and at higher EOD command rates cease firing altogether (<italic>n</italic> = 6).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-figsupp4-v3.tif"/></fig><fig id="fig4s5" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.012</object-id><label>Figure 4—figure supplement 5.</label><caption><title>Golgi cells increase their firing rate with increasing EOD command rate .</title><p>(<bold>A</bold>) Membrane voltage of an example Golgi cell in response to EOD command sequences from 10 to 60 Hz. Spikes are truncated. Red vertical lines show times of EOD commands. (<bold>B</bold>) Firing rates increase as a function of EOD command in Golgi cells (p&lt;0.001, linear regression t-test, <italic>n</italic> = 3).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig4-figsupp5-v3.tif"/></fig></fig-group><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.013</object-id><label>Figure 5.</label><caption><title>Model granule cells with rate-dependent command inputs match recorded granule cells.</title><p>(<bold>A–D</bold>) Dark versus light blue indicates model cell response with and without rate-dependent inputs matched to the data. (<bold>A</bold>) Response of a model granule cell to two EODs in a 10 Hz command sequence. Note that the cell responds very similarly at this rate with either set of inputs. (<bold>B</bold>) Response of the same model cell as in (<bold>A</bold>), but for a sequence of EOD commands at 60 Hz. Note the qualitatively distinct responses with and without input rate-dependencies at this higher rate. (<bold>C–D</bold>) Distributions of two response statistics for new and old models, dashed lines show the value found in real granule cells. (<bold>C</bold>) Median percentage increase in membrane voltage from 10 to 60 Hz (for old model p=0.03, for new model p=0.72). (<bold>D</bold>) Median membrane potential slope across a 60 Hz train of EOD commands (for old model p&lt;0.002, for new model p=0.81).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig5-v3.tif"/></fig><p>To quantify the differences between recorded versus model granule cells, we computed the average percentage increase in membrane voltage from 10 Hz to 60 Hz (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) and the average slope of the line best fit to the membrane voltage of each cell across a 60 Hz train of EOD commands (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). For the model cells, we generated a distribution by drawing 1000 sets of 28 cells from our model population (matching the 28 recorded cells) and used this to compute both a distribution and a p-value. In each histogram the vertical dashed line shows the value calculated for the set of recorded granule cells. Whereas recorded granule cells showed very little change in their average membrane potential at high command rates, model cells increased their membrane potential substantially (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Recorded granule cells have, on average, a negative slope in their membrane potential across 60 Hz trains, whereas model cells have positive sloping membrane potentials (<xref ref-type="fig" rid="fig4">Figure 4D</xref>), consistent with greater summation in the model versus the recorded granule cells. Clearly the original granule cell model provides a poor description of actual granule cell responses at high EOD command rates.</p><p>The shortcomings of the granule cell model we have been using could arise from a mismatch of the model to the biophysical properties of real granule cells, or it could be the result of poorly describing their mossy-fiber and unipolar-brush-cell inputs. To differentiate between these possibilities, we modeled granule cell responses using the same integrate-and-fire description we have been using, but we replaced the computed input to the model cells with experimentally measured inputs. For each granule cell, we fit integrate-and-fire model parameters and, at the same time, inferred its excitatory inputs from the recorded membrane potential. This process was relatively straightforward given that granule cells exhibit large EPSPs, low noise, and receive just a few inputs (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>; <xref ref-type="bibr" rid="bib54">Requarth et al., 2014</xref>; <xref ref-type="bibr" rid="bib59">Sawtell, 2010</xref>) (see Materials and methods). We found that the original integrate-and-fire model did a good job of fitting the data provided that we used inputs inferred from data, not the inputs computed in the original model (<xref ref-type="fig" rid="fig4">Figure 4E</xref> shows the data and model fit for an example cell, also see <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). We tried a number of augmented models, including features such as synaptic depression, inhibition and conductance-based soma and synapses, but these did not substantially improve the fit compared to the basic current-based integrate-and-fire model with purely excitatory input. This analysis suggested that the failure of the original model (<xref ref-type="fig" rid="fig3">Figure 3</xref>) to generalize may indeed lie in its failure to accurately represent the EOD-rate dependence of mossy fiber and unipolar brush cell inputs.</p><p>To test this more directly, we recorded from mossy fiber axons, unipolar brush cells, and Golgi cells. Criteria for distinguishing between these different elements in neural recordings have been established previously (<xref ref-type="bibr" rid="bib12">Bell et al., 1992</xref>; <xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>; <xref ref-type="bibr" rid="bib59">Sawtell, 2010</xref>). Prominent effects of EOD command rate were observed in early mossy fibers, the most common class of mossy fiber input to granule cells. Consistent with past observations, early mossy fibers fire extremely precise bursts of spikes following after EOD command. After the successive commands in a 10 Hz train they fire exactly the same burst of spikes (<xref ref-type="fig" rid="fig4">Figure 4F</xref>, top), but on the second command of a 40 Hz or 60 Hz train they drop one or more spikes (<xref ref-type="fig" rid="fig4">Figure 4F</xref>, middle and bottom). The result of this dropping out is that the average number of mossy fiber spikes fired per command decreases with increasing command rate (<xref ref-type="fig" rid="fig4">Figure 4G</xref>).</p><p>An additional effect observed at high command rates was a decrease in the rate of tonic input to granule cells. Tonic inputs (EPSPs not time-locked to the EOD command) were observed in 19 of 28 granule cells (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). Similar command-rate dependent decreases in tonic firing were observed in recordings from putative mossy fibers and unipolar brush cells (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Command rate-dependent responses were also found in another previously characterized functional class of granule cell input, known as pause inputs. Pause inputs exhibit a sharply-timed cessation of tonic firing following each EOD command and are believed to correspond to unipolar brush cells (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). Recordings from granule cells and putative UBCs indicate that such pause inputs decrease their firing significantly at higher command rates, often ceasing to fire completely (<xref ref-type="fig" rid="fig4s4">Figure 4—figure supplement 4</xref>). Finally, we found that Golgi cells, inhibitory interneurons that synapse onto granule cells, markedly increase their firing with increasing EOD command rate (<xref ref-type="fig" rid="fig4s5">Figure 4—figure supplement 5</xref>). Hence, command rate-dependent Golgi inhibition could also contribute to reducing the effect of temporal summation of excitatory inputs in granule cells.</p></sec><sec id="s2-4"><title>Model granule cells with rate-dependent command inputs match recorded granule cells</title><p>As described above, excitatory inputs to granule cells exhibit EOD command-rate dependencies that are more complex than those assumed in our original model. To determine whether such effects could help to explain generalization in ELL output neurons, we incorporated features of the recorded mossy fibers into a revised model. Specifically, we introduced the rate-dependent dropping out of early mossy fiber spikes and the reduction in tonic mossy fiber firing into the model. The measured rate-dependence of pause mossy fibers was similar to what was assumed in the original model, so no modification was necessary for them. Golgi cells were not considered further because we felt that too little is currently known about the details of Golgi inhibition onto granule cells to incorporate them into the model.</p><p>We characterized the effects of these changes by simulating populations of granule cells with and without command rate-dependent inputs. At low command rates model granule cells from the two populations show similar responses (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). However, at high command rates the two populations differ. Granule cells in the revised model no longer exhibit the increased depolarization at high versus low rates that was observed in the original model granule cells (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Examining the statistics we used previously to characterize EOD-rate dependencies in granule cell responses reveals that the inclusion of realistic assumptions regarding mossy fiber inputs dramatically changes the overall character of the granule cell responses in the revised model. The result is model granule cell responses that are clearly more consistent with the subthreshold responses recorded in actual granule cells across EOD rates (<xref ref-type="fig" rid="fig5">Figure 5C,D</xref>).</p></sec><sec id="s2-5"><title>The revised model with full regularization matches the generalization performance of ELL output neurons</title><p>Finally, we sought to determine whether the revised granule cell model, combined with fully regularized synaptic plasticity, can explain generalization in ELL output cells. We again simulated the generalization experiment where the system learns with 10 Hz sequences of EODs and cancellation performance is subsequently probed at different EOD rates (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). The revised model with full regularization shows cancellation across rates that generalizes at a level comparable to the recorded ELL neurons (<xref ref-type="fig" rid="fig6">Figure 6A,C,D</xref>). To understand the roles of both regularization and EOD rate dependencies, we compared results obtained using the revised model granule cell population (with rate-dependent input) but with the minimally regularized synaptic plasticity rule. In this case, model ELL neurons trained only at 10 Hz exhibited over-cancellation at high EOD rates (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). Hence the more realistic mossy fiber-granule cell model, on its own, is also insufficient to explain generalization (<xref ref-type="fig" rid="fig6">Figure 6B,C,D</xref>).</p><fig-group><fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.44032.014</object-id><label>Figure 6.</label><caption><title>A revised ELL model accounts for generalization in ELL neurons.</title><p>In all panels dashed blue traces are the sensory response to be cancelled and solid blue traces are the response to the paired EOD command plus mimic sequences. Learning occurs only at 10 Hz as indicated by grey boxes. Red ticks show the times of EOD commands and black ticks show the times of EOD mimics. (<bold>A</bold>) Top, pre-learning response of a revised model output cell with full regularization to paired EOD command and mimic sequences delivered at 10 Hz. Bottom, response of the same cell after learning. Note, the response to the mimic is largely cancelled at both 10 and 60 Hz. (<bold>B</bold>) Top, pre-learning response of a revised model output cell with minimal regularization to paired EOD command and mimic sequences delivered at 10 Hz. Bottom, response of the same cell after learning. Note, the response to the mimic is largely cancelled at 10 Hz but is now over-cancelled at 60 Hz. (<bold>C</bold>) Level of cancellation achieved at 10 Hz across different model and real ELL cells is similar (p=0.72 for minimally regularized model versus data; p=0.62 for fully-regularized model versus data, Wilcoxon signed rank test). (<bold>D</bold>) Similar to C but showing the level of cancellation achieved at 60 Hz, (p&lt;0.001 for minimally regularized model versus data; p=0.38 for fully-regularized model versus data, Wilcoxon signed rank test). (<bold>E</bold>) Dark blue, mean spiking response of model granule cells with input rate dependencies; grey, mean response of electroreceptor afferents, both at 60 Hz EOD rate. Note the similarity in shape.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig6-v3.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.015</object-id><label>Figure 6—figure supplement 1.</label><caption><title>Stronger regularization of synaptic plasticity restricts negative images to be proportional to the mean granule cell response and decreases variance in synaptic weights.</title><p>(<bold>A</bold>) Overlap between negative image and average model granule cell activity across a 25 EOD command sequence at 60 Hz, as a function of the strength of regularization of synaptic plasticity (see Materials and methods). (<bold>B</bold>) Variance of the final set of model synaptic weights from granule cells to the model ELL neuron, after pairing, as a function of the strength of regularization of synaptic plasticity.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig6-figsupp1-v3.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.016</object-id><label>Figure 6—figure supplement 2.</label><caption><title>Rate-dependence of ELL output cell responses to the EOD.</title><p>(<bold>A</bold>) Firing rate of three (i.-iii.) ELL output cells to EOD mimics delivered at 10, 40, and 60 Hz. Vertical ticks above the data indicate times of electrosensory stimuli. Black lines are data and red lines are the expected response assuming the response is a linear sum of individual EOD responses (see Materials and methods). Note the decreasing response profile at high rates. (<bold>B</bold>) Rate of decay of ELL output cell firing rate across a 25 mimic sequence as a function of mimic frequency (n = 22). (<bold>C</bold>) Mean ELL output cell firing rate across a 25 mimic sequence as a function of mimic frequency (n = 22).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig6-figsupp2-v3.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.44032.017</object-id><label>Figure 6—figure supplement 3.</label><caption><title>Rate-dependence of ampullary afferent responses to the EOD.</title><p>(<bold>A</bold>) Firing rate of an electroreceptor afferent to EOD mimics delivered at 10 Hz (left) and 60 Hz (right). Vertical ticks above data indicate times of electrosensory stimuli. Black lines are data and red lines are the expected response assuming the response is a linear sum of individual EOD responses (see Materials and methods). Note the decreasing response profile at high rates. (<bold>B</bold>) Rate of decay of electroreceptor afferent firing rate across a 25 mimic sequence as a function of mimic frequency (n = 12). (<bold>C</bold>) Mean electroreceptor afferent firing rate across a 25 mimic sequence as a function of mimic frequency (n = 12). (<bold>D</bold>) Example (average) impulse response of the electrosensory afferent shown in <bold>A</bold> to an isolated EOD, with both positive (green) and negative (red) lobes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-44032-fig6-figsupp3-v3.tif"/></fig></fig-group><p>Further examination of the model suggests a hypothesis regarding how regularized synaptic plasticity and rate-dependent mossy fiber inputs work together to support generalization. The form of regularized synaptic plasticity we have used involves a decay of each synaptic weight toward a constant non-zero value. Increasing the strength of this regularization decreases the variance of the learned weights because synaptic weights from different granule cells are constrained to be similar to this value and hence to one another (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). This means that, with strong regularization, the learned negative image is constrained to be approximately proportional to the mean response of the granule cell population. This average shape is, in turn, affected strongly by the rate-dependence of inputs to granule cells. As we have shown, in the absence of realistic mossy fiber rate-dependencies the mean model granule cell response has an increasing profile across a 60 Hz train, whereas, with the actual mossy fiber rate dependence, the mean granule cell response has a decreasing profile.</p><p>Notably, the sensory responses of ELL neurons to high rate trains of EOD mimics (prior to cancellation) also exhibit a decreasing profile (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). To determine the origin of such responses, we performed a separate set of extracellular recordings from ampullary electroreceptor afferents (the source of electrosensory input to ELL neurons). Ampullary afferent firing rate also exhibited a decreasing profile at high EOD rates (<xref ref-type="fig" rid="fig6">Figure 6E</xref>, <xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). Responses of ampullary afferents to isolated EOD pulses consist of a firing rate increase followed by a reduction below baseline and in some cases additional smaller waves of increased and decreased firing resembling a damped oscillation (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3D</xref>)(<xref ref-type="bibr" rid="bib18">Bell and Russell, 1978</xref>). Estimating the impulse response of an ampullary afferent from its average response to a single EOD mimic and then convolving this impulse response with a sequence of EOD mimics yielded a reasonable approximation to the observed responses (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3A</xref>, red lines). Hence the decaying profile of the sensory response to high-rate sequences of EODs as well as the inhibitory rebound at the end of such sequences are expected features of a linear system with an impulse response resembling a damped oscillation.</p><p>In summary, these results suggest that generalization across EOD discharge rates may be achieved in the ELL by combining two features: (1) a form of plasticity that encourages low variance in learned weights, forcing the negative image to be close to the mean granule cell response and (2) mossy fiber rate dependencies that ensure that the mean granule cell corollary discharge response has a shape that approximates the sensory signal to be cancelled. Together, these two features may allow accurate negative images to be generated across a wide range of EOD rates for which no previous learning has taken place.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><sec id="s3-1"><title>Functional significance of generalization in the ELL</title><p>Past work on negative image formation and sensory cancellation in mormyrid fish has been restricted to one particular behavioral regime, namely, periods when EOD rates are low and regular. However, the rate and timing of EODs are under voluntary control and vary widely during both electrocommunication and active electrolocation (<xref ref-type="bibr" rid="bib39">Hofmann et al., 2014</xref>; <xref ref-type="bibr" rid="bib49">Moller et al., 1989</xref>; <xref ref-type="bibr" rid="bib60">Schwarz and von der Emde, 2001</xref>; <xref ref-type="bibr" rid="bib63">Toerring and Moller, 1984</xref>). This suggests that negative images learned over periods of minutes or hours at low EOD rates (e.g. while the fish is inactive) must generalize when the fish transitions to a high EOD rate (e.g. during foraging, fleeing, exploring a novel object, or interacting with a conspecific). If generalization did not occur in such instances, the passive electrosensory system would be vulnerable to self-generated interference during the periods when it would be needed the most. Behavioral studies suggest that multiple senses (including both the passive and active electrosensory systems) are used in concert to detect prey (<xref ref-type="bibr" rid="bib66">von der Emde and Bleckmann, 1998</xref>). In light of these considerations, our observation that the cancellation performance of ELL neurons generalizes accurately supports and substantially extends the ethological relevance of negative images for passive electrolocation in mormyrid fish. A caveat is that our study focused on generalization in only one specific set of circumstances, that is an abrupt transition from low to high rates. Although this allowed us to focus on in-depth analysis of the mechanisms of generalization, important questions remain about how such mechanisms operate under more natural circumstances, for example in the context of the more complex and variable EOD interval patterns characteristic of behaving fish.</p><p>Our results are likely relevant to a number of other behavioral contexts and brain structures in which the cancellation of self-generated sensory inputs is known to occur. Negative images have been described in the active electrosensory system of mormyrid as well as gymnotid fish where they serve to cancel the effects of movements of the fish’s body as well as spatially redundant electrosensory signals resulting from interactions with conspecifics (<xref ref-type="bibr" rid="bib6">Bastian, 1996</xref>; <xref ref-type="bibr" rid="bib54">Requarth et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Requarth and Sawtell, 2014</xref>). Movements of the tail, for example, generate reafference by changing the position of the electric organ (located in the tail) relative to electroreceptors on the head and body. In the passive electrosensory system of elasmobranchs (the group that includes sharks and skates), negative images cancel the effects of swimming movements and respiration (<xref ref-type="bibr" rid="bib20">Bodznick et al., 1999</xref>). Cancellation of self-generated inputs has also been described in related cerebellum-like structures associated with the mechanosensory lateral line system in fish and the auditory system in mice (<xref ref-type="bibr" rid="bib50">Montgomery and Bodznick, 1994</xref>; <xref ref-type="bibr" rid="bib62">Singla et al., 2017</xref>). In all of these cases, generalization is expected to be vital in assuring that negative images remain accurate across different behavioral and/or environmental contexts.</p></sec><sec id="s3-2"><title>Mechanisms of generalization</title><p>Using a combined experimental and theoretical approach we identified two features that, when added to existing models of ELL, were sufficient to explain how negative images learned at one rate generalize to another. The first element was that synaptic plasticity from granule cells to ELL neurons be appropriately regularized. Regularization of learned parameters is ubiquitous in machine learning as a technique to prevent overfitting, or the learning of parameters that fit the idiosyncrasies and noise present in training data and therefore do not generalize well to new data (<xref ref-type="bibr" rid="bib19">Bishop, 2006</xref>). Consistent with this, in an ELL model lacking adequate regularization we found that ELL neurons could learn negative images at low EOD rates, however, cancellation at high (untrained) rates was poor. Although we do not have direct evidence for such regularization of synaptic plasticity in ELL, we note that there are a number of candidate mechanisms described in other systems. For example bounded synaptic strengths (<xref ref-type="bibr" rid="bib2">Amit and Fusi, 1992</xref>), discrete synaptic weights (<xref ref-type="bibr" rid="bib51">O'Connor et al., 2005</xref>; <xref ref-type="bibr" rid="bib52">Petersen et al., 1998</xref>), synaptic scaling (<xref ref-type="bibr" rid="bib64">Turrigiano, 2008</xref>), coupling of synaptic changes between nearby synapses (<xref ref-type="bibr" rid="bib33">Engert and Bonhoeffer, 1997</xref>), synaptic competition (<xref ref-type="bibr" rid="bib47">Miller, 1996</xref>), and various sources of noise (<xref ref-type="bibr" rid="bib5">Basalyga and Salinas, 2006</xref>), could all act as forms of regularization even if they are simply due to constraints on the system or have additional purposes. In our model we found that a constant decay of the strength of each synapse towards a baseline value worked best. This rule has the appealing property of being implementable locally at each synapse. However, our rule does require an explicit setting for the regularization decay rate. This parameter could itself be learned over a longer timescale, which would be a form of meta-plasticity (<xref ref-type="bibr" rid="bib1">Abraham and Bear, 1996</xref>) or meta-learning (<xref ref-type="bibr" rid="bib30">Doya, 2002</xref>). To our knowledge, little is currently known in any biological system regarding whether and how synaptic plasticity is regularized or about whether such regularization plays a role in generalization. Addressing these questions is an interesting challenge for future research that may be aided by emerging methods for directly visualizing morphology, activity, and synaptic proteins at the level of dendrites and spines (<xref ref-type="bibr" rid="bib57">Roth et al., 2017</xref>).</p><p>The second feature we identified as important for generalization is an approximate matching between the EOD rate dependence of electrosensory inputs to ELL output neurons and the rate dependence of the summed corollary discharge input that an output cell receives via the granule cells. In vivo recordings from ampullary electroreceptor afferents, ELL output neurons, mossy fibers, and granule cells provided direct evidence for such matching. The temporal dynamics of granule cell corollary discharge responses across EOD rates are, on average, much more similar to those of electroreceptor afferents than expected based on past recordings and modeling of granule cell responses to isolated EOD commands. This matching appears to be achieved via a variety of previously unknown EOD command rate dependencies in the inputs to granule cells. So-called early mossy fibers are known from previous studies to fire a highly-stereotyped burst of action potentials following each EOD command (<xref ref-type="bibr" rid="bib12">Bell et al., 1992</xref>). We found that the number of spikes in such bursts declines progressively with increases in the command rate. The multiple spikes in the burst seem redundant in the context of isolated EODs. Why would multiple spikes be needed to signal the time of occurrence of an EOD command? The present work suggests that rate-dependent grading of such bursts conveys information that is important for generalization.</p><p>We mainly focused on the command rate-dependence of so-called early mossy fiber inputs because these inputs are by far the most frequently encountered in our blind recordings. However, the command-rate dependence of less common elements such as unipolar brush cells and Golgi cells was also qualitatively consistent with the proposed matching. Determining the relative importance for generalization of these different sources of command-rate dependence (i.e. mossy fibers, unipolar brush cells, and Golgi cells) is difficult given that we lack methods for selectively targeting them for recordings or manipulations. We also cannot rule out the importance for generalization of other circuit elements not studied here and for which we lack sufficient physiological data under conditions of different EOD rates. Our model (like all past models of the mormyrid ELL) does not distinguish between two distinct classes of ELL neurons: glutamatergic output cells versus GABAergic MG cells which inhibit output cells. MG cells occupy an analogous position in the circuitry of the mormryid ELL as Purkinje cells in the teleost cerebellum and cartwheel cells in the dorsal cochlear nucleus (<xref ref-type="bibr" rid="bib16">Bell, 2002</xref>; <xref ref-type="bibr" rid="bib17">Bell et al., 2008</xref>). Importantly, both MG and output cells integrate electrosensory and corollary discharge input and both exhibit anti-Hebbian plasticity (<xref ref-type="bibr" rid="bib14">Bell et al., 1997a</xref>; <xref ref-type="bibr" rid="bib13">Bell et al., 1993</xref>; <xref ref-type="bibr" rid="bib44">Meek et al., 1996</xref>; <xref ref-type="bibr" rid="bib48">Mohr et al., 2003</xref>). However, it is presently unknown, even in the context of low EOD rates, how MG cells contribute to sensory cancellation and negative image formation. Our model also omits molecular layer interneurons and does not distinguish between E- and I-type output cells. Constructing a more complete and realistic model that includes these additional features is a focus of ongoing experimental and theoretical studies of the mormyrid ELL.</p><p>Generalization of negative images could be accomplished quite simply if both electrosensory and corollary discharge signals had a linear dependence on EOD rate. Responses of ampullary electroreceptor afferents, indeed, appear to exhibit a roughly linear dependence on EOD rate (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>). However, recordings from granule cells in mormyrid fish (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>; <xref ref-type="bibr" rid="bib55">Requarth and Sawtell, 2014</xref>; <xref ref-type="bibr" rid="bib59">Sawtell, 2010</xref>), as well as studies of cerebellar granule cells in mammals (<xref ref-type="bibr" rid="bib4">Barmack and Yakhnitsa, 2008</xref>; <xref ref-type="bibr" rid="bib26">Chabrol et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Chadderton et al., 2004</xref>; <xref ref-type="bibr" rid="bib58">Ruigrok et al., 2011</xref>), suggest that granule cells exhibit markedly nonlinear properties, including prominent rectification and burst firing. In our initial modeling we found that even when electrosensory and mossy fiber inputs both varied approximately linearly with EOD rate and inputs were summed linearly by model granule cells, the model failed to match the generalization performance seen in real ELL neurons. One reason for its failure is the nonlinearity introduced by the firing rate threshold of the granule cells. Whenever a threshold is applied, portions of a signal that are subthreshold at low repetition rates can become supra-threshold at higher rates due to temporal summation, resulting in nonlinear responses (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Rather than linearizing the granule cell population response, the EOD rate dependencies we found in mossy fiber inputs to granule cells actually introduce additional nonlinearities on top of the threshold linearity. It is the summed effect of these nonlinearities across the granule cell population that guarantees that an approximate negative image is always available in the scaled mean of the population activity. This may be a useful principle employed by other neural systems - encoding of approximate solutions across contexts in a robust manner, in this case through a simple average population activity, allowing flexible learning while maintaining information that supports generalization.</p></sec><sec id="s3-3"><title>Connections to generalization in other systems</title><p>The issue of generalization has been explored in the gymnotid ELL in the context of cancellation of spatially redundant electrosensory signals, such as those generated by tail movements or conspecifics (<xref ref-type="bibr" rid="bib21">Bol et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Mejias et al., 2013</xref>). Such cancellation is similar to that in the mormyrid ELL in that it is mediated by anti-Hebbian plasticity at synapses between granule cells and ELL neurons (<xref ref-type="bibr" rid="bib38">Harvey-Girard et al., 2010</xref>). However, cancellation in the gymnotid ELL is driven by proprioception or electrosensory feedback to granule cells rather than by corollary discharge (<xref ref-type="bibr" rid="bib7">Bastian et al., 2004</xref>; <xref ref-type="bibr" rid="bib27">Chacron et al., 2005</xref>). In vivo recordings from ELL neurons in gymnotids demonstrated that cancellation remains accurate over a wide range of stimulus contrasts (as might be produced by conspecifics at different distances) (<xref ref-type="bibr" rid="bib46">Mejias et al., 2013</xref>). Modeling was used to show how learning at one contrast could generalize to higher or lower contrasts, despite numerous nonlinearities in the system. Interestingly, features of the model identified to be important for such generalization are related to those described here for the mormyrid ELL, including granule cell response properties and a slow decay in parallel fiber synaptic strength (<xref ref-type="bibr" rid="bib46">Mejias et al., 2013</xref>; <xref ref-type="bibr" rid="bib43">Lewis and Maler, 2004</xref>), which can be considered a form of regularization. Although responses of granule cells have not yet been measured in vivo in gymnotids, several lines of evidence suggest that they are important in relation to the specificity and generalization of learning in the gymnotid ELL (<xref ref-type="bibr" rid="bib21">Bol et al., 2011</xref>; <xref ref-type="bibr" rid="bib46">Mejias et al., 2013</xref>).</p><p>A role for cerebellar granule cells in generalization has been suggested based on studies of motor learning. Adaptation of the vestibulo-ocular reflex (VOR) shows various patterns of generalization and specificity when training and testing are carried out at different head rotation frequencies or static head tilts (<xref ref-type="bibr" rid="bib22">Boyden et al., 2004</xref>). Under some experimental conditions, VOR learning has been shown to be quite specific to the training context (<xref ref-type="bibr" rid="bib3">Baker et al., 1987</xref>; <xref ref-type="bibr" rid="bib67">Yakushin et al., 2000</xref>). Such specificity can be explained by models in which learning is mediated by changes in granule cell inputs conveying highly-specific representations of the training context--for example, granule cells that fire for specific combination of head rotation and head tilt. Such hypotheses have not been directly tested in the context of the VOR or other forms of motor learning, however, numerous lines of evidence support the existence of highly-selective granule cell representations of this sort (<xref ref-type="bibr" rid="bib26">Chabrol et al., 2015</xref>; <xref ref-type="bibr" rid="bib40">Huang et al., 2013</xref>; <xref ref-type="bibr" rid="bib41">Ishikawa et al., 2015</xref>; <xref ref-type="bibr" rid="bib59">Sawtell, 2010</xref>). Generalization of VOR learning is also observed under some circumstances, for example when training at a high head rotation frequency and testing on a lower frequency (<xref ref-type="bibr" rid="bib22">Boyden et al., 2004</xref>). Broader tuning in granule cells could underlie generalization in such cases. Studies of generalization of VOR learning may be informed by recent characterizations of the statistics of vestibular input during natural behavior in primates and rodents (<xref ref-type="bibr" rid="bib23">Carriot et al., 2014</xref>, <xref ref-type="bibr" rid="bib24">Carriot et al., 2017</xref>).</p><p>It has been suggested that patterns of generalization in human motor learning, such as adaptation to force fields in reaching, can be explained by the tuning of a set of basis elements (<xref ref-type="bibr" rid="bib29">Donchin et al., 2003</xref>; <xref ref-type="bibr" rid="bib36">Ghahramani et al., 1996</xref>; <xref ref-type="bibr" rid="bib61">Shadmehr and Mussa-Ivaldi, 1994</xref>). Given their large numbers and the well-characterized plasticity of their parallel fiber synapses, granule cells are a natural candidate for such elements. To our knowledge, the present study is the first to directly relate responses of granule cells recorded during a learning task to generalization.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Experimental preparation</title><p>All experiments performed in this study adhere to the American Physiological Society’s Guiding Principles in the Care and Use of Animals and were approved by the Columbia University Institutional Animal Care and Use Committee, protocol AAAW4462. Mormyrid fish (7-12 cm in length) of the species <italic>Gnathonemus petersii</italic> were used in these experiments. Surgical procedures to expose the brain for recording were identical to those described previously (<xref ref-type="bibr" rid="bib10">Bell, 1982</xref>; <xref ref-type="bibr" rid="bib34">Enikolopov et al., 2018</xref>; <xref ref-type="bibr" rid="bib59">Sawtell, 2010</xref>). Gallamine triethiodide (Flaxedil) was given at the end of the surgery (∼20 μg / cm of body length) and the anesthetic (MS:222, 1:25,000) was removed. Aerated water was passed over the fish’s gills for respiration. Paralysis blocks the effect of electromotoneurons on the electric organ, preventing the EOD, but the motor command signal that would normally elicit an EOD continues to be emitted spontaneously at rates of 2-5 Hz. The timing of the EOD motor command can be measured precisely allowing the central effects of corollary discharge inputs to be observed in isolation from the electrosensory input that would normally result from the EOD. In a few experiments, recordings from electroreceptor afferents were performed in unparalyzed fish anesthetized with metomidate which leaves the fish’s EOD intact (<xref ref-type="bibr" rid="bib31">Engelmann et al., 2006</xref>).</p></sec><sec id="s4-2"><title>EOD command stimulation</title><p>We controlled the EOD motor command rate by targeting a concentric bipolar stimulating electrode (FHC, Bowdoin, ME) to the axon tract connecting the precommand nucleus to the EOD command nucleus, located near the ventral surface of the brainstem. The electrode was inserted at the midline through the corpus cerebellum just anterior to ELL (angled 22 degrees caudally in the sagittal plane) and lowered into the brain using a hydraulic manipulator until commands could be evoked by a strong stimulus (0.2 ms duration; 50 μA). The depth of the electrode was then fine-tuned until commands could be reliably evoked at short latencies by single pulses using minimal current (typically 5-15 μA). In most cases, such stimulation gave near perfect control over the timing of the EOD command. Occasionally, stimulation failed to evoke a command during high rate trains or the fish discharged spontaneously during a low rate train. However, these errors were easy to detect and were sufficiently infrequent that they were deemed negligible. Finally, microstimulation-evoked corollary discharge responses were indistinguishable from those evoked by the fish’s spontaneous commands at the level of field potentials, mossy fibers, and granule cells.</p></sec><sec id="s4-3"><title>Electrophysiology</title><p>The EOD motor command signal was recorded with an electrode placed over the electric organ. The command signal is the synchronized volley of electromotoneurons that would normally elicit an EOD in the absence of neuromuscular blockade. The command signal lasts about 3 ms and consists of a small negative wave followed by three larger biphasic waves. The latencies of central corollary discharge or command-evoked responses were measured with respect to the negative peak of the first large biphasic wave in the command signal.</p><p>Extracellular recordings from the VLZ were made with glass microelectrodes filled with 2M NaCl (8-30 M<inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>). Consistent with previous studies, ampullary afferents were encountered in the deeper layers of ELL (medial in our penetrations) and were characterized by highly regular spontaneous firing at ~50 Hz, the absence of any response to the EOD motor command, an excitatory responses to a stomach negative EOD mimic pulse (0.2-2 ms duration), and strong responses to small (&lt;1 μA), long duration (10-100 ms) electrosensory stimuli. Output cells were encountered in more superficial layers (on penetrations slightly lateral to those in which afferents were encountered) and were characterized by much lower and more irregular firing rates than ampullary afferents. E-cells showed increased firing in responses to a stomach negative EOD mimic pulse, while I-cells showed decreased firing. None of the E- or I-cells included in our analysis exhibited two distinct action potential waveforms, the hallmark of the other major cell type of in VLZ, the medium ganglion cells (<xref ref-type="bibr" rid="bib14">Bell et al., 1997a</xref>; <xref ref-type="bibr" rid="bib13">Bell et al., 1993</xref>). Hence these recordings are presumed to be from the efferent neurons of ELL.</p><p>Extracellular recordings from mossy fibers in EGp and in the paratrigeminal command-associated nucleus were made using glass microelectrodes filled with 2M NaCl (40-100 MΩ). For in vivo whole-cell recordings from EGp neurons patch electrodes (9-15 MΩ) were filled with an internal solution containing, in mM: K-gluconate (122); KCl (7); HEPES (10); Na2GTP (0.4); MgATP (4); EGTA (0.5), and 0.5% biocytin (pH 7.2, 280-290 mOsm). No correction was made for liquid junction potentials. Only cells with stable membrane potentials more hyperpolarized than -50 mV and access resistance &lt; 100 MΩ were analyzed. Membrane potentials were filtered at 3-10 kHz and digitized at 20 kHz (CED power1401 hardware and Spike2 software; Cambridge Electronics Design, Cambridge, UK).</p></sec><sec id="s4-4"><title>Pairing experiments</title><p>Cancellation and negative image formation was tested in E- and I-cells by pairing EOD commands with an EOD mimic pulse (0.2-2 ms wide square pulses; 1-5 μA) delivered at the delay at which the EOD would normally occur (4.5 ms after the EOD command). This delay was fixed and independent of command rate in our experiments. This is assumed to be the case under natural conditions as well, although to our knowledge, this has never been directly shown. EOD mimics were delivered using a dipole electrode positioned <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 2 mm from the skin within the unit’s receptive field. These methods are the same as those used previously to characterize negative images and sensory cancellation in the context of low command rates. In I cells, the EOD mimic often drove the firing rate to zero, making it difficult to quantify cancellation. To avoid this firing rate rectification, we reversed the EOD mimic polarity when recording from I cells, such that they responded with excitation instead of inhibition. This response reversal is due to known properties of ampullary electroreceptor afferents, which increase (or decrease) firing above (or below) their baseline rate for stimuli that make the pore of the receptor positive (or negative) with respect to the basal face within the body. Past studies have commonly used this approach to demonstrate the specificity of negative image formation in the VLZ by performing multiple pairing in the same neuron using opposite stimulus polarities (<xref ref-type="bibr" rid="bib8">Bell, 1981</xref>, <xref ref-type="bibr" rid="bib10">Bell, 1982</xref>; <xref ref-type="bibr" rid="bib34">Enikolopov et al., 2018</xref>). Negative images are invariably observed for both stimulus polarities in such experiments, that is responses to the corollary discharge alone after pairing are opposite in sign to the response to the stimulus during pairing. Systematic differences between negative images and cancellation in E versus I cells or for mimics of opposite polarities have never been noted, justifying this approach to avoid rectification.</p><p>Two types of pairing experiments were conducted. For the first type, pairing was performed across a range of rates (10, 40, and 60 Hz or 10, 30, and 50 Hz). Cancellation was assessed by comparing responses early and late during pairing which lasted 10-20 minutes. Negative images were assessed in a subset of cells by comparing responses to the command alone across rates before versus after pairing. Responses to identical trains of electrosensory stimuli presented independent of the command were also tested for each cell. In some cases, multiple pairings were conducted in the same cell after allowing 10-15 minutes for recovery from the effects of prior pairing. The second type of experiment was the same as described above except that pairing was only conducted at 10 Hz. Cancellation was assessed in these experiments by briefly (60-100 sec) probing responses at all three rates before and immediately after pairing at 10 Hz.</p></sec><sec id="s4-5"><title>Linear model of electroreceptor sequence responses</title><p>To test whether electroreceptor afferent responses to EOD sequences could be approximated as linear, we estimated the impulse response kernel, <inline-formula><mml:math id="inf3"><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, of each recorded unit from its response to an isolated EOD mimic. We first computed the average firing rate evoked by isolated EOD mimics (those separated by at least 150 ms). We treated this as an estimate of the impulse response of the recorded unit. To compute the predicted linear response, <inline-formula><mml:math id="inf4"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, we convolved this kernel with a series of delta functions centered on the times of the EOD mimics:<disp-formula id="equ1"><mml:math id="m1"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>*</mml:mi><mml:mi>δ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf5"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the times of the EOD commands in the sequence.</p></sec><sec id="s4-6"><title>Quantification of cancellation and generalization</title><p>To quantify cancellation and generalization, the degree of cancellation, <inline-formula><mml:math id="inf6"><mml:mi>C</mml:mi></mml:math></inline-formula>, was measured as the ratio of the total variance of the response to a sequence starting at time <inline-formula><mml:math id="inf7"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and ending at time <inline-formula><mml:math id="inf8"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, to an EOD command plus mimic sequence post pairing, <inline-formula><mml:math id="inf9"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, to that pre pairing,<inline-formula><mml:math id="inf10"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>:<disp-formula id="equ2"><mml:math id="m2"><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo>⟨</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>-</mml:mo><mml:mo>⟨</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>⟩</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:math></disp-formula></p></sec><sec id="s4-7"><title>Modeling granule cells</title><p>Our general approach to modeling granule cells follows that used previously (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). We generate model granule cell populations by random mixing of mossy fiber inputs, as described below. To extend this model to the case of different EOD command rates we also directly fit integrate-and-fire models to recordings of real granule cell responses, inferring the mossy fiber inputs at the same time. We then use information about rate dependencies in these mossy fiber inputs gleaned from this fitting procedure as well as from direct recordings of mossy fibers to show that rate-dependent changes in the inputs to granule cells can account for their responses to EOD command sequences. This information was then used to update the granule cell population model. The following sections describe these different modeling steps in more detail.</p></sec><sec id="s4-8"><title>Fitting granule cell voltage responses to EOD command sequences</title><p>When fitting models to real granule cell data we first removed stimulus artifacts caused by electromotor command nucleus stimulation as well as any spikes using a simple threshold on the gradient of the membrane voltage. We found that a gradient threshold of 1.8 mV/ms worked well. We used multiple methods and models to fit a set of 28 intracellularly recorded granule cell responses to EOD command sequences from 10 to 60 Hz. The basic model was an integrate-and-fire model with current based synapses. The parameters of the model were the membrane time constant, the leak potential, and synaptic parameters. Each cell could receive two inputs. Each input had the following parameters, a fast and a slow time constant, and a fast and a slow weight. This accounts for the fact that granule cell EPSPs often show a combination of fast and slow components. We allowed two inputs to permit both command-associated inputs and command-independent tonic inputs. The response of a model granule cell was given by<disp-formula id="equ3"><mml:math id="m3"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>V</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>δ</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula>where <inline-formula><mml:math id="inf11"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the time of the <inline-formula><mml:math id="inf12"><mml:mi>j</mml:mi></mml:math></inline-formula>-th spike of the <inline-formula><mml:math id="inf13"><mml:mi>i</mml:mi></mml:math></inline-formula>-th input and the synaptic kernels for each input are given by<disp-formula id="equ4"><label>(1)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mfrac><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mstyle></mml:mfrac></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mstyle></mml:mfrac><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mstyle></mml:mfrac></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>To fit granule cell models, we further needed to estimate the times of input spikes for each cell. We used multiple methods to make this input inference, all of which gave similar results. The first method was a wavelet-based detection method. We computed the continuous wavelet transform of the membrane voltage at 16 scales from 800 to 2000 Hz, using the MATLAB Wavelet Toolbox. We searched for times where the wavelet transform exhibited peaks at multiple scales and considered these times putative input spike times. We then combined peak locations into single putative input times if they were closer than 0.5 ms together. We then visually validated all of the data by checking if the input times detected by this procedure corresponded to clear upticks in the membrane voltage. We made corrections when it appeared an EPSP had occurred and then used both the corrected and uncorrected input times when fitting models and compared results. The qualitative results described in the main text did not depend on the input details at this level of accuracy. We used two different methods for estimating the parameters of granule cell models. Our results did not depend on which method was used. The first method was to use the putative input times we found, assume these were the actual input times to the granule cells, and then use least squares minimization to find the optimal parameters of the granule cell model, given these input times. The second method was to use these putative input times as an initialization for an MCMC method which then generated joint samples from the posterior distribution of granule cell model parameters and input times. We initialized the input times based on those found by the wavelet method. We then used Gibbs sampling to sample model parameters after a burn-in of 500 sweeps. Approximate sampling of input times was achieved by allowing the following moves: an input spike could be jittered around its current location, an input spike could be removed, and an input spike could be added. We placed priors on the total number of spikes based on the estimated number detected by the wavelet method to prevent the addition of many extra spikes. We also placed hard bounds on the parameters so that synaptic weights were always positive.</p></sec><sec id="s4-9"><title>Basic granule cell model</title><p>As in previous work (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>), we generated populations of model granule cells from a random mixing procedure based on the following assumptions. Each cell receives input from classes early (E), medium (M), late (L), pause (P) or tonic (T). (i) Each granule cell has three sites for mossy fiber synaptic inputs. (ii) The probabilities of a given input being of E, M, L, P and T type are given by <inline-formula><mml:math id="inf14"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>,<inline-formula><mml:math id="inf15"><mml:msub><mml:mrow> <mml:mi/><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf16"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf17"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf18"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, with <inline-formula><mml:math id="inf19"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. (iii) The type of input received at one mossy fiber-granule cell synapse is independent of that received at any other synapse. We used input type probabilities as calculated previously based on fits to individual granule cells (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>).</p><p>We introduced two sources of variability. We included trial to trial variability in the peak height of recorded single EPSPs from a normal distribution with <inline-formula><mml:math id="inf20"><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.224</mml:mn></mml:math></inline-formula> mV; during simulation of model granule cells, we sampled this distribution for each mossy fiber spike. Some granule cells further receive tonic mossy fiber inputs in addition to corollary discharge inputs. These inputs fire at high rates, independent of the EOD command. We included tonic input as previously, based on 72 tonic mossy fiber recordings.</p><p>For each model granule cell we randomly determined whether each potential connection to that model cell received early (<inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.425</mml:mn></mml:math></inline-formula>), medium (<inline-formula><mml:math id="inf22"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.075</mml:mn></mml:math></inline-formula>), late (<inline-formula><mml:math id="inf23"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula>), pause (<inline-formula><mml:math id="inf24"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula>), tonic (<inline-formula><mml:math id="inf25"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.157</mml:mn></mml:math></inline-formula>) or no input (<inline-formula><mml:math id="inf26"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.243</mml:mn></mml:math></inline-formula>), as in previous work. We then chose a particular mossy fiber response of the previously-determined class as the source of that input; we assumed that a connection is equally likely to be from any of the mossy fibers within a given class. These steps constitute the basic procedure for modeling populations of granule cells. The mossy fiber recordings we use to generate granule cells were based on responses to single EOD commands. To model the responses of these cells to EOD command sequences we needed to choose a method for predicting the responses of each mossy fiber to sequences of EOD commands. The following sections describe how this was achieved.</p><p>In the model granule cells we used synapses with fast and slow components. We used the same synapse model described above when fitting responses of real granule cells. The synaptic dynamics were described by <xref ref-type="disp-formula" rid="equ4">Equation 1</xref>. When generating model granule cell populations we had to choose values for the four parameters <inline-formula><mml:math id="inf27"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="inf29"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf30"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. These were chosen by fitting Gamma distributions to the values of these parameters obtained by fitting the granule cell model to granule cell data as described above. We then drew parameters randomly from these distributions for each model granule cell we generated. Parameters were the same for each input to a given granule cell, and the values of the four parameters were assumed to be independent.</p></sec><sec id="s4-10"><title>Model granule cell responses to EOD command sequences</title><p>To generate responses of model granule cells to EOD command sequences we needed to model the responses of each mossy fiber to that same sequence. We did not have a sufficiently large set of mossy fiber recordings from each class in response to EOD sequences at different rates to simply use these recordings directly as inputs to model granule cells. Instead we made simple models of how each of our previously recorded mossy fibers (whose responses only to isolated EOD commands we had recorded) would respond to EOD command sequences, based on actual responses to command sequences recorded from mossy fibers and UBCs in the present study. We considered two different models, referred to in the main text as the original model and the revised model. Medium, late and pause inputs were treated identically in the two models. Early and tonic inputs differed. For medium inputs we simply assumed that the set of spikes fired after each EOD command was the same, no matter where that command came in a sequence. This meant that spikes due to one command could overlap with spikes from subsequent commands, which we allowed, although we checked that this did not result in unrealistic firing rates of medium mossy fibers. Late inputs are characterized by a delay in firing after a command followed by a period of spiking. To model the response of a late mossy fiber to EOD command sequences we assumed that the firing delays accumulated if they overlapped. This amounts to computing the spiking response of a late mossy fiber to an EOD command sequence by starting at the first command in the sequence and proceeding through the sequence, allowing the delay in firing following a command to prevent spikes that would otherwise have been caused by the previous command. For pause mossy fibers we estimated the length of the pause in tonic firing induced by each command. To create the response of the fiber to an EOD command sequence we drew randomly from the empirical inter-spike interval of the fiber and populated the period of the sequence with spikes. We then deleted spikes occurring within the estimated pause period after any EOD command in the sequence. This naturally gave rise to cessation of firing at high EOD command frequencies, due to accumulation of pausing. Similar responses at high command rates were observed in recorded pause mossy fibers.</p></sec><sec id="s4-11"><title>Early and tonic mossy fiber are treated differently in the two models</title><p>The key differences between the original and revised models were in the way we treated early mossy fiber inputs and tonic mossy fiber inputs. Recordings from early mossy fibers as well as mossy fiber inputs inferred from granule cell recordings showed that early mossy fibers tend to fire progressively fewer spikes per EOD command during high-frequency command sequences and that tonic mossy fibers also tend to fire at a progressively lower rate during high frequency EOD sequences. The original model does not take these new findings into account, whereas the revised model does. In the original model we assume that early mossy fibers fire the exact same burst of spikes (known from recorded responses to single EOD commands) after each command in a sequence and we create tonic mossy fiber spike trains in response to EOD command sequences by sampling from estimated inter-spike interval distributions for each recorded tonic mossy fiber. In the revised model, the fraction of spikes fired by each early mossy fiber following each EOD command, compared to the number fired after an isolated EOD command, was a function of recent EOD command history. The fraction <italic>f</italic> relaxed to 1 with a characteristic timescale (80 ms) and is reduced by a factor <inline-formula><mml:math id="inf31"><mml:mi>α</mml:mi></mml:math></inline-formula>= <inline-formula><mml:math id="inf32"><mml:mn>0.72</mml:mn></mml:math></inline-formula> following each EOD command:<disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>f</mml:mi></mml:math></disp-formula>and <inline-formula><mml:math id="inf33"><mml:mi>f</mml:mi><mml:mo>→</mml:mo><mml:mi>α</mml:mi><mml:mi>f</mml:mi></mml:math></inline-formula> after each EOD command. These parameters were chosen to approximately match the dropping observed in recorded responses of early mossy fibers to EOD command sequences. In the revised model we modified the responses of tonic mossy fibers by removing a number of spikes from the spike train based on the recent EOD command rate (computed over the last 100 ms). The decrease in tonic firing was again based on recorded tonic mossy fiber responses to EOD sequences. Tonic firing rates were decreased linearly from their maximum rate at an EOD command frequency of 10 Hz to 0.6 times their maximum rate at an EOD command frequency of 60 Hz.</p></sec><sec id="s4-12"><title>Additional granule-cell responses types</title><p>Not all granule cells from the revised model population behaved in the same way. For example, a minority of cells, specifically those receiving previously described medium mossy fiber inputs active at intermediate delays, integrate and fire more spikes at high EOD command rates. Only 2 of the 28 recorded granule cells received a medium input, consistent with the small proportion of medium inputs found previously (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). One of these cells, indeed, exhibited prominent summation and increased spiking at high rates. However, given the small proportion of medium inputs, a much larger number of actual granule cells would have to be recorded to determine whether such response types are a consistent feature of real granule cells.</p></sec><sec id="s4-13"><title>Synaptic plasticity</title><p>As in previous work we modeled the membrane potential of ELL neurons, <inline-formula><mml:math id="inf34"><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, as a passive, current-based leaky unit receiving excitatory input from 20,000 model granule cells <inline-formula><mml:math id="inf35"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and sensory input <inline-formula><mml:math id="inf36"><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, with anti-Hebbian spike-timing dependent plasticity at granule cell-ELL neuron synapses with weights <inline-formula><mml:math id="inf37"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and EPSP kernel <inline-formula><mml:math id="inf38"><mml:mi>E</mml:mi></mml:math></inline-formula> fit to recorded granule cell-evoked EPSPs (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>). As discussed above, we adjusted the polarity of the sensory stimulus such that excitation was evoked in both E and I cells. Hence, no distinction was made in the model between E and I cells. The granule cell-ELL neuron learning rule has the form <inline-formula><mml:math id="inf39"><mml:msup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> where <inline-formula><mml:math id="inf40"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> determines the time dependence of associative depression. Theoretical analysis has shown that the negative images are guaranteed to be stable when <inline-formula><mml:math id="inf42"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf43"><mml:mi>E</mml:mi></mml:math></inline-formula> is the EPSP from granule cells to the ELL neuron (Roberts and Bell 2000). The timescale of <inline-formula><mml:math id="inf44"><mml:mi>E</mml:mi></mml:math></inline-formula> agrees with learning rules fit to experimental data, thus we set <inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi></mml:math></inline-formula>. We further included a regularization term as mentioned in the main text. This regularization is equivalent to a constant decay of each synaptic weight toward a baseline value that is the same for all synapses. Using this approach, the rate of change of <inline-formula><mml:math id="inf46"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is equal to <inline-formula><mml:math id="inf47"><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msub><mml:mo>∫</mml:mo><mml:mi>V</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>E</mml:mi><mml:mi>*</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, where the integral is over the period of the EOD command sequence being paired. The regularization constant <inline-formula><mml:math id="inf48"><mml:mi>λ</mml:mi></mml:math></inline-formula> sets the time constant, <inline-formula><mml:math id="inf49"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>, for the decay of synaptic weights to the baseline value <inline-formula><mml:math id="inf50"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The values of <inline-formula><mml:math id="inf51"><mml:mi>λ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf52"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> chosen here were selected by hand in order to match the experimental data. The model introduces these two parameters as a minimal extension of our previous model which can account for the experimental results. See the Discussion for thoughts about how these parameters might be set in the biological system.</p><p>We used <inline-formula><mml:math id="inf53"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi>s</mml:mi></mml:math></inline-formula> in the case of full regularization and <inline-formula><mml:math id="inf54"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1000</mml:mn><mml:mi>s</mml:mi></mml:math></inline-formula> for minimal regularization. The value used with full regularization was chosen to bring the overall performance of the model when generalizing as close to that found in the data without compromising cancellation at 10 Hz to the point where the model could not cancel as well as the data. The value used with minimal regularization was chosen to prevent unrealistically large weights from being learned. We chose the value of <inline-formula><mml:math id="inf55"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> depending on the ELL neuron being modeled so that the mean model granule cell response scaled by <inline-formula><mml:math id="inf56"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was approximately equal to the negative of the sensory input to the ELL neuron, that is such that <inline-formula><mml:math id="inf57"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mfenced close="⟩" open="⟨" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>≈</mml:mo><mml:mo>-</mml:mo><mml:mi>s</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. <inline-formula><mml:math id="inf58"><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf59"><mml:msup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> were taken from previous work, where they were fit to negative images recorded experimentally (<xref ref-type="bibr" rid="bib42">Kennedy et al., 2014</xref>).</p></sec></sec></body><back><ack id="ack"><title>Acknowledgments</title><p>This work was supported by grants from the NSF (1025849) to NBS and LFA and NIH (NS075023) to NBS and by the Irma T Hirschl Trust. LFA was further supported by the Simons and Gatsby Charitable Foundations and by NSF NeuroNex Award DBI-1707398.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Investigation, Methodology, Writing—original draft</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Supervision, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Funding acquisition, Investigation, Methodology, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>Animal experimentation: All experiments performed in this study adhere to the American Physiological Society's Guiding Principles in the Care and Use of Animals and were approved by the Columbia University Institutional Animal Care and Use Committee, protocol AAAW4462.</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><object-id pub-id-type="doi">10.7554/eLife.44032.018</object-id><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-44032-transrepform-v3.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>Data and model code are available via Zenodo (doi: 10.5281/zenodo.2590782).</p><p>The following dataset was generated:</p><p><element-citation id="dataset1" publication-type="data" specific-use="isSupplementedBy"><person-group person-group-type="author"><name><surname>Nathaniel</surname><given-names>Sawtell</given-names></name><name><surname>Conor</surname><given-names>Dempsey</given-names></name><name><surname>Larry</surname><given-names>F Abbott</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Data and model associated with &quot;Generalization of learned responses in the mormyrid electrosensory lobe&quot; published in eLife</data-title><source>Zenodo</source><pub-id assigning-authority="Zenodo" pub-id-type="doi">10.5281/zenodo.2590782</pub-id></element-citation></p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abraham</surname> <given-names>WC</given-names></name><name><surname>Bear</surname> <given-names>MF</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Metaplasticity: the plasticity of synaptic plasticity</article-title><source>Trends in Neurosciences</source><volume>19</volume><fpage>126</fpage><lpage>130</lpage><pub-id pub-id-type="doi">10.1016/S0166-2236(96)80018-X</pub-id><pub-id pub-id-type="pmid">8658594</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amit</surname> <given-names>DJ</given-names></name><name><surname>Fusi</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Constraints on learning in dynamic synapses</article-title><source>Network: Computation in Neural Systems</source><volume>3</volume><fpage>443</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1088/0954-898X_3_4_008</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname> <given-names>J</given-names></name><name><surname>Wickland</surname> <given-names>C</given-names></name><name><surname>Peterson</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Dependence of cat vestibulo-ocular reflex direction adaptation on animal orientation during adaptation and rotation in darkness</article-title><source>Brain Research</source><volume>408</volume><fpage>339</fpage><lpage>343</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(87)90401-X</pub-id><pub-id pub-id-type="pmid">3594223</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barmack</surname> <given-names>NH</given-names></name><name><surname>Yakhnitsa</surname> <given-names>V</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Functions of interneurons in mouse cerebellum</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>1140</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3942-07.2008</pub-id><pub-id pub-id-type="pmid">18234892</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basalyga</surname> <given-names>G</given-names></name><name><surname>Salinas</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>When response variability increases neural network robustness to synaptic noise</article-title><source>Neural Computation</source><volume>18</volume><fpage>1349</fpage><lpage>1379</lpage><pub-id pub-id-type="doi">10.1162/neco.2006.18.6.1349</pub-id><pub-id pub-id-type="pmid">16764507</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastian</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Plasticity in an electrosensory system. I. general features of a dynamic sensory filter</article-title><source>Journal of Neurophysiology</source><volume>76</volume><fpage>2483</fpage><lpage>2496</lpage><pub-id pub-id-type="doi">10.1152/jn.1996.76.4.2483</pub-id><pub-id pub-id-type="pmid">8899621</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bastian</surname> <given-names>J</given-names></name><name><surname>Chacron</surname> <given-names>MJ</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Plastic and nonplastic pyramidal cells perform unique roles in a network capable of adaptive redundancy reduction</article-title><source>Neuron</source><volume>41</volume><fpage>767</fpage><lpage>779</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(04)00071-6</pub-id><pub-id pub-id-type="pmid">15003176</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>An efference copy which is modified by reafferent input</article-title><source>Science</source><volume>214</volume><fpage>450</fpage><lpage>453</lpage><pub-id pub-id-type="doi">10.1126/science.7291985</pub-id><pub-id pub-id-type="pmid">7291985</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Finger</surname> <given-names>TE</given-names></name><name><surname>Russell</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Central connections of the posterior lateral line lobe in mormyrid fish</article-title><source>Experimental Brain Research</source><volume>42</volume><fpage>9</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1007/BF00235724</pub-id><pub-id pub-id-type="pmid">6163655</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Properties of a modifiable efference copy in an electric fish</article-title><source>Journal of Neurophysiology</source><volume>47</volume><fpage>1043</fpage><lpage>1056</lpage><pub-id pub-id-type="doi">10.1152/jn.1982.47.6.1043</pub-id><pub-id pub-id-type="pmid">7108570</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Libouban</surname> <given-names>S</given-names></name><name><surname>Szabo</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Neural pathways related to the electric organ discharge command in mormyrid fish</article-title><source>The Journal of Comparative Neurology</source><volume>216</volume><fpage>327</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1002/cne.902160309</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Serrier</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Corollary discharge effects and sensory processing in the mormyrid electrosensory lobe: I. field potentials and cellular activity in associated structures</article-title><source>Journal of Neurophysiology</source><volume>68</volume><fpage>843</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1152/jn.1992.68.3.843</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Caputi</surname> <given-names>A</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Serrier</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Storage of a sensory pattern by anti-Hebbian synaptic plasticity in an electric fish</article-title><source>PNAS</source><volume>90</volume><fpage>4650</fpage><lpage>4654</lpage><pub-id pub-id-type="doi">10.1073/pnas.90.10.4650</pub-id><pub-id pub-id-type="pmid">8506312</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Caputi</surname> <given-names>A</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1997">1997a</year><article-title>Physiology and plasticity of morphologically identified cells in the mormyrid electrosensory lobe</article-title><source>The Journal of Neuroscience</source><volume>17</volume><fpage>6409</fpage><lpage>6423</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.17-16-06409.1997</pub-id><pub-id pub-id-type="pmid">9236249</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Han</surname> <given-names>VZ</given-names></name><name><surname>Sugawara</surname> <given-names>Y</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="1997">1997b</year><article-title>Synaptic plasticity in a cerebellum-like structure depends on temporal order</article-title><source>Nature</source><volume>387</volume><fpage>278</fpage><lpage>281</lpage><pub-id pub-id-type="doi">10.1038/387278a0</pub-id><pub-id pub-id-type="pmid">9153391</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Evolution of cerebellum-like structures</article-title><source>Brain, Behavior and Evolution</source><volume>59</volume><fpage>312</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1159/000063567</pub-id><pub-id pub-id-type="pmid">12207086</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Han</surname> <given-names>V</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cerebellum-like structures and their implications for cerebellar function</article-title><source>Annual Review of Neuroscience</source><volume>31</volume><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.30.051606.094225</pub-id><pub-id pub-id-type="pmid">18275284</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bell</surname> <given-names>CC</given-names></name><name><surname>Russell</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="1978">1978</year><article-title>Effect of electric organ discharge on ampullary receptors in a mormyrid</article-title><source>Brain Research</source><volume>145</volume><fpage>85</fpage><lpage>96</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(78)90798-9</pub-id><pub-id pub-id-type="pmid">638785</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bishop</surname> <given-names>CM</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Pattern Recognition and Machine Learning (Information Science and Statistics)</source><publisher-name>Springer-Verlag</publisher-name></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bodznick</surname> <given-names>D</given-names></name><name><surname>Montgomery</surname> <given-names>JC</given-names></name><name><surname>Carey</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Adaptive mechanisms in the elasmobranch hindbrain</article-title><source>The Journal of Experimental Biology</source><volume>202</volume><fpage>1357</fpage><lpage>1364</lpage><pub-id pub-id-type="pmid">10210676</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bol</surname> <given-names>K</given-names></name><name><surname>Marsat</surname> <given-names>G</given-names></name><name><surname>Harvey-Girard</surname> <given-names>E</given-names></name><name><surname>Longtin</surname> <given-names>A</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Frequency-tuned cerebellar channels and burst-induced LTD lead to the cancellation of redundant sensory inputs</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>11028</fpage><lpage>11038</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0193-11.2011</pub-id><pub-id pub-id-type="pmid">21795551</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boyden</surname> <given-names>ES</given-names></name><name><surname>Katoh</surname> <given-names>A</given-names></name><name><surname>Raymond</surname> <given-names>JL</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Cerebellum-dependent learning: the role of multiple plasticity mechanisms</article-title><source>Annual Review of Neuroscience</source><volume>27</volume><fpage>581</fpage><lpage>609</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.27.070203.144238</pub-id><pub-id pub-id-type="pmid">15217344</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carriot</surname> <given-names>J</given-names></name><name><surname>Jamali</surname> <given-names>M</given-names></name><name><surname>Chacron</surname> <given-names>MJ</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Statistics of the vestibular input experienced during natural self-motion: implications for neural processing</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>8347</fpage><lpage>8357</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0692-14.2014</pub-id><pub-id pub-id-type="pmid">24920638</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carriot</surname> <given-names>J</given-names></name><name><surname>Jamali</surname> <given-names>M</given-names></name><name><surname>Chacron</surname> <given-names>MJ</given-names></name><name><surname>Cullen</surname> <given-names>KE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The statistics of the vestibular input experienced during natural self-motion differ between rodents and primates</article-title><source>The Journal of Physiology</source><volume>595</volume><fpage>2751</fpage><lpage>2766</lpage><pub-id pub-id-type="doi">10.1113/JP273734</pub-id><pub-id pub-id-type="pmid">28083981</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Censor</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Generalization of perceptual and motor learning: a causal link with memory encoding and consolidation?</article-title><source>Neuroscience</source><volume>250</volume><fpage>201</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2013.06.062</pub-id><pub-id pub-id-type="pmid">23850685</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chabrol</surname> <given-names>FP</given-names></name><name><surname>Arenz</surname> <given-names>A</given-names></name><name><surname>Wiechert</surname> <given-names>MT</given-names></name><name><surname>Margrie</surname> <given-names>TW</given-names></name><name><surname>DiGregorio</surname> <given-names>DA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Synaptic diversity enables temporal coding of coincident multisensory inputs in single neurons</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>718</fpage><lpage>727</lpage><pub-id pub-id-type="doi">10.1038/nn.3974</pub-id><pub-id pub-id-type="pmid">25821914</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chacron</surname> <given-names>MJ</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name><name><surname>Bastian</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Feedback and feedforward control of frequency tuning to naturalistic stimuli</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>5521</fpage><lpage>5532</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0445-05.2005</pub-id><pub-id pub-id-type="pmid">15944380</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chadderton</surname> <given-names>P</given-names></name><name><surname>Margrie</surname> <given-names>TW</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Integration of quanta in cerebellar granule cells during sensory processing</article-title><source>Nature</source><volume>428</volume><fpage>856</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1038/nature02442</pub-id><pub-id pub-id-type="pmid">15103377</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donchin</surname> <given-names>O</given-names></name><name><surname>Francis</surname> <given-names>JT</given-names></name><name><surname>Shadmehr</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Quantifying generalization from trial-by-trial behavior of adaptive systems that learn with basis functions: theory and experiments in human motor control</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>9032</fpage><lpage>9045</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-27-09032.2003</pub-id><pub-id pub-id-type="pmid">14534237</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doya</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Metalearning and neuromodulation</article-title><source>Neural Networks</source><volume>15</volume><fpage>495</fpage><lpage>506</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(02)00044-8</pub-id><pub-id pub-id-type="pmid">12371507</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelmann</surname> <given-names>J</given-names></name><name><surname>Bacelo</surname> <given-names>J</given-names></name><name><surname>van den Burg</surname> <given-names>E</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Sensory and motor effects of etomidate anesthesia</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>1231</fpage><lpage>1243</lpage><pub-id pub-id-type="doi">10.1152/jn.00405.2005</pub-id><pub-id pub-id-type="pmid">16267119</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engelmann</surname> <given-names>J</given-names></name><name><surname>Gertz</surname> <given-names>S</given-names></name><name><surname>Goulet</surname> <given-names>J</given-names></name><name><surname>Schuh</surname> <given-names>A</given-names></name><name><surname>von der Emde</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Coding of stimuli by ampullary afferents in <italic>Gnathonemus petersii</italic></article-title><source>Journal of Neurophysiology</source><volume>104</volume><fpage>1955</fpage><lpage>1968</lpage><pub-id pub-id-type="doi">10.1152/jn.00503.2009</pub-id><pub-id pub-id-type="pmid">20685928</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engert</surname> <given-names>F</given-names></name><name><surname>Bonhoeffer</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Synapse specificity of long-term potentiation breaks down at short distances</article-title><source>Nature</source><volume>388</volume><fpage>279</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1038/40870</pub-id><pub-id pub-id-type="pmid">9230437</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Enikolopov</surname> <given-names>AG</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Internally generated predictions enhance neural and behavioral detection of sensory stimuli in an electric fish</article-title><source>Neuron</source><volume>99</volume><fpage>135</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.06.006</pub-id><pub-id pub-id-type="pmid">30001507</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fahle</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Perceptual learning: specificity versus generalization</article-title><source>Current Opinion in Neurobiology</source><volume>15</volume><fpage>154</fpage><lpage>160</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2005.03.010</pub-id><pub-id pub-id-type="pmid">15831396</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghahramani</surname> <given-names>Z</given-names></name><name><surname>Wolpert</surname> <given-names>DM</given-names></name><name><surname>Jordan</surname> <given-names>MI</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Generalization to local remappings of the visuomotor coordinate transformation</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>7085</fpage><lpage>7096</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-21-07085.1996</pub-id><pub-id pub-id-type="pmid">8824344</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname> <given-names>VZ</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Reversible associative depression and nonassociative potentiation at a parallel fiber synapse</article-title><source>Neuron</source><volume>27</volume><fpage>611</fpage><lpage>622</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)00070-2</pub-id><pub-id pub-id-type="pmid">11055442</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harvey-Girard</surname> <given-names>E</given-names></name><name><surname>Lewis</surname> <given-names>J</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Burst-induced anti-Hebbian depression acts through short-term synaptic dynamics to cancel redundant sensory signals</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>6152</fpage><lpage>6169</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0303-10.2010</pub-id><pub-id pub-id-type="pmid">20427673</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hofmann</surname> <given-names>V</given-names></name><name><surname>Geurten</surname> <given-names>BR</given-names></name><name><surname>Sanguinetti-Scheck</surname> <given-names>JI</given-names></name><name><surname>Gómez-Sena</surname> <given-names>L</given-names></name><name><surname>Engelmann</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Motor patterns during active electrosensory acquisition</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>8</volume><elocation-id>186</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2014.00186</pub-id><pub-id pub-id-type="pmid">24904337</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>CC</given-names></name><name><surname>Sugino</surname> <given-names>K</given-names></name><name><surname>Shima</surname> <given-names>Y</given-names></name><name><surname>Guo</surname> <given-names>C</given-names></name><name><surname>Bai</surname> <given-names>S</given-names></name><name><surname>Mensh</surname> <given-names>BD</given-names></name><name><surname>Nelson</surname> <given-names>SB</given-names></name><name><surname>Hantman</surname> <given-names>AW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Convergence of pontine and proprioceptive streams onto multimodal cerebellar granule cells</article-title><source>eLife</source><volume>2</volume><elocation-id>e00400</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.00400</pub-id><pub-id pub-id-type="pmid">23467508</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ishikawa</surname> <given-names>T</given-names></name><name><surname>Shimuta</surname> <given-names>M</given-names></name><name><surname>Häusser</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Multimodal sensory integration in single cerebellar granule cells in vivo</article-title><source>eLife</source><volume>4</volume><elocation-id>e12916</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12916</pub-id><pub-id pub-id-type="pmid">26714108</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kennedy</surname> <given-names>A</given-names></name><name><surname>Wayne</surname> <given-names>G</given-names></name><name><surname>Kaifosh</surname> <given-names>P</given-names></name><name><surname>Alviña</surname> <given-names>K</given-names></name><name><surname>Abbott</surname> <given-names>LF</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A temporal basis for predicting the sensory consequences of motor commands in an electric fish</article-title><source>Nature Neuroscience</source><volume>17</volume><fpage>416</fpage><lpage>422</lpage><pub-id pub-id-type="doi">10.1038/nn.3650</pub-id><pub-id pub-id-type="pmid">24531306</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname> <given-names>JE</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Synaptic dynamics on different time scales in a parallel fiber feedback pathway of the weakly electric fish</article-title><source>Journal of Neurophysiology</source><volume>91</volume><fpage>1064</fpage><lpage>1070</lpage><pub-id pub-id-type="doi">10.1152/jn.00856.2003</pub-id><pub-id pub-id-type="pmid">14602840</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meek</surname> <given-names>J</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Sugawara</surname> <given-names>Y</given-names></name><name><surname>Hafmans</surname> <given-names>TG</given-names></name><name><surname>Veron</surname> <given-names>M</given-names></name><name><surname>Denizot</surname> <given-names>JP</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Interneurons of the ganglionic layer in the mormyrid electrosensory lateral line lobe: morphology, immunohistochemistry, and synaptology</article-title><source>The Journal of Comparative Neurology</source><volume>375</volume><fpage>43</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1096-9861(19961104)375:1&lt;43::AID-CNE3&gt;3.0.CO;2-O</pub-id><pub-id pub-id-type="pmid">8913892</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meek</surname> <given-names>J</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name><name><surname>Bell</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Structural organization of the mormyrid electrosensory lateral line lobe</article-title><source>The Journal of Experimental Biology</source><volume>202</volume><fpage>1291</fpage><lpage>1300</lpage><pub-id pub-id-type="pmid">10210669</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mejias</surname> <given-names>JF</given-names></name><name><surname>Marsat</surname> <given-names>G</given-names></name><name><surname>Bol</surname> <given-names>K</given-names></name><name><surname>Maler</surname> <given-names>L</given-names></name><name><surname>Longtin</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Learning contrast-invariant cancellation of redundant signals in neural systems</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003180</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003180</pub-id><pub-id pub-id-type="pmid">24068898</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname> <given-names>KD</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Synaptic economics: competition and cooperation in synaptic plasticity</article-title><source>Neuron</source><volume>17</volume><fpage>371</fpage><lpage>374</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(00)80169-5</pub-id><pub-id pub-id-type="pmid">8816700</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohr</surname> <given-names>C</given-names></name><name><surname>Roberts</surname> <given-names>PD</given-names></name><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>The mormyromast region of the mormyrid electrosensory lobe. I. responses to corollary discharge and electrosensory stimuli</article-title><source>Journal of Neurophysiology</source><volume>90</volume><fpage>1193</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1152/jn.00211.2003</pub-id><pub-id pub-id-type="pmid">12904505</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moller</surname> <given-names>P</given-names></name><name><surname>Serrier</surname> <given-names>J</given-names></name><name><surname>Bowling</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Electric organ discharge displays during social encounter in the weakly electric fish brienomyrus Niger L. (Mormyridae)</article-title><source>Ethology</source><volume>82</volume><fpage>177</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1111/j.1439-0310.1989.tb00498.x</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montgomery</surname> <given-names>JC</given-names></name><name><surname>Bodznick</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>An adaptive filter that cancels self-induced noise in the electrosensory and lateral line mechanosensory systems of fish</article-title><source>Neuroscience Letters</source><volume>174</volume><fpage>145</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1016/0304-3940(94)90007-8</pub-id><pub-id pub-id-type="pmid">7970170</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Connor</surname> <given-names>DH</given-names></name><name><surname>Wittenberg</surname> <given-names>GM</given-names></name><name><surname>Wang</surname> <given-names>SS</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Graded bidirectional synaptic plasticity is composed of switch-like unitary events</article-title><source>PNAS</source><volume>102</volume><fpage>9679</fpage><lpage>9684</lpage><pub-id pub-id-type="doi">10.1073/pnas.0502332102</pub-id><pub-id pub-id-type="pmid">15983385</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Petersen</surname> <given-names>CC</given-names></name><name><surname>Malenka</surname> <given-names>RC</given-names></name><name><surname>Nicoll</surname> <given-names>RA</given-names></name><name><surname>Hopfield</surname> <given-names>JJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>All-or-none potentiation at CA3-CA1 synapses</article-title><source>PNAS</source><volume>95</volume><fpage>4732</fpage><lpage>4737</lpage><pub-id pub-id-type="doi">10.1073/pnas.95.8.4732</pub-id><pub-id pub-id-type="pmid">9539807</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poggio</surname> <given-names>T</given-names></name><name><surname>Bizzi</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Generalization in vision and motor control</article-title><source>Nature</source><volume>431</volume><fpage>768</fpage><lpage>774</lpage><pub-id pub-id-type="doi">10.1038/nature03014</pub-id><pub-id pub-id-type="pmid">15483597</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Requarth</surname> <given-names>T</given-names></name><name><surname>Kaifosh</surname> <given-names>P</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A role for mixed corollary discharge and proprioceptive signals in predicting the sensory consequences of movements</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>16103</fpage><lpage>16116</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2751-14.2014</pub-id><pub-id pub-id-type="pmid">25429151</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Requarth</surname> <given-names>T</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Plastic corollary discharge predicts sensory consequences of movements in a cerebellum-like circuit</article-title><source>Neuron</source><volume>82</volume><fpage>896</fpage><lpage>907</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2014.03.025</pub-id><pub-id pub-id-type="pmid">24853945</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname> <given-names>PD</given-names></name><name><surname>Bell</surname> <given-names>CC</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Computational consequences of temporally asymmetric learning rules: ii. sensory image cancellation</article-title><source>Journal of Computational Neuroscience</source><volume>9</volume><fpage>67</fpage><lpage>83</lpage><pub-id pub-id-type="doi">10.1023/A:1008938428112</pub-id><pub-id pub-id-type="pmid">10946993</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname> <given-names>RH</given-names></name><name><surname>Zhang</surname> <given-names>Y</given-names></name><name><surname>Huganir</surname> <given-names>RL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Dynamic imaging of AMPA receptor trafficking in vitro and in vivo</article-title><source>Current Opinion in Neurobiology</source><volume>45</volume><fpage>51</fpage><lpage>58</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2017.03.008</pub-id><pub-id pub-id-type="pmid">28411409</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruigrok</surname> <given-names>TJ</given-names></name><name><surname>Hensbroek</surname> <given-names>RA</given-names></name><name><surname>Simpson</surname> <given-names>JI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spontaneous activity signatures of morphologically identified interneurons in the vestibulocerebellum</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>712</fpage><lpage>724</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1959-10.2011</pub-id><pub-id pub-id-type="pmid">21228180</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Multimodal integration in granule cells as a basis for associative plasticity and sensory prediction in a cerebellum-like circuit</article-title><source>Neuron</source><volume>66</volume><fpage>573</fpage><lpage>584</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.04.018</pub-id><pub-id pub-id-type="pmid">20510861</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwarz</surname> <given-names>S</given-names></name><name><surname>von der Emde</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Distance discrimination during active electrolocation in the weakly electric fish <italic>Gnathonemus petersii</italic></article-title><source>Journal of Comparative Physiology A: Sensory, Neural, and Behavioral Physiology</source><volume>186</volume><fpage>1185</fpage><lpage>1197</lpage><pub-id pub-id-type="doi">10.1007/s003590000170</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname> <given-names>R</given-names></name><name><surname>Mussa-Ivaldi</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Adaptive representation of dynamics during learning of a motor task</article-title><source>The Journal of Neuroscience</source><volume>14</volume><fpage>3208</fpage><lpage>3224</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.14-05-03208.1994</pub-id><pub-id pub-id-type="pmid">8182467</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singla</surname> <given-names>S</given-names></name><name><surname>Dempsey</surname> <given-names>C</given-names></name><name><surname>Warren</surname> <given-names>R</given-names></name><name><surname>Enikolopov</surname> <given-names>AG</given-names></name><name><surname>Sawtell</surname> <given-names>NB</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A cerebellum-like circuit in the auditory system cancels responses to self-generated sounds</article-title><source>Nature Neuroscience</source><volume>20</volume><fpage>943</fpage><lpage>950</lpage><pub-id pub-id-type="doi">10.1038/nn.4567</pub-id><pub-id pub-id-type="pmid">28530663</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Toerring</surname> <given-names>MJ</given-names></name><name><surname>Moller</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="1984">1984</year><article-title>Locomotor and electric displays associated with electrolocation during exploratory behavior in mormyrid fish</article-title><source>Behavioural Brain Research</source><volume>12</volume><fpage>291</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1016/0166-4328(84)90155-4</pub-id><pub-id pub-id-type="pmid">6540586</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turrigiano</surname> <given-names>GG</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The self-tuning neuron: synaptic scaling of excitatory synapses</article-title><source>Cell</source><volume>135</volume><fpage>422</fpage><lpage>435</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2008.10.008</pub-id><pub-id pub-id-type="pmid">18984155</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von der Emde</surname> <given-names>G</given-names></name><name><surname>Sena</surname> <given-names>LG</given-names></name><name><surname>Niso</surname> <given-names>R</given-names></name><name><surname>Grant</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>The midbrain precommand nucleus of the mormyrid electromotor network</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>5483</fpage><lpage>5495</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.20-14-05483.2000</pub-id><pub-id pub-id-type="pmid">10884332</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>von der Emde</surname> <given-names>G</given-names></name><name><surname>Bleckmann</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Finding food: senses involved in foraging for insect larvae in the electric fish <italic>Gnathonemus petersii</italic></article-title><source>The Journal of Experimental Biology</source><volume>201</volume><fpage>969</fpage><lpage>980</lpage><pub-id pub-id-type="pmid">9487102</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakushin</surname> <given-names>SB</given-names></name><name><surname>Raphan</surname> <given-names>T</given-names></name><name><surname>Cohen</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Context-specific adaptation of the vertical vestibuloocular reflex with regard to gravity</article-title><source>Journal of Neurophysiology</source><volume>84</volume><fpage>3067</fpage><lpage>3071</lpage><pub-id pub-id-type="doi">10.1152/jn.2000.84.6.3067</pub-id><pub-id pub-id-type="pmid">11110833</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.44032.022</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Carr</surname><given-names>Catherine Emily</given-names></name><role>Reviewing Editor</role><aff><institution>University of Maryland</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Carr</surname><given-names>Catherine Emily</given-names></name><role>Reviewer</role><aff><institution>University of Maryland</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Chacron</surname><given-names>Maurice J</given-names></name><role>Reviewer</role><aff><institution>McGill University</institution><country>Canada</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Maler</surname><given-names>Len</given-names> </name><role>Reviewer</role><aff><institution>University of Ottawa</institution><country>Canada</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;Generalization of learned responses in the mormyrid electrosensory lobe&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by four peer reviewers, including Catherine Emily Carr as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Eve Marder as the Senior Editor. The following individuals involved in review of your submission have also agreed to reveal their identity: Maurice J Chacron (Reviewer #2); Len Maler (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>This manuscript examines circuit-level account of generalization, using the electrosensory lobe of weakly electric mormyrid fish. Electrosensory systems show adaptive cancellation of self-generated inputs, and this paper develops a circuit-level model, with physiological recordings, to show how such systems could generalize across behavioral regimes. The mechanism involves changes in synaptic plasticity and matching of the temporal dynamics.</p><p>Essential revisions:</p><p>The reviewers do not think that extra experiments are required, given the many novel protocols and experimental results this submission already contains. The main points to be addressed are:</p><p>1) With respect to the negative image model, reviewers raised questions about a potential role for medium ganglion cells. Would a model based on the response of MGs to varying EOD rates do as well ? This could be addressed by a summary of MG cell circuitry and physiology, followed by an argument for why a first order model of negative image formation and cancellation can ignore the MGs, then future directions to bring the MGs into a more complete model.</p><p>2) There is strong spike frequency adaptation of both ampullary afferents and their ELL targets. The cited Engelmann et al., 2010, paper quantifies the receptor SFA in detail, and the authors could discuss this with respect to how EOD rate and SFA of the ampullary receptors/ELL targets might interact.</p><p>3) With respect to the model, there are ambiguities in the model description noted in the full reviews (appended). The authors should check their model against the issues raised by the reviewers.</p><p>A further point is that 'generalization' also occurs in wave-type gymnotiform fish (Bol et al., and Mejias et al.). These papers could be cited, with discussion of how cerebellar descending input could be adapted to generalizing over different EOD frequencies (mormyrid ampullary system) vs different 'noise' amplitudes (gymnotiform wave species and maybe mormyrid tuberous system).</p><p>Useful details will be found in the full reviews (appended).</p><p><italic>Reviewer #1:</italic> </p><p>With respect to the negative image model and a potential role for medium ganglion cells, would a model based on the response of MGs to varying EOD rates do just as well? A serious discussion of the MGs and explanation of why they think these are not important for negative image formation and cancellation and what other role(s) they may play would be helpful.</p><p><italic>Reviewer #2:</italic> </p><p>This manuscript investigates whether the cancellation signal that is internally generated by mormyrid weakly electric fish (i.e., the negative image) will cancel out EOD pulses that occur in rapid succession. The authors find that this is indeed the case and use modelling to make predictions as to the nature of the underlying mechanisms. Overall, I think that this is a very nice study. However, there are a few issues that should be dealt with:</p><p>– It is unclear how behaviorally relevant the situation considered here is to the animal. The authors do cite previous studies in the Introduction, but these appear to be dealing with object localization rather than prey capture. It should also be mentioned that the animal most likely does not exclusively use its ampullary system to locate prey but that information coming from both the passive and the active electrosense are likely combined. Finally, in looking at the authors' data, it appears that ampullary afferents and central ELL cells display strong spike frequency adaptation when EOD pulses are 15 msec apart, which might hamper their ability to detect low frequency prey stimuli. These issues need to be discussed properly.</p><p>– The model assumed by the authors uses both the &quot;unlearned&quot; input as well as the &quot;learned&quot; one. What is the physiological justification for this as I am not aware of ELL cells receiving the &quot;unlearned&quot; input?</p><p>– Although I like the study, it took me a few reads to fully understand the story and its implications. I suggest rewriting it such that the experimental data is presented first, then the &quot;full&quot; model, and the other &quot;candidates&quot; relegated to supplementary information. This would greatly help the reader focus on what is relevant rather than being taken through several models that do not work for various reasons.</p><p>– Finally, although the modeling is compelling, it only makes a prediction as to why negative images can &quot;generalize&quot; to higher frequencies, the actual nature of the mechanisms remains to be determined experimentally.</p><p><italic>Reviewer #3:</italic> </p><p>This is potentially a strong manuscript but has what appears to be a serious flaw in reasoning (or in my understanding of the literature – see below). I have followed work in this system for many years but had never thought about the underlying assumptions. Mormyrids (like gymnotiform fish) have electroreceptors (ampullary) tuned to exogenous low frequency signals (e.g., respiration movements of prey). They also have tuberous receptors that are tuned to the fish's own EOD and detect changes in local EOD amplitude caused by, e.g., conductors or non-conductors. The ampullary receptors project to one map of the ELL (VLZ). This map contains E (fusiform I think) and I (large ganglion cells I think) projection neurons. These cells also have apical dendrites that are in receipt of the EOD command signal (corollary discharge) conveyed via granule cells of the overlying cerebellum (EGp).</p><p>The problem for mormyrids is that the EOD also stimulates the ampullary receptors. Their EOD triggered discharge (demonstrated decades ago by Curt Bell and colleagues) would prevent the fish from detecting prey. Curt Bell and colleagues, over many years and papers, demonstrated that a corollary discharge from EGp was able to cancel out the EOD evoked response of of VLZ neurons.</p><p>The plasticity associated with the corollary discharge input to ELL was always assayed at the convenient low EOD rates of an inactive fish. I knew that mormyrid fish can increase their EOD rates to much high levels when actively sampling their environment. I had never make the connection and question raised in this paper: do the cancellation models developed for low frequency EOD rates carry over to the high frequency EOD rate condition?</p><p>The key experiments are very nicely designed with independent control of the EOD rate and stimulus presentation. This is very nice in that pairing or not is completely under experimental control: (1) corollary discharge alone (curare: no EOD and therefore no sensory input) and experimenter stimulates corollary discharge pathway (one control); (2) sense input alone (EOD pulse mimic) in the absence of a central EOD command and therefore no corollary discharge (second control); (3) paired artificial sensory input + experimenter evoked corollary discharge (natural condition at low frequency EOD rates). Recordings are from the principle E and I cells (output cells) of VLZ.</p><p>The results, as presented in Figure 2 are striking – cancellation learned with 10 Hz paired stimulation generalizes to 40 and 60 Hz EOD rates. The careful control experiments proved very convincingly that it cancellation at the novel EOD frequencies as due to a negative image; this is a very strong extension of Curt Bell's original negative image hypothesis (for the same EOD rate for pairing and test stimulation). The nicest control is the demonstration that the response to the command stimulation alone (only corollary discharge input to E or I cells) produced a negative image. These are novel and very interesting results.</p><p>The next step was to apply a model previously developed to account for negative image formation and cancellation; this model was developed for learning and testing at the same low frequency. The response of model elements to low frequency EOD rates was extended in a simple and natural manner to the higher EOD rates used in the experiments. This model worked as expected when the test stimuli were at 10 Hz (a trivial control for the model changes). The model failed in that it over-cancelled at the higher test EOD rates. The model required training at all test frequencies and was not able to generalize thus failing to replicate the experimental data.</p><p>The original model was then changed in what appears to be minor ways (full regularization) and this did appear to improve the ability of the model to account for generalization. At this point, the authors decided that the problem lay in that they had falsely assumed the responses of the cerebellar granule cells conveying the corollary discharge signal was the same for a 10 Hz and, e.g,, a 60 Hz signal. Now, with their new protocol, they were able to record the granule cell response to the corollary discharge alone and at many different 'EOD rates'. Here a very interesting difference emerged between the data and the original model predictions: the model granule cell, but not the real granule cell, showed a pronounced temporal summation in response to the higher frequencies. A series of very nice experiments then suggested that the problem lay not in the granule cell model itself, but rather in the assumption that the mossy fibers conveying the corollary discharge responded in the same manner for 10 Hz and, e.g., 60 Hz discharge. These mossy fibers could not follow the high frequency EOD command signal – i.e., spikes dropped out. In addition, tonic mossy cell firing also was reduced.</p><p>When the authors modified the mossy fiber response component of their model, it now very nicely predicted the effect of EOD rate increases on negative image formation and cancellation. The authors explanation of what is going on is quite involved and I won't try to summarize it. It is also quite convincing.</p><p>I really could not find any flaw in the reasoning. Nonetheless, I do have one serious problem with the negative image model. To explain this, I will first summarize my possibly outdated memories of the VLZ circuitry and physiology. Any potential confusion is because there has been extensive work on both the VLZ and the mormyromast ELL zones; it is often difficult for me to determine whether conclusions are limited to ampullary vs mormyromast regions. In addition to the principle E and I cells, VLZ (and the mormyromast zones) contains medium ganglion cells (MGs). These are GABAergic interneurons with extensive apical dendrites that receive corollary discharge input from EGp granule cells. As I recall, there are two types of such MGs and they may connect differentially with the principle cell types. These MGs have narrow and broad (dendritic) spikes and the broad spikes are associated with plasticity of their corollary discharge input; in fact, I believe that Curt Bell first demonstrated parallel fiber plasticity in the VLZ MGs. The MGs provide a strong (I suspect cause of the anatomy) and plastic (Bell's data I believe) inhibitory input to principle cells. And they will be activated for both the low and high EOD rates. The authors have chosen not to incorporate these cells into their model. This seems counterintuitive to me.</p><p>I am worried that the model, though it is based on mossy fiber recordings and does a reasonable job explaining generalization, is nevertheless seriously flawed in that it omits a major source of corollary discharge input to the principle cells. Perhaps a model based on the response of MGs to varying EOD rates and including the MG to principle cell inhibitory input would do just as well as the author's model in explaining their results. The authors are certainly aware of the MGs: &quot;…an additional prominent class of GABAergic ELL cells known as medium</p><p>ganglion cells.&quot;, but do not further discuss their potential contribution to cancellation by the principle cells.</p><p>I think the authors treatment of cerebellar Golgi cells and unipolar brush cells is OK (for a first order model). What I would like to see is a serious discussion of the MGs and explanation of why they think these are not important for negative image formation and cancellation and what other role(s) they may play. Perhaps I have gotten mixed up re VLZ and mormyromast zone data (at least some of my knowledge re comparing ampullary and morrmyromast zone cancellation comes from direct discussions with Curt Bell, Kirsty Grant and Hans Meek, and I am not even sure that all their results were even published). Basically, I want the authors to take the MGs seriously because they are a very prominent component of VLZ circuitry and must convey corollary discharge associated input to the principle cells. And then convince me that their limited model is still a reasonable first order model that will not be completely overturned once the contribution(s) of MGs are taken into account.</p><p><italic>Reviewer #4:</italic> </p><p>This is a very nice study that presents novel experiments and associated modeling of negative image cancellation in the electrosensory system of mormyrid fish. The work addresses the important question of the generalizability of this cancellation from the standard low frequency sensory sampling rates used in lab settings – and by the animal at rest – to higher rates known to occur during movement. This cancellation is necessary for disentangling true external inputs from those caused by active sensing, a process that relies on a cerebellar-like corollary discharge. The authors present data that show how the animal can generalize from 10 Hz rates (training) to higher test rates.</p><p>The beauty of this study lies in particular in the intricate measurements of the granule cells and their inputs (various types of mossy fibers and unipolar brush cells), and the construction of a state-of-the-art model of a heterogeneous population of granule cells. The improved model, constructed using machine learning techniques to estimate parameters as well as the timing of spike input, reproduces the main features of the data. With their previous biophysical model thus further constrained by these new data, the improved model is shown to generalize properly, as the fish does, from the learned 10Hz sampling rate to the novel 60Hz rate. This is possible provided two ingredients are present: 1) regularization, which means that synaptic weights decay down to a value (chosen to be different for each cell), which is quicker (10s) then in their previous study (1000s) – and such an ingredient has been used for generalization in neural net studies – and there is a matching between time courses of corollary discharge and electrosensory input – although this precise statement differs in parts of the paper -see below.</p><p>The statement about the matching is confusing. In the Abstract, it is said that an approximate matching of the temporal dynamics (including EOD rate dependence) of corollary discharge and electrosensory inputs. This statement actually relies on Figure 6E and Figure 6—figure supplement 3. But in the Discussion, second paragraph of subsection “Mechanisms of generalization”, the matching is between the EOD rate dependence of electrosensory responses in ELL output cells and the rate dependence of the summed corollary discharge input that an ELL output cell receives from the granule cells. The difference is that the first case looks at the firing rate of sensory cells, and the second at the firing rate of their target cells. At the very least the statement needs to be clarified. But also I want to understand the nature of this &quot;matching&quot;, in the sense of whether it is required to make things work or not. It seems to me that this hinges a lot on the method used to choose w<sub>c</sub>, i.e. the constant driving force in the regularization dynamics (subsection “Synaptic plasticity”). In other words, the ELL output cell is a function of inputs from both the electroreceptors and the granule cells, and I cannot see how to simply swap ELL and electroreceptors in the &quot;matching&quot; statement.</p><p>Relatedly, the choice of making w<sub>c</sub> proportional to the ELL output s(t) (subsection “Synaptic plasticity”) seems to &quot;direct&quot; this matching, since the ELL output must depend on receptor input. The parameter w<sub>c</sub> is important because it is part of both your key ingredients (regularization and matching). A clarification is also needed with regard to to precisely how w<sub>c</sub> is determined: if I understand correctly, the weights w<sub>i</sub> are said to evolve according to the associative learning rule (plus the regularization) which depends on the choice of w<sub>c</sub>; in turn w<sub>c</sub> is said to depend on s(t). Yet this ELL output must depend on the w<sub>i</sub> since these weights scale the 20000 granule cell inputs. So w<sub>c</sub> depends on w<sub>c</sub>: is it self-consistently determined numerically? It would also be good to know the typical size and distribution of w<sub>c</sub> values you used.</p><p>The second concern is about the regularization: your associative rule has Δ+ which drives the weights up proportionally to spike count. Yet you need w<sub>c</sub> to drive them back down exponentially. It seems that one can be traded off for the other to some extent: have you checked whether Δ+ can be changed to fit the data? Was it a free parameter, or was it fixed from prior experiments?</p><p>The Discussion mentions cancellation of self-generated inputs, and thus the need for generalization in other systems, including gymnotiform weakly electric fish which have no corollary discharge. Recent experimental and modeling work (Bol et al., 2011) has shown how that system can learn to cancel many frequencies at the same time using a depressing correlation rule (not exactly the anti-hebbian rule used here) – these different frequencies are analogous in some sense to the different self-generated EOD rates the mormyrids must cancel. An elaboration of that work also showed how the experimentally observed contrast invariance of the cancellation can be achieved across frequencies (i.e. generalization to contrasts not learned, and the optimal contrast to learn at – Mejias et al., 2013). These studies require regularization, yet in that case to prevent weights from decaying to zero. An optimal rate of decay of weights was numerically predicted for the best cancellation. This sweet spot might be of a similar nature as the one of 1 𝜆λ=10 s used by trial and error by the authors (subsection “Synaptic plasticity”).</p><p>It would be important for the authors to at least make a comparative statement to this system given its close functional proximity to theirs, briefly highlighting commonalities/contrasts between corollary discharge-driven and online driven cancellation strategies. The authors' results makes interesting predictions that may apply to this system.</p><p>Finally, I would like to see a few more words about how the authors dealt with avoiding (Results paragraph three) firing-rate rectification in the ELL output cells, which they say complicated quantitative measurements of sensory cancellation. How was the polarity of the EOD mimic adjusted &quot;to evoke excitatory responses in both E and I cells&quot;? Which parameter does this polarity correspond to in their model? Was this parameter fitted? Heterogeneously? I can't quite wrap my head around how big or systematic a correction this was, but such a constant may influence a lot of other things, given e.g. the choice of w<sub>c</sub> above.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.44032.023</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>The reviewers do not think that extra experiments are required, given the many novel protocols and experimental results this submission already contains. The main points to be addressed are:</p><p>1) With respect to the negative image model, reviewers raised questions about a potential role for medium ganglion cells. Would a model based on the response of MGs to varying EOD rates do as well ? This could be addressed by a summary of MG cell circuitry and physiology, followed by an argument for why a first order model of negative image formation and cancellation can ignore the MGs, then future directions to bring the MGs into a more complete model.</p></disp-quote><p>We are glad that the reviewers are interested in the function of MG cells. Though MG cells have been well-studied in some respects, e.g. in terms of their synaptic plasticity, it is important to recognize that their function is unknown, even in the context of low EOD rates studied in the past. By virtue of their anti-Hebbian plasticity, the MG cells should cancel out the effects of the EOD. However, this raises a paradox. How can MG cells aid cancellation in output cells when plasticity stops them from communicating with the rest of the ELL network? We have spent the past several years working on this problem and will shortly submit for publication a major study that offers a solution. Note, this new work focuses exclusively on the case of low rate EODs and does not address the problem of generalization. Without getting too deeply into the details, the solution involves compartmentalization of communication and learning functions within MG cells and a novel wiring scheme for which we provide experimental evidence. Essentially, this scheme allows MG cells to pass on an appropriate negative image to output cells.</p><p>Importantly, such a function is entirely consistent with the scheme for generalization proposed in the present manuscript. In light of our new work on MG cells, the question would be how can MG cells generate an appropriate negative image (to be passed onto output cells) that generalizes across rates? This brings us right back to the conclusions of the present manuscript. Namely, that regularized synaptic plasticity and an approximate matching of granule cell corollary discharge and electrosensory responses is sufficient. We would simply posit that this occurs at the level of MG cells as well as at the level of output cells. Note, there is nothing in the simplified singleneuron model of the ELL presented in the present manuscript that is inconsistent with this (i.e. the model could just as well be an MG cell).</p><p>For the purposes of the present manuscript, we do not think it is feasible or appropriate to attempt to communicate all this, given that the reasoning is based on unpublished work. However, we have added text that amplifies the important points that MG cells are likely important and that the present model is a simplification (see below). We have also removed the potentially confusing term “principal cell”.</p><p>“We also cannot rule out the importance for generalization of other circuit elements not studied here and for which we lack sufficient physiological data under conditions of different EOD rates. Our model (like all past models of the mormyrid ELL) does not distinguish between two distinct classes of ELL neurons: glutamatergic output cells versus GABAergic MG cells which inhibit output cells. MG cells occupy an analogous position in the circuitry of the mormryid ELL as Purkinje cells in the teleost cerebellum and cartwheel cells in the dorsal cochlear nucleus (Bell, 2002; Bell, Han, and Sawtell, 2008). Importantly, both MG and output cells integrate electrosensory and corollary discharge input and both exhibit anti-Hebbian plasticity (Bell, Caputi, and Grant, 1997; Bell et al., 1993; Meek et al., 1996; Mohr, Roberts, and Bell, 2003). However, it is presently unknown, even in the context of low EOD rates, how MG cells contribute to sensory cancellation and negative image formation. Our model also omits molecular layer interneurons, similar to those found in the cerebellar cortex, and does not distinguish between E- and I-type output cells. Constructing a more complete and realistic model that includes these additional features is a major focus of ongoing experimental and theoretical studies of the mormyrid ELL.”</p><p>“The model is simplified in that it does not differentiate between two distinct classes of ELL neurons: output cells and medium ganglion (MG) cells (see Discussion).”</p><disp-quote content-type="editor-comment"><p>2) There is strong spike frequency adaptation of both ampullary afferents and their ELL targets. The cited Engelmann et al., 2010, paper quantifies the receptor SFA in detail, and the authors could discuss this with respect to how EOD rate and SFA of the ampullary receptors/ELL targets might interact.</p></disp-quote><p>Thanks for this comment. We failed to provide a clear explanation in the main text of why responses of ampullary afferents decrease at high EOD rates. The response of ampullary afferents to a single EOD pulse consists of an increase in firing rate followed by a longer-lasting decrease below baseline. We show in Figure 6—figure supplement 3 that the response of afferent at high rates is well approximated by a linear sum of their responses to isolated pulses. This effect could indeed be related to spike frequency adaptation. This point is now discussed in the main text, see below:</p><p>“Interestingly, the sensory responses of ELL neurons to high rate trains of EOD mimics (prior to cancellation) also exhibit a decreasing profile (Figure 2A, Figure 6—figure supplement 2). A separate set of recordings from ampullary electroreceptor afferents also revealed a decreasing profile at high EOD rates (Figure 6E, Figure 6—figure supplement 3). Responses of ampullary afferents to isolated EOD pulses consist of a firing rate increase followed by a reduction below baseline and in some cases additional smaller waves of increased and decreased firing resembling a damped oscillation (Figure 6—figure supplement 3D)(Bell and Russell, 1978). Estimating the impulse response of an ampullary afferent from its average response to a single EOD mimic and then convolving this impulse response with a sequence of EOD mimics indeed yielded a reasonable approximation to the observed responses (Figure 6—figure supplement 3A, red lines). Hence the decaying profile of the sensory response to high-rate sequences of EODs as well as the inhibitory rebound at the end of such sequences are expected features of a linear system with an impulse response resembling a damped oscillation.”</p><p>Incidentally, the Engelmann paper focuses exclusively on responses to low-frequency stimuli characteristic of prey and does not characterize responses to EOD-like stimuli (extremely brief pulses ~0.2 ms in duration).</p><disp-quote content-type="editor-comment"><p>3) With respect to the model, there are ambiguities in the model description noted in the full reviews (appended). The authors should check their model against the issues raised by the reviewers.</p></disp-quote><p>See below.</p><disp-quote content-type="editor-comment"><p>A further point is that 'generalization' also occurs in wave-type gymnotiform fish (Bol et al., and Mejias et al.). These papers could be cited, with discussion of how cerebellar descending input could be adapted to generalizing over different EOD frequencies (mormyrid ampullary system) vs different 'noise' amplitudes (gymnotiform wave species and maybe mormyrid tuberous system).</p></disp-quote><p>Thanks for this, these papers are indeed relevant and are now discussed in a new paragraph in the discussion.</p><p>“The issue of generalization has been explored in the gymnotid ELL in the context of cancellation of spatially redundant electrosensory signals, such as those generated by tail movements or conspecifics (Bol et al., 2011; Mejias et al., 2013). Such cancellation is similar to that in the mormyrid ELL in that it is mediated by anti-Hebbian plasticity at synapses between granule cells and ELL neurons (Harvey-Girard, Lewis, and Maler, 2010). However, cancellation in the gymnotid ELL is driven by electrosensory feedback to granule cells rather than by corollary discharge (Bastian, Chacron, and Maler, 2004; Chacron, Maler, and Bastian, 2005). in vivo recordings from ELL neurons in gymnotids demonstrated that cancellation remains accurate over a wide range of stimulus contrasts (as might be produced by conspecifics at different distances) (Mejias et al., 2013). Modeling was used to show how learning at one contrast could generalize to higher or lower contrasts, despite numerous nonlinearities in the system. Interestingly, features of the model identified to be important for such generalization are related to those described here for the mormyrid ELL, including granule cell response properties and a slow decay in parallel fiber synaptic strength (Mejias et al., 2013), which can be considered a form of regularization. Although responses of granule cells have not yet been measured in vivo in gymnotids, several lines of evidence suggest that they are important in relation to the specificity and generalization of learning in the gymnotid ELL (Bol et al., 2011; Mejias et al., 2013).”</p><disp-quote content-type="editor-comment"><p>Useful details will be found in the full reviews (appended).</p></disp-quote><p>Reviewer #1:</p><disp-quote content-type="editor-comment"><p>With respect to the negative image model and a potential role for medium ganglion cells, would a model based on the response of MGs to varying EOD rates do just as well? A serious discussion of the MGs and explanation of why they think these are not important for negative image formation and cancellation and what other role(s) they may play would be helpful.</p></disp-quote><p>See above.</p><p>Reviewer #2:</p><disp-quote content-type="editor-comment"><p>This manuscript investigates whether the cancellation signal that is internally generated by mormyrid weakly electric fish (i.e., the negative image) will cancel out EOD pulses that occur in rapid succession. The authors find that this is indeed the case and use modelling to make predictions as to the nature of the underlying mechanisms. Overall, I think that this is a very nice study. However, there are a few issues that should be dealt with:</p><p>– It is unclear how behaviorally relevant the situation considered here is to the animal. The authors do cite previous studies in the Introduction, but these appear to be dealing with object localization rather than prey capture. It should also be mentioned that the animal most likely does not exclusively use its ampullary system to locate prey but that information coming from both the passive and the active electrosense are likely combined.</p></disp-quote><p>Added sentence and reference to discussion:</p><p>“Behavioral studies suggest that multiple senses (including both the passive and active electrosensory systems) are used in concert to detect prey (von der Emde and Bleckmann, 1998).”</p><disp-quote content-type="editor-comment"><p>Finally, in looking at the authors' data, it appears that ampullary afferents and central ELL cells display strong spike frequency adaptation when EOD pulses are 15 msec apart, which might hamper their ability to detect low frequency prey stimuli. These issues need to be discussed properly.</p></disp-quote><p>See above.</p><disp-quote content-type="editor-comment"><p>– The model assumed by the authors uses both the &quot;unlearned&quot; input as well as the &quot;learned&quot; one. What is the physiological justification for this as I am not aware of ELL cells receiving the &quot;unlearned&quot; input?</p></disp-quote><p>We are referring to the peripheral electrosensory input to ELL neurons. Text has been added for clarification. This input is known anatomically and is central to ELL function.</p><p>“This corresponds anatomically to the input onto the basilar dendrites of ELL neurons from interneurons in the deep layers of ELL receiving somatotopic input from ampullary electroreceptor afferents (Meek, Grant, and Bell, 1999)”</p><disp-quote content-type="editor-comment"><p>– Although I like the study, it took me a few reads to fully understand the story and its implications. I suggest rewriting it such that the experimental data is presented first, then the &quot;full&quot; model, and the other &quot;candidates&quot; relegated to supplementary information. This would greatly help the reader focus on what is relevant rather than being taken through several models that do not work for various reasons.</p></disp-quote><p>We appreciate the reviewer’s patience and agree that model failures should not be the focus. We tried numerous different versions of the manuscript, including some in which we separated the experimental and theoretical results. In the end, we felt that integrating the experiments and the models, as we have tried to do, was best. In the revised manuscript we have added some material to the Introduction to better set up the problem and preview our main findings (per the suggestion of reviewer 2 below). We think this will help readability.</p><disp-quote content-type="editor-comment"><p>– Finally, although the modeling is compelling, it only makes a prediction as to why negative images can &quot;generalize&quot; to higher frequencies, the actual nature of the mechanisms remains to be determined experimentally.</p></disp-quote><p>We agree that the model has not been proven. On the other hand, the model does provide a functional interpretation for previously unknown and unexpected features of mossy fiber and granule cell corollary discharge responses reported here for the first time. For example, the observation from past work that mossy fibers fire identical bursts of ~8 precisely timed spike in response to each command seems odd. Why are 8 spikes needed to signal the timing of the EOD when a single spike would seemingly suffice? Here we show experimentally that the mossy fiber bursts change with EOD rate and the model provides a non-trivial, mechanistic explanation for how information encoded in the EOD command rate-dependence of the mossy fibers could be used to support generalization of learning.</p><p>“So-called early mossy fibers are known from previous studies to fire a highly-stereotyped burst of action potentials following each EOD command (Bell, Grant, and Serrier, 1992). We found that the number of spikes in such bursts declines progressively with increases in the command rate. The multiple spikes in the burst seem redundant in the context of isolated EODs. Why would multiple spikes be needed to signal the time of occurrence of an EOD command? The present work suggests that rate-dependent grading of such bursts conveys information that is important for generalization. “</p><disp-quote content-type="editor-comment"><p>Reviewer #3:</p><p>This is potentially a strong manuscript but has what appears to be a serious flaw in reasoning (or in my understanding of the literature – see below). I have followed work in this system for many years but had never thought about the underlying assumptions. Mormyrids (like gymnotiform fish) have electroreceptors (ampullary) tuned to exogenous low frequency signals (e.g., respiration movements of prey). They also have tuberous receptors that are tuned to the fish's own EOD and detect changes in local EOD amplitude caused by, e.g., conductors or non-conductors. The ampullary receptors project to one map of the ELL (VLZ). This map contains E (fusiform I think) and I (large ganglion cells I think) projection neurons. These cells also have apical dendrites that are in receipt of the EOD command signal (corollary discharge) conveyed via granule cells of the overlying cerebellum (EGp).</p><p>[…]</p><p>I think the authors treatment of cerebellar Golgi cells and unipolar brush cells is OK (for a first order model). What I would like to see is a serious discussion of the MGs and explanation of why they think these are not important for negative image formation and cancellation and what other role(s) they may play. Perhaps I have gotten mixed up re VLZ and mormyromast zone data (at least some of my knowledge re comparing ampullary and morrmyromast zone cancellation comes from direct discussions with Curt Bell, Kirsty Grant and Hans Meek, and I am not even sure that all their results were even published). Basically, I want the authors to take the MGs seriously because they are a very prominent component of VLZ circuitry and must convey corollary discharge associated input to the principle cells. And then convince me that their limited model is still a reasonable first order model that will not be completely overturned once the contribution(s) of MGs are taken into account.</p></disp-quote><p>Agreed. See above.</p><p>Reviewer #4:</p><disp-quote content-type="editor-comment"><p>This is a very nice study that presents novel experiments and associated modeling of negative image cancellation in the electrosensory system of mormyrid fish. The work addresses the important question of the generalizability of this cancellation from the standard low frequency sensory sampling rates used in lab settings – and by the animal at rest – to higher rates known to occur during movement. This cancellation is necessary for disentangling true external inputs from those caused by active sensing, a process that relies on a cerebellar-like corollary discharge. The authors present data that show how the animal can generalize from 10 Hz rates (training) to higher test rates.</p><p>[…]</p><p>The statement about the matching is confusing. In the Abstract, it is said that an approximate matching of the temporal dynamics (including EOD rate dependence) of corollary discharge and electrosensory inputs. This statement actually relies on Figure 6E and Figure 6—figure supplement 3. But in the Discussion, second paragraph of subsection “Mechanisms of generalization”, the matching is between the EOD rate dependence of electrosensory responses in ELL output cells and the rate dependence of the summed corollary discharge input that an ELL output cell receives from the granule cells. The difference is that the first case looks at the firing rate of sensory cells, and the second at the firing rate of their target cells. At the very least the statement needs to be clarified. But also I want to understand the nature of this &quot;matching&quot;, in the sense of whether it is required to make things work or not. It seems to me that this hinges a lot on the method used to choose w<sub>c</sub>, i.e. the constant driving force in the regularization dynamics (subsection “Synaptic plasticity”). In other words, the ELL output cell is a function of inputs from both the electroreceptors and the granule cells, and I cannot see how to simply swap ELL and electroreceptors in the &quot;matching&quot; statement.</p></disp-quote><p>The matching is between the average granule cell response and the electrosensory inputs to ELL output cells. The electrosensory response of the output cells is very similar to the electrosensory response of the afferent fibers providing input to those cells prior to the learning of negative images, which is the reason for the confusing statements where the electrosensory response of output cells is said to match the average granule cell response. We have changed the statement in the Discussion to clarify this:</p><p>“The second feature we identified as important for generalization is an approximate matching between the EOD rate dependence of electrosensory inputs to ELL output cells and the rate dependence of the average corollary discharge response in granule cells.”</p><disp-quote content-type="editor-comment"><p>Relatedly, the choice of making w<sub>c</sub> proportional to the ELL output s(t) (subsection “Synaptic plasticity”) seems to &quot;direct&quot; this matching, since the ELL output must depend on receptor input. The parameter w<sub>c</sub> is important because it is part of both your key ingredients (regularization and matching). A clarification is also needed with regard to to precisely how w<sub>c</sub> is determined: if I understand correctly, the weights w<sub>i</sub> are said to evolve according to the associative learning rule (plus the regularization) which depends on the choice of w<sub>c</sub>; in turn w<sub>c</sub> is said to depend on s(t). Yet this ELL output must depend on the w<sub>i</sub> since these weights scale the 20000 granule cell inputs. So w<sub>c</sub> depends on w<sub>c</sub>: is it self-consistently determined numerically? It would also be good to know the typical size and distribution of w<sub>c</sub> values you used.</p></disp-quote><p>This is a simple confusion: s(t) is the “sensory only response”, not the summed response to corollary discharge and sensory input. We have added the following clarifying statement.</p><p>“We chose the value of 𝑤<sub>𝑐</sub> depending on the ELL neuron being modeled so that the mean model granule cell response scaled by 𝑤<sub>𝑐</sub> was approximately equal to the negative of the sensory input to the ELL neuron, that is such that 𝑤<sub>𝑐</sub>⟨𝑟<sub>𝑖</sub>(𝑡)⟩ ≈ −𝑠(𝑡). “</p><disp-quote content-type="editor-comment"><p>The second concern is about the regularization: your associative rule has Δ+ which drives the weights up proportionally to spike count. Yet you need w<sub>c</sub> to drive them back down exponentially. It seems that one can be traded off for the other to some extent: have you checked whether Δ+ can be changed to fit the data? Was it a free parameter, or was it fixed from prior experiments?</p></disp-quote><p>Δ+ was estimated from previous in vitro experiments, Bell, 1997 and Han, 2000. Regularization and Δ+/Δ- cannot be traded off against one another. The ratio of Δ+/Δ- sets the steady-state firing rate of the cell, and the scale of the two parameters sets the rate of learning. Regularization is a decay toward w<sub>c</sub> in this model, which can involve both potentiation and depression toward w<sub>c</sub>.</p><disp-quote content-type="editor-comment"><p>The Discussion mentions cancellation of self-generated inputs, and thus the need for generalization in other systems, including gymnotiform weakly electric fish which have no corollary discharge. Recent experimental and modeling work (Bol et al., 2011) has shown how that system can learn to cancel many frequencies at the same time using a depressing correlation rule (not exactly the anti-hebbian rule used here) – these different frequencies are analogous in some sense to the different self-generated EOD rates the mormyrids must cancel. An elaboration of that work also showed how the experimentally observed contrast invariance of the cancellation can be achieved across frequencies (i.e. generalization to contrasts not learned, and the optimal contrast to learn at – Mejias et al., 2013). These studies require regularization, yet in that case to prevent weights from decaying to zero. An optimal rate of decay of weights was numerically predicted for the best cancellation. This sweet spot might be of a similar nature as the one of 1 𝜆=10 s used by trial and error by the authors (subsection “Synaptic plasticity”).</p><p>It would be important for the authors to at least make a comparative statement to this system given its close functional proximity to theirs, briefly highlighting commonalities/contrasts between corollary discharge-driven and online driven cancellation strategies. The authors' results makes interesting predictions that may apply to this system.</p></disp-quote><p>See above. Thanks for this, these papers are indeed relevant and are now discussed in a new paragraph in the discussion.</p><disp-quote content-type="editor-comment"><p>Finally, I would like to see a few more words about how the authors dealt with avoiding (Results paragraph three) firing-rate rectification in the ELL output cells, which they say complicated quantitative measurements of sensory cancellation. How was the polarity of the EOD mimic adjusted &quot;to evoke excitatory responses in both E and I cells&quot;? Which parameter does this polarity correspond to in their model? Was this parameter fitted? Heterogeneously? I can't quite wrap my head around how big or systematic a correction this was, but such a constant may influence a lot of other things, given e.g. the choice of w<sub>c</sub> above.</p></disp-quote><p>Text has been added to the experimental and modeling sections of the Materials and methods section:</p><p>“In I cells, the EOD mimic often drove the firing rate to zero, making it difficult to quantify cancellation. To avoid this firing rate rectification, we reversed the EOD mimic polarity when recording from I cells, such that they responded with excitation instead of inhibition. This response reversal is due to known properties of ampullary electroreceptor afferents, which increase (or decrease) firing above (or below) their baseline rate for stimuli that make the pore of the receptor positive (or negative) with respect to the basal face within the body. Past studies have commonly used this approach to demonstrate the specificity of negative image formation in the VLZ by performing multiple pairing in the same neuron using opposite stimulus polarities (Bell, 1981, 1982; Enikolopov, Abbott, and Sawtell, 2018). Negative images are invariably observed for both stimulus polarities in such experiments, i.e. responses to the corollary discharge alone after pairing are opposite in sign to the response to the stimulus during pairing. Systematic differences between negative images and cancellation in E versus I cells or for mimics of opposite polarities have never been noted, justifying this approach to avoid rectification.”</p><p>“As discussed above, we adjusted the polarity of the sensory stimulus such that excitation was evoked in both E and I cells. Hence, no distinction was made in the model between E and I cells.”</p></body></sub-article></article>