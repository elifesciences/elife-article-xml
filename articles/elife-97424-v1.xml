<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">97424</article-id><article-id pub-id-type="doi">10.7554/eLife.97424</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.97424.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>A model-based factorization method for scRNA data unveils bifurcating transcriptional modules underlying cell fate determination</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ren</surname><given-names>Jun</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9027-2303</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Zhou</surname><given-names>Ying</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Hu</surname><given-names>Yudi</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Jing</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Fang</surname><given-names>Hongkun</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Lyu</surname><given-names>Xuejing</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Guo</surname><given-names>Jintao</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con7"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Shi</surname><given-names>Xiaodong</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con8"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Li</surname><given-names>Qiyuan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8934-8948</contrib-id><email>qiyuan.li@xmu.edu.cn</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con9"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00mcjh785</institution-id><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution></institution-wrap><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0006swh35</institution-id><institution>Department of Hematology, The First Affiliated Hospital of Xiamen University and Institute of Hematology, School of Medicine, Xiamen University</institution></institution-wrap><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00mcjh785</institution-id><institution>School of Informatics, Xiamen University, Xiamen</institution></institution-wrap><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01xd2tj29</institution-id><institution>Department of Scientific Research Management, Weifang People’s Hospital, Shandong Second Medical University</institution></institution-wrap><addr-line><named-content content-type="city">Weifang</named-content></addr-line><country>China</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Karimi</surname><given-names>Mohammad M</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0220mzb33</institution-id><institution>King's College London</institution></institution-wrap><country>United Kingdom</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Moses</surname><given-names>Alan M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>University of Toronto</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>05</day><month>02</month><year>2025</year></pub-date><volume>13</volume><elocation-id>RP97424</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-04-02"><day>02</day><month>04</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-04-04"><day>04</day><month>04</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.04.02.587768"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-08-21"><day>21</day><month>08</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97424.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-12-18"><day>18</day><month>12</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97424.2"/></event></pub-history><permissions><copyright-statement>© 2024, Ren et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Ren et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-97424-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-97424-figures-v1.pdf"/><abstract><p>Manifold-learning is particularly useful to resolve the complex cellular state space from single-cell RNA sequences. While current manifold-learning methods provide insights into cell fate by inferring graph-based trajectory at cell level, challenges remain to retrieve interpretable biology underlying the diverse cellular states. Here, we described MGPfact<sup>XMBD</sup>, a model-based manifold-learning framework and capable to factorize complex development trajectories into independent bifurcation processes of gene sets, and thus enables trajectory inference based on relevant features. MGPfact<sup>XMBD</sup> offers a more nuanced understanding of the biological processes underlying cellular trajectories with potential determinants. When bench-tested across 239 datasets, MGPfact<sup>XMBD</sup> showed advantages in major quantity-control metrics, such as branch division accuracy and trajectory topology, outperforming most established methods. In real datasets, MGPfact<sup>XMBD</sup> recovered the critical pathways and cell types in microglia development with experimentally valid regulons and markers. Furthermore, MGPfact<sup>XMBD</sup> discovered evolutionary trajectories of tumor-associated CD8<sup>+</sup> T cells and yielded new subtypes of CD8<sup>+</sup> T cells with gene expression signatures significantly predictive of the responses to immune checkpoint inhibitor in independent cohorts. In summary, MGPfact<sup>XMBD</sup> offers a manifold-learning framework in scRNA-seq data which enables feature selection for specific biological processes and contributing to advance our understanding of biological determination of cell fate.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>scRNA-seq</kwd><kwd>factorization</kwd><kwd>manifold-learning</kwd><kwd>bifurcation process</kwd><kwd>mixtures of Gaussian processes</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>82272944</award-id><principal-award-recipient><name><surname>Li</surname><given-names>Qiyuan</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source><award-id>82203420</award-id><principal-award-recipient><name><surname>Guo</surname><given-names>Jintao</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100012166</institution-id><institution>National Key Research and Development Program of China</institution></institution-wrap></funding-source><award-id>2022YFC2704801</award-id><principal-award-recipient><name><surname>Li</surname><given-names>Qiyuan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A novel method for factorizing complex cellular trajectories into interpretable bifurcation processes enhances the understanding of cell fate determination through the identification of key biological determinants in scRNA-seq data.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Data-mining of single-cell RNA sequencing (scRNA-seq) is often transformed into learning of lower-dimensional embedding (<xref ref-type="bibr" rid="bib5">Becht et al., 2019</xref>; <xref ref-type="bibr" rid="bib16">Haghverdi et al., 2015</xref>; <xref ref-type="bibr" rid="bib28">Maaten and Hinton, 2008</xref>) of the expression vectors, which represents the variation in the cellular space and helps explain the biological background. Previous single-cell studies used various embedding methods to characterize and visualize clustering of cells with unique biological functions (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>). Among the existing methods, graph-based embedding can better capture nonlinear biological signals among cells hence yielded more insights of the diversity of cells. More recent studies also use graph-based embedding (<xref ref-type="bibr" rid="bib10">Costa et al., 2018</xref>) to reveal the dependency among cells and thereby reconstruct the evolutionary trajectory in the cellular space, which helps in understanding the determination of cell fate in development, differentiation and cancer.</p><p>To date, more and more manifold-learning methods are developed to infer lower-dimensional graphic embedding (manifolds) of scRNA-seq data, and yielded a number of trajectories corresponding to important cellular processes, such as TSCAN (<xref ref-type="bibr" rid="bib20">Ji and Ji, 2016</xref>), DPT (<xref ref-type="bibr" rid="bib17">Haghverdi et al., 2016</xref>), and scShaper (<xref ref-type="bibr" rid="bib46">Smolander et al., 2022</xref>) belong to linear topological classes and reveal major linear pathways based on embedding spaces or cell clustering. TSCAN employs the construction of minimum spanning trees to discover pathways, while DPT reconstructs cellular trajectories using random walks, and scShaper integrates multiple pseudo-temporal solutions to deduce the shortest trajectory within a linear context. Additionally, there have been many approaches capable of inferring complex tree topological structures, such as the widely used Monocle series of algorithms includes Monocle 2 and 3 (<xref ref-type="bibr" rid="bib8">Cao et al., 2019</xref>; <xref ref-type="bibr" rid="bib34">Qiu et al., 2017b</xref>, <xref ref-type="bibr" rid="bib33">Qiu et al., 2017a</xref>). They leverage sophisticated graphing techniques to map intricate cell hierarchies; Monocle 2 creates DDRtree based on reversed graph embedding techniques, while Monocle 3 utilizes UMAP (<xref ref-type="bibr" rid="bib5">Becht et al., 2019</xref>) for embedding. TinGa (<xref ref-type="bibr" rid="bib49">Todorov et al., 2020</xref>) and scFates (<xref ref-type="bibr" rid="bib12">Faure et al., 2023</xref>) represent more recent innovations. TinGa utilizes the Growing Neural Gas (GNG) algorithm (<xref ref-type="bibr" rid="bib13">Fritzke, 1994</xref>) to construct an adaptive graph structure that effectively captures the density structure of the dataset. scFates, streamlines pseudotime analysis with flexible tree learning options, advanced feature extraction tasks, and specific functionalities for fork analysis.</p><p>Moreover, recent studies based on RNA velocity have provided insights into cell state transitions. These methods measure RNA synthesis and degradation rates based on the abundance of spliced and unspliced mRNA, such as CellRank (<xref ref-type="bibr" rid="bib22">Lange et al., 2022</xref>). Nevertheless, current RNA velocity analyses are still unable to resolve cell-fates with complex branching trajectory. Deep learning methods such as scTour (<xref ref-type="bibr" rid="bib24">Li, 2023</xref>) and TIGON (<xref ref-type="bibr" rid="bib45">Sha et al., 2024</xref>) circumvent some of these limitations, offering continuous state assumptions or requiring prior cell sampling information.</p><p>Despite these advances, trajectory prediction remains a major challenge in single-cell analysis. First, graph-based trajectories represent synergic effects of multiple biological processes, making it difficult to disentangle the effects of specific process, hence limited model interpretability and the power to gain novel biological insights. Second, the inference of trajectory is highly dependent on the biases in the gene-selection, whereas conventional statistical feature-selection methods are less efficient for the learning of complex topologies, and adds to the difficulty of suggesting candidate genes for downstream functional study. Additionally, many approaches require additional prior information, which further limits the applicability.</p><p>Here, we describe MGPfact<sup>XMBD</sup> (Factorization based on Mixtures of Gaussian Processes), a model-based, unsupervised manifold-learning method which factorizes complex cellular trajectories into interpretable bifurcation Gaussian processes of transcription, and thereby enables discovery of specific biological determinants of cell fate. In the validation datasets, MGPfact recapitulated developmental trajectory of microglia and recovered key regulatory factors which have been proved experimentally. Moreover, MGPfact discovered highly specific subtypes of tumor-associated CD8<sup>+</sup> T cells which are associated with benefit to cancer immunotherapy.</p><p>Bring together, MGPfact is a knowledge discovery tool which conducts manifold-learning and factorization simultaneously. MGPfact offers two advantages in future scRNA-seq analyses: first, it provides highly interpretable, factorizable cellular trajectories with matched gene expression modules; then, it provides efficient feature-selection for graph-based embedding, thus enhancing our understanding of the determination of cell fate.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Design of MGPfact</title><p>The analytical pipeline of MGPfact consists of two major stages (<xref ref-type="fig" rid="fig1">Figure 1</xref>). An algorithmic description is given in Algorithm 1.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of MGPfact workflow.</title><p>The complete workflow comprises two major stages: minimum unbiased representative points (MURP) downsampling with preprocessed data and trajectory reconstruction. In the stage of trajectory reconstruction, the single-cell RNA sequencing (scRNA-seq) data were first factorized into independent bifurcation processes based on mixtures of Gaussian processes, which were then merged into a consensus trajectory.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig1-v1.tif"/></fig><p>First, we performed downsampling of the preprocessed scRNA-seq data <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to yield a <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-by-<inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> expression matrix <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo mathvariant="bold">′</mml:mo></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> based on the ‘minimum unbiased representative points (MURP)’ as described previously (<xref ref-type="bibr" rid="bib35">Ren et al., 2022</xref>), where <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> representative points were considered as landmarks of the cellular trajectory and <inline-formula><mml:math id="inf6"><mml:mi>N</mml:mi></mml:math></inline-formula> is the number of genes. Then, we computed <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> principal components (PCs) of the downsampled expression matrix to obtain the matrix <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-by-<inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>),<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> is projection vector, <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> serve as the <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>-th initial state of embedding.</p><p>Next, we used typical Gaussian Process Regression of <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> on pseudotime <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a Gaussian Process (GP) with covariance matrix <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">G</mml:mi><mml:mi class="mathcal" mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>And for all features:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is defined as follows:<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Specifically, we consider <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as a mixture of <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> independent bifurcation Gaussian processes (<xref ref-type="bibr" rid="bib44">Schulz et al., 2018</xref>),<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>To cope with the bifurcation processes in cell fate, each of the Gaussian processes is defined with a bifurcation point at <inline-formula><mml:math id="inf21"><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, branching labels <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, and the necessary hyperparameters. The branching labels <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, correspond to different phases and states of cell fate, where <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> corresponds the phase before branching, and <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. corresponds to the two cellular states of the bifurcation process, respectively. For any landmark (MURP) <inline-formula><mml:math id="inf26"><mml:mi>x</mml:mi></mml:math></inline-formula>,<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The covariance matrix <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for trajectory <inline-formula><mml:math id="inf28"><mml:mi>l</mml:mi></mml:math></inline-formula> can be expressed as follows,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">K</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is a kernel function. We employ radial basis function (rbf) and polynomial kernel function (pl). We chose these two kernel functions for the effectiveness in handling nonlinear and polynomial relationships, achieving a balance between model performance and computational efficiency.<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>And the <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is calculated as follows:<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi class="mathcal" mathvariant="script">K</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="1em"/></mml:mstyle></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Therefore, <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is updated as follows:<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We infer all parameters by maximizing the posterior likelihood using Markov Chain Monte Carlo (MCMC) methods available in Mamba (<xref ref-type="bibr" rid="bib6">Brian, 2014</xref>). The posterior distribution of pseudotime <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> can be represented as:<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the likelihood function of the observed data <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the prior distribution of the Gaussian process. This posterior distribution integrates the observed data with model priors, enabling inference of pseudotime and trajectory simultaneously. Due to the high autocorrelation of <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the posterior distribution, we use Adaptive Metropolis within Gibbs (AMWG) sampling (<xref ref-type="bibr" rid="bib41">Roberts and Rosenthal, 2009</xref>; <xref ref-type="bibr" rid="bib48">Tierney, 1994</xref>). Other parameters are estimated using the more efficient SLICE sampling technique (<xref ref-type="bibr" rid="bib30">Neal, 2003</xref>).</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups" id="AL1"><thead><tr><th align="left" valign="bottom">Algorithm 1 MGPfact: infer cell fate trajectory</th></tr></thead><tbody><tr><td align="left" valign="bottom"><bold>INPUT:</bold> expression matrix <bold><italic>Y</italic></bold>, independent trajectories number <italic>L</italic><break/><bold>OUTPUT:</bold> <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mtext>other hyperparameters</mml:mtext><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> ; trajectory toplogy<break/>1: initialize all parameters in <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>2: covariance matrix <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>3: object function <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">L</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>4: <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mi mathvariant="bold">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> ← MURP downsampling <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>;<break/>5: <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo mathvariant="bold">∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> ← PCA analysis<break/>6: <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> ← Opmized ObjectF<break/>7: <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> ← Greate independent trajectory using <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>8: <bold>function</bold> ObjectF (<inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo mathvariant="bold">∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) <break/>9:   <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo mathvariant="bold">∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>10:     for <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">Q</mml:mi></mml:mrow><mml:mo>;</mml:mo><mml:mi>q</mml:mi><mml:mo>+</mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>do</bold>                <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>▹</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> object function<break/>11:        <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo mathvariant="bold">∗</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>12:        for <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">l</mml:mi><mml:mo mathvariant="italic">=</mml:mo><mml:mn mathvariant="italic">1</mml:mn><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">l</mml:mi><mml:mo mathvariant="italic">&lt;</mml:mo><mml:mi mathvariant="italic">L</mml:mi><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">l</mml:mi><mml:mo mathvariant="italic">+</mml:mo><mml:mo mathvariant="italic">+</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>do</bold><break/>13:         <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo class="mathcal" mathvariant="script">,</mml:mo><mml:msub><mml:mi class="mathcal" mathvariant="script">b</mml:mi><mml:mrow><mml:mi class="mathcal" mathvariant="script">l</mml:mi></mml:mrow></mml:msub><mml:mo class="mathcal" mathvariant="script">,</mml:mo><mml:msub><mml:mi class="mathcal" mathvariant="script">c</mml:mi><mml:mrow><mml:mi class="mathcal" mathvariant="script">l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo mathvariant="bold" stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>14:        <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>15:       <bold>end for</bold><break/>16:     <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">L</mml:mi></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">L</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>P</mml:mi><mml:mi>D</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>17:     <bold>end for</bold><break/>18:     <bold>return</bold><inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">L</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>19: <bold>end function</bold><break/>20: <bold>function</bold> Cov (<inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>)                      <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>▹</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> construct covariance matrix<break/>21:  <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>22:   <bold>for</bold> <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo mathvariant="italic">=</mml:mo><mml:mn mathvariant="italic">1</mml:mn><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">i</mml:mi><mml:mo mathvariant="italic">&lt;</mml:mo><mml:mi mathvariant="italic">P</mml:mi><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">i</mml:mi><mml:mo mathvariant="italic">+</mml:mo><mml:mo mathvariant="italic">+</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>do</bold><break/>23:      <bold>for</bold> <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="italic">j</mml:mi><mml:mo mathvariant="italic">=</mml:mo><mml:mn mathvariant="italic">1</mml:mn><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">j</mml:mi><mml:mo mathvariant="italic">&lt;</mml:mo><mml:mi mathvariant="italic">P</mml:mi><mml:mo mathvariant="italic">;</mml:mo><mml:mi mathvariant="italic">j</mml:mi><mml:mo mathvariant="italic">+</mml:mo><mml:mo mathvariant="italic">+</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>do</bold><break/>24:        <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>K</mml:mi><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">c</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>25:      <bold>end for</bold><break/>26:   <bold>end for</bold><break/>27:   <bold>return</bold> <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><break/>28: <bold>end function</bold><break/>29: <bold>function</bold> <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mi>E</mml:mi><mml:mi>R</mml:mi><mml:mi>N</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>  <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>▹</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> kernel function<break/>30:    if <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold><break/>31:       <bold>return</bold> <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>32:    <bold>else if</bold> <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∧</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold><break/>33:       <bold>return</bold><inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>34:    <bold>else if</bold><inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <bold>then</bold><break/>35:      <bold>return</bold> <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/>36:    <bold>end if</bold><break/>37: <bold>end function</bold></td></tr></tbody></table></table-wrap><p>Then, MGPfact can identify genes that have significant impacts on the branching events in the trajectories. We introduce a rotation matrix <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to obtain factor score <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each trajectory <inline-formula><mml:math id="inf74"><mml:mi>l</mml:mi></mml:math></inline-formula> by rotating <inline-formula><mml:math id="inf75"><mml:msup><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>.<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For all trajectories,<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf76"><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the error term for the <inline-formula><mml:math id="inf77"><mml:mi>l</mml:mi></mml:math></inline-formula>-th trajectory.</p><p>Specifically, the factor scores <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> for each gene onto the <inline-formula><mml:math id="inf79"><mml:mi>l</mml:mi></mml:math></inline-formula>-th trajectory can be expressed using <xref ref-type="disp-formula" rid="equ1 equ14">equations (1) and (14)</xref> as follows,<disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is used to represent the contribution (gene weight) of each gene to the <inline-formula><mml:math id="inf81"><mml:mi>l</mml:mi></mml:math></inline-formula>-th trajectory, thus enabling gene-selection based on the inferred trajectories.</p><p>Additionally, we can combine independent bifurcation processes to form a consensus diffusion tree to represent the trajectory of cell fate (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>).</p></sec><sec id="s2-2"><title>Performance evaluation of MGPfact</title><sec id="s2-2-1"><title>Robustness analysis of MGPfact</title><p>Before the performance evaluation, we performed a grid search on the number of independent trajectories in 100 training datasets and selected <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> for downstream testing (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s2">2</xref>, Methods).</p><p>To further validate the efficacy of MURP downsampling step in MGPfact, we employed an alternative downsampling using randomly selected cells for trajectory inference (Methods). This comparison revealed that the prediction accuracy substantially diminished without MURP, evidenced by a notable reduction in branch assignment (<inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, 20.5%) and cell ordering (<inline-formula><mml:math id="inf84"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, 64.9%) (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). In contrast, trajectory predictions utilizing MURP-based downsampling realized an overall score increase of 5.31 to 185%, underscoring the indispensable role of MURP in the trajectory inference capabilities of MGPfact.</p><p>Furthermore, we performed a robustness analysis on the topological consistency of the predicted consensus trajectory by comparing prediction results from randomly sampled subsets of the original data. As a result, the consensus trajectory predicted from random subsets by MGPfact retained a high degree of congruence with those from the original datasets (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>, <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.686</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). This outcome attests to MGPfact’s robustness and generalizability under varying data conditions, hence the capability of retrieving conserved bifurcation trajectories in the data.</p></sec><sec id="s2-2-2"><title>MGPfact predicts cellular trajectories</title><p>Then, we assessed the performance of MGPfact for prediction of cellular trajectories in 239 test datasets, including 171 synthetic and 68 real datasets, alongside with another seven existing algorithms. For the overall performance score, MGPfact (<inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>O</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.534</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) ranked second only to TinGa (<inline-formula><mml:math id="inf87"><mml:mi>O</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.563</mml:mn></mml:math></inline-formula>) and outperformed the rest of six algorithms (<xref ref-type="fig" rid="fig2">Figure 2a</xref>). Particularly, MGPfact demonstrated the highest accuracy in predicting cell fate in branching trajectory (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.482</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). As for other three individual metrics, MGPfact ranked the fourth in <inline-formula><mml:math id="inf89"><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.606</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the sixth in <inline-formula><mml:math id="inf91"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.507</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), and the fourth in <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> (<inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.712</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) (<xref ref-type="fig" rid="fig2">Figure 2c–e</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Trajectory inference (TI) performance of state-of-the-art methods in 239 test datasets.</title><p>(<bold>a</bold>) Overall scores; (<bold>b</bold>) <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>c</bold>) <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>d</bold>) <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> ; (<bold>e</bold>) <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>All results are color-coded based on the trajectory types, with the black line representing the mean value. The ‘Overall’ assessment is calculated as the geometric mean of all four metrics.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig2-v1.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>The distribution of trajectory types among training set and test set.</title><p>The 339 datasets were randomly split into two groups, serving as the training set and test set, respectively. The training set consists of 100 datasets, while the testing set includes 239 datasets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig2-figsupp1-v1.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Robustness testing of the number of independent trajectories on 100 training datasets.</title><p>With L=3 set as the default, we tested the impact of different L values (1, 2, 4, and 5) on the prediction results. In all box plots, the asterisk represents the mean value, while the whiskers extend to the farthest data points within 1.5 times the interquartile range. Significance is denoted as follows: not annotated indicates non-significant; * <italic>P</italic>&lt;0.05; ** <italic>P</italic>&lt;0.01; *** <italic>P</italic>&lt;0.001; two-sided paired Student’s T-tests.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig2-figsupp2-v1.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>MURP downsampling enhances the performance of MGPfact.</title><p>Trajectory inference was conducted by randomly selecting 20, 40, 60, 80, and 100 cells from the original dataset. The results were mapped back to the original data using a KNN graph structure to obtain the final predictions, which were then compared with those obtained through MURP downsampling. In all box plots, the asterisk represents the mean value, while the whiskers extend to the farthest data points within 1.5 times the interquartile range. Significance is denoted as follows: not annotated indicates non-significant; * <italic>P</italic>&lt;0.05; ** <italic>P</italic>&lt;0.01; *** <italic>P</italic>&lt;0.001; two-sided paired Student’s T-tests.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig2-figsupp3-v1.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>Robustness analysis of consensus trees.</title><p>Random sampling is performed on the original data at different proportions of 60%, 70%, 80%, and 90%. The MGPfact consensus trajectory predictions are compared with that based on the original, unsampled data using <inline-formula><mml:math id="inf99"><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:math></inline-formula>. In all box plots, the asterisk represents the mean value, while the whiskers extend to the farthest data points within 1.5 times the interquartile range.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig2-figsupp4-v1.tif"/></fig></fig-group><p>Next, we compared the performance of MGPfact with the other algorithms in nine different trajectory types, respectively, for predicting differentiated cell fate (<inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). As a result, MGPfact significantly outperformed more than half of the algorithms tested in the following trajectory types (T-test p&lt;0.1, <xref ref-type="table" rid="table1">Table 1</xref>): disconnected graph (N=5), linear (N=5), bifurcation (N=4), multifurcation (N=4), and tree (N=4). As for the other three metrics, MGPfact also showed advantages in <inline-formula><mml:math id="inf101"><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:math></inline-formula> in linear (N=5), bifurcation (N=3), convergence (N=3); and in <inline-formula><mml:math id="inf102"><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in multifurcation (N=6), bifurcation (N=5). Nevertheless, MGPfact showed limited predictive performance for <inline-formula><mml:math id="inf103"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>MGPfact outperformed state-of-the-art methods in <inline-formula><mml:math id="inf104"><mml:mi>F</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</title><p><italic>P</italic>-values based one-sided paired t-tests suggest that the <inline-formula><mml:math id="inf105"><mml:mi>F</mml:mi><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> scores of MGPfact were significantly higher than those of the other methods for different trajectory types in the test set.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Trajectory Type</th><th align="left" valign="bottom">DPT</th><th align="left" valign="bottom">MonocleDDRTree</th><th align="left" valign="bottom">Monocle3</th><th align="left" valign="bottom">scFates Tree</th><th align="left" valign="bottom">scShaper</th><th align="left" valign="bottom">TinGa</th><th align="left" valign="bottom">TSCAN</th></tr></thead><tbody><tr><td align="left" valign="bottom"> Acyclic Graph</td><td align="left" valign="bottom">0.169</td><td align="left" valign="bottom">0.735</td><td align="left" valign="bottom">0.341</td><td align="left" valign="bottom">0.167</td><td align="left" valign="bottom"><bold>0.006</bold></td><td align="left" valign="bottom">0.485</td><td align="left" valign="bottom"><bold>0.002</bold></td></tr><tr><td align="left" valign="bottom"> Bifurcation</td><td align="left" valign="bottom">0.559</td><td align="left" valign="bottom"><bold>0.001</bold></td><td align="left" valign="bottom"><bold>0.015</bold></td><td align="left" valign="bottom">0.298</td><td align="left" valign="bottom"><bold>0.010</bold></td><td align="left" valign="bottom">0.772</td><td align="left" valign="bottom"><bold>0.002</bold></td></tr><tr><td align="left" valign="bottom"> Convergence</td><td align="left" valign="bottom">0.275</td><td align="left" valign="bottom"><bold>0.059</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.027</bold></td><td align="left" valign="bottom">0.120</td><td align="left" valign="bottom">0.871</td><td align="left" valign="bottom"><bold>0.008</bold></td></tr><tr><td align="left" valign="bottom"> Cycle</td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.002</bold></td><td align="left" valign="bottom">0.114</td><td align="left" valign="bottom">0.991</td><td align="left" valign="bottom">0.659</td><td align="left" valign="bottom">0.982</td></tr><tr><td align="left" valign="bottom"> Disconnected Graph</td><td align="left" valign="bottom"><bold>0.020</bold></td><td align="left" valign="bottom"><bold>0.001</bold></td><td align="left" valign="bottom">0.108</td><td align="left" valign="bottom"><bold>0.007</bold></td><td align="left" valign="bottom"><bold>0.001</bold></td><td align="left" valign="bottom">0.475</td><td align="left" valign="bottom"><bold>0.000</bold></td></tr><tr><td align="left" valign="bottom"> Connected Graph</td><td align="left" valign="bottom"><bold>0.053</bold></td><td align="left" valign="bottom">0.214</td><td align="left" valign="bottom">0.114</td><td align="left" valign="bottom">0.285</td><td align="left" valign="bottom"><bold>0.005</bold></td><td align="left" valign="bottom"><bold>0.057</bold></td><td align="left" valign="bottom"><bold>0.001</bold></td></tr><tr><td align="left" valign="bottom"> Linear</td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom">1.000</td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom">0.980</td></tr><tr><td align="left" valign="bottom"> Multifurcation</td><td align="left" valign="bottom"><bold>0.033</bold></td><td align="left" valign="bottom"><bold>0.001</bold></td><td align="left" valign="bottom"><bold>0.041</bold></td><td align="left" valign="bottom">0.717</td><td align="left" valign="bottom">0.552</td><td align="left" valign="bottom">0.758</td><td align="left" valign="bottom"><bold>0.051</bold></td></tr><tr><td align="left" valign="bottom"> Tree</td><td align="left" valign="bottom"><bold>0.021</bold></td><td align="left" valign="bottom">0.809</td><td align="left" valign="bottom">0.918</td><td align="left" valign="bottom"><bold>0.086</bold></td><td align="left" valign="bottom"><bold>0.000</bold></td><td align="left" valign="bottom">0.993</td><td align="left" valign="bottom"><bold>0.000</bold></td></tr></tbody></table></table-wrap><p>It is also worth noting that in 68 test datasets of real cell populations, MGPfact ranked the top of all seven algorithms for ‘overall score’ (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). As for the individual metric, MGPfact ranked to top for predicting trajectory topology (<inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.721</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><xref ref-type="fig" rid="fig3">Figure 3c</xref>); and the second in trajectory branching (<inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.600</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="fig" rid="fig3">Figure 3b</xref>) with no significant difference with that of the top predictor (scShaper, T-test, p=0.829). These data show that MGPfact can effectively reconstruct the trajectory of cell fate and retrieve relevant biological processes. As for the other metrics in real test datasets, MGPfact was the fifth in the similarity of cell locations (<inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.46</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), and the third in the similarity of gene significance (<inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.735</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). The differences between the metrics of MGPfact and those of the top performers were subtle (<xref ref-type="fig" rid="fig3">Figure 3d–e</xref>, <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Trajectory inference (TI) performance of state-of-the-art methods in 68 test datasets of real cell population.</title><p>(<bold>a</bold>) Overall scores; (<bold>b</bold>) <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>c</bold>) <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>d</bold>) <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>; (<bold>e</bold>) <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>. All results are color-coded based on the trajectory types, with the black line representing the mean value for ranking all methods. The ‘Overall’ assessment is calculated as the geometric mean of all four metrics.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Trajectories identified by different methods on 3 real-world datasets, with reference structures being linear (<bold>a</bold>) dataset-id=real/silver/germline-human-female_li, bifurcation (<bold>b</bold>) dataset-id=real/silver/fibroblast-reprogramming_treutlein, and multifurcation (<bold>c</bold>) dataset-id=real/silver/oligodendrocyte-differentiation-subclusters_marques.</title><p>The first column of each row presents the actual cell development trajectory (‘ground truth’), with black lines representing the trajectory structure and the colored dots indicating cells at different stages. These elements highlight the main paths and key bifurcation points of cell differentiation as a reference for evaluating prediction results. Subsequent columns show the trajectory reconstruction results of MGPfact and other methods. The overall score for each method reflects its accuracy in trajectory inference relative to the gold standard, which is represented in the top-left figure.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig3-figsupp1-v1.tif"/></fig></fig-group><p>We also analyzed three real-world datasets (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>), each representing a unique topology of trajectory: linear, single bifurcation, and multiple bifurcations. MGPfact excelled in capturing key developmental trajectory with branch points (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). In the linear trajectory, MGPfact accurately predicted the absence of bifurcations, aligning well with the ground truth (<inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0.871</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). For the bifurcation trajectory, MGPfact successfully identified the main bifurcation (<inline-formula><mml:math id="inf116"><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0.636</mml:mn></mml:math></inline-formula>). As for the multifurcation trajectory, MGPfact’s prediction is also close to the ground truth, as reflected by the overall score (<inline-formula><mml:math id="inf117"><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>0.566</mml:mn></mml:math></inline-formula>).</p><p>In summary, our data suggest that MGPfact is highly efficient in predicting cell fate in branching trajectory (<inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) and topological structure (<inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). These capabilities align with the primary objectives of the algorithm, namely, effective identification of the branching events in the development processes of cells. In addition, MGPfact performed better in real datasets, suggesting its robustness to noise from real experimental conditions. Nevertheless, trajectory inference by MGPfact is based on factorization of the covariance matrix, hence less performance in <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>  than methods based on full covariance matrix.</p></sec><sec id="s2-2-3"><title>Comparative of time efficiency and memory consumption</title><p>We also compared the runtime and memory usage of different algorithms across 239 test datasets (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). MGPfact’s average maximum memory consumption (<inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn><mml:mi>G</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) is comparable to those of the other algorithms (<inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.55</mml:mn><mml:mo>,</mml:mo><mml:mn>0.91</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>G</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). As a trade-off for its advantages in feature-selection and factorization, MGPfact requires moderately longer execution time than the other algorithms (<inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3.42</mml:mn><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p></sec></sec><sec id="s2-3"><title>MGPfact recovers the trajectory of early postnatal microglia development</title><p>The main advantage of MGPfact lies in the capability to factorize a complex cellular trajectory into bifurcation processes of selected co-expressed genes. To illustrate how MGPfact elucidates the biological process underlying cell fate determination, we applied MGPfact to a scRNA-seq data of microglia development and validated the results with experimental evidences (<xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>).</p><sec id="s2-3-1"><title>MGPfact recovers the determinants of the microglia development</title><p>Utilizing MGPfact, we reconstructed the developmental trajectories of microglia from immature microglia (IM at pseudotime 0) to homeostatic microglia (HM) and proliferative-region-associated microglia (PAM) (<xref ref-type="fig" rid="fig4">Figure 4a–c</xref>, left panel). MGPfact identified three bifurcation processes (<xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>), each corresponding to 74–90 highly weighted genes (HWG, absolute gene weight &gt;0.05) (<xref ref-type="fig" rid="fig4">Figure 4a–c</xref>, right panel).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>MGPfact reconstructed the developmental trajectory of microglia, recovering known determinants of microglia fate.</title><p>(<bold>a-c</bold>) The inferred independent bifurcation processes with respect to the unique cell types (color-coded) of microglia development, where phase 0 corresponds to the state before bifurcation; and phases 1 and 2 correspond to the states post-bifurcation. Each colored dot represents a metacell of unique cell type defined by MURP. The most highly weighted regulons in each trajectory were labeled by the corresponding transcription factors (left panels). The HWG of each bifurcation process include a set of highly weighted genes, of which the expression levels differ significantly among phases 1, 2, and 3 (right panels). (<bold>d</bold>) The most highly weighted regulons influencing the three developmental trajectories of microglia. (<bold>e</bold>) The expression levels of the transcription factors of highly weighted regulons in each trajectory significantly differ among different phases. (<bold>f</bold>) The consensus developmental trajectory by merging the three bifurcation processes. Point 0 denotes the initial of differentiation, whereas the notion of ‘<italic>n-m’</italic> denotes the <italic>m-</italic>th branch from the branching point <italic>n</italic>. Each colored circle represents a landmark (MURP) of the trajectory, showing the fraction of cell types. The transcription factors of highly weighted regulons in each bifurcation process were used to label each branching point. Particularly, PAM-T1 and PAM-T2 are the two newly defined subtypes of PAM. (<bold>g</bold>) Selected differently expressed genes between PAM-T1 and PAM-T2 (|logfc|&gt;0.25, adjusted <italic>P</italic>-value &lt;0.1) are shown by colored-dots corresponding to the mean expression levels in either cell type. The IDs validated marker genes for PAM are labeled in green. In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance is denoted as: ns, not significant, * <italic>P</italic>&lt;0.05, ** <italic>P</italic>&lt;0.01, *** <italic>P</italic>&lt;0.001, **** <italic>P</italic>&lt;0.0001, Wilcoxon rank-sum test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig4-v1.tif"/></fig><p>The first bifurcation determines the differentiated cell fates of PAM and HM, which involves a set of notable marker genes of both cell types, such as Apoe, Selplg (HM), and Gpnmb (PAM). The second bifurcation determines the proliferative status, which is crucial for the development and function of PAM and HM (<xref ref-type="bibr" rid="bib15">Guzmán, 2022</xref>; <xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>). The genes affected by the second bifurcation are associated with cell cycle and proliferation, such as Mki67, Tubb5, Top2a. The third bifurcation influences the development and maturity of microglia, of which the highly weighted genes, such as Tmem119, P2ry12, and Sepp1 are all previously annotated markers for the establishment of the fates of microglia (<xref ref-type="bibr" rid="bib3">Anderson et al., 2022</xref>; <xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>; <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>).</p><p>Moreover, we retrieved highly active regulons from the HWG by MGPfact, of which the significance is quantified by the overall weights of the member genes. These data unveiled highly active transcription regulations in each bifurcation processes, which further traced back to the influential transcription factors as determinants of microglia development, such as Hif1a, E2f5, and Nfkb1 (<xref ref-type="fig" rid="fig4">Figure 4d–e</xref>, Methods). Specifically, Hif1a is crucial for microglial activation and directly linked to neurodegenerative disease progression (<xref ref-type="bibr" rid="bib51">Wang et al., 2022</xref>). Our data showed an upregulation of Hif1a in the PAM-branch (phase 1) of the first bifurcation, reaffirming the role of Hif1a in PAM differentiation. The other two transcription factors, E2f5 and Nfkb1, were active in phase 2 of the second bifurcation and the third bifurcation, respectively. Both are known for the roles in microglial development (<xref ref-type="bibr" rid="bib11">Dresselhaus and Meffert, 2019</xref>; <xref ref-type="bibr" rid="bib29">Nawal, 2017</xref>).</p></sec><sec id="s2-3-2"><title>Using consensus trajectories to delineate the development of microglial cells</title><p>We generated a consensus trajectory of microglial development from three independent bifurcation processes (Methods). Of note, the consensus trajectory revealed two distinct subtypes of proliferative-region-associated microglia (PAM), PAM-T1 (Hif1a+/E2f5-/Nfkb1+), and PAM-T2 (Hif1a+/E2f5-/Nfkb1-) (<xref ref-type="fig" rid="fig4">Figure 4f</xref>). Particularly, the highly expressed genes in PAM-T2, including Spp1, Gpnmb, Lgals1, and Cd63, are previously identified in disease-associated microglia (DAM) (<xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>). Thus, our finding reaffirmed the connection between the two cell types, DAM and PAM, and suggested Nfkb1 as a potential determinant of differentiation of PAM (<xref ref-type="fig" rid="fig4">Figure 4g</xref>, <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>).</p><p>In conclusion, MGPfact reconstructed the cellular trajectory of microglial development, identified distinct cell types with marker genes and key regulators which are highly consistent to the experimental evidences (<xref ref-type="bibr" rid="bib11">Dresselhaus and Meffert, 2019</xref>; <xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>; <xref ref-type="bibr" rid="bib29">Nawal, 2017</xref>; <xref ref-type="bibr" rid="bib51">Wang et al., 2022</xref>).</p></sec></sec><sec id="s2-4"><title>Using MGPfact to decipher the evolution of tumor-associated CD8<sup>+</sup> T cells</title><p>Next, we applied MGPfact to two populations of tumor-associated CD8<sup>+</sup> T cells from non-small cell lung cancer (NSCLC)(<xref ref-type="bibr" rid="bib14">Guo et al., 2018</xref>) and colorectal cancer (CRC) (<xref ref-type="bibr" rid="bib54">Zhang et al., 2018</xref>), respectively. Using the same analytical pipeline as above, we identified a set of CD8<sup>+</sup> T cell gene expression signatures (GES) from MGPfact-inferred trajectories, which are significantly predictive of clinical outcomes and immune treatment responses. Additionally, our data unveiled novel subtypes of tumor-associated CD8<sup>+</sup> T cells with strong clinical implications.</p><sec id="s2-4-1"><title>MGPfact better explains the fate of tumor-associated CD8<sup>+</sup> T cells</title><p>We assessed the goodness-of-fit (adjusted R-square) of the consensus trajectory derived by MGPfact and three methods (Monocle 2, Monocle 3, and scFates Tree) for the CD8<sup>+</sup> T cell subtypes described in the original studies (<xref ref-type="bibr" rid="bib14">Guo et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Zhang et al., 2018</xref>). The data showed that MGPfact significantly improved the explanatory power for most CD8<sup>+</sup> T cell subtypes over Monocle 2, which was used in the original studies (p&lt;0.05, see <xref ref-type="table" rid="table2">Table 2</xref> and <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>), except for the CD8-GZMK cells in the CRC dataset. Additionally, MGPfact demonstrated better explanatory power in specific cell types when compared to Monocle 3 and scFates Tree. For instance, in the NSCLC dataset, MGPfact exhibited higher explanatory power for CD8-LEF1 cells (<xref ref-type="table" rid="table2">Table 2</xref>, R-squared=0.935), while Monocle 3 and scFates Tree perform better in other cell types.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Comparison of the explanatory power for CD8<sup>+</sup> T cell fate for MGPfact and three other different methods.</title><p>Adjusted R-squared values and P-values based on F-tests demonstrate the relative performance of MGPfact, Monocle 2, Monocle 3, and scFates Tree in fitting the experimentally characterized and annotated CD8<sup>+</sup> T cell subtypes.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom" colspan="2">MGPfact</th><th align="left" valign="bottom" colspan="2">Monocle 2</th><th align="left" valign="bottom" colspan="2">Monocle 3</th><th align="left" valign="bottom" colspan="2">scFates Tree</th></tr></thead><tbody><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"/><td align="left" valign="bottom"><bold>Adjust R<sup>2</sup></bold></td><td align="left" valign="bottom"><bold>p</bold></td><td align="left" valign="bottom"><bold>Adjust R<sup>2</sup></bold></td><td align="left" valign="bottom"><bold>p</bold></td><td align="left" valign="bottom"><bold>Adjust R<sup>2</sup></bold></td><td align="left" valign="bottom"><bold>p</bold></td><td align="left" valign="bottom"><bold>Adjust R<sup>2</sup></bold></td><td align="left" valign="bottom"><bold>p</bold></td></tr><tr><td align="left" valign="bottom" rowspan="6">NSCLC (GSE99254)</td><td align="left" valign="bottom">CD8-LEF1</td><td align="left" valign="bottom"><bold>0.935</bold></td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.176</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.089</td><td align="left" valign="bottom">0.08</td><td align="left" valign="bottom">0.902</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-CD28</td><td align="left" valign="bottom"><bold>0.195</bold></td><td align="left" valign="bottom">0.002</td><td align="left" valign="bottom">0.170</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.108</td><td align="left" valign="bottom">0.06</td><td align="left" valign="bottom">0.006</td><td align="left" valign="bottom">0.145</td></tr><tr><td align="left" valign="bottom">CD8-CX3CR1</td><td align="left" valign="bottom">0.634</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.259</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.629</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom"><bold>0.882</bold></td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-GZMK</td><td align="left" valign="bottom">0.259</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.189</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom"><bold>0.855</bold></td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.547</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-ZNF683</td><td align="left" valign="bottom">0.232</td><td align="left" valign="bottom">0.001</td><td align="left" valign="bottom">0.051</td><td align="left" valign="bottom">0.043</td><td align="left" valign="bottom"><bold>0.625</bold></td><td align="left" valign="bottom">0.003</td><td align="left" valign="bottom">0.039</td><td align="left" valign="bottom">0.003</td></tr><tr><td align="left" valign="bottom">CD8-LAYN</td><td align="left" valign="bottom">0.435</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.031</td><td align="left" valign="bottom">0.027</td><td align="left" valign="bottom">0.503</td><td align="left" valign="bottom">0.018</td><td align="left" valign="bottom"><bold>0.523</bold></td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom" rowspan="7">CRC (GSE108989)</td><td align="left" valign="bottom">CD8-LEF1</td><td align="left" valign="bottom">0.311</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.027</td><td align="left" valign="bottom">0.036</td><td align="left" valign="bottom">0.461</td><td align="left" valign="bottom">0.007</td><td align="left" valign="bottom"><bold>0.99</bold></td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-GPR183</td><td align="left" valign="bottom">0.380</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.032</td><td align="left" valign="bottom">0.025</td><td align="left" valign="bottom"><bold>0.474</bold></td><td align="left" valign="bottom">0.006</td><td align="left" valign="bottom">0.139</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-CX3CR1</td><td align="left" valign="bottom">0.648</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.047</td><td align="left" valign="bottom">0.008</td><td align="left" valign="bottom">0.454</td><td align="left" valign="bottom">0.007</td><td align="left" valign="bottom"><bold>0.817</bold></td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-GZMK</td><td align="left" valign="bottom">0.130</td><td align="left" valign="bottom">0.013</td><td align="left" valign="bottom">0.550</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom"><bold>0.855</bold></td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.236</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-CD6</td><td align="left" valign="bottom">0.277</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.109</td><td align="left" valign="bottom">0.007</td><td align="left" valign="bottom"><bold>0.45</bold></td><td align="left" valign="bottom">0.008</td><td align="left" valign="bottom">0.054</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-CD160</td><td align="left" valign="bottom">0.124</td><td align="left" valign="bottom">0.016</td><td align="left" valign="bottom">0.080</td><td align="left" valign="bottom">0.025</td><td align="left" valign="bottom"><bold>0.856</bold></td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.707</td><td align="left" valign="bottom">0.000</td></tr><tr><td align="left" valign="bottom">CD8-LAYN</td><td align="left" valign="bottom"><bold>0.741</bold></td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.172</td><td align="left" valign="bottom">0.000</td><td align="left" valign="bottom">0.373</td><td align="left" valign="bottom">0.021</td><td align="left" valign="bottom">0.505</td><td align="left" valign="bottom">0.000</td></tr></tbody></table></table-wrap></sec><sec id="s2-4-2"><title>MGPfact identifies T-cell gene expression signatures with clinical implications</title><p>MGPfact discerned the different cellular fates of tumor-associated CD8<sup>+</sup> T cells by distinct bifurcation processes. To reveal the clinical implications of these bifurcation processes, we retrieved the mean expression vectors corresponding to either phase (branch) as GES, and stratified cancer cohorts by quantifying the propensities to certain destiny of CD8<sup>+</sup> T cells (Methods). Our data demonstrated pronounced disparities in the clinical outcomes associated with different fates of CD8<sup>+</sup> T cells among patients (<xref ref-type="fig" rid="fig5">Figure 5a-b</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2c</xref>). In NSCLC, trajectory 1 is associated with cytotoxic T cells (96%, phase 1) and higher overall survival in TCGA-lung adenocarcinoma (LUAD) patients. Trajectory 2 is associated with exhausted T cells (91%, phase 2), and lower overall survival in the same cohort (<xref ref-type="fig" rid="fig5">Figure 5a</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1a-b</xref>). Similarly, in the CRC, trajectory 1 is associated with exhausted T cells (95%, phase 1) and poor overall survival in TCGA-COAD patients (<xref ref-type="fig" rid="fig5">Figure 5b</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2a-b</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Highly weighted genes (HWG) of the bifurcation processes of CD8<sup>+</sup> T cells serve as reliable indicators for clinical outcome and immune checkpoint inhibitor (ICI) treatment response.</title><p>(<bold>a</bold>) Gene expression signatures (GES) corresponding to HWG in CD8<sup>+</sup> T cells trajectory 1 and 2 in non-small cell lung cancer (NSCLC) predict overall survival of the TCGA-LUAD cohort. (<bold>b</bold>) GES corresponding to HWG in CD8<sup>+</sup> T cells trajectory 1 in colorectal cancer (CRC) predict overall survival of the TCGA-COAD cohort. (<bold>c</bold>) ROC curve showing the weighted mean of HWG in Trajectories 1 and 2 in NSCLC significantly associated with ICI response across three independent studies. (<bold>d</bold>) ROC curve showing the weighted mean of HWG in trajectories 1 and 2 in CRC significantly associated with ICI response across four independent studies.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Differentiation process and determinants of CD8<sup>+</sup> T cells from non-small cell lung cancer (NSCLC) environment.</title><p>(<bold>a</bold>) The independent trajectories, where phase 0 represents the juncture before bifurcation, while phases 1 and 2 represent the diverging branches post-bifurcation. (<bold>b</bold>) Proportions of cell types in different phases of independent trajectories; (<bold>c</bold>) The regulon weight of top regulons of two trajectories. (<bold>d</bold>) The differential expression of top transcription factors among different phases for each trajectory. In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance denoted as: *p&lt;0.05, ****p&lt;0.0001, two-sided unpaired Student’s t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig5-figsupp1-v1.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Differentiation process and determinants of CD8<sup>+</sup> T cells from colorectal cancer (CRC) environment.</title><p>(<bold>a</bold>) The independent trajectories, where phase 0 represents the juncture before bifurcation, while phases 1 and 2 represent the diverging branches post-bifurcation. (<bold>b</bold>) Proportions of cell types in different phases of independent trajectories; (<bold>c</bold>) The regulon weight of top regulons of two trajectories. (<bold>d</bold>) The differential expression of top transcription factors among different phases for each trajectory. (<bold>e</bold>) Survival analysis of the patients from TCGA-COAD cohort. The patients are stratified by utilizing the branch event within trajectory 2 from MGPfact analysis. p-values are calculated using multivariate Cox regression, with HR representing the hazard ratio. (<bold>f</bold>) ROC curve for immune checkpoint inhibitor (ICI) treatment response associated with highly weighted genes related to Trajectories 2 in CRC across four independent studies. In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance denoted as: ns, not significant, *p&lt;0.05, **p&lt;0.01, ***p&lt;0.001, ****p&lt;0.0001, two-sided unpaired Student’s t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig5-figsupp2-v1.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>In non-small cell lung cancer (NSCLC), the weighted mean of highly weighted genes (HWG) from independent differentiation trajectories differs between phases (<bold>a, c</bold>) and immune checkpoint inhibitor (ICI) treatment groups.</title><p>(<bold>a-b</bold>) The HWG obtained from the first branching event. (<bold>c-d</bold>) The HWG obtained from the first branching event. In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance denoted as: ns, not significant, *p&lt;0.05, two-sided unpaired Student’s t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig5-figsupp3-v1.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>In colorectal cancer (CRC), the weighted mean of highly weighted genes (HWG) from independent differentiation trajectories differs between phases (<bold>a, c</bold>) and immune checkpoint inhibitor (ICI) treatment groups.</title><p>(<bold>a-b</bold>) The HWG obtained from the first branching event. (<bold>c-d</bold>) The HWG obtained from the first branching event. In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance denoted as: ns, not significant, *p&lt;0.05, ****p&lt;0.0001, two-sided unpaired Student’s t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig5-figsupp4-v1.tif"/></fig></fig-group><p>In addition, for each trajectory identified in NSCLC and CRC, we selected a set of HWG (absolute gene weight &gt;0.05) to characterize the underlying biological processes and key transcription factors determining the bifurcation (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>, <xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1a–b</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2a–b</xref>). In NSCLC, the HWG of trajectory 1 are primarily implicated in immune responses associated with antigen processing and presentation (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>), while trajectory 2-HWG involves processes of immune cell migration (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>). For CRC, trajectory 1 is enriched for genes of T cell activation and regulation (<xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>).</p><p>Notably, our data showed that the weighted mean expression of the HWG of CD8<sup>+</sup> T cell trajectories (Methods) are associated with responses to immune checkpoint inhibitors (ICIs) in multiple independent cohorts (<xref ref-type="fig" rid="fig5">Figure 5c-d</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2f</xref>). For instance, the weighted means of HWG of trajectories 1 and 2 in NSCLC which are associated with high activities of cytotoxic T cells, predicted better responses to anti-PD-130 and anti-CTLA-4 (<xref ref-type="bibr" rid="bib9">Cho et al., 2020</xref>; <xref ref-type="bibr" rid="bib25">Liu et al., 2018</xref>), as well as their combination therapies (<xref ref-type="bibr" rid="bib4">Auslander et al., 2018</xref>) (<inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0.813</mml:mn><mml:mo>,</mml:mo><mml:mn>0.964</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <italic>P</italic>&lt;0.1, <xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>). Similarly, HWG pertaining to trajectory 1 in CRC is associated with high proportion of <inline-formula><mml:math id="inf126"><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>R</mml:mi><mml:mi>A</mml:mi></mml:math></inline-formula>(87%, phase 1), hence better responses to immunotherapies in 4 cohorts (<xref ref-type="bibr" rid="bib4">Auslander et al., 2018</xref>; <xref ref-type="bibr" rid="bib9">Cho et al., 2020</xref>; <xref ref-type="bibr" rid="bib21">Jung et al., 2019</xref>; <xref ref-type="bibr" rid="bib25">Liu et al., 2018</xref>) (<inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0.796</mml:mn><mml:mo>,</mml:mo><mml:mn>0.964</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, p&lt;0.01, <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>).</p><p>Taken together, the factorization of scRNA-seq data by MGPfact provides highly relevant gene expression signatures of the fate of tumor-associated CD8<sup>+</sup> T cells, which advances the understanding of the evolution of tumor immune microenvironment (TIME) and predicts clinical outcomes.</p></sec><sec id="s2-4-3"><title>MGPfact identified new subtypes of CD8<sup>+</sup> T cells with clinical implications</title><p>Furthermore, the consensus trajectories of tumor-associated CD8<sup>+</sup> T cells inferred by MGPfact from NSCLC and CRC revealed new subtypes of lymphocytes. In NSCLC, we characterized CD8-ZNF683-T1 (LEF+/TBX21-) and CD8-ZNF683-T2 (LEF+/TBX21+) from CD8-ZNF683 (<xref ref-type="fig" rid="fig6">Figure 6a</xref>). The CD8-ZNF683-T2 cells highly expressed genes associated with ‘pre-exhausted’ state, such as ITGAL, SAMD3, and SLAMF7 (<xref ref-type="bibr" rid="bib32">Pritchard et al., 2023</xref>), many of which are target genes of TBX21. In contrast, CD8-ZNF683-T1 showed lower expression of these genes, hence repellency to the ‘pre-exhausted’ state (<xref ref-type="fig" rid="fig6">Figure 6b</xref>, <xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref>). In CRC, we identified two subtypes of effector memory T cells (CD8-GZMK), CD8-GZMK-T1 (EOMES-/BHLHE40+), and CD8-GZMK-T2 (EOMES-/BHLHE40-) (<xref ref-type="fig" rid="fig6">Figure 6d</xref>). CD8-GZMK-T2 strongly resembles CD8-GZMK, and potentially differentiating into CD8-CD6 (resident memory T cells, <inline-formula><mml:math id="inf128"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and CD8-CD160 (intraepithelial lymphocytes, <inline-formula><mml:math id="inf129"><mml:mi>I</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi></mml:math></inline-formula>); whereas CD8-GZMK-T1 cells demonstrated higher expression of GZMB, indicating an active cytotoxic cell-killing capability (<xref ref-type="bibr" rid="bib50">Trapani, 2001</xref>). Simultaneously, these cells also marked by high expression levels of immune related genes, including OASL, RBPJ, and CTLA4, which are known targets of BHLHE40 (<xref ref-type="bibr" rid="bib27">Lutter et al., 2022</xref>; <xref ref-type="bibr" rid="bib43">Salmon et al., 2022</xref>), implying that BHLHE40 is a modulator of the higher effector activity in CD8-GZMK-T1 (<xref ref-type="fig" rid="fig6">Figure 6e</xref>, <xref ref-type="supplementary-material" rid="supp12">Supplementary file 12</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>MGPfact serves as an effective approach for characterization of new cellular subtypes.</title><p>(<bold>a</bold>) The consensus trajectory of tumor-associated CD8<sup>+</sup> T cells in non-small cell lung cancer (NSCLC) identified CD8-ZNF683-T1 and CD8-ZNF683-T2 as two subtypes of CD8-ZNF683, which are influenced by TBX21. (<bold>b</bold>) Selected differently expressed genes between CD8-ZNF683-T1 and CD8-ZNF683-T2 (|logfc|&gt;0.25, adjusted p-value &lt;0.1). (<bold>c</bold>) High expression of CD8-ZNF683-T1 signatures predicts good overall survival in the TCGA LUAD cohort (Methods). p-values were calculated through multivariate Cox regression analysis, and HR represents hazard ratio. (<bold>d</bold>) The consensus trajectory of tumor-associated CD8<sup>+</sup> T cells in colorectal cancer (CRC) identified CD8-GZMK-T1 and CD8-GZMK-T2 as two subtypes of CD8-GZMK. (<bold>e</bold>) Selected differently expressed genes between CD8-GZMK-T1 and CD8-GZMK-T2 (|logfc|&gt;0.25, adjusted p-value &lt;0.1). (<bold>f</bold>) ROC curve showing high expression of CD8-GZMK-T1 signature associated with ICI treatment response in three independent studies. The consensus trajectory is formed by merging three bifurcation processes. Each colored circle represents a landmark (minimum unbiased representative points, MURP), indicating the cell type.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>The CD8-GZMK-T1 scores between immune checkpoint inhibitor (ICI) treatment response groups (Methods).</title><p>In all box plots, the horizontal line represents the median value, and the whisker extends to the furthest data point within 1.5 times the interquartile range. Significance denoted as: ns, not significant, *p&lt;0.05, two-sided unpaired Student’s t-test.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-fig6-figsupp1-v1.tif"/></fig></fig-group><p>We further derived scores based on the differentially expressed genes of CD8-ZNF683-T1 and CD8-GZMK-T1 (Methods), as measures of the fraction of each subtype in cancer cohorts. In the LUAD cohort of TCGA, increased fraction of CD8-ZNF683-T1 in TIME was associated with favorable outcomes (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). And increased fractions of CD8-GZMK-T1 in TIME were associated with better responses to ICI therapy across three independent cohorts<sup>31–33</sup> (<xref ref-type="fig" rid="fig6">Figure 6f</xref>, <xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>, <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>A</mml:mi><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0.782</mml:mn><mml:mo>,</mml:mo><mml:mn>0.917</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, p&lt;0.1), which were treated with anti-PD-1, anti-CTLA-4 and their combination therapies.</p><p>In conclusion, our data showed the cellular trajectory inferred by MGPfact can be used to elucidate the complex evolutionary processes of tumor-associated CD8<sup>+</sup> T cells, and further inform the characterization of new subtypes of T cells with significant clinical implications.</p></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>scRNA-seq provides a direct, quantitative snapshot of a population of cells in certain biological conditions, thereby revealing the actual cell states and functions. Although existing clustering and embedding algorithms can effectively reveal discrete biological states of cells, these methods become less efficient when depicting continuous evolving of cells over the temporal domain. The introduction of manifold learning offers a new dimension for discovery of relevant biological knowledge in cell fate determination, allowing for a better representation of continuous changes in cells, especially in time-dependent processes such as development, differentiation, and clonal evolution. However, current manifold learning methods face major limitations, such as the need for prior information on pseudotime and cell clustering, and lack of explainability, which restricts their applicability. Additionally, many existing trajectory inference methods do not support gene selection, making it difficult to annotate the results to known biological entities, thereby hindering the interpretation of results and subsequent functional studies.</p><p>We developed MGPfact to overcome the limitations of the existing methods. Inspired by recent studies, MGPfact model the cell fate as mixture of Gaussian processes, which accommodate both continuous evolution pathway and biphasic destiny of cell fate. Thus, MGPfact is capable to distinguish discrete and continuous events in the same trajectory. In addition, by factorizing the mixture of Gaussian processes, MGPfact offers the advantage to select genes corresponding to each bifurcation process and thereby enables full biological annotation and interpretation of the trajectory. As a validation, we showed that gene-selection by MGPfact consistently recapitulated the development of microglia and tumor-associated CD8<sup>+</sup> T cells; and recovered key regulators of distinct cell fate. So far, MGPfact is the only model-based manifold-learning framework which factorizes complex development trajectories into independent bifurcation processes of gene sets.</p><p>We conducted a comprehensive comparison of MGPfact with existing TI methods from various perspectives. This comparison included the correlation of cell sorting, accuracy of branch allocation, similarity of topological structures, and differentially expressed features. It ought to be mentioned that number of principal components used should be determined by the intrinsic biological characteristics of the cell fate-determination. Our experiment based on a limited number of datasets may not represent more complex scenarios in other cell types. For the overall TI-performance, MGPfact demonstrated leading performance across 239 datasets, second only to TinGa. For the performance in branch allocation, which directly reflects the fitness to the outcomes of cell-fate, MGPfact outperformed its counterparts, especially in the topology groups of linear and bifurcation. As for <inline-formula><mml:math id="inf131"><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf132"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, MGPfact performed less well mainly for two reasons. First, MGPfact is designed for bifurcation topology in the cellular trajectory, hence less efficient in inferring complex topologies. Then, MGPfact inference is based on selected gene sets instead of the whole transcriptome, the resulted trajectory correspond only to the bifurcation processes of interest and hence does not necessarily reflect the whole topology of cellular trajectory. Furthermore, MGPfact performed significantly better in trajectory prediction in real cell population compared to the synthetic ones, suggesting the algorithm fit better to the true biological variation and noises.</p><p>To reconstruct the trajectory of cell fate, we merged all the bifurcation processes into a consensus trajectory. In the validation by microglia and tumor-associated CD8<sup>+</sup> T cells, the consensus trajectory revealed highly consistent findings recovering known biology and the marker genes of specific cell states which further inform the transcription factor (TF) determining the fate of cell. In addition, the consensus trajectory revealed new subtypes of cells demonstrating highly relevant transcriptional characteristics. Particularly, we reported new subtypes of tumor-associated CD8<sup>+</sup> T cells characterized by different TBX21 and BHLHE40 activity, both of which are known regulators of CD8<sup>+</sup> T cell functionality (<xref ref-type="bibr" rid="bib27">Lutter et al., 2022</xref>; <xref ref-type="bibr" rid="bib32">Pritchard et al., 2023</xref>; <xref ref-type="bibr" rid="bib43">Salmon et al., 2022</xref>; <xref ref-type="bibr" rid="bib50">Trapani, 2001</xref>). These data suggest that MGPfact is capable to discover gene modules with strong and consistent transcriptional background hence better interpretability. Moreover, the results of MGPfact demonstrated strong clinical relevance. Using MGPfact we retrieved GES which quantitatively measure the propensity and fraction of different fates of CD8<sup>+</sup> T cell. These signatures correspond to important biological processes of T cell activity; and predict clinical outcome and ICI treatment responses from transcriptome data of bulk tumor biopsies, independent of any endogenous feature of the tumor cells.</p><p>Nevertheless, MGPfact also has some limitations, which shall be addressed in future study. Firstly, the complex definition of the bifurcation kernel introduces unfavorable singularity to the Gaussian kernel when considering highly complex trajectories. Additionally, the current trajectory inference by MGPfact is solely based on the temporal domain, neglecting bifurcation processes occurring in space. To overcome these limitations, future models should incorporate spatial dynamics of transcription and RNA velocity data to provide more comprehensive insights of cell fate. Moreover, the reconstruction of cellular trajectories by MGPfact implies independence of each bifurcation processes, which may not reflect real cellular behavior. Therefore, predictions from MGPfact should be interpreted with caution and validated experimentally.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Benchmarking MGPfact to state-of-the-art methods</title><p>We adopted a comprehensive evaluation framework from previous scRNA-seq study to assess the TI performance of MGPfact (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Smolander et al., 2022</xref>; <xref ref-type="bibr" rid="bib49">Todorov et al., 2020</xref>). The validation dataset comprises 110 real data and 229 synthetic data, encompassing nine different cellular trajectory topologies. The ground truth of cellular trajectories of each dataset were inferred and validated by the original study (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>). The synthetic datasets were generated using four simulators: dyngen (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>), dyntoy (<xref ref-type="bibr" rid="bib42">Saelens et al., 2019</xref>), PROSSTT (<xref ref-type="bibr" rid="bib31">Papadopoulos et al., 2019</xref>), and Splatter (<xref ref-type="bibr" rid="bib53">Zappia et al., 2017</xref>), each modeling different trajectory topologies such as linear, branching, and cyclic. Splatter simulates branching events by setting expression states and transition probabilities, dyntoy generates random expression gradients to reflect dynamic changes, and dyngen focuses on complex branching structures within gene regulatory networks.</p><p>The evaluation of TI performance was based on five metrics.</p><list list-type="order"><list-item><p>The Hamming-Ipsen-Mikhailov (HIM) distance is a metric for assessing similarity between two topological structures. It integrates the normalized Hamming distance, which highlights differences in edge lengths, with the Ipsen-Mikhailov distance, which focuses on similarities in degree distributions. By linearly combining these two measures, the HIM distance offers a comprehensive evaluation of both local and global structural differences.</p></list-item><list-item><p>The <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is a metric used to evaluate a model’s accuracy in branch allocation. It represents the harmonic mean of precision and recall, effectively capturing the performance of branch identification. In trajectory inference, <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>F</mml:mi><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> are calculated by assessing the similarity between predicted and actual trajectory branches, emphasizing the Jaccard similarity of branch pairs.</p></list-item><list-item><p>This <inline-formula><mml:math id="inf135"><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> metric measures similarity in intercellular distances between predicted and actual trajectories. It evaluates model accuracy in cell ordering by comparing relative positions of paired cells, highlighting changes in cell positions across states, and reflecting cell differentiation dynamics.</p></list-item><list-item><p>The <inline-formula><mml:math id="inf136"><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> metric evaluates the similarity of key features, such as differentially expressed genes, between predicted and actual trajectories. Using weighted Pearson correlation, it highlights consistent features, reflecting the model’s ability to capture biological variation. This helps identify crucial genes in trajectories and understand the molecular mechanisms of cell state transitions.</p></list-item><list-item><p>The <inline-formula><mml:math id="inf137"><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi></mml:math></inline-formula> score is calculated by taking the geometric mean of the four aforementioned metrics, providing an assessment of overall performance.</p></list-item></list><p>The dataset is divided into two groups: a training set and a testing set (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). We use 100 training datasets to perform the following tasks:</p><list list-type="order"><list-item><p>Determine the optimal number of trajectories: With three set as the default for the number of factorized trajectories, we tested other values (1, 2, 4, and 5) and used paired T-tests to assess whether there are significant changes in MGPfact’s prediction results under different parameter settings.</p></list-item><list-item><p>Verify the critical role of MURP: Randomly select 20, 40, 60, 80, and 100 cells for trajectory inference, map the inference results back to the original data using the KNN graph structure, and compare the prediction results with those obtained through MURP downsampling.</p></list-item><list-item><p>Robustness analysis of the consensus trajectory topology: Perform 60%, 70%, 80%, and 90% sampling on the original data, and then calculate the similarity between the consensus trajectory predictions of MGPfact with and without sampling. A higher score indicates better robustness of the method.</p></list-item></list><p>Subsequently, in 239 test datasets, we compare MGPfact with seven state-of-the-art TI methods using the aforementioned metrics, including Monocle DDRTree (<xref ref-type="bibr" rid="bib34">Qiu et al., 2017b</xref>, <xref ref-type="bibr" rid="bib33">Qiu et al., 2017a</xref>), TSCAN (<xref ref-type="bibr" rid="bib20">Ji and Ji, 2016</xref>), and DPT (<xref ref-type="bibr" rid="bib17">Haghverdi et al., 2016</xref>), as well as four new methods from recent studies: Monocle 3 (<xref ref-type="bibr" rid="bib8">Cao et al., 2019</xref>), scShaper (<xref ref-type="bibr" rid="bib46">Smolander et al., 2022</xref>), scFates Tree (<xref ref-type="bibr" rid="bib12">Faure et al., 2023</xref>), and TinGa (<xref ref-type="bibr" rid="bib49">Todorov et al., 2020</xref>).</p><p>The experimental comparisons were conducted on a CentOS system equipped with 48 CPU cores running at 2.2 GHz and 250 GB of memory. To ensure a uniform comparison, all experiments were performed using a single CPU core. For MGPfact, we tested each resulted trajectory and selected the one with the best ‘overall’ score for comparison. For the other seven methods, default settings are used unless otherwise specified.</p></sec><sec id="s4-2"><title>Application of MGPfact in a microglia single-cell RNA-seq dataset</title><p>We utilized the MGPfact reconstructed the developmental trajectory of microglia from a scRNA-seq dataset, including IM, PAM, and HM (<xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>). In this analysis, we provided a detailed explanation of the analytical steps of MGPfact and the key results. First, we identified three independent developmental pathways and pinpointed HWG associated with each bifurcation process. Then, we retrieved highly active regulons within each bifurcation process, tracing back to the potential influential determinants (transcription factors) in the development of microglia. Finally, we combined all the bifurcation processes into a consensus trajectory, which recovered the known biology of disease-related microglia (PAM), as represented by distinct cellular states and marker genes.</p></sec><sec id="s4-3"><title>Predicting the evolutionary trajectory of tumor-associated CD8<sup>+</sup> T cells</title><p>We utilized MGPfact to conduct an exploratory analysis of the evolution of tumor-associated CD8<sup>+</sup> T cells of non-small cell lung cancer (NSCLC) and colorectal cancer (CRC). We evaluated the goodness-of-fitness of the consensus trajectories from MGPfact to the CD8<sup>+</sup> T cell subtypes identified in the original studies. For comparison, we used Monocle 2 (<xref ref-type="bibr" rid="bib34">Qiu et al., 2017b</xref>, <xref ref-type="bibr" rid="bib33">Qiu et al., 2017a</xref>) as a baseline model.</p><p>For the survival analysis, we extracted GES from each independent bifurcation process to develop classifiers for evolutionary propensity of CD8<sup>+</sup> T cells towards specific fates, based on which we stratified TCGA cancer cohorts and verified their association with clinical outcome.</p><p>To evaluat the association to ICI responses, we used HWG to retrieve key transcription factors related to each bifurcation process and characterized the underlying biological processes. We then assessed their connection to immunotherapy response using weighted means of the HWG.</p><p>Finally, we identified new subtypes based on distinct endpoints of the consensus trajectory and validated their association with clinical outcome and immunotherapy response using the mean of the differently expressed gene (DEG).</p></sec><sec id="s4-4"><title>Single-cell sequencing data processing</title><p>We obtained the original mouse developmental microglia single-cell sequencing data from the GEO accession number GSE123025 (<xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>). Using Seurat (<xref ref-type="bibr" rid="bib7">Butler et al., 2018</xref>; <xref ref-type="bibr" rid="bib47">Stuart et al., 2019</xref>), we replicated the processing steps described in the original study: (1) Normalization by dividing gene expression values by total RNA count, followed by log2 transformation; (2) Selection of highly variable genes (HVGs) using Seurat’s mean.var.plot function, with controlled average expression <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.0125</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and variance <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>; (3) Scaling and centering of the normalized matrix for HVGs, with regression of cell cycle effects. After preprocessing, we grouped cells into IM (P7-C0), PAM (P7-C1 and P7-GPNMB<sup>+</sup>CLEC7A<sup>+</sup>), and HM (P60), resulting in a 4889-gene expression matrix across 1009 cells.</p><p>For analyzing tumor-associated CD8<sup>+</sup> T cells, we utilized scRNA-seq data from lung cancer (GSE99254) (<xref ref-type="bibr" rid="bib14">Guo et al., 2018</xref>) and colorectal cancer (GSE108989) (<xref ref-type="bibr" rid="bib54">Zhang et al., 2018</xref>) in the GEO database. We extracted preprocessed and centralized gene expression matrices of CD8<sup>+</sup> T cells and analyzed them using the same genes and the same method (Monocle 2) as in the original papers or MGPfact for trajectory construction for a direct comparison. The NSCLC data yielded an 888-gene expression matrix across 3700 cells, while the CRC data resulted in a 700-gene expression matrix across 3177 cells.</p></sec><sec id="s4-5"><title>Functional enrichment of highly weighted genes</title><p>For the highly weighted genes (HWG, absolute gene weight &gt;0.05) obtained from independent bifurcation processes, we utilized the R package clusterprofiler (<xref ref-type="bibr" rid="bib52">Yu et al., 2012</xref>) to perform functional annotation using GO terms (<xref ref-type="bibr" rid="bib18">Harris et al., 2004</xref>), including biological process (BP), cellular component (CC), and molecular function (MF). The results with a Benjamini–Hochberg-adjusted p-value less than 0.05 were retained.</p></sec><sec id="s4-6"><title>Transcription factor program analysis</title><p>To comprehensively assess key regulatory factors within each independent trajectory, we performed SCENIC (<xref ref-type="bibr" rid="bib2">Aibar et al., 2017</xref>) transcription factor regulatory program estimation for each analysis case. GENIE3 (<xref ref-type="bibr" rid="bib19">Huynh-Thu et al., 2010</xref>) was used to identify co-expressed modules from the results of MURP (<xref ref-type="bibr" rid="bib35">Ren et al., 2022</xref>) downsampling. RCisTarget (<xref ref-type="bibr" rid="bib1">Aerts et al., 2010</xref>; <xref ref-type="bibr" rid="bib2">Aibar et al., 2017</xref>) was then used to identify regulons before AUCell (<xref ref-type="bibr" rid="bib2">Aibar et al., 2017</xref>) was used to estimate the activity of each regulon. Each regulon comprises a specific transcription factor and its target genes. Finally, we utilize gene weights obtained from MGPfact analysis to evaluate the distinct impact of top regulons on each trajectory.</p></sec><sec id="s4-7"><title>Generating the consensus trajectory</title><p>Following MGPfact decomposition, we obtained multiple independent bifurcation trajectories, each corresponds to a binary tree within the temporal domain. These trajectories were then merged to construct a coherent diffusion tree, representing the consensus trajectory of cells’ fate. The merging process involves initially sorting all trajectories by their bifurcation time. The first (earliest) bifurcation trajectory is chosen as the initial framework, and subsequent trajectories are integrated to the initial framework iteratively by adding the corresponding branches at the bifurcation timepoints. As a result, the trajectories are ultimately merged into a comprehensive binary tree, serving as the consensus trajectory.</p></sec><sec id="s4-8"><title>Assessing consistency of MGPfact-derived CD8<sup>+</sup> T cell subtype trajectories</title><p>In the case study of CD8<sup>+</sup> T cells, by combining independent trajectories, we derive a consensus trajectory representing the complex developmental pathway. To assess the goodness-of-fitness to the CD8<sup>+</sup> T cell subtypes from the original study, we classified the trajectories into several states based on bifurcation points, each corresponding to a distinct stage of the evolutionary process. Then, we evaluated the interactive effects between the states and pseudotime on the fraction of the cell types using F-test (ANOVA). The resulted R-squared (R2), p-values, and F-statistics were used to evaluate the goodness-of-fitness of the models tested hence the explanatory power. For comparison, we used the Monocle 2 as the baseline model for trajectory inference. The differentiation trajectories of Monocle 2 were replicated following the workflow in the original study (<xref ref-type="bibr" rid="bib14">Guo et al., 2018</xref>; <xref ref-type="bibr" rid="bib54">Zhang et al., 2018</xref>).</p></sec><sec id="s4-9"><title>Survival analysis</title><p>We assessed the association of bifurcation processes and specific cell types with the clinical outcomes two cohorts of lung adenocarcinoma (LUAD, N=563) and colon adenocarcinoma (COAD, N=320) data from The Cancer Genome Atlas (TCGA). The gene expression and clinical data were downloaded from UCSC Xena platform (<ext-link ext-link-type="uri" xlink:href="http://xena.ucsc.edu/">http://xena.ucsc.edu/</ext-link>).</p><p>We assessed the survival impacts of NSCLC and CRC bifurcation processes in the TCGA LUAD and COAD cohorts, respectively. For each independent bifurcation process, we defined GES by the mean expression vectors of all trajectories in phase 1 and 2, respectively. Subsequently, we calculated the Pearson’s correlation coefficients for each individual expression profile in TCGA LUAD or COAD cohorts to the phase 1 and 2 GES, where higher correlation corresponds to a stronger propensity to specific cell fate. This allowed us to classify patients into two groups: those exhibiting propensity to phase 1 and those exhibiting propensity to phase 2.</p><p>To assess the survival impacts of specific cell states defined by the consensus trajectory, we developed a CD8-ZNF683-T1 score based on the signed average expression level of DEG associated with CD8-ZNF683-T1. Subsequently, we classified the TCGA LUAD cohorts into two groups using the median of CD8-ZNF683-T1 scores, identifying those demonstrating a propensity towards CD8-ZNF683-T1 and those demonstrating a propensity towards CD8-ZNF683-T2.</p><p>To adjust for possible confounding effects, the relevant clinical features including age, sex, and tumor stage were used as covariates. The Cox regression model was implemented using R-4.2 package ‘survival.’ And, we generated Kaplan-Meier survival curves based on different classifiers to illustrate differences in survival time and report the statistical significance based on Log-rank test.</p></sec><sec id="s4-10"><title>Immune-checkpoint inhibitor treatment response analysis</title><p>For the prediction of Immune-checkpoint inhibitor treatment response, we collected four datasets containing ICI treatment responses. These datasets consist of two non-small cell lung cancer-related datasets (GSE135222 [<xref ref-type="bibr" rid="bib21">Jung et al., 2019</xref>], n=27; GSE126044 [<xref ref-type="bibr" rid="bib9">Cho et al., 2020</xref>], n=16) and two melanoma-related datasets (GSE115821 [<xref ref-type="bibr" rid="bib4">Auslander et al., 2018</xref>], n=14; TCGA-MENO [<xref ref-type="bibr" rid="bib25">Liu et al., 2018</xref>], n=10). All data were processed with DESeq2 (<xref ref-type="bibr" rid="bib26">Love et al., 2014</xref>) to fit gene dispersion to a negative binomial distribution, normalize raw counts, and stabilize variance, achieving standardization.</p><p>To validate the bifurcation processes identified by MGPfact predicting patients' response to immune-checkpoint inhibitor (ICI) treatments, we selected highly weighted genes (HWG) with absolute weights greater than 0.05 from each independent bifurcation process. Then, we calculated the weighted mean expression of HWG in each ICI dataset to generate ROC curves for patient drug response.</p><p>To validate the specific cell states defined by the consensus trajectory predicting patients' response to ICI treatments, we used CD8-GZMK-T1 score based on the average expression level differences of upregulated and downregulated genes associated with CD8- GZMK-T1. Then, we calculated the CD8-GZMK-T1 score in each ICI dataset to generate ROC curves for patient drug response.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Methodology</p></fn><fn fn-type="con" id="con4"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con6"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con7"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con8"><p>Writing – review and editing</p></fn><fn fn-type="con" id="con9"><p>Supervision, Methodology, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>The specific configuration of parameters contained in the model.</title></caption><media xlink:href="elife-97424-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>p-values associated with one-sided paired t-tests assess whether the performance score (across five metrics) of MGPfact is significantly higher than the other methods on the different trajectory types in test set.</title></caption><media xlink:href="elife-97424-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Comparison of memory utilization (GB) and temporal efficiency (min).</title></caption><media xlink:href="elife-97424-supp3-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>The highly weighted genes associated with independent bifurcating processes in microglia development (absolute gene weight &gt;0.05).</title></caption><media xlink:href="elife-97424-supp4-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>List of genes specifically expressed in homeostatic microglia (HM).</title><p>PAM-T1 cells (n=113) vs. PAM-T2 cells (n=298), two-sided moderated t-test with limma.</p></caption><media xlink:href="elife-97424-supp5-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Comparison of the explanatory power for CD8<sup>+</sup> T cell fate for MGPfact and three other different methods.</title><p>Adjusted R-squared values and p-values based on F-tests demonstrate the relative performance of MGPfact, Monocle 2, Monocle 3, and scFates Tree in fitting the experimentally characterized and annotated CD8<sup>+</sup> T cell subtypes.</p></caption><media xlink:href="elife-97424-supp6-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 7.</label><caption><title>The highly weighted genes associated with the CD8<sup>+</sup> T cell-independent bifurcating processes in non-small cell lung cancer (NSCLC) (absolute gene weight &gt;0.05).</title></caption><media xlink:href="elife-97424-supp7-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp8"><label>Supplementary file 8.</label><caption><title>The highly weighted genes associated with the CD8<sup>+</sup> T cell-independent bifurcating processes in colorectal cancer (CRC) (absolute gene weight &gt;0.05).</title></caption><media xlink:href="elife-97424-supp8-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp9"><label>Supplementary file 9.</label><caption><title>GO Enrichment Analysis Results for Highly Weighted Genes Associated with Trajectory 1 of non-small cell lung cancer (NSCLC) (Benjamini–Hochberg-adjusted p-value &lt;0.05).</title></caption><media xlink:href="elife-97424-supp9-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp10"><label>Supplementary file 10.</label><caption><title>GO Enrichment Analysis Results for Highly Weighted Genes Associated with Trajectory 1 of colorectal cancer (CRC) (Benjamini–Hochberg-adjusted p-value &lt;0.05).</title></caption><media xlink:href="elife-97424-supp10-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp11"><label>Supplementary file 11.</label><caption><title>List of genes specifically expressed in CD8-ZNF683.</title><p>CD8-ZNF683-T1 cells (n=204) vs. CD8-ZNF683-T2 cells (n=395), two-sided moderated t-test with limma.</p></caption><media xlink:href="elife-97424-supp11-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp12"><label>Supplementary file 12.</label><caption><title>List of genes specifically expressed in CD8-GZMK.</title><p>CD8-GZMK-T1 cells (n=155) vs. CD8-GZMK-T2 cells (n=221), two-sided moderated t-test with limma.</p></caption><media xlink:href="elife-97424-supp12-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-97424-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The datasets used for method performance comparison are archived on Zenodo platform, with processed real and synthetic datasets available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.1443566">https://doi.org/10.5281/zenodo.1443566</ext-link>. All instance data used in this article can be downloaded from the GEO database with accession numbers GSE123025, GSE99254, and GSE108989.The expression matrices related to immune- checkpoint inhibitors (ICI) and clinical response information used in this article were downloaded from the GEO database (GSE135222; GSE126044, GSE115821) and TCGA (TCGA-SKCM). This is a computational study, in which no new experimental data were generated. We have developed a comprehensive workflow for MGPfact. Firstly, a Docker container enables one-click program execution (details at: <ext-link ext-link-type="uri" xlink:href="https://github.com/renjun0324/ti_mgpfact">https://github.com/renjun0324/ti_mgpfact</ext-link>, copy archived at <xref ref-type="bibr" rid="bib36">Ren, 2025a</xref>). Additionally, to fully harness MGPfact's capabilities, we have created the R package MGPfactR, accessible at: <ext-link ext-link-type="uri" xlink:href="https://github.com/renjun0324/MGPfactR">https://github.com/renjun0324/MGPfactR</ext-link> (copy archived at <xref ref-type="bibr" rid="bib37">Ren, 2025b</xref>). Within this workflow, MCMC sampling for model parameter estimation is carried out using the Mamba library in the Julia environment. The related Julia package can be found here: <ext-link ext-link-type="uri" xlink:href="https://github.com/renjun0324/MGPfact.jl">https://github.com/renjun0324/MGPfact.jl</ext-link> (copy archived at <xref ref-type="bibr" rid="bib38">Ren, 2025c</xref>). Other analysis scripts can be found on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/renjun0324/mgpfact_paper">https://github.com/renjun0324/mgpfact_paper</ext-link> (copy archived at <xref ref-type="bibr" rid="bib39">Ren, 2025d</xref>). And the scFates Tree used in this paper is available as a performance comparison Docker container, constructed using the dendritic trajectory process in scFates, accessible at: <ext-link ext-link-type="uri" xlink:href="https://github.com/renjun0324/ti_scfates_tree">https://github.com/renjun0324/ti_scfates_tree</ext-link> (copy archived at <xref ref-type="bibr" rid="bib40">Renjun0324, 2025</xref>).</p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Song</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Kang</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Xing</surname><given-names>R</given-names></name><name><surname>Gao</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Dong</surname><given-names>M</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Kirchhoff</surname><given-names>D</given-names></name><name><surname>Roider</surname><given-names>HG</given-names></name><name><surname>Yan</surname><given-names>T</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>T cell landscape of non-small cell lung cancer revealed by deep single-cell RNA sequencing</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE99254">GSE99254</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Cheng</surname><given-names>Z</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>Okamoto</surname><given-names>J</given-names></name><name><surname>Gulati</surname><given-names>G</given-names></name><name><surname>Bennett</surname><given-names>ML</given-names></name><name><surname>Sun</surname><given-names>LO</given-names></name><name><surname>Clarke</surname><given-names>LE</given-names></name><name><surname>Marschallinger</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Wyss-Coray</surname><given-names>T</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Deep single-cell RNAseq of microglia and brain myeloid cells from various brain regions and developmental stages</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE123025">GSE123025</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Single-cell -omics datasets containing a trajectory</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.1443566</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>H</given-names></name><name><surname>Kim</surname><given-names>HS</given-names></name><name><surname>Kim</surname><given-names>JY</given-names></name><name><surname>Sun</surname><given-names>JM</given-names></name><name><surname>Ahn</surname><given-names>JS</given-names></name><name><surname>Ahn</surname><given-names>Mj</given-names></name><name><surname>Park</surname><given-names>K</given-names></name><name><surname>Esteller</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>SHJ</given-names></name><name><surname>Choi</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>DNA methylation loss coupled with mitotic cell division promotes immune evasion of tumours with high mutation load [RNA-seq]</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE135222">GSE135222</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset5"><person-group person-group-type="author"><name><surname>Auslander</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>JS</given-names></name><name><surname>Frederick</surname><given-names>DT</given-names></name><name><surname>Miao</surname><given-names>B</given-names></name><name><surname>Moll</surname><given-names>T</given-names></name><name><surname>Tian</surname><given-names>T</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Madan</surname><given-names>S</given-names></name><name><surname>Sullivan</surname><given-names>RJ</given-names></name><name><surname>Boland</surname><given-names>G</given-names></name><name><surname>Flaherty</surname><given-names>K</given-names></name><name><surname>Herlyn</surname><given-names>M</given-names></name><name><surname>Ruppin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Robust prediction of response to immune checkpoint blockade therapy in metastatic melanoma</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115821">GSE115821</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset6"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Yu</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Fang</surname><given-names>Q</given-names></name><name><surname>Gao</surname><given-names>R</given-names></name><name><surname>Kang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Huang</surname><given-names>JY</given-names></name><name><surname>Konno</surname><given-names>H</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name><name><surname>Gao</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Shen</surname><given-names>Z</given-names></name><name><surname>Ouyang</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Lineage tracking reveals dynamic relationships of T cells in colorectal cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE108989">GSE108989</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset7"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>JW</given-names></name><name><surname>Hong</surname><given-names>MH</given-names></name><name><surname>Jun</surname><given-names>SH</given-names></name><name><surname>Kim</surname><given-names>YJ</given-names></name><name><surname>Cho</surname><given-names>BC</given-names></name><name><surname>Lee</surname><given-names>I</given-names></name><name><surname>Kim</surname><given-names>HR</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Genome-wide identification of differentially methylated promoters and enhancers associated with response to anti-PD-1 therapy in non-small cell lung cancer</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE126044">GSE126044</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset8"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Lichtenberg</surname><given-names>T</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Poisson</surname><given-names>LM</given-names></name><name><surname>Lazar</surname><given-names>AJ</given-names></name><name><surname>Cherniack</surname><given-names>AD</given-names></name><name><surname>Kovatich</surname><given-names>AJ</given-names></name><name><surname>Benz</surname><given-names>CC</given-names></name><name><surname>Levine</surname><given-names>DA</given-names></name><name><surname>Lee</surname><given-names>AV</given-names></name><name><surname>Omberg</surname><given-names>L</given-names></name><name><surname>Wolf</surname><given-names>DM</given-names></name><name><surname>Shriver</surname><given-names>CD</given-names></name><name><surname>Thorsson</surname><given-names>V</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><collab>The Cancer Genome Atlas Research Network</collab></person-group><year iso-8601-date="2018">2018</year><data-title>cohort: TCGA Lung Adenocarcinoma (LUAD)</data-title><source>UCSC Genome Browser</source><pub-id pub-id-type="accession" xlink:href="https://xenabrowser.net/datapages/?cohort=TCGA%20Lung%20Adenocarcinoma%20(LUAD)&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443">TCGA-LUAD</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset9"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Lichtenberg</surname><given-names>T</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Poisson</surname><given-names>LM</given-names></name><name><surname>Lazar</surname><given-names>AJ</given-names></name><name><surname>Cherniack</surname><given-names>AD</given-names></name><name><surname>Kovatich</surname><given-names>AJ</given-names></name><name><surname>Benz</surname><given-names>CC</given-names></name><name><surname>Levine</surname><given-names>DA</given-names></name><name><surname>Lee</surname><given-names>AV</given-names></name><name><surname>Omberg</surname><given-names>L</given-names></name><name><surname>Wolf</surname><given-names>DM</given-names></name><name><surname>Shriver</surname><given-names>CD</given-names></name><name><surname>Thorsson</surname><given-names>V</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><collab>The Cancer Genome Atlas Research Network</collab></person-group><year iso-8601-date="2018">2018</year><data-title>cohort: TCGA Colon Cancer (COAD)</data-title><source>UCSC Genome Browser</source><pub-id pub-id-type="accession" xlink:href="https://xenabrowser.net/datapages/?cohort=TCGA%20Colon%20Cancer%20(COAD)&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443">TCGA-COAD</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset10"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Lichtenberg</surname><given-names>T</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Poisson</surname><given-names>LM</given-names></name><name><surname>Lazar</surname><given-names>AJ</given-names></name><name><surname>Cherniack</surname><given-names>AD</given-names></name><name><surname>Kovatich</surname><given-names>AJ</given-names></name><name><surname>Benz</surname><given-names>CC</given-names></name><name><surname>Levine</surname><given-names>DA</given-names></name><name><surname>Lee</surname><given-names>AV</given-names></name><name><surname>Omberg</surname><given-names>L</given-names></name><name><surname>Wolf</surname><given-names>DM</given-names></name><name><surname>Shriver</surname><given-names>CD</given-names></name><name><surname>Thorsson</surname><given-names>V</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><collab>The Cancer Genome Atlas Research Network</collab></person-group><year iso-8601-date="2018">2018</year><data-title>cohort: TCGA Melanoma (SKCM)</data-title><source>UCSC Genome Browser</source><pub-id pub-id-type="accession" xlink:href="https://xenabrowser.net/datapages/?cohort=TCGA%20Melanoma%20(SKCM)&amp;removeHub=https%3A%2F%2Fxena.treehouse.gi.ucsc.edu%3A443">TCGA-SKCM</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Qingyun Li for providing the cell labels for the microglial dataset (<xref ref-type="bibr" rid="bib23">Li et al., 2019</xref>). We would also like to express our gratitude to Nengming Xiao, and Guo Fu for their valuable input and constructive suggestions during the preparation of the manuscript. This work was supported by the Fundamental Research Funds for the National Natural Science Foundation of China [82272944 to QL]; the National Natural Science Foundation of China [82203420 to JG]; the National Key Research and Development Program of China [2022YFC2704801 to QL].</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aerts</surname><given-names>S</given-names></name><name><surname>Quan</surname><given-names>XJ</given-names></name><name><surname>Claeys</surname><given-names>A</given-names></name><name><surname>Naval Sanchez</surname><given-names>M</given-names></name><name><surname>Tate</surname><given-names>P</given-names></name><name><surname>Yan</surname><given-names>J</given-names></name><name><surname>Hassan</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Robust target gene discovery through transcriptome perturbations and genome-wide enhancer predictions in <italic>Drosophila</italic> uncovers a regulatory basis for sensory specification</article-title><source>PLOS Biology</source><volume>8</volume><elocation-id>e1000435</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1000435</pub-id><pub-id pub-id-type="pmid">20668662</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aibar</surname><given-names>S</given-names></name><name><surname>González-Blas</surname><given-names>CB</given-names></name><name><surname>Moerman</surname><given-names>T</given-names></name><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Imrichova</surname><given-names>H</given-names></name><name><surname>Hulselmans</surname><given-names>G</given-names></name><name><surname>Rambow</surname><given-names>F</given-names></name><name><surname>Marine</surname><given-names>J-C</given-names></name><name><surname>Geurts</surname><given-names>P</given-names></name><name><surname>Aerts</surname><given-names>J</given-names></name><name><surname>van den Oord</surname><given-names>J</given-names></name><name><surname>Atak</surname><given-names>ZK</given-names></name><name><surname>Wouters</surname><given-names>J</given-names></name><name><surname>Aerts</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title><source>Nature Methods</source><volume>14</volume><fpage>1083</fpage><lpage>1086</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id><pub-id pub-id-type="pmid">28991892</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>SR</given-names></name><name><surname>Roberts</surname><given-names>JM</given-names></name><name><surname>Ghena</surname><given-names>N</given-names></name><name><surname>Irvin</surname><given-names>EA</given-names></name><name><surname>Schwakopf</surname><given-names>J</given-names></name><name><surname>Cooperstein</surname><given-names>IB</given-names></name><name><surname>Bosco</surname><given-names>A</given-names></name><name><surname>Vetter</surname><given-names>ML</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Neuronal apoptosis drives remodeling states of microglia and shifts in survival pathway dependence</article-title><source>eLife</source><volume>11</volume><elocation-id>e76564</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.76564</pub-id><pub-id pub-id-type="pmid">35481836</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auslander</surname><given-names>N</given-names></name><name><surname>Zhang</surname><given-names>G</given-names></name><name><surname>Lee</surname><given-names>JS</given-names></name><name><surname>Frederick</surname><given-names>DT</given-names></name><name><surname>Miao</surname><given-names>B</given-names></name><name><surname>Moll</surname><given-names>T</given-names></name><name><surname>Tian</surname><given-names>T</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Madan</surname><given-names>S</given-names></name><name><surname>Sullivan</surname><given-names>RJ</given-names></name><name><surname>Boland</surname><given-names>G</given-names></name><name><surname>Flaherty</surname><given-names>K</given-names></name><name><surname>Herlyn</surname><given-names>M</given-names></name><name><surname>Ruppin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Robust prediction of response to immune checkpoint blockade therapy in metastatic melanoma</article-title><source>Nature Medicine</source><volume>24</volume><fpage>1545</fpage><lpage>1549</lpage><pub-id pub-id-type="doi">10.1038/s41591-018-0157-9</pub-id><pub-id pub-id-type="pmid">30127394</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becht</surname><given-names>E</given-names></name><name><surname>McInnes</surname><given-names>L</given-names></name><name><surname>Healy</surname><given-names>J</given-names></name><name><surname>Dutertre</surname><given-names>CA</given-names></name><name><surname>Kwok</surname><given-names>IWH</given-names></name><name><surname>Ng</surname><given-names>LG</given-names></name><name><surname>Ginhoux</surname><given-names>F</given-names></name><name><surname>Newell</surname><given-names>EW</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>38</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Brian</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2014">2014</year><data-title>Mamba: markov chain monte carlo for bayesian analysis in julia</data-title><version designator="0.12.0">0.12.0</version><source>Github</source><ext-link ext-link-type="uri" xlink:href="https://github.com/brian-j-smith/Mamba.jl">https://github.com/brian-j-smith/Mamba.jl</ext-link></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title><source>Nature Biotechnology</source><volume>36</volume><fpage>411</fpage><lpage>420</lpage><pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>J</given-names></name><name><surname>Spielmann</surname><given-names>M</given-names></name><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Ibrahim</surname><given-names>DM</given-names></name><name><surname>Hill</surname><given-names>AJ</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Mundlos</surname><given-names>S</given-names></name><name><surname>Christiansen</surname><given-names>L</given-names></name><name><surname>Steemers</surname><given-names>FJ</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Shendure</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title><source>Nature</source><volume>566</volume><fpage>496</fpage><lpage>502</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id><pub-id pub-id-type="pmid">30787437</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>JW</given-names></name><name><surname>Hong</surname><given-names>MH</given-names></name><name><surname>Ha</surname><given-names>SJ</given-names></name><name><surname>Kim</surname><given-names>YJ</given-names></name><name><surname>Cho</surname><given-names>BC</given-names></name><name><surname>Lee</surname><given-names>I</given-names></name><name><surname>Kim</surname><given-names>HR</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Genome-wide identification of differentially methylated promoters and enhancers associated with response to anti-PD-1 therapy in non-small cell lung cancer</article-title><source>Experimental &amp; Molecular Medicine</source><volume>52</volume><fpage>1550</fpage><lpage>1563</lpage><pub-id pub-id-type="doi">10.1038/s12276-020-00493-8</pub-id><pub-id pub-id-type="pmid">32879421</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costa</surname><given-names>F</given-names></name><name><surname>Grün</surname><given-names>D</given-names></name><name><surname>Backofen</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>GraphDDP: a graph-embedding approach to detect differentiation pathways in single-cell-data using prior class knowledge</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>3685</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-05988-7</pub-id><pub-id pub-id-type="pmid">30206223</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dresselhaus</surname><given-names>EC</given-names></name><name><surname>Meffert</surname><given-names>MK</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cellular specificity of nf-κb function in the nervous system</article-title><source>Frontiers in Immunology</source><volume>10</volume><elocation-id>1043</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2019.01043</pub-id><pub-id pub-id-type="pmid">31143184</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faure</surname><given-names>L</given-names></name><name><surname>Soldatov</surname><given-names>R</given-names></name><name><surname>Kharchenko</surname><given-names>PV</given-names></name><name><surname>Adameyko</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>scFates: a scalable python package for advanced pseudotime and bifurcation analysis from single-cell data</article-title><source>Bioinformatics</source><volume>39</volume><elocation-id>btac746</elocation-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btac746</pub-id><pub-id pub-id-type="pmid">36394263</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Fritzke</surname><given-names>B</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>A growing neural gas network learns topologies</article-title><conf-name>NIPS Papers</conf-name></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Zheng</surname><given-names>C</given-names></name><name><surname>Song</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Kang</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name><name><surname>Xing</surname><given-names>R</given-names></name><name><surname>Gao</surname><given-names>R</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Dong</surname><given-names>M</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Kirchhoff</surname><given-names>D</given-names></name><name><surname>Roider</surname><given-names>HG</given-names></name><name><surname>Yan</surname><given-names>T</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing</article-title><source>Nature Medicine</source><volume>24</volume><fpage>978</fpage><lpage>985</lpage><pub-id pub-id-type="doi">10.1038/s41591-018-0045-3</pub-id><pub-id pub-id-type="pmid">29942094</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="thesis"><person-group person-group-type="author"><name><surname>Guzmán</surname><given-names>AU</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>PhD dissertation Single-cell RNA sequencing of spinal cord microglia in a mouse model of neuropathic pain</article-title><publisher-name>McGill University</publisher-name></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L</given-names></name><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title><source>Bioinformatics</source><volume>31</volume><fpage>2989</fpage><lpage>2998</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv325</pub-id><pub-id pub-id-type="pmid">26002886</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haghverdi</surname><given-names>L</given-names></name><name><surname>Büttner</surname><given-names>M</given-names></name><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Buettner</surname><given-names>F</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title><source>Nature Methods</source><volume>13</volume><fpage>845</fpage><lpage>848</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id><pub-id pub-id-type="pmid">27571553</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harris</surname><given-names>MA</given-names></name><name><surname>Clark</surname><given-names>J</given-names></name><name><surname>Ireland</surname><given-names>A</given-names></name><name><surname>Lomax</surname><given-names>J</given-names></name><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Foulger</surname><given-names>R</given-names></name><name><surname>Eilbeck</surname><given-names>K</given-names></name><name><surname>Lewis</surname><given-names>S</given-names></name><name><surname>Marshall</surname><given-names>B</given-names></name><name><surname>Mungall</surname><given-names>C</given-names></name><name><surname>Richter</surname><given-names>J</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><name><surname>Bult</surname><given-names>C</given-names></name><name><surname>Dolan</surname><given-names>M</given-names></name><name><surname>Drabkin</surname><given-names>H</given-names></name><name><surname>Eppig</surname><given-names>JT</given-names></name><name><surname>Hill</surname><given-names>DP</given-names></name><name><surname>Ni</surname><given-names>L</given-names></name><name><surname>Ringwald</surname><given-names>M</given-names></name><name><surname>Balakrishnan</surname><given-names>R</given-names></name><name><surname>Cherry</surname><given-names>JM</given-names></name><name><surname>Christie</surname><given-names>KR</given-names></name><name><surname>Costanzo</surname><given-names>MC</given-names></name><name><surname>Dwight</surname><given-names>SS</given-names></name><name><surname>Engel</surname><given-names>S</given-names></name><name><surname>Fisk</surname><given-names>DG</given-names></name><name><surname>Hirschman</surname><given-names>JE</given-names></name><name><surname>Hong</surname><given-names>EL</given-names></name><name><surname>Nash</surname><given-names>RS</given-names></name><name><surname>Sethuraman</surname><given-names>A</given-names></name><name><surname>Theesfeld</surname><given-names>CL</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Dolinski</surname><given-names>K</given-names></name><name><surname>Feierbach</surname><given-names>B</given-names></name><name><surname>Berardini</surname><given-names>T</given-names></name><name><surname>Mundodi</surname><given-names>S</given-names></name><name><surname>Rhee</surname><given-names>SY</given-names></name><name><surname>Apweiler</surname><given-names>R</given-names></name><name><surname>Barrell</surname><given-names>D</given-names></name><name><surname>Camon</surname><given-names>E</given-names></name><name><surname>Dimmer</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>V</given-names></name><name><surname>Chisholm</surname><given-names>R</given-names></name><name><surname>Gaudet</surname><given-names>P</given-names></name><name><surname>Kibbe</surname><given-names>W</given-names></name><name><surname>Kishore</surname><given-names>R</given-names></name><name><surname>Schwarz</surname><given-names>EM</given-names></name><name><surname>Sternberg</surname><given-names>P</given-names></name><name><surname>Gwinn</surname><given-names>M</given-names></name><name><surname>Hannick</surname><given-names>L</given-names></name><name><surname>Wortman</surname><given-names>J</given-names></name><name><surname>Berriman</surname><given-names>M</given-names></name><name><surname>Wood</surname><given-names>V</given-names></name><name><surname>de la Cruz</surname><given-names>N</given-names></name><name><surname>Tonellato</surname><given-names>P</given-names></name><name><surname>Jaiswal</surname><given-names>P</given-names></name><name><surname>Seigfried</surname><given-names>T</given-names></name><name><surname>White</surname><given-names>R</given-names></name><collab>Gene Ontology Consortium</collab></person-group><year iso-8601-date="2004">2004</year><article-title>The Gene Ontology (GO) database and informatics resource</article-title><source>Nucleic Acids Research</source><volume>32</volume><fpage>D258</fpage><lpage>D261</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh036</pub-id><pub-id pub-id-type="pmid">14681407</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name><name><surname>Irrthum</surname><given-names>A</given-names></name><name><surname>Wehenkel</surname><given-names>L</given-names></name><name><surname>Geurts</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Inferring regulatory networks from expression data using tree-based methods</article-title><source>PLOS ONE</source><volume>5</volume><elocation-id>e12776</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0012776</pub-id><pub-id pub-id-type="pmid">20927193</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>Z</given-names></name><name><surname>Ji</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title><source>Nucleic Acids Research</source><volume>44</volume><elocation-id>e117</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkw430</pub-id><pub-id pub-id-type="pmid">27179027</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jung</surname><given-names>H</given-names></name><name><surname>Kim</surname><given-names>HS</given-names></name><name><surname>Kim</surname><given-names>JY</given-names></name><name><surname>Sun</surname><given-names>JM</given-names></name><name><surname>Ahn</surname><given-names>JS</given-names></name><name><surname>Ahn</surname><given-names>MJ</given-names></name><name><surname>Park</surname><given-names>K</given-names></name><name><surname>Esteller</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>SH</given-names></name><name><surname>Choi</surname><given-names>JK</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>DNA methylation loss promotes immune evasion of tumours with high mutation and copy number load</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4278</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12159-9</pub-id><pub-id pub-id-type="pmid">31537801</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lange</surname><given-names>M</given-names></name><name><surname>Bergen</surname><given-names>V</given-names></name><name><surname>Klein</surname><given-names>M</given-names></name><name><surname>Setty</surname><given-names>M</given-names></name><name><surname>Reuter</surname><given-names>B</given-names></name><name><surname>Bakhti</surname><given-names>M</given-names></name><name><surname>Lickert</surname><given-names>H</given-names></name><name><surname>Ansari</surname><given-names>M</given-names></name><name><surname>Schniering</surname><given-names>J</given-names></name><name><surname>Schiller</surname><given-names>HB</given-names></name><name><surname>Pe’er</surname><given-names>D</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>CellRank for directed single-cell fate mapping</article-title><source>Nature Methods</source><volume>19</volume><fpage>159</fpage><lpage>170</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01346-6</pub-id><pub-id pub-id-type="pmid">35027767</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Cheng</surname><given-names>Z</given-names></name><name><surname>Zhou</surname><given-names>L</given-names></name><name><surname>Darmanis</surname><given-names>S</given-names></name><name><surname>Neff</surname><given-names>NF</given-names></name><name><surname>Okamoto</surname><given-names>J</given-names></name><name><surname>Gulati</surname><given-names>G</given-names></name><name><surname>Bennett</surname><given-names>ML</given-names></name><name><surname>Sun</surname><given-names>LO</given-names></name><name><surname>Clarke</surname><given-names>LE</given-names></name><name><surname>Marschallinger</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Quake</surname><given-names>SR</given-names></name><name><surname>Wyss-Coray</surname><given-names>T</given-names></name><name><surname>Barres</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Developmental heterogeneity of microglia and brain myeloid cells revealed by deep single-cell rna sequencing</article-title><source>Neuron</source><volume>101</volume><fpage>207</fpage><lpage>223</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2018.12.006</pub-id><pub-id pub-id-type="pmid">30606613</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>scTour: a deep learning architecture for robust inference and accurate prediction of cellular dynamics</article-title><source>Genome Biology</source><volume>24</volume><elocation-id>149</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-023-02988-9</pub-id><pub-id pub-id-type="pmid">37353848</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Lichtenberg</surname><given-names>T</given-names></name><name><surname>Hoadley</surname><given-names>KA</given-names></name><name><surname>Poisson</surname><given-names>LM</given-names></name><name><surname>Lazar</surname><given-names>AJ</given-names></name><name><surname>Cherniack</surname><given-names>AD</given-names></name><name><surname>Kovatich</surname><given-names>AJ</given-names></name><name><surname>Benz</surname><given-names>CC</given-names></name><name><surname>Levine</surname><given-names>DA</given-names></name><name><surname>Lee</surname><given-names>AV</given-names></name><name><surname>Omberg</surname><given-names>L</given-names></name><name><surname>Wolf</surname><given-names>DM</given-names></name><name><surname>Shriver</surname><given-names>CD</given-names></name><name><surname>Thorsson</surname><given-names>V</given-names></name><collab>Cancer Genome Atlas Research Network</collab><name><surname>Hu</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>An integrated tcga pan-cancer clinical data resource to drive high-quality survival outcome analytics</article-title><source>Cell</source><volume>173</volume><fpage>400</fpage><lpage>416</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.02.052</pub-id><pub-id pub-id-type="pmid">29625055</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>M</given-names></name><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Differential analysis of count data–the DESeq2 package</article-title><source>Genome Biology</source><volume>15</volume><fpage>10</fpage><lpage>1186</lpage><pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lutter</surname><given-names>L</given-names></name><name><surname>van der Wal</surname><given-names>MM</given-names></name><name><surname>Brand</surname><given-names>EC</given-names></name><name><surname>Maschmeyer</surname><given-names>P</given-names></name><name><surname>Vastert</surname><given-names>S</given-names></name><name><surname>Mashreghi</surname><given-names>M-F</given-names></name><name><surname>van Loosdregt</surname><given-names>J</given-names></name><name><surname>van Wijk</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Human regulatory T cells locally differentiate and are functionally heterogeneous within the inflamed arthritic joint</article-title><source>Clinical &amp; Translational Immunology</source><volume>11</volume><elocation-id>e1420</elocation-id><pub-id pub-id-type="doi">10.1002/cti2.1420</pub-id><pub-id pub-id-type="pmid">36204213</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maaten</surname><given-names>L</given-names></name><name><surname>Hinton</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Visualizing data using t-SNE</article-title><source>Journal of Machine Learning Research</source><volume>9</volume><fpage>2579</fpage><lpage>2605</lpage></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nawal</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A systems biology perspective of stem cell differentiation into microglia</article-title><source>Stem Cell Reports</source><volume>8</volume><fpage>1516</fpage><lpage>1524</lpage><pub-id pub-id-type="doi">10.1016/j.stemcr.2017.04.023</pub-id><pub-id pub-id-type="pmid">28528700</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neal</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Slice sampling</article-title><source>The Annals of Statistics</source><volume>31</volume><fpage>705</fpage><lpage>767</lpage><pub-id pub-id-type="doi">10.1214/aos/1056562461</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Papadopoulos</surname><given-names>N</given-names></name><name><surname>Gonzalo</surname><given-names>PR</given-names></name><name><surname>Söding</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>PROSSTT: probabilistic simulation of single-cell RNA-seq data for complex differentiation processes</article-title><source>Bioinformatics</source><volume>35</volume><fpage>3517</fpage><lpage>3519</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btz078</pub-id><pub-id pub-id-type="pmid">30715210</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pritchard</surname><given-names>GH</given-names></name><name><surname>Phan</surname><given-names>AT</given-names></name><name><surname>Christian</surname><given-names>DA</given-names></name><name><surname>Blain</surname><given-names>TJ</given-names></name><name><surname>Fang</surname><given-names>Q</given-names></name><name><surname>Johnson</surname><given-names>J</given-names></name><name><surname>Roy</surname><given-names>NH</given-names></name><name><surname>Shallberg</surname><given-names>L</given-names></name><name><surname>Kedl</surname><given-names>RM</given-names></name><name><surname>Hunter</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Early T-bet promotes LFA1 upregulation required for CD8+ effector and memory T cell development</article-title><source>The Journal of Experimental Medicine</source><volume>220</volume><elocation-id>e20191287</elocation-id><pub-id pub-id-type="doi">10.1084/jem.20191287</pub-id><pub-id pub-id-type="pmid">36445307</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Hill</surname><given-names>A</given-names></name><name><surname>Packer</surname><given-names>J</given-names></name><name><surname>Lin</surname><given-names>D</given-names></name><name><surname>Ma</surname><given-names>YA</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017a</year><article-title>Single-cell mRNA quantification and differential analysis with Census</article-title><source>Nature Methods</source><volume>14</volume><fpage>309</fpage><lpage>315</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4150</pub-id><pub-id pub-id-type="pmid">28114287</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Mao</surname><given-names>Q</given-names></name><name><surname>Tang</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Chawla</surname><given-names>R</given-names></name><name><surname>Pliner</surname><given-names>HA</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017b</year><article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title><source>Nature Methods</source><volume>14</volume><fpage>979</fpage><lpage>982</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4402</pub-id><pub-id pub-id-type="pmid">28825705</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Lyu</surname><given-names>X</given-names></name><name><surname>Fang</surname><given-names>H</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Yu</surname><given-names>R</given-names></name><name><surname>Shi</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A downsampling method enables robust clustering and integration of single-cell transcriptome data</article-title><source>Journal of Biomedical Informatics</source><volume>130</volume><elocation-id>104093</elocation-id><pub-id pub-id-type="doi">10.1016/j.jbi.2022.104093</pub-id><pub-id pub-id-type="pmid">35537690</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025a</year><data-title>Ti_mgpfact</data-title><version designator="swh:1:rev:88a89013dcc7bbf28d295b4af3278aab394f0ccd">swh:1:rev:88a89013dcc7bbf28d295b4af3278aab394f0ccd</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:cd0b254281b5bdcec5c266cdaabd351bed38069f;origin=https://github.com/renjun0324/ti_mgpfact;visit=swh:1:snp:64bb8832429d03a1a1191dcee2527acdfb59b8be;anchor=swh:1:rev:88a89013dcc7bbf28d295b4af3278aab394f0ccd">https://archive.softwareheritage.org/swh:1:dir:cd0b254281b5bdcec5c266cdaabd351bed38069f;origin=https://github.com/renjun0324/ti_mgpfact;visit=swh:1:snp:64bb8832429d03a1a1191dcee2527acdfb59b8be;anchor=swh:1:rev:88a89013dcc7bbf28d295b4af3278aab394f0ccd</ext-link></element-citation></ref><ref id="bib37"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025b</year><data-title>MGPfactR</data-title><version designator="swh:1:rev:029521d60b473d6d0e4d6db89b00cd6a7ea3c7b8">swh:1:rev:029521d60b473d6d0e4d6db89b00cd6a7ea3c7b8</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:54e5238fad1f505510e4cd945ee3bc8012907f18;origin=https://github.com/renjun0324/MGPfactR;visit=swh:1:snp:fd3e9f1d3bde63deda921ef8cab05e00a54956e4;anchor=swh:1:rev:029521d60b473d6d0e4d6db89b00cd6a7ea3c7b8">https://archive.softwareheritage.org/swh:1:dir:54e5238fad1f505510e4cd945ee3bc8012907f18;origin=https://github.com/renjun0324/MGPfactR;visit=swh:1:snp:fd3e9f1d3bde63deda921ef8cab05e00a54956e4;anchor=swh:1:rev:029521d60b473d6d0e4d6db89b00cd6a7ea3c7b8</ext-link></element-citation></ref><ref id="bib38"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025c</year><data-title>MGPfact.jl</data-title><version designator="swh:1:rev:53edd03791f28042fb554c2232acd57104ffe64f">swh:1:rev:53edd03791f28042fb554c2232acd57104ffe64f</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8444cca61b545fc6459adaf9c338fc1dcd96608c;origin=https://github.com/renjun0324/MGPfact.jl;visit=swh:1:snp:9b279407058549f6df26de958cf033dcc11bc84d;anchor=swh:1:rev:53edd03791f28042fb554c2232acd57104ffe64f">https://archive.softwareheritage.org/swh:1:dir:8444cca61b545fc6459adaf9c338fc1dcd96608c;origin=https://github.com/renjun0324/MGPfact.jl;visit=swh:1:snp:9b279407058549f6df26de958cf033dcc11bc84d;anchor=swh:1:rev:53edd03791f28042fb554c2232acd57104ffe64f</ext-link></element-citation></ref><ref id="bib39"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ren</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2025">2025d</year><data-title>Mgpfact_paper</data-title><version designator="swh:1:rev:5da82bdc22a755139f0a503f9619b8f8fda93ebc">swh:1:rev:5da82bdc22a755139f0a503f9619b8f8fda93ebc</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:8e6c27dd077a72d39f914c7c04c3fa72507130b7;origin=https://github.com/renjun0324/mgpfact_paper;visit=swh:1:snp:9f29ba0c7ef2adc073a1f1712afb1250e7adb5ef;anchor=swh:1:rev:5da82bdc22a755139f0a503f9619b8f8fda93ebc">https://archive.softwareheritage.org/swh:1:dir:8e6c27dd077a72d39f914c7c04c3fa72507130b7;origin=https://github.com/renjun0324/mgpfact_paper;visit=swh:1:snp:9f29ba0c7ef2adc073a1f1712afb1250e7adb5ef;anchor=swh:1:rev:5da82bdc22a755139f0a503f9619b8f8fda93ebc</ext-link></element-citation></ref><ref id="bib40"><element-citation publication-type="software"><person-group person-group-type="author"><collab>Renjun0324</collab></person-group><year iso-8601-date="2025">2025</year><data-title>Ti_scfates_tree</data-title><version designator="swh:1:rev:0c757ac4b84716619c1238e47d7d71c350f9eec8">swh:1:rev:0c757ac4b84716619c1238e47d7d71c350f9eec8</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:86a50b5a5a474f8b798243449acbc99adc782875;origin=https://github.com/renjun0324/ti_scfates_tree;visit=swh:1:snp:fd637b1354e6470412b68f18b995c53f538eef95;anchor=swh:1:rev:0c757ac4b84716619c1238e47d7d71c350f9eec8">https://archive.softwareheritage.org/swh:1:dir:86a50b5a5a474f8b798243449acbc99adc782875;origin=https://github.com/renjun0324/ti_scfates_tree;visit=swh:1:snp:fd637b1354e6470412b68f18b995c53f538eef95;anchor=swh:1:rev:0c757ac4b84716619c1238e47d7d71c350f9eec8</ext-link></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>GO</given-names></name><name><surname>Rosenthal</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Examples of adaptive mcmc</article-title><source>Journal of Computational and Graphical Statistics</source><volume>18</volume><fpage>349</fpage><lpage>367</lpage><pub-id pub-id-type="doi">10.1198/jcgs.2009.06134</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A comparison of single-cell trajectory inference methods</article-title><source>Nature Biotechnology</source><volume>37</volume><fpage>547</fpage><lpage>554</lpage><pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id><pub-id pub-id-type="pmid">30936559</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salmon</surname><given-names>AJ</given-names></name><name><surname>Shavkunov</surname><given-names>AS</given-names></name><name><surname>Miao</surname><given-names>Q</given-names></name><name><surname>Jarjour</surname><given-names>NN</given-names></name><name><surname>Keshari</surname><given-names>S</given-names></name><name><surname>Esaulova</surname><given-names>E</given-names></name><name><surname>Williams</surname><given-names>CD</given-names></name><name><surname>Ward</surname><given-names>JP</given-names></name><name><surname>Highsmith</surname><given-names>AM</given-names></name><name><surname>Pineda</surname><given-names>JE</given-names></name><name><surname>Taneja</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Edelson</surname><given-names>BT</given-names></name><name><surname>Gubin</surname><given-names>MM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>BHLHE40 regulates the t-cell effector function required for tumor microenvironment remodeling and immune checkpoint therapy efficacy</article-title><source>Cancer Immunology Research</source><volume>10</volume><fpage>597</fpage><lpage>611</lpage><pub-id pub-id-type="doi">10.1158/2326-6066.CIR-21-0129</pub-id><pub-id pub-id-type="pmid">35181783</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>E</given-names></name><name><surname>Speekenbrink</surname><given-names>M</given-names></name><name><surname>Krause</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A tutorial on Gaussian process regression: Modelling, exploring, and exploiting functions</article-title><source>Journal of Mathematical Psychology</source><volume>85</volume><fpage>1</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1016/j.jmp.2018.03.001</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sha</surname><given-names>Y</given-names></name><name><surname>Qiu</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>P</given-names></name><name><surname>Nie</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>Reconstructing growth and dynamic trajectories from single-cell transcriptomics data</article-title><source>Nature Machine Intelligence</source><volume>6</volume><fpage>25</fpage><lpage>39</lpage><pub-id pub-id-type="doi">10.1038/s42256-023-00763-w</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smolander</surname><given-names>J</given-names></name><name><surname>Junttila</surname><given-names>S</given-names></name><name><surname>Venäläinen</surname><given-names>MS</given-names></name><name><surname>Elo</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>scShaper: an ensemble method for fast and accurate linear trajectory inference from single-cell RNA-seq data</article-title><source>Bioinformatics</source><volume>38</volume><fpage>1328</fpage><lpage>1335</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btab831</pub-id><pub-id pub-id-type="pmid">34888622</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive integration of single-cell data</article-title><source>Cell</source><volume>177</volume><fpage>1888</fpage><lpage>1902</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tierney</surname><given-names>L</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Markov chains for exploring posterior distributions</article-title><source>The Annals of Statistics</source><volume>22</volume><fpage>1701</fpage><lpage>1728</lpage><pub-id pub-id-type="doi">10.1214/aos/1176325750</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Todorov</surname><given-names>H</given-names></name><name><surname>Cannoodt</surname><given-names>R</given-names></name><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>TinGa: fast and flexible trajectory inference with growing neural gas</article-title><source>Bioinformatics</source><volume>36</volume><fpage>i66</fpage><lpage>i74</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa463</pub-id><pub-id pub-id-type="pmid">32657409</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapani</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Granzymes: a family of lymphocyte granule serine proteases</article-title><source>Genome Biology</source><volume>2</volume><elocation-id>1</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2001-2-12-reviews3014</pub-id><pub-id pub-id-type="pmid">11790262</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Lu</surname><given-names>M</given-names></name><name><surname>Zhu</surname><given-names>X</given-names></name><name><surname>Gu</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>T</given-names></name><name><surname>Xia</surname><given-names>C</given-names></name><name><surname>Yang</surname><given-names>L</given-names></name><name><surname>Xu</surname><given-names>Y</given-names></name><name><surname>Zhou</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>The role of microglia immunometabolism in neurodegeneration: focus on molecular determinants and metabolic intermediates of metabolic reprogramming</article-title><source>Biomedicine &amp; Pharmacotherapy</source><volume>153</volume><elocation-id>113412</elocation-id><pub-id pub-id-type="doi">10.1016/j.biopha.2022.113412</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>LG</given-names></name><name><surname>Han</surname><given-names>Y</given-names></name><name><surname>He</surname><given-names>QY</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title><source>Omics</source><volume>16</volume><fpage>284</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id><pub-id pub-id-type="pmid">22455463</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zappia</surname><given-names>L</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Splatter: simulation of single-cell RNA sequencing data</article-title><source>Genome Biology</source><volume>18</volume><elocation-id>174</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id><pub-id pub-id-type="pmid">28899397</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L</given-names></name><name><surname>Yu</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>L</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Fang</surname><given-names>Q</given-names></name><name><surname>Gao</surname><given-names>R</given-names></name><name><surname>Kang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Huang</surname><given-names>JY</given-names></name><name><surname>Konno</surname><given-names>H</given-names></name><name><surname>Guo</surname><given-names>X</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name><name><surname>Gao</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Ren</surname><given-names>X</given-names></name><name><surname>Shen</surname><given-names>Z</given-names></name><name><surname>Ouyang</surname><given-names>W</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Lineage tracking reveals dynamic relationships of T cells in colorectal cancer</article-title><source>Nature</source><volume>564</volume><fpage>268</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0694-x</pub-id><pub-id pub-id-type="pmid">30479382</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97424.3.sa0</article-id><title-group><article-title>eLife Assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Karimi</surname><given-names>Mohammad M</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>King's College London</institution><country>United Kingdom</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Compelling</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Important</kwd></kwd-group></front-stub><body><p>MGPfact<sup>XMBD</sup> is a novel computational method for investigating cell evolutionary trajectory for scRNA-seq samples. It is <bold>important</bold>, with several potential future applications. The authors benchmarked this method using synthetic and real-world samples and showed superior performance for some of the tasks in cell trajectory analysis compared to other methods with <bold>compelling</bold> evidence.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97424.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>Ren et al developed a novel computational method to investigate cell evolutionary trajectory for scRNA-seq samples. This method, MGPfact, estimates pseudotime and potential branches in the evolutionary path through explicitly modeling the bifurcations in a Gaussian process. They benchmarked this method using synthetic as well as real world samples and showed superior performance for some of the tasks in cell trajectory analysis. They further demonstrated the utilities of MGPfact using single cell RNA-seq samples derived from microglia or T cells and showed that it can accurately identify the differentiation timepoint and uncover biologically relevant gene signatures.</p><p>Strengths:</p><p>Overall I think this is a useful new tool that could deliver novel insights for the large body of scRNA-seq data generated in the public domain. The manuscript is written is a logical way and most parts of the method are well described.</p><p>Comments on revisions:</p><p>In this revision, the authors have sufficiently addressed all of my concerns. I don't have any follow-up comments.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97424.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary of the manuscript:</p><p>Authors present MGPfact<sup>XMBD</sup>, a novel model-based manifold-learning framework designed to address the challenges of interpreting complex cellular state spaces from single-cell RNA sequences. To overcome current limitations, MGPfactXMBD factorizes complex development trajectories into independent bifurcation processes of gene sets, enabling trajectory inference based on relevant features. As a result, it is expected that the method provides a deeper understanding of the biological processes underlying cellular trajectories and their potential determinants.</p><p>MGPfact<sup>XMBD</sup> was tested across 239 datasets, and the method demonstrated similar to slightly superior performance in key quality-control metrics to state-of-the-art methods. When applied to case studies, MGPfact<sup>XMBD</sup> successfully identified critical pathways and cell types in microglia development, validating experimentally identified regulons and markers. Additionally, it uncovered evolutionary trajectories of tumor-associated CD8+ T cells, revealing new subtypes with gene expression signatures that predict responses to immune checkpoint inhibitors in independent cohorts.</p><p>Overall, MGPfact<sup>XMBD</sup> represents a relevant tool in manifold-learning for scRNA-seq data, enabling feature selection for specific biological processes and enhancing our understanding of the biological determinants of cell fate.</p><p>Summary of the outcome:</p><p>The novel method addresses core state-of-the-art questions in biology related to trajectory identification. The design and the case studies are of relevance.</p><p>Comments on revisions:</p><p>The authors have addressed all my previous comments to satisfaction.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97424.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ren</surname><given-names>Jun</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Zhou</surname><given-names>Ying</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Hu</surname><given-names>Yudi</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Jing</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Fang</surname><given-names>Hongkun</given-names></name><role specific-use="author">Author</role><aff><institution>Department of Scientific Research Management, Weifang People's Hospital，Shandong Second Medical University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Lyu</surname><given-names>Xuejing</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Guo</surname><given-names>Jintao</given-names></name><role specific-use="author">Author</role><aff><institution>Department of Scientific Research Management, Weifang People's Hospital，Shandong Second Medical University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Shi</surname><given-names>Xiaodong</given-names></name><role specific-use="author">Author</role><aff><institution>School of Informatics, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Qiyuan</given-names></name><role specific-use="author">Author</role><aff><institution>National Institute for Data Science in Health and Medicine, School of Medicine, Xiamen University</institution><addr-line><named-content content-type="city">Xiamen</named-content></addr-line><country>China</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1:</bold></p><p>Comment#1: Ren et al developed a novel computational method to investigate cell evolutionary trajectory for scRNA-seq samples. This method, MGPfact, estimates pseudotime and potential branches in the evolutionary path by explicitly modeling the bifurcations in a Gaussian process. They benchmarked this method using synthetic as well as real-world samples and showed superior performance for some of the tasks in cell trajectory analysis. They further demonstrated the utilities of MGPfact using single-cell RNA-seq samples derived from microglia or T cells and showed that it can accurately identify the differentiation timepoint and uncover biologically relevant gene signatures. Overall I think this is a useful new tool that could deliver novel insights for the large body of scRNA-seq data generated in the public domain. The manuscript is written in a logical way and most parts of the method are well described.</p></disp-quote><p>Thank you for reviewing our manuscript and for your positive feedback on MGPfact. We are pleased that you find it useful for identifying differentiation timepoints and uncovering gene signatures. We will continue to refine MGPfact and explore its applications across diverse datasets. Your insights are invaluable, and we appreciate your support.</p><disp-quote content-type="editor-comment"><p>Comment#2: Some parts of the methods are not clear. It should be outlined in detail how pseudo time T is updated in Methods. It is currently unclear either in the description or Algorithm 1.</p></disp-quote><p>Thanks to the reviewers' comments. We've added a description of how pseudotime <italic>T</italic> is obtained between lines 138 and 147 in the article. In brief, the pseudotime of MGPfact is inferred through Gaussian process regression on the downsampled single-cell transcriptomic data. Specifically, <italic>T</italic> is treated as a continuous variable representing the progression of cells through the differentiation process. We describe the relationship between pseudotime and expression data using the formula:<disp-formula id="sa3equ1"><mml:math id="sa3m1"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <italic>f</italic>(<italic><bold>T</bold></italic>) is a Gaussian Process (GP) with covariance matrix <italic><bold>S</bold></italic>, and <inline-formula><mml:math id="sa3m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the error term. The Gaussian process is defined as:<disp-formula id="sa3equ2"><mml:math id="sa3m3"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="sa3m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the variance set to 1e-6.</p><p>During inference, we update the pseudotime by maximizing the posterior likelihood. Specifically, the posterior distribution of pseudotime <italic><bold>T</bold></italic> can be represented as:<disp-formula id="sa3equ3"><mml:math id="sa3m5"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="sa3m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> is the likelihood function of the observed data <italic>Y</italic>*, and <inline-formula><mml:math id="sa3m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the prior distribution of the Gaussian process. This posterior distribution integrates the observed data with model priors, enabling inference of pseudotime and trajectory simultaneously. Due to the high autocorrelation of <italic>T</italic> in the posterior distribution, we use Adaptive Metropolis within Gibbs (AMWG) sampling (Roberts and Rosenthal, 2009; Tierney, 1994). Other parameters are estimated using the more efficient SLICE sampling technique (Neal, 2003).</p><disp-quote content-type="editor-comment"><p>Comment#3: There should be a brief description in the main text of how synthetic data were generated, under what hypothesis, and specifically how bifurcation is embedded in the simulation.</p></disp-quote><p>Thank you for the reviewers' comments. We have added descriptions regarding the synthetic dataset in the methods section. The revised content is from line 487 to 493:</p><p>“The synthetic datasets were generated using four simulators: dyngen (Saelens et al., 2019), dyntoy (Saelens et al., 2019), PROSSTT (Papadopoulos et al., 2019), and Splatter (Zappia et al., 2017), each modeling different trajectory topologies such as linear, branching, and cyclic. Splatter simulates branching events by setting expression states and transition probabilities, dyntoy generates random expression gradients to reflect dynamic changes, and dyngen focuses on complex branching structures within gene regulatory networks.”</p><disp-quote content-type="editor-comment"><p>Comment#4: Please explain what the abbreviations mean at their first occurrence.</p></disp-quote><p>We appreciate the reviewers' feedback. We have thoroughly reviewed the entire manuscript and made sure that all abbreviations have had their full forms provided upon their first occurrence.</p><disp-quote content-type="editor-comment"><p>Comment#5: In the benchmark analysis (Figures 2/3), it would be helpful to include a few trajectory plots of the real-world data to visualize the results and to evaluate the accuracy.</p></disp-quote><p>We appreciate the reviewer's feedback. To more clearly demonstrate the performance of MGPfact, we selected three representative cases from the dataset for visual comparison. These cases represent different types of trajectory structures: linear, bifurcation, and multifurcation. The revised content is between line 220 and 226.</p><p>As shown in Supplementary Fig. 5, it is evident that MGPfact excels in capturing main developmental paths and identifying key bifurcation points. In the linear trajectory structure, MGPfact accurately predicted the linear structure without bifurcation events, showing high consistency with the ground truth (<italic>overall</italic>=0.871). In the bifurcation trajectory structure, MGPfact accurately captured the main bifurcation event (<italic>overall</italic>=0.636). In the multifurcation trajectory structure, although MGPfact predicted only one bifurcation point, its overall structure remains close to the ground truth, as evidenced by its high overall score (<italic>overall</italic>=0.566). Overall, MGPfact demonstrates adaptability and accuracy in reconstructing various types of trajectory structures.</p><disp-quote content-type="editor-comment"><p>Comment#6: It is not clear how this method selects important genes/features at bifurcation. This should be elaborated on in the main text.</p></disp-quote><p>Thanks to the reviewers' comments. To enhance understanding, we've added detailed descriptions of gene selection in the main text and appendix, specifically from lines 150 to 161. In brief, MGPfact employs a Gaussian process mixture model to infer cell fate trajectories and identify independent branching events. We calculate load matrices using formulas 1 and 14 to assess each gene's contribution to the trajectories. Genes with an absolute weight greater than 0.05 are considered predominant in specific branching processes. Subsequently, SCENIC (Aibar et al., 2017; Bravo González-Blas et al., 2023) analysis was conducted to further infer the underlying regulons and annotate the biological processes of these genes.</p><disp-quote content-type="editor-comment"><p>Comment#7: It is not clear how survival analysis was performed in Figure 5. Specifically, were critical confounders, such as age, clinical stage, and tumor purity controlled?</p></disp-quote><p>To evaluate the predictive and prognostic impacts of the selected genes, we utilized the Cox multivariate regression model, where the effects of relevant covariates, including age, clinical stage, and tumor purity, were adjusted. We then conducted the Kaplan-Meier survival analysis again to ensure the reliability of the results. The revisions mainly include the following sections:</p><p>(1) We modified the description of adjusting for confounding factors in the survival analysis, from line 637 to 640:</p><p>“To adjust for possible confounding effects, the relevant clinical features including age, sex and tumor stage were used as covariates. The Cox regression model was implemented using R-4.2 package “survival”. And we generated Kaplan-Meier survival curves based on different classifiers to illustrate differences in survival time and report the statistical significance based on Log-rank test.”</p><p>(2) We updated the images in the main text regarding the survival analysis, including Fig. 5a-b, Fig. 6c, and Supplementary Fig. 8e.</p><disp-quote content-type="editor-comment"><p>Comment#8: I recommend that the authors perform some sort of 'robustness' analysis for the consensus tree built from the bifurcation Gaussian process. For example, subsample 80% of the cells to see if the bifurcations are similar between each bootstrap.</p></disp-quote><p>We appreciate the reviewers' feedback. We performed a robustness analysis of the consensus tree using 100 training datasets. This involved sampling the original data at different proportions, and then calculating the topological similarity between the consensus trajectory predictions of MGPfact and those without sampling, using the Hamming-Ipsen-Mikhailov (<italic>HIM</italic>) metric. A higher score indicates greater robustness. The relevant figure is in Supplementary Fig. 4, and the description is in the main text from line 177 to 182.</p><p>The results indicate that the consensus trajectory predictions based on various sampling proportions of the original data maintain a high topological similarity with the unsampled results (<italic>HIM<sub>mean</sub></italic>=0.686). This demonstrates MGPfact’s robustness and generalizability under different data conditions, hence the capability of capturing bifurcative processes in the cells’ trajectory.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2:</bold></p><p>Comment#1: The authors present MGPfact<sup>XMBD</sup>, a novel model-based manifold-learning framework designed to address the challenges of interpreting complex cellular state spaces from single-cell RNA sequences. To overcome current limitations, MGPfact<sup>XMBD</sup> factorizes complex development trajectories into independent bifurcation processes of gene sets, enabling trajectory inference based on relevant features. As a result, it is expected that the method provides a deeper understanding of the biological processes underlying cellular trajectories and their potential determinants. MGPfact<sup>XMBD</sup> was tested across 239 datasets, and the method demonstrated similar to slightly superior performance in key quality-control metrics to state-of-the-art methods. When applied to case studies, MGPfact<sup>XMBD</sup> successfully identified critical pathways and cell types in microglia development, validating experimentally identified regulons and markers. Additionally, it uncovered evolutionary trajectories of tumor-associated CD8+ T cells, revealing new subtypes with gene expression signatures that predict responses to immune checkpoint inhibitors in independent cohorts. Overall, MGPfact<sup>XMBD</sup> represents a relevant tool in manifold learning for scRNA-seq data, enabling feature selection for specific biological processes and enhancing our understanding of the biological determinants of cell fate.</p></disp-quote><p>Thank you for your thoughtful review of our manuscript. We are thrilled to hear that you find MGPfact<sup>XMBD</sup> beneficial for exploring cellular evolutionary paths in scRNA-seq data. Your insights are invaluable, and we look forward to incorporating them to further enrich our study. Thank you once again for your support and constructive feedback.</p><disp-quote content-type="editor-comment"><p>Comment#2: How the methods compare with existing Deep Learning based approaches such as TIGON is a question mark. If a comparison would be possible, it should be conducted; if not, it should be clarified why.</p></disp-quote><p>We appreciate the reviewer's comments. We have added a comparison with the sctour (Li, 2023) and TIGON methods (Sha, 2024).</p><p>It is important to note that the encapsulation and comparison of MGPfact are based on traditional differentiation trajectory construction. Saelens et al. established a systematic evaluation framework that categorizes differentiation trajectory structures into topological subtypes such as linear, bifurcation, multifurcation, graph, and tree, focusing on identifying branching structures in the cell differentiation process (Saelens et al., 2019). The sctour and TIGON methods mentioned by the reviewer are primarily used for estimating RNA velocity, focusing on continuous temporal evolution rather than explicit branching structures, and do not explicitly model branches. Therefore, we considered the predictions of these two methods as linear trajectories and compared them with MGPfact. While scTour explicitly estimates pseudotime, TIGON uses the concept of &quot;growth,&quot; which is analogous to pseudotime, so we made the necessary adaptations.</p><p><xref ref-type="fig" rid="sa3fig1">Author response image 1</xref> show that within this framework, compared to scTour (<italic>overall<sub>mean</sub></italic>=0.448) and TIGON (<italic>overall<sub>mean</sub></italic>=0.263), MGPfact still maintains a relatively high standard (<italic>overall<sub>mean</sub></italic>=0.534). This indicates that MGPfact has a significant advantage in accurately capturing branching structures in cell differentiation, especially in applications where explicit modeling of branches is required.</p><fig id="sa3fig1" position="float"><label>Author response image 1.</label><caption><title>Comparison of MGPfact with scTour and TIGON in trajectory inference performance across 239 test datasets.</title><p>(<bold>a</bold>) Overall scores; (<bold>b</bold>) <italic>F</italic>1<italic><sub>branches</sub></italic>; (<bold>c</bold>) <italic>HIM</italic>; (<bold>d</bold>) <italic>cor</italic><sub><italic>dist</italic></sub>; (<bold>e</bold>) <italic>wcor<sub>features</sub></italic>. All results are color-coded based on the trajectory types, with the black line representing the mean value. The “Overall” assessment is calculated as the geometric mean of all four metrics.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-sa3-fig1-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>Comment#3: Missing Methods:</p><p>- The paper lacks a discussion of Deep Learning approaches for bifurcation analysis. e.g. scTour, Tigon.</p><p>- I am missing comments on methods such CellRank, and alternative approaches to delineate a trajectory.</p></disp-quote><p>We thank the reviewer for these comments.</p><p>(1) As mentioned in response to Comments#2, the scTour and TIGON methods are primarily used for estimating RNA velocity, focusing on continuous temporal evolution rather than explicit branching structures, and they do not explicitly model branches. We consider the predictions of these two methods as linear trajectories and compare them with MGPfact. The relevant description and discussion have been addressed in the response.</p><p>(2) We have added a description of RNA velocity estimation methods (scTour, TIGON, CellRank) in the introduction section. The revised content is from line 66 to 71:</p><p>Moreover, recent studies based on RNA velocity has provided insights into cell state transitions. These methods measure RNA synthesis and degradation rates based on the abundance of spliced and unspliced mRNA, such as CellRank (Lange et al., 2022). Nevertheless, current RNA velocity analyses are still unable to resolve cell-fates with complex branching trajectory. Deep learning methods such as scTour (Li, 2023) and TIGON (Sha, 2024) circumvent some of these limitations, offering continuous state assumptions or requiring prior cell sampling information.</p><disp-quote content-type="editor-comment"><p>Comment#4: Impact of MURP:</p><p>The rationale for using MURP is well-founded, especially for trajectory definition. However, its impact on the final results needs evaluation.</p><p>How does the algorithm compare with a random subselection of cells or the entire cell set?</p></disp-quote><p>Thank you for the comments. We fully agree that MURP is crucial in trajectory prediction. As a downsampling method, MURP is specifically designed to address noise issues in single-cell data by dividing the data into several subsets, thereby maximizing noise reduction while preserving the main structure of biological variation (Ren et al., 2022). In MGPfact, MURP typically reduces the data to fewer than 100 downsampled points, preserving the core biological structure while lowering computational complexity. To assess MURP's impact, we conducted experiments by randomly selecting 20, 40, 60, 80, and 100 cells for trajectory inference. These results were mapped back to the original data using the KNN graph structure for final predictions, which were then compared with the MURP downsampling results. Supplementary results can be found in Supplementary Fig. 3, with additional descriptions in the main text from line 170 to 176.</p><p>The results indicate that trajectory inference using randomly sampled cells has significantly lower prediction accuracy compared to that using MURP. This is particularly evident in branch assignment (<italic>F</italic>1<italic><sub>branches</sub></italic>) and correlation <italic>cor<sub>dist</sub></italic>, where the average levels decrease by 20.5%-64.9%. In contrast, trajectory predictions using MURP for downsampling show an overall score improvement of 5.31%-185%, further highlighting MURP's role in enhancing trajectory inference within MGPfact.</p><disp-quote content-type="editor-comment"><p>Comment#5: What is the impact of the number of components selected?</p></disp-quote><p>Thank you for the comments. In essence, MGPfact consists of two main steps: (1) trajectory inference; (2) calculation of factorized scores and identification of high-weight genes. After step 1, MGPfact estimates parameters such as pseudotime <bold><italic>T</italic></bold> and bifurcation points <bold><italic>B</italic></bold>. In step 2, we introduce a rotation matrix <inline-formula><mml:math id="sa3m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> to obtain factor scores for each trajectory <italic>l</italic> by rotating <bold><italic>Y</italic></bold>*.<disp-formula id="sa3equ4"><mml:math id="sa3m9"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>For all trajectories,<disp-formula id="sa3equ5"><mml:math id="sa3m10"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">N</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mtext>error </mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="sa3m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is the error term for the l-th trajectory. The number of features in <bold><italic>Y</italic></bold>* must match the dimensions of the rotation matrix <bold><italic>R</italic></bold> to ensure the factorized score matrix <bold><italic>W</italic></bold> contains factor scores for <italic>L</italic> trajectories, achieving effective feature representation and interpretation in the model.</p><p>Additionally, to further illustrate the impact of the number of principal components (PCs) on model performance in step 1, we conducted additional experiments. We used 3 PCs as the default and adjusted the number to evaluate changes from this baseline. As shown in <xref ref-type="fig" rid="sa3fig2">Author response image 2</xref>, setting the number of PCs to 1 significantly decreases the overall performance score (<italic>Overall<sub>mean</sub></italic>=0.363), as well as the <italic>wcor<sub>features</sub></italic> (<inline-formula><mml:math id="sa3m12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.586</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) and <italic>cor<sub>dist</sub></italic> (<inline-formula><mml:math id="sa3m13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.21</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) metrics. In contrast, increasing the number of PCs does not significantly affect the metrics. It ought to be mentioned that number of components used should be determined by the intrinsic biological characteristics of the cell fate-determination. Our experiment based on a limited number of datasets may not represent more complex scenarios in other cell types.</p><fig id="sa3fig2" position="float"><label>Author response image 2.</label><caption><title>Robustness testing of the number of MURP PCA components on 100 training datasets.</title><p>With the number of principal components (PCs) set to 3 by default; we tested the impact of different number of components (1-10) on the prediction results. In all box plots, the asterisk represents the mean value, while the whiskers extend to the farthest data points within 1.5 times the interquartile range. Significance is denoted as follows: not annotated indicates non-significant; * P &lt; 0.05; ** P &lt; 0.01; *** P &lt; 0.001; two-sided paired Student’s T-tests.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97424-sa3-fig2-v1.tif"/></fig><disp-quote content-type="editor-comment"><p>Comment#6: Please comment on the selection of the kernel functions (rbf and polynomial) and explain why other options were discarded.</p></disp-quote><p>Thank you for the comments. We have added a description regarding the selection of radial basis functions and polynomial kernels in lines 126-130. As the reviewers mentioned, the choice of kernel functions is crucial in the MGPfact analysis pipeline for constructing the covariance matrix of the Gaussian process. We selected the radial basis function (RBF) kernel and the polynomial kernel to balance capturing data complexity and computational efficiency. The RBF kernel is chosen for its ability to effectively model smooth functions and capture local variations in the data, making it well-suited to the continuous and smooth characteristics of biological processes; its hyperparameters offer modeling flexibility. The polynomial kernel is used to capture more complex nonlinear relationships between input features, with its hyperparameters also allowing further customization of the model. In contrast, other complex kernels, such as Matérn or spectral kernels, were omitted due to their interpretability challenges and the risk of overfitting with limited data. However, as suggested by the reviewers, we will consider and test the impact of other kernel functions on the covariance matrix of the Gaussian process and their role in trajectory inference in our subsequent phases of algorithm design.</p><disp-quote content-type="editor-comment"><p>Comment#7: What is the impact of the Pseudotime method used initially? This section should be expanded with clear details on the techniques and parameters used in each analysis.</p></disp-quote><p>We are sorry for the confusion. We've added a description of how pseudotime is obtained between line 138 and 147 in the main text. And the specific hyperparameters involved in the model and their prior settings are detailed in the supplementary information.</p><p>In brief, the pseudotime and related topological parameters of the bifurcative trajectories in MGPfact are inferred by Gaussian process regression from downsampled single-cell transcriptomic data (MURP). Specifically, is treated as a continuous variable representing the progression of cells through the differentiation process. We describe the relationship between pseudotime and expression data as:<disp-formula id="sa3equ6"><mml:math id="sa3m14"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="sa3m15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is a Gaussian Process (GP) with covariance matrix <inline-formula><mml:math id="sa3m16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="sa3m17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the error term. The Gaussian process is defined as:<disp-formula id="sa3equ7"><mml:math id="sa3m18"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi class="mathcal" mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi class="mathcal" mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="sa3m19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the variance set to 1e-6. During inference, we update the pseudotime by maximizing the posterior liklihood. Specifically, the posterior distribution of pseudotime is obtained by combining the observed data <bold><italic>Y</italic></bold>* with the prior distribution of the Gaussian process model.<disp-formula id="sa3equ8"><mml:math id="sa3m20"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>∣</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>We use the Markov Chain Monte Carlo method for parameter estimation, particularly employing the adaptive Metropolis-within-Gibbs (AMWG) sampling to handle the high autocorrelation of pseudotime.</p><disp-quote content-type="editor-comment"><p>Comment#8: Enhancing Readability: For clarity, provide intuitive descriptions of each evaluation function used in simulated and real data. The novel methodology performs well for some metrics but less so for others. A clear understanding of these measurements is essential.</p></disp-quote><p>To address the concern of readability, we have added descriptions of 5 evaluation metrics in the methodology section (Benchmarking MGPfact to state-of-the-art methods) in line 494 to 515. Additionally, we have included a summary and discussion of these metrics in the conclusion section in line 214-240 to help the readers better understand the significance and impact of these measurements.</p><p>(1) In brief, the Hamming-Ipsen-Mikhailov (<italic>HIM</italic>) distance measures the similarity between topological structures, combining the normalized Hamming distance and the Ipsen-Mikhailov distance, which focus on edge length differences and degree distribution similarity, respectively. The <italic>F1<sub>branches</sub></italic> is used to assess the accuracy of a model's branch assignment via Jaccard similarity between branch pairs. In trajectory inference, <italic>cor<sub>dist</sub></italic> quantifies the similarity of inter-cell distances between predicted and true trajectories, evaluating the accuracy of cell ordering. The <italic>wcor<sub>features</sub></italic> assesses the similarity of key features through weighted Pearson correlation, capturing biological variation. The <italic>Overall</italic> score is calculated as the geometric mean of these metrics, providing an assessment of overall performance.</p><p>(2) For MGPfact and the other seven methods included in the comparison, each has its own focus. MGPfact specializes in factorizing complex cell trajectories using Gaussian process mixture models, making it particularly capable of identifying bifurcation events. Therefore, it excels in the accuracy of branch partitioning and similarity of trajectory topology. Among other methods, scShaper (Smolander et al., 2022) and TSCAN(Ji and Ji, 2016) are more suited for generating linear trajectories and excel in linear datasets, accurately predicting pseudotime. The Monocle series, as typical representatives of tree methods, effectively capture complex topologies and are suitable for analyzing cell data with diversified differentiation paths.</p><disp-quote content-type="editor-comment"><p>Comment#9: Microglia Analysis:In Figures 3A-C, the genes mentioned in the text for each bifurcation do not always match those shown in the panels. Please confirm this.</p></disp-quote><p>Thank you for pointing this out. We have carefully reviewed the article and corrected the error where the genes shown in the figures did not correspond to the descriptions in the article. The specific corrections have been made between line 257 and 264:</p><p>“The first bifurcation determines the differentiated cell fates of PAM and HM, which involves a set of notable marker genes of both cell types, such as Apoe, Selplg (HM), and Gpnmb (PAM). The second bifurcation determines the proliferative status, which is crucial for the development and function of PAM and HM (Guzmán, n.d.; Li et al., 2019). The genes affected by the second bifurcation are associated with cell cycle and proliferation, such as Mki67, Tubb5, Top2a. The third bifurcation influences the development and maturity of microglia, of which the highly weighted genes, such as Tmem119, P2ry12, and Sepp1 are all previously annotated markers for establishment of the fates of microglia (Anderson et al., 2022; Li et al., 2019) (Supplementary Table 4).”</p><disp-quote content-type="editor-comment"><p>Comment#10: Regulons:</p><p>- The conclusions rely heavily on regulons. The Methods section describes using SCENIC, GENIE3, RCisTarget, and AUCell, but their relation to bifurcation analysis is unclear.</p><p>- Do you perform trajectory analysis on all MURP-derived cells or within each identified trajectory based on bifurcation? This point needs clarification to make the outcomes comprehensible. The legend of Figure 4 provides some ideas, but further clarity is required.</p></disp-quote><p>Thank you for the comments.</p><p>(1) To clarify, we used the tools like SCENIC to annotate the highly weighted genes (HWG) resulted from the bifurcation analysis for transcription factor regulation activity and possible impacts on biological processes. We have added descriptions to the analysis of our microglial data. The revised content is between line 265 and 266:</p><p>Moreover, we retrieved highly active regulons from the HWG by MGPfact, of which the significance is quantified by the overall weights of the member genes.</p><p>(2) We apologize for any confusion caused by our description. It is important to clarify that we performed an overall trajectory analysis on all MURP results, rather than analyzing within each identified trajectory. Specifically, we first used MURP to downsample all preprocessed cells, where each MURP subset represents a group of cells. We then conducted trajectory inference on all MURP subsets and identified bifurcation points. This process generated multiple independent differentiation trajectories, encompassing all MURP subsets. To clearly convey this point, we have added descriptions in the legend of Figure 4. The revised content is between line 276 and 283:</p><p>“Fig. 4. MGPfact reconstructed the developmental trajectory of microglia, recovering known determinants of microglia fate. a-c. The inferred independent bifurcation processes with respect to the unique cell types (color-coded) of microglia development, where phase 0 corresponds to the state before bifurcation; and phases 1 and 2 correspond to the states post-bifurcation. Each colored dot represents a metacell of unique cell type defined by MURP. The most highly weighted regulons in each trajectory were labeled by the corresponding transcription factors (left panels). The HWG of each bifurcation process include a set of highly weighted genes (HWG), of which the expression levels differ significantly among phases 1, 2, and 3 (right panels).”</p><disp-quote content-type="editor-comment"><p>Comment#11: CD8+ T Cells: The comparison is made against Monocle2, the method used in the publication, but it would be beneficial to compare it with more recent methods. Otherwise, the added value of MGPfact is unclear.</p></disp-quote><p>Per your request, we have expanded our comparative analysis to include not only Monocle2 but also more recent methods such as Monocle3 (Cao et al., 2019) and scFates Tree (Faure et al., 2023). We used adjusted R-squared values to evaluate each method's ability to explain trajectory variation. The results have been added to Table 2 and Supplementary Table 6. The revised content is between line 318 and 326:</p><p>“We assessed the goodness-of-fit (adjusted R-square) of the consensus trajectory derived by MGPfact and three methods (Monocle 2, Monocle 3 and scFates Tree) for the CD8+ T cell subtypes described in the original studies (Guo et al., 2018; Zhang et al., 2018). The data showed that MGPfact significantly improved the explanatory power for most CD8+ T cell subtypes over Monocle 2, which was used in the original studies (P &lt; 0.05, see Table 2 and Supplementary Table 6), except for the CD8-GZMK cells in the CRC dataset. Additionally, MGPfact demonstrated better explanatory power in specific cell types when compared to Monocle 3 and scFates Tree. For instance, in the NSCLC dataset, MGPfact exhibited higher explanatory power for CD8-LEF1 cells (Table 2, R-squared = 0.935), while Monocle 3 and scFates Tree perform better in other cell types.”</p><disp-quote content-type="editor-comment"><p>Comment#12: Consensus Trajectory: A panel explaining how the consensus trajectory is generated would be helpful. Include both visual and textual explanations tailored to the journal's audience.</p></disp-quote><p>Thank you for the comments. Regarding how the consensus trajectory is constructed, we have illustrated and described this in Figure 1 and the supplementary methods. Taking the reviewers' suggestions into account, we have added more details about the generation process of the consensus trajectory in the methods section to enhance the completeness of the manuscript. The revised content is from line 599 to 606:</p><p>“Following MGPfact decomposition, we obtained multiple independent bifurcative trajectories, each corresponds to a binary tree within the temporal domain. These trajectories were then merged to construct a coherent diffusion tree, representing the consensus trajectory of cells’ fate. The merging process involves initially sorting all trajectories by their bifurcation time. The first (earliest) bifurcative trajectory is chosen as the initial framework, and subsequent trajectories are integrated to the initial framework iteratively by adding the corresponding branches at the bifurcation timepoints. As a result, the trajectories are ultimately merged into a comprehensive binary tree, serving as the consensus trajectory.”</p><disp-quote content-type="editor-comment"><p>Comment#13: Discussion:</p><p>- Check for typos, e.g., line 382 &quot;pseudtime.&quot;.</p><p>- Avoid considering HVG as the entire feature space.</p><p>- The first three paragraphs are too similar to the Introduction. Consider shortening them to succinctly state the scenario and the implications of your contribution.</p></disp-quote><p>Thank you for pointing out the typos.</p><p>(1) We conducted a comprehensive review of the document to ensure there are no typographical errors.</p><p>(2) We restructured the first three paragraphs of the discussion section to clarify the limitations in the use of current manifold-learning methods and removed any absolute language regarding treating HVGs as the entire feature space. The revised content is from line 419 to 430:</p><p>“Single-cell RNA sequencing (scRNA-seq) provides a direct, quantitative snapshot of a population of cells in certain biological conditions, thereby revealing the actual cell states and functions. Although existing clustering and embedding algorithms can effectively reveal discrete biological states of cells, these methods become less efficient when depicting continuous evolving of cells over the temporal domain. The introduction of manifold learning offers a new dimension for discovery of relevant biological knowledge in cell fate determination, allowing for a better representation of continuous changes in cells, especially in time-dependent processes such as development, differentiation, and clonal evolution. However, current manifold learning methods face major limitations, such as the need for prior information on pseudotime and cell clustering, and lack of explainability, which restricts their applicability. Additionally, many existing trajectory inference methods do not support gene selection, making it difficult to annotate the results to known biological entities, thereby hindering the interpretation of results and subsequent functional studies.”</p><disp-quote content-type="editor-comment"><p>Comment#14: Minor Comments:</p><p>(1) Review the paragraph regarding the &quot;current manifold-learning methods are faced with two major challenges.&quot; The message needs clarification.</p><p>(2) Increase the quality of the figures.</p><p>(3) Update the numbering of equations from #(.x) to (x).</p></disp-quote><p>We thank the reviewer for these detailed suggestions.</p><p>(1) We have thoroughly revised the discussion section, addressing overly absolute statements. The revised content is from line 426 to 428:</p><p>“However, current manifold learning methods face major limitations, such as the need for prior information on pseudotime and cell clustering, and lack of explainability, which restricts their applicability.”</p><p>(2) We conducted a comprehensive review of the figures in the article to more clearly present our results.</p><p>(3) We have meticulously reviewed the equations in the article to ensure there are no display issues with the indices.</p><p>References</p><p>Aibar S, González-Blas CB, Moerman T, Huynh-Thu VA, Imrichova H, Hulselmans G, Rambow F, Marine J-C, Geurts P, Aerts J, van den Oord J, Atak ZK, Wouters J, Aerts S. 2017. SCENIC: single-cell regulatory network inference and clustering. <italic>Nat Methods</italic> 14:1083–1086. doi:10.1038/nmeth.4463</p><p>Anderson SR, Roberts JM, Ghena N, Irvin EA, Schwakopf J, Cooperstein IB, Bosco A, Vetter ML. 2022. Neuronal apoptosis drives remodeling states of microglia and shifts in survival pathway dependence. <italic>Elife</italic> 11:e76564.</p><p>Bravo González-Blas C, De Winter S, Hulselmans G, Hecker N, Matetovici I, Christiaens V, Poovathingal S, Wouters J, Aibar S, Aerts S. 2023. SCENIC+: single-cell multiomic inference of enhancers and gene regulatory networks. <italic>Nat Methods</italic>. doi:10.1038/s41592-023-01938-4</p><p>Cao J, Spielmann M, Qiu X, Huang X, Ibrahim DM, Hill AJ, Zhang F, Mundlos S, Christiansen L, Steemers FJ, Trapnell C, Shendure J. 2019. The single-cell transcriptional landscape of mammalian organogenesis. <italic>Nature</italic> 566:496–502. doi:10.1038/s41586-019-0969-x</p><p>Faure L, Soldatov R, Kharchenko PV, Adameyko I. 2023. scFates: a scalable python package for advanced pseudotime and bifurcation analysis from single-cell data. <italic>Bioinformatics</italic> 39:btac746. doi:10.1093/bioinformatics/btac746</p><p>Guo X, Zhang Y, Zheng L, Zheng C, Song J, Zhang Q, Kang B, Liu Z, Jin L, Xing R, Gao R, Zhang L, Dong M, Hu X, Ren X, Kirchhoff D, Roider HG, Yan T, Zhang Z. 2018. Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing. <italic>Nat Med</italic> 24:978–985. doi:10.1038/s41591-018-0045-3</p><p>Guzmán AU. n.d. Single-cell RNA sequencing of spinal cord microglia in a mouse model of neuropathic pain.</p><p>Ji Z, Ji H. 2016. TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis. <italic>Nucleic Acids Res</italic> 44:e117–e117. doi:10.1093/nar/gkw430</p><p>Lange M, Bergen V, Klein M, Setty M, Reuter B, Bakhti M, Lickert H, Ansari M, Schniering J, Schiller HB, Pe’er D, Theis FJ. 2022. CellRank for directed single-cell fate mapping. <italic>Nat Methods</italic> 19:159–170. doi:10.1038/s41592-021-01346-6</p><p>Li Q. 2023. scTour: a deep learning architecture for robust inference and accurate prediction of cellular dynamics. <italic>Genome Biology</italic>.</p><p>Li Q, Cheng Z, Zhou L, Darmanis S, Neff NF, Okamoto J, Gulati G, Bennett ML, Sun LO, Clarke LE, Marschallinger J, Yu G, Quake SR, Wyss-Coray T, Barres BA. 2019. Developmental Heterogeneity of Microglia and Brain Myeloid Cells Revealed by Deep Single-Cell RNA Sequencing. <italic>Neuron</italic> 101:207-223.e10. doi:10.1016/j.neuron.2018.12.006</p><p>Neal RM. 2003. Slice sampling. <italic>The annals of statistics</italic> 31:705–767.</p><p>Papadopoulos N, Gonzalo PR, Söding J. 2019. PROSSTT: probabilistic simulation of single-cell RNA-seq data for complex differentiation processes. <italic>Bioinformatics</italic> 35:3517–3519. doi:10.1093/bioinformatics/btz078</p><p>Ren J, Zhang Q, Zhou Y, Hu Y, Lyu X, Fang H, Yang J, Yu R, Shi X, Li Q. 2022. A downsampling method enables robust clustering and integration of single-cell transcriptome data. <italic>Journal of Biomedical Informatics</italic> 130:104093. doi:10.1016/j.jbi.2022.104093</p><p>Roberts GO, Rosenthal JS. 2009. Examples of adaptive MCMC. <italic>Journal of computational and graphical statistics</italic> 18:349–367.</p><p>Saelens W, Cannoodt R, Todorov H, Saeys Y. 2019. A comparison of single-cell trajectory inference methods. <italic>Nat Biotechnol</italic> 37:547–554. doi:10.1038/s41587-019-0071-9</p><p>Sha Y. 2024. Reconstructing growth and dynamic trajectories from single-cell transcriptomics data 6.</p><p>Smolander J, Junttila S, Venäläinen MS, Elo LL. 2022. scShaper: an ensemble method for fast and accurate linear trajectory inference from single-cell RNA-seq data. <italic>Bioinformatics</italic> 38:1328–1335. doi:10.1093/bioinformatics/btab831</p><p>Tierney L. 1994. Markov chains for exploring posterior distributions. <italic>the Annals of Statistics</italic> 1701–1728.</p><p>Zappia L, Phipson B, Oshlack A. 2017. Splatter: simulation of single-cell RNA sequencing data. <italic>Genome Biol</italic> 18:174. doi:10.1186/s13059-017-1305-0</p><p>Zhang L, Yu X, Zheng L, Zhang Y, Li Y, Fang Q, Gao R, Kang B, Zhang Q, Huang JY, Konno H, Guo X, Ye Y, Gao S, Wang S, Hu X, Ren X, Shen Z, Ouyang W, Zhang Z. 2018. Lineage tracking reveals dynamic relationships of T cells in colorectal cancer. <italic>Nature</italic> 564:268–272. doi:10.1038/s41586-018-0694-x</p></body></sub-article></article>