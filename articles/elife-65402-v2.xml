<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">65402</article-id><article-id pub-id-type="doi">10.7554/eLife.65402</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Humans optimally anticipate and compensate for an uneven step during walking</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-217177"><name><surname>Darici</surname><given-names>Osman</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-6217-5656</contrib-id><email>osman.darici1@ucalgary.ca</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-217178"><name><surname>Kuo</surname><given-names>Arthur D</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03yjb2x39</institution-id><institution>Faculty of Kinesiology, University of Calgary</institution></institution-wrap><addr-line><named-content content-type="city">Calgary</named-content></addr-line><country>Canada</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ting</surname><given-names>Lena H</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01dp7jr64</institution-id><institution>École Normale Supérieure</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>11</day><month>01</month><year>2022</year></pub-date><pub-date pub-type="collection"><year>2022</year></pub-date><volume>11</volume><elocation-id>e65402</elocation-id><history><date date-type="received" iso-8601-date="2020-12-03"><day>03</day><month>12</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2022-01-10"><day>10</day><month>01</month><year>2022</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2020-12-02"><day>02</day><month>12</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.12.01.407023"/></event></pub-history><permissions><copyright-statement>© 2022, Darici and Kuo</copyright-statement><copyright-year>2022</copyright-year><copyright-holder>Darici and Kuo</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-65402-v2.pdf"/><abstract><p>The simple task of walking up a sidewalk curb is actually a dynamic prediction task. The curb is a disturbance that could cause a loss of momentum if not anticipated and compensated for. It might be possible to adjust momentum sufficiently to ensure undisturbed time of arrival, but there are infinite possible ways to do so. Much of steady, level gait is determined by energy economy, which should be at least as important with terrain disturbances. It is, however, unknown whether economy also governs walking up a curb, and whether anticipation helps. Here, we show that humans compensate with an anticipatory pattern of forward speed adjustments, predicted by a criterion of minimizing mechanical energy input. The strategy is mechanistically predicted by optimal control for a simple model of bipedal walking dynamics, with each leg’s push-off work as input. Optimization predicts a triphasic trajectory of speed (and thus momentum) adjustments, including an anticipatory phase. In experiment, human subjects ascend an artificial curb with the predicted triphasic trajectory, which approximately conserves overall walking speed relative to undisturbed flat ground. The trajectory involves speeding up in a few steps before the curb, losing considerable momentum from ascending it, and then regaining speed in a few steps thereafter. Descending the curb entails a nearly opposite, but still anticipatory, speed fluctuation trajectory, in agreement with model predictions that speed fluctuation amplitudes should scale linearly with curb height. The fluctuation amplitudes also decrease slightly with faster average speeds, also as predicted by model. Humans can reason about the dynamics of walking to plan anticipatory and economical control, even with a sidewalk curb in the way.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>bipedal walking</kwd><kwd>central nervous system</kwd><kwd>control</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution>Office of Naval Research</institution></institution-wrap></funding-source><award-id>ETOWL program</award-id><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>AG030815</award-id><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008459</institution-id><institution>University of Calgary</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id><institution>Natural Sciences and Engineering Research Council of Canada</institution></institution-wrap></funding-source><award-id>Discovery program</award-id><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001804</institution-id><institution>Canada Research Chairs</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Darici</surname><given-names>Osman</given-names></name><name><surname>Kuo</surname><given-names>Arthur D</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection, and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Humans can predict and optimally plan goal-directed dynamic walking tasks that have transient events such as negotiating a sidewalk curb.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>There are indeterminate control choices to be made during walking, not least when steady gait is interrupted by a surface perturbation such as a sidewalk curb (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). If no compensation is performed, an upward perturbation might cause a sudden reduction of speed, and an overall loss of time compared to steady gait (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Other possibilities include nonanticipatory reaction occurring only after the perturbation (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), or tight regulation of step timing to immediately restore momentum (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). But it may be helpful to plan and act ahead with anticipatory adjustments. For example, a ball, once sighted, may be caught by predicting its dynamics and planning and executing an interception course. A sidewalk curb may similarly be anticipated ahead of time, albeit with most of the dynamics within the person rather than the curb, and with a less clearly defined objective. This raises the question of whether humans anticipate the curb, and what objective criteria govern its interception, perhaps with a single, optimal response. The seemingly simple task of dealing with an uneven step may yield insight on whether humans perform predictive, dynamical planning while they walk.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Hypothetical ways to walking over a single upward step (Up-step).</title><p>(<bold>a</bold>) Humans walk with the body center of mass (COM) moving up and down atop the stance leg behaving like an inverted pendulum. Momentum is disrupted by the Up-step if not for compensatory response, plotted as a time-varying trajectory of the COM’s forward speed <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, discretely sampled once per step <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Hypothetical responses could include (<bold>b</bold>) no compensation, (<bold>c</bold>) a nonanticipatory reactive compensation, and (d) tight time regulation. (<bold>b</bold>) No compensation means the same push-off actuation is performed regardless of Up-step, resulting in a transient loss of speed (speed vs. time, top) and time (cumulative time gain vs. time, bottom) relative to nominal level gait. (<bold>c</bold>) Nonanticipatory compensation occurs reactively after the perturbation (vertical dotted line aligned to Up-step) to quickly regain speed, perhaps to avoid loss of time. (<bold>d</bold>) Tight time regulation means applying control to keep each step’s timing as constant as possible to reject the disturbance. These responses could be less economical than an optimal control including anticipatory speed adjustments before and after the perturbation. In plots, speed <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> is sampled discretely at midstance instant (dot symbols) and plotted vs. time. Cumulative time gain is illustrated as time gained or lost compared to steady-level gait at nominal speed, as a function of elapsed time during a walking bout. The final value indicates the eventual time gain (or loss, if negative) over the entire distance. In the corresponding experiment, human subjects walked in a walkway (30 m long) with level ground ora single Up- or Down-step (height <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 7.5 cm) at midpoint.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig1-v2.tif"/></fig><p>Both feedback and anticipatory control could contribute to walking. Feedback refers to reactive control driven by sensory feedback of the body’s dynamical state, for example from vestibular and somatosensors to control standing balance (<xref ref-type="bibr" rid="bib21">Horak et al., 1990</xref>; <xref ref-type="bibr" rid="bib25">Kuo, 1995</xref>; <xref ref-type="bibr" rid="bib37">Park et al., 2004</xref>). Such feedback also appears important for balance during walking, for example to adjust foot placement each step (<xref ref-type="bibr" rid="bib4">Bauby and Kuo, 2000</xref>; <xref ref-type="bibr" rid="bib34">O’Connor and Kuo, 2009</xref>; <xref ref-type="bibr" rid="bib51">Wang and Srinivasan, 2014</xref>). In contrast, anticipatory control actions take place before the body state has been affected, perhaps using vision to predict an upcoming perturbation or obstacle. For example, humans clearly anticipate and plan for the body’s future location, for example to negotiate around obstacles or through doorways (<xref ref-type="bibr" rid="bib3">Arechavaleta et al., 2008</xref>; <xref ref-type="bibr" rid="bib7">Brown et al., 2021</xref>; <xref ref-type="bibr" rid="bib40">Patla, 1998</xref>). In particular, foot placement and motion are planned, with the help of vision, to avoid or step over upcoming obstacles (<xref ref-type="bibr" rid="bib40">Patla, 1998</xref>; <xref ref-type="bibr" rid="bib38">Patla and Rietdyk, 1993</xref>), and to land on foot targets (<xref ref-type="bibr" rid="bib17">Drew et al., 2008</xref>; <xref ref-type="bibr" rid="bib30">Matthis and Fajen, 2013</xref>). Although much of this planning has been described in terms of kinematics, it may also include intersegmental dynamics, which might be regulated to clear obstacles with reduced mechanical work (<xref ref-type="bibr" rid="bib39">Patla and Prentice, 1995</xref>). There may, however, also be advantages to planning other dynamical states such as speed or momentum during locomotion, for example when one speeds up before jumping over a puddle. Indeed, runners do load the leg differently just before a drop (<xref ref-type="bibr" rid="bib32">Müller et al., 2012</xref>), perhaps as a way to regulate momentum. The negotiation of uneven terrain might similarly benefit from anticipatory planning of speed or momentum.</p><p>Any systematic control strategy, regardless whether anticipatory or feedback, should also be driven by objective criteria to select among infinite options. For locomotion, the criterion of metabolic energy economy determines features such as the preferred step length and step width during steady walking (<xref ref-type="bibr" rid="bib14">Donelan et al., 2001</xref>; <xref ref-type="bibr" rid="bib53">Zarrugh et al., 1974</xref>), as governed by the pendulum-like dynamics of the legs (<xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>). Energetic costs are also greater on uneven terrain (<xref ref-type="bibr" rid="bib24">Kowalsky et al., 2021</xref>; <xref ref-type="bibr" rid="bib36">Pandolf et al., 1977</xref>; <xref ref-type="bibr" rid="bib50">Voloshina et al., 2013</xref>) and under transient conditions (<xref ref-type="bibr" rid="bib7">Brown et al., 2021</xref>). However, it is unknown whether the economy preferences of steady walking apply to uneven terrain as well. We previously explored this question theoretically with a simple model of human walking (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>), for the task of negotiating a single uneven step (termed Up- or Down-step) during otherwise steady walking (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). We used optimal control to determine the most economical strategy to regain time and momentum lost from the disturbance. The objective was to minimize a crude indicator of energy expenditure, the mechanical work performed in the step-to-step transition from one pendulum-like stance leg to the next (<xref ref-type="bibr" rid="bib15">Donelan et al., 2002</xref>; <xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>). This yielded a strategy for negotiating an Up-step by modulating forward momentum and speed over multiple steps, starting with a speed-up before the perturbation, and continuing the modulation for several steps after the perturbation. The model predicted a substantial economic advantage to the anticipatory speed-up, compared to post hoc compensation alone. The optimal control was systematically scalable, with greater amplitude of speed fluctuations for larger step heights, and an almost opposite amplitude for negotiating a Down-step (with negative height change). This suggests that humans might also benefit from such an anticipatory strategy, made determinate by optimization.</p><p>The purpose of the present study was to test whether humans negotiate a step height disturbance with an anticipatory compensation strategy as predicted by dynamic optimization. The compensation is manifested as a trajectory of speed fluctuations both before and after the disturbance, to reduce energy expenditure and avoid loss of time from the disturbance. We tested whether humans use a compensatory pattern similar to the predicted optimum, including anticipatory fluctuations before the step is physically encountered. This is contrasted against alternative strategies such as reacting only after the disturbance, or not reacting at all. We also tested whether the human pattern varies systematically, as predicted by model (<xref ref-type="fig" rid="fig2">Figure 2</xref>), by scaling in amplitude and time for Up- vs. Down-steps and different walking speeds. This may reveal whether such a compensation strategy may be generalized for different nominal walking conditions. The results may reveal whether humans reason about their walking dynamics to perform predictive planning on uneven terrain.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Model of dynamic walking over a single Up- (or Down-) step.</title><p>(<bold>a</bold>) Model behaves like an inverted pendulum. Momentum and speed fluctuate in each step (numbered <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), and are particularly disrupted by an uneven step (at <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>b</bold>) Dynamic walking model has a point mass <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> at pelvis, supported by an inverted pendulum stance leg (massless, length <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, gravitational acceleration <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, fixed or constrained step length <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and inter-leg angle <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>2</mml:mn><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>). (<bold>c</bold>) Level nominal walking has discrete step-to-step transition where COM velocity (dark arrow) is redirected from forward-and-downward to forward-and-upward by active, impulsive trailing leg push-off (PO), immediately followed by an inelastic, impulsive, leading leg collision (CO). Both PO and CO are directed along the corresponding leg. (<bold>d, e</bold>) The model walks Up or Down a step by modulating the sequence of discrete push-offs surrounding and including the uneven step. The model’s compensatory response is therefore summarized as a time-varying trajectory of speeds <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, discretely sampled once per step <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig2-v2.tif"/></fig><sec id="s1-1"><title>Model predictions</title><p>The model yielded two main predictions to be tested experimentally. First, it predicted an anticipatory compensation strategy, in the form of speed fluctuations before and after the disturbance (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Considerable momentum and time would be lost to an Up-step if not for compensation. The predicted optimal compensation to avoid a loss of overall time is to speed-up in advance of the Up-step (thereby reducing the loss of momentum and time atop it), and then regain momentum afterwards (<xref ref-type="fig" rid="fig3">Figure 3a</xref>; <xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). The strategy depends systematically on the disturbance amplitude, where a Down-step is represented by negative amplitude. For stepping down (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), the optimal strategy is therefore almost exactly opposite the Up-step strategy: slow-down in advance, gain speed and time atop the Down-step, and then slow-down again toward nominal speed. This is manifested as twofold symmetry, meaning the optimal speed fluctuations are opposite in time (reflecting about the vertical axis at time 0) and in speed (reflecting about the mean speed). These strategies are executed through modulation in push-off work. As a result, time (<xref ref-type="fig" rid="fig3">Figure 3c</xref>) is first gained prior to the Up-step (and lost prior to Down-step, <xref ref-type="fig" rid="fig3">Figure 3d</xref>), such that the cumulative time gain eventually reaches zero, meaning that the model has not lost time compared to level walking.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Model predictions for walking over an Up-step or Down-step with minimum work.</title><p>(<bold>a</bold>) Optimal walking speed fluctuations vs. time, for Up-step compensation that minimizes push-off work while avoiding loss of time. Model anticipates the perturbation with a tri-phasic adjustment: Speed up ahead of time, then lose momentum atop the perturbation, and then regain speed thereafter. (<bold>b</bold>) Optimal speed fluctuations for Down-step compensation (blue symbols) is also tri-phasic, and nearly opposite in sign to Up-step: Slow down in advance, gain momentum, then slow down again (<bold>c</bold>) Cumulative time gained for Up- and Down-step compensations, ending with zero cumulative time loss. (<bold>d</bold>) Self-similarity of Up-step compensations shows that a similarly-shaped discrete compensation pattern can apply to different walking conditions with appropriate scaling. Example trajectories are shown for three different nominal speeds (slower, medium, faster), a longer fixed step length at each nominal speed (longer steps), and step length increasing with instantaneous speed according to human preferred step length (preferred steps). The trajectories are also scaled and superimposed (see inset) to illustrate a single self-similar pattern for all parameter choices. For model predictions (a-c), nominal conditions are equivalent to a human walking at 1.5 m/s with a fixed step length, and a 7.5 cm Up-step. Plots show normalized units (nominal mid-stance velocity <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>0.44</mml:mn><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mn>0.79</mml:mn><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.075</mml:mn><mml:mi>L</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) and human scale. Predictions are described in detail by (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig3-v2.tif"/></fig><p>The second main prediction was that a single optimal strategy, in terms of speed fluctuations, is scalable for practically any combination of overall walking speed and step length (termed self-similarity, <xref ref-type="fig" rid="fig3">Figure 3d</xref>). A basic pattern for optimal speed fluctuations retains approximately the same shape across different overall walking speeds, fixed step lengths, or even step length changing according to the human preferred step length relationship (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). In addition, the amplitude of that basic pattern scales inversely with speed, meaning slightly smaller fluctuations for faster speeds (compare slower to faster speeds in <xref ref-type="fig" rid="fig3">Figure 3d</xref>). This is because a step of fixed height (and thus gravitational potential energy) has a relatively smaller effect on the greater kinetic energy (increasing with square of speed) of faster walking. In addition, the timing scales such that the optimal strategy would have similar shape with shorter step lengths, except stretched slightly longer in time. Thus, we expect a single basic pattern, treated as a sequence of discrete speed fluctuations (<xref ref-type="fig" rid="fig3">Figure 3a</xref>) to predict optimal responses that are scalable to an individual’s average speed, step length, or the preferred speed and step length relationship. The pattern should be scaled to slightly smaller amplitude for faster average speeds, and to negative amplitude for Down-steps as opposed to Up-steps.</p><p>These predictions may be contrasted with several alternative hypothetical strategies (detailed by <xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). One is that humans might not compensate for an Up-step, and simply apply the same nominal effort as for level ground, albeit with a loss of time relative to nominal (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). Another is that humans may not anticipate but react only after the disturbance, which could regain lost time but with a greater speed-up (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). Yet another would be to tightly regulate step timing to nominal with each step (<xref ref-type="fig" rid="fig1">Figure 1d</xref>), even atop the disturbance, and thus keep speed fairly steady. According to the model, these strategies all differ in the amount of work performed, 0.489 MgL (about 10% more than nominal walking) for the optimal strategy, 0.519 MgL (17% more) for nonanticipatory reactive control, and 0.513 MgL (15% more) for tight time regulation. It would of course be most economical not to compensate at all. But if time is to be regained, there are infinite ways to do so, and only one that is most economical.</p><p>The model therefore makes testable predictions regarding human compensation for an uneven step. We hypothesize that step-to-step transitions are costly enough to merit anticipation and compensation for uneven steps. There are surely other energetic costs for walking, such as for adjusting step duration and length, or for controlling other degrees of freedom. It is, however, not necessary to model such features, if step-to-step transitions are costly enough to predict substantial and nontrivial compensations. We test what strategy humans perform by examining the distinct speed (and thus momentum) fluctuation patterns (<xref ref-type="fig" rid="fig3">Figure 3</xref>, top).</p></sec></sec><sec id="s2" sec-type="results"><title>Results</title><p>Prior to the main hypothesis tests, we first report some basic measures of overall walking speeds and variability, as a basis for comparing speed fluctuations (Speed, <xref ref-type="fig" rid="fig4">Figure 4</xref>). For the central (8.5 m) segment of the walkway, the overall average self-selected speed for control trials (level walking) was 1.38 ± 0.10 m/s on level ground (mean ± standard deviation [SD across subjects]). Each individual typically had a small amount of variation in self-selected speed between trials, with about 5% c.v. (coefficient of variation) across control trials. Subjects were thus fairly consistent in their own walking speed, despite receiving no feedback regarding walking durations or speeds. During level Control walking (<xref ref-type="fig" rid="fig4">Figure 4</xref>, top row), the speed fluctuations were small in magnitude and largely noise-like, with variability 0.031 ± 0.007 m/s (root-mean-square variation within trial, reported as mean ± SD across subjects), or about 2.2% c.v. These fluctuations exhibited a small amount of correlation between subjects, with correlation coefficient <italic>ρ</italic> = 0.47 ± 0.31 (p = 2.5e−04), as demonstrated by correlating each individual’s average Control trial against the average Control across all subjects. This suggests a degree of unexpected, nonrandom behavior shared between subjects, of relatively small amplitude of about 0.014 m/s, about 17% of the non-Control amplitudes.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Human walking speed trajectories vs. time, for (<bold>a</bold>) Control and (<bold>b</bold>) Up- and (<bold>c</bold>) Down-step conditions.</title><p>Plots are arranged in columns: (left) all individual trials of three representative test subjects (thin lines connecting small dots), along with per-subject average trajectories (across trials, thick lines) and standard deviations (SDs, shaded regions ± 1 s.d.; dashed line indicates average speed). Averages were computed for speed fluctuations treated as sequences of discrete steps, and plotted in both discrete (dot symbols) and continuous time. (Middle:) Speed fluctuations of each test subject (n = 2, individual colors) walking over the step, averaging all trials within each subject. (Right:) Average speed trajectories across all test subjects (solid line), with standard deviation (SD) across all subjects (light shaded region), and SD ignoring subject-dependent speed (darker shaded region). Individual patterns (Middle) were significantly correlated with the average pattern across subjects (Right). Speed is defined as each step’s length divided by corresponding step time, assigned to the middle- stance instant of each step (indicated by discrete dot symbols). All trials are aligned to zero time, defined as middle -stance instant after landing on the Up- or Down-step (both 7.5 cm high).</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Individual and average test subject speeds plotted in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title></caption><media mime-subtype="x-rar-compressed" mimetype="application" xlink:href="elife-65402-fig4-data1-v2.rar"/></supplementary-material></p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig4-v2.tif"/></fig><p>We next examine the human walking speed fluctuations in response to Up- and Down-steps. There were four main findings, comparing the responses across subjects in comparison to model, and in comparison to experimental instructions. The first question was whether the Up- and Down-step responses exhibited consistent, nonrandom behavior across subjects, to determine whether speed fluctuations were noisy or deterministic. The second was to test the primary hypothesis, that human speed fluctuations have a deterministic pattern as predicted by a model minimizing mechanical work. The third was to test the related expectation that speed fluctuation amplitudes should scaled with step height and overall walking speed, as also predicted by model. The final test was to quantify the consistency of overall walking durations for each subject, as an indicator of compliance to experimental instructions. Along with their speed fluctuations, subjects also exhibited fluctuations in step length and duration. These factors were not included in model and therefore not tested, but the trends are summarized in Appendix 2.</p><sec id="s2-1"><title>Humans produced triphasic Up- and Down-step compensatory speed fluctuations</title><p>There was also a clear pattern in compensations for an uneven step, with consistent fluctuations in walking speed across trials and across subjects (Speed, <xref ref-type="fig" rid="fig4">Figure 4</xref>). The fluctuations within these trials were greater than those of Control, about 3.0% and 3.4% c.v. for Up- and Down-steps (<xref ref-type="fig" rid="fig4">Figure 4</xref>, middle and bottom), respectively. The compensation strategies, in terms of walking speed trajectory over time, appeared qualitatively similar between multiple trials for an individual (<xref ref-type="fig" rid="fig4">Figure 4</xref>, left column), and between different individuals (<xref ref-type="fig" rid="fig4">Figure 4</xref>, middle column), to yield a single representative trajectory for all Up-step compensations (<xref ref-type="fig" rid="fig4">Figure 4</xref> right column).</p><p>The basic speed response could be summarized in terms of a triphasic pattern centered about the Up-step: (1) speed up in the two steps prior, (2) then lose speed during the two steps onto the Up-step and immediately thereafter, and (3) then regain speed over the following one or two steps. The peak speed just prior to the Up-step (<inline-formula><mml:math id="inf15"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) was about 5.7% greater than average speed, and the minimum after the Up-step (<inline-formula><mml:math id="inf16"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>) was about 3.4% slower. Similar observations were the case for Down-step compensations (<xref ref-type="fig" rid="fig4">Figure 4</xref>, bottom row), except with fluctuations in nearly the opposite direction, in a basic pattern of about 2.0% slow-down prior to the Down-step (<inline-formula><mml:math id="inf17"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), and 3.6% and 3.8% faster after (<inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> respectively), followed by a brief slow-down to nominal. The timing of this pattern was slightly different from Up-step, with the initial slow-down being clearest for only one step immediately before the Down-step (<inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), then speed-up occurring for about two to three steps, and the return to normal walking in only about one step. The anticipatory compensation thus begins only a few steps before the perturbation, and is accompanied by several steps of response after the perturbation.</p><p>The consistency of responses across subjects was quantified as follows. The Up-step speed fluctuations were similar across subjects (compare <xref ref-type="fig" rid="fig4">Figure 4</xref>, middle and right columns), with a positive correlation coefficient between each individual’s Up-step trials and the average across subjects (<italic>ρ =</italic> 0.82 ± 0.1252; p = 1.26e−10 paired <italic>t</italic>-test of correlations, performed across discrete speed sequences). The same was true for Down-step patterns, with positive correlation (<italic>ρ</italic> = 0.68 ± 0.27, p = 3.0e−06). Neither Up- nor Down-step speed fluctuations were well correlated with Control (<italic>ρ</italic> = −0.016 ± 0.21 and 0.184 ± 0.193, respectively, correlating each subject’s Up- and Down-step responses against average Control across subjects, p = 0.78, p = 0.007). Moreover, the speed fluctuations for the Up-step and Down-step were somewhat opposite to each other, with a negative correlation between individual Up-steps and average Down-step pattern and vice versa (respectively, <italic>ρ</italic> = −0.34 ± 0.16, p = 1.6e−05; <italic>ρ =</italic> −0.27 ± 0.22, p = 0.0016).</p></sec><sec id="s2-2"><title>Human compensations were consistent with minimum-work predictions</title><p>In support of the main hypothesis, the compensation strategies agreed reasonably well with optimal control model predictions (<xref ref-type="fig" rid="fig5">Figure 5</xref>, top for model; bottom for human). The model had predicted a similar triphasic pattern for speed fluctuations (<xref ref-type="fig" rid="fig3">Figure 3</xref>), as a means of traversing the walkway with minimum push-off work, while maint aining nominal overall speed. This agreement was quantified by a positive correlation coefficient between human and model fluctuations for both Up- and Down-steps (<italic>ρ</italic> = 0.50 ± 0.21, p = 4.4e−6 and <italic>ρ</italic> = 0.59 ± 0.17, p = 1.08e−7; paired <italic>t</italic>-tests for correlations performed across discrete speed sequences). And in keeping with the model’s prediction of opposing fluctuations for Up- vs. Down-steps, there was also a negative correlation between human Up-steps and model Down-steps, and vice versa (<italic>ρ</italic> = −0.42 ± 0.21, p = 2.75e−5 and <italic>ρ</italic> = −0.54 ± 0.15, p = 8.05e−8; paired <italic>t</italic>-tests). We also verified that human control responses were not correlated with model predictions for either Up- or Down-step, with correlation coefficients not significantly different from zero (p = 0.32, p = 0.31).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Comparison of model and human walking speed fluctuations vs. time, compensating for (left column:) Up- and (right column:) Down-steps.</title><p>(Top row:) Model speed fluctuations predicted to minimize push-off mechanical work. (Bottom row:) Experimentally measured compensation strategies for humans (n = 12), showing average speed pattern across subjects (shaded regions denote ±1 s.d. after eliminating variations in average speed). Human speed fluctuations were significantly correlated with model for both Up-step <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.50</mml:mn><mml:mo>∗</mml:mo><mml:mo>±</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.21</mml:mn><mml:mo>;</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>4.4</mml:mn><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> and Down-step <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0.59</mml:mn><mml:mo>∗</mml:mo><mml:mo>±</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.17</mml:mn><mml:mo>;</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, asterisk indicates statistical significance; correlations performed between discrete speed sequences. Each data point corresponds to the body’s forward walking speed, defined as each step’s length divided by step time, and assigned to the instance when the stance leg is upright. The first step onto the Up- or Down-step is indicated by vertical dashed line, also at middle stance instant. The average overall walking speed is denoted by horizontal solid line. Model trajectories (<xref ref-type="fig" rid="fig3">Figure 3</xref>) are converted from mid-stance speed in simulation (dashed lines) into the equivalent of experimental body speed (solid lines; see <xref ref-type="fig" rid="fig6">Figure 6</xref>). Model predicts shape of fluctuation pattern but not exact amplitude. Plots show dimensional equivalents to model with speed in units of <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mn>3.13</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and time in units <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msqrt><mml:mi>L</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mn>0.32</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> (using gravitational acceleration and human leg length <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig5-v2.tif"/></fig><p>The human triphasic responses were not consistent with the alternative control strategies. The anticipatory speed-up before perturbation did not agree with the no-compensation and reactive-compensation (<xref ref-type="fig" rid="fig1">Figure 1b, c</xref>) strategies, where no change in speed would be expected. The speed fluctuations before and after perturbation were also nearly opposite to, and therefore not consistent with the tight time regulation strategy (<xref ref-type="fig" rid="fig1">Figure 1d</xref>).</p></sec><sec id="s2-3"><title>Human compensation patterns were self-similar and scalable for step height and overall walking speed</title><p>There were three indicators of self-similarity and scaling, all consistent with model predictions. First, the significant intersubject correlations are indicative of self-similarity among different individuals within each condition. The model had predicted a similar triphasic response pattern that could be scaled in amplitude and time for different average walking speeds and step lengths (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). The significant correlations (reported above, compare <xref ref-type="fig" rid="fig4">Figure 4</xref>, middle and right columns, p = 1.26e−10 for Up-steps, p = 3.0e−06 for Down-steps) show that each individual and each trial’s speed fluctuations were proportional to the average pattern across subjects. Fluctuations were thus similar across a range of self-selected speeds and step lengths, with timing compared at discrete step numbers account for continuous time scaling. Thus, a single, self-similar pattern for Up- and Down-steps (<xref ref-type="fig" rid="fig4">Figure 4</xref> average across subjects, right column) was sufficient to summarize responses across individuals walking at their own pace.</p><p>Second, the speed fluctuations exhibited scaling with step height. There was a significant linear relationship between step height <italic>b</italic> (+0.075, −0.075, and 0 cm) and each trial’s fluctuation amplitude, with a positive linear coefficient <italic>c<sub>b</sub></italic> (0.849 ± 0.047, mean ± c.i. 95% confidence interval, p = 9.7e−175), and a small offset (<italic>d<sub>b</sub></italic> 0.104 ± 0.041). The coefficient indicates that Up- and Down-step responses (<xref ref-type="fig" rid="fig4">Figure 4</xref>, Human) were approximately opposite to each other, consistent with the model’s predicted twofold symmetry. Not surprisingly, level control responses were approximately intermediate between the two. The compensatory fluctuation pattern for Up-steps can therefore predict a significant portion of the patterns for the other two step height conditions.</p><p>Third, the speed fluctuation amplitudes decreased with faster walking speeds. There was a significant linear relationship between each Up-step trial’s average walking speed and its fluctuation amplitude. This yielded a weak but significant negative linear coefficient <italic>c<sub>ν</sub></italic> (−0.785 ± 0.618 c.i., p = 0.013), with offset near unity (<italic>d<sub>vν</sub></italic> 1.008 ± 0.073 c.i.). This is equivalent to a 10% increment in overall speed being accompanied by a 11.1% reduction in speed fluctuation amplitude for an Up-step (1.4 m/s). The average Up-step fluctuation pattern (across all subjects) was a significant predictor of patterns for different overall speeds and two other step height conditions.</p></sec><sec id="s2-4"><title>Humans walking durations were approximately conserved despite Up- and Down-step disturbances</title><p>Subjects were approximately compliant with the instruction to maintain a similar overall speed and walking duration across trials, whether or not there was an uneven step. There were no significant differences in overall speed, overall step length, or overall duration across trials, due to experimental condition (p = 0.65, p = 0.78, and p = 0.96, respectively, repeated measures ANOVA). Overall speeds were also fairly consistent across trials within Up- or Down-step conditions (2%–3% c.v.).</p><p>The apparent conservation of walking duration contrasts with what would be expected for a no-compensation strategy (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). The model, if performing constant push-offs instead of compensating, would slow-down atop the Up-step (<xref ref-type="fig" rid="fig1">Figure 1b</xref>, speed), mainly due to the exchange of kinetic energy for potential energy. It would gradually accumulate a loss of about 0.7 s in time (<xref ref-type="fig" rid="fig1">Figure 1b</xref>, time) compared to level walking. Alternatively, a particle sliding on frictionless ground at human-like speed, would be expected to lose about 0.7 m/s and 8 s to an upward ramp of equivalent height. Thus, both a walking model and a sliding particle lose substantial speed and time due to a change in height, if there were no active time conservation. Human subjects did not lose significant time from the Up-step’s potential energy, nor did they gain significant time from the Down-step.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>We examined how humans anticipate and compensate for a step change in the height of an otherwise flat walking surface. The compensatory response was characterized by a systematic, triphasic pattern in walking speed fluctuations, from which we draw several notable observations. First, the response was a scalable pattern that exhibited self-similarity, in that the same basic pattern could describe behavior at a variety of average walking speeds and step lengths. In addition, the response also exhibited an anticipatory component, meaning that it partially occurred prior to physically encountering the step. Finally, the response was consistent with predictions from a simple walking model, optimizing for least mechanical work. We next discuss these findings and their implications for anticipatory human control.</p><p>Human speed fluctuations exhibited a systematic, scalable pattern. A single basic pattern could describe the Up- and Down-step responses of different individuals, and even the different trials of a single individuals. That pattern could simply be scaled in amplitude and time scale to match any single response (similar to model, <xref ref-type="fig" rid="fig3">Figure 3d</xref>), according to the trial’s average walking speed and step length (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Systematicity is expected in part because of the deterministic and scalable dynamics of walking, with a pendulum-like exchange of kinetic and gravitational potential energy within each step (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>), and particularly an exchange of forward speed for vertical height atop the Up-step (<inline-formula><mml:math id="inf26"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, <xref ref-type="fig" rid="fig2">Figure 2</xref>). A pendulum’s motion, and the action of the step-to-step transition, are consistent and scalable in speed and step length, and in amplitude and time (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>). The scalability could potentially make it unnecessary for the central nervous system (CNS) to synthesize or reoptimize a new compensation for each new perturbation encountered. The dynamics of walking appear consistent enough to facilitate prediction of the compensation patterns .</p><p>The observed active control pattern was anticipatory, reactive, and time conserving. The evidence for anticipation is that the speed fluctuations commenced a few steps before the perturbation, as the first phase of the triphasic pattern (e.g., steps <inline-formula><mml:math id="inf27"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> in <xref ref-type="fig" rid="fig4">Figure 4</xref>), consisting of a speed-up prior to Up-steps, and a slow-down prior to Down-steps. This anticipation was not consistent with the alternative hypothetical strategies of no compensation (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), reactive and nonanticipatory compensation (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), and tight regulation to avoid step time fluctuations (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). Rather it was consistent with the minimum-work optimal control model, and counteracted the subsequent effects of the perturbation, which were a substantial loss (gain) of speed and time atop the Up- (Down-) step, during the second phase of the triphasic pattern (<inline-formula><mml:math id="inf28"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0,1</mml:mn></mml:math></inline-formula>). Following that perturbation and despite the anticipation, walking speed was still slower (faster) than nominal, and thus counteracted by another gradual speed-up (slow-down) during the third, reactive phase (<inline-formula><mml:math id="inf29"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2,3</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:math></inline-formula>). It is unclear whether the reactive phase was produced by feedback or by planning, but its effects were apparently part of an overall compensatory plan, because all three phases together conserved overall walking duration. Nominal walking speed and nominal time were regained several steps after the perturbation. In principle, it should also be possible to compensate with a purely reactive control after the perturbation (e.g., <xref ref-type="fig" rid="fig1">Figure 1c</xref>), an entirely anticipatory control, or an infinite number of other variations. However, model simulations suggest that such actions would require more mechanical work (and in many cases, much more) than the more integrative, triphasic pattern extending both before and after the perturbation (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>).</p><p>This compensatory strategy suggests that humans can consider energy and time in their control decisions. Optimal control is helpful for resolving redundancies and indeterminacies, but it is not straightforward to determine an objective function that adequately represents human behaviors. Metabolic energy expenditure is an important determinant of level locomotion (<xref ref-type="bibr" rid="bib2">Alexander, 1996</xref>; <xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>), and transient perturbations only add to that expenditure. We used a simple proxy measure for energy expenditure, the push-off work for step-to-step transitions. That work is proportionate to and appears to account for a majority of energetic cost of steady walking (<xref ref-type="bibr" rid="bib1">Adamczyk et al., 2006</xref>; <xref ref-type="bibr" rid="bib14">Donelan et al., 2001</xref>; <xref ref-type="bibr" rid="bib15">Donelan et al., 2002</xref>; <xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>), and explains much of the cost of transient accelerations (<xref ref-type="bibr" rid="bib44">Seethapathi and Srinivasan, 2015</xref>). The work proxy is thus predictive of physiological energy expenditure, while having minimal need for fitted parameters. Our study also explicitly considers timing, which is not a concern in steady locomotion at fixed speed. Here, considerable time (<xref ref-type="fig" rid="fig1">Figure 1b</xref>) and/or economy (<xref ref-type="fig" rid="fig1">Figure 1c</xref>) would be lost to an uncompensated perturbation (<xref ref-type="bibr" rid="bib9">Darici et al., 2018</xref>; <xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>), making their interaction important. We therefore incorporated overall time as a constraint in the model, and as a task instruction in the experiment. Timing is certainly important for tasks such as catching a ball, and perhaps for locomotion tasks such as intercepting a sidewalk curb or catching up to a friend on the sidewalk. It is of course a matter of context whether a person wishes to conserve time, hurry, or dawdle. But saving time often costs more energy, and our results suggest that humans can plan economical locomotion strategies that avoid loss of time when appropriate.</p><p>There remains the question of how the control is implemented by the central nervous system. The human’s ability to reason about surface perturbations could be regarded as a mapping from visual terrain image and body state into a control action, equivalent to an inverse internal model of dynamics (<xref ref-type="bibr" rid="bib22">Kawato, 1999</xref>). Examples from reinforcement learning suggest that such a mapping could be optimized iteratively (<xref ref-type="bibr" rid="bib20">Heess et al., 2017</xref>), which might be representable with biological neurons. Our results suggest that the control policy could conceivably stored in quite compact form, because a single compensation pattern (e.g., <inline-formula><mml:math id="inf30"><mml:mi>Δ</mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) might simply be scaled for different walking speeds, step heights, or step lengths. It is also conceivable that such a pattern could be repeatedly applied or superimposed to predict long sequences of uneven terrain, which are also energetically costly (<xref ref-type="bibr" rid="bib24">Kowalsky et al., 2021</xref>; <xref ref-type="bibr" rid="bib50">Voloshina et al., 2013</xref>). Also needed for learning is a means to evaluate the objective cost function, perhaps with physiological sensors of metabolic cost (<xref ref-type="bibr" rid="bib45">Selinger et al., 2015</xref>), but it might be sufficient to use sensors indirectly related to motion, and learn their association with energy. There is presently little known about how the CNS actually implements locomotor compensations, but the patterns observed here are relatively simple and scalable.</p><p>This study highlights a less-appreciated aspect of vision-based path planning. It is clear that humans use vision to plan paths for the body (<xref ref-type="bibr" rid="bib3">Arechavaleta et al., 2008</xref>; <xref ref-type="bibr" rid="bib7">Brown et al., 2021</xref>), including adjustment of COM height (<xref ref-type="bibr" rid="bib32">Müller et al., 2012</xref>) and foot placement (<xref ref-type="bibr" rid="bib30">Matthis and Fajen, 2013</xref>; <xref ref-type="bibr" rid="bib40">Patla, 1998</xref>). After all, it is sensible to predict which paths are feasible and which are less arduous. But we found that humans plan not just positions, but also dynamical trajectories such as forward momentum. They make quick, dynamically sensible decisions to overcome quite minor obstacles, apparently for energetic benefit. Such planning might also explain the leg loading preceding a Down-step in human running (<xref ref-type="bibr" rid="bib32">Müller et al., 2012</xref>). It is also consistent with how birds run over an obstacle, with an anticipatory vault in the step beforehand (<inline-formula><mml:math id="inf31"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>), perhaps for economy (<xref ref-type="bibr" rid="bib6">Birn-Jeffery et al., 2014</xref>). Path planning may therefore be for more than just body location, but also dynamical state.</p><p>There are of course, other possible optimality criteria not considered here. We have tested and rejected a few here: no compensation, reactive compensation, and tight speed regulation (<xref ref-type="fig" rid="fig1">Figure 1</xref>). Other alternatives could potentially be tested, if stated unambiguously and objectively enough to model. A challenge is that most quantitative models to date apply to steady-state conditions, and it is unknown whether they can predict transients. To our knowledge, the present study is the first to use a mechanistic model to predict behavioral, multistep trajectories performed by humans. Perhaps the closest analog is a model based on empirical energetic cost curves that explain the curvilinear paths that humans take to go through doorways (<xref ref-type="bibr" rid="bib7">Brown et al., 2021</xref>). We suspect that the empirical costs could be predicted mechanistically by a three-dimensional version of our dynamic walking model (e.g., <xref ref-type="bibr" rid="bib43">Rebula et al., 2017</xref>), although that remains to be tested. We also expect that our model is compatible with other, more complex models, if the center of mass (COM) moves in an inverted pendulum motion, and the mechanical work of step-to-step transitions accounts for much or most of the energy expenditure. It would be challenging to predict the observed human responses with a model that does not subscribe to these basic principles.</p><p>Such a mechanistic approach has similarities to the separate field of neuromotor control for upper extremity reaching movements. That field has demonstrated how humans learn and adapt their arm dynamics, consistent with CNS internal models (<xref ref-type="bibr" rid="bib18">Franklin et al., 2008</xref>; <xref ref-type="bibr" rid="bib47">Sharp et al., 2011</xref>). In reaching studies, adaptation is usually guided by repeated practice and explicit feedback, say of position error with respect to an explicit target. Trajectory planning may similarly apply to locomotion, in anticipation of perturbations to dynamics. But one difference here is that subjects received no explicit feedback of any kind of error, including timing, and no repeated practice. Their planning appears to be based on prior experience with similar dynamics and similar timing context. There may be rich opportunity for locomotion to borrow from the optimization approaches of reaching, while also providing a complementary perspective on CNS control.</p><p>The present study is a drastic simplification of the costs relevant to human locomotion. There are certainly many contributions to the metabolic cost, such as for muscles to produce force (<xref ref-type="bibr" rid="bib42">Rebula and Kuo, 2015</xref>; <xref ref-type="bibr" rid="bib49">van der Zee and Kuo, 2021</xref>) irrespective of work. There are also many actions known to cost energy during locomotion, for example transient adjustment of step length and frequency (<xref ref-type="bibr" rid="bib33">Ojeda et al., 2015</xref>; <xref ref-type="bibr" rid="bib48">Snaterse et al., 2011</xref>), active lifting of the swing foot for ground clearance (<xref ref-type="bibr" rid="bib52">Wu and Kuo, 2016</xref>), and lateral step width and foot placement (<xref ref-type="bibr" rid="bib14">Donelan et al., 2001</xref>; <xref ref-type="bibr" rid="bib35">O’Connor et al., 2012</xref>). There are also nonenergetic factors that govern human behavior such as vigor (<xref ref-type="bibr" rid="bib46">Shadmehr et al., 2019</xref>), which also affects timing, but in the form of a reward rather than the constraint used here. Stability may also be important for human locomotion, although we found no need to include it as an explicit objective, first because our walking model has passive dynamic stability against small disturbances (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>), and second because optimization for economy alone was sufficient to traverse the perturbation without falling. Stability might affect walking more when there is a more significant risk of falling than observed here. The present study shows that energy and time are two factors that may influence locomotion planning, but is also not intended to exclude other objectives and influences.</p><p>There are also limitations to the present model of walking. Notably, our model was intended to illustrate the effects of relatively small speed variations and surface height perturbations on pendulum-like walking. We did not explicitly control for walking speed, resulting in quite small differences between trials that make the speed scaling a rather weak test. We examined relatively low, 7.5 cm steps that can be traversed quite easily and still be treated as walking, as opposed to climbing stairs. The model did have predictive value (correlating with human with <italic>ρ</italic> = 0.50, <xref ref-type="fig" rid="fig4">Figure 4</xref>), but the human patterns seemed to have some qualitatively consistent differences, for example in the amount of slow-down preceding the Down-step, and the number of steps spent speeding up or slowing down (<xref ref-type="fig" rid="fig4">Figure 4</xref>). The differences might be related to how humans flex their knees when stepping down, and actively lift the foot to clear the trailing step, especially if the foot lands far behind it and must therefore travel a longer distance before moving to the lower height. This complex action could potentially influence the strategy for COM motion. It could potentially be included in dynamic walking models with explicit knee (e.g., <xref ref-type="bibr" rid="bib11">Dean and Kuo, 2009</xref>) and ankle (<xref ref-type="bibr" rid="bib54">Zelik et al., 2014</xref>) joints, which have step-to-step transition energetics similar to here (e.g., <xref ref-type="bibr" rid="bib15">Donelan et al., 2002</xref>; <xref ref-type="bibr" rid="bib1">Adamczyk et al., 2006</xref>). Such models could potentially be useful for stepping higher, but we also believe that steps as high as stairsteps would ultimately require quite different control, less like an inverted pendulum. We also expect that transiently varying step lengths and foot placements could be added to the model (<xref ref-type="bibr" rid="bib5">Bhounsule, 2014</xref>; <xref ref-type="bibr" rid="bib27">Kuo, 2001</xref>; <xref ref-type="bibr" rid="bib33">Ojeda et al., 2015</xref>). We have previously proposed that substantial energy is also expended for active leg motions during steady walking (<xref ref-type="bibr" rid="bib13">Doke and Kuo, 2007</xref>; <xref ref-type="bibr" rid="bib12">Doke et al., 2005</xref>), perhaps half that expended for step-to-step transitions (<xref ref-type="bibr" rid="bib27">Kuo, 2001</xref>). We presently lack a model for the cost of transient step adjustments, which could potentially provide more detail about how active speed and step length fluctuations are achieved (e.g. <xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). It is also likely that humans couple their sagittal and frontal plane motions for a change in step height, which might be accommodated in a three-dimensional model (<xref ref-type="bibr" rid="bib23">Kim and Collins, 2017</xref>; <xref ref-type="bibr" rid="bib26">Kuo, 1999</xref>). Considerable improvements might be achievable with additional dynamical degrees of freedom, but these would also entail additional free parameters, which must often be fit to data and could diminish the generality of the model predictions. An advantage of the present simple model is that it has negligible parametric sensitivity (<xref ref-type="fig" rid="fig3">Figure 3d</xref>), and predicts fundamental aspects of walking dynamics based on first principles.</p><p>Despite these limitations, we showed here that humans perform compensatory, multistep speed adjustments on uneven terrain. A simple model minimizing the mechanical work of step-to-step transitions can predict these adjustments. The adjustments start several steps before, extend after the perturbation, in a triphasic pattern of speed fluctuations. Such a pattern is consistent with metabolic energy expenditure as a criterion for optimal control, and shows that humans perform anticipatory control before a perturbation is directly encountered. The CNS appears to anticipate the effects of disturbances on the dynamics of the body and exploit these dynamics for active and economical control.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><p>This study consisted of an experiment to test how humans traverse a single Up- or Down-step interrupting steady walking. We hypothesized that humans would anticipate the surface height perturbation, and produce a compensatory pattern of walking speed fluctuations, similar to predictions from our previous modeling study (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). Specifically, the model predicted a triphasic pattern for speed fluctuations, intended to compensate for the perturbation with minimal mechanical work, and conserve overall walking speed and walking time over a walkway of fixed distance. Although the model is far simpler than human, its mechanical work appears to explain a substantial fraction of human metabolic cost, perhaps enough to predict anticipatory walking strategies. We first summarize the model predictions, prior to describing the experimental procedure.</p><sec id="s4-1"><title>Model of walking</title><p>We summarize predictions from an optimal control model of walking (<xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>), with details in Appendix 1. The task is to walk down a walkway interrupted by a single Up- or Down-step (numbered step <inline-formula><mml:math id="inf32"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>; <xref ref-type="fig" rid="fig1">Figure 1a</xref>), with adjustments to the forward speed <inline-formula><mml:math id="inf33"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the COM for each step <inline-formula><mml:math id="inf34"><mml:mi>i</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2a</xref>; defined as the COM velocity at midstance when stance leg is vertical). The model has rigid, pendulum-like legs supporting a point-mass pelvis of mass <inline-formula><mml:math id="inf35"><mml:mi>M</mml:mi></mml:math></inline-formula>, along with infinitesimal-mass feet (<xref ref-type="fig" rid="fig2">Figure 2b</xref>; <xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>). The dynamics of the single stance phase are those of a simple inverted pendulum, which conserves mechanical energy and therefore loses speed stepping on an Up-step. As a simplification, the model’s legs nominally take steps either of fixed length similar to the ‘rimless wheel’ model (<xref ref-type="bibr" rid="bib31">McGeer, 1990</xref>), or variable length increasing with speed according to the human preferred step length relationship (see Appendix 1). With inverted pendulum dynamics, a level, nominal step (<xref ref-type="fig" rid="fig2">Figure 2c</xref>) is energetically conservative, except when punctuated by a step-to-step transition, where the trailing leg pushes off (PO) impulsively just before the leading leg’s dissipative collision (CO) impulse. This redirects the center-of-mass (COM) velocity to a new pendular arc described by the leading leg. The push-off and collision impulses are performed along the axis of the corresponding legs, with push-off as the only powered actuation, and (perfectly inelastic) collision the only dissipation. The push-off work constitutes the only energy cost in this model. Experiments show that it explains how mechanical work and human metabolic energy expenditure increase as a function of step length (<xref ref-type="bibr" rid="bib15">Donelan et al., 2002</xref>) or step width (in 3D model; <xref ref-type="bibr" rid="bib14">Donelan et al., 2001</xref>) on level ground. Of course, there are certainly other costs such as to move the legs (<xref ref-type="bibr" rid="bib12">Doke et al., 2005</xref>) or maintain balance (<xref ref-type="bibr" rid="bib16">Donelan et al., 2004</xref>; <xref ref-type="bibr" rid="bib35">O’Connor et al., 2012</xref>), but evidence suggests that they are dominated by the higher cost of step-to-step transitions (<xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>). Here, we modeled uneven terrain as a small, vertical height discrepancy <inline-formula><mml:math id="inf36"><mml:mi>b</mml:mi></mml:math></inline-formula> in step height, where additional push-off can help compensate for momentum lost to an Up-step (<xref ref-type="fig" rid="fig2">Figure 2d</xref>), and collision for momentum gained to a Down-step (<xref ref-type="fig" rid="fig2">Figure 2e</xref>).</p><p>Optimal control was used to determine the compensation for a single step height change (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). The objective was to minimize total push-off work for multiple (variable <inline-formula><mml:math id="inf37"><mml:mi>N</mml:mi></mml:math></inline-formula>) steps while compensating for the terrain unevenness. The model was governed by the walking dynamics and constrained to start and end its compensation at steady, nominal speed, with the <inline-formula><mml:math id="inf38"><mml:mi>N</mml:mi></mml:math></inline-formula> steps distributed equally before and after the Up-step. It was also constrained to match the total time for nominal level, steady walking, thus making up for time lost to the Up-step. The continuous time pendulum dynamics were controlled by discrete push-off work <inline-formula><mml:math id="inf39"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for each step (where <inline-formula><mml:math id="inf40"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> for the push-off onto the Up-step), which served as the decision variables for optimization. Each push-off caused a change in the forward speed <inline-formula><mml:math id="inf41"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the COM each step <inline-formula><mml:math id="inf42"><mml:mi>i</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), discretely sampled at the midstance instance when the stance leg passed through vertical, prior to the step-to-step transition. The control strategy refers to the discrete sequence of speeds <inline-formula><mml:math id="inf43"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (including <inline-formula><mml:math id="inf44"><mml:mi>i</mml:mi></mml:math></inline-formula> over a range of steps), or equivalently the push-off sequence <sub>i</sub><inline-formula><mml:math id="inf45"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . We expected that the compensation would occur within several steps before and after the perturbation, and selected <inline-formula><mml:math id="inf46"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:math></inline-formula> as more than sufficient to encompass the relevant speed fluctuations. In model, velocity perturbations decay within several steps, based on the exponential persistence time of model (about 90% decay within 5.7 steps; <xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). We simulated a nominal step height <inline-formula><mml:math id="inf47"><mml:mi>b</mml:mi></mml:math></inline-formula> equivalent to 7.5 cm.</p></sec><sec id="s4-2"><title>Human subject experiment</title><p>To test model predictions, we measured speed fluctuations as humans walked down a level walkway (about 30 m) with a single, raised step onto a second level of 7.5 cm (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). We tested healthy adult subjects (<inline-formula><mml:math id="inf48"><mml:mi>n</mml:mi></mml:math></inline-formula> = 12; 7 male, 5 female, all under 30 years age), whose steps and walking speed were measured with inertial measurement units (IMUs) on both feet. There were three conditions: Up-step, Down-step, and Control on level ground. Both Up- and Down-steps used the same walkway except in opposite directions, and Control took place on level floor directly alongside the walkway. The raised section, commencing about halfway down, was assembled from fairly rigid, polystyrene insulation foam. In all conditions, subjects walked at comfortable speed from a start line through and past a finish line. Trials took place in alternating direction, with a brief delay for the subject to turn around and stand briefly before starting the next trial. There were at least 4 (and up to 10) trials of each condition, usually with Up- and Down-steps alternating with each other, except with occasional Control conditions inserted at random and interrupting that pattern. Before data collection, subjects were given opportunity to try the conditions and gain familiarity with the walkway and the location of the Up-step. For brevity, all mentions of the Up-step apply equally to the Down-step, unless explicitly stated. We tested one-sample group, with sample size (<inline-formula><mml:math id="inf49"><mml:mi>n</mml:mi></mml:math></inline-formula> = 12) selected for a statistical power of at least 0.8, based on previous data for anticipated means and SDs (<xref ref-type="bibr" rid="bib8">Darici, 2015</xref>). The experiment was performed once, and each test subject was tested once with each condition as a repeated measure. All subjects provided written informed consent prior to the experiment, according to Institutional Review Board procedures (University of Michigan, Energetics, Balance, and Control of Human Locomotion, <ext-link ext-link-type="uri" xlink:href="https://errm.umich.edu/ERRM/sd?PageID=HUM00020554">HUM00020554</ext-link>).</p><p>The experiment was minimally governed, aside from instructing subjects which conditions to perform. To establish a subjective ‘normal’ walking speed, and walking time, subjects first performed two to four Control trials at the beginning of the experiment. We provided context by instructing subjects to walk ‘in about the same time’ throughout the experiment, although they never received feedback about their timing, reported in Results. The instructions were to avoid behaviors that might otherwise be considered normal in daily life, for example stopping to inspect the Up-step or to tie a shoelace or deciding to hurry through the experiment. We consider a loose time goal to be more explicit about expectations than a simpler but potentially ambiguous instruction to ‘walk normally’. At the same time, we allowed for arbitrary self-selected speeds, because the model’s predictions do not depend on a particular speed. We thus expected a range of speeds across trials and across subjects. To help subjects to step onto the Up-step without stutter steps, there was a visual cue (a paper sticker) on the otherwise featureless walking surface, several steps (approximately 5 m) before the Up-step. Subjects were informed that they could use this cue to line up their steps prior to the Up-step, although they were not required to use it, and no trials were excluded even if there was a stutter step. Anecdotally, most subjects appeared to pay little attention to the sticker, especially after the first few trials.</p><p>We measured walking speed fluctuation trajectories (<xref ref-type="fig" rid="fig6">Figure 6</xref>) with IMUs. A discrete body speed was recorded for each walking step, based on an integrated trajectory for each foot (<xref ref-type="bibr" rid="bib41">Rebula et al., 2013</xref>). The trajectories were computed from an IMU mounted atop each foot (<xref ref-type="fig" rid="fig6">Figure 6a</xref>), with gravity-compensated accelerations integrated to yield a spatiotemporal trajectory, subject to an assumption that each foot comes briefly to rest during each footfall, approximately in the middle of stance when the foot is flat on ground. These instances were used to correct the integrated foot velocity to zero, and thus reduce integration drift (<xref ref-type="bibr" rid="bib41">Rebula et al., 2013</xref>). We then estimated stride length and time from the forward distance and time between an IMU’s footfalls, respectively. Individual distances traveled by the 2 feet (<xref ref-type="fig" rid="fig6">Figure 6b</xref>) were corrected for integration drift so that they both agreed on overall distance, using linear detrending. Each foot’s average speed over a stride (<xref ref-type="fig" rid="fig6">Figure 6c</xref>) was defined as the stride length between two discrete footfall (midstance) instants of the same foot, divided by the stride time between those instants. The body’s forward walking speed (Speed, <xref ref-type="fig" rid="fig6">Figure 6c</xref> and subsequent figures) was estimated as a discrete sequence of these average speeds, once per step by alternating left and right feet (assuming the body travels at the same distance per stride as the feet), with each sample <italic>i</italic> corresponding to the midstance instance at beginning of stride. These speed trajectories were analyzed for a central, 8.5 m segment of the walkway, or about 15 steps surrounding the Up-step (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). This was more than sufficient to encompass the compensation patterns, which largely took place within only a few steps before and after the perturbation. To compare between trials, the time <inline-formula><mml:math id="inf50"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> was defined as the instant of the footfall onto the Up-step (or Down-step, or step next to it for Control), as detected by IMU. The speed trajectory for each subject’s trials within a condition was averaged at discrete step numbers, as were the times for those steps, to yield an individual’s average speed trajectory per condition.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Experimental measurement of forward walking speed from inertial data (representative data).</title><p>(<bold>a</bold>) Foot trajectories in space are computed from inertial measurement unit (IMU) data. Shown are representative sagittal plane trajectory for one foot’s motion during a stride, and the individual strides for both feet during an Up-step trial (with 2× vertical scale for trial). Trajectories were integrated from an IMU atop each foot, where drift was reduced by detecting footfall instances (black dots) where the foot was stationary, and correcting the integrated velocity to zero at those instances (<xref ref-type="bibr" rid="bib41">Rebula et al., 2013</xref>). (<bold>b</bold>) Forward speed vs. time for each foot and for the body. Each foot’s instantaneous forward speed was computed from the spatial trajectories. The average speed during each stride (‘stride average’, filled symbols) was determined, equal to the distance traveled divided by the stride duration. This was then treated as the body speed for each step (inset figure, filled symbols are same as stride averages), sampled discretely from each foot’s strides at the respective footfall instances. The fluctuations in body speed were compared with model predictions.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-fig6-v2.tif"/></fig><p>Model predictions were tested with speed trajectories for Up-step, Down-step, and Control conditions. First, we tested the consistency of human responses across different speeds and different subjects. Each individual’s trajectories (as discrete sequences) were compared against the average trajectory for all individuals with Pearson’s correlation coefficient <italic>ρ</italic>, with significant correlation determined by one-sample <italic>t</italic>-test. The patterns were thus compared for their shape for each discrete step, and not their amplitude or time scale. Significant correlation was therefore also used as an indicator of self-similarity across speeds, step lengths, and subjects.</p><p>Next, as a test of the model (<xref ref-type="fig" rid="fig3">Figure 3</xref>), individual subject trajectories were correlated against the model’s predicted trajectories. The model was intended to predict proportionalities in speed and work, and therefore the shapes of the fluctuation patterns, rather than absolute quantities. Therefore, each individual’s speed fluctuation pattern of <inline-formula><mml:math id="inf51"><mml:mi>N</mml:mi></mml:math></inline-formula> steps was correlated against the predicted pattern, with the Pearson’s correlation coefficient <italic>ρ</italic> expected to be positive (as opposed to a null hypothesis value of zero). Positive correlation across all subjects was tested for significance with one-sample paired <italic>t</italic>-test. The model predicted similar fluctuation patterns regardless of parameter choices (<xref ref-type="fig" rid="fig3">Figure 3d</xref>), and so we compared human against the model with fixed step lengths for simplicity. Only the optimal control model was tested in this way, whereas the alternative strategies (<xref ref-type="fig" rid="fig1">Figure 1</xref>) were tested by inspection.</p><p>Finally, we tested the model’s predicted scaling of speed fluctuations with step height and speed. We expected that the average Up-step response could predict the amplitude each individual’s response to Down-step and level control and across different speeds. These were tested with two types of linear regression, with the hypothesized predictor <inline-formula><mml:math id="inf52"><mml:mi>Δ</mml:mi><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denoting the average Up-step speed fluctuation pattern (across all subjects and Up-step trials, for steps <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf55"><mml:mi>Δ</mml:mi></mml:math></inline-formula> denoting fluctuation from average). The fluctuation waveform <inline-formula><mml:math id="inf56"><mml:mi>Δ</mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> for a subject <inline-formula><mml:math id="inf57"><mml:mi>j</mml:mi></mml:math></inline-formula> and trial <italic>k</italic> was expected to scale in proportion to the trial’s step height <inline-formula><mml:math id="inf58"><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> (+7.5, 0, and −7.5 cm),<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf59"><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the Up-step height, and <inline-formula><mml:math id="inf60"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf61"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the coefficient and offset from regression. Similarly, the fluctuation waveform was expected to scale in negative proportion to a trial’s overall speed <inline-formula><mml:math id="inf62"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>,<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>:</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>≈</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:msup><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mover><mml:mi>v</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mspace width="thinmathspace"/></mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf63"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are speed-related coefficient and offset, and <inline-formula><mml:math id="inf65"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mo>´</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> the average walking speed for all Up-step trials. Scaling with step height was tested by statistical significance of <inline-formula><mml:math id="inf66"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, expected to be near unity. Scaling with speed was tested by significance of <inline-formula><mml:math id="inf67"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, expected to be slightly negative. The offsets <inline-formula><mml:math id="inf68"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf69"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were expected to be near zero and unity, respectively, but were not tested because only <inline-formula><mml:math id="inf70"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf71"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were central to the hypothesis. We did not explicitly control for walking speed, and so the speed test relies on a sufficient range of differences in self-selected speeds between trials. Statistical significance was tested with a p threshold of 0.05.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Formal analysis, Investigation, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Funding acquisition, Investigation, Supervision, Writing - original draft, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other"><p>All subjects provided written informed consent prior to the experiment, according to Institutional Review Board procedures (University of Michigan, Energetics, Balance, and Control of Human Locomotion, HUM00020554).</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-65402-transrepform1-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>All data generated or analyzed during this study are included in the manuscript and supporting file.</p></sec><ack id="ack"><title>Acknowledgements</title><p>This work is supported by NSF DGE 0718128, the ONR ETOWL program, NIH AG030815, the Dr. Benno Nigg Research Chair (University of Calgary), and NSERC (Natural Sciences and Engineering Research Council of Canada) Discovery program and Canada Research Chair (Tier 1) program.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adamczyk</surname><given-names>PG</given-names></name><name><surname>Collins</surname><given-names>SH</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The advantages of a rolling foot in human walking</article-title><source>The Journal of Experimental Biology</source><volume>209</volume><fpage>3953</fpage><lpage>3963</lpage><pub-id pub-id-type="doi">10.1242/jeb.02455</pub-id><pub-id pub-id-type="pmid">17023589</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="1996">1996</year><source>Optima for Animals</source><publisher-loc>Princeton, NJ</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arechavaleta</surname><given-names>G.</given-names></name><name><surname>Laumond</surname><given-names>JP</given-names></name><name><surname>Hicheur</surname><given-names>H</given-names></name><name><surname>Berthoz</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>An Optimality Principle Governing Human Walking</article-title><source>IEEE Transactions on Robotics</source><volume>24</volume><fpage>5</fpage><lpage>14</lpage><pub-id pub-id-type="doi">10.1109/TRO.2008.915449</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bauby</surname><given-names>CE</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Active control of lateral balance in human walking</article-title><source>Journal of Biomechanics</source><volume>33</volume><fpage>1433</fpage><lpage>1440</lpage><pub-id pub-id-type="doi">10.1016/s0021-9290(00)00101-9</pub-id><pub-id pub-id-type="pmid">10940402</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhounsule</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Control of a compass gait walker based on energy regulation using ankle push-off and foot placement</article-title><source>Robotica</source><volume>33</volume><fpage>1314</fpage><lpage>1324</lpage><pub-id pub-id-type="doi">10.1017/S0263574714000745</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Birn-Jeffery</surname><given-names>AV</given-names></name><name><surname>Hubicki</surname><given-names>CM</given-names></name><name><surname>Blum</surname><given-names>Y</given-names></name><name><surname>Renjewski</surname><given-names>D</given-names></name><name><surname>Hurst</surname><given-names>JW</given-names></name><name><surname>Daley</surname><given-names>MA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Don’t break a leg: running birds from quail to ostrich prioritise leg safety and economy on uneven terrain</article-title><source>The Journal of Experimental Biology</source><volume>217</volume><fpage>3786</fpage><lpage>3796</lpage><pub-id pub-id-type="doi">10.1242/jeb.102640</pub-id><pub-id pub-id-type="pmid">25355848</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>GL</given-names></name><name><surname>Seethapathi</surname><given-names>N</given-names></name><name><surname>Srinivasan</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A unified energy-optimality criterion predicts human navigation paths and speeds</article-title><source>PNAS</source><volume>118</volume><elocation-id>e2020327118</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2020327118</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Darici</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2015">2015</year><conf-name>Beware of the bump: Optimal strategy to traverse a step height perturbation</conf-name><article-title>Dynamic Walking</article-title></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darici</surname><given-names>O</given-names></name><name><surname>Temeltas</surname><given-names>H</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Optimal regulation of bipedal walking speed despite an unexpected bump in the road</article-title><source>PLOS ONE</source><volume>13</volume><elocation-id>e0204205</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0204205</pub-id><pub-id pub-id-type="pmid">30256825</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Darici</surname><given-names>O</given-names></name><name><surname>Temeltas</surname><given-names>H</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Anticipatory Control of Momentum for Bipedal Walking on Uneven Terrain</article-title><source>Scientific Reports</source><volume>10</volume><elocation-id>540</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-57156-6</pub-id><pub-id pub-id-type="pmid">31953516</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dean</surname><given-names>JC</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Elastic coupling of limb joints enables faster bipedal walking</article-title><source>Journal of the Royal Society, Interface</source><volume>6</volume><fpage>561</fpage><lpage>573</lpage><pub-id pub-id-type="doi">10.1098/rsif.2008.0415</pub-id><pub-id pub-id-type="pmid">18957360</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doke</surname><given-names>J</given-names></name><name><surname>Donelan</surname><given-names>JM</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Mechanics and energetics of swinging the human leg</article-title><source>The Journal of Experimental Biology</source><volume>208</volume><fpage>439</fpage><lpage>445</lpage><pub-id pub-id-type="doi">10.1242/jeb.01408</pub-id><pub-id pub-id-type="pmid">15671332</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doke</surname><given-names>J</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Energetic cost of producing cyclic muscle force, rather than work, to swing the human leg</article-title><source>The Journal of Experimental Biology</source><volume>210</volume><fpage>2390</fpage><lpage>2398</lpage><pub-id pub-id-type="doi">10.1242/jeb.02782</pub-id><pub-id pub-id-type="pmid">17575044</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donelan</surname><given-names>JM</given-names></name><name><surname>Kram</surname><given-names>R</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Mechanical and metabolic determinants of the preferred step width in human walking</article-title><source>Proceedings. Biological Sciences</source><volume>268</volume><fpage>1985</fpage><lpage>1992</lpage><pub-id pub-id-type="doi">10.1098/rspb.2001.1761</pub-id><pub-id pub-id-type="pmid">11571044</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donelan</surname><given-names>JM</given-names></name><name><surname>Kram</surname><given-names>R</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Mechanical work for step-to-step transitions is a major determinant of the metabolic cost of human walking</article-title><source>The Journal of Experimental Biology</source><volume>205</volume><fpage>3717</fpage><lpage>3727</lpage><pub-id pub-id-type="doi">10.1242/jeb.205.23.3717</pub-id><pub-id pub-id-type="pmid">12409498</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donelan</surname><given-names>J</given-names></name><name><surname>Shipman</surname><given-names>D</given-names></name><name><surname>Kram</surname><given-names>R</given-names></name><name><surname>Kuo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Mechanical and metabolic requirements for active lateral stabilization in human walking</article-title><source>Journal of Biomechanics</source><volume>37</volume><fpage>827</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1016/j.jbiomech.2003.06.002</pub-id><pub-id pub-id-type="pmid">15111070</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drew</surname><given-names>T</given-names></name><name><surname>Andujar</surname><given-names>JE</given-names></name><name><surname>Lajoie</surname><given-names>K</given-names></name><name><surname>Yakovenko</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Cortical mechanisms involved in visuomotor coordination during precision walking</article-title><source>Brain Research Reviews</source><volume>57</volume><fpage>199</fpage><lpage>211</lpage><pub-id pub-id-type="doi">10.1016/j.brainresrev.2007.07.017</pub-id><pub-id pub-id-type="pmid">17935789</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname><given-names>DW</given-names></name><name><surname>Burdet</surname><given-names>E</given-names></name><name><surname>Tee</surname><given-names>KP</given-names></name><name><surname>Osu</surname><given-names>R</given-names></name><name><surname>Chew</surname><given-names>C-M</given-names></name><name><surname>Milner</surname><given-names>TE</given-names></name><name><surname>Kawato</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>CNS learns stable, accurate, and efficient movements using a simple algorithm</article-title><source>The Journal of Neuroscience</source><volume>28</volume><fpage>11165</fpage><lpage>11173</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3099-08.2008</pub-id><pub-id pub-id-type="pmid">18971459</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grieve</surname><given-names>DW</given-names></name></person-group><year iso-8601-date="1968">1968</year><article-title>Gait patterns and the speed of walking</article-title><source>Biomedical Engineering</source><volume>3</volume><fpage>119</fpage><lpage>122</lpage></element-citation></ref><ref id="bib20"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Heess</surname><given-names>N</given-names></name><name><surname>Tb</surname><given-names>D</given-names></name><name><surname>Sriram</surname><given-names>S</given-names></name><name><surname>Lemmon</surname><given-names>J</given-names></name><name><surname>Merel</surname><given-names>J</given-names></name><name><surname>Wayne</surname><given-names>G</given-names></name><name><surname>Tassa</surname><given-names>Y</given-names></name><name><surname>Erez</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Eslami</surname><given-names>SMA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Emergence of Locomotion Behaviours in Rich Environments</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1707.02286">https://arxiv.org/abs/1707.02286</ext-link></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horak</surname><given-names>FB</given-names></name><name><surname>Nashner</surname><given-names>LM</given-names></name><name><surname>Diener</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Postural strategies associated with somatosensory and vestibular loss</article-title><source>Experimental Brain Research</source><volume>82</volume><fpage>167</fpage><lpage>177</lpage><pub-id pub-id-type="doi">10.1007/BF00230848</pub-id><pub-id pub-id-type="pmid">2257901</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawato</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Internal models for motor control and trajectory planning</article-title><source>Current Opinion in Neurobiology</source><volume>9</volume><fpage>718</fpage><lpage>727</lpage><pub-id pub-id-type="doi">10.1016/s0959-4388(99)00028-8</pub-id><pub-id pub-id-type="pmid">10607637</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Collins</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Once-Per-Step Control of Ankle Push-Off Work Improves Balance in a Three-Dimensional Simulation of Bipedal Walking</article-title><source>IEEE Transactions on Robotics</source><volume>33</volume><fpage>406</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1109/TRO.2016.2636297</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kowalsky</surname><given-names>DB</given-names></name><name><surname>Rebula</surname><given-names>JR</given-names></name><name><surname>Ojeda</surname><given-names>LV</given-names></name><name><surname>Adamczyk</surname><given-names>PG</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Human walking in the real world: Interactions between terrain type, gait parameters, and energy expenditure</article-title><source>PLOS ONE</source><volume>16</volume><elocation-id>e0228682</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0228682</pub-id><pub-id pub-id-type="pmid">33439858</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>An optimal control model for analyzing human postural balance</article-title><source>IEEE Transactions on Bio-Medical Engineering</source><volume>42</volume><fpage>87</fpage><lpage>101</lpage><pub-id pub-id-type="doi">10.1109/10.362914</pub-id><pub-id pub-id-type="pmid">7851935</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Stabilization of Lateral Motion in Passive Dynamic Walking</article-title><source>The International Journal of Robotics Research</source><volume>18</volume><fpage>917</fpage><lpage>930</lpage><pub-id pub-id-type="doi">10.1177/02783649922066655</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>A simple model of bipedal walking predicts the preferred speed-step length relationship</article-title><source>Journal of Biomechanical Engineering</source><volume>123</volume><fpage>264</fpage><lpage>269</lpage><pub-id pub-id-type="doi">10.1115/1.1372322</pub-id><pub-id pub-id-type="pmid">11476370</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Energetics of actively powered locomotion using the simplest walking model</article-title><source>Journal of Biomechanical Engineering</source><volume>124</volume><fpage>113</fpage><lpage>120</lpage><pub-id pub-id-type="doi">10.1115/1.1427703</pub-id><pub-id pub-id-type="pmid">11871597</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuo</surname><given-names>AD</given-names></name><name><surname>Donelan</surname><given-names>JM</given-names></name><name><surname>Ruina</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Energetic consequences of walking like an inverted pendulum: step-to-step transitions</article-title><source>Exercise and Sport Sciences Reviews</source><volume>33</volume><fpage>88</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1097/00003677-200504000-00006</pub-id><pub-id pub-id-type="pmid">15821430</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matthis</surname><given-names>JS</given-names></name><name><surname>Fajen</surname><given-names>BR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Humans exploit the biomechanics of bipedal gait during visually guided walking over complex terrain</article-title><source>Proceedings. Biological Sciences</source><volume>280</volume><elocation-id>20130700</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2013.0700</pub-id><pub-id pub-id-type="pmid">23658204</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McGeer</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Passive Dynamic Walking</article-title><source>The International Journal of Robotics Research</source><volume>9</volume><fpage>62</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1177/027836499000900206</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname><given-names>R</given-names></name><name><surname>Ernst</surname><given-names>M</given-names></name><name><surname>Blickhan</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Leg adjustments during running across visible and camouflaged incidental changes in ground level</article-title><source>The Journal of Experimental Biology</source><volume>215</volume><fpage>3072</fpage><lpage>3079</lpage><pub-id pub-id-type="doi">10.1242/jeb.072314</pub-id><pub-id pub-id-type="pmid">22875771</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ojeda</surname><given-names>LV</given-names></name><name><surname>Rebula</surname><given-names>JR</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name><name><surname>Adamczyk</surname><given-names>PG</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Influence of contextual task constraints on preferred stride parameters and their variabilities during human walking</article-title><source>Medical Engineering &amp; Physics</source><volume>37</volume><fpage>929</fpage><lpage>936</lpage><pub-id pub-id-type="doi">10.1016/j.medengphy.2015.06.010</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Connor</surname><given-names>SM</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Direction-dependent control of balance during walking and standing</article-title><source>Journal of Neurophysiology</source><volume>102</volume><fpage>1411</fpage><lpage>1419</lpage><pub-id pub-id-type="doi">10.1152/jn.00131.2009</pub-id><pub-id pub-id-type="pmid">19553493</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Connor</surname><given-names>SM</given-names></name><name><surname>Xu</surname><given-names>HZ</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Energetic cost of walking with increased step variability</article-title><source>Gait &amp; Posture</source><volume>36</volume><fpage>102</fpage><lpage>107</lpage><pub-id pub-id-type="doi">10.1016/j.gaitpost.2012.01.014</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandolf</surname><given-names>KB</given-names></name><name><surname>Givoni</surname><given-names>B</given-names></name><name><surname>Goldman</surname><given-names>RF</given-names></name></person-group><year iso-8601-date="1977">1977</year><article-title>Predicting energy expenditure with loads while standing or walking very slowly</article-title><source>Journal of Applied Physiology</source><volume>43</volume><fpage>577</fpage><lpage>581</lpage><pub-id pub-id-type="doi">10.1152/jappl.1977.43.4.577</pub-id><pub-id pub-id-type="pmid">908672</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Park</surname><given-names>S</given-names></name><name><surname>Horak</surname><given-names>FB</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Postural feedback responses scale with biomechanical constraints in human standing</article-title><source>Experimental Brain Research</source><volume>154</volume><fpage>417</fpage><lpage>427</lpage><pub-id pub-id-type="doi">10.1007/s00221-003-1674-3</pub-id><pub-id pub-id-type="pmid">14618285</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patla</surname><given-names>A</given-names></name><name><surname>Rietdyk</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Visual control of limb trajectory over obstacles during locomotion: effect of obstacle height and width</article-title><source>Gait &amp; Posture</source><volume>1</volume><fpage>45</fpage><lpage>60</lpage><pub-id pub-id-type="doi">10.1016/0966-6362(93)90042-Y</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patla</surname><given-names>AE</given-names></name><name><surname>Prentice</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>The role of active forces and intersegmental dynamics in the control of limb trajectory over obstacles during locomotion in humans</article-title><source>Experimental Brain Research</source><volume>106</volume><fpage>499</fpage><lpage>504</lpage><pub-id pub-id-type="doi">10.1007/BF00231074</pub-id><pub-id pub-id-type="pmid">8983995</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patla</surname><given-names>AE</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>How Is Human Gait Controlled by Vision</article-title><source>Ecological Psychology</source><volume>10</volume><fpage>287</fpage><lpage>302</lpage><pub-id pub-id-type="doi">10.1080/10407413.1998.9652686</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rebula</surname><given-names>JR</given-names></name><name><surname>Ojeda</surname><given-names>LV</given-names></name><name><surname>Adamczyk</surname><given-names>PG</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Measurement of foot placement and its variability with inertial sensors</article-title><source>Gait &amp; Posture</source><volume>38</volume><fpage>974</fpage><lpage>980</lpage><pub-id pub-id-type="doi">10.1016/j.gaitpost.2013.05.012</pub-id><pub-id pub-id-type="pmid">23810335</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rebula</surname><given-names>JR</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The cost of leg forces in bipedal locomotion: a simple optimization study</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0117384</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0117384</pub-id><pub-id pub-id-type="pmid">25707000</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rebula</surname><given-names>JR</given-names></name><name><surname>Ojeda</surname><given-names>LV</given-names></name><name><surname>Adamczyk</surname><given-names>PG</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>The stabilizing properties of foot yaw in human walking</article-title><source>Journal of Biomechanics</source><volume>53</volume><fpage>1</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1016/j.jbiomech.2016.11.059</pub-id><pub-id pub-id-type="pmid">28161109</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seethapathi</surname><given-names>N</given-names></name><name><surname>Srinivasan</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The metabolic cost of changing walking speeds is significant, implies lower optimal speeds for shorter distances, and increases daily energy estimates</article-title><source>Biology Letters</source><volume>11</volume><elocation-id>20150486</elocation-id><pub-id pub-id-type="doi">10.1098/rsbl.2015.0486</pub-id><pub-id pub-id-type="pmid">26382072</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selinger</surname><given-names>JC</given-names></name><name><surname>O’Connor</surname><given-names>SM</given-names></name><name><surname>Wong</surname><given-names>JD</given-names></name><name><surname>Donelan</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Humans Can Continuously Optimize Energetic Cost during Walking</article-title><source>Current Biology</source><volume>25</volume><fpage>2452</fpage><lpage>2456</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.08.016</pub-id><pub-id pub-id-type="pmid">26365256</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shadmehr</surname><given-names>R</given-names></name><name><surname>Reppert</surname><given-names>TR</given-names></name><name><surname>Summerside</surname><given-names>EM</given-names></name><name><surname>Yoon</surname><given-names>T</given-names></name><name><surname>Ahmed</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Movement Vigor as a Reflection of Subjective Economic Utility</article-title><source>Trends in Neurosciences</source><volume>42</volume><fpage>323</fpage><lpage>336</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2019.02.003</pub-id><pub-id pub-id-type="pmid">30878152</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharp</surname><given-names>I</given-names></name><name><surname>Huang</surname><given-names>F</given-names></name><name><surname>Patton</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Visual error augmentation enhances learning in three dimensions</article-title><source>Journal of Neuroengineering and Rehabilitation</source><volume>8</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.1186/1743-0003-8-52</pub-id><pub-id pub-id-type="pmid">21888657</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Snaterse</surname><given-names>M</given-names></name><name><surname>Ton</surname><given-names>R</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name><name><surname>Donelan</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Distinct fast and slow processes contribute to the selection of preferred step frequency during human walking</article-title><source>Journal of Applied Physiology</source><volume>110</volume><fpage>1682</fpage><lpage>1690</lpage><pub-id pub-id-type="doi">10.1152/japplphysiol.00536.2010</pub-id><pub-id pub-id-type="pmid">21393467</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Zee</surname><given-names>TJ</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The high energetic cost of rapid force development in muscle</article-title><source>The Journal of Experimental Biology</source><volume>224</volume><elocation-id>jeb233965</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.233965</pub-id><pub-id pub-id-type="pmid">33707194</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voloshina</surname><given-names>AS</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name><name><surname>Daley</surname><given-names>MA</given-names></name><name><surname>Ferris</surname><given-names>DP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Biomechanics and energetics of walking on uneven terrain</article-title><source>The Journal of Experimental Biology</source><volume>216</volume><fpage>3963</fpage><lpage>3970</lpage><pub-id pub-id-type="doi">10.1242/jeb.081711</pub-id><pub-id pub-id-type="pmid">23913951</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Srinivasan</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Stepping in the direction of the fall: the next foot placement can be predicted from current upper body state in steady-state walking</article-title><source>Biology Letters</source><volume>10</volume><elocation-id>20140405</elocation-id><pub-id pub-id-type="doi">10.1098/rsbl.2014.0405</pub-id><pub-id pub-id-type="pmid">25252834</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>AR</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Determinants of preferred ground clearance during swing phase of human walking</article-title><source>The Journal of Experimental Biology</source><volume>219</volume><fpage>3106</fpage><lpage>3113</lpage><pub-id pub-id-type="doi">10.1242/jeb.137356</pub-id><pub-id pub-id-type="pmid">27473435</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zarrugh</surname><given-names>MY</given-names></name><name><surname>Todd</surname><given-names>FN</given-names></name><name><surname>Ralston</surname><given-names>HJ</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Optimization of energy expenditure during level walking</article-title><source>European Journal of Applied Physiology and Occupational Physiology</source><volume>33</volume><fpage>293</fpage><lpage>306</lpage><pub-id pub-id-type="doi">10.1007/BF00430237</pub-id><pub-id pub-id-type="pmid">4442409</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zelik</surname><given-names>KE</given-names></name><name><surname>Huang</surname><given-names>TWP</given-names></name><name><surname>Adamczyk</surname><given-names>PG</given-names></name><name><surname>Kuo</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The role of series ankle elasticity in bipedal walking</article-title><source>Journal of Theoretical Biology</source><volume>346</volume><fpage>75</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1016/j.jtbi.2013.12.014</pub-id><pub-id pub-id-type="pmid">24365635</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec id="s8" sec-type="appendix"><title>Dynamic walking model</title><p>The model dynamics are briefly summarized as follows (detailed previously by <xref ref-type="bibr" rid="bib9">Darici et al., 2018</xref>). Each of <inline-formula><mml:math id="inf72"><mml:mi>N</mml:mi></mml:math></inline-formula> steps has index <inline-formula><mml:math id="inf73"><mml:mi>i</mml:mi></mml:math></inline-formula> with the Up- or Down-step disturbance located at <inline-formula><mml:math id="inf74"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). Negative <inline-formula><mml:math id="inf75"><mml:mi>i</mml:mi></mml:math></inline-formula> therefore refer to the preparatory steps beforehand, and positive to recovery steps thereafter. Each step has a pendulum-like single stance phase with passive dynamics, and a costly step-to-step transition. Mechanical work is only performed during that transition, starting with COM velocity <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> directed forward and downward at the end of each stance phase. For brevity, the equations presented here use dimensionless versions of quantities, with <inline-formula><mml:math id="inf77"><mml:mi>M</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="inf78"><mml:mi>g</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf79"><mml:mi>L</mml:mi></mml:math></inline-formula> as base units. The step-to-step transition starts with pre-emptive push-off work <inline-formula><mml:math id="inf80"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (in units of mass-normalized work) performed impulsively along the trailing leg to redirect the COM velocity. This is followed immediately by the heel-strike collision along the leading leg, to yield postcollision velocity <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> . Again applying impulse momentum (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>),<disp-formula id="equ3">. <label>(1)</label><mml:math id="m3"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mn>2</mml:mn><mml:mi>α</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf82"><mml:mn>2</mml:mn><mml:mi>α</mml:mi></mml:math></inline-formula> is a fixed interleg angle (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>Another single stance phase follows the step-to-step transition, and is modeled as an underactuated, simple inverted pendulum. As a discrete indicator of overall forward momentum, we use the midstance velocity <inline-formula><mml:math id="inf83"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (no superscript; see <xref ref-type="fig" rid="fig1">Figure 1</xref>) following step-to-step transition <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, sampled when the leg is vertical, and the COM velocity is purely forward.</p><p>We treat steady, level walking as the nominal condition (<xref ref-type="fig" rid="fig1">Figure 1c</xref>). The nominal push-off work <inline-formula><mml:math id="inf85"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> offsets the collision work (<xref ref-type="bibr" rid="bib28">Kuo, 2002</xref>), so that<disp-formula id="equ4"><label>(2)</label><mml:math id="m4"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:msup><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></disp-formula></p><p>and <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> . The uneven step disturbs steady walking (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). Its height <inline-formula><mml:math id="inf87"><mml:mi>b</mml:mi></mml:math></inline-formula> (positive for Up-steps, negative for Down-steps) causes the preceding stance phase to end with a different stance leg angle from nominal. For a given height <inline-formula><mml:math id="inf88"><mml:mi>b</mml:mi></mml:math></inline-formula> and step length <inline-formula><mml:math id="inf89"><mml:mi>S</mml:mi></mml:math></inline-formula>, we define the angular disturbance as <inline-formula><mml:math id="inf90"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>,<disp-formula id="equ5"><label>(3)</label><mml:math id="m5"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:msup><mml:mi mathvariant="normal">n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfrac><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where the angle is zero for all nondisturbance steps.</p><p>An inverted pendulum stance phase follows each step-to-step transition. A step time <inline-formula><mml:math id="inf91"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defined as the time for the stance leg angle <inline-formula><mml:math id="inf92"><mml:mi>θ</mml:mi></mml:math></inline-formula> to move between successive step-to-step transitions, from <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> and passing through midstance speed <inline-formula><mml:math id="inf95"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> .</p><p>Using the linearized dynamics, the dimensionless step time <inline-formula><mml:math id="inf96"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of step <inline-formula><mml:math id="inf97"><mml:mi>i</mml:mi></mml:math></inline-formula> is<disp-formula id="equ6"><label>(4)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Solving the equation of motion with the step time, the velocity at end of stance <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, or equivalently the beginning of the next step-to-step transition can be found as:<disp-formula id="equ7"><label>(5)</label><mml:math id="m7"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Midstance time <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> for step <inline-formula><mml:math id="inf100"><mml:mi>i</mml:mi></mml:math></inline-formula> can also be found using the linearized dynamics:<disp-formula id="equ8"><label>(6)</label><mml:math id="m8"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>α</mml:mi><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Solving for mid-stance speed <inline-formula><mml:math id="inf101"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>,<disp-formula id="equ9"><label>(7)</label><mml:math id="m9"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>We chose nominal parameters to correspond to typical human walking, with two ways to specify step length. The nominal gait was for a person with leg length <inline-formula><mml:math id="inf102"><mml:mi>L</mml:mi></mml:math></inline-formula> of 1 m walking at 1.5 m/s, with step length of 0.79 m and step time of 0.53 s (from anecdotal observations). This step length was kept fixed in the optimization, and parameter sensitivities were computed for a longer fixed value (0.95 m in <xref ref-type="fig" rid="fig3">Figure 3d</xref>), detailed more extensively previously (<xref ref-type="bibr" rid="bib10">Darici et al., 2020</xref>). The other specification was to increase step length according to the preferred human relationship, increasing approximately with <inline-formula><mml:math id="inf103"><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>0.42</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib19">Grieve, 1968</xref>) and thereby changing the work cost slightly. Optimization yielded similar shaped speed fluctuation patterns with little sensitivity to fixed or variable step length (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). In model, the sole optimization cost was push-off work, neglecting costs for moving the legs back and forth (<xref ref-type="bibr" rid="bib27">Kuo, 2001</xref>), expected to be fairly constant for the small speed fluctuations predicted by model.</p><p>Using dynamic similarity, parameters and results may be expressed in terms of body mass <inline-formula><mml:math id="inf104"><mml:mi>M</mml:mi></mml:math></inline-formula>, gravitational acceleration <inline-formula><mml:math id="inf105"><mml:mi>g</mml:mi></mml:math></inline-formula>, and <inline-formula><mml:math id="inf106"><mml:mi>L</mml:mi></mml:math></inline-formula> as base units. The corresponding model parameters treated as dimensional are angle <inline-formula><mml:math id="inf107"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.41</mml:mn></mml:math></inline-formula>, push-off <inline-formula><mml:math id="inf108"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mn>0.0342</mml:mn><mml:mi>M</mml:mi><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:math></inline-formula>, step time <inline-formula><mml:math id="inf109"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1.66</mml:mn><mml:msup><mml:mrow><mml:mn>5</mml:mn><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, and precollision speed <inline-formula><mml:math id="inf110"><mml:msup><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow/></mml:msup><mml:mo>=</mml:mo><mml:mn>0.601</mml:mn><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, where capital letters indicate nominal values for <inline-formula><mml:math id="inf111"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="inf112"><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively. We also refer to a nominal speed <inline-formula><mml:math id="inf114"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>0.44</mml:mn><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> for midstance speed <inline-formula><mml:math id="inf115"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> . We considered a range of Up-step heights, for example <inline-formula><mml:math id="inf116"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>0.075</mml:mn><mml:mi>L</mml:mi></mml:math></inline-formula>, equivalent to about 7.5 cm for a human.</p></sec><sec id="s9" sec-type="appendix"><title>Optimization problem</title><p>The optimization is formulated as follows, with policy <inline-formula><mml:math id="inf117"><mml:mi>π</mml:mi></mml:math></inline-formula> denoting the set of push-offs <inline-formula><mml:math id="inf118"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:<disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:msup><mml:mi>π</mml:mi><mml:mrow/></mml:msup><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:munder><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>π</mml:mi></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>subject to:</p><list list-type="simple"><list-item><p>Speed:<inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p>Time:<inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>⋅</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p>Dynamics: Model dynamics (above)</p></list-item></list><p>where <inline-formula><mml:math id="inf121"><mml:mi>N</mml:mi></mml:math></inline-formula> is the total (odd) number of steps and step <inline-formula><mml:math id="inf122"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> is the first step on the Up-/Down-step. Thus, <inline-formula><mml:math id="inf123"><mml:mi>N</mml:mi></mml:math></inline-formula> adjusts how far in advance and or after the perturbation for which the model can modulate its momentum or speed. The speed constraints are such that the initial and final conditions are equal to the nominal, steady speed <inline-formula><mml:math id="inf124"><mml:mi>V</mml:mi></mml:math></inline-formula>. The time constraint makes up for lost time, so that the total time is equal to the nominal time to walk <inline-formula><mml:math id="inf125"><mml:mi>N</mml:mi></mml:math></inline-formula> steps on level ground. By the end of the control sequence, the model must walk at the same speed as nominal and must have caught up with the nominal model on level ground. We chose <inline-formula><mml:math id="inf126"><mml:mi>N</mml:mi></mml:math></inline-formula> large enough to cover the speed adjustments that humans made in the experiments. Note that, because human speeds are most conveniently measured from footfall to footfall, we converted the model speeds to a similar footfall definition (stride length divided by stride time, footfall to footfall) for purposes of comparison between model and human (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The optimization problem was formulated and solved using a constrained optimization solver (Matlab ‘fmincon’, MathWorks, Inc, Natick, MA, USA).</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec id="s10" sec-type="appendix"><title>Step duration and step length fluctuations</title><p>Reported here are human subject compensation patterns for Up- and Down-step perturbations (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>), in terms of step durations and step lengths. This study was primarily concerned with the fluctuations in forward speed or momentum that humans perform to compensate for a step height perturbation. Humans can modulate their speed with transient changes to both step length and step time, a feature not included in the present model. The human data are included here to facilitate future models that could provide greater detail on these responses.</p><p>We did not perform hypothesis tests on these data, but a few descriptive measures are provided. For Up-steps (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> left/top row), step lengths were about +3.1%, +18.5%, and −7% for the three steps surrounding the perturbation (<inline-formula><mml:math id="inf127"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, 0, + 1), respectively, compared to average step length. For Down-steps, the corresponding step length differences were 0.24%, 2.29%, and −2.58% (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>, bottom row). As for step times (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>, bottom), the Up-step differences were −5.8%, +15%, and −2.7%, and Down-steps differences were +2.5%, +2.5%, and −3.5%, compared to average step period. Qualitatively, humans appeared to distribute compensations differently between Up- and Down-steps. Whereas speed fluctuations were approximately opposite in amplitude (<xref ref-type="fig" rid="fig4">Figure 4</xref>) for Up- vs. Down-steps, the same does not appear true for step durations (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>, left column) and step lengths (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>, right column). We speculate that the human knee affords different strategies for regulating forward momentum when stepping upward vs. downward.</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Human (left column) empirical step duration and (right column) step length fluctuations vs. time, for (<bold>a</bold>) Up-step and (<bold>b</bold>) Down-step.</title><p>Shown are step durations and step lengths for each step (line denotes mean across subjects, shaded area denotes ±1 SD; <italic>N</italic> = 12) vs. time, with vertical line denoting the step onto the perturbation. The human speed fluctuations (<xref ref-type="fig" rid="fig4">Figure 4</xref>) appeared to be achieved by transiently changing a combination of step durations and step lengths. Each discrete speed is defined as each step’s corresponding step length divided by duration.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65402-app2-fig1-v2.tif"/></fig><p>These observations suggest possibilities for incorporation into a model. To predict transiently changing step durations and lengths, the model would need an associated energetic cost. The only cost included here is for step-to-step transitions, which appear to account for the majority of human energy expenditure during walking (<xref ref-type="bibr" rid="bib29">Kuo et al., 2005</xref>). We have proposed that humans pay an additional cost for moving the legs back and forth, which could explain the energetically optimal step length for steady walking (<xref ref-type="bibr" rid="bib27">Kuo, 2001</xref>), and could account for about one-third of its overall cost (<xref ref-type="bibr" rid="bib12">Doke et al., 2005</xref>). Transient step adjustments would be expected to alter or add to the steady cost, in amount not yet modeled, because the mechanistic determinants remain unknown. Nevertheless, the existence of such a cost does not exclude step-to-step transition costs as an important determinant of the speed fluctuations observed here.</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65402.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ting</surname><given-names>Lena H</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" link-type="continued-by" object-id="10.1101/2020.12.01.407023" object-id-type="id" xlink:href="https://sciety.org/articles/activity/10.1101/2020.12.01.407023"/></front-stub><body><p>The study combines theoretical and experimental approaches to probe the laws governing strategy for coping with the control of stepping on uneven terrain. Congruent results in anticipatory and reactive adjustments indicate that a simple strategy based on the conservation of energy may be expressed within neural control pathways for locomotion.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65402.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Ting</surname><given-names>Lena H</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Srinivasan</surname><given-names>Manoj</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00rs6vg23</institution-id><institution>The Ohio State University</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2020.12.01.407023">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.12.01.407023v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Humans optimally anticipate and compensate for an uneven step during walking&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individual involved in review of your submission has agreed to reveal their identity: Manoj Srinivasan (Reviewer #3).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Stride length: The authors need to address whether the model limitations of using a fixed stride length affect the generalization of the results to variable stride lengths. The generalization of the claims, even in a qualitative way, need to be demonstrated, particularly as the authors have previously published simulation predictions with variable stride length. The reviewers agree that even a qualitative match between simulations and experiments would be sufficient given the inherent limitations of a simple model.</p><p>2) Timing: Several questions regarding the claims with respect to timing require clarification and potentially further simulations. The time constraint imposed on the simulation is a particular concern; the total time should be released or at a minimum, the cost of different total times should be compared. Without doing so, the claim that there is no time lost due to the perturbation are not supported. Another issue with the claims around timing are the potential bias based on instruction to the participants. These multiple issues need to be addressed to substantiate the claims around timing.</p><p>3) Given that the simulations appear to have been published previously, the contributions of this manuscript above and beyond those of previous ones by the authors need to be more fully described. What is the major advance that this paper provides?</p><p>4) Aspects of the study methodology require clarification. These include the tested hypotheses, subject instructions and the scientific rationale for the study design and outcomes. Considerations for alternative study design and study limitations should be addressed in the discussion.</p><p>5) A more complete discussion of the modeling assumptions and limitations needs to be included. These should include both the limitation of a simple model, the effects of including a swing limb, and alternative optimality criteria that may provide either similar or disparate results.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>1) The suggestion that the automatic optimization strategy is engaged here does not indicate whether this solution is dictated by subject instructions. In other words, could the solution here be simply the fact that subjects would be instructed not to stop when transversing the obstacles? The implied automatic action for this adaptation is not fully supported by experiments.</p><p>2) The description of background information could benefit from a more thorough review of the related studies and clarifications.</p><p>3) The study refers to the feedforward limb speed control in the study design and outcomes; yet, no background for the CNS using this parameter as a variable is provided. If this is an assumption then it should be identified as such.</p><p>4) One of the main findings is the self-similarity of the anticipatory response at multiple average speeds and step lengths. This brings a few concerns related to the normalization (see specific question 6) and the overall significance of this outcome. The discussion should identify the impact of this finding on the conclusions.</p><p>5) The overall study design appears to be unclear. The interplay between the tested hypotheses and the background or theoretical facts is not fully clear. The understanding of study validity could be improved by the additional description of study design and the consideration of alternatives and study limitations. For example, stepping over obstacles could be executed with multiple strategies and probably in a context-dependent way. These alternatives and the experimental observations should be discussed in the context of the findings in this study.</p><p>6) P2, ln8 &quot;This raises the question.…&quot; The general point expressed here may benefit from the focus on the specific question. As is, the outcome may be task-dependent, e.g., the interception of prey would require a different strategy from that used to catch a ball.</p><p>7) P2, ln22 &quot;The negotiation of uneven terrain.…&quot; The background literature highlighting these points could be added. The predictive planning in the same context was previously demonstrated in studies by Patla in humans and in animals by Drew.</p><p>8) p2, ln43 &quot;… humans compensate for ground perturbations is unknown…&quot; This may be an overgeneralization. There are multiple types of ground perturbations. Some mechanisms are known and documented, e.g., the mechanisms of the stretch reflex and finite step phase transition rules in humans and animals (including insects), e.g., Prochazka's models.</p><p>9) p3, ln23 &quot;… swing phase dynamics are ignored, and the legs are constrained to fixed step lengths.…&quot; This oversimplification does not agree with the observed experimental results. The dependency of limb speed on the control of the swing phase has a direct bearing on the assumption of limb speed control. The implications of this limitation should be clarified. Ultimately, the addition of swing dynamics with the appropriate stride length dependency could substantially support the claims in this study.</p><p>10) p4, ln10 &quot;… discretely sampled a the mid-stance instance.…&quot; The measurement of step speed should be clarified. Have you estimated the speed of the center of mass or some other related kinematic landmark?</p><p>11) Figure 2 The analysis is done in time even though the speed of each subject was self-paced. The previous studies indicate that humans may use discrete in time step-based control, which would imply that the analysis in Figure 2 should be similarly normalized to each step.</p><p>12) p6, ln25 &quot;… systematic behavior.…&quot; This statement may be unclear. What is the nature of these systematic variations amongst volunteers?</p><p>13) p6, ln28 &quot; Humans compensated for.…&quot; This statement makes a specific claim based on the presented testing; however, the hypothesis for the tests has not been expressed. Please, consider clarifying the nature of the study design here. Was this work driven by the rationale or the specific a priori hypotheses?</p><p>14) p6, ln33 &quot;… would lose 1 s.…&quot; This statement likely implies a full stop for a second prior to the step over the obstacle. Please confirm or clarify the origin of this conclusion. Also, it is unclear if this simulated behavior depended on the initial conditions. For example, the step adjustments may only be necessary if the timing with the obstacle interaction is not good enough for the smooth step over it.</p><p>15) p7, ln9 &quot;The Up-step and.…&quot; Please, clarify what variables are correlated here. It is unclear how the &quot;conditions&quot; could be correlated.</p><p>16) Methodological unclarity. What was the placement of IMU units? Was there any signal processing of IMU signals? The instrumentation of subjects should be described in methods.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The conclusions of the paper could be strengthened by:</p><p>1) demonstrating that the predictions also hold for a model with variable step length. It is not clear why step length was fixed as a fixed step length does not seem a valid assumption here and previous models of the authors had variable step length. Does a model with variable step length predict variations in step length in agreement with experimental observations?</p><p>2) demonstrating that optimal control also predicts no time lost due to stepping up as compared to walking on even terrain. If I got it right, the total time is imposed when solving the optimal control problem. The authors stress that time is lost in uncompensated up-steps when describing their model predictions, which they contrast with the optimal policy. However, the loss of time was not predicted but imposed (page 14 – line 27).</p><p>3) demonstrating that the number of compensation steps N that minimizes work corresponds to the observed number of compensation steps. Now, N is informed by observations (page 14 – line 29). N is not specified, I infer from the figures that it was nine but according to the author's previous modeling paper, there is little additional reduction in work when increasing the number of compensation steps above three. Therefore, minimal work does not explain why people take more than three compensation steps.</p><p>4) demonstrating that minimal work leads to better agreement between simulations and observations than other plausible optimality criteria. I understand that some plausible criteria, e.g., stability against noise, are not easy to test but they could be discussed.</p><p>5) demonstrating that the predicted dependence of speed fluctuations on step height is in agreement with experimental observations. (I realize that this might require additional experiments and might therefore not be feasible within a reasonable time but I feel it is a missed opportunity that this was not part of the original experimental protocol.)</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The manuscript is well written. I found it easy to read.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for resubmitting your work entitled &quot;Humans optimally anticipate and compensate for an uneven step during walking&quot; for further consideration by <italic>eLife</italic>. Your revised article has been reviewed by 3 peer reviewers and the evaluation has been overseen by a Reviewing Editor and by Aleksandra Walczak as the Senior Editor.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The thorough revision is appropriate for publication.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors have addressed some but not all the questions/concerns raised in the previous review.</p><p>Previous essential revision 1. Instead of demonstrating that minimization of mechanical work captured observed stride length variability, the authors moved the results on stride length variability to the appendix. I am under the impression that the authors have previously published simulations in which stride times were not imposed (was not contradicted in response) and it is unclear why simulations with variable (i.e. not pre-imposed) stride times could not be performed. The added value of performing simulations with different imposed stride lengths is limited as compared to the added value of performing simulations in which stride length is a free variable (and thus follows from optimization). Simulations with variable stride lengths could have given information on whether the key assumption (minimization of mechanical work) predicts other features than speed fluctuations alone.</p><p>Previous essential revision 5. The authors have introduced alternative hypotheses but this feels 'after the facts'. It was already clear that these hypotheses would not hold (with prior knowledge of the experimental data) and they have therefore limited value. We specifically asked about alternative optimality criteria and such criteria will only strengthen the reported findings when they truly challenge them.</p><p>With respect to stability as an alternative optimization criterion, I find the addition to the discussion not convincing. The model being able to traverse the perturbation without falling tells little about stability against noise, which can be expected in real life (but was not modeled). I am also unsure about what the authors mean by 'the model could easily traverse the perturbation'. How was 'easily' defined?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>The authors have addressed all my specific comments satisfactorily.</p><p>I am also reasonably satisfied with how the authors have addressed the issue of constant vs varying step length that other reviewers raised and the consensus review included. However, the authors may want to clearly note that allowing the step length to vary with speed via a static preferred speed-step-length relationship is not the same (ie not mathematically equivalent) as allowing the step length to vary as an independent optimization variable because, well, one problem has more optimization degrees of freedom than the other. But this additional calculation is certainly suggestive (and I believe its suggestion) that allowing step lengths to vary will not change the speed fluctuation results substantially.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65402.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Stride length: The authors need to address whether the model limitations of using a fixed stride length affect the generalization of the results to variable stride lengths. The generalization of the claims, even in a qualitative way, need to be demonstrated, particularly as the authors have previously published simulation predictions with variable stride length. The reviewers agree that even a qualitative match between simulations and experiments would be sufficient given the inherent limitations of a simple model.</p></disp-quote><p>We have added more justification that fixed stride lengths are not critical to model predictions. We added predictions using the human preferred stride length vs. speed relationship, and show that the optimal speed fluctuations are quite similar whether using fixed or preferred stride lengths (Figure 5d; Methods text; more detail in Appendix). This is in addition to the existing predictions for different fixed stride lengths and different average speeds.</p><disp-quote content-type="editor-comment"><p>2) Timing: Several questions regarding the claims with respect to timing require clarification and potentially further simulations. The time constraint imposed on the simulation is a particular concern; the total time should be released or at a minimum, the cost of different total times should be compared. Without doing so, the claim that there is no time lost due to the perturbation are not supported. Another issue with the claims around timing are the potential bias based on instruction to the participants. These multiple issues need to be addressed to substantiate the claims around timing.</p></disp-quote><p>We have made several changes to address the question of timing. As suggested, we have added a simulation with the total time is released (Figure 1b), showing how time is lost to the Up-step (also shown previously, Darici et al., 2020). We have also clarified that the (unreleased) model is constrained to conserve time, and that the prediction is that time can be conserved if desired, not that it must necessarily be so. Regarding the experiment, we have clarified how participants were instructed to loosely maintain similar time (Methods), with the resulting conclusion that they were able to approximately conserve, not that they always do. In fact, the instruction was given because humans who walk entirely without context might spontaneously decide to slow down, speed up, pause, or stop at any time. We were not clear that conserved time was not a hypothesis, and now express it more explicitly as an observation. The corresponding Result subheading is “Humans walking durations were approximately conserved despite Up- and Down-step disturbances.” Finally, we have included model predicted costs for the alternative strategies vs. optimal (Model predictions).</p><disp-quote content-type="editor-comment"><p>3) Given that the simulations appear to have been published previously, the contributions of this manuscript above and beyond those of previous ones by the authors need to be more fully described. What is the major advance that this paper provides?</p></disp-quote><p>We have taken a number of measures throughout the manuscript to emphasize how the present study is a human subjects experiment, and the previous was a model simulation paper. For example, an added figure (new Figure 6) shows more information about the experimental measurements. We have re-emphasized the experiment in a number of places in the text, for example:</p><p>Abstract: “Here we show that humans compensate…” and “In experiment, humans…”</p><p>Introduction: “The purpose of the present study was to test whether humans negotiate a step height disturbance with an anticipatory compensation strategy as predicted by dynamic optimization.”</p><p>Methods: “This study consisted of an experiment…”</p><p>Results: “1. Humans produced…”, “2. Human compensations…”, “3. Humans…were self-similar”, “4. Human walking durations…” [emphasis on Humans, as opposed to previous Model paper]</p><p>Discussion: “We examined how humans anticipate…”</p><disp-quote content-type="editor-comment"><p>4) Aspects of the study methodology require clarification. These include the tested hypotheses, subject instructions and the scientific rationale for the study design and outcomes. Considerations for alternative study design and study limitations should be addressed in the discussion.</p></disp-quote><p>A number of changes have been made regarding methodology. These are detailed in the responses below, but here is a brief summary of some of the changes:</p><p>Introduction: Expanded rationale, e.g. “The results may reveal whether humans reason about their walking dynamics to perform predictive planning on uneven terrain.”</p><p>Methods, Model: “The model yielded two main predictions to be tested experimentally.” [three paragraphs including alternative hypotheses]</p><p>Figure 1 and text: Added alternative hypotheses for no compensation, non-anticipatory compensation, and tight regulation to avoid speed fluctuations.</p><p>Human subjects experiment: “Model predictions were tested with speed trajectories.” [three paragraphs describing tests]. Also expanded description of subject instructions.</p><p>Discussion: Rejection of alternative hypothesis, e.g. “This anticipation was not consistent with the alternative hypothetical strategies…”</p><disp-quote content-type="editor-comment"><p>5) A more complete discussion of the modeling assumptions and limitations needs to be included. These should include both the limitation of a simple model, the effects of including a swing limb, and alternative optimality criteria that may provide either similar or disparate results.</p></disp-quote><p>We have added alternative hypotheses (Figure 1b, c, d) in comparison with results. We have also expanded the discussion of model limitations, including about the swing limb and particularly its knee. These points are detailed in the responses below.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>1) The suggestion that the automatic optimization strategy is engaged here does not indicate whether this solution is dictated by subject instructions. In other words, could the solution here be simply the fact that subjects would be instructed not to stop when transversing the obstacles? The implied automatic action for this adaptation is not fully supported by experiments.</p></disp-quote><p>We have clarified that the evidence for optimality is the observed tri-phasic pattern, and not the conservation of walking duration. As reviewer, suggests, duration was a matter of subject instructions, and we merely verified that they followed instructions. We have reorganized the results to clarify the emphasis on the pattern as hypothesis test (Results first three sub-headings), and we have de-emphasized walking duration (Results, last sub-heading “Human walking durations were approximately conserved.”).</p><disp-quote content-type="editor-comment"><p>2) The description of background information could benefit from a more thorough review of the related studies and clarifications.</p></disp-quote><p>We have added more context to the background information (specific points 2, 3), to clarify what aspects of uneven terrain are already understood, and how the present study addresses the prediction of compensation strategies with dynamic optimization.</p><disp-quote content-type="editor-comment"><p>3) The study refers to the feedforward limb speed control in the study design and outcomes; yet, no background for the CNS using this parameter as a variable is provided. If this is an assumption then it should be identified as such.</p></disp-quote><p>We have clarified that speed was intended to refer to the body’s forward speed. We had been unclear that we used inertial measurements to measure speed of foot to infer the average speed of the body with each step. We have revised the Methods to clarify that the hypothesis and experimental measurements are concerned with fluctuations in walking speed for the whole body. A new Figure 6 shows how the body’s forward speed is estimated from foot speeds.</p><disp-quote content-type="editor-comment"><p>4) One of the main findings is the self-similarity of the anticipatory response at multiple average speeds and step lengths. This brings a few concerns related to the normalization (see specific question 6) and the overall significance of this outcome. The discussion should identify the impact of this finding on the conclusions.</p></disp-quote><p>We have expanded on the discussion of self-similar scaling. Early in Discussion:</p><p>“A pendulum’s motion, and the action of the step-to-step transition, are consistent and scalable in speed and step length, and in amplitude and time (Kuo, 2002). The scalability could potentially make it unnecessary for the central nervous system (CNS) to synthesize or re-optimize a new compensation for each new perturbation encountered.”</p><p>Later in Discussion of control:</p><p>“the control policy could conceivably be stored in quite a compact form, because a single compensation pattern (e.g., <inline-formula><mml:math id="sa2m1"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mtext>up</mml:mtext></mml:mrow></mml:msup></mml:math></inline-formula>) might simply be scaled for different walking speeds, step heights, or step lengths (Figure 4). It is also conceivable that such a pattern could be repeatedly applied or superimposed to predict long sequences of uneven terrain, which are also energetically costly (Voloshina et al., 2013; Kowalsky et al., 2021).”</p><disp-quote content-type="editor-comment"><p>5) The overall study design appears to be unclear. The interplay between the tested hypotheses and the background or theoretical facts is not fully clear. The understanding of study validity could be improved by the additional description of study design and the consideration of alternatives and study limitations. For example, stepping over obstacles could be executed with multiple strategies and probably in a context-dependent way. These alternatives and the experimental observations should be discussed in the context of the findings in this study.</p></disp-quote><p>We have re-organized the Methods to improve the link between model and experiment. We have expanded on alternative hypotheses, as summarized in the above replies, and in responses below. More extensive details are included in the responses below.</p><disp-quote content-type="editor-comment"><p>6) P2, ln8 “This raises the question.…” The general point expressed here may benefit from the focus on the specific question. As is, the outcome may be task-dependent, e.g., the interception of prey would require a different strategy from that used to catch a ball.</p></disp-quote><p>We have reworded the sentence to focus on the differences with the curb:</p><p>“A sidewalk curb may similarly be anticipated ahead of time, albeit with most of the dynamics within the person rather than the curb, and with a less clearly defined objective.”</p><disp-quote content-type="editor-comment"><p>7) P2, ln22 &quot;The negotiation of uneven terrain.…&quot; The background literature highlighting these points could be added. The predictive planning in the same context was previously demonstrated in studies by Patla in humans and in animals by Drew.</p></disp-quote><p>We added reference to Drew, and moved the reference to Patla early within the paragraph. We have also expanded the background on planning based on other references:</p><p>“In particular, foot placement and motion are planned, with the help of vision, to avoid or step over upcoming obstacles (Patla, 1998; Patla and Rietdyk, 1993), and to land on foot targets (Drew et al., 2008; Matthis and Fajen, 2013). Although much of this planning has been described in terms of kinematics, it may also include intersegmental dynamics, which may be regulated to clear obstacles with reduced mechanical work (Patla and Prentice, 1995).”</p><disp-quote content-type="editor-comment"><p>8) p2, ln43 &quot;… humans compensate for ground perturbations is unknown…&quot; This may be an overgeneralization. There are multiple types of ground perturbations. Some mechanisms are known and documented, e.g., the mechanisms of the stretch reflex and finite step phase transition rules in humans and animals (including insects), e.g., Prochazka's models.</p></disp-quote><p>We have reworded to be more specific about our hypothesis about anticipatory strategies:</p><p>“This raises the question of whether humans anticipate the curb, and what objective criteria govern its interception.” We did not intend to implicate stretch reflexes and other effects.</p><disp-quote content-type="editor-comment"><p>9) p3, ln23 &quot;… swing phase dynamics are ignored, and the legs are constrained to fixed step lengths.…&quot; This oversimplification does not agree with the observed experimental results. The dependency of limb speed on the control of the swing phase has a direct bearing on the assumption of limb speed control. The implications of this limitation should be clarified. Ultimately, the addition of swing dynamics with the appropriate stride length dependency could substantially support the claims in this study.</p></disp-quote><p>We had intended to focus on speed of the body, and not on swing phase. We have made several changes to de-emphasize swing phase. We have also added model results regarding stride length dependency:</p><p>“As a simplification, the model’s legs nominally take steps either of fixed length similar to the “rimless wheel” model (McGeer, 1990), or variable length increasing with speed according to the human preferred step length relationship (see Appendix 1)”.</p><p>In experimental methods we have clarified how we measured body speed, and added a figure to illustrate (Figure 6). We also moved the stride length and timing results to Appendix, since these were only measurements without any hypothesis tests. This may help focus on the main hypothesis, where body speed was compared between model and human (Figure 6).</p><disp-quote content-type="editor-comment"><p>10) p4, ln10 “… discretely sampled a the mid-stance instance.…” The measurement of step speed should be clarified. Have you estimated the speed of the center of mass or some other related kinematic landmark?</p></disp-quote><p>We added clarification that the model’s speed is for center of mass:</p><p>“forward speed <inline-formula><mml:math id="sa2m2"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the COM each step <inline-formula><mml:math id="sa2m3"><mml:mi>i</mml:mi></mml:math></inline-formula>(Figure 2a; defined as the COM velocity at mid-stance when stance leg is vertical).”</p><p>In the later Experiment sub-section, we define human body speed as the average body speed for each step, to compare against model.</p><disp-quote content-type="editor-comment"><p>11) Figure 2 The analysis is done in time even though the speed of each subject was self-paced. The previous studies indicate that humans may use discrete in time step-based control, which would imply that the analysis in Figure 2 should be similarly normalized to each step.</p></disp-quote><p>The reviewer is correct that the dynamics are continuous in time, and that the model and human should be compared in terms of discrete steps. This is indeed the case, and we have made several changes to clarify.</p><p>In Model, “Each push-off caused a change in the forward speed <inline-formula><mml:math id="sa2m4"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the COM each step <inline-formula><mml:math id="sa2m5"><mml:mi>i</mml:mi></mml:math></inline-formula> (Figure 2a), discretely sampled at the mid-stance instance when the stance leg passed through vertical, prior to the step-to-step transition.”</p><p>And in Figure 2, “The model’s compensatory response is therefore summarized as a time-varying trajectory of speeds <inline-formula><mml:math id="sa2m6"><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, discretely sampled once per step <inline-formula><mml:math id="sa2m7"><mml:mi>i</mml:mi></mml:math></inline-formula>.”</p><p>In Figure 3, “Averages were computed for speed fluctuations treated as sequences of discrete steps, and plotted in both discrete (dot symbols) and continuous time.”</p><disp-quote content-type="editor-comment"><p>12) p6, ln25 “… systematic behavior.…” This statement may be unclear. What is the nature of these systematic variations amongst volunteers?</p></disp-quote><p>This was a small degree of unexplained correlation in the control trials, and so we have clarified:</p><p>“This suggests a degree of unexpected, non-random behavior shared between subjects, of relatively small amplitude of about 0.014 m/s, and at around 17% of the non-Control amplitudes.”</p><disp-quote content-type="editor-comment"><p>13) p6, ln28 &quot; Humans compensated for.…&quot; This statement makes a specific claim based on the presented testing; however, the hypothesis for the tests has not been expressed. Please, consider clarifying the nature of the study design here. Was this work driven by the rationale or the specific a priori hypotheses?</p></disp-quote><p>We agree this was unclear, and in fact the conservation of walking duration was simply an observation, not a hypothesis. To emphasize the hypothesis tests, we have re-ordered the results so that the hypothesis tests appear first, each with a specific claim, and the observation about walking duration (now Result 4) with the observation “4. Humans walking durations were approximately conserved”.</p><p>We also re-worded to state “Subjects were approximately compliant with the instruction… There were no significant differences in overall speed…”</p><p>Here are the three claims that did include hypothesis tests (in Results):</p><p>1. Humans produced triphasic Up- and Down-step compensatory speed fluctuations. [tested by correlation between average human response and individual subject fluctuations]</p><p>2. Human compensations were consistent with minimum-work predictions. [tested by correlation between model and individual subject fluctuations]</p><p>3. Human compensation patterns were self-similar and scalable for step height and overall walking speed. (tested by correlation and linear regression with step height and speed as predictors)</p><disp-quote content-type="editor-comment"><p>14) p6, ln33 &quot;… would lose 1 s.…&quot; This statement likely implies a full stop for a second prior to the step over the obstacle. Please confirm or clarify the origin of this conclusion. Also, it is unclear if this simulated behavior depended on the initial conditions. For example, the step adjustments may only be necessary if the timing with the obstacle interaction is not good enough for the smooth step over it.</p></disp-quote><p>We have provided more information about the loss:</p><p>“The model, if performing constant push-offs instead of compensating, would slow down atop the Up-step (Figure 1b, speed), mainly due to the exchange of kinetic energy for potential energy. It would gradually accumulate a loss of about 0.7 s in time (Figure 1b, time) compared to level walking.”</p><p>We also added a sub-figure (Figure 1b) to illustrate the outcome.</p><disp-quote content-type="editor-comment"><p>15) p7, ln9 &quot;The Up-step and.…&quot; Please, clarify what variables are correlated here. It is unclear how the &quot;conditions&quot; could be correlated.</p></disp-quote><p>We have clarified that we were referring to the speed fluctuations:</p><p>“The Up-step speed fluctuations were similar across subjects (compare Figure 3 middle and right columns)”.</p><disp-quote content-type="editor-comment"><p>16) Methodological unclarity. What was the placement of IMU units? Was there any signal processing of IMU signals? The instrumentation of subjects should be described in methods.</p></disp-quote><p>We have added more detail on placement and processing in the text. Regarding placement:</p><p>“The trajectories were computed from an IMU mounted atop each foot (Figure 6a).”</p><p>Regarding signal processing:</p><p>“with gravity-compensated accelerations integrated to yield a spatiotemporal trajectory, subject to an assumption that each foot comes briefly to rest during each footfall.”</p><p>The new figure (Figure 6) was added to illustrate this.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The conclusions of the paper could be strengthened by:</p><p>1) demonstrating that the predictions also hold for a model with variable step length. It is not clear why step length was fixed as a fixed step length does not seem a valid assumption here and previous models of the authors had variable step length. Does a model with variable step length predict variations in step length in agreement with experimental observations?</p></disp-quote><p>We have included more explanation, including optimal control predictions with the model constrained to follow the preferred human step length vs. speed relationship (Figure 5d). In text:</p><p>“A basic pattern for optimal speed fluctuations retains approximately the same shape across different overall walking speeds, fixed step lengths, or even step length changing to the human preferred step length relationship.”</p><p>Later in the same paragraph:</p><p>“…we expect a single basic pattern, treated as a sequence of discrete speed fluctuations (Figure 5a) to predict optimal responses regardless of an individual’s average speed, step length, or the preferred speed and step length relationship.”</p><p>In Discussion, we also note:</p><p>“We also expect that transiently varying step lengths and foot placements could be added to the model (Bhounsule, 2014; Kuo, 2001; Ojeda et al., 2015b), and potentially provide more detail about how active speed fluctuations are achieved (e.g. Appendix 2-figure 1).”</p><disp-quote content-type="editor-comment"><p>2) demonstrating that optimal control also predicts no time lost due to stepping up as compared to walking on even terrain. If I got it right, the total time is imposed when solving the optimal control problem. The authors stress that time is lost in uncompensated up-steps when describing their model predictions, which they contrast with the optimal policy. However, the loss of time was not predicted but imposed (page 14 – line 27).</p></disp-quote><p>The reviewer is correct, “no time lost” is not a prediction but an imposed constraint. As clarification, we have added to Methods:</p><p>“It (the model) was also constrained to match the total time for nominal level, steady walking, thus making up for time lost to the Up-step.”</p><p>In Experiment: “We provided context by instructing subjects to walk “in about the same time” throughout the experiment.”</p><p>In Results, we have de-emphasized the time conservation, by placing it after the hypothesis tests (regarding speed fluctuations), and by stating more clearly that:</p><p>“Subjects were approximately compliant with the instruction to maintain a similar overall speed and walking duration across trials, whether or not there was an uneven step.”</p><disp-quote content-type="editor-comment"><p>3) demonstrating that the number of compensation steps N that minimizes work corresponds to the observed number of compensation steps. Now, N is informed by observations (page 14 – line 29). N is not specified, I infer from the figures that it was nine but according to the author’s previous modeling paper, there is little additional reduction in work when increasing the number of compensation steps above three. Therefore, minimal work does not explain why people take more than three compensation steps.</p></disp-quote><p>We have clarified that the value of <inline-formula><mml:math id="sa2m8"><mml:mi>N</mml:mi></mml:math></inline-formula> is not a hypothesis:</p><p>“We expected that the [model] compensation would occur within several steps before and after the perturbation, and selected <inline-formula><mml:math id="sa2m9"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:math></inline-formula> as more than sufficient to encompass the relevant speed fluctuations.”</p><p>And in Human experiment, “These speed trajectories were analyzed for…about 15 steps surrounding the Up-step (Figure 1a). This was more than sufficient to encompass the compensation patterns, which largely took place within only a few steps before and after the perturbation.”</p><p>Reviewer is correct that compensation takes place in roughly three steps before and after perturbation, for about seven steps in total. We optimized and measured for more steps to ensure that the entire compensation was observed. In Results:</p><p>“The basic speed response… (1) Speed up in the two steps prior, (2) then lose speed during the two steps onto the Up-step and immediately thereafter, and (3) then regain speed over the following one or two steps.”</p><p>Also in Results:</p><p>“The anticipatory compensation thus begins only a few steps before the perturbation, but is accompanied by several steps of response after the perturbation.”</p><p>We do not claim an absolute minimal number of steps for human, but rather describe when and how most of the response occurs.</p><disp-quote content-type="editor-comment"><p>4) demonstrating that minimal work leads to better agreement between simulations and observations than other plausible optimality criteria. I understand that some plausible criteria, e.g., stability against noise, are not easy to test but they could be discussed.</p></disp-quote><p>We have expanded on the Discussion of optimality criteria, including a number of additional energy costs and objectives (e.g., no compensation, non-anticipatory reaction, and tight regulation to avoid speed changes (Figure 2)). Regarding stability, we have added the following remark:</p><p>“Stability may also be important for human locomotion, although we found no need to include it as an explicit objective because the model could easily traverse the perturbation, and found it most economical to do so without falling. Stability might affect walking more when there is a more significant risk of falling than observed here.”</p><disp-quote content-type="editor-comment"><p>5) demonstrating that the predicted dependence of speed fluctuations on step height is in agreement with experimental observations. (I realize that this might require additional experiments and might therefore not be feasible within a reasonable time but I feel it is a missed opportunity that this was not part of the original experimental protocol.)</p></disp-quote><p>We have expanded on the Discussion of optimality criteria, including a number of additional energy costs and objectives (e.g., no compensation, non-anticipatory reaction, and tight regulation to avoid speed changes (Figure 2)). Regarding stability, we have added the following remark:</p><p>“Stability may also be important for human locomotion, although we found no need to include it as an explicit objective because the model could easily traverse the perturbation, and found it most economical to do so without falling. Stability might affect walking more when there is a more significant risk of falling than observed here.”</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The authors have addressed some but not all the questions/concerns raised in the previous review.</p><p>Previous essential revision 1. Instead of demonstrating that minimization of mechanical work captured observed stride length variability, the authors moved the results on stride length variability to the appendix. I am under the impression that the authors have previously published simulations in which stride times were not imposed (was not contradicted in response) and it is unclear why simulations with variable (i.e. not pre-imposed) stride times could not be performed. The added value of performing simulations with different imposed stride lengths is limited as compared to the added value of performing simulations in which stride length is a free variable (and thus follows from optimization). Simulations with variable stride lengths could have given information on whether the key assumption (minimization of mechanical work) predicts other features than speed fluctuations alone.</p></disp-quote><p>We have made three changes to address this comment. First, we added a new paragraph in Model Predictions to explain why we test predictions from step-to-step transition costs. Second, we added a discussion (in Discussion) regarding transient step durations. It is true that we have previously proposed a cost for steady stride times, but we explain that the transient stride adjustments observed here require a different model, which has not been proposed. Third, we added a paragraph to Appendix expanding on this further. These changes are detailed as follows.</p><p>1. We have moved the model predictions earlier, to precede Results. (An editor had previously asked us to move Methods to the end, but we find it clearer to restore model predictions to their original location as a separate section.) We clarify:</p><p>“We hypothesize that step-to-step transitions are costly enough to merit anticipation and compensation for uneven steps. […] It is, however, not necessary to model such features, if step-to-step transitions are costly enough to predict substantial and nontrivial compensations.”</p><p>2. Added to Discussion:</p><p>“We have previously proposed that substantial energy is also expended for active leg motions during steady walking (Doke and Kuo, 2007; Doke et al., 2005), perhaps half the amount expended for step-to-step transitions (Kuo, 2001). We presently lack a model for the cost of transient step adjustments, which could potentially provide more detail about how active speed and step length fluctuations are achieved.”</p><p>3. Added to Appendix 2:</p><p>“These observations suggest possibilities for incorporation into a model. […] Nevertheless, the existence of such a cost does not exclude step-to-step transition costs as an important determinant of the speed fluctuations observed here.”</p><disp-quote content-type="editor-comment"><p>Previous essential revision 5. The authors have introduced alternative hypotheses but this feels 'after the facts'. It was already clear that these hypotheses would not hold (with prior knowledge of the experimental data) and they have therefore limited value. We specifically asked about alternative optimality criteria and such criteria will only strengthen the reported findings when they truly challenge them.</p></disp-quote><p>We have expanded on the Discussion of alternative hypotheses to address this comment. We understand the request (from first review), “demonstrating that minimal work leads to better agreement between simulations and observations than other plausible optimality criteria,” but it is difficult to predict what alternatives another person would accept as plausible and truly challenging. In the absence of a specific suggestion, we have added the following to the Discussion:</p><p>“There are of course, other possible optimality criteria not considered here. […] It would be challenging to predict the observed human responses with a model that does not subscribe to these basic principles.”</p><disp-quote content-type="editor-comment"><p>With respect to stability as an alternative optimization criterion, I find the addition to the discussion not convincing. The model being able to traverse the perturbation without falling tells little about stability against noise, which can be expected in real life (but was not odelled). I am also unsure about what the authors mean by ‘the model could easily traverse the perturbation’. How was ‘easily’ defined?</p></disp-quote><p>To clarify, we have amended the sentence (changes emphasized):</p><p>“Stability may also be important for human locomotion, although we found no need to include it as an explicit objective, first because our walking model has passive dynamic stability against small disturbances (Kuo, 2002), and second because optimization for economy alone was sufficient to traverse the perturbation without falling.”</p><p>We agree that our optimization tells little about stability against noise, but only said that “we found no need” for explicit stability, not that it does not matter at all. The rest of the paragraph already said, “Stability might affect walking more when there is a more significant risk of falling than observed here. The present study shows that energy and time are two factors that may influence locomotion planning, but is also not intended to exclude other objectives and influences.”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>The authors have addressed all my specific comments satisfactorily.</p><p>I am also reasonably satisfied with how the authors have addressed the issue of constant vs varying step length that other reviewers raised and the consensus review included. However, the authors may want to clearly note that allowing the step length to vary with speed via a static preferred speed-step-length relationship is not the same (ie not mathematically equivalent) as allowing the step length to vary as an independent optimization variable because, well, one problem has more optimization degrees of freedom than the other. But this additional calculation is certainly suggestive (and I believe its suggestion) that allowing step lengths to vary will not change the speed fluctuation results substantially.</p></disp-quote><p>In Discussion, we have added:</p><p>“We presently lack a model for the cost of transient step adjustments, which could potentially provide more detail about how active speed and step length fluctuations are achieved (e.g. Appendix 2-figure 1).”</p><p>In the Appendix, we added a paragraph to expand on this issue:</p><p>“These observations suggest possibilities for incorporation into a model. […] Nevertheless, the existence of such a cost does not exclude step-to-step transition costs as an important determinant of the speed fluctuations observed here.”</p></body></sub-article></article>