<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">88431</article-id><article-id pub-id-type="doi">10.7554/eLife.88431</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88431.3</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Genetics and Genomics</subject></subj-group></article-categories><title-group><article-title>Spotless, a reproducible pipeline for benchmarking cell type deconvolution in spatial transcriptomics</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-314661"><name><surname>Sang-aram</surname><given-names>Chananchida</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0922-0822</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-314579"><name><surname>Browaeys</surname><given-names>Robin</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2934-5195</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-314662"><name><surname>Seurinck</surname><given-names>Ruth</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-88315"><name><surname>Saeys</surname><given-names>Yvan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0415-1506</contrib-id><email>yvan.saeys@ugent.be</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund6"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04q4ydz28</institution-id><institution>Data Mining and Modelling for Biomedicine, VIB Center for Inflammation Research</institution></institution-wrap><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cv9y106</institution-id><institution>Department of Applied Mathematics, Computer Science and Statistics, Ghent University</institution></institution-wrap><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Pinello</surname><given-names>Luca</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/002pd6e78</institution-id><institution>Massachusetts General Hospital</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Landry</surname><given-names>Christian R</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04sjchr03</institution-id><institution>Université Laval</institution></institution-wrap><country>Canada</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>24</day><month>05</month><year>2024</year></pub-date><volume>12</volume><elocation-id>RP88431</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2023-04-18"><day>18</day><month>04</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2023-03-24"><day>24</day><month>03</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.03.22.533802"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2023-07-31"><day>31</day><month>07</month><year>2023</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88431.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-04-08"><day>08</day><month>04</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88431.2"/></event></pub-history><permissions><copyright-statement>© 2023, Sang-aram et al</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Sang-aram et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-88431-v1.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-88431-figures-v1.pdf"/><abstract><p>Spatial transcriptomics (ST) technologies allow the profiling of the transcriptome of cells while keeping their spatial context. Since most commercial untargeted ST technologies do not yet operate at single-cell resolution, computational methods such as deconvolution are often used to infer the cell type composition of each sequenced spot. We benchmarked 11 deconvolution methods using 63 silver standards, 3 gold standards, and 2 case studies on liver and melanoma tissues. We developed a simulation engine called <italic>synthspot</italic> to generate silver standards from single-cell RNA-sequencing data, while gold standards are generated by pooling single cells from targeted ST data. We evaluated methods based on their performance, stability across different reference datasets, and scalability. We found that cell2location and RCTD are the top-performing methods, but surprisingly, a simple regression model outperforms almost half of the dedicated spatial deconvolution methods. Furthermore, we observe that the performance of all methods significantly decreased in datasets with highly abundant or rare cell types. Our results are reproducible in a Nextflow pipeline, which also allows users to generate synthetic data, run deconvolution methods and optionally benchmark them on their dataset (<ext-link ext-link-type="uri" xlink:href="https://github.com/saeyslab/spotless-benchmark">https://github.com/saeyslab/spotless-benchmark</ext-link>).</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>spatial transcriptomics</kwd><kwd>deconvolution</kwd><kwd>benchmark</kwd><kwd>single-cell RNA sequencing</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007229</institution-id><institution>Bijzonder Onderzoeksfonds UGent</institution></institution-wrap></funding-source><award-id>BOF21-DOC-105</award-id><principal-award-recipient><name><surname>Sang-aram</surname><given-names>Chananchida</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id><institution>Fonds Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>1181318N</award-id><principal-award-recipient><name><surname>Browaeys</surname><given-names>Robin</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100002913</institution-id><institution>Vlaamse Overheid</institution></institution-wrap></funding-source><award-id>Onderzoeksprogramma Artificiele Intelligentie</award-id><principal-award-recipient><name><surname>Seurinck</surname><given-names>Ruth</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id><institution>Fonds Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>EOS (Excellence of Science)</award-id><principal-award-recipient><name><surname>Saeys</surname><given-names>Yvan</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007229</institution-id><institution>Bijzonder Onderzoeksfonds UGent</institution></institution-wrap></funding-source><award-id>BOF18-GOA-024</award-id><principal-award-recipient><name><surname>Saeys</surname><given-names>Yvan</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id><institution>Fonds Wetenschappelijk Onderzoek</institution></institution-wrap></funding-source><award-id>SBO - S001121N</award-id><principal-award-recipient><name><surname>Saeys</surname><given-names>Yvan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Estimating cell type composition from a gene expression mixture remains a challenging task, as evidenced by how a simple regression model outperforms many state-of-the-art spatial deconvolution methods.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Unlike single-cell sequencing, spatial transcriptome profiling technologies can uncover the location of cells, adding another dimension to the data that is essential for studying systems biology, for example cell-cell interactions and tissue architecture (<xref ref-type="bibr" rid="bib44">Wagner et al., 2016</xref>). These approaches can be categorized into imaging- or sequencing-based methods, each of them offering complementary advantages (<xref ref-type="bibr" rid="bib3">Asp et al., 2020</xref>). As imaging-based methods use labeled hybridization probes to target specific genes, they offer subcellular resolution and high capture sensitivity, but are limited to a few hundreds or thousands of genes (<xref ref-type="bibr" rid="bib14">Eng et al., 2019</xref>; <xref ref-type="bibr" rid="bib48">Xia et al., 2019</xref>). On the other hand, sequencing-based methods offer an unbiased and transcriptome-wide coverage by using capture oligonucleotides with a polydT sequence (<xref ref-type="bibr" rid="bib28">Rodriques et al., 2019</xref>; <xref ref-type="bibr" rid="bib36">Ståhl et al., 2016</xref>). These oligos are printed in clusters, or <italic>spots</italic>, each with a location-specific barcode that allows identification of the originating location of a transcript. While the size of these spots initially started at 100 µm in diameter, some recent sequencing technologies have managed to reduce their size to the subcellular level, thus closing the resolution gap with imaging technologies (<xref ref-type="bibr" rid="bib7">Chen et al., 2022</xref>; <xref ref-type="bibr" rid="bib8">Cho et al., 2021</xref>). However, these spots do not necessarily correspond to individual cells, and therefore, computational methods remain necessary to determine the cell-type composition of each spot.</p><p>Deconvolution and mapping are two types of cell type composition inference tools that can be used to disentangle populations from a mixed gene expression profile (<xref ref-type="bibr" rid="bib23">Longo et al., 2021</xref>). In conjunction with the spatial dataset, a reference scRNA-seq dataset from an atlas or matched sequencing experiment is typically required to build cell-type-specific gene signatures. Deconvolution infers the proportions of cell types in a spot by utilizing a regression or probabilistic framework, and methods specifically designed for ST data often incorporate additional model parameters to account for spot-to-spot variability. On the other hand, mapping approaches score a spot for how strongly its expression profile corresponds to those of specific cell types. As such, deconvolution returns the proportion of cell types per spot, and mapping returns the probability of cell types belonging to a spot. Unless otherwise specified, we use the term ‘deconvolution’ to refer to both deconvolution and mapping algorithms in this study.</p><p>Although there have recently been multiple benchmarking studies (<xref ref-type="bibr" rid="bib20">Li et al., 2022</xref>; <xref ref-type="bibr" rid="bib49">Yan and Sun, 2023</xref>; <xref ref-type="bibr" rid="bib22">Li et al., 2023b</xref>), several questions remain unanswered. First, the added value of algorithms specifically developed for the deconvolution of ST data has not been evaluated by comparing them to a baseline or bulk deconvolution method. Second, it is unclear which algorithms are better equipped to handle challenging scenarios, such as the presence of a highly abundant cell type throughout the tissue or the detection of a rare cell type in a single region of interest. Finally, the stability of these methods to variations in the reference dataset arising from changes in technology or protocols has not been assessed.</p><p>In this study, we address these gaps in knowledge and provide a comprehensive evaluation of 11 deconvolution methods in terms of performance, stability, and scalability (<xref ref-type="fig" rid="fig1">Figure 1</xref>). The tools include eight spatial deconvolution methods (cell2location <xref ref-type="bibr" rid="bib19">Kleshchevnikov and Shmatko, 2020</xref>, DestVI <xref ref-type="bibr" rid="bib24">Lopez et al., 2022</xref>, DSTG <xref ref-type="bibr" rid="bib34">Song and Su, 2021</xref>, RCTD <xref ref-type="bibr" rid="bib6">Cable et al., 2022</xref>, SpatialDWLS <xref ref-type="bibr" rid="bib11">Dong and Yuan, 2021</xref>, SPOTlight <xref ref-type="bibr" rid="bib13">Elosua-Bayes et al., 2021</xref>, stereoscope <xref ref-type="bibr" rid="bib2">Andersson et al., 2020</xref>, and STRIDE <xref ref-type="bibr" rid="bib39">Sun et al., 2022</xref>), one bulk deconvolution method (MuSiC <xref ref-type="bibr" rid="bib46">Wang et al., 2019</xref>), and two mapping methods (Seurat <xref ref-type="bibr" rid="bib38">Stuart et al., 2019</xref> and Tangram <xref ref-type="bibr" rid="bib4">Biancalani et al., 2021</xref>). For all methods compared, we discussed with the original authors in order to ensure that their method was run in an appropriate setting and with good parameter values. We also compared method performance with two baselines: a ‘null distribution’ based on random proportions drawn from a Dirichlet distribution, and predictions from the non-negative least squares (NNLS) algorithm. We evaluated method performance on a total of 66 synthetic datasets (63 silver standards and 3 gold standards) and two application datasets. Our benchmarking pipeline is completely reproducible and accessible through Nextflow (<ext-link ext-link-type="uri" xlink:href="https://github.com/saeyslab/spotless-benchmark">github.com/saeyslab/spotless-benchmark</ext-link>). Furthermore, each method is implemented inside a Docker container, which enables users to run the tools without requiring prior installation.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of the benchmark.</title><p>(<bold>a</bold>) The datasets used consist of silver standards generated from single-cell RNA-seq data, gold standards from imaging-based data, and two case studies on liver and melanoma. Our simulation engine <italic>synthspot</italic> enables the creation of artificial tissue patterns. (<bold>b</bold>) We evaluated deconvolution methods on three overall performance metrics (RMSE, AUPR, and JSD), and further checked specific aspects of performance, that is how well methods detect rare cell types and handle reference datasets from different sequencing technologies. For the case studies, the AUPR and stability are only evaluated on the liver dataset. (<bold>c</bold>) Our benchmarking pipeline is entirely accessible and reproducible through the use of Docker containers and Nextflow. (<bold>d</bold>) To evaluate performance on the liver case study, we leveraged prior knowledge of the localization and composition of cell types to calculate the AUPR and JSD. We also investigated method performance on three different sequencing protocols.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig1-v1.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Overview of <italic>synthspot</italic> abundance patterns used in the study.</title><p>(<bold>a</bold>) Characteristics considered in synthspot include composition uniformity, cell type distinctness across regions, the presence of special cell types, or the removal of certain cell types. The pie charts represent frequency priors per region. Cell type composition in each region can be either <italic>uniform</italic> or <italic>diverse,</italic> depending on whether each cell type has the same or different number of cells per spot. <italic>Distinct</italic> and <italic>overlap</italic> refers to whether each region has a distinct set of cell types per region, or whether cell types can be found in multiple regions. <italic>Dominant cell type</italic> means that there is one dominant cell type that is 5–15 times more abundant than other cell types in all regions. In <italic>partially dominant cell type</italic>, this dominant cell type is dominant in all regions except for a region where it is equally abundant with other cell types and another region where it is absent. <italic>Rare cell type</italic> is the opposite of the dominant cell type, where one cell type is instead much less abundant than other cell types in all regions. In the <italic>regional rare cell type</italic> dataset, the rare cell type is only present in one region instead of all regions. (<bold>b</bold>) Each abundance pattern is a combination of multiple characteristics.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig1-figsupp1-v1.tif"/></fig><fig id="fig1s2" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 2.</label><caption><title>Data generation scheme of silver standards.</title><p>Silver standards are generated using half of the cells from a reference scRNA-seq dataset (generation). The other half (test) is used as the reference profile in deconvolution methods. This split is stratified by cell type. One scRNA-seq dataset gives rise to 90 synthetic datasets, as we generate nine <italic>synthspot</italic> abundance patterns with 10 replicates for each abundance pattern.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig1-figsupp2-v1.tif"/></fig><fig id="fig1s3" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 3.</label><caption><title>UMAP and violin plots of three of the seven scRNA-seq datasets used to generate silver standards.</title><p>Each point on the UMAP represents a single cell and the distance between two points corresponds to how similar their gene expression profiles are. The violin plots show the distribution of total number of counts and features (genes) across all cells in a cell type. The brain cortex dataset has much higher counts than the others because it was sequenced with a plate-based method (SMART-Seq), while the others were sequenced with droplet-based methods (10 x Chromium and Drop-seq).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig1-figsupp3-v1.tif"/></fig><fig id="fig1s4" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 4.</label><caption><title>(Continuation of the previous figure supplement) UMAP and violin plots of four of the seven scRNA-seq datasets used to generate silver standards.</title><p>Each point on the UMAP represents a single cell and the distance between two points corresponds to how similar their gene expression profiles are. The violin plots show the distribution of total number of counts and features (genes) across all cells in a cell type.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig1-figsupp4-v1.tif"/></fig></fig-group></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title><italic>Synthspot</italic> allows simulation of artificial tissue patterns</title><p>Synthetic spatial datasets are commonly generated by developers of deconvolution methods as part of benchmarking their algorithms against others. However, these synthetic datasets typically have spots with random compositions that do not reflect the reality of tissue regions with distinct compositions, such as layers in the brain. On the other hand, general-purpose simulators are more focused on other inference tasks, such as spatial clustering and cell-cell communication, and are usually unsuitable for deconvolution. For instance, generative models and kinetic models like those of scDesign3 (<xref ref-type="bibr" rid="bib35">Song and Wang, 2024</xref>) and scMultiSim (<xref ref-type="bibr" rid="bib21">Li et al., 2023a</xref>) are computationally intensive and unable to model entire transcriptomes. SRTSim (<xref ref-type="bibr" rid="bib51">Zhu, 2023</xref>) focuses on modeling gene expression trends and does not explicitly model tissue composition, while spaSim (<xref ref-type="bibr" rid="bib15">Feng et al., 2023</xref>) only models tissue composition without gene expression. To overcome these limitations, we developed our own simulator called <italic>synthspot</italic> that can generate synthetic tissue patterns with distinct regions, allowing for more realistic simulations (<ext-link ext-link-type="uri" xlink:href="https://github.com/saeyslab/synthspot">https://github.com/saeyslab/synthspot</ext-link>; <xref ref-type="bibr" rid="bib5">Browaeys and Sang-aram, 2024</xref>). We validated that our simulation procedure accurately models real data characteristics and that method performances are comparable between synthetic and real tissue patterns (Appendix 1).</p><p>Within a synthetic dataset, <italic>synthspot</italic> creates artificial regions in which all spots belonging to the same region have the same frequency priors. Frequency priors correspond to the likelihood in which cells from a cell type will be sampled, and therefore, spots within the same region will have similar compositions. These frequency priors are influenced by the chosen artificial tissue pattern, or <italic>abundance pattern</italic>, which determines the uniformity, distinctness, and rarity of cell types within and across regions (<xref ref-type="fig" rid="fig1">Figure 1a</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). For example, the <italic>uniform</italic> characteristic will sample the same number of cells for all cell types in a spot, while <italic>diverse</italic> samples differing number of cells. The <italic>distinct</italic> characteristic constrains a cell type to only be present in one region, while <italic>overlap</italic> allows it to be present in multiple regions. Additionally, the <italic>dominant cell type</italic> characteristic randomly assigns a dominant cell type that is at least 5–15 times more abundant than others in each spot, while <italic>rare cell type</italic> does the opposite to create a cell type that is 5–15 times less abundant. The different characteristics can be combined in up to nine different abundance patterns, each representing a plausible biological scenario.</p></sec><sec id="s2-2"><title>Cell2location and RCTD are the top performers in synthetic data</title><p>Our synthetic spatial datasets consist of 63 silver standards generated from <italic>synthspot</italic> and 3 gold standards generated from imaging data with single-cell resolution (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a-b</xref>). We generated the silver standards using seven publicly available scRNA-seq datasets and nine abundance patterns. The scRNA-seq datasets consisted of four mouse brain tissues (cortex, hippocampus, and two cerebellum), mouse kidney, mouse skin cancer (melanoma), and human skin cancer (squamous cell carcinoma). Half of the cells from each scRNA-seq dataset were used to generate the synthetic spots and the other half used as the reference for deconvolution. This split was stratified by cell type. We generated 10 replicates for each of the 63 silver standards, with each replicate containing around 750 spots (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). For the gold standard, we used two seqFISH+ sections of mouse brain cortex and olfactory bulb (63 spots with 10,000 genes each) and one STARMap section of mouse primary visual cortex (108 spots with 996 genes; <xref ref-type="bibr" rid="bib14">Eng et al., 2019</xref>; <xref ref-type="bibr" rid="bib45">Wang et al., 2018</xref>). We summed up counts from cells within circles of 55 µm diameter, which are the size of spots in the 10x Visium commercial platform.</p><p>We evaluated method performance with the root-mean-square error (RMSE), area under the precision-recall curve (AUPR), and Jensen-Shannon divergence (JSD; Appendix 2). The RMSE measures how numerically accurate the predicted proportions are, the AUPR measures how well a method can detect whether a cell type is present or absent, and the JSD measure similarities between two probability distributions.</p><p>RCTD and cell2location were the top two performers across all metrics in the silver standards, followed by SpatialDWLS, stereoscope, and MuSiC (<xref ref-type="fig" rid="fig2">Figure 2b</xref>, <xref ref-type="fig" rid="fig3">Figure 3a</xref>). All other methods ranked worse than NNLS in at least one metric. For each silver standard, method rankings were determined using the median value across 10 replicates. We observed that method performances were more consistent between abundance patterns than between datasets (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplements 1</xref>–<xref ref-type="fig" rid="fig3s3">3</xref>). Most methods had worse performance in the two abundance patterns with a dominant cell type, and there was considerable performance variability between replicates due to different dominant cell types being selected in each replicate. Only RCTD and cell2location consistently outperformed NNLS in all metrics in these patterns (<xref ref-type="fig" rid="fig3s4">Figure 3—figure supplements 4</xref>–<xref ref-type="fig" rid="fig3s5">5</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Overall results of the benchmark.</title><p>(<bold>a</bold>) Methods ordered according to their overall rankings (<bold>d</bold>), determined by the aggregated rankings of performance and scalability. (<bold>b</bold>) Performance of each method across metrics, artificial abundance patterns in the silver standard, and data sources. The ability to detect rare cell types and stability against different reference datasets are also included. (<bold>c</bold>) Average runtime across silver standards and scalability on increasing dimensions of the spatial dataset.</p><p><supplementary-material id="fig2sdata1"><label>Figure 2—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig2">Figure 2</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig2-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig2-v1.tif"/></fig><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Method performance on synthetic datasets, evaluated using root-mean-squared error (RMSE), area under the precision-recall curve (AUPR), and Jensen-Shannon divergence (JSD).</title><p>Non-negative least squares (NNLS) is shaded as a baseline algorithm. Methods are ordered based on the summed ranks across all 63 and three datasets, respectively. (<bold>a</bold>) The rank distribution of each method across all 63 silver standards, based on the best median value across ten replicates for that standard. (<bold>b</bold>) Gold standards of two seqFISH+ datasets and one STARMap dataset. We took the average over seven field of views for the seqFISH+ dataset.</p><p><supplementary-material id="fig3sdata1"><label>Figure 3—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig3">Figure 3</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig3-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-v1.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Boxplots of root-mean-squared error (RMSE) across ten replicates for each silver standard dataset (row) and abundance pattern (column).</title><p>Long dashed gray line: baseline algorithm (non-negative least squares); dotted gray line: null distribution (random proportions from a Dirichlet distribution). Number of cell types: brain cortex, 18; single-cell cerebellum, 8; single-nucleus cerebellum, 8; hippocampus, 12; kidney, 16; melanoma, 15; SCC, 14.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp1-v1.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Boxplots of the area under the precision-recall curve (AUPR) across ten replicates for each silver standard dataset (row) and abundance pattern (column).</title><p>Long dashed gray line: baseline algorithm (non-negative least squares); dotted gray line: null distribution (random proportions from a Dirichlet distribution). Number of cell types: brain cortex, 18; single-cell cerebellum, 8; single-nucleus cerebellum, 8; hippocampus, 12; kidney, 16; melanoma, 15; SCC, 14.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp2-v1.tif"/></fig><fig id="fig3s3" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 3.</label><caption><title>Boxplots of Jensen-Shannon divergence across ten replicates for each silver standard dataset (row) and abundance pattern (column).</title><p>Long dashed gray line: baseline algorithm (non-negative least squares); dotted gray line: null distribution (random proportions from a Dirichlet distribution). Number of cell types: brain cortex, 18; single-cell cerebellum, 8; single-nucleus cerebellum, 8; hippocampus, 12; kidney, 16; melanoma, 15; SCC, 14.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp3-v1.tif"/></fig><fig id="fig3s4" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 4.</label><caption><title>Summed rank plots across all silver standard datasets for each abundance pattern (column) and metric (row).</title><p>Methods are ordered from best to worst performance. The baseline method (non-negative least squares) is shaded in gray.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp4-v1.tif"/></fig><fig id="fig3s5" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 5.</label><caption><title>(Continuation of the previous figure supplement) Summed rank plots across all silver standard datasets for each abundance pattern (column) and metric (row).</title><p>Methods are ordered from best to worst performance. The baseline method (non-negative least squares) is shaded in gray.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp5-v1.tif"/></fig><fig id="fig3s6" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 6.</label><caption><title>Summed abundances across all spots for each gold standard dataset.</title><p>FOV1 of the olfactory bulb dataset has shorter bars as it only contains 8 spots. Methods are ordered according to their ranking for each dataset, based on the lowest median RMSE.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig3-figsupp6-v1.tif"/></fig></fig-group><p>For the gold standards, cell2location, MuSiC, and RCTD are the top three performers as well as the only methods to outrank NNLS in all three metrics (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). As each seqFISH+ dataset consisted of seven field of views (FOVs), we used the average across FOVs as the representative value to be ranked for that dataset. Several FOVs were dominated by one cell type (<xref ref-type="fig" rid="fig3s6">Figure 3—figure supplement 6</xref>), which was similar to the dominant cell type abundance pattern in our silver standard. Consistent with the silver standard results, half of the methods did not perform well in these FOVs. In particular, SPOTlight, DestVI, stereoscope, and Tangram tended to predict less variation between cell type abundances. DSTG, SpatialDWLS, and Seurat predicted the dominant cell type in some FOVs but did not predict the remaining cell type compositions accurately. Most methods performed worse in the STARMap dataset except for SpatialDWLS, SPOTlight, and Tangram.</p></sec><sec id="s2-3"><title>Detecting rare cell types remains challenging even for top-performing methods</title><p>Lowly abundant cell types often play an important role in development or disease progression, as in the case of stem cells and progenitor cells or circulating tumor cells (<xref ref-type="bibr" rid="bib17">Jindal et al., 2018</xref>). As the occurrence of these cell types are often used to create prognostic models of patient outcomes, the accurate detection of rare cell types is a key aspect of deconvolution tools (<xref ref-type="bibr" rid="bib1">Ali et al., 2016</xref>; <xref ref-type="bibr" rid="bib32">Sato et al., 2005</xref>). Here, we focus on the two <italic>rare cell type</italic> patterns in our silver standard (<italic>rare cell type diverse</italic> and <italic>regional rare cell type diverse</italic>), in which a rare cell type is 5–15 times less abundant than other cell types in all or one synthetic region, respectively (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). This resulted in 14 synthetic datasets (seven scRNA-seq datasets × two abundance patterns) with 10 replicates each. We only evaluated methods based on the AUPR of the rare cell type, using the average AUPR across the 10 replicates as the representative value for each dataset. We did not include the RMSE and JSD or consider other cell types, because in prognostic models, the presence of rare cell types is often of more importance than the magnitude of the abundance itself. Therefore, it is more relevant that methods are able to correctly rank spots with and without the rare cell type.</p><p>In line with our previous analysis, RCTD and cell2location were also the best at predicting the presence of lowly abundant cell types (<xref ref-type="fig" rid="fig4">Figure 4a</xref>). There is a strong correlation between cell type abundance and AUPR, as clearly demonstrated when plotting the precision-recall curves of cell types with varying proportions (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). While most methods can detect cell types with moderate or high abundance, they usually have lower sensitivity for rare cell types, and hence lower AUPRs. Upon visual inspection of precision-recall curves at decreasing abundance levels, we found a similar pattern across all silver standards (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Nonetheless, we also observe that the AUPR is substantially lower if the rare cell type is only present in one region and not across the entire tissue, indicating that prevalence is also an important factor in detection.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Detection of the rare cell type in the two <italic>rare cell type</italic> abundance patterns.</title><p>(<bold>a</bold>) Area under the precision-recall curve (AUPR) across the seven scRNA-seq datasets, averaged over 10 replicates. Methods generally have better AUPR if the rare cell type is present in all regions compared to just one region. (<bold>b</bold>) An example on one silver standard replicate demonstrates that most methods can detect moderately and highly abundant cells, but their performance drops for lowly abundant cells.</p><p><supplementary-material id="fig4sdata1"><label>Figure 4—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig4-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig4-v1.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Evaluating the AUPR as a function of cell type abundance.</title><p>Across the ten replicates of a silver standard dataset (here, the SCC dataset with the <italic>regionally rare</italic> abundance pattern is shown), we ordered cell types according to their abundance and computed the average precision-recall curve for each abundance rank. For instance, the leftmost column depicts the average precision-recall curve for the most abundant cell type in all 10 replicates. The boxplots (top) depict cell type frequency priors in each abundance rank, that is the likelihood in which a cell type will be sampled in a spot. The observed average abundance is also indicated underneath the abundance rank number. As cells become less abundant, they become harder to detect by all methods, as indicated by less confident PR curves with smaller areas. Plots of all silver standard datasets can be found in our GitHub repository.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig4-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-4"><title>Technical variability between reference scRNA-seq and spatial datasets can significantly impact predictions</title><p>Since deconvolution predictions exclusively rely on signatures learned from the scRNA-seq reference, it should come as no surprise that the choice of the reference dataset has been shown to have the largest impact on bulk deconvolution predictions (<xref ref-type="bibr" rid="bib42">Vallania et al., 2018</xref>). Hence, deconvolution methods should ideally also account for platform effects, that is the capture biases that may occur from differing protocols and technologies being used to generate scRNA-seq and ST data.</p><p>To evaluate the stability of each method against reference datasets from different technological platforms, we devised the <italic>inter</italic>-dataset scenario, where we provided an alternative reference dataset to be used for deconvolution, in contrast to the <italic>intra-</italic>dataset analysis done previously, where the same reference dataset was used for both spot generation and deconvolution. We tested this on the brain cortex (SMART-seq) and two cerebellum (Drop-seq and 10x Chromium) silver standards. For the brain cortex, we used an additional 10x Chromium reference from the same atlas (<xref ref-type="bibr" rid="bib50">Yao et al., 2021</xref>). To measure stability, we computed the JSD between the proportions predicted from the intra- and inter-dataset scenario.</p><p>Except for MuSiC, we see that methods with better performance–cell2location, RCTD, SpatialDWLS, and stereoscope–were also more stable against changing reference datasets (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Out of these four, only SpatialDWLS did not account for a platform effect in its model definition. Cell2location had the most stable predictions, ranking first in all three datasets, while both NNLS and MuSiC were consistently in the bottom three. For the rest of the methods, stability varied between datasets. DestVI performed well in the cerebellum datasets but not the brain cortex, and SPOTlight had the opposite pattern. As expected, deconvolution performance also generally worsens in the inter-dataset scenario (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>).</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Prediction stability when using different reference datasets.</title><p>For each synthetic dataset (total n=90, from nine abundance patterns with ten replicates each), we computed the Jensen-Shannon divergence between cell type proportions obtained from two different reference datasets.</p><p><supplementary-material id="fig5sdata1"><label>Figure 5—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig5">Figure 5</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig5-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig5-v1.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Changes in performance metrics when using a different reference dataset, from a matched to an unmatched reference (i.e., intra-dataset vs inter-dataset scenario).</title><p>A matched reference means that the simulated spots and reference were generated from the same scRNA-seq data but on different halves of cells (<xref ref-type="fig" rid="fig1s2">Figure 1—figure supplement 2</xref>). Methods are ordered based on JSD between predicted proportions and not on the metrics themselves (<xref ref-type="fig" rid="fig5">Figure 5</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig5-figsupp1-v1.tif"/></fig></fig-group></sec><sec id="s2-5"><title>Evaluation of methods on public Visium datasets validate results on synthetic data</title><p>While synthetic datasets provide valuable benchmarks, it is crucial to validate deconvolution methods using real sequencing-based ST data, as they may exhibit distinct characteristics. To achieve this, we leveraged 10x Visium datasets from two mouse tissues, namely liver and skin cancer (melanoma). These datasets were chosen due to the availability of ground truth knowledge regarding cell proportions and localization, as elaborated further below.</p><sec id="s2-5-1"><title>Liver</title><p>The liver is a particularly interesting case study due to its tissue pattern, where hepatocytes are highly abundant and constitute more than 60% of the tissue. This characteristic allows us to compare method performance with those of the <italic>dominant cell type</italic> abundance pattern from the silver standard, which was challenging for most methods. Here, we use the four Visium slides and single-cell dataset from the liver cell atlas of <xref ref-type="bibr" rid="bib16">Guilliams et al., 2022</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>. The single-cell dataset was generated from three different experimental protocols–scRNA-seq following ex vivo digestion, scRNA-seq following in vivo liver perfusion, and single-nucleus RNA-seq (snRNA-seq) on frozen liver—additionally enabling us to assess method stability on different reference datasets.</p><p>We assessed method performance using AUPR and JSD by leveraging prior knowledge of the localization and composition of cell types in the liver. Although the true composition of each spot is not known, we can assume the presence of certain cell types in certain locations in the tissue due to the zonated nature of the liver. Specifically, we calculated the AUPR of portal vein and central vein endothelial cells (ECs) under the assumption that they are present only in their respective venous locations. Next, we calculated the JSD of the expected and predicted cell type proportions in a liver sample. The expected cell type proportions were based on snRNA-seq data (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), which has been shown to best recapitulate actual cell compositions observed by confocal microscopy (<xref ref-type="bibr" rid="bib16">Guilliams et al., 2022</xref>). We ran each method on a combined reference containing all three experimental protocols (ex vivo scRNA-seq, in vivo scRNA-seq, and snRNA-seq), as well as on each protocol separately. To ensure consistency, we filtered each reference dataset to only include the nine cell types that were common to all three protocols.</p><p>RCTD and cell2location were the top performers for both AUPR and JSD (<xref ref-type="fig" rid="fig6">Figure 6a</xref>), achieving a JSD comparable to those of biological variation, that is the average pairwise JSD between four snRNA-seq samples. In contrast, Tangram, DSTG, SPOTlight, and stereoscope had higher JSD values than those of NNLS. Except for SPOTlight, these three methods were not able to accurately infer the overabundance of the dominant cell type, with stereoscope and Tangram predicting a uniform distribution of cell types (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). This corresponds to what we observed in the <italic>dominant cell type</italic> pattern of the silver standard and certain FOVs in the gold standard. To further substantiate this, we used the ex vivo scRNA-seq dataset to generate 10 synthetic datasets with the <italic>dominant cell type</italic> abundance pattern. Then, we used the remaining two experimental protocols separately as the reference for deconvolution. Indeed, the method rankings followed the overall pattern, and a comparison of the JSD values between synthetic and real Visium data revealed a strong correlation (<xref ref-type="fig" rid="fig6s3">Figure 6—figure supplement 3</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Method performance on two Visium case studies.</title><p>(<bold>a</bold>) In the liver case study, the AUPR was calculated using the presence of portal/central vein endothelial cells in portal and central veins, and the JSD was calculated by comparing predicted cell type proportions with those from snRNA-seq. All reference datasets contain nine cell types. Biological variation refers to the average pairwise JSD between four snRNA-seq samples. Methods are ordered based on the summed rank of all data points. (<bold>b</bold>) For melanoma, the JSD was calculated between the predicted cell type proportions and those from Molecular Cartography (bold). Biological variation refers to the JSD between the two Molecular Cartography samples. (<bold>c</bold>) Relationship between the proportions of endothelial cells predicted per spot and their distance to the nearest blood vessel (in arbitrary units, AU), where zero denotes a spot annotated as a vessel. An inverse correlation can be observed more clearly in better-performing methods.</p><p><supplementary-material id="fig6sdata1"><label>Figure 6—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig6">Figure 6</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig6-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-v1.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Comparison of cell type compositions between three sequencing protocols in the mouse liver atlas from <xref ref-type="bibr" rid="bib16">Guilliams et al., 2022</xref>.</title><p>In the original paper, samples profiled by snRNA-seq were shown to best resemble in vivo cell compositions.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp1-v1.tif"/></fig><fig id="fig6s2" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 2.</label><caption><title>Predicted cell type abundances averaged across all four Visium slides from the liver atlas.</title><p>Using different reference datasets for deconvolution often led to drastically different predictions (most notably with snRNA-seq). Each reference dataset except ‘All’ was filtered to only contain nine common cell types. ‘All (filtered)’ comprises all three protocols but only nine cell types; ‘All’ contains 14 more cell types which were grouped under ‘Others’. The ground truth is the average of four snRNA-seq samples (ABU11, ABU13, ABU17 ABU20). Methods are ordered according to their JSD rankings (<xref ref-type="fig" rid="fig6">Figure 6a</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp2-v1.tif"/></fig><fig id="fig6s3" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 3.</label><caption><title>Concordance of method performance between the synthetic dataset (generated using synthspot’s <italic>dominant cell type</italic> abundance pattern) and the Visium dataset.</title><p>(<bold>a</bold>) Method performance on synthetic liver datasets generated from the ex vivo scRNA-seq protocol, using either the in vivo scRNA-seq or snRNA-seq protocols as the reference for deconvolution. (<bold>b</bold>) Comparison of the average JSD of each method between the synthetic and Visium datasets.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp3-v1.tif"/></fig><fig id="fig6s4" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 4.</label><caption><title>The predicted abundance of central vein and portal vein endothelial cells (ECs) for each spot in one liver Visium slide.</title><p>Here, the single-cell atlas containing all three protocols and filtered to nine cell types was used as reference for deconvolution. According to prior knowledge, central vein ECs should only be present in the central vein, and portal vein ECs in the portal vein. Methods are ordered based on their overall AUPR rankings (<xref ref-type="fig" rid="fig6">Figure 6a</xref>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp4-v1.tif"/></fig><fig id="fig6s5" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 5.</label><caption><title>Stability of predicted proportions when using three different protocols from the liver atlas as reference for deconvolution.</title><p>For each Visium slide, pairwise JSD values between each reference were calculated. Methods are ordered based on stability, with a lower JSD indicating higher stability.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp5-v1.tif"/></fig><fig id="fig6s6" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 6.</label><caption><title>The ground truth and predicted cell type proportions of the melanoma dataset.</title><p>(<bold>a</bold>) Melanoma sections profiled by Molecular Cartography, a targeted, imaging-based technology, are considered as ground truth. The six different sections have consistent cell type proportions, with an average inter- and intra-sample JSD of around 0.003. Sections with the same number belong to the same sample, that is A-1 and D-1. (<bold>b</bold>) The average cell type abundances predicted by each deconvolution method are also consistent on the three melanoma Visium slides.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig6-figsupp6-v1.tif"/></fig></fig-group><p>Nonetheless, there were some inconsistencies between the AUPR and JSD rankings, specifically with Seurat and SpatialDWLS ranking highly for JSD and lowly for AUPR. This is because the JSD is heavily influenced by the dominant cell type in the dataset, such that even when predicting only the dominant cell type per spot, Seurat still performed well in terms of JSD. However, it was unable to predict the presence of portal and central vein ECs in their respective regions (<xref ref-type="fig" rid="fig6s4">Figure 6—figure supplement 4</xref>). Therefore, complementary metrics like AUPR and JSD must both be considered when evaluating methods.</p><p>We observed that using the combination of the three experimental protocols as the reference dataset did not necessarily result in the best performance, and it was often possible to achieve better or similar results by using a reference dataset from a single experimental protocol. The best reference varied between methods, and most methods did not exhibit consistent performance across all references. Interestingly, Cell2location, MuSiC, and NNLS had much higher JSD when using the snRNA-seq data as the reference, while RCTD and Seurat had the lowest JSD on the same reference. To further evaluate the stability of the methods, we calculated the JSD between proportions predicted with different reference datasets. RCTD and Seurat showed the lowest JSD, indicating higher stability (<xref ref-type="fig" rid="fig6s5">Figure 6—figure supplement 5</xref>). Finally, we examined the predicted proportions when using the entire atlas without filtering cell types, which contains all three protocols and 23 cell types instead of only the nine common cell types (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). The additional 14 cell types made up around 20% of the ground truth proportions. While RCTD, Seurat, SpatialDWLS, and MuSiC retained the relative proportions of the nine common cell types, the rest predicted substantially different cell compositions.</p></sec><sec id="s2-5-2"><title>Melanoma</title><p>Melanoma poses a significant challenge in both therapeutic and research efforts due to its high degree of heterogeneity and plasticity. In a recent study, <xref ref-type="bibr" rid="bib18">Karras et al., 2022</xref> investigated the cell state diversity of melanoma by generating single-cell and ST data from a mouse melanoma model (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref>). Among others, the spatial data consists of three individual tumor sections profiled by 10x Visium, as well as 33 regions of interest from two tumor samples profiled by Molecular Cartography (MC), an imaging-based technology that can profile up to 100 genes at subcellular resolution. Using a custom processing pipeline, we obtained cell type annotations—and subsequently the cell type proportions—for each of the MC samples. These cell type proportions were consistent across different sections and samples, and were used as the ground truth for deconvolution (<xref ref-type="fig" rid="fig6s6">Figure 6—figure supplement 6</xref>). We aggregated the predicted proportions of the seven malignant cell states in the Visium slides, as we could not reliably annotate these cell states in the MC dataset.</p><p>To assess method performance, we calculated the average pairwise JSDs between the two MC samples and three Visium slides. Cell2location, SPOTlight, and RCTD were the best performers with JSDs of around 0.01 (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). With the exception of SPOTlight performing well in this dataset, the rankings of the remaining methods followed the usual trend in the silver standards, with NNLS outperforming Seurat, DestVI, STRIDE, and DSTG. Additionally, we sought to corroborate these findings through a more qualitative approach by leveraging the blood vessel annotations provided in the original study. Given that by definition, endothelial cells form the linings of blood vessels, we visualized the relationship between EC abundance and the distance to the nearest vessel (<xref ref-type="fig" rid="fig6">Figure 6c</xref>). Although the majority of spots were predicted to have no ECs, a fraction of spots exhibited the expected trend where ECs were more abundant the closer the spot was to a blood vessel. This trend was more discernible for higher ranked methods, while the lower-ranked ones either showed no correlation (NNLS, DestVI, DSTG) or had noisy predictions (Seurat, Tangram).</p></sec></sec><sec id="s2-6"><title>Runtime and scalability</title><p>Most methods are able to deconvolve the silver standard datasets in less than 30 min and only had slight variability in the runtime (<xref ref-type="fig" rid="fig7">Figure 7a</xref>). Model-based methods—DestVI, stereoscope, cell2location, and STRIDE—have the advantage that a model built from a single-cell reference can be reused for all synthetic datasets derived from that reference (i.e. the nine abundance patterns ×10 replicates). This typically reduces the runtime needed to fit the model on the synthetic datasets. However, these methods tend to be more computationally intensive and are strongly recommended to be run with GPU acceleration. This was not implemented in STRIDE and could explain its longer runtime during model building.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Runtime and scalability of each method.</title><p>(<bold>a</bold>) Runtime over the 63 silver standards (three replicates each). Methods are ordered by total runtime. Asterisks indicate when GPU acceleration has been used. Cell2location, stereoscope, DestVI, and STRIDE first build a model for each single-cell reference (red points), which can be reused for all synthetic datasets derived from that reference. (<bold>b</bold>) Method scalability on increasing dimensions of the spatial dataset. For model-based methods, the model building and fitting time were summed. Methods are ordered based on total runtime.</p><p><supplementary-material id="fig7sdata1"><label>Figure 7—source data 1.</label><caption><title>Raw data table of <xref ref-type="fig" rid="fig7">Figure 7</xref>.</title></caption><media mimetype="application" mime-subtype="xlsx" xlink:href="elife-88431-fig7-data1-v1.xlsx"/></supplementary-material></p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-fig7-v1.tif"/></fig><p>Next, we investigated method scalability by varying the dimensions of the spatial dataset (<xref ref-type="fig" rid="fig7">Figure 7b</xref>). We tested 16 combinations of spots (100, 1 k, 5 k, 10 k) and genes (5 k, 10 k, 20 k, 30 k), while the single-cell dataset was kept at 5 k cells and 30 k genes. Here, we considered both the model building and fitting step in the runtime (when applicable). Tangram, Seurat, and SPOTlight had a constant runtime across all dimensions, each deconvolving the largest dataset (3×10<sup>8</sup> elements in total) in less than ten minutes. Other methods had increased runtime both when spots and genes were increased, except for DestVI which was only affected by the number of spots, and STRIDE by the number of genes. This was because by default, DestVI only uses 2000 highly variable genes for deconvolution. Similarly, the scalability of RCTD, SpatialDWLS, Tangram, and SPOTlight are due to the fact that they only make use of differentially expressed or cell type-specific marker genes. Stereoscope was the least scalable by far, taking over 8 hr for the largest dataset, and 3.5 hr for the smallest one. Note that many methods allow for parameters that can greatly affect runtime, such as the number of training epochs and/or the number of genes to use (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). For instance, here we have used all genes to run stereoscope (default parameters), but the authors have suggested that it is possible to use only 5000 genes in the model and maintain the same performance.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this study, we performed a thorough investigation of various biologically relevant and previously unconsidered aspects related to deconvolution. We evaluated the performance of 11 deconvolution methods on 63 silver standards, 3 gold standards, and 2 Visium datasets using three complementary metrics. We also incorporated two baselines for every analysis, the NNLS algorithm and null distribution proportions from a Dirichlet distribution. In the case studies, we demonstrated two approaches for evaluating deconvolution methods in datasets lacking an absolute ground truth. These approaches include using proportions derived from another sequencing or spatial technology as a proxy, and leveraging spot annotations, for example zonation or blood vessel annotations, that typically have already been generated for a separate analysis.</p><p>Our findings indicate that RCTD, cell2location, and SpatialDWLS were the highest ranked methods in terms of performance, consistent with previous studies (<xref ref-type="bibr" rid="bib20">Li et al., 2022</xref>; <xref ref-type="bibr" rid="bib49">Yan and Sun, 2023</xref>). However, we also found that over half of the methods did not outperform the baseline (NNLS) and bulk deconvolution method (MuSiC). These results were consistent across the silver and gold standards, as well as the liver and melanoma case studies, demonstrating the generalizability and applicability of our simulation and benchmarking framework. We also found that the abundance pattern of the tissue and the reference dataset used had the most significant impact on method performance. Even top-performing methods struggled with challenging abundance patterns, such as when a rare cell type was present in only one region, or when a highly dominant cell type masks the signature of less abundant ones. Furthermore, different reference datasets could result in substantially different predicted proportions. Methods that accounted for technical variability in their models, such as cell2location and RCTD, were more stable to changes in the reference dataset than those that did not, such as SpatialDWLS.</p><p>Regarding the reference dataset, the number of genes per cell type (which is generally correlated to the sequencing depth) seems to have a significant impact on the performance of deconvolution methods. We observed that methods were less accurate in datasets with fewer genes per cell type (<xref ref-type="fig" rid="fig1s3">Figure 1—figure supplements 3</xref>–<xref ref-type="fig" rid="fig1s4">4</xref>). For example, all methods performed better in the snRNA-seq cerebellum dataset, which had the same number of cell types as the scRNA-seq cerebellum dataset, but on average 1000 more genes per cell type. The kidney dataset was the most challenging for all methods, with most of its 16 cell types having less than 1000 genes. This was evident from the RMSE and JSD scores that were relatively closer to the null distribution than in other datasets (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplements 1</xref> and <xref ref-type="fig" rid="fig3s3">3</xref>). In contrast, the 18 cell types in the brain cortex dataset had an average of 3000–9000 features, leading to much better performance for most methods compared to the kidney dataset despite having more cell types. This trend was also observed in the STARMap gold standard dataset, which consisted of only 996 genes. Most methods performed worse in the STARMap dataset except for SpatialDWLS, SPOTlight, and Tangram. Since these three methods only use marker genes for deconvolution, this may explain why the small number of genes (most of which were already marker genes) did not affect them as much.</p><p>In addition to performance, the runtime and scalability of a method is also a factor to consider. Although most runtimes were comparable on our silver standards, we have made use of GPU acceleration for Tangram, DestVI, stereoscope, and cell2location. As this might not be available for some users, using these methods on the CPU might require training on fewer epochs or selecting only a subset of genes. With all these factors in consideration, we recommend RCTD as a good starting point. In addition to being one of the best and fastest methods, it also allows CPU parallelization (i.e. using multiple cores) for users that may not have access to a GPU.</p><p>As a general guideline, we recommend comparing the result of multiple deconvolution methods, especially between cell2location and RCTD. If the predictions are highly contradictory, the reference dataset may not be of sufficiently good quality. We recommend obtaining scRNA-seq and spatial data from the same sample to reduce biological variability, as there will always be technical variability across platforms. This can also ensure that the same cell types will be present in both datasets (<xref ref-type="bibr" rid="bib23">Longo et al., 2021</xref>). If that is not possible, use a reference dataset that has sufficient sequencing depth (at least more than 1000 genes per cell type), preferably from a single platform. In addition to checking the sequencing depth, our simulator <italic>synthspot</italic> can also be used to evaluate the quality of the reference dataset. As we have demonstrated in the liver case study, users can generate synthetic spatial datasets with an abundance pattern that best resembles their tissue of interest. With a high-quality reference, both cell2location and RCTD should be able to achieve an AUPR close to one and JSD close to zero. Our Nextflow pipeline seamlessly integrates the complete workflow of synthetic data generation, deconvolution, and performance evaluation.</p><p>As spatial omics is still an emerging field, the development of new deconvolution methods can be anticipated in the future. Our benchmark provides a reliable and reproducible evaluation framework for current and upcoming deconvolution tools, making it a valuable resource for researchers in the field.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><sec id="s4-1"><title>Synthspot</title><p>We generated synthetic spatial datasets using the <italic>synthspot</italic> R package, whose spot generation process is modeled after that of SPOTlight (<xref ref-type="bibr" rid="bib13">Elosua-Bayes et al., 2021</xref>). This simulator generates synthetic spot data by considering the gene expression of one spot as a mixture of the expression of <inline-formula><mml:math id="inf1"><mml:mi>n</mml:mi></mml:math></inline-formula> cells, with <inline-formula><mml:math id="inf2"><mml:mi>n</mml:mi></mml:math></inline-formula> being a random number between 2 and 10 that is sampled from a uniform distribution. To generate one spot, the simulator samples <inline-formula><mml:math id="inf3"><mml:mi>n</mml:mi></mml:math></inline-formula> cells from the input scRNA-seq data, sums their counts gene by gene, and downsamples the counts. The target number of counts for downsampling is picked from a normal distribution with mean and standard deviation of 20,000±5000 by default, but these values can be changed by the user. To mimic biological tissue, <italic>synthspot</italic> generates artificial regions, or groups of spots with similar cell type compositions (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). The prior distribution of each cell type in each region is influenced by the selected <italic>abundance pattern</italic>, called <italic>dataset type</italic> in the package (Appendix 1).</p></sec><sec id="s4-2"><title>Method execution</title><p>An overview of the 11 methods can be found in <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>. As input, all methods require a reference scRNA-seq dataset with cell type annotations along with a spatial dataset. We first ran the methods based on the provided tutorials, and later reached out to the original authors of each method for additional recommendations. For most methods, we explored different parameters and selected ones that resulted in the best performance. The specifics on how each method was run and the final parameters can be found in <bold>Appendix 3</bold>. Unless stated otherwise, these parameters were applied on all datasets used in this study.</p><p>We implemented a Nextflow pipeline (<xref ref-type="bibr" rid="bib10">Di Tommaso et al., 2017</xref>) to run the methods concurrently and compute their performance. For reproducibility, each method was installed inside a Docker container and can be run either using Docker or Apptainer (formerly known as Singularity). Our pipeline can be run in three modes: (1) <italic>run_standard</italic> to reproduce our benchmark, (2) <italic>run_dataset</italic> to run methods on a given scRNA-seq and spatial dataset, and (3) <italic>generate_and_run</italic> to also generate synthetic spatial data from the given scRNA-seq dataset. Our pipeline can accept both Seurat (.rds) and AnnData (.h5ad) objects as input, and the proportions are output as a tab-separated file. Parameter tuning has also been implemented.</p><p>All methods were deployed on a high-performance computing cluster with an Intel Xeon Gold 6140 processor operating at 2.3 GHz, running a RHEL8 operating system. We made use of GPU acceleration whenever possible using a NVIDIA Volta V100 GPU. We ran all methods with one core and 8 GB memory, dynamically increasing the memory by 8 GB if the process failed.</p></sec><sec id="s4-3"><title>Datasets</title><sec id="s4-3-1"><title>Gold</title><p>The seqFISH+ dataset consists of two mouse brain tissue slices (cortex and olfactory bulb) with seven field of views (FOVs) per slice (<xref ref-type="bibr" rid="bib14">Eng et al., 2019</xref>). Ten thousand genes were profiled for each FOV. Each FOV had a dimension of 206 μm × 206 μm and a resolution of 103 nm per pixel. We simulated Visium spots of 55 μm diameter and disregarded the spot-to-spot distance, resulting in nine spots per FOV and 126 spots for the entire dataset. The FOVs had varying number of cells and cell types per simulated spot (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1a</xref>). We created a reference dataset for each tissue slice using the combined single-cell expression profiles from all seven FOVs. There were 17 cell types in the cortex tissue section and nine cell types in the olfactory bulb tissue section.</p><p>The STARMap dataset of mouse primary visual cortex (VISp) is 1.4 mm × 0.3 mm and contains 1020 genes and 973 cells (<xref ref-type="bibr" rid="bib45">Wang et al., 2018</xref>). We generated Visium-like spots as above, assuming that 1 pixel = 810 nm, as this information was not provided in the original paper. We removed any spot with hippocampal cell types, and removed unannotated and Reln cells from spots, resulting in 108 spots comprising 569 cells and 12 cell types in total. We used the VISp scRNA-seq dataset from the Allen Brain Atlas as the reference (<xref ref-type="bibr" rid="bib40">Tasic et al., 2016</xref>). After filtering for common genes, 996 genes remained.</p></sec><sec id="s4-3-2"><title>Silver</title><p>We used six scRNA-seq datasets and one snRNA-seq dataset for the generation of silver standards (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>). All datasets are publicly available and already contain cell type annotations. We downsized each dataset by filtering out cells with an ambiguous cell type label and cell types with less than 25 cells, and kept only highly variable genes (HVGs) that are expressed in at least 10% of cells from one cell type. We set this threshold at 25% for the brain cortex dataset. We further downsampled the kidney dataset to 15,000 cells, and the melanoma dataset to 20,000 cells. For the two cerebellum datasets, we integrated them following the method of <xref ref-type="bibr" rid="bib38">Stuart et al., 2019</xref>, performed the same gene filtering approach on the integrated dataset, and only retained common cell types.</p><p>We generated the synthetic datasets using nine out of the 17 possible abundance patterns in <italic>synthspot</italic>. For each scRNA-seq dataset, we generated 10 replicates of each abundance pattern. For each replicate, we ran <italic>generate_synthetic_visium</italic> with five regions (<italic>n_regions</italic>), with minimally 100 spots and maximally 200 spots per region (<italic>n_spots_min</italic>, <italic>n_spots_max</italic>), and target counts of 20,000±5,000 per spot (<italic>visium_mean,</italic> and <italic>visium_sd</italic>). There were on average 750 spots per replicate.</p></sec><sec id="s4-3-3"><title>Liver</title><p>We downloaded single-cell and spatial datasets of healthy mice from the liver cell atlas (<xref ref-type="bibr" rid="bib16">Guilliams et al., 2022</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1c</xref>). The single-cell data contains 185,894 cells and 31,053 genes from three experimental protocols: scRNA-seq following ex vivo digestion, scRNA-seq following in vivo liver perfusion, and snRNA-seq on frozen liver. We used the finer annotation of CD45<sup>-</sup> cells, which among others, subclustered endothelial cells into portal vein, central vein, lymphatic, and liver sinusoidal endothelial cells. We only retained cell types where at least 50 cells are present in each protocol, resulting in nine common cell types. The spatial data consisted of four Visium slides, containing on average 1440 spots. Each spot has been annotated by the original authors as belonging to either the central, mid, periportal, or portal zone. This zonation trajectory was calculated based on hepatocyte zonation markers.</p><p>We deconvolved the Visium slides using five variations of the single-cell reference: the entire dataset, the dataset filtered to nine cell types, and each experimental protocol separately (also filtered to nine cell types). The proportions obtained from using the entire dataset was not used to compute evaluation metrics but only to visualize method stability (<xref ref-type="fig" rid="fig6s2">Figure 6—figure supplement 2</xref>). Due to the large size of the reference, we ran some methods differently. We ran stereoscope with 5000 HVGs and subsampled each cell type to a maximum of 250 cells (<italic>-sub</italic>). We gave STRIDE the number of topics to test (<italic>--ntopics 23 33 43 53 63</italic>) instead of the default range that goes up to triple the number of cell types. We ran DestVI with 2500 training epochs and batch size of 128. For Seurat, we ran <italic>FindTransferAnchors</italic> with the ‘rpca’ (reciprocal PCA) option instead of ‘pcaproject’. MuSiC and SpatialDWLS use dense matrices in their code (in contrast to sparse matrices in other methods), resulting in a size limit of 2<sup>31</sup> elements in a matrix. Whenever this is exceeded, we downsampled the reference dataset by keeping maximally 10,000 cells per cell type and keeping 3000 HVGs along with any genes that are at least 10% expressed in a cell type. When a reference with multiple protocols was used, we provided this information to cell2location and Seurat.</p><p>To compute the AUPR, we considered only spots annotated as being in the central or portal zone. We considered the following ground truth for portal vein and central vein ECs:</p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top">Portal vein EC</th><th align="left" valign="top">Central Vein EC</th></tr></thead><tbody><tr><td align="left" valign="top">Portal spot</td><td align="char" char="." valign="top">1</td><td align="char" char="." valign="top">0</td></tr><tr><td align="left" valign="top">Central spot</td><td align="char" char="." valign="top">0</td><td align="char" char="." valign="top">1</td></tr></tbody></table></table-wrap><p>For the JSD ground truth, we only retained samples from the snRNA-seq protocol where all nine cell types were present, resulting in four samples (ABU11, ABU13, ABU17, and ABU20). For both the ground truth and predicted proportions, we averaged the abundance of each cell type in per slide or sample. Then, we calculated the pairwise JSD between each of the four slides and four snRNA-seq samples and reported the average JSD. The biological variation was obtained by averaging the pairwise JSD between the snRNA-seq samples.</p></sec><sec id="s4-3-4"><title>Melanoma</title><p>The scRNA-seq and spatial datasets were downloaded from the original study (<xref ref-type="bibr" rid="bib18">Karras et al., 2022</xref>; <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1d</xref>), with the scRNA-seq dataset being the same one used in the silver standard before the split (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1b</xref>). We preprocessed the Visium slides by filtering out spots with fewer than 100 features, as their inclusion led to errors when running marker-based deconvolution methods. This filtering removed 26 spots from the third slide. The blood vessel annotation was provided by the pathologist from the original publication. We ran stereoscope and DestVI with the same parameters as the liver case study due to the size of the reference dataset.</p><p>The Molecular Cartography (MC) dataset consists of two samples, six sections, and 33 regions of interest (ROI). For each ROI, a DAPI-stained image and a text file containing transcript locations are provided. We obtained cell type proportions using an in-house image processing pipeline. First, the image was cleaned by eliminating tiling effects and background debris using BaSic (<xref ref-type="bibr" rid="bib27">Peng et al., 2017</xref>) and scikit-image (<xref ref-type="bibr" rid="bib43">van der Walt et al., 2014</xref>), respectively. Subsequently, DAPI-stained images were segmented, and locations of individual nuclei were obtained using CellPose (<xref ref-type="bibr" rid="bib37">Stringer et al., 2021</xref>). The transcripts of all measured genes were then assigned to their corresponding cells, resulting in the creation of cell-by-gene count matrices. These matrices were normalized based on the size of segmented nuclei and preprocessed in ScanPy (<xref ref-type="bibr" rid="bib47">Wolf et al., 2018</xref>). Specifically, counts were log-transformed, scaled, and genes expressed in fewer than five cells and cells with less than 10 transcripts were filtered out. Leiden clustering (<xref ref-type="bibr" rid="bib41">Traag et al., 2019</xref>) was performed using 17 principal components and 35 neighbors, and cells were annotated using <italic>scanpy.tl.score_genes</italic> with a curated marker gene list. Finally, the counts of each cell type were aggregated across samples to obtain cell type proportions.</p><p>As dendritic cells and melanoma cell states could not be annotated in the MC dataset, we adjusted the predicted proportions from Visium by removing dendritic cells proportions (pDCs and DCs) and recalculating the relative proportions, and aggregating the proportions of the seven malignant cell states.</p></sec></sec><sec id="s4-4"><title>Scalability</title><p>We generated a synthetic dataset with 10,000 spots and 31,053 genes using only the snRNA-seq protocol from the liver atlas. We then used the remaining two protocols (combined) as the reference dataset. Genes of the synthetic dataset were downsampled randomly based on a uniform distribution, while genes of the reference data were downsampled based on marker genes and HVGs. The spots/cells of both datasets were downsampled randomly, and this was done in a stratified manner for the reference dataset.</p></sec><sec id="s4-5"><title>Evaluation metrics and baselines</title><p>The root-mean-squared error between the known and predicted proportions (<inline-formula><mml:math id="inf4"><mml:mi>p</mml:mi></mml:math></inline-formula>) of a spot <inline-formula><mml:math id="inf5"><mml:mi>s</mml:mi></mml:math></inline-formula> for cell type <inline-formula><mml:math id="inf6"><mml:mi>z</mml:mi></mml:math></inline-formula>, in a reference dataset with <inline-formula><mml:math id="inf7"><mml:mi>Z</mml:mi></mml:math></inline-formula> cell types in total, is calculated as<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mspace width="thinmathspace"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:msqrt><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We calculated the JSD and AUPR using the R packages <italic>philentropy</italic> and <italic>precrec</italic>, respectively (<xref ref-type="bibr" rid="bib30">Saito and Rehmsmeier, 2017</xref>; <xref ref-type="bibr" rid="bib12">Drost, 2018</xref>). The JSD is a smoothed and symmetric version of the Kullback-Leibler divergence (KL). It is calculated as<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mi>J</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>K</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mo>+</mml:mo><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>To calculate the AUPR, we binarized the known proportions by considering a cell type to be present in a spot if its proportion is greater than zero, and absent if it is equal to zero. Then, we compute the micro-averaged AUPR by aggregating all cell types together.</p><p>For the silver standards, the RMSE and JSD values across all spots are averaged and used as the representative value for a replicate <inline-formula><mml:math id="inf8"><mml:mi>k</mml:mi></mml:math></inline-formula> for each dataset-abundance pattern combination. In contrast, only one AUPR value is obtained per replicate. Note that the RMSE calculation takes the number of cell types into account and hence should not be compared between datasets.</p><p>We created the performance summary plot using the <italic>funkyheatmap</italic> package in R. To aggregate per data source and per abundance pattern, we calculated the grand mean of each metric across datasets, applied min-max scaling on each metric, and then computed the geometric mean of the scaled metrics (RMSE, AUPR, and JSD for gold and silver standards; AUPR and JSD for liver; and only JSD for melanoma). The aggregation per metric is the arithmetic mean of all datasets evaluated on that metric. Finally, we determined the overall rankings based on the weighted ranks of the following criteria: silver standard, gold standard, liver case study, melanoma case study, rare cell type detection, stability, and runtime. We assigned a weight of 0.5 to each silver standard abundance pattern and a weight of one to the remaining criteria.</p><p>To provide reference values for each metric, we used (1) random proportions based on probabilities drawn from a Dirichlet distribution and (2) predictions from the NNLS algorithm. For the former, we used the <italic>DirichletReg</italic> package (<xref ref-type="bibr" rid="bib26">Maier, 2014</xref>) to generate reference values for all 63 silver standards using the average value across 100 iterations. The dimension of the <inline-formula><mml:math id="inf9"><mml:mi mathvariant="bold-italic">α</mml:mi></mml:math></inline-formula> vector was equal to the number of cell types in the corresponding dataset, and all concentration values were set to one. For the NNLS baseline, we used the Lawson-Hanson NNLS implementation from the <italic>nnls</italic> R package. We solve for <inline-formula><mml:math id="inf10"><mml:mi>β</mml:mi></mml:math></inline-formula> in the equation <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf12"><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:math></inline-formula> the spatial expression matrix and <inline-formula><mml:math id="inf13"><mml:mi mathvariant="bold-italic">X</mml:mi></mml:math></inline-formula> the average gene expression profile per cell type from the scRNA-seq reference. We obtained proportion estimates by dividing each element of <inline-formula><mml:math id="inf14"><mml:mi>β</mml:mi></mml:math></inline-formula> with its total sum.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Software, Methodology, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Supervision, Methodology, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Supervision, Funding acquisition, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>An overview of all datasets used in this study, including the gold standards, silver standards, liver case study, and melanoma case study.</title></caption><media xlink:href="elife-88431-supp1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>An overview of the deconvolution tools benchmarked in this study, including the algorithm and usage information.</title></caption><media xlink:href="elife-88431-supp2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-88431-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All datasets used in this article, including the silver standards, gold standards, and case studies, are available on Zenodo at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.5727613">https://doi.org/10.5281/zenodo.5727613</ext-link>. Original download links and accession numbers of individual studies can be found at <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. The synthspot R package can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/saeyslab/synthspot">https://github.com/saeyslab/synthspot</ext-link>, copy archived at <xref ref-type="bibr" rid="bib5">Browaeys and Sang-aram, 2024</xref>. The Nextflow pipeline along with analysis scripts can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/saeyslab/spotless-benchmark">https://github.com/saeyslab/spotless-benchmark</ext-link>, copy archived at <xref ref-type="bibr" rid="bib31">Sang-aram, 2023</xref>.</p><p>The following dataset was generated:</p><p><element-citation publication-type="data" specific-use="isSupplementedBy" id="dataset1"><person-group person-group-type="author"><name><surname>Sang-aram</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Benchmark datasets for Spotless</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.5727613</pub-id></element-citation></p><p>The following previously published datasets were used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset2"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Allen</surname><given-names>WE</given-names></name><name><surname>Wright</surname><given-names>MA</given-names></name><name><surname>Sylwestrak</surname><given-names>EL</given-names></name><name><surname>Samusik</surname><given-names>N</given-names></name><name><surname>Vesuna</surname><given-names>S</given-names></name><name><surname>Evans</surname><given-names>K</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name><name><surname>Bava</surname><given-names>FA</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Gold standard - STARMap</data-title><source>Dropbox</source><pub-id pub-id-type="accession" xlink:href="https://www.dropbox.com/sh/f7ebheru1lbz91s/AACIAqjvDv--mhnE-PmSXB41a/visual_1020?dl=0">visual_1020</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset3"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Graybuck</surname><given-names>LT</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Garren</surname><given-names>E</given-names></name><name><surname>Economo</surname><given-names>MN</given-names></name><name><surname>Viswanathan</surname><given-names>S</given-names></name><name><surname>Penn</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Shared and distinct transcriptomic cell types across neocortical areas</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115746">GSE115746</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset4"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>A</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Goldman</surname><given-names>M</given-names></name><name><surname>Krienen</surname><given-names>FM</given-names></name><name><surname>de Rivera</surname><given-names>H</given-names></name><name><surname>Bien</surname><given-names>E</given-names></name><name><surname>Baum</surname><given-names>M</given-names></name><name><surname>Bortolin</surname><given-names>L</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Goeva</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>A Single-Cell Atlas of Cell Types, States, and Other Transcriptional Patterns from Nine Regions of the Adult Mouse Brain</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE116470">GSE116470</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset5"><person-group person-group-type="author"><name><surname>Kozareva</surname><given-names>V</given-names></name><name><surname>Martin</surname><given-names>C</given-names></name><name><surname>Osorno</surname><given-names>T</given-names></name><name><surname>Rudolph</surname><given-names>S</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Vanderburg</surname><given-names>C</given-names></name><name><surname>Nadaf</surname><given-names>N</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Regehr</surname><given-names>WG</given-names></name><name><surname>Macosko</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>A transcriptomic atlas of mouse cerebellar cortex reveals novel cell types</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE165371">GSE165371</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset6"><person-group person-group-type="author"><name><surname>Zeisel</surname><given-names>A</given-names></name><name><surname>Hochgerner</surname><given-names>H</given-names></name><name><surname>Lönnerberg</surname><given-names>P</given-names></name><name><surname>Johnsson</surname><given-names>A</given-names></name><name><surname>Memic</surname><given-names>F</given-names></name><name><surname>Van Der Zwan</surname><given-names>J</given-names></name><name><surname>Häring</surname><given-names>M</given-names></name><name><surname>Braun</surname><given-names>E</given-names></name><name><surname>Borm</surname><given-names>LE</given-names></name><name><surname>La Manno</surname><given-names>G</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Silver standard - mouse hippocampus</data-title><source>Linarsson Lab Mouse Brain Atlas</source><pub-id pub-id-type="accession" xlink:href="http://mousebrain.org/adolescent/downloads.html">adolescent</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset7"><person-group person-group-type="author"><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Shrestha</surname><given-names>R</given-names></name><name><surname>Qiu</surname><given-names>C</given-names></name><name><surname>Kondo</surname><given-names>A</given-names></name><name><surname>Huang</surname><given-names>S</given-names></name><name><surname>Werth</surname><given-names>M</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Barasch</surname><given-names>J</given-names></name><name><surname>Suszták</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>Comprehensive single cell RNAseq analysis of the kidney reveals novel cell types and unexpected cell plasticity</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE107585">GSE107585</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset8"><person-group person-group-type="author"><name><surname>Karras</surname><given-names>P</given-names></name><name><surname>Bordeu</surname><given-names>I</given-names></name><name><surname>Pozniak</surname><given-names>J</given-names></name><name><surname>Nowosad</surname><given-names>A</given-names></name><name><surname>Pazzi</surname><given-names>C</given-names></name><name><surname>Van Raemdonck</surname><given-names>N</given-names></name><name><surname>Landeloos</surname><given-names>E</given-names></name><name><surname>Van Herck</surname><given-names>Y</given-names></name><name><surname>Pedri</surname><given-names>D</given-names></name><name><surname>Bervoets</surname><given-names>G</given-names></name><name><surname>Makhzami</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>A cellular hierarchy in melanoma uncouples growth and metastasis</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE207592">GSE207592</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset9"><person-group person-group-type="author"><name><surname>Ji</surname><given-names>AL</given-names></name><name><surname>Rubin</surname><given-names>AJ</given-names></name><name><surname>Thrane</surname><given-names>K</given-names></name><name><surname>Jiang</surname><given-names>S</given-names></name><name><surname>Reynolds</surname><given-names>DL</given-names></name><name><surname>Meyers</surname><given-names>RM</given-names></name><name><surname>Guo</surname><given-names>MG</given-names></name><name><surname>George</surname><given-names>BM</given-names></name><name><surname>Mollbrink</surname><given-names>A</given-names></name><name><surname>Bergenstråhle</surname><given-names>J</given-names></name><name><surname>Larsson</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Single Cell and Spatial Analysis of Human Squamous Cell Carcinoma [single-cell RNA-seq]</data-title><source>NCBI Gene Expression Omnibus</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE144236">GSE144236</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset10"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Van Velthoven</surname><given-names>CT</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Sedeno-Cortes</surname><given-names>AE</given-names></name><name><surname>Baftizadeh</surname><given-names>F</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Chiang</surname><given-names>M</given-names></name><name><surname>Crichton</surname><given-names>K</given-names></name><name><surname>Ding</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Stability analysis - mouse brain cortex</data-title><source>Allen Brain Atlas</source><pub-id pub-id-type="accession" xlink:href="https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x">Mouse-whole-cortex-and-hippocampus-10x</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset11"><person-group person-group-type="author"><name><surname>Guilliams</surname><given-names>M</given-names></name><name><surname>Bonnardel</surname><given-names>J</given-names></name><name><surname>Haest</surname><given-names>B</given-names></name><name><surname>Vanderborght</surname><given-names>B</given-names></name><name><surname>Wagner</surname><given-names>C</given-names></name><name><surname>Remmerie</surname><given-names>A</given-names></name><name><surname>Bujko</surname><given-names>A</given-names></name><name><surname>Martens</surname><given-names>L</given-names></name><name><surname>Thoné</surname><given-names>T</given-names></name><name><surname>Browaeys</surname><given-names>R</given-names></name><name><surname>De Ponti</surname><given-names>FF</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Case study - mouse liver</data-title><source>Scott Lab &amp; Guilliams Lab Liver Cell Atlas</source><pub-id pub-id-type="accession" xlink:href="https://www.livercellatlas.org/download.php">Mouse-StSt</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset12"><person-group person-group-type="author"><name><surname>Karras</surname><given-names>P</given-names></name><name><surname>Bordeu</surname><given-names>I</given-names></name><name><surname>Pozniak</surname><given-names>J</given-names></name><name><surname>Nowosad</surname><given-names>A</given-names></name><name><surname>Pazzi</surname><given-names>C</given-names></name><name><surname>Van Raemdonck</surname><given-names>N</given-names></name><name><surname>Landeloos</surname><given-names>E</given-names></name><name><surname>Van Herck</surname><given-names>Y</given-names></name><name><surname>Pedri</surname><given-names>D</given-names></name><name><surname>Bervoets</surname><given-names>G</given-names></name><name><surname>Makhzami</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>Case study - mouse melanoma (10x Visium)</data-title><source>Google Drive</source><pub-id pub-id-type="accession" xlink:href="https://drive.google.com/drive/folders/1poq4Lo5AxVp0WpG1EMgIjIeDR4q98zcA">1poq4Lo5AxVp0WpG1EMgIjIeDR4q98zcA</pub-id></element-citation></p><p><element-citation publication-type="data" specific-use="references" id="dataset13"><person-group person-group-type="author"><name><surname>Karras</surname><given-names>P</given-names></name><name><surname>Bordeu</surname><given-names>I</given-names></name><name><surname>Pozniak</surname><given-names>J</given-names></name><name><surname>Nowosad</surname><given-names>A</given-names></name><name><surname>Pazzi</surname><given-names>C</given-names></name><name><surname>Van Raemdonck</surname><given-names>N</given-names></name><name><surname>Landeloos</surname><given-names>E</given-names></name><name><surname>Van Herck</surname><given-names>Y</given-names></name><name><surname>Pedri</surname><given-names>D</given-names></name><name><surname>Bervoets</surname><given-names>G</given-names></name><name><surname>Makhzami</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2022">2022</year><data-title>A cellular hierarchy in melanoma uncouples growth and metastasis</data-title><source>Zenodo</source><pub-id pub-id-type="doi">10.5281/zenodo.6856193</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank all the authors of the methods who provided valuable feedback on how to optimally run their algorithms. Their input has been crucial in enabling us to compare the methods in a fair manner. We thank Lotte Pollaris for processing the Molecular Cartography dataset. CS is funded by the Ghent University Special Research Fund [grant number BOF21-DOC-105], RB is funded by The Research Foundation – Flanders [grant number 1181318 N], RS is funded by the Flemish Government under the Flanders AI Research Program, and YS is funded by Ghent University Special Research Fund [grant number BOF18-GOA-024], and The Research Foundation – Flanders [Excellence of Science (EOS) program and SBO project, grant number S001121N].</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ali</surname><given-names>HR</given-names></name><name><surname>Chlon</surname><given-names>L</given-names></name><name><surname>Pharoah</surname><given-names>PDP</given-names></name><name><surname>Markowetz</surname><given-names>F</given-names></name><name><surname>Caldas</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Patterns of immune infiltration in breast cancer and their clinical implications: A gene-expression-based retrospective study</article-title><source>PLOS Medicine</source><volume>13</volume><elocation-id>e1002194</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pmed.1002194</pub-id><pub-id pub-id-type="pmid">27959923</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andersson</surname><given-names>A</given-names></name><name><surname>Bergenstråhle</surname><given-names>J</given-names></name><name><surname>Asp</surname><given-names>M</given-names></name><name><surname>Bergenstråhle</surname><given-names>L</given-names></name><name><surname>Jurek</surname><given-names>A</given-names></name><name><surname>Fernández Navarro</surname><given-names>J</given-names></name><name><surname>Lundeberg</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Single-cell and spatial transcriptomics enables probabilistic inference of cell type topography</article-title><source>Communications Biology</source><volume>3</volume><elocation-id>565</elocation-id><pub-id pub-id-type="doi">10.1038/s42003-020-01247-y</pub-id><pub-id pub-id-type="pmid">33037292</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Asp</surname><given-names>M</given-names></name><name><surname>Bergenstråhle</surname><given-names>J</given-names></name><name><surname>Lundeberg</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Spatially resolved transcriptomes-next generation tools for tissue exploration</article-title><source>BioEssays</source><volume>42</volume><elocation-id>e1900221</elocation-id><pub-id pub-id-type="doi">10.1002/bies.201900221</pub-id><pub-id pub-id-type="pmid">32363691</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Biancalani</surname><given-names>T</given-names></name><name><surname>Scalia</surname><given-names>G</given-names></name><name><surname>Buffoni</surname><given-names>L</given-names></name><name><surname>Avasthi</surname><given-names>R</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Sanger</surname><given-names>A</given-names></name><name><surname>Tokcan</surname><given-names>N</given-names></name><name><surname>Vanderburg</surname><given-names>CR</given-names></name><name><surname>Segerstolpe</surname><given-names>Å</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Avraham-Davidi</surname><given-names>I</given-names></name><name><surname>Vickovic</surname><given-names>S</given-names></name><name><surname>Nitzan</surname><given-names>M</given-names></name><name><surname>Ma</surname><given-names>S</given-names></name><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Lipinski</surname><given-names>M</given-names></name><name><surname>Buenrostro</surname><given-names>J</given-names></name><name><surname>Brown</surname><given-names>NB</given-names></name><name><surname>Fanelli</surname><given-names>D</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Deep learning and alignment of spatially resolved single-cell transcriptomes with Tangram</article-title><source>Nature Methods</source><volume>18</volume><fpage>1352</fpage><lpage>1362</lpage><pub-id pub-id-type="doi">10.1038/s41592-021-01264-7</pub-id><pub-id pub-id-type="pmid">34711971</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Browaeys</surname><given-names>R</given-names></name><name><surname>Sang-aram</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Synthspot</data-title><version designator="swh:1:rev:72df76f823f7fd60ad91a1afcf55f5bd7dfebe14">swh:1:rev:72df76f823f7fd60ad91a1afcf55f5bd7dfebe14</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:21f1a0307d3e3e548198f54b91b78db000d205b0;origin=https://github.com/saeyslab/synthspot;visit=swh:1:snp:eec161d2cb85b6a1048298928ef75b41dbcd62ad;anchor=swh:1:rev:72df76f823f7fd60ad91a1afcf55f5bd7dfebe14">https://archive.softwareheritage.org/swh:1:dir:21f1a0307d3e3e548198f54b91b78db000d205b0;origin=https://github.com/saeyslab/synthspot;visit=swh:1:snp:eec161d2cb85b6a1048298928ef75b41dbcd62ad;anchor=swh:1:rev:72df76f823f7fd60ad91a1afcf55f5bd7dfebe14</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cable</surname><given-names>DM</given-names></name><name><surname>Murray</surname><given-names>E</given-names></name><name><surname>Zou</surname><given-names>LS</given-names></name><name><surname>Goeva</surname><given-names>A</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Robust decomposition of cell type mixtures in spatial transcriptomics</article-title><source>Nature Biotechnology</source><volume>40</volume><fpage>517</fpage><lpage>526</lpage><pub-id pub-id-type="doi">10.1038/s41587-021-00830-w</pub-id><pub-id pub-id-type="pmid">33603203</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>A</given-names></name><name><surname>Liao</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>M</given-names></name><name><surname>Ma</surname><given-names>K</given-names></name><name><surname>Wu</surname><given-names>L</given-names></name><name><surname>Lai</surname><given-names>Y</given-names></name><name><surname>Qiu</surname><given-names>X</given-names></name><name><surname>Yang</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Hao</surname><given-names>S</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Huang</surname><given-names>X</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Hong</surname><given-names>Y</given-names></name><name><surname>Jiang</surname><given-names>Y</given-names></name><name><surname>Peng</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Shen</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Yuan</surname><given-names>Y</given-names></name><name><surname>Wei</surname><given-names>X</given-names></name><name><surname>Zheng</surname><given-names>H</given-names></name><name><surname>Feng</surname><given-names>W</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Yang</surname><given-names>Y</given-names></name><name><surname>Xiang</surname><given-names>H</given-names></name><name><surname>Han</surname><given-names>L</given-names></name><name><surname>Qin</surname><given-names>B</given-names></name><name><surname>Guo</surname><given-names>P</given-names></name><name><surname>Lai</surname><given-names>G</given-names></name><name><surname>Muñoz-Cánoves</surname><given-names>P</given-names></name><name><surname>Maxwell</surname><given-names>PH</given-names></name><name><surname>Thiery</surname><given-names>JP</given-names></name><name><surname>Wu</surname><given-names>Q-F</given-names></name><name><surname>Zhao</surname><given-names>F</given-names></name><name><surname>Chen</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Dai</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name><name><surname>Kuang</surname><given-names>H</given-names></name><name><surname>Hui</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Fei</surname><given-names>J-F</given-names></name><name><surname>Wang</surname><given-names>O</given-names></name><name><surname>Wei</surname><given-names>X</given-names></name><name><surname>Lu</surname><given-names>H</given-names></name><name><surname>Wang</surname><given-names>B</given-names></name><name><surname>Liu</surname><given-names>S</given-names></name><name><surname>Gu</surname><given-names>Y</given-names></name><name><surname>Ni</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Mu</surname><given-names>F</given-names></name><name><surname>Yin</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Lisby</surname><given-names>M</given-names></name><name><surname>Cornall</surname><given-names>RJ</given-names></name><name><surname>Mulder</surname><given-names>J</given-names></name><name><surname>Uhlén</surname><given-names>M</given-names></name><name><surname>Esteban</surname><given-names>MA</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>L</given-names></name><name><surname>Xu</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Spatiotemporal transcriptomic atlas of mouse organogenesis using DNA nanoball-patterned arrays</article-title><source>Cell</source><volume>185</volume><fpage>1777</fpage><lpage>1792</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2022.04.003</pub-id><pub-id pub-id-type="pmid">35512705</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>C-S</given-names></name><name><surname>Xi</surname><given-names>J</given-names></name><name><surname>Si</surname><given-names>Y</given-names></name><name><surname>Park</surname><given-names>S-R</given-names></name><name><surname>Hsu</surname><given-names>J-E</given-names></name><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Jun</surname><given-names>G</given-names></name><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Lee</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Microscopic examination of spatial transcriptome using Seq-Scope</article-title><source>Cell</source><volume>184</volume><fpage>3559</fpage><lpage>3572</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.05.010</pub-id><pub-id pub-id-type="pmid">34115981</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Davis</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The relationship between Precision-Recall and ROC curves</article-title><conf-name>the 23rd international conference</conf-name><fpage>233</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1145/1143844.1143874</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Tommaso</surname><given-names>P</given-names></name><name><surname>Chatzou</surname><given-names>M</given-names></name><name><surname>Floden</surname><given-names>EW</given-names></name><name><surname>Barja</surname><given-names>PP</given-names></name><name><surname>Palumbo</surname><given-names>E</given-names></name><name><surname>Notredame</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Nextflow enables reproducible computational workflows</article-title><source>Nature Biotechnology</source><volume>35</volume><fpage>316</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id><pub-id pub-id-type="pmid">28398311</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dong</surname><given-names>R</given-names></name><name><surname>Yuan</surname><given-names>GC</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>SpatialDWLS: accurate deconvolution of spatial transcriptomic data</article-title><source>Genome Biology</source><volume>22</volume><elocation-id>145</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-021-02362-7</pub-id><pub-id pub-id-type="pmid">33971932</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Drost</surname><given-names>HG</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Philentropy: information theory and distance quantification with R</article-title><source>Journal of Open Source Software</source><volume>3</volume><elocation-id>765</elocation-id><pub-id pub-id-type="doi">10.21105/joss.00765</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elosua-Bayes</surname><given-names>M</given-names></name><name><surname>Nieto</surname><given-names>P</given-names></name><name><surname>Mereu</surname><given-names>E</given-names></name><name><surname>Gut</surname><given-names>I</given-names></name><name><surname>Heyn</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title><source>Nucleic Acids Research</source><volume>49</volume><elocation-id>e50</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkab043</pub-id><pub-id pub-id-type="pmid">33544846</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eng</surname><given-names>C-HL</given-names></name><name><surname>Lawson</surname><given-names>M</given-names></name><name><surname>Zhu</surname><given-names>Q</given-names></name><name><surname>Dries</surname><given-names>R</given-names></name><name><surname>Koulena</surname><given-names>N</given-names></name><name><surname>Takei</surname><given-names>Y</given-names></name><name><surname>Yun</surname><given-names>J</given-names></name><name><surname>Cronin</surname><given-names>C</given-names></name><name><surname>Karp</surname><given-names>C</given-names></name><name><surname>Yuan</surname><given-names>G-C</given-names></name><name><surname>Cai</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</article-title><source>Nature</source><volume>568</volume><fpage>235</fpage><lpage>239</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id><pub-id pub-id-type="pmid">30911168</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Doyle</surname><given-names>M</given-names></name><name><surname>Ozcoban</surname><given-names>V</given-names></name><name><surname>Bass</surname><given-names>GT</given-names></name><name><surname>Pizzolla</surname><given-names>A</given-names></name><name><surname>Cain</surname><given-names>L</given-names></name><name><surname>Weng</surname><given-names>S</given-names></name><name><surname>Pasam</surname><given-names>A</given-names></name><name><surname>Kocovski</surname><given-names>N</given-names></name><name><surname>Huang</surname><given-names>Y-K</given-names></name><name><surname>Keam</surname><given-names>SP</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name><name><surname>Neeson</surname><given-names>PJ</given-names></name><name><surname>Pearson</surname><given-names>RB</given-names></name><name><surname>Sandhu</surname><given-names>S</given-names></name><name><surname>Goode</surname><given-names>DL</given-names></name><name><surname>Trigos</surname><given-names>AS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Spatial analysis with SPIAT and spaSim to characterize and simulate tissue microenvironments</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>2697</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-37822-0</pub-id><pub-id pub-id-type="pmid">37188662</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guilliams</surname><given-names>M</given-names></name><name><surname>Bonnardel</surname><given-names>J</given-names></name><name><surname>Haest</surname><given-names>B</given-names></name><name><surname>Vanderborght</surname><given-names>B</given-names></name><name><surname>Wagner</surname><given-names>C</given-names></name><name><surname>Remmerie</surname><given-names>A</given-names></name><name><surname>Bujko</surname><given-names>A</given-names></name><name><surname>Martens</surname><given-names>L</given-names></name><name><surname>Thoné</surname><given-names>T</given-names></name><name><surname>Browaeys</surname><given-names>R</given-names></name><name><surname>De Ponti</surname><given-names>FF</given-names></name><name><surname>Vanneste</surname><given-names>B</given-names></name><name><surname>Zwicker</surname><given-names>C</given-names></name><name><surname>Svedberg</surname><given-names>FR</given-names></name><name><surname>Vanhalewyn</surname><given-names>T</given-names></name><name><surname>Gonçalves</surname><given-names>A</given-names></name><name><surname>Lippens</surname><given-names>S</given-names></name><name><surname>Devriendt</surname><given-names>B</given-names></name><name><surname>Cox</surname><given-names>E</given-names></name><name><surname>Ferrero</surname><given-names>G</given-names></name><name><surname>Wittamer</surname><given-names>V</given-names></name><name><surname>Willaert</surname><given-names>A</given-names></name><name><surname>Kaptein</surname><given-names>SJF</given-names></name><name><surname>Neyts</surname><given-names>J</given-names></name><name><surname>Dallmeier</surname><given-names>K</given-names></name><name><surname>Geldhof</surname><given-names>P</given-names></name><name><surname>Casaert</surname><given-names>S</given-names></name><name><surname>Deplancke</surname><given-names>B</given-names></name><name><surname>Ten Dijke</surname><given-names>P</given-names></name><name><surname>Hoorens</surname><given-names>A</given-names></name><name><surname>Vanlander</surname><given-names>A</given-names></name><name><surname>Berrevoet</surname><given-names>F</given-names></name><name><surname>Van Nieuwenhove</surname><given-names>Y</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Saelens</surname><given-names>W</given-names></name><name><surname>Van Vlierberghe</surname><given-names>H</given-names></name><name><surname>Devisscher</surname><given-names>L</given-names></name><name><surname>Scott</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Spatial proteogenomics reveals distinct and evolutionarily conserved hepatic macrophage niches</article-title><source>Cell</source><volume>185</volume><fpage>379</fpage><lpage>396</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.12.018</pub-id><pub-id pub-id-type="pmid">35021063</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jindal</surname><given-names>A</given-names></name><name><surname>Gupta</surname><given-names>P</given-names></name><name><surname>Sengupta</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Discovery of rare cells from voluminous single cell expression data</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4719</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-07234-6</pub-id><pub-id pub-id-type="pmid">30413715</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Karras</surname><given-names>P</given-names></name><name><surname>Bordeu</surname><given-names>I</given-names></name><name><surname>Pozniak</surname><given-names>J</given-names></name><name><surname>Nowosad</surname><given-names>A</given-names></name><name><surname>Pazzi</surname><given-names>C</given-names></name><name><surname>Van Raemdonck</surname><given-names>N</given-names></name><name><surname>Landeloos</surname><given-names>E</given-names></name><name><surname>Van Herck</surname><given-names>Y</given-names></name><name><surname>Pedri</surname><given-names>D</given-names></name><name><surname>Bervoets</surname><given-names>G</given-names></name><name><surname>Makhzami</surname><given-names>S</given-names></name><name><surname>Khoo</surname><given-names>JH</given-names></name><name><surname>Pavie</surname><given-names>B</given-names></name><name><surname>Lamote</surname><given-names>J</given-names></name><name><surname>Marin-Bejar</surname><given-names>O</given-names></name><name><surname>Dewaele</surname><given-names>M</given-names></name><name><surname>Liang</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Hua</surname><given-names>Y</given-names></name><name><surname>Wouters</surname><given-names>J</given-names></name><name><surname>Browaeys</surname><given-names>R</given-names></name><name><surname>Bergers</surname><given-names>G</given-names></name><name><surname>Saeys</surname><given-names>Y</given-names></name><name><surname>Bosisio</surname><given-names>F</given-names></name><name><surname>van den Oord</surname><given-names>J</given-names></name><name><surname>Lambrechts</surname><given-names>D</given-names></name><name><surname>Rustgi</surname><given-names>AK</given-names></name><name><surname>Bechter</surname><given-names>O</given-names></name><name><surname>Blanpain</surname><given-names>C</given-names></name><name><surname>Simons</surname><given-names>BD</given-names></name><name><surname>Rambow</surname><given-names>F</given-names></name><name><surname>Marine</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>A cellular hierarchy in melanoma uncouples growth and metastasis</article-title><source>Nature</source><volume>610</volume><fpage>190</fpage><lpage>198</lpage><pub-id pub-id-type="doi">10.1038/s41586-022-05242-7</pub-id><pub-id pub-id-type="pmid">36131018</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kleshchevnikov</surname><given-names>V</given-names></name><name><surname>Shmatko</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Comprehensive Mapping of Tissue Cell Architecture via Integrated Single Cell and Spatial Transcriptomics</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.15.378125</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Guo</surname><given-names>C</given-names></name><name><surname>Xu</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Fang</surname><given-names>M</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name><name><surname>Yao</surname><given-names>X</given-names></name><name><surname>Tang</surname><given-names>M</given-names></name><name><surname>Liu</surname><given-names>K</given-names></name><name><surname>Zhao</surname><given-names>X</given-names></name><name><surname>Lin</surname><given-names>J</given-names></name><name><surname>Cheng</surname><given-names>L</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Xue</surname><given-names>T</given-names></name><name><surname>Qu</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Benchmarking spatial and single-cell transcriptomics integration methods for transcript distribution prediction and cell type deconvolution</article-title><source>Nature Methods</source><volume>19</volume><fpage>662</fpage><lpage>670</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01480-9</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Squires</surname><given-names>M</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2023">2023a</year><article-title>scMultiSim: Simulation of Multi-Modality Single Cell Data Guided by Cell-Cell Interactions and Gene Regulatory Networks</article-title><source>Research Square</source><pub-id pub-id-type="doi">10.21203/rs.3.rs-2675530/v1</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Chen</surname><given-names>S</given-names></name><name><surname>Liao</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Zhang</surname><given-names>R</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Sun</surname><given-names>S</given-names></name><name><surname>Gao</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2023">2023b</year><article-title>A comprehensive benchmarking with practical guidelines for cellular deconvolution of spatial transcriptomics</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>1548</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-37168-7</pub-id><pub-id pub-id-type="pmid">36941264</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Longo</surname><given-names>SK</given-names></name><name><surname>Guo</surname><given-names>MG</given-names></name><name><surname>Ji</surname><given-names>AL</given-names></name><name><surname>Khavari</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Integrating single-cell and spatial transcriptomics to elucidate intercellular tissue dynamics</article-title><source>Nature Reviews. Genetics</source><volume>22</volume><fpage>627</fpage><lpage>644</lpage><pub-id pub-id-type="doi">10.1038/s41576-021-00370-8</pub-id><pub-id pub-id-type="pmid">34145435</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lopez</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Keren-Shaul</surname><given-names>H</given-names></name><name><surname>Boyeau</surname><given-names>P</given-names></name><name><surname>Kedmi</surname><given-names>M</given-names></name><name><surname>Pilzer</surname><given-names>D</given-names></name><name><surname>Jelinski</surname><given-names>A</given-names></name><name><surname>Yofe</surname><given-names>I</given-names></name><name><surname>David</surname><given-names>E</given-names></name><name><surname>Wagner</surname><given-names>A</given-names></name><name><surname>Ergen</surname><given-names>C</given-names></name><name><surname>Addadi</surname><given-names>Y</given-names></name><name><surname>Golani</surname><given-names>O</given-names></name><name><surname>Ronchese</surname><given-names>F</given-names></name><name><surname>Jordan</surname><given-names>MI</given-names></name><name><surname>Amit</surname><given-names>I</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>DestVI identifies continuums of cell types in spatial transcriptomics data</article-title><source>Nature Biotechnology</source><volume>40</volume><fpage>1360</fpage><lpage>1369</lpage><pub-id pub-id-type="doi">10.1038/s41587-022-01272-8</pub-id><pub-id pub-id-type="pmid">35449415</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>ATL</given-names></name><name><surname>Riesenfeld</surname><given-names>S</given-names></name><name><surname>Andrews</surname><given-names>T</given-names></name><name><surname>Dao</surname><given-names>TP</given-names></name><name><surname>Gomes</surname><given-names>T</given-names></name><collab>participants in the 1st Human Cell Atlas Jamboree</collab><name><surname>Marioni</surname><given-names>JC</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>EmptyDrops: distinguishing cells from empty droplets in droplet-based single-cell RNA sequencing data</article-title><source>Genome Biology</source><volume>20</volume><elocation-id>63</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-019-1662-y</pub-id><pub-id pub-id-type="pmid">30902100</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maier</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2014">2014</year><source>DirichletReg: Dirichlet Regression for Compositional Data in R</source><publisher-name>Wirtschaftsuniversität Wien</publisher-name><pub-id pub-id-type="doi">10.57938/ad3142d3-2fcd-4c37-aec6-8e0bd7d077e1</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>T</given-names></name><name><surname>Thorn</surname><given-names>K</given-names></name><name><surname>Schroeder</surname><given-names>T</given-names></name><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name><name><surname>Marr</surname><given-names>C</given-names></name><name><surname>Navab</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A BaSiC tool for background and shading correction of optical microscopy images</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>14836</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms14836</pub-id><pub-id pub-id-type="pmid">28594001</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rodriques</surname><given-names>SG</given-names></name><name><surname>Stickels</surname><given-names>RR</given-names></name><name><surname>Goeva</surname><given-names>A</given-names></name><name><surname>Martin</surname><given-names>CA</given-names></name><name><surname>Murray</surname><given-names>E</given-names></name><name><surname>Vanderburg</surname><given-names>CR</given-names></name><name><surname>Welch</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>LM</given-names></name><name><surname>Chen</surname><given-names>F</given-names></name><name><surname>Macosko</surname><given-names>EZ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Slide-seq: A scalable technology for measuring genome-wide expression at high spatial resolution</article-title><source>Science</source><volume>363</volume><fpage>1463</fpage><lpage>1467</lpage><pub-id pub-id-type="doi">10.1126/science.aaw1219</pub-id><pub-id pub-id-type="pmid">30923225</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rossi</surname><given-names>ND</given-names></name><name><surname>Chen</surname><given-names>JG</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Analyzing spatial transcriptomics data using giotto</article-title><source>Current Protocols</source><volume>2</volume><elocation-id>e405</elocation-id><pub-id pub-id-type="doi">10.1002/cpz1.405</pub-id><pub-id pub-id-type="pmid">35384407</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saito</surname><given-names>T</given-names></name><name><surname>Rehmsmeier</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Precrec: fast and accurate precision-recall and ROC curve calculations in R</article-title><source>Bioinformatics</source><volume>33</volume><fpage>145</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw570</pub-id><pub-id pub-id-type="pmid">27591081</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Sang-aram</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Spotless-benchmark</data-title><version designator="swh:1:rev:b6c3a9a47f8f6586fb495ff051f5fba35057ca25">swh:1:rev:b6c3a9a47f8f6586fb495ff051f5fba35057ca25</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:e35f7ed0519fca5557d49e8cde7a1b50029c146b;origin=https://github.com/saeyslab/spotless-benchmark;visit=swh:1:snp:51e34cc80c889ef7556b962231cbca54db105410;anchor=swh:1:rev:b6c3a9a47f8f6586fb495ff051f5fba35057ca25">https://archive.softwareheritage.org/swh:1:dir:e35f7ed0519fca5557d49e8cde7a1b50029c146b;origin=https://github.com/saeyslab/spotless-benchmark;visit=swh:1:snp:51e34cc80c889ef7556b962231cbca54db105410;anchor=swh:1:rev:b6c3a9a47f8f6586fb495ff051f5fba35057ca25</ext-link></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>E</given-names></name><name><surname>Olson</surname><given-names>SH</given-names></name><name><surname>Ahn</surname><given-names>J</given-names></name><name><surname>Bundy</surname><given-names>B</given-names></name><name><surname>Nishikawa</surname><given-names>H</given-names></name><name><surname>Qian</surname><given-names>F</given-names></name><name><surname>Jungbluth</surname><given-names>AA</given-names></name><name><surname>Frosina</surname><given-names>D</given-names></name><name><surname>Gnjatic</surname><given-names>S</given-names></name><name><surname>Ambrosone</surname><given-names>C</given-names></name><name><surname>Kepner</surname><given-names>J</given-names></name><name><surname>Odunsi</surname><given-names>T</given-names></name><name><surname>Ritter</surname><given-names>G</given-names></name><name><surname>Lele</surname><given-names>S</given-names></name><name><surname>Chen</surname><given-names>YT</given-names></name><name><surname>Ohtani</surname><given-names>H</given-names></name><name><surname>Old</surname><given-names>LJ</given-names></name><name><surname>Odunsi</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Intraepithelial CD8+ tumor-infiltrating lymphocytes and a high CD8+/regulatory T cell ratio are associated with favorable prognosis in ovarian cancer</article-title><source>PNAS</source><volume>102</volume><fpage>18538</fpage><lpage>18543</lpage><pub-id pub-id-type="doi">10.1073/pnas.0509182102</pub-id><pub-id pub-id-type="pmid">16344461</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Towards unified quality verification of synthetic count data with countsimQC</article-title><source>Bioinformatics</source><volume>34</volume><fpage>691</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btx631</pub-id><pub-id pub-id-type="pmid">29028961</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Q</given-names></name><name><surname>Su</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>DSTG: deconvoluting spatial transcriptomics data through graph-based artificial intelligence</article-title><source>Briefings in Bioinformatics</source><volume>22</volume><elocation-id>bbaa414</elocation-id><pub-id pub-id-type="doi">10.1093/bib/bbaa414</pub-id><pub-id pub-id-type="pmid">33480403</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2024">2024</year><article-title>scDesign3 generates realistic in silico data for multimodal single-cell and spatial omics</article-title><source>Nature Biotechnology</source><volume>42</volume><fpage>247</fpage><lpage>252</lpage><pub-id pub-id-type="doi">10.1038/s41587-023-01772-1</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ståhl</surname><given-names>PL</given-names></name><name><surname>Salmén</surname><given-names>F</given-names></name><name><surname>Vickovic</surname><given-names>S</given-names></name><name><surname>Lundmark</surname><given-names>A</given-names></name><name><surname>Navarro</surname><given-names>JF</given-names></name><name><surname>Magnusson</surname><given-names>J</given-names></name><name><surname>Giacomello</surname><given-names>S</given-names></name><name><surname>Asp</surname><given-names>M</given-names></name><name><surname>Westholm</surname><given-names>JO</given-names></name><name><surname>Huss</surname><given-names>M</given-names></name><name><surname>Mollbrink</surname><given-names>A</given-names></name><name><surname>Linnarsson</surname><given-names>S</given-names></name><name><surname>Codeluppi</surname><given-names>S</given-names></name><name><surname>Borg</surname><given-names>Å</given-names></name><name><surname>Pontén</surname><given-names>F</given-names></name><name><surname>Costea</surname><given-names>PI</given-names></name><name><surname>Sahlén</surname><given-names>P</given-names></name><name><surname>Mulder</surname><given-names>J</given-names></name><name><surname>Bergmann</surname><given-names>O</given-names></name><name><surname>Lundeberg</surname><given-names>J</given-names></name><name><surname>Frisén</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title><source>Science</source><volume>353</volume><fpage>78</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1126/science.aaf2403</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>C</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Michaelos</surname><given-names>M</given-names></name><name><surname>Pachitariu</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Cellpose: A generalist algorithm for cellular segmentation</article-title><source>Bioinformatics</source><volume>01</volume><elocation-id>931238</elocation-id><pub-id pub-id-type="doi">10.1101/2020.02.02.931238</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T</given-names></name><name><surname>Butler</surname><given-names>A</given-names></name><name><surname>Hoffman</surname><given-names>P</given-names></name><name><surname>Hafemeister</surname><given-names>C</given-names></name><name><surname>Papalexi</surname><given-names>E</given-names></name><name><surname>Mauck</surname><given-names>WM</given-names></name><name><surname>Hao</surname><given-names>Y</given-names></name><name><surname>Stoeckius</surname><given-names>M</given-names></name><name><surname>Smibert</surname><given-names>P</given-names></name><name><surname>Satija</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Comprehensive integration of single-cell data</article-title><source>Cell</source><volume>177</volume><fpage>1888</fpage><lpage>1902</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id><pub-id pub-id-type="pmid">31178118</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>T</given-names></name><name><surname>Wu</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>STRIDE: accurately decomposing and integrating spatial transcriptomics using single-cell RNA sequencing</article-title><source>Nucleic Acids Research</source><volume>50</volume><elocation-id>e42</elocation-id><pub-id pub-id-type="doi">10.1093/nar/gkac150</pub-id><pub-id pub-id-type="pmid">35253896</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Menon</surname><given-names>V</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Kim</surname><given-names>TK</given-names></name><name><surname>Jarsky</surname><given-names>T</given-names></name><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>Levi</surname><given-names>B</given-names></name><name><surname>Gray</surname><given-names>LT</given-names></name><name><surname>Sorensen</surname><given-names>SA</given-names></name><name><surname>Dolbeare</surname><given-names>T</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Shapovalova</surname><given-names>N</given-names></name><name><surname>Parry</surname><given-names>S</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Bernard</surname><given-names>A</given-names></name><name><surname>Madisen</surname><given-names>L</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Hawrylycz</surname><given-names>M</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>335</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1038/nn.4216</pub-id><pub-id pub-id-type="pmid">26727548</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traag</surname><given-names>VA</given-names></name><name><surname>Waltman</surname><given-names>L</given-names></name><name><surname>van Eck</surname><given-names>NJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>5233</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-41695-z</pub-id><pub-id pub-id-type="pmid">30914743</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallania</surname><given-names>F</given-names></name><name><surname>Tam</surname><given-names>A</given-names></name><name><surname>Lofgren</surname><given-names>S</given-names></name><name><surname>Schaffert</surname><given-names>S</given-names></name><name><surname>Azad</surname><given-names>TD</given-names></name><name><surname>Bongen</surname><given-names>E</given-names></name><name><surname>Haynes</surname><given-names>W</given-names></name><name><surname>Alsup</surname><given-names>M</given-names></name><name><surname>Alonso</surname><given-names>M</given-names></name><name><surname>Davis</surname><given-names>M</given-names></name><name><surname>Engleman</surname><given-names>E</given-names></name><name><surname>Khatri</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Leveraging heterogeneity across multiple datasets increases cell-mixture deconvolution accuracy and reduces biological and technical biases</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4735</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-07242-6</pub-id><pub-id pub-id-type="pmid">30413720</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Walt</surname><given-names>S</given-names></name><name><surname>Schönberger</surname><given-names>JL</given-names></name><name><surname>Nunez-Iglesias</surname><given-names>J</given-names></name><name><surname>Boulogne</surname><given-names>F</given-names></name><name><surname>Warner</surname><given-names>JD</given-names></name><name><surname>Yager</surname><given-names>N</given-names></name><name><surname>Gouillart</surname><given-names>E</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><collab>scikit-image contributors</collab></person-group><year iso-8601-date="2014">2014</year><article-title>scikit-image: image processing in Python</article-title><source>PeerJ</source><volume>2</volume><elocation-id>e453</elocation-id><pub-id pub-id-type="doi">10.7717/peerj.453</pub-id><pub-id pub-id-type="pmid">25024921</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>A</given-names></name><name><surname>Regev</surname><given-names>A</given-names></name><name><surname>Yosef</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title><source>Nature Biotechnology</source><volume>34</volume><fpage>1145</fpage><lpage>1160</lpage><pub-id pub-id-type="doi">10.1038/nbt.3711</pub-id><pub-id pub-id-type="pmid">27824854</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Allen</surname><given-names>WE</given-names></name><name><surname>Wright</surname><given-names>MA</given-names></name><name><surname>Sylwestrak</surname><given-names>EL</given-names></name><name><surname>Samusik</surname><given-names>N</given-names></name><name><surname>Vesuna</surname><given-names>S</given-names></name><name><surname>Evans</surname><given-names>K</given-names></name><name><surname>Liu</surname><given-names>C</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>J</given-names></name><name><surname>Nolan</surname><given-names>GP</given-names></name><name><surname>Bava</surname><given-names>FA</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title><source>Science</source><volume>361</volume><elocation-id>eaat5691</elocation-id><pub-id pub-id-type="doi">10.1126/science.aat5691</pub-id><pub-id pub-id-type="pmid">29930089</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Susztak</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>NR</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bulk tissue cell type deconvolution with multi-subject single-cell expression reference</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>380</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-08023-x</pub-id><pub-id pub-id-type="pmid">30670690</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wolf</surname><given-names>FA</given-names></name><name><surname>Angerer</surname><given-names>P</given-names></name><name><surname>Theis</surname><given-names>FJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title><source>Genome Biology</source><volume>19</volume><elocation-id>15</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id><pub-id pub-id-type="pmid">29409532</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xia</surname><given-names>C</given-names></name><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Emanuel</surname><given-names>G</given-names></name><name><surname>Hao</surname><given-names>J</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title><source>PNAS</source><volume>116</volume><fpage>19490</fpage><lpage>19499</lpage><pub-id pub-id-type="doi">10.1073/pnas.1912459116</pub-id><pub-id pub-id-type="pmid">31501331</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>L</given-names></name><name><surname>Sun</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Benchmarking and integration of methods for deconvoluting spatial transcriptomic data</article-title><source>Bioinformatics</source><volume>39</volume><elocation-id>btac805</elocation-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btac805</pub-id><pub-id pub-id-type="pmid">36515467</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yao</surname><given-names>Z</given-names></name><name><surname>van Velthoven</surname><given-names>CTJ</given-names></name><name><surname>Nguyen</surname><given-names>TN</given-names></name><name><surname>Goldy</surname><given-names>J</given-names></name><name><surname>Sedeno-Cortes</surname><given-names>AE</given-names></name><name><surname>Baftizadeh</surname><given-names>F</given-names></name><name><surname>Bertagnolli</surname><given-names>D</given-names></name><name><surname>Casper</surname><given-names>T</given-names></name><name><surname>Chiang</surname><given-names>M</given-names></name><name><surname>Crichton</surname><given-names>K</given-names></name><name><surname>Ding</surname><given-names>SL</given-names></name><name><surname>Fong</surname><given-names>O</given-names></name><name><surname>Garren</surname><given-names>E</given-names></name><name><surname>Glandon</surname><given-names>A</given-names></name><name><surname>Gouwens</surname><given-names>NW</given-names></name><name><surname>Gray</surname><given-names>J</given-names></name><name><surname>Graybuck</surname><given-names>LT</given-names></name><name><surname>Hawrylycz</surname><given-names>MJ</given-names></name><name><surname>Hirschstein</surname><given-names>D</given-names></name><name><surname>Kroll</surname><given-names>M</given-names></name><name><surname>Lathia</surname><given-names>K</given-names></name><name><surname>Lee</surname><given-names>C</given-names></name><name><surname>Levi</surname><given-names>B</given-names></name><name><surname>McMillen</surname><given-names>D</given-names></name><name><surname>Mok</surname><given-names>S</given-names></name><name><surname>Pham</surname><given-names>T</given-names></name><name><surname>Ren</surname><given-names>Q</given-names></name><name><surname>Rimorin</surname><given-names>C</given-names></name><name><surname>Shapovalova</surname><given-names>N</given-names></name><name><surname>Sulc</surname><given-names>J</given-names></name><name><surname>Sunkin</surname><given-names>SM</given-names></name><name><surname>Tieu</surname><given-names>M</given-names></name><name><surname>Torkelson</surname><given-names>A</given-names></name><name><surname>Tung</surname><given-names>H</given-names></name><name><surname>Ward</surname><given-names>K</given-names></name><name><surname>Dee</surname><given-names>N</given-names></name><name><surname>Smith</surname><given-names>KA</given-names></name><name><surname>Tasic</surname><given-names>B</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A taxonomy of transcriptomic cell types across the isocortex and hippocampal formation</article-title><source>Cell</source><volume>184</volume><fpage>3222</fpage><lpage>3241</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.04.021</pub-id><pub-id pub-id-type="pmid">34004146</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>SRTsim: spatial pattern preserving simulations for spatially resolved transcriptomics</article-title><source>Genome Biology</source><volume>24</volume><elocation-id>39</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-023-02879-z</pub-id><pub-id pub-id-type="pmid">36869394</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Description and validation of the simulation procedure</title><p>To generate synthetic spots, <italic>synthspot</italic> by default samples 2–10 cells from input scRNA-seq data. The counts from these cells are then summed up per gene then downsampled using the <italic>downsampleMatrix</italic> function from <italic>DropletUtils</italic> (<xref ref-type="bibr" rid="bib25">Lun et al., 2019</xref>) to be within the given mean and standard deviation (20,000±5000 counts by default). The uniqueness of <italic>synthspot</italic> lies in the variable cell type frequency priors between abundance patterns, which determine the probability that a cell type will be sampled during spot generation. The nine abundance patterns used in our benchmark are made up of three characteristics, (1) the uniformity of each region, the (2) distinctness of cell types within each region, and (3) whether or not there are missing, dominant, or rare cell types (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>). <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> depicts the simulation process in detail. For simplicity purposes, we have excluded the <italic>partially dominant</italic>, <italic>regionally rare</italic>, and <italic>missing cell types</italic> abundance patterns from this flowchart. For the <italic>partially dominant</italic> pattern, we would also randomly select a region the dominant cell type would be absent (cell type prior is then set to zero), and another region where it is as equally abundant as other cell types (prior is sampled from uniform distribution of <xref ref-type="bibr" rid="bib44">Wagner et al., 2016</xref>; <xref ref-type="bibr" rid="bib20">Li et al., 2022</xref>). Similarly, for the <italic>regionally rare</italic> pattern, we would select a select where the rare cell type will only be present in, and then the prior of the rare cell type would be set to zero for all other regions. For the <italic>missing cell types</italic> pattern, we would first randomly select four cell types to be removed. Note that it is also possible for synthspot to use the cell type composition of regionally annotated scRNA-seq data as frequency priors. In that case, it will create the number of regions equal to the scRNA-seq data and use cell type frequencies in the corresponding real region.</p><p>As an example, let us say we want to create a synthetic dataset containing two artificial regions which follow the <italic>dominant cell type</italic> pattern. Consider an input scRNA-seq dataset with eight cell types called A, B, C, …, H. In this case, a dominant cell type is randomly selected which will be present in all regions (=H). Assume that region 1 contains cell types [A, B, C, E, H]. The abundance of H is sampled from a uniform distribution from 75 to 100, while the rest will be sampled from 1 to 10. Suppose we obtain the following priors: H=80, A=1, B=2, C=3, and E=4. The summed abundance is 90, and the cell type frequencies are now: H=0.9, A=0.01, B=0.02, C=0.03 and E=0.04. For all spots generated in region 1, these are the probabilities in which the cell types will be sampled.</p><p>We validated that our synthetic data and its abundance patterns sufficiently matches real Visium data in two ways, comparing the distributions with <italic>countsimQC</italic> (<xref ref-type="bibr" rid="bib33">Soneson, 2018</xref>) and using frequency priors based on real data. We compared synthspot with the algorithms to generate synthetic data used by cell2location, stereoscope, and SPOTlight. We used brain and kidney Visium datasets as the reference, and generated synthetic data using scRNA-seq data from the respective organs. These were the same scRNA-seq datasets used in our silver standard.</p><p>The counts per gene of each dataset seem to be representative of each algorithm’s performance for other metrics, for example expression distribution, dispersion, mean-variance trend, and fraction of zeros (<xref ref-type="fig" rid="app1fig2">Appendix 1—figures 2</xref> and <xref ref-type="fig" rid="app1fig3">3</xref>). For the brain dataset, synthspot has the most resemblance with real data, followed by SPOTlight (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>). Since cell2location and stereoscope did not implement a downsampling step in their simulation, their synthetic brain datasets had overly abundant counts, a result of the plate-based scRNA-seq dataset (SMART-seq). SPOTlight downsamples each spot to have a total UMI count of 20,000, so the count distribution becomes uniform, unlike real data. For the kidney, all algorithms except stereoscope’s were able to generate synthetic data that resembled real data (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). For most measures, cell2location’s algorithm had the most resemblance with real data. Nonetheless, the robustness of synthspot towards sequencing technologies of the input dataset along with the flexibility in fine-tuning properties of the synthetic data makes it the preferred tool to aid in benchmarking. Finally, we verified that the distributions of the nine synthspot abundance patterns did not differ from one another visually or from the <italic>real</italic> abundance pattern, which uses real annotations as the frequency priors (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>).</p><p>As a second verification, we used the regional annotation in the brain cortex dataset with the <italic>real</italic> abundance pattern to generate synthetic data with five brain regions (L1, L2/3, L4, L5, and L6), with each region having the same composition as the real layer. We then compared method performance between the <italic>real</italic> and <italic>diverse overlap</italic> patterns (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>). Although the spot compositions between the patterns are different, method performances are similar, validating that artificial patterns can be used to evaluate model performance.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Schematic of the <italic>synthspot</italic> simulation algorithm.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app1-fig1-v1.tif"/></fig><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Plots comparing the characteristics of real Visium data from mouse brain and synthetic datasets generated from brain scRNA-seq data using different algorithms.</title><p>(<bold>a</bold>) Average abundance values (log counts per million) per gene. (<bold>b</bold>) Association between average abundance and the dispersion. (<bold>c</bold>) Distribution of effective library sizes, or the total count per sample multiplied by the corresponding TMM normalization factor calculated by <italic>edgeR</italic>. (<bold>d–e</bold>) Distribution of pairwise Spearman correlation coefficients for 500 randomly selected spots (<bold>d</bold>) and genes (<bold>e</bold>), calculated from log CPM values. Only non-constant genes are considered. (<bold>f</bold>) Distribution of the fraction of zeros observed per spot. (<bold>g–h</bold>) The association between fraction zeros and average gene abundance (<bold>g</bold>) and total counts per spot (<bold>h</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app1-fig2-v1.tif"/></fig><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Plots comparing the characteristics of real Visium data from mouse kidney and synthetic datasets generated from kidney scRNA-seq data using different algorithms.</title><p>(<bold>a</bold>) Average abundance values (log counts per million) per gene. (<bold>b</bold>) Association between average abundance and the dispersion. (<bold>c</bold>) Distribution of effective library sizes, or the total count per sample multiplied by the corresponding TMM normalization factor calculated by <italic>edgeR</italic>. (<bold>d–e</bold>) Distribution of pairwise Spearman correlation coefficients for 500 randomly selected spots (<bold>d</bold>) and genes (<bold>e</bold>), calculated from log CPM values. Only non-constant genes are considered. (<bold>f</bold>) Distribution of the fraction of zeros observed per spot. (<bold>g–h</bold>) The association between fraction zeros and average gene abundance (<bold>g</bold>) and total counts per spot (<bold>h</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app1-fig3-v1.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Plots comparing the characteristics of real Visium data from mouse brain and the eight synthetic abundance patterns from synthspot generated from brain scRNA-seq data.</title><p>(<bold>a</bold>) Association between average abundance and the dispersion. (<bold>b</bold>) Average abundance values (log counts per million) per gene. (<bold>c</bold>) Distribution of effective library sizes, or the total count per sample multiplied by the corresponding TMM normalization factor calculated by <italic>edgeR</italic>. (<bold>d–e</bold>) Distribution of pairwise Spearman correlation coefficients for 500 randomly selected spots (<bold>d</bold>) and genes (<bold>e</bold>), calculated from log CPM values. Only non-constant genes are considered. (<bold>f</bold>) Distribution of the fraction of zeros observed per spot. (<bold>g–h</bold>) The association between fraction zeros and average gene abundance (<bold>g</bold>) and total counts per spot (<bold>h</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app1-fig4-v1.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Method performance on synthetic data generated from completely synthetic or annotated brain regions.</title><p>When using an <italic>artificial</italic> abundance pattern (<italic>diverse overlap</italic>) to create synthetic spatial data, method rankings remain almost identical as when using a <italic>real</italic> abundance pattern. The <italic>real</italic> pattern uses regional annotations from the scRNA-seq input to create regions with the same cell type frequencies.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app1-fig5-v1.tif"/></fig></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s9"><title>Issues with threshold-based classification metrics</title><p>In addition to the area under the precision-recall curve (AUPR), we initially included the (balanced) accuracy, specificity, recall (sensitivity), precision, and F1 score in the evaluation. These metrics evaluate the classification capabilities of each method, that is the correctness of cell type presence and absence prediction. Briefly, accuracy is the percentage of correctly classified cell types, specificity measures how many of the cell types predicted as absent are truly absent, sensitivity measures how well a method can detect a cell type within a spot, precision measures how many cell types predicted as present are truly present, and the F1 score integrates sensitivity and precision.</p><p>The first issue was that methods that use probabilistic models (e.g. cell2location, stereoscope, RCTD and DestVI) do not return proportions that are exactly zero but instead negligible values as low as 10<sup>–9</sup>. This made an unbiased evaluation difficult since a fixed threshold for cell type presence/absence must be selected to calculate classification metrics. In particular, different methods, datasets and abundance patterns have different thresholds for which the classification metrics are at a maximum.</p><p>The second issue stems from the class imbalance of our datasets, in which more cell types are absent than present in a spot (more negative than positive classes). In general, around 15% of the proportion matrix are positives classes, which made the specificity and precision particularly uninformative. This can be seen by how Seurat was the best performer on both specificity and precision despite having low sensitivity (<xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref>). By mostly predicting cell types to be absent in a spot, there are more false negatives (FNs), but specificity and precision do not take FNs into account. The balanced accuracy and F1 score were also unable to entirely correct for this class imbalance.</p><p>Given these two issues, we decided to use the precision-recall curve (PR) for evaluation instead and not include these five classification metrics (although we discuss its calculation below). The PR curve plots precision against recall at different thresholds, and the threshold to distinguish cell type absence/presence is varied from zero to one instead of fixing it at a certain value. Hence, the proportions are used as-is without rounding or binarization. It is also recommended for use with imbalanced datasets (<xref ref-type="bibr" rid="bib9">Davis, 2006</xref>).</p></sec><sec sec-type="appendix" id="s10"><title>Calculation of threshold-based classification metrics</title><p>First, we rounded the predicted proportion matrices to two decimal points, so a proportion of 0.005 and under was rounded to zero. We calculated the micro-average of each classification metric. This is a global metric where the contributions of all classes are considered. We essentially treat the proportion matrix as in a binary classification problem and go through each element individually. As an example, the micro-precision is calculated as<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munderover><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munderover><mml:mi>T</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munderover><mml:mi>F</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where TP stands for true positive and FP for false positive. This is in contrast to the macro-average, where the metric is computed independently for each cell type using a one-vs-all approach, and the average is taken across all cell types (<inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mspace width="thinmathspace"/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>).</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>The relative frequency in which a method performs best in the silver standard, based on the best median value across ten replicates for that combination.</title><p>‘Tie’ means that two or more methods score the same up to the third decimal point. RMSE: root-mean-square error; AUPR: area under the precision-recall curve.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app2-fig1-v1.tif"/></fig></sec></app><app id="appendix-3"><title>Appendix 3</title><sec sec-type="appendix" id="s11"><title>Method execution and parameter choice</title><p>In this appendix, we briefly describe each method, how we ran them, and the parameters that we evaluated. As most methods contain adjustable parameters that can affect its performance, we tested a range of parameter options to ensure optimal performance for each method. For reproducibility, users can find the exact parameters we have used for each analysis under the ‘conf/’ folder in our Github repository.</p><sec sec-type="appendix" id="s11-1"><title>cell2location (v0.06a)</title><p>Cell2location models the transcripts with a negative binomial distribution. It uses variational inference to estimate all the parameters. One advantage of cell2location is that users can shape model priors by providing hyperparameters that correspond to their prior knowledge. We used default priors from the tutorial of cell2location version 0.3. We filtered genes from the reference and spatial datasets as suggested by the tutorial. Model fitting was performed with cross-validation stratified by cell type annotation (<italic>stratify_cv</italic>). Sample information was not given to the model. The number of training iterations was set to 30,000 (<italic>n_iter</italic>).</p><p>In a newer tutorial, the default value of <italic>detection_alpha</italic> hyperparameter changed from 200 to 20. We compared the old and new values on the brain cortex seqFISH+ dataset (gold standard) and the kidney dataset (silver standard) and did not find a difference in performance (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1a</xref>). Hence, we kept <italic>detection_alpha = 200</italic> for our benchmark. We also varied the number of cells per location from 10 to 50 cells in the gold standard but also did not find a noticeable change in performance (<xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1b</xref>).</p></sec><sec sec-type="appendix" id="s11-2"><title>DestVI (v0.16.0)</title><p>DestVI uses latent variable models (i.e. variational autoencoders) for the single-cell and spatial data. Unlike other methods, it also models a continuous estimate of cell state for every cell type in every spot. With the default of 2500 epochs, training did not converge for many of the silver standard datasets. We followed the author’s recommendations and increased to 5000 training epochs and reduce the minibatch size (<italic>batch_size</italic>) to 64, which improved performance for all silver standard datasets (<xref ref-type="fig" rid="app3fig3">Appendix 3—figure 3</xref>). For the gold standards, we used 2500 training epochs and <italic>batch_size =</italic> 4.</p></sec><sec sec-type="appendix" id="s11-3"><title>DSTG (v0.0.1)</title><p>DSTG uses a graph convolutional neural network to learn the composition of real spots from simulated spots. It performs a joint dimensionality reduction (canonical correlation analysis, CCA) and identifies the mutual nearest neighbors between the real and simulated spots. As many of the parameters were hardcoded, for example, 200 nearest neighbors and 30 canonical vectors, the algorithm did not run on our gold standards where there were only nine spots per FOV. We adjusted the source code to change <italic>k_filter</italic>, <italic>k</italic>, <italic>num_cc</italic>, and <italic>dims</italic> to be equal to the number of spots in such cases, otherwise the default parameters were used.</p></sec><sec sec-type="appendix" id="s11-4"><title>MuSiC (v0.2.0)</title><p>MuSiC is a bulk deconvolution method developed to handle multiple scRNA-seq references from multiple subjects. It employs weighted non-negative least squares (NNLS) regression. In case there are scRNA-seq reference datasets from multiple samples, the between-subject variance is used as weights for each gene. Genes with consistent expression among subjects are considered more informative and will be given higher weights during regression. We ran MuSiC without pre-grouping of cell types. We did not provide subject information to the model but instead considered each cell as a separate subject. This is not all our silver standards contained sample information, and we observed that the performance remained the same or worse when the sample information was given (<xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2a</xref>). We also experimented with creating ‘pseudosamples’ for datasets without sample information, where each cell was randomly assigned to one out of three artificial samples. This returned a worse performance than when single cells were used as samples (<xref ref-type="fig" rid="app3fig2">Appendix 3—figure 2b</xref>).</p></sec><sec sec-type="appendix" id="s11-5"><title>RCTD (v1.2.0)</title><p>RCTD models the transcripts as being Poisson distributed and uses maximum likelihood estimation to infer cell type proportions. We ran RCTD with <italic>doublet_mode=“full”</italic>, indicating that many cell types per spot were to be expected.</p></sec><sec sec-type="appendix" id="s11-6"><title>Seurat integration (v4.1.0)</title><p>Using joint dimensionality reduction between the scRNA-seq (reference) and spatial (query) data, we defined compatible reference-query pairs and used them as anchors for the label transfer procedure. We obtain a probability for a cell type being in the spot and use this as proxy for the abundance. We compared two normalization methods (SCTransform and vst) and two projection methods (PCA and CCA) and found that using SCTransform with PCA gave the best results (<xref ref-type="fig" rid="app3fig4">Appendix 3—figure 4</xref>). As with DSTG, we changed the number of neighbors and vectors (<italic>k.score</italic>, <italic>k.weight</italic>, <italic>dims</italic>) used in the gold standard as equal to the number of spots, otherwise the default was used.</p></sec><sec sec-type="appendix" id="s11-7"><title>SpatialDWLS (v1.1.0)</title><p>SpatialDWLS performs cell-type enrichment analysis for each spot, then uses down-weighted least squares on marker genes. We followed the protocol described in <xref ref-type="bibr" rid="bib29">Rossi and Chen, 2022</xref>, where the <italic>makeSignMatrixDWLS</italic> function was used with top 100 marker genes, instead of following the online vignette where the <italic>makeSignMatrixPAGE</italic> function was used with all marker genes (<xref ref-type="fig" rid="app3fig5">Appendix 3—figure 5</xref>).</p></sec><sec sec-type="appendix" id="s11-8"><title>SPOTlight (v0.1.7)</title><p>SPOTlight is the only method based on non-negative matrix factorization (NMF) and NNLS. This method computes topics from the gene expression profile with NMF instead of using the expression values directly. NNLS is used with the topics to obtain the cell type proportions for each spot. We followed the vignette of version 0.1.5, as the recommended parameters have changed slightly between each version of SPOTlight. In this version, SPOTlight uses Seurat’s <italic>FindAllMarkers</italic> functions to calculate marker genes between cell types, and the <italic>logfc.threshold</italic> (limit testing to genes which show at least X-fold difference) and <italic>min.pct</italic> (only test genes that are expressed in at least X% of cells) parameters have a huge impact on the resulting list of marker genes. Furthermore, the parameters <italic>cl_n</italic> (number of cell types to use) and <italic>min_cont</italic> (only keep cells that are at least X% present in a spot) within the deconvolution function itself affects the predictions. We tested three sets of parameters and in the end, ran <italic>FindAllMarkers</italic> with <italic>only.pos=TRUE</italic>, <italic>logfc.threshold=1</italic>, and <italic>min.pct=0.9</italic>, and the deconvolution with <italic>cl_n=50</italic> and <italic>min_cont</italic> = <italic>0.09</italic> (<xref ref-type="fig" rid="app3fig6">Appendix 3—figure 6</xref>). This was also the parameter set that gave the shortest runtime. We also normalized both the reference and spatial data with <italic>SCTransform</italic>.</p></sec><sec sec-type="appendix" id="s11-9"><title>Stereoscope (v0.2.0)</title><p>Stereoscope models the transcripts with a negative binomial distribution. It uses maximum likelihood estimation to infer the rate and overdispersion parameters from the scRNA-seq data and then uses maximum a posterior (MAP) estimation to infer cell type proportions. We ran stereoscope using all genes for the silver standard but only the top 5000 most highly expressed genes for the gold standard, as that gave the best results for both cases. Although the authors have noted in their paper that choosing the 5000 most expressed genes is sufficient, we saw that using all genes for the silver standards still gave slightly better performance (<xref ref-type="fig" rid="app3fig7">Appendix 3—figure 7a</xref>). We implemented an option to use the HVGs instead of top expressed genes, but this did not consistently result in better performance (<xref ref-type="fig" rid="app3fig7">Appendix 3—figure 7b</xref>). Finally, we tested the <italic>sub</italic> parameter, which subsamples each cell type in the single-cell reference to at most X cells, but did not see any improvement in the kidney (silver standard) or liver dataset (<xref ref-type="fig" rid="app3fig7">Appendix 3—figure 7c</xref>). We verified that both the training and test models have converged.</p></sec><sec sec-type="appendix" id="s11-10"><title>STRIDE (v0.0.2)</title><p>STRIDE trains a topic model from scRNA-seq data, then applies this model to the spatial data. We ran it with <monospace>--normalize</monospace> and we let STRIDE automatically select the optimal topic number for each dataset. We did not find a pattern when comparing results from raw and normalized counts (<xref ref-type="fig" rid="app3fig8">Appendix 3—figure 8</xref>).</p></sec><sec sec-type="appendix" id="s11-11"><title>Tangram (v1.0.3)</title><p>Tangram learns a spatial alignment of scRNA-seq from the spatial data via nonconvex optimization. Like Seurat integration, Tangram returns the probabilistic counts for each cell type in each cell voxel. We tested the three mapping modes: <italic>cells</italic> (maps single cells to spots), <italic>clusters</italic> (maps average of cells per cell type instead of single cells), and <italic>constrained</italic> (constrain the number of mapped single cell profiles). Although the <italic>constrained</italic> mode was recommended for deconvolution, we found that using the <italic>clusters</italic> resulted in the best performance (<xref ref-type="fig" rid="app3fig9">Appendix 3—figure 9</xref>). When running the <italic>constrained</italic> mode, we also provided the ground truth number of cells per spot and total number of cells in the <italic>density_prior</italic> and <italic>target_counts</italic> parameters, respectively. Increasing the training epochs did not have an effect on the performance, and we verified that the models have converged. The final parameters we used were <italic>map_cells_to_space</italic> with <italic>mode=“clusters”</italic> and <italic>density_prior=“rna_count_based”</italic>. We used the top 100 marker genes for each cell type.</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Changing hyperparameters in the cell2location model.</title><p>There is almost no performance difference when changing the (<bold>a</bold>) detection alpha and (<bold>b</bold>) number of cells per spot.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig1-v1.tif"/></fig><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Comparing MuSiC performance when the model was given sample information.</title><p>MuSiC seems to perform best when single cells were used as samples (‘None’), as compared to (<bold>a</bold>) when the real sample information was given and (<bold>b</bold>) when pseudosamples were created.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig2-v1.tif"/></fig><fig id="app3fig3" position="float"><label>Appendix 3—figure 3.</label><caption><title>Comparing parameters of DestVI.</title><p>Compared to the default parameters (2500 epochs), DestVI has better performance with 5000 training epochs and batch size of 64.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig3-v1.tif"/></fig><fig id="app3fig4" position="float"><label>Appendix 3—figure 4.</label><caption><title>Comparing different data transformation and dimensionality reduction methods in Seurat.</title><p>Seurat has the best performance when the data was transformed using SCTransform and the dimensionality reduction method is PCA. CCA = canonical correlation analysis; PCA = principal component analysis; VST = variance stabilizing transformation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig4-v1.tif"/></fig><fig id="app3fig5" position="float"><label>Appendix 3—figure 5.</label><caption><title>Comparing SpatialDWLS between two signature matrix creation functions.</title><p>SpatialDWLS has better performance when the <italic>makeSignMatrixDWLS</italic> was used to create the signature matrix (as described in the Current Protocols paper), instead of the <italic>makeSignMatrixPAGE</italic> function (described in the online vignette).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig5-v1.tif"/></fig><fig id="app3fig6" position="float"><label>Appendix 3—figure 6.</label><caption><title>Comparing SPOTlight performance on three sets of parameters.</title><p>We used Set1 parameters in our benchmark.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig6-v1.tif"/></fig><fig id="app3fig7" position="float"><label>Appendix 3—figure 7.</label><caption><title>Comparing stereoscope performance to using only highly variable genes (HVGs).</title><p>There is no consistent performance difference between using all genes of stereoscope and using the 5000 HVGs (with or without subsampling the scRNA-seq reference).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig7-v1.tif"/></fig><fig id="app3fig8" position="float"><label>Appendix 3—figure 8.</label><caption><title>Comparing STRIDE performance on normalized and raw counts.</title><p>For STRIDE, there is no consistent performance difference between normalizing or using the raw counts.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig8-v1.tif"/></fig><fig id="app3fig9" position="float"><label>Appendix 3—figure 9.</label><caption><title>Comparing the mapping modes in Tangram.</title><p>Although the <italic>constrained</italic> mapping mode was recommended in the Tangram vignette, we found that the <italic>clusters</italic> mode achieve better performance.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-88431-app3-fig9-v1.tif"/></fig></sec></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88431.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Pinello</surname><given-names>Luca</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Massachusetts General Hospital</institution><country>United States</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Solid</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>This study makes a <bold>valuable</bold> contribution to spatial transcriptomics by rigorously benchmarking cell-type deconvolution methods, assessing their performance across diverse datasets with a focus on biologically relevant, previously unconsidered aspects. The authors demonstrate the strengths of RCTD, cell2location, and SpatialDWLS for their performance, while also revealing the limitations of many methods when compared to simpler baselines. By implementing a full Nextflow pipeline, Docker containers, and a rigorous assessment of the simulator, this work offers robust insights that elevate the standards for future evaluations and provides a resource for those seeking to improve or develop new deconvolution methods. The thorough comparison and analysis of methods, coupled with a strong emphasis on reproducibility, provide <bold>solid</bold> support for the findings.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88431.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Cell type deconvolution is one of the early and critical steps in the analysis and integration of spatial omic and single cell gene expression datasets, and there are already many approaches proposed for the analysis. Sang-aram et al. provide an up-to-date benchmark of computational methods for cell type deconvolution.</p><p>In doing so, they provide some (perhaps subtle) additional elements that I would say are above the average for a benchmarking study: (i) a full Nextflow pipeline to reproduce their analyses; (ii) methods implemented in Docker containers (which can be used by others to run their datasets); (iii) a fairly decent assessment of their simulator compared to other spatial omics simulators. A key aspect of their results is that they are generally very concordant between real and synthetic datasets. And, it is important that they authors include an appropriate &quot;simpler&quot; baseline method to compare against and surprisingly, several methods performed below this baseline. Overall, this study also has the potential to also set the standard of benchmarks higher, because of these mentioned elements.</p><p>The only weakness of this study that I can readily see is that this is a very active area of research and we may see other types of data start to dominate (CosMx, Xenium) and new computational approaches will surely arrive. The Nextflow pipeline will make the the prospect of including new reference datasets and new computational methods easier.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88431.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public Review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>In this manuscript Sangaram et al provide a systematic methodology and pipeline for benchmarking cell type deconvolution algorithms for spatial transcriptomic data analysis in a reproducible manner. They developed a tissue pattern simulator that starts from single-cell RNA-seq data to create silver standards and used spatial aggregation strategies from real in situ-based spatial technologies to obtain gold standards. By using several established metrics combined with different deconvolution challenges they systematically scored and ranked 12 different methods and assessed both functional and usability criteria. Altogether, they present a reusable and extendable platform and reach very similar conclusions to other deconvolution benchmarking paper, including that RCTD, SpatialDWLS and Cell2location typically provide the best results. Major strengths of the simulation engine include the ability to downsample and recapitulate several cell and tissue organization patterns.</p><p>More specifically, the authors of this study sought to construct a methodology for benchmarking cell type deconvolution algorithms for spatial transcriptomic data analysis in a reproducible manner. The authors leveraged publicly available scRNA-seq, seqFISH, and STARMap datasets to create synthetic spatial datasets modeled after that of the Visium platform. It should be noted that the underlying experimental techniques of seqFISH and STARMap (in situ hybridization) do not parallel that of Visium (sequencing), which could potentially bias simulated data. Furthermore, to generate the ground truth datasets cells and their corresponding count matrix are represented by simple centroids. Although this simplifies the analysis it might not necessarily accurately reflect Visium spots where cells could lie on a boundary and affect deconvolution results.</p><p>The authors thoroughly and rigorously compare methods while addressing situational discrepancies in model performance, indicative of a strong analysis. The authors make a point to address both inter- and intra- dataset reference handling, which has a significant impact on performance, as the authors note in the text and conclusions. Indeed, supplying optimal reference data is - potentially most - important to achieve the best performance and hence it's important to understand that experimental design or sample matching is at least equally important to selecting the ideal deconvolution tool.</p><p>Similarly, the authors conclude that many methods are still outperformed by bulk deconvolution methods (e.g. Music or NNLS), however, it needs to be noted that these 'bulk' methods are also among the most sensitive when using an external (inter) dataset (S10), which likely resembles the more realistic scenario for most labs.</p><p>As the authors also discuss it's important to realize that deconvolution approaches are typically part of larger exploratory data analysis (EDA) efforts and require users to change parameters and input data multiple times. Thus, running time, computing needs, and scalability are probably key factors that researchers would like to consider when looking to deconvolve their datasets.</p><p>The authors achieve their aim to benchmark different deconvolution methods and the results from their thorough analysis support the conclusions that creating cell type deconvolution algorithms that can handle both cell abundance and rarity throughout a given tissue sample are challenging.</p><p>The reproducibility of the methods described will have significant utility for researchers looking to develop cell type deconvolution algorithms, as this platform will allow simultaneous replication of the described analysis and comparison to new methods.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.88431.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Sang-aram</surname><given-names>Chananchida</given-names></name><role specific-use="author">Author</role><aff><institution>Ghent University</institution><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff></contrib><contrib contrib-type="author"><name><surname>Browaeys</surname><given-names>Robin</given-names></name><role specific-use="author">Author</role><aff><institution>Ghent University</institution><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff></contrib><contrib contrib-type="author"><name><surname>Seurinck</surname><given-names>Ruth</given-names></name><role specific-use="author">Author</role><aff><institution>Ghent University</institution><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff></contrib><contrib contrib-type="author"><name><surname>Saeys</surname><given-names>Yvan</given-names></name><role specific-use="author">Author</role><aff><institution>Ghent University</institution><addr-line><named-content content-type="city">Ghent</named-content></addr-line><country>Belgium</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #1 (Recommendation for the authors)</bold></p><p>I only have one comment for improvement of this study and it has to do with the comparison of simulators that they conducted. There are many other simulators around now, including scDesign3, spaSim, SPIDER, SRTSIM, etc. Are any of those methods worth including in the comparison?</p></disp-quote><p>Indeed, many of the mentioned simulators did not exist when we initially developed synthspot, and upon closer examination, they are not directly comparable to our tool.</p><p>• scDesign3: The runtime of scDesign3 is quite long as a result of its generative model. The example provided in its tutorial only simulates 183 genes and takes over seven minutes when using four cores on a system with Intel Xeon E5-2640 CPUs running at 2.5GHz. In a small downsampling analysis, we simulated 10, 50, 100, and 150 genes with scDesign3 and observed runtimes of 30, 130, 245, and 360 seconds, respectively. This seems to indicate a linear relationship between the number of genes and the runtime, therefore rendering it unsuitable for simulating whole-transcriptome datasets for deconvolution.</p><p>• spaSim: spaSim focuses on modelling cell locations in different tissue structures but does not provide gene expression data. It is designed for testing cell colocalization capabilities rather than simulating gene expression.</p><p>• SPIDER: Although SPIDER appears to have some overlap with our work, it seems to be in the early stages of development. The GitHub repository contains only two scripts without any documentation, and the preprint does not provide instructions on how to use the tool.</p><p>• SRTSim: SRTSim explicitly states in its publication that it is not suitable for evaluating cell type deconvolution, as its focus is on simulating gene expression data without modelling cell type composition.</p><p>• scMultiSim: scMultiSim, like scDesign3, is limited in its capability to model the entire transcriptome.</p><p>Nonetheless, the inherent modularity of our Nextflow framework makes it possible for users to simply run the deconvolution methods on data that has been simulated by other simulators if need be.</p><p>Additionally, we have added the following rationale for why we developed synthspot in “Synthspot allows simulation of artificial tissue patterns”:</p><p>“On the other hand, general-purpose simulators are typically more focused on other inference tasks, such as spatial clustering and cell-cell communication, and are unsuitable for deconvolution. For instance, generative models and kinetic models like those of scDesign3 and scMultiSim are computationally intensive and unable to model entire transcriptomes. SRTSim focuses on modeling gene expression trends and does not explicitly model tissue composition, while spaSim only models tissue composition without gene expression.”</p><disp-quote content-type="editor-comment"><p>The other aspect of the simulation comparison that I'm missing is some kind of spatial metric. There are metrics about feature correlation, sample-sample correlation, library size, etc. But, what about spatial correlation (e.g., Moran's I or similar). Perhaps comparing the distribution of Moran's I across genes in a simulated and real dataset would be a good first start.</p></disp-quote><p>We would like to clarify that synthspot does not actually simulate the spatial location of spots, but synthetic regions where spots from the same region share similar compositions. Hence, incorporating a spatial metric in the comparison is not feasible. However, as RCTD is the only method that explicitly uses spot locations in its model (Supplementary Table 2, &quot;Location information&quot;), we believe that generating synthetic datasets with actual coordinates would not significantly impact the conclusions of the study.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Review)</bold></p><p>On the other hand, the authors state that in silver standard datasets one half of the scRNA-seq data was used for simulation and the other half was used as a reference for the algorithms, but the method of splitting the data, i.e., at random or proportionally by cell type, was not specified.</p></disp-quote><p>The data was split proportionally by cell type. To clarify this, we have included an additional sentence in the main text under the first paragraph of “Cell2location and RCTD perform well in synthetic data”, as well as in Figure S2.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Recommendation for the authors)</bold></p><p>Figure legends in Figures 3, 4 and across most Supplementary material are almost illegible. Please consider increasing font size for better readability.</p></disp-quote><p>Thank you for bringing this to our attention. The font size has been increased for all main and supplementary figures. Additionally, the supplementary figures have also been exported in higher resolution.</p><disp-quote content-type="editor-comment"><p>Supplementary Notes Figure 2c reads &quot;... total count per sampled multiplied by...&quot;</p></disp-quote><p>This has been adapted, as well as the captions of Supplementary Notes Figure 3c and 4c which had the same typo.</p><disp-quote content-type="editor-comment"><p><bold>Review #3 (Public review)</bold></p><p>The simulation setup has a significant weakness in the selection of reference single-cell RNAseq datasets used for generating synthetic spots. It is unclear why a mix of mouse and human scRNA-seq datasets were chosen, as this does not reflect a realistic biological scenario. This could call into question the findings of the &quot;detecting rare cell types remains challenging even for top-performing methods&quot; section of the paper, as the true &quot;rare cell types&quot; would not be as distinct as human skin cells in a mouse brain setting as simulated here.</p></disp-quote><p>We appreciate the reviewer’s concern and would like to clarify that within one simulated dataset, we never mix mouse and human scRNA-seq data together. The synthetic spots generated for the silver standards are always sampled from a single scRNA-seq or snRNA-seq dataset. Specifically, for each of the seven public scRNA-seq datasets, we generate synthetic datasets with one of nine abundance patterns, resulting in a total of 63 synthetic datasets. These abundance patterns only affect the sampling priors that are used—the spots are still created with combinations of cells sampled from the same dataset.</p><disp-quote content-type="editor-comment"><p>Furthermore, it is unclear why the authors developed Synthspot when other similar frameworks, such as SRTsim, exist. Have the authors explored other simulation frameworks?</p></disp-quote><p>While there are other simulation frameworks available now, synthspot was designed to specifically address the requirements of our study, offering unique capabilities that make it suitable for deconvolution evaluation. Moreover, many of the simulators did not exist when we initially developed our tool. We have added the following rationale for why we developed synthspot in “Synthspot allows simulation of artificial tissue patterns”:</p><p>“On the other hand, general-purpose simulators are typically more focused on other inference tasks, such as spatial clustering and cell-cell communication, and are unsuitable for deconvolution. For instance, generative models and kinetic models like those of scDesign3 and scMultiSim are computationally intensive and unable to model entire transcriptomes. SRTSim focuses on modeling gene expression trends and does not explicitly model tissue composition, while spaSim only models tissue composition without gene expression.”</p><p>In our response to Reviewer 1 copied below, we also outline specific reasons why other simulators were not suitable for our benchmark:</p><p>• scDesign3: The runtime of scDesign3 is quite long as a result of its generative model. The example provided in its tutorial only simulates 183 genes and takes over seven minutes when using four cores on a system with Intel Xeon E5-2640 CPUs running at 2.5GHz. In a small downsampling analysis, we simulated 10, 50, 100, and 150 genes with scDesign3 and observed runtimes of 30, 130, 245, and 360 seconds, respectively. This seems to indicate a linear relationship between the number of genes and the runtime, therefore rendering it unsuitable for simulating whole-transcriptome datasets for deconvolution.</p><p>• spaSim: spaSim focuses on modelling cell locations in different tissue structures but does not provide gene expression data. It is designed for testing cell colocalization capabilities rather than simulating gene expression.</p><p>• SPIDER: Although SPIDER appears to have some overlap with our work, it seems to be in the early stages of development. The GitHub repository contains only two scripts without any documentation, and the preprint does not provide instructions on how to use the tool.</p><p>• SRTSim: SRTSim explicitly states in its publication that it is not suitable for evaluating cell type deconvolution, as its focus is on simulating gene expression data without modelling cell type composition.</p><p>• scMultiSim: scMultiSim, like scDesign3, is limited in its capability to model the entire transcriptome.</p><disp-quote content-type="editor-comment"><p>Finally, we would have appreciated the inclusion of tissue samples with more complex structures, such as those from tumors, where there may be more intricate mixing between cell types and spot types.</p></disp-quote><p>We acknowledge the reviewer's suggestion and have incorporated a melanoma dataset from Karras et al. (2022) in response to this suggestion. This study profiled melanoma tumors by using both scRNA-seq and spatial technologies. The scRNA-seq consists of eight immune cell types and seven melanoma cell states. We have included this study as an additional silver standard and case study, the latter of which is presented in a separate section following the liver analysis (and a corresponding section in Methods).</p><p>We found that method performances on synthetic datasets generated from this melanoma dataset follow previous trends (Figure S3-S5). However, the inclusion of the case study led to the following changes in the overall rankings: cell2location and RCTD are now tied for first place (previously RCTD ranked first), and Seurat and SPOTlight have swapped places. Despite these changes, the core messages and conclusions of our paper remain unchanged. All relevant figures (Figures 1a, 2, 3a, 4a, 6b, 7a, S3-S6, S9) have been updated to incorporate these new analyses and results.</p><disp-quote content-type="editor-comment"><p><bold>Review #3 (Recommendation for the authors)</bold></p><p>To maintain consistency in the results, it is recommended to exclude the human scRNAseq set when generating synthetic spots. Furthermore, addressing the other significant weaknesses mentioned earlier would be beneficial.</p></disp-quote><p>Please refer to our response to the public review where we address the same remark.</p><disp-quote content-type="editor-comment"><p>It is essential to differentiate this work from previous benchmarking and simulation frameworks.</p></disp-quote><p>In addition to the rationale on why we developed our own framework (see response to the public review), we have included the following text in the discussion that highlights our versatile approach when using a real spatial dataset for evaluation:</p><p>“In the case studies, we demonstrated two approaches for evaluating deconvolution methods in datasets without an absolute ground truth. These approaches include using proportions derived from another sequencing or spatial technology as a proxy, and leveraging spot annotations, e.g., zonation or blood vessel annotations, that typically have already been generated for a separate analysis.”</p><p>Furthermore, we conducted an extra analysis in the liver case study, generating synthetic datasets with one experimental protocol and using the remaining two as separate references (Figure S13). This further illustrates the usefulness of our simulation framework, which we mentioned by appending this sentence in the discussion:</p><p>“As in our silver standards, users can select the abundance pattern most resembling the real tissue to generate the synthetic spatial dataset, as we have also demonstrated in the liver case study.”</p></body></sub-article></article>