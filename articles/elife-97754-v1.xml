<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">97754</article-id><article-id pub-id-type="doi">10.7554/eLife.97754</article-id><article-id pub-id-type="doi" specific-use="version">10.7554/eLife.97754.3</article-id><article-version article-version-type="publication-state">version of record</article-version><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Physics of Living Systems</subject></subj-group></article-categories><title-group><article-title>Light-driven synchronization of optogenetic clocks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cannarsa</surname><given-names>Maria Cristina</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0009-4126-4022</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Liguori</surname><given-names>Filippo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2859-6953</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author"><name><surname>Pellicciotta</surname><given-names>Nicola</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7105-9566</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Frangipane</surname><given-names>Giacomo</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1533-4754</contrib-id><email>giacomo.frangipane@uniroma1.it</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-5020-0663</contrib-id><email>roberto.dileonardo@uniroma1.it</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02be6w209</institution-id><institution>Department of Physics, Sapienza University of Rome</institution></institution-wrap><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02be6w209</institution-id><institution>Department of Biology and Biotechnology Charles Darwin, Sapienza University of Rome</institution></institution-wrap><addr-line><named-content content-type="city">Rome</named-content></addr-line><country>Italy</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/042t93s57</institution-id><institution>Center for Life Nano &amp; Neuro Science, Fondazione Istituto Italiano di Tecnologia (IIT)</institution></institution-wrap><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff><aff id="aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00bc51d88</institution-id><institution>NANOTEC-CNR, Soft and Living Matter Laboratory, Institute of Nanotechnology</institution></institution-wrap><addr-line><named-content content-type="city">Rome</named-content></addr-line><country>Italy</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03ht1xw27</institution-id><institution>National Centre for Biological Sciences­‐Tata Institute of Fundamental Research</institution></institution-wrap><country>India</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0dhs15</institution-id><institution>École Normale Supérieure - PSL</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>15</day><month>10</month><year>2024</year></pub-date><volume>13</volume><elocation-id>RP97754</elocation-id><history><date date-type="sent-for-review" iso-8601-date="2024-03-22"><day>22</day><month>03</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint.</event-desc><date date-type="preprint" iso-8601-date="2024-03-11"><day>11</day><month>03</month><year>2024</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.10.24.563722"/></event><event><event-desc>This manuscript was published as a reviewed preprint.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-05-10"><day>10</day><month>05</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97754.1"/></event><event><event-desc>The reviewed preprint was revised.</event-desc><date date-type="reviewed-preprint" iso-8601-date="2024-08-29"><day>29</day><month>08</month><year>2024</year></date><self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.97754.2"/></event></pub-history><permissions><copyright-statement>© 2024, Cannarsa et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Cannarsa et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-97754-v1.pdf"/><abstract><p>Synthetic genetic oscillators can serve as internal clocks within engineered cells to program periodic expression. However, cell-to-cell variability introduces a dispersion in the characteristics of these clocks that drives the population to complete desynchronization. Here, we introduce the optorepressilator, an optically controllable genetic clock that combines the repressilator, a three-node synthetic network in <italic>E. coli</italic>, with an optogenetic module enabling to reset, delay, or advance its phase using optical inputs. We demonstrate that a population of optorepressilators can be synchronized by transient green light exposure or entrained to oscillate indefinitely by a train of short pulses, through a mechanism reminiscent of natural circadian clocks. Furthermore, we investigate the system’s response to detuned external stimuli observing multiple regimes of global synchronization. Integrating experiments and mathematical modeling, we show that the entrainment mechanism is robust and can be understood quantitatively from single cell to population level.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>synthetic biology</kwd><kwd>optogenetics</kwd><kwd>nonlinear dynamics</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>E. coli</italic></kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id><institution>European Research Council</institution></institution-wrap></funding-source><award-id>834615</award-id><principal-award-recipient><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100021856</institution-id><institution>Ministero dell'Università e della Ricerca</institution></institution-wrap></funding-source><award-id>R20R4X8ZEL</award-id><principal-award-recipient><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Introducing the optorepressilator, a synthetic genetic oscillator that can be synchronized, entrained, and detuned by green light to precisely control periodic gene expression in single cells or entire bacterial populations.</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>publishing-route</meta-name><meta-value>prc</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Genetic clocks keep time within living organisms in order to program periodic behaviors like circadian rhythms. An intensive genetic analysis of the complex landscape of these biological oscillations has revealed that, from bacteria and fungi to plants and animals, these clocks share similar motifs in the underlying gene regulatory networks (<xref ref-type="bibr" rid="bib41">Young and Kay, 2001</xref>; <xref ref-type="bibr" rid="bib5">Cookson et al., 2009</xref>). From a reverse perspective, synthetic biologists have tackled the problem of designing from scratch minimal gene networks that can produce periodic patterns of gene expression (<xref ref-type="bibr" rid="bib9">Elowitz and Leibler, 2000</xref>; <xref ref-type="bibr" rid="bib1">Atkinson et al., 2003</xref>; <xref ref-type="bibr" rid="bib36">Stricker et al., 2008</xref>; <xref ref-type="bibr" rid="bib30">Purcell et al., 2010</xref>). Very early numerical simulations had shown that networks with an odd number of cyclically connected genes exhibit robust oscillations (<xref ref-type="bibr" rid="bib12">Fraser and Tiwari, 1974</xref>). The repressilator was the first experimental realization of a synthetic genetic clock based on this principle (<xref ref-type="bibr" rid="bib9">Elowitz and Leibler, 2000</xref>). As shown schematically in <xref ref-type="fig" rid="fig1">Figure 1</xref>, the repressilator is a minimal network consisting of three transcription factors mutually repressing on a loop. The original design, using the repressors LacI, TetR and cI in <italic>Escherichia coli</italic>, displayed marked oscillations in single cells, although with large fluctuations in both amplitude and period. This noise has been recently significantly reduced by genetic optimization, resulting in much more robust albeit slower oscillations (<xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref>). This refactored repressilator is usually referred to as repressilator 2.0 (<xref ref-type="bibr" rid="bib31">Riglar et al., 2019</xref>). In this system, the decrease in protein concentration is driven only by growth-related dilution, not by active protein degradation. As discussed in <xref ref-type="bibr" rid="bib9">Elowitz and Leibler, 2000</xref>, a symmetric, protein only model already predicts limit cycle oscillations provided repression is steep enough:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>x</mml:mi><mml:mspace width="1em"/><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>y</mml:mi><mml:mspace width="1em"/><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mstyle></mml:math></inline-formula> are the three repressors concentrations in units of the dissociation constant <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>, the concentration of proteins required to repress a promoter to half maximum, <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> is a common decay rate set by dilution and <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi></mml:mstyle></mml:math></inline-formula> is the normalized maximum production rate. In the digital approximation (<inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>), when <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> the resulting dynamics look like relaxation oscillations with amplitude <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> and a full cycle period given by <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="fig" rid="fig1">Figure 1a</xref> and Appendix 1-section 1). As a result, although individual cells oscillate indefinitely, the natural dispersion of growth rates <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> results in a dispersion of periods leading to progressive dephasing of individual oscillators as shown by the simulations in <xref ref-type="fig" rid="fig1">Figure 1b</xref>. In the same figure we report an experimental observation of this damping that we obtained using <italic>E. coli</italic> bacteria carrying the repressilator 2.0 (<xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref>). This system contains three fluorescent reporters whose expression is regulated by the same three transcription factors of the repressilator, so that the reporters’ concentration follows that of the repressor transcribed by the same promoter (see <xref ref-type="fig" rid="fig1">Figure 1a</xref>). The cultures were initially synchronized chemically with IPTG, which deactivates the LacI repressor eliminating the edge between <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> from the network in <xref ref-type="fig" rid="fig1">Figure 1a</xref>. This new topology admits a stable fixed point where the concentrations of <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> are maximal while <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi></mml:mstyle></mml:math></inline-formula> goes to zero. Next, the cultures were maintained in exponential growth phase by periodic dilutions in a multiwell plate while the population-averaged fluorescence signal was monitored using a plate reader (see Materials and methods). For clarity reasons, we will often report only the fluorescence signal from the CFP reporter that indirectly quantifies the concentration of the TetR repressor or <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> in our simple model. <xref ref-type="fig" rid="fig1">Figure 1b</xref> shows that when starting from the synchronized state, the population signal from the CFP reporter displays high contrast oscillations with a period of 16 hr and an amplitude that is reduced to a half after about 2.5 periods. Phase drifts are very common in natural biological oscillators. Small couplings within a population of oscillators can give rise to a globally synchronized state (<xref ref-type="bibr" rid="bib27">Pikovsky, 2001</xref>), as in the case of cardiac pacemaker cells (<xref ref-type="bibr" rid="bib21">Mirollo and Strogatz, 1990</xref>) or quorum sensing coupled genetic oscillators (<xref ref-type="bibr" rid="bib6">Danino et al., 2010</xref>; <xref ref-type="bibr" rid="bib29">Prindle et al., 2011</xref>). Other genetic oscillators, like circadian clocks, rely instead on a periodic external cue, known as zeitgeber (time-giver), to constantly adjust their phase to that of a common environmental cycle. Sunlight is the predominant zeitgeber of natural circadian clocks (<xref ref-type="bibr" rid="bib13">Golombek and Rosenstein, 2010</xref>). In the context of synthetic biology, light is a particularly versatile input for controlling the state of genetic circuits and programming gene expression in space and time with much greater precision than chemical signals (<xref ref-type="bibr" rid="bib18">Levskaya et al., 2005</xref>; <xref ref-type="bibr" rid="bib37">Tabor et al., 2009</xref>; <xref ref-type="bibr" rid="bib23">Olson et al., 2014</xref>; <xref ref-type="bibr" rid="bib2">Baumschlager and Khammash, 2021</xref>). Optical signals can also be multiplexed through spectral (<xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Fernandez-Rodriguez et al., 2017</xref> or amplitude modulation <xref ref-type="bibr" rid="bib3">Benzinger et al., 2022</xref>). A growing number of optogenetics tools have been recently applied in prokaryotes to control different aspects of bacterial physiology (<xref ref-type="bibr" rid="bib19">Liu et al., 2018</xref>, such as growth <xref ref-type="bibr" rid="bib8">Davidson et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Milias-Argeitis et al., 2016</xref>; <xref ref-type="bibr" rid="bib15">Gutiérrez Mena et al., 2022</xref>, antibiotic resistance <xref ref-type="bibr" rid="bib34">Sheets et al., 2023</xref>, motility <xref ref-type="bibr" rid="bib11">Frangipane et al., 2018</xref>; <xref ref-type="bibr" rid="bib42">Zhang et al., 2020</xref> and adhesion <xref ref-type="bibr" rid="bib17">Jin and Riedel-Kruse, 2018</xref>). A widely used optogenetic system is the light-switchable two-component system, CcaS-CcaR from <italic>Synechocystis</italic> PCC 6803 (<xref ref-type="bibr" rid="bib38">Tabor et al., 2011</xref>). CcaS senses green light and phosphorilates the response regulator CcaR. Phosphorylated CcaR binds to the promoter <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, activating gene expression. Red light reverts CcaS to the inactive state and shuts down transcription from <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. This system was optimized for controllable gene expression with a high dynamic range in <italic>E. coli</italic> (<xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref>; <xref ref-type="bibr" rid="bib24">Ong and Tabor, 2018</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Dephasing in a population of repressilators.</title><p>(<bold>a</bold>) (left) Schematic representation of the repressilator 2.0 plasmid. (right) Simulated time evolution of the three repressors concentrations in the limit cycle of the protein-only model in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>. The reported expressions for amplitude and period are derived in the limits <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> (see Appendix 1-section 1). (<bold>b</bold>) Concentration of the reporter CFP (TetR) as a function of time for an initially synchronized population of oscillators growing in a multi-well plate. Blue circles represent average over two technical replicates, corresponding errorbars are comparable to symbol size. The shadowed gray curves show simulations of independent oscillators (see Materials and methods) and standard deviation 0.034 h<sup>-1</sup>. Dephasing due to the variability of oscillators periods causes a damping in the mean population signal reported as a blue line. Snapshots of the population ensemble in the 3D concentration space <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>-</mml:mtext></mml:mrow><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>-</mml:mtext></mml:mrow><mml:mi>z</mml:mi></mml:mstyle></mml:math></inline-formula> are reported for three instants of time during the simulation, clearly showing progressive dephasing of individual oscillators over the limit cycle trajectory.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig1-v1.tif"/></fig><p>Here, we show that integrating an optogenetic module in the repressilator circuit enables the use of light to synchronize, entrain, and detune oscillations in gene expression within single cells or entire populations. We employ the CcaS-CcaR light-inducible system to express one of the repressilator proteins, resulting in a novel four-node optogenetic network named the ’optorepressilator’. With this modification, light induces precise phase adjustments among synthetic genetic clocks within individual cells, leading to persistent population-wide oscillations. These oscillations mantain a constant phase relation to the external light cue that can act as a zeitgeber.</p><p>We show that a population of these synthetic oscillators can be synchronized through transient green light exposure or be entrained via a sequence of short pulses, sustaining indefinite oscillations. Additionally, we explore the system’s response to detuned external stimuli, revealing multiple synchronization regimes.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Optorepressilator: a light-controllable repressilator</title><p>In the optorepressilator (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), LacI proteins are produced by two genes. We indicate with <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> the normalized concentration of the repressilator’s LacI, transcribed via the <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>λ</mml:mi></mml:mstyle></mml:math></inline-formula> promoter and repressed by <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi></mml:mstyle></mml:math></inline-formula> (cI), and with <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> the concentration of LacI proteins transcribed via the light-inducible promoter <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref>, <xref ref-type="fig" rid="fig2">Figure 2b</xref>). <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> add up to repress protein <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>, while a light-dependent production rate drives <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> dynamics:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mover><mml:mi>y</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mover><mml:mi>z</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> is a light dependent production rate. It is important to note that the dynamics of <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> is decoupled from all other repressors and only determined by light. In particular, under steady illumination conditions <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula>. If the expression of the light-inducible LacI is adjusted to have a dynamic range containing the dissociation constant <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> then we might be able to optically switch the system from limit cycle oscillations under red light to a fixed point under green light (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). In the digital approximation, the limit cycle is broken when <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> and the system collapses to a fixed point with coordinates <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>The optorepressilator: a light-controllable genetic oscillator.</title><p>(<bold>a</bold>) Schematic illustration of the optorepressilator circuit. Green and red light respectively promote and repress the production of one of the three transcription factors in the repressilator (LacI). (<bold>b</bold>) Working mechanism of the optogenetic module. A light-driven two-component system controls the production of an additional copy of <italic>lacI</italic>. The optogenetic system consists of the membrane-associated histidine kinase CcaS and its response regulator CcaR. Absorption of green light increases the rate of CcaS autophosphorylation and phosphate transfer to the transcription factor CcaR. Phosphorylated CcaR promotes transcription of an additional copy of the LacI gene from the promoter <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. Red light reverts CcaS to the inactive state and shuts down transcription from <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. (<bold>c</bold>) Ideal optorepressilator’s dynamics according to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. The system oscillates unperturbed under red light, but collapses to a fixed point under green light when the extra <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> represses <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig2-v1.tif"/></fig></sec><sec id="s2-2"><title>Fine-tuning optogenetic expression</title><p>Estimates for the LacI dissociation constant <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> vary between 0.01–0.1 nM (<xref ref-type="bibr" rid="bib25">Ozbudak et al., 2004</xref>). Even taking into account the fact that the repressor plasmid is present in more than one copy (∼ five copies), this suggests that a small number of LacI proteins may already disrupt the limit cycle. Therefore, controlling the leakage of the promoter under the red light is crucial. The optogenetic module consists of two components, named as sensor and actuator in <xref ref-type="fig" rid="fig3">Figure 3c</xref>. In order to fine-tune the expression of LacI, we created four different ranges of gene expression in which both transcription and translation were modulated on two levels. Translation was controlled by substituting the ribosome binding site (RBS) (BBa_B0034) in the original plasmid with a weaker RBS (BBa_B0033) from the same IGEM Community collection. Transcription was modulated through gene copy number by moving the light-driven gene expression cassettes from the plasmids to the genome. Combined with the sensor and actuator plasmids, these constructs resulted in four versions of the optogenetic module (<xref ref-type="fig" rid="fig3">Figure 3a</xref>) with different expression ranges. We characterized these expression ranges as a function of incident light (<xref ref-type="fig" rid="fig3">Figure 3b</xref>) using sfGFP as fluorescent reporter and a custom-made light-addressable multiwell plate (see <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). By comparing expression at maximum green level, we can estimate that RBS substitution leads to a 27-fold decrease in reporter production (<xref ref-type="fig" rid="fig3">Figure 3b</xref>), while relocation of the light-driven cassette to the genome reduces expression by 57-fold. The combination of weak RBS and genome insertion results in a gene expression range below the autofluorescence background (estimated combined fold reduction of 1500). We then replaced the sfGFP gene with LacI in all four versions of the optogenetic module and transformed the repressilator plasmid (pLPT234) in each of the four strains. As a first step, we verified that the oscillations of the limit cycle were preserved under red light. To this end, we first chemically synchronized the oscillations with IPTG and then monitored the concentration of TetR (<inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>) reported by CFP. Cultures were maintained in exponential phase by periodic dilutions in multiwells under constant red light. We found that only the strain with the lowest expression level (represented in <xref ref-type="fig" rid="fig3">Figure 3c</xref>) oscillates with the same amplitude as the control strain containing only the repressilator plasmids (<xref ref-type="fig" rid="fig3">Figure 3d</xref>). The slight difference in period can be explained by the presence of additional plasmids in the optorepressilator strain, which results in a lower growth rate. As found in the digital approximation, the repressilator period is mainly controlled by the inverse growth rate (see <xref ref-type="fig" rid="fig1">Figure 1a</xref> and <xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>) meaning a lower growth rate results in a longer oscillation period. When we normalize the time with the growth rate the two oscillations overlap nicely (<xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). In contrast, no clear oscillations were observed in the other three strains, where LacI leaking from the red-repressed promoter destroys the limit cycle and collapses all cells in a fixed point where the repressilator protein cI is high and TetR is low (see Appendix 1-section 5).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Fine-tuning gene expression in the optorepressilator circuit.</title><p>(<bold>a</bold>) To tune expression from the optogenetic module we varied the strength of RBSs and gene copy number by placing the output gene (sfGFP) either on a plasmid or in the chromosome. (<bold>b</bold>) Light-controlled expression levels of the sfGFP reporter from the four constructs in (<bold>a</bold>) and a negative control consisting of DHL708 with plasmids pNO286-3 and pSR58-0 (optogenetic plasmids without sfGFP cassette). For each curve, the samples were exposed to a fixed level of red light (intensity 0.74 W/m<sup>2</sup>) while increasing green light intensity, as indicated by the dots’ colors (color reference on the right). The main error bars represent the dynamic range of each sample. The smaller error bars represent the standard deviation of individual light conditions between replicates made in three separate days. The gray shaded area represents the autofluorescence background. Light intensities and raw fluorescence data are in <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>. (<bold>c</bold>) Scheme of the final optorepressilator circuit (see Materials and methods for details). (<bold>d</bold>) Time evolution of TetR reporter (CFP) concentration in a population of IPTG synchronized cells growing under red light. Black points from the original repressilator 2.0 display marked oscillations. Colored lines correspond to the four constructs in a with sfGFP replaced by LacI and the addition of the sponge promoters as in pSpongeROG. Circles represent data, where each dot is the average of two replicates with error bars comparable to marker size, while lines are spline interpolations. Only the purple line, corresponding to the system in (<bold>c</bold>), shows oscillations comparable to those of the original repressilator. The difference in period can be explained by the difference in growth rate of the two strains, as shown in <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig3-v1.tif"/></fig></sec><sec id="s2-3"><title>Optogenetic synchronization</title><p>Having verified that the system oscillates under red light, we then checked whether green light can synchronize a population of optorepressilators. <xref ref-type="fig" rid="fig4">Figure 4a</xref> shows the population signal of CFP fluorescence reporting the concentration of TetR (<inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>) in multiwell cultures. The cultures were constantly kept under red light for the first 40 hr. Although individual cells oscillate, their phases are randomly distributed so that the average population signal is constant. At <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mstyle></mml:math></inline-formula> h we switch from red to green for 12 hr, and CFP fluorescence decays to zero. This is expected when extra LacI is produced by the optogenetic module, repressing both TetR and CFP. When the population signal decays completely, all the cells are stuck in the same fixed point (<inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> in the model), so that when switching back to red, they start oscillating in synchrony. This was also confirmed by single-cell data from a mother-machine microfluidic chip (<xref ref-type="fig" rid="fig4">Figure 4b</xref>). Under the same light protocol as in <xref ref-type="fig" rid="fig4">Figure 4a</xref>, most of the channels blink in unison after exposure and removal of synchronizing green light (<xref ref-type="video" rid="video1">Video 1</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Optical synchronization.</title><p>(<bold>a</bold>) Time evolution of mSCFP3(CFP), mVenus and mKate2 signals from a population of exponentially growing cells in multiwell plate. Red and green shaded areas represent the illumination protocol. Dots reports data for optorepressilator cells and clearly shows the appearance of synchronous oscillations after transient illumination with green light, each marker is the average of two replicates and the error bar is data range. (<bold>b</bold>) Single cell data from a mother machine experiment employing a similar light protocol as in (<bold>a</bold>) (<xref ref-type="video" rid="video1">Video 1</xref>). The gray curves represent the concentration of CFP for individual cells growing in different channels, while the blue curve is their average. Snapshots above the plot report fluorescence imaging of bacteria in the microfluidic chip, centered at the corresponding time point on the time axis below. Scale bar is 5 μm.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig4-v1.tif"/></fig><media mimetype="video" mime-subtype="mp4" xlink:href="elife-97754-video1.mp4" id="video1"><label>Video 1.</label><caption><title>Optical synchronization in mother machine.</title><p>The snapshots of CFP fluorescence were acquired every 9 minutes and the video is played at 32 frames/s. The presence of a green square over the image indicates that at that time point the bacteria are exposed to green light stimuli provided by the Thorlabs LED M530L4. The fluorescence of each mother cell and the mean fluorescence of all mother cells are plotted in <xref ref-type="fig" rid="fig4">Figure 4b</xref>. Scale bar is 5 μm.</p></caption></media></sec><sec id="s2-4"><title>Optogenetic entrainment</title><p>Both plate reader and mother-machine experiments showed that cells carrying the optorepressilator system could be synchronized by transient light exposure. However, oscillations in the population signal were progressively dampened again by the dispersion of growth rates and thus of individual clocks’ periods. This was particularly evident in the mother-machine experiment, where the growth rate variability is larger. Natural genetic clocks are able to counteract period dispersion by exploiting an external periodic stimulus to advance or delay their phases. For example, it was shown that a 1-hr exposure to light at bedtime can delay the human circadian rhythm by about two hours, while exposure to the same intensity of white light after waking up can advance our schedule by a little less than half an hour (<xref ref-type="bibr" rid="bib35">St Hilaire et al., 2012</xref>). Interestingly, the optorepressilator model in <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref>, despite its simplicity, displays a very similar behavior. In <xref ref-type="fig" rid="fig5">Figure 5a</xref>, we report the phase shift <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math></inline-formula> produced by a single pulse (with a duration of 2 hr and intensity <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mspace width="thickmathspace"/><mml:msup><mml:mrow><mml:mtext>h</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> fixed for all the simulations) as a function of the pulse arrival phase <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math></inline-formula>. This type of curve is often referred to as a phase response curve (PRC) and is obtained here by numerical integration of (2) for a single optorepressilator. The first thing we notice is that positive pulse arrival phase <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> results in a negative phase shift <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> that delays subsequent oscillations, while a negative <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math></inline-formula> results in a phase advance (<inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>). This behavior can be understood at least qualitatively by simple considerations. When a pulse arrives before <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> reaches the maximum (<inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>), a burst of <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> is produced (<xref ref-type="fig" rid="fig5">Figure 5b</xref>) that may trigger an earlier decay of <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> and the pulse duration <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula> is long enough. This results in an advanced peak, or equivalently a positive phase shift, which is greater the earlier the light pulse arrives. Conversely, when the pulse arrives while <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> is decaying the <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> burst will prolong the <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> decay until the moment when <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> falls below 1. This results in a delayed peak, or a negative phase shift that increases in magnitude as <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math></inline-formula> increases (<xref ref-type="fig" rid="fig5">Figure 5b</xref>). The exact shape of the PRC will depend on light intensity through <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and pulse duration <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula> as shown in <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Optical entrainment.</title><p>(<bold>a</bold>) Phase shift as a function of pulse arrival phase. (<bold>b</bold>) Numerical simulations of <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> illustrating the effect of pulse arrival phase on the phase of optorepressilator oscillations. (<bold>c</bold>) Graphical illustration of the parameters used to describe the phase shift. (<bold>d</bold>) (top) CFP signal from a population of cells growing exponentially in 96-well plates that are exposed to a train of periodic pulses of green light. The population signal displays undamped oscillations demonstrating optical entrainment. (bottom) Numerical simulation of an ensemble of optorepressilators evolving according to <xref ref-type="disp-formula" rid="equ2">Equation (2)</xref> and with distributed growth rates (same parameters as in <xref ref-type="fig" rid="fig1">Figure 1b</xref>). Pulses have a duration of <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula> and a relative period of <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>. Gray lines are individual oscillators while blue is the population average. (<bold>e</bold>) (top) Gray lines are CFP signals from single cells growing in a mother machine under periodic pulsed illumination (<xref ref-type="video" rid="video2">Video 2</xref>). The blue curve is the average. (bottom) Numerical simulation with the same parameters as in (<bold>d</bold>) but a larger dispersion of growth rates and a slightly shorter relative period <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mstyle></mml:math></inline-formula> was required to match experiments above. In both data and simulation the magenta dotted curve highlights a slow oscillator (low growth rate and larger amplitude) entrained with a phase such as to receive the light pulse on the rising edge to anticipate the next oscillation. Magenta dashed lines highlight faster oscillators whose phase is such to receive the pulse on the decaying edge to delay the following oscillation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig5-v1.tif"/></fig><p>The phase response curve turns out to be a very useful concept to predict the system’s response to a periodic external input. For example, if the system is exposed to a periodic train of light pulses, the phase response curve can be used to predict the sequence of phases <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> at which subsequent pulses will arrive (<xref ref-type="bibr" rid="bib14">Granada et al., 2009</xref>).<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula></p><p>where phases go from 0 at the expression peak of the <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> protein, to 1 when a full cycle is completed at the next peak. The fixed points <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> of this mapping are those for which <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and hence:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The fixed points where the phase response curve has a negative slope satisfying the condition <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, represent stable entrained states (<xref ref-type="bibr" rid="bib14">Granada et al., 2009</xref>) for which the system oscillates at the same frequency of the external light signal. So when the system is exposed to a train of external pulses of period <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> we should look for the phase <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> for which <xref ref-type="disp-formula" rid="equ4">Equation 4</xref> is satisfied, and if the phase response curve has a negative slope larger than –2, we can predict that the system will be entrained with a stable phase difference <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> between light pulses and the peaks of CFP (<inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>) protein.</p><p>Let us now consider an ensemble of optorepressilators with distributed natural periods <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and subjected to a train of light pulses with period <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. Based on the previous discussion, each optorepressilator will be entrained by the external periodic signal but with a specific phase difference satisfying <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>. The population signal will then show entrained oscillations representing the average over individual oscillators having the same period but maintaining different phase differences with the external signal.</p><p>From this simplified theoretical discussion, we deduce that if real optorepressilators had the predicted phase response curve, then it should be possible to use a train of light pulses as a zeitgeber capable of producing long-term oscillations in gene expression at the population level. We first demonstrate this by monitoring the population signal from CFP (reporting TetR or <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> in the model) in multiwell cultures under constant red illumination (6.82 W/m<sup>2</sup>) interrupted by green light pulses (5.64 W/m<sup>2</sup>) of duration 2 h with period <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>18</mml:mn></mml:mstyle></mml:math></inline-formula> h. <xref ref-type="fig" rid="fig5">Figure 5d</xref> shows high contrast and undamped oscillations to be contrasted to the damped ones in <xref ref-type="fig" rid="fig1">Figure 1b</xref> and <xref ref-type="fig" rid="fig4">Figure 4a</xref>. The bottom panel in <xref ref-type="fig" rid="fig5">Figure 5d</xref> shows the result of a numerical simulation with the same parameters as in <xref ref-type="fig" rid="fig1">Figure 1b</xref> and the addition of a periodic light stimulation, with period <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>. Simulation panel also displays in gray the signals from individual optorepressilators before performing the average (in blue). These results are also confirmed by mother machine observations reported in <xref ref-type="fig" rid="fig5">Figure 5e</xref> (<xref ref-type="video" rid="video2">Video 2</xref>). For the simulations in the lower panel of <xref ref-type="fig" rid="fig5">Figure 5e</xref>, all parameters remained the same as in <xref ref-type="fig" rid="fig5">Figure 5d</xref> with the exception of the period of the light pulses (<inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.97</mml:mn></mml:mstyle></mml:math></inline-formula>) and the standard deviation of the growth rate distribution, which was increased from 0.034 h<sup>-1</sup> to 0.071 h<sup>-1</sup> to better reproduce the experimental observations in the mother machine. A narrower distribution of growth rates in multiwell cultures could be due to the fact that faster growing bacteria outperform slower-growing cells in a competing environment, unlike in the mother machine where there is no competition between cells in different channels. The theoretical discussion above predicts that the individual oscillators will each find their own stable phase with respect to external pulses. The slower ones will arrange themselves to receive the pulse on the rising edge of the peak to reduce their period, while the faster ones will have the pulse arriving after the peak to increase their period. We confirm this in both experiments and simulations in <xref ref-type="fig" rid="fig5">Figure 5e</xref>, where the individual traces of a slow (higher amplitude) and a fast (lower amplitude) oscillator have been highlighted with dotted and dashed lines, respectively.</p><media mimetype="video" mime-subtype="mp4" xlink:href="elife-97754-video2.mp4" id="video2"><label>Video 2.</label><caption><title>Optical entrainment in mother machine.</title><p>The snapshots of CFP fluorescence were acquired every 9 minutes and the video is played at 32 frames/s. The presence of a green square over the image indicates that at that time point the bacteria are exposed to green light stimuli provided by the Thorlabs LED M530L4. The fluorescence of each mother cell and the mean fluorescence of all mother cells are plotted in <xref ref-type="fig" rid="fig5">Figure 5e</xref>. Scale bar is 5 μm.</p></caption></media></sec><sec id="s2-5"><title>Detuning</title><p>In an entrained population, most oscillators are detuned from their natural frequency to that of the external signal. In this section, we will explore detuning by starting with numerical simulations of our simple model in <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> and then comparing them with long-term observations of detuned optorepressilators in a plate reader experiment. <xref ref-type="fig" rid="fig6">Figure 6a</xref> shows a 3D surface representing the ratio of the actual optorepressilator frequency <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> over external frequency <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> as a function of frequency and amplitude of the external signal <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. The <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi></mml:mstyle></mml:math></inline-formula> value is obtained as the frequency of the main peak in the power spectrum of the simulated data. The plateaus in this graph are related to the so-called Arnold’s tongues (<xref ref-type="bibr" rid="bib27">Pikovsky, 2001</xref>), that is regions of synchronization in the frequency/amplitude plane. On the cyan plateau, the system oscillates with the same frequency as the external signal, while there are also higher order plateaus with a fractional value of the ratio <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> (see <xref ref-type="fig" rid="app1fig8">Appendix 1—figure 8</xref>). On the cyan tongue, when the system is detuned to higher frequencies, its phase will be such that it receives the light pulse on the rising edge of the <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> protein. When detuned to lower frequencies, however, it shifts to receive pulses on the falling edge of <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula>. When detuning to lower frequencies, the system goes to an higher order synchronization tongue where it oscillates at twice the frequency of the external signal. Similarly, forcing to higher frequencies moves the system to fractional order tongues, such as the green plateau in the plot, in which the system oscillates at half the external frequency. All these regimes are found in experiments in which we maintain cultures of optorepressilators in exponential phase within multiwell plates that are independently addressed with light signals of different frequencies (<xref ref-type="fig" rid="fig6">Figure 6b</xref>). It is also remarkable to observe how the relative phase between the system and the external signal evolves within the cyan tongue, as predicted by the model. More quantitatively, we have extracted the phase difference <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> between light pulses and CFP oscillations from the data shown in the three central panels of <xref ref-type="fig" rid="fig6">Figure 6b</xref> (<inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.2</mml:mn></mml:mstyle></mml:math></inline-formula>). We found that, in accordance with the discussion in the previous section (<xref ref-type="disp-formula" rid="equ4">Equation 4</xref>), the red points with coordinates <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> fall on the theoretical phase response curve when we choose <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mspace width="thickmathspace"/><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="fig5">Figure 5a</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Detuning.</title><p>(<bold>a</bold>) 3D surface representing the ratio between the actual frequency of a single forced optorepressilator and the frequency of the forcing signal, as a function of the forcing frequency and amplitude. The colors of the plateaus (Arnold’s tongues) highlight different regions of global synchronization in the frequency/amplitude plane. (<bold>b</bold>) Time evolution of the average CFP concentration (blue curve) in a plate reader experiment, for different frequencies of green light pulses (green bars). The color bars at the right of the plot indicates the corresponding region on the surface in (<bold>a</bold>). (<bold>c</bold>) Mother machine experiment revealing two distinct cells oscillating at half the signal frequency but peaking on alternate pulses of incoming light. This explains why for <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> in (<bold>b</bold>) we observe a population mean oscillating with the same frequency of the forcing instead of the <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mstyle></mml:math></inline-formula> value predicted for the green tongue in (<bold>a</bold>).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-fig6-v1.tif"/></fig><p>A discrepancy is apparently found in the green tongue, where we experimentally observe oscillations at the same frequency as the external signal. This is not unexpected, however, when one realizes that although the individual optorepressilators may oscillate at half the external frequency <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula>, they can peak at either the even or odd peaks of the external signal. When we average these alternating peaks over the population, we get a small amplitude oscillation at the frequency of the external signal. This is also confirmed by a mother machine experiment where we tried to detune to about twice the natural frequency and observed different channels oscillating at half the signal frequency and with alternating peaks (<xref ref-type="fig" rid="fig6">Figure 6c</xref>).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Inspired by the light entrainment of natural circadian rhythms, we designed the optorepressilator, a four-node synthetic oscillatory network that can lock its phase to an external periodic light signal. By integrating an optogenetic module into a repressilator circuit, we demonstrate, theoretically and with experiments, that light can synchronize, entrain, and detune oscillations within single cells or an entire population. We find that this four-node network shows a phase-sensitive response to light pulses. Depending on the arrival time, a pulse can either delay or advance the clock as in many natural circadian clocks. As a result, our system can be entrained by periodic light pulses, even when the forcing period deviates from the natural frequency. Using a combination of optogenetic experiments ranging from the macroscopic population scale to the microscopic scale of single cells, we show that the entrainment mechanism is robust and can be understood quantitatively by a simple protein-only model. The entrainment of biological clocks can provide new insights into oscillation mechanisms and, at the same time, practical means to control biological rhythms. Through periodic modulation of chemical signals within microfluidic environments, entrainment of natural biological clocks ranging from the embryonic segmentation clock (<xref ref-type="bibr" rid="bib32">Sanchez et al., 2022</xref>) to the NF-kB system regulating immune response (<xref ref-type="bibr" rid="bib16">Heltberg et al., 2016</xref>) has been previously achieved. However, the complexity of the underlying genetic networks often precludes a deeper mathematical understanding of the fundamental nature of the entrainment phenomenon. Synthetic oscillators provide an ideal platform for studying entrainment in engineered minimal systems where a close comparison with relatively simple models is possible (<xref ref-type="bibr" rid="bib22">Mondragón-Palomino et al., 2011</xref>). Our minimal optorepressilator model can provide many theoretical predictions, often in analytical form within the digital approximation (<inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>). It explains correlations between amplitude and period of oscillations (<xref ref-type="fig" rid="app1fig9">Appendix 1—figure 9</xref>), or how robust oscillations are against leakage (Appendix 1-section 5). Moreover an approximate form for the phase response curve is derived (Appendix 1-section 7), providing a quantitative physical insight into the mechanisms that produce delayed or advanced oscillations and on how pulse characteristics affect the system’s response.</p><p>From a more applied perspective, the optorepressilator enriches the toolbox of genetic modules by adding a light-synchronizable clock that could be used to program precise oscillatory patterns of gene expression. When compared to chemical signaling, the use of light to control and coordinate the functioning of synthetic networks offers clear advantages in terms of spatial and temporal modulation. Light cues can be applied and removed on the spot, without waiting for media substitution (<xref ref-type="bibr" rid="bib43">Zhao et al., 2018</xref>). In addition, using spatial light modulators it could be possible to address spatially separated subpopulations within a common environment to oscillate with distinct periods and phases. Optical synchronization of genetic oscillators can be easily implemented in a wide range of experimental settings like liquid cultures, agar plates or microfluidics. Light, for example, can penetrate bioreactors and orchestrate gene expression in a population of uncoupled oscillators. Moving to infrared inducible optogenetic systems (<xref ref-type="bibr" rid="bib4">Chernov et al., 2017</xref>), optical signals could also penetrate biological tissues for in vivo applications (<xref ref-type="bibr" rid="bib31">Riglar et al., 2019</xref>).</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Reagent type (species) or resource</th><th align="left" valign="bottom">Designation</th><th align="left" valign="bottom">Source or reference</th><th align="left" valign="bottom">Identifiers</th><th align="left" valign="bottom">Additional information</th></tr></thead><tbody><tr><td align="left" valign="bottom">Strain, strain background (<italic>Escherichia coli</italic>)</td><td align="left" valign="bottom">DHL708</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref></td><td align="left" valign="bottom"><ext-link ext-link-type="uri" xlink:href="https://www.addgene.org/98417/">Addgene_98417</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pLPT234 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib31">Riglar et al., 2019</xref></td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_127855">Addgene_127855</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pLPT145 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref></td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_85527">Addgene_85527</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pNO286-3 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib24">Ong and Tabor, 2018</xref></td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_107746">Addgene_107746</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pSR58.6 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref></td><td align="left" valign="bottom">RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_63176">Addgene_63176</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pKD46 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib7">Datsenko and Wanner, 2000</xref></td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Recombinant DNA reagent</td><td align="left" valign="bottom">pKD4 (plasmid)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib7">Datsenko and Wanner, 2000</xref></td><td align="left" valign="bottom">RRID: <ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_45605">Addgene_45605</ext-link></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">Commercial kit</td><td align="left" valign="bottom">In-Fusion HD Cloning</td><td align="left" valign="bottom">Takara Bio</td><td align="left" valign="bottom"/><td align="left" valign="bottom"/></tr></tbody></table></table-wrap><sec id="s4-1"><title>Strains and plasmids</title><p>A list of the strains and plasmids used is in <xref ref-type="table" rid="app1table1">Appendix 1—table 1</xref> and <xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>, along with plasmids maps and their description (<xref ref-type="fig" rid="app1fig10">Appendix 1—figures 10</xref> and <xref ref-type="fig" rid="app1fig11">11</xref>). Genome insertion of light-driven cassettes was performed using lambda-red recombination (<xref ref-type="bibr" rid="bib7">Datsenko and Wanner, 2000</xref>) targeting the <italic>attB</italic> genome site. The starting strain was <italic>E. coli</italic> DHL708 (a gift from Johan Paulsson, Addgene plasmid # 98417; <xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref>) for all insertions. All the recombination cassettes were amplified from modified versions of plasmid pKD46 (<xref ref-type="bibr" rid="bib7">Datsenko and Wanner, 2000</xref>, <xref ref-type="table" rid="app1table2">Appendix 1—table 2</xref>). In addition to kanamycin antibiotic resistance, the recombination cassettes contained the desired protein gene (LacI, sfGFP) controlled by the light-driven promoter <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</p><p>Plasmid cloning was performed using In-Fusion cloning (Takara Bio) for large rearrangements and Q5 Site-Directed Mutagenesis Kit (New England BioLabs) for small modifications that is RBS changes. The final optorepressilator system is composed of: the strain MCC0233 obtained inserting <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>P</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> (the light-driven promoter), a weak RBS and LacI open-reading frame in the genome of DHL708; pNO286-3 (a gift from Jeffrey Tabor, Addgene plasmid # 107746; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene">http://n2t.net/addgene</ext-link>:107746; RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_107746">Addgene_107746</ext-link>) <xref ref-type="bibr" rid="bib24">Ong and Tabor, 2018</xref>, plasmid with mini-CcaS light sensor and the enzymes for the phycocyanobilin chromophore; pLPT234 (a gift from Johan Paulsson, Addgene plasmid # 127855; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene">http://n2t.net/addgene</ext-link>:127855; RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_127855">Addgene_127855</ext-link>) <xref ref-type="bibr" rid="bib31">Riglar et al., 2019</xref>, plasmid with the core repressilator circuit and reporters; pSpongeROG, a modified version of plasmid pSR58.6 (a gift from Jeffrey Tabor, Addgene plasmid # 63176; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene">http://n2t.net/addgene</ext-link>:63176; RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_63176">Addgene_63176</ext-link>) <xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref> added with the sponge from plasmid pLPT145 (a gift from Johan Paulsson, Addgene plasmid # 85527; <ext-link ext-link-type="uri" xlink:href="http://n2t.net/addgene">http://n2t.net/addgene</ext-link>:85527; RRID:<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/RRID/RRID:Addgene_85527">Addgene_85527</ext-link>) <xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref> and without the light-driven gene expression cassette (sfGFP).</p></sec><sec id="s4-2"><title>Plate reader experiments to follow circuit oscillations</title><p>Bacterial strains were grown from glycerol stock for 16 hr in LB with appropriate antibiotics (see <xref ref-type="table" rid="app1table3">Appendix 1—table 3</xref> for antibiotic working concentration), in a falcon tube exposed to saturating 660 nm red light in a shaker incubator (200 rpm) at 37 ºC. Cultures were diluted <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> approximately 8 hr before the beginning of the experiment in imaging medium (<xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref>) with antibiotics under red light, and 1 mM IPTG was added in this interval if samples had to be chemically synchronized. Samples were transferred in duplicates to a 96-well plate (Greiner GR655096), and we measured OD600 and fluorescence for sCFP, mVenus and mKate2. When OD600 reached approximately 0.8 for the first time, the samples were diluted 1:4 in new wells with imaging medium plus antibiotics. Every two hours, we measured OD600 and fluorescence and diluted about 1:4 in fresh culture medium plus antibiotics to bring the cultures back to an OD of 0.2 and keep the bacteria under exponential growth conditions. OD600 and fluorescence were measured with a TECAN Infinite M Nano +plate reader warmed to 37°C. The parameters to detect fluorescence were: mSCFP3 excitation 433 (±9) nm emission 474 (±20) nm; mVenus excitation 500 (±9) nm emission 540 (±20) nm; mKate2 excitation 588 (±9) nm emission 633 (±20) nm. Between measurements, the well plate was kept in a shaking incubator (100 rpm) at 37°C and individual wells were exposed to the appropriate light conditions through the custom-made light-addressable multiwell plate (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>). The red and green light intensities were respectively: 9.82 W/m<sup>2</sup>, 5.64 W/m<sup>2</sup>. Data were analysed through custom python script. Blank absorbance of the medium was removed. Absorbance was then used to normalize fluorescence with respect to cell count.</p></sec><sec id="s4-3"><title>Plate reader experiments to detect constructs expression range</title><p>Samples were grown from glycerol stocks overnight as in the previous protocol. Cells were refreshed in imaging medium plus antibiotics and OD600 was set to 0.002. Samples were transferred to a 96-well plate and placed in a shaking incubator at 37 °C. There, individual wells were exposed to homogeneous levels of red light and a gradient of green light with the custom device in <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>. Absorbance and sfGFP fluorescence were measured every hour by temporarily moving the plate from the incubator to the plate reader. Data were analysed through custom python script. Protein production rate was calculated as the time derivative of sfGFP concentration divided by OD600 in a selected OD600 interval of exponential growth.</p></sec><sec id="s4-4"><title>Mother machine fabrication</title><p>Master molds with mother machine features were fabricated using a hybrid technique involving standard soft-lithography and two-photon polymerization (<xref ref-type="bibr" rid="bib39">Vanderpoorten et al., 2019</xref>). Firstly, the feeding channel (50 μm-width, 15 μm-height) was fabricated using standard protocols of soft-lithography. Precisely, a SU-8 layer of 15 μm was fabricated by spinning SU-8 2015 onto a soda-lime coverglass (3000 rpm - 30 s, Laurell WS-650Mz-23NPPB). Strong adhesion of the SU8 to the carrier coverglass was ensured by three layers of OmniCoat adhesion promoter (MicroChem Corp). The coverglass was soft-baked, and a microfluidic mask with a pattern of 50 μm-wide channels was projected onto the photoresist (UV KUB 2, 400 mJ - 40 s at 25% of maximum power). The coverglass was soft-baked, post-baked, and developed according to the protocol provided by MicroChem Corp. In addition, the sample was hard-baked for 30 min at 170 °C. A second layer of 20 μm was fabricated on top of the feeding channel by spinning SU-8 2015 at 2000 rpm, followed by a soft-baking of 2 hours at 95 °C. Then, the microfabrication of the micron-size channels was carried out by a custom-built two-photon polymerization setup (<xref ref-type="bibr" rid="bib40">Vizsnyiczai et al., 2017</xref>). The refractive index contrast between cured and uncured SU-8 was used to identify the edge of the largest channel, where a comb of micrometer-sized channels was made by direct laser writing. The whole coverglass was again baked at 95°C and rinsed with PGMEA and IPA. Finally, the master mold was silanized to prevent the PDMS from adhering to the master. PDMS was prepared from a Sylgard 184 Silicone Elastomer kit: polymer base and curing agent were mixed in a 10:1 ratio, and air bubbles were removed from the mixture by centrifugation. The degassed mixture was then poured over the master, and the devices were cured for about 1.5 hr at 90 °C. PDMS chips were peeled from the master mold and bonded to glass by oxygen plasma treatment (15 s at 100 watts) and then baked for 10 min at 120°C.</p></sec><sec id="s4-5"><title>Microscopy</title><p>Phase contrast and epi-fluorescence imaging were performed using a custom-built optical microscope equipped with a <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>100</mml:mn><mml:mo>×</mml:mo></mml:mstyle></mml:math></inline-formula> magnification objective (Nikon MRH11902; NA=1.3) and a high-sensitivity CMOS camera (Hamamatsu Orca-Flash 4.0 V3; see <xref ref-type="fig" rid="app1fig12">Appendix 1—figure 12</xref>). For phase contrast imaging, a deep red LED (Thorlabs M730L4) with low inhibition of the optogenetic expression system was used. Light control was achieved by directing light through a 10:90 beam splitter (R:T, Thorlabs BSN10R) positioned under the objective. Green and red light stimuli were provided by two LEDs (Thorlabs M530L4, Thorlabs M660L4, respectively) coupled through a dichroic mirror (Thorlabs DMLP567R) and passing through a long-pass filter at 550 nm (Thorlabs FELH0550). Epi-fluorescence imaging was conducted using a blue LED (Thorlabs M455L4) and a filter set for the CFP (Chroma 49001-ET-ECFP). To enable imaging in both phase contrast and epi-fluorescence, a motorized filter wheel (Thorlabs FW102C) was used to switch between the fluorescence filter set and a long-pass filter at 700 nm (Thorlabs FWLH0700). To maintain sample focus throughout the entire acquisition process, a custom script was developed. This script scans the sample in height and finally moves to the z-plane where the image of a specific fixed structure in the chip has maximum edge enhancement (calculated with the Sobel function). To avoid drift on the x-y plane, we correlate the acquired image of the fixed structure with one acquired at the beginning of the experiment and compute the shift on the x-y plane. The scanning process was performed using a motorized vertical lift stage (Zaber X-VSR-E) and a motorized microscope stage (Zaber X-ASR100B120B-SE03D12).</p></sec><sec id="s4-6"><title>Mother machine experiments</title><p>Cells were grown from a glycerol stock for 16 hr in LB with appropriate antibiotics, in a 50 mL centrifuge tube exposed to saturating 660 nm red light. Bacteria were refreshed 1:100 in imaging medium under red light until they reached an OD of 0.1 (around 4 hours). 1 mL of culture was centrifuged in an Eppendorf miniSpin Plus centrifuge at 1000 rcf for 5 min and concentrated 50 x. 20 μL of concentrated bacteria were loaded in the mothermachine’s flow channel with a pipette. Bacteria were loaded in the growth channels, by centrifugation of the mothermachine chip for 7 min at 1300 rcf (with soft ramp acceleration) in an Eppendorf Centrifuge 5430 R using the Combislide adapter. The flow channel of the mothermachine was then washed for approximately 5 min with LB with antibiotics and 0.1% BSA at a constant flow of 50 μL/min, to carry away excess bacteria. For the whole duration of the experiments, the mothermachine was perfused with LB with antibiotics and 0.1% BSA at a constant rate of 5.5 μL/min. Green and red light stimuli were provided by the two LEDs (Thorlabs M530L4, Thorlabs M660L4) with respective intensities 6W/m<sup>2</sup> and 26W/m<sup>2</sup> for the synchronization experiments, and 1.1W/m<sup>2</sup> and 4.5W/m<sup>2</sup> for the entrainment experiments.</p></sec><sec id="s4-7"><title>Data analysis: segmentation in the mother machine</title><p>Phase contrast images were taken every 3 min and fluorescence images every 9 min. Phase contrast images were analyzed, to identify the single feeding channels of the microfluidic chip. Single cells were segmented using the pretrained neural network model Cellpose 2.0. We further trained the model with our own data to increase the accuracy of segmentation (<xref ref-type="bibr" rid="bib26">Pachitariu and Stringer, 2022</xref>). The masks obtained after segmentation were used to measure the total fluorescence of the mother cell in all feeding channels of the mother machine as a function of time.</p></sec><sec id="s4-8"><title>Simulations</title><p>All simulations were performed by direct Euler integration of <xref ref-type="disp-formula" rid="equ2">Equation 2</xref> using custom Python program. The selection of model parameters was motivated as follows: the mean value of the growth rate was directly estimated from experiments <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref>); for all promoters we choose a cooperativity index <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula> to both match experimental oscillation profiles and in agreement with <xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref>; for the production rates we chose the value <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup> to match the experimental period <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>T</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mn>17.5</mml:mn><mml:mspace width="thickmathspace"/><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow></mml:mstyle></mml:math></inline-formula>; the maximum light induced production rate <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>80</mml:mn><mml:mspace width="thickmathspace"/><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> was estimated to maximize agreement with experimental data in <xref ref-type="fig" rid="fig5">Figure 5a</xref>.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Data curation, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing, Design and construction of all plasmids and strains</p></fn><fn fn-type="con" id="con2"><p>Data curation, Formal analysis, Validation, Investigation, Methodology, Writing – original draft, Writing – review and editing, Collaboration to plasmid design</p></fn><fn fn-type="con" id="con3"><p>Data curation, Formal analysis, Validation, Investigation, Methodology, Writing – original draft</p></fn><fn fn-type="con" id="con4"><p>Data curation, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing – original draft, Writing – review and editing, Collaboration to plasmid design</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-97754-mdarchecklist1-v1.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material><supplementary-material id="sdata1"><label>Source data 1.</label><caption><title>Plate reader data of optorepressilator detuning (<xref ref-type="fig" rid="fig6">Figure 6b</xref>, <xref ref-type="fig" rid="fig5">Figure 5d</xref>), optorepressilator light-driven synchronization (<xref ref-type="fig" rid="fig4">Figure 4a</xref>) and of repressilator desynchronization (<xref ref-type="fig" rid="fig1">Figure 1b</xref>).</title></caption><media xlink:href="elife-97754-data1-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="sdata2"><label>Source data 2.</label><caption><title>Plate reader data of GFP protein expression levels (<xref ref-type="fig" rid="fig3">Figure 3b</xref>).</title></caption><media xlink:href="elife-97754-data2-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="sdata3"><label>Source data 3.</label><caption><title>Data of mother machine experiments (<xref ref-type="fig" rid="fig4">Figure 4b</xref>, <xref ref-type="fig" rid="fig5">Figure 5e</xref>).</title></caption><media xlink:href="elife-97754-data3-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material><supplementary-material id="sdata4"><label>Source data 4.</label><caption><title>Plate reader data of the comparison between optorepressilator versions (<xref ref-type="fig" rid="fig3">Figure 3d</xref>).</title></caption><media xlink:href="elife-97754-data4-v1.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>All data generated or analysed during this study are included in the manuscript and supporting files.</p></sec><ack id="ack"><title>Acknowledgements</title><p>The research leading to these results has received funding from the European Research Council under the ERC Grant Agreement No. 834615 (GF, NC, RDL) and from the Italian Ministry of University and Research (MUR) under the FARE2020 Grant R20R4X8ZEL (MCC, RDL).</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atkinson</surname><given-names>MR</given-names></name><name><surname>Savageau</surname><given-names>MA</given-names></name><name><surname>Myers</surname><given-names>JT</given-names></name><name><surname>Ninfa</surname><given-names>AJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Development of genetic circuitry exhibiting toggle switch or oscillatory behavior in <italic>Escherichia coli</italic></article-title><source>Cell</source><volume>113</volume><fpage>597</fpage><lpage>607</lpage><pub-id pub-id-type="doi">10.1016/s0092-8674(03)00346-5</pub-id><pub-id pub-id-type="pmid">12787501</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baumschlager</surname><given-names>A</given-names></name><name><surname>Khammash</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Synthetic biological approaches for optogenetics and tools for transcriptional light-control in bacteria</article-title><source>Advanced Biology</source><volume>5</volume><elocation-id>e2000256</elocation-id><pub-id pub-id-type="doi">10.1002/adbi.202000256</pub-id><pub-id pub-id-type="pmid">34028214</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benzinger</surname><given-names>D</given-names></name><name><surname>Ovinnikov</surname><given-names>S</given-names></name><name><surname>Khammash</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Synthetic gene networks recapitulate dynamic signal decoding and differential gene expression</article-title><source>Cell Systems</source><volume>13</volume><fpage>353</fpage><lpage>364</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2022.02.004</pub-id><pub-id pub-id-type="pmid">35298924</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chernov</surname><given-names>KG</given-names></name><name><surname>Redchuk</surname><given-names>TA</given-names></name><name><surname>Omelina</surname><given-names>ES</given-names></name><name><surname>Verkhusha</surname><given-names>VV</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Near-infrared fluorescent proteins, biosensors, and optogenetic tools engineered from phytochromes</article-title><source>Chemical Reviews</source><volume>117</volume><fpage>6423</fpage><lpage>6446</lpage><pub-id pub-id-type="doi">10.1021/acs.chemrev.6b00700</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cookson</surname><given-names>NA</given-names></name><name><surname>Tsimring</surname><given-names>LS</given-names></name><name><surname>Hasty</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>The pedestrian watchmaker: genetic clocks from engineered oscillators</article-title><source>FEBS Letters</source><volume>583</volume><fpage>3931</fpage><lpage>3937</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2009.10.089</pub-id><pub-id pub-id-type="pmid">19903483</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Danino</surname><given-names>T</given-names></name><name><surname>Mondragón-Palomino</surname><given-names>O</given-names></name><name><surname>Tsimring</surname><given-names>L</given-names></name><name><surname>Hasty</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A synchronized quorum of genetic clocks</article-title><source>Nature</source><volume>463</volume><fpage>326</fpage><lpage>330</lpage><pub-id pub-id-type="doi">10.1038/nature08753</pub-id><pub-id pub-id-type="pmid">20090747</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Datsenko</surname><given-names>KA</given-names></name><name><surname>Wanner</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>One-step inactivation of chromosomal genes in <italic>Escherichia coli</italic> K-12 using PCR products</article-title><source>PNAS</source><volume>97</volume><fpage>6640</fpage><lpage>6645</lpage><pub-id pub-id-type="doi">10.1073/pnas.120163297</pub-id><pub-id pub-id-type="pmid">10829079</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Davidson</surname><given-names>EA</given-names></name><name><surname>Basu</surname><given-names>AS</given-names></name><name><surname>Bayer</surname><given-names>TS</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Programming microbes using pulse width modulation of optical signals</article-title><source>Journal of Molecular Biology</source><volume>425</volume><fpage>4161</fpage><lpage>4166</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2013.07.036</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elowitz</surname><given-names>MB</given-names></name><name><surname>Leibler</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>A synthetic oscillatory network of transcriptional regulators</article-title><source>Nature</source><volume>403</volume><fpage>335</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1038/35002125</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernandez-Rodriguez</surname><given-names>J</given-names></name><name><surname>Moser</surname><given-names>F</given-names></name><name><surname>Song</surname><given-names>M</given-names></name><name><surname>Voigt</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Engineering RGB color vision into <italic>Escherichia coli</italic></article-title><source>Nature Chemical Biology</source><volume>13</volume><fpage>706</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1038/nchembio.2390</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frangipane</surname><given-names>G</given-names></name><name><surname>Dell’Arciprete</surname><given-names>D</given-names></name><name><surname>Petracchini</surname><given-names>S</given-names></name><name><surname>Maggi</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dynamic density shaping of photokinetic <italic>E. coli</italic></article-title><source>eLife</source><volume>7</volume><elocation-id>e36608</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.36608</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fraser</surname><given-names>A</given-names></name><name><surname>Tiwari</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1974">1974</year><article-title>Cyclic genetic systems</article-title><source>Journal of Theoretical Biology</source><volume>47</volume><fpage>397</fpage><lpage>412</lpage><pub-id pub-id-type="doi">10.1016/0022-5193(74)90206-9</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Golombek</surname><given-names>DA</given-names></name><name><surname>Rosenstein</surname><given-names>RE</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Physiology of circadian entrainment</article-title><source>Physiological Reviews</source><volume>90</volume><fpage>1063</fpage><lpage>1102</lpage><pub-id pub-id-type="doi">10.1152/physrev.00009.2009</pub-id><pub-id pub-id-type="pmid">20664079</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Granada</surname><given-names>A</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name><name><surname>Ronacher</surname><given-names>B</given-names></name><name><surname>Kramer</surname><given-names>A</given-names></name><name><surname>Herzel</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2009">2009</year><chapter-title>Chapter 1 Phase response curves: elucidating the dynamics of coupled oscillators</chapter-title><source>Methods in Enzymology</source><publisher-name>Elsevier</publisher-name><fpage>1</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1016/S0076-6879(08)03801-9</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutiérrez Mena</surname><given-names>J</given-names></name><name><surname>Kumar</surname><given-names>S</given-names></name><name><surname>Khammash</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Dynamic cybergenetic control of bacterial co-culture composition via optogenetic feedback</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>4808</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-32392-z</pub-id><pub-id pub-id-type="pmid">35798721</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heltberg</surname><given-names>M</given-names></name><name><surname>Kellogg</surname><given-names>RA</given-names></name><name><surname>Krishna</surname><given-names>S</given-names></name><name><surname>Tay</surname><given-names>S</given-names></name><name><surname>Jensen</surname><given-names>MH</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Noise induces hopping between nf-κb entrainment modes</article-title><source>Cell Systems</source><volume>3</volume><fpage>532</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1016/j.cels.2016.11.014</pub-id><pub-id pub-id-type="pmid">28009264</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jin</surname><given-names>X</given-names></name><name><surname>Riedel-Kruse</surname><given-names>IH</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Biofilm Lithography enables high-resolution cell patterning via optogenetic adhesin expression</article-title><source>PNAS</source><volume>115</volume><fpage>3698</fpage><lpage>3703</lpage><pub-id pub-id-type="doi">10.1073/pnas.1720676115</pub-id><pub-id pub-id-type="pmid">29555779</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levskaya</surname><given-names>A</given-names></name><name><surname>Chevalier</surname><given-names>AA</given-names></name><name><surname>Tabor</surname><given-names>JJ</given-names></name><name><surname>Simpson</surname><given-names>ZB</given-names></name><name><surname>Lavery</surname><given-names>LA</given-names></name><name><surname>Levy</surname><given-names>M</given-names></name><name><surname>Davidson</surname><given-names>EA</given-names></name><name><surname>Scouras</surname><given-names>A</given-names></name><name><surname>Ellington</surname><given-names>AD</given-names></name><name><surname>Marcotte</surname><given-names>EM</given-names></name><name><surname>Voigt</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Engineering <italic>Escherichia coli</italic> to see light</article-title><source>Nature</source><volume>438</volume><fpage>441</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1038/nature04405</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Jin</surname><given-names>J</given-names></name><name><surname>Geng</surname><given-names>Z</given-names></name><name><surname>Qi</surname><given-names>Q</given-names></name><name><surname>Liang</surname><given-names>Q</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Programming bacteria with light-sensors and applications in synthetic biology</article-title><source>Frontiers in Microbiology</source><volume>9</volume><elocation-id>2692</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2018.02692</pub-id><pub-id pub-id-type="pmid">30467500</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milias-Argeitis</surname><given-names>A</given-names></name><name><surname>Rullan</surname><given-names>M</given-names></name><name><surname>Aoki</surname><given-names>SK</given-names></name><name><surname>Buchmann</surname><given-names>P</given-names></name><name><surname>Khammash</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Automated optogenetic feedback control for precise and robust regulation of gene expression and cell growth</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>12546</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms12546</pub-id><pub-id pub-id-type="pmid">27562138</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mirollo</surname><given-names>RE</given-names></name><name><surname>Strogatz</surname><given-names>SH</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Synchronization of pulse-coupled biological oscillators</article-title><source>SIAM Journal on Applied Mathematics</source><volume>50</volume><fpage>1645</fpage><lpage>1662</lpage><pub-id pub-id-type="doi">10.1137/0150098</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mondragón-Palomino</surname><given-names>O</given-names></name><name><surname>Danino</surname><given-names>T</given-names></name><name><surname>Selimkhanov</surname><given-names>J</given-names></name><name><surname>Tsimring</surname><given-names>L</given-names></name><name><surname>Hasty</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Entrainment of a population of synthetic genetic oscillators</article-title><source>Science</source><volume>333</volume><fpage>1315</fpage><lpage>1319</lpage><pub-id pub-id-type="doi">10.1126/science.1205369</pub-id><pub-id pub-id-type="pmid">21885786</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Olson</surname><given-names>EJ</given-names></name><name><surname>Hartsough</surname><given-names>LA</given-names></name><name><surname>Landry</surname><given-names>BP</given-names></name><name><surname>Shroff</surname><given-names>R</given-names></name><name><surname>Tabor</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Characterizing bacterial gene circuit dynamics with optically programmed gene expression signals</article-title><source>Nature Methods</source><volume>11</volume><fpage>449</fpage><lpage>455</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2884</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ong</surname><given-names>NT</given-names></name><name><surname>Tabor</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>A miniaturized <italic>Escherichia coli</italic> green light sensor with high dynamic range</article-title><source>ChemBioChem</source><volume>19</volume><fpage>1255</fpage><lpage>1258</lpage><pub-id pub-id-type="doi">10.1002/cbic.201800007</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ozbudak</surname><given-names>EM</given-names></name><name><surname>Thattai</surname><given-names>M</given-names></name><name><surname>Lim</surname><given-names>HN</given-names></name><name><surname>Shraiman</surname><given-names>BI</given-names></name><name><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Multistability in the lactose utilization network of <italic>Escherichia coli</italic></article-title><source>Nature</source><volume>427</volume><fpage>737</fpage><lpage>740</lpage><pub-id pub-id-type="doi">10.1038/nature02298</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachitariu</surname><given-names>M</given-names></name><name><surname>Stringer</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Cellpose 2.0: how to train your own model</article-title><source>Nature Methods</source><volume>19</volume><fpage>1634</fpage><lpage>1641</lpage><pub-id pub-id-type="doi">10.1038/s41592-022-01663-4</pub-id><pub-id pub-id-type="pmid">36344832</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pikovsky</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Synchronization: A Universal Concept in Nonlinear Sciences</source><publisher-loc>New York</publisher-loc><publisher-name>Cambridge U Press</publisher-name></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Potvin-Trottier</surname><given-names>L</given-names></name><name><surname>Lord</surname><given-names>ND</given-names></name><name><surname>Vinnicombe</surname><given-names>G</given-names></name><name><surname>Paulsson</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synchronous long-term oscillations in a synthetic gene circuit</article-title><source>Nature</source><volume>538</volume><fpage>514</fpage><lpage>517</lpage><pub-id pub-id-type="doi">10.1038/nature19841</pub-id><pub-id pub-id-type="pmid">27732583</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prindle</surname><given-names>A</given-names></name><name><surname>Samayoa</surname><given-names>P</given-names></name><name><surname>Razinkov</surname><given-names>I</given-names></name><name><surname>Danino</surname><given-names>T</given-names></name><name><surname>Tsimring</surname><given-names>LS</given-names></name><name><surname>Hasty</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A sensing array of radically coupled genetic “biopixels.”</article-title><source>Nature</source><volume>481</volume><fpage>39</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.1038/nature10722</pub-id><pub-id pub-id-type="pmid">22178928</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purcell</surname><given-names>O</given-names></name><name><surname>Savery</surname><given-names>NJ</given-names></name><name><surname>Grierson</surname><given-names>CS</given-names></name><name><surname>di Bernardo</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A comparative analysis of synthetic genetic oscillators</article-title><source>Journal of the Royal Society, Interface</source><volume>7</volume><fpage>1503</fpage><lpage>1524</lpage><pub-id pub-id-type="doi">10.1098/rsif.2010.0183</pub-id><pub-id pub-id-type="pmid">20591848</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riglar</surname><given-names>DT</given-names></name><name><surname>Richmond</surname><given-names>DL</given-names></name><name><surname>Potvin-Trottier</surname><given-names>L</given-names></name><name><surname>Verdegaal</surname><given-names>AA</given-names></name><name><surname>Naydich</surname><given-names>AD</given-names></name><name><surname>Bakshi</surname><given-names>S</given-names></name><name><surname>Leoncini</surname><given-names>E</given-names></name><name><surname>Lyon</surname><given-names>LG</given-names></name><name><surname>Paulsson</surname><given-names>J</given-names></name><name><surname>Silver</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bacterial variability in the mammalian gut captured by a single-cell synthetic oscillator</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>4665</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-12638-z</pub-id><pub-id pub-id-type="pmid">31604953</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sanchez</surname><given-names>PGL</given-names></name><name><surname>Mochulska</surname><given-names>V</given-names></name><name><surname>Mauffette Denis</surname><given-names>C</given-names></name><name><surname>Mönke</surname><given-names>G</given-names></name><name><surname>Tomita</surname><given-names>T</given-names></name><name><surname>Tsuchida-Straeten</surname><given-names>N</given-names></name><name><surname>Petersen</surname><given-names>Y</given-names></name><name><surname>Sonnen</surname><given-names>K</given-names></name><name><surname>François</surname><given-names>P</given-names></name><name><surname>Aulehla</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Arnold tongue entrainment reveals dynamical principles of the embryonic segmentation clock</article-title><source>eLife</source><volume>11</volume><elocation-id>e79575</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.79575</pub-id><pub-id pub-id-type="pmid">36223168</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidl</surname><given-names>SR</given-names></name><name><surname>Sheth</surname><given-names>RU</given-names></name><name><surname>Wu</surname><given-names>A</given-names></name><name><surname>Tabor</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Refactoring and optimization of light-switchable <italic>Escherichia coli</italic> two-component systems</article-title><source>ACS Synthetic Biology</source><volume>3</volume><fpage>820</fpage><lpage>831</lpage><pub-id pub-id-type="doi">10.1021/sb500273n</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheets</surname><given-names>MB</given-names></name><name><surname>Tague</surname><given-names>N</given-names></name><name><surname>Dunlop</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>An optogenetic toolkit for light-inducible antibiotic resistance</article-title><source>Nature Communications</source><volume>14</volume><elocation-id>1034</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-023-36670-2</pub-id><pub-id pub-id-type="pmid">36823420</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>St Hilaire</surname><given-names>MA</given-names></name><name><surname>Gooley</surname><given-names>JJ</given-names></name><name><surname>Khalsa</surname><given-names>SBS</given-names></name><name><surname>Kronauer</surname><given-names>RE</given-names></name><name><surname>Czeisler</surname><given-names>CA</given-names></name><name><surname>Lockley</surname><given-names>SW</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Human phase response curve to a 1 h pulse of bright white light</article-title><source>The Journal of Physiology</source><volume>590</volume><fpage>3035</fpage><lpage>3045</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2012.227892</pub-id><pub-id pub-id-type="pmid">22547633</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stricker</surname><given-names>J</given-names></name><name><surname>Cookson</surname><given-names>S</given-names></name><name><surname>Bennett</surname><given-names>MR</given-names></name><name><surname>Mather</surname><given-names>WH</given-names></name><name><surname>Tsimring</surname><given-names>LS</given-names></name><name><surname>Hasty</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A fast, robust and tunable synthetic gene oscillator</article-title><source>Nature</source><volume>456</volume><fpage>516</fpage><lpage>519</lpage><pub-id pub-id-type="doi">10.1038/nature07389</pub-id><pub-id pub-id-type="pmid">18971928</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tabor</surname><given-names>JJ</given-names></name><name><surname>Salis</surname><given-names>HM</given-names></name><name><surname>Simpson</surname><given-names>ZB</given-names></name><name><surname>Chevalier</surname><given-names>AA</given-names></name><name><surname>Levskaya</surname><given-names>A</given-names></name><name><surname>Marcotte</surname><given-names>EM</given-names></name><name><surname>Voigt</surname><given-names>CA</given-names></name><name><surname>Ellington</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A synthetic genetic edge detection program</article-title><source>Cell</source><volume>137</volume><fpage>1272</fpage><lpage>1281</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2009.04.048</pub-id><pub-id pub-id-type="pmid">19563759</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tabor</surname><given-names>JJ</given-names></name><name><surname>Levskaya</surname><given-names>A</given-names></name><name><surname>Voigt</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Multichromatic control of gene expression in <italic>Escherichia coli</italic></article-title><source>Journal of Molecular Biology</source><volume>405</volume><fpage>315</fpage><lpage>324</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2010.10.038</pub-id><pub-id pub-id-type="pmid">21035461</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vanderpoorten</surname><given-names>O</given-names></name><name><surname>Peter</surname><given-names>Q</given-names></name><name><surname>Challa</surname><given-names>PK</given-names></name><name><surname>Keyser</surname><given-names>UF</given-names></name><name><surname>Baumberg</surname><given-names>J</given-names></name><name><surname>Kaminski</surname><given-names>CF</given-names></name><name><surname>Knowles</surname><given-names>TPJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Scalable integration of nano-, and microfluidics with hybrid two-photon lithography</article-title><source>Microsystems &amp; Nanoengineering</source><volume>5</volume><elocation-id>40</elocation-id><pub-id pub-id-type="doi">10.1038/s41378-019-0080-3</pub-id><pub-id pub-id-type="pmid">31636930</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vizsnyiczai</surname><given-names>G</given-names></name><name><surname>Frangipane</surname><given-names>G</given-names></name><name><surname>Maggi</surname><given-names>C</given-names></name><name><surname>Saglimbeni</surname><given-names>F</given-names></name><name><surname>Bianchi</surname><given-names>S</given-names></name><name><surname>Di Leonardo</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Light controlled 3D micromotors powered by bacteria</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>15974</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms15974</pub-id><pub-id pub-id-type="pmid">28656975</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>MW</given-names></name><name><surname>Kay</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Time zones: A comparative genetics of circadian clocks</article-title><source>Nature Reviews Genetics</source><volume>2</volume><fpage>702</fpage><lpage>715</lpage><pub-id pub-id-type="doi">10.1038/35088576</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Luo</surname><given-names>Y</given-names></name><name><surname>Poh</surname><given-names>CL</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Blue light-directed cell migration, aggregation, and patterning</article-title><source>Journal of Molecular Biology</source><volume>432</volume><fpage>3137</fpage><lpage>3148</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2020.03.029</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>EM</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Mehl</surname><given-names>J</given-names></name><name><surname>Park</surname><given-names>H</given-names></name><name><surname>Lalwani</surname><given-names>MA</given-names></name><name><surname>Toettcher</surname><given-names>JE</given-names></name><name><surname>Avalos</surname><given-names>JL</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Optogenetic regulation of engineered cellular metabolism for microbial chemical production</article-title><source>Nature</source><volume>555</volume><fpage>683</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1038/nature26141</pub-id><pub-id pub-id-type="pmid">29562237</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>1. Analytical solution of repressilator dynamics in the digital approximation</title><p>In the digital approximation, Hill functions in <xref ref-type="disp-formula" rid="equ5">Equation A1</xref> in the main text are replaced by <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Θ</mml:mi></mml:mstyle></mml:math></inline-formula> functions and equations become piecewise linear first order. Oscillations are therefore built by joining together rising (to steady value <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula>) or decaying (to 0) exponentials with rate <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula>, calling with <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>M</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> respectively the maximum and minimum values in the oscillations. <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle></mml:math></inline-formula> is the interval between two maxima of two different proteins and <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi></mml:mstyle></mml:math></inline-formula> is the time interval to rise from the minimum <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> to 1 (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). All concentrations are measured in units of <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula> so 1 represents the activation threshold. We can write the following four equations in the unknowns <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ5"><label>(A1)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>M</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ6"><label>(A2)</label><mml:math id="m6"><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:math></disp-formula><disp-formula id="equ7"><label>(A3)</label><mml:math id="m7"><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:math></disp-formula><disp-formula id="equ8"><label>(A4)</label><mml:math id="m8"><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:math></disp-formula></p><p>Where, for simplicity of notation, we measure time in units of <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>α</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Simulations of the digital model.</title><p><inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively, are the maximum and minimum values in the oscillations and is the time interval to rise from the minimum <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> to 1 (threshold value in <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> units).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig1-v1.tif"/></fig><p>From <xref ref-type="disp-formula" rid="equ5 equ6">Equation A1 and A2</xref> we find:<disp-formula id="equ9"><label>(A5)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and<disp-formula id="equ10"><label>(A6)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>δ</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which substituted in (<xref ref-type="disp-formula" rid="equ7">Equation A3</xref>) and (<xref ref-type="disp-formula" rid="equ8">Equation A4</xref>) give:<disp-formula id="equ11"><label>(A7)</label><mml:math id="m11"><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mi>m</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>M</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:math></disp-formula><disp-formula id="equ12"><label>(A8)</label><mml:math id="m12"><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msqrt><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msqrt><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></disp-formula></p><p>The two equations above can be solved numerically to get <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>M</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> once <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi></mml:mstyle></mml:math></inline-formula> is known. However if, as in our case, <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mo>≫</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> we can find the approximate solutions:<disp-formula id="equ13"><label>(A9)</label><mml:math id="m13"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mspace width="thickmathspace"/><mml:mo>,</mml:mo><mml:mspace width="thickmathspace"/><mml:mspace width="thickmathspace"/><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:math></disp-formula></p><p>Substituting back in (<xref ref-type="disp-formula" rid="equ9">Equation A5</xref>) we get<disp-formula id="equ14"><label>(A10)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>β</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and thus for the entire period<disp-formula id="equ15"><label>(A11)</label><mml:math id="m15"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>β</mml:mi></mml:math></disp-formula></p><p>Finally reintroducing the time scale <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> we can write for the period<disp-formula id="equ16"><label>(A12)</label><mml:math id="m16"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mi>α</mml:mi></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac></mml:math></disp-formula></p></sec><sec sec-type="appendix" id="s9"><title>2. Growth rate estimate</title><p>Growth rate analysis of the optorepressilator data displayed in <xref ref-type="fig" rid="fig6">Figure 6b</xref> in the main text.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Analysis to estimate growth rate from experimental data.</title><p>(<bold>a</bold>) Raw absorbance data from one individual sample in the plate reader experiment. The initial gray area is removed from further analysis to ensure samples reached stable growth conditions. (<bold>b</bold>) Minimum and maximum OD600 points (respectively in yellow and red) in log scale are fitted with a line to extract the growth rate as its slope. (<bold>c</bold>) Distribution of the growth rates. Median and mean of the distribution are shown respectively in black and orange. Due to the non-symmetric distribution, we used the median to summarize the growth rate. (<bold>d</bold>) Box plots of the growth rates for each sample, all grown in parallel. The blue line inside the box plots is the median. The black line is the mean of all medians, our estimate growth rate (<inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0.75</mml:mn><mml:mo>±</mml:mo><mml:mn>0.01</mml:mn><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>) for the optorepressilator in plate reader experiments. The gray area represents the mean growth rate ± the standard deviation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig2-v1.tif"/></fig></sec><sec sec-type="appendix" id="s10"><title>3. Custom-made light-addressable multiwell plate</title><p>The custom-made light-addressable multiwell plate was made using an Adafruit NeoPixel NeoMatrix 8×8, a matrix of 64 RGB LEDs, attached to the bottom of a Greiner 96 well plate with black wells and removed bottoms (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3a</xref>). The matrix was placed so that each LED was directly under an individual well. An opaque foam layer was cut in order to accommodate LEDs, adjusting the matrix to the plate and reducing well-to-well light contamination. An additional plate was fixed on top of this structure to decrease light intensity on samples by increasing the distance between LEDs and samples. Opaque foam layers were cut in correspondence with the wells and attached above and below this plate, again to avoid well-to-well light contamination. The construct was fixed to a shaking incubator (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3b</xref>). A 96 well plate could be placed on top of it and removed for data acquisition. A darkened lid was placed on the samples’ plate to block environment light. The LEDs matrix was controlled with an Arduino microcontroller. To ensure correct timing of inputs, we employed an AZDelivery Real Time Clock module. LEDs intensity on samples was measured with Thorlabs Standard Photodiode Power Sensor S121C.</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Illustration of the light-addressable multiwell plate.</title><p>(<bold>a</bold>) Scheme of a longitudinal section of the device, with key components highlighted. (<bold>b</bold>) Frontal picture of the custom-made light-addressable multiwell plate placed in a shaking incubator. The sample plate and dark lid are partially lifted. (<bold>c</bold>) Top-down picture of the device. Dark lid and sample plate are removed and LEDs are on.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig3-v1.tif"/></fig></sec><sec sec-type="appendix" id="s11"><title>4. Period normalized by growth rate</title><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Period of different constructs overlaps when normalized by growth rate.</title><p>(<bold>a</bold>) Fluorescence intensities of the repressilator and optorepressilator, as shown in <xref ref-type="fig" rid="fig3">Figure 3d</xref>. (<bold>b</bold>) Time axis rescaled: time points of samples in a multiplied by their respective growth rates <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> (0.87 h<sup>-1</sup>, 0.76 h<sup>-1</sup>) and aligned to a common initial time. Post-rescaling, the oscillations of the repressilator and optorepressilator overlap nicely.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig4-v1.tif"/></fig></sec><sec sec-type="appendix" id="s12"><title>5. Effect of leakage on the period and stability of the oscillations</title><p>Leakage from the optogenetic <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> promoter can destroy limit cycle oscillations and collapse the system into a stable fixed point. To study how leakage affects oscillations we employ linear stability analysis. In the absence of leakage (<inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>), the system of equations is symmetric and the fixed point is <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ξ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> satisfies the following condition:<disp-formula id="equ17"><label>(A13)</label><mml:math id="m17"><mml:msub><mml:mi>ξ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>ξ</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>Leakage <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> makes the system asymmetric and the new fixed point coordinates <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> satisfy the following conditions:<disp-formula id="equ18"><label>(A14)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>z</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mspace width="2em"/><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>x</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="2em"/><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Linearizing around the fixed point, we can write for the displacements:<disp-formula id="equ19"><label>(A15)</label><mml:math id="m19"><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>δ</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>δ</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>δ</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>with:<disp-formula id="equ20"><label>(A16)</label><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>γ</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msubsup><mml:mi>z</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/><mml:msub><mml:mi>γ</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mspace width="2em"/><mml:msub><mml:mi>γ</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:msubsup><mml:mi>y</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Rewriting <xref ref-type="disp-formula" rid="equ19">Equation A15</xref> in matrix form we have:<disp-formula id="equ21"><label>(A17)</label><mml:math id="m21"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The three eigenvalues of <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mi>π</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>3</mml:mn></mml:mroot></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. The fixed point is stable when all the eigenvalues have a positive real part (<inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>). At <inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> we have an Hopf bifurcation and for <inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> two eigenvalues acquire a negative real part and a limit cycle arises. We numerically calculated <inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of normalized leakage <inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> for the same parameters we used in all the simulations (<inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup>, <inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup>, <inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>). Results are shown in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref> showing that the Hopf bifurcation occurs for <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>3.24</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p>When no leakage is present, <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the production of <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula> induced by green light. As discussed in the main text we estimate an experimental value for <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>107</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>. This means that in all experiments reported here, light intensity is always strong enough to break limit cycle oscillations if continuously exposed.</p><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Simulations of leakage’s effect on limit cycle and period.</title><p>(<bold>a</bold>) <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>γ</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> vs leakage shows that increasing the leakage past a certain threshold the existing limit cycle breaks down and the system does damped oscillations towards the fixed point. (<bold>b</bold>) The period of the oscillator is affected by the leakage. We plot the curves for the two hill coefficients treated in the manuscript. For <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula> the period is monotonically decreasing in response to leakage increase, suggesting that the period increase in the optorepressilator respect to the repressilator (<xref ref-type="fig" rid="fig3">Figure 3d</xref> main text) is not leakage. In the digital case (<inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>) we see that the leakage breaks the limit cycle for values of <inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig5-v1.tif"/></fig></sec><sec sec-type="appendix" id="s13"><title>6. Quantification of gene expression levels as a function of light intensity</title><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Samples are DHL708 <italic>E. coli</italic> strain with pNO286-3 plasmid, added with sfGFP light-driven production construct as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref> of the main text, while control (’ctr’) is DHL708+pNO286-3+pSR58-0.</title><p>(<bold>a</bold>) Protein production rate over green light intensity (same data as <xref ref-type="fig" rid="fig3">Figure 3b</xref>). While being exposed to different green light intensities, all samples were also constantly exposed to 0.74 W/m<sup>2</sup> red light. Dots are the mean values of experiments repeated on 3 different days. (<bold>b</bold>) Raw OD600 (top) and sfGFP fluorescence (bottom) data for one of the sfGFP production replicates.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig6-v1.tif"/></fig></sec><sec sec-type="appendix" id="s14"><title>7. Dependence of Phase Response Curves (PRC) on <inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula></title><fig id="app1fig7" position="float"><label>Appendix 1—figure 7.</label><caption><title>Impact of light dependent production rate β’ and input duration τ on Phase Response Curves.</title><p>(<bold>a</bold>) PRCs of the optorepressilator for <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> h and <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> varying logarithmically between 1 h<sup>-1</sup> and 10<sup>4</sup> h<sup>-1</sup>. (<bold>b</bold>) PRCs of the optorepressilator for <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>80</mml:mn></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup> and <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula> varying between 0.02 h and 75 h. (<bold>c</bold>) PRCs of the optorepressilator in the digital approximation (<inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>) for varying <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula>. The black dashed lines represent the theoretical prediction as described below. The other parameters used in the simulations are <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup>, <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>300</mml:mn></mml:mstyle></mml:math></inline-formula> h<sup>-1</sup>, <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig7-v1.tif"/></fig><p>Within the digital approximation (<inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>) we can derive approximate expressions for the phase response curve as follows.</p><sec sec-type="appendix" id="s14-1"><title>Case <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula></title> <p>When the pulse arrives at a time delay <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi></mml:mstyle></mml:math></inline-formula> after the peak, a bump in <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> is produced whose rise time is <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>τ</mml:mi></mml:mstyle></mml:math></inline-formula> while the time <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>t</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> to decay to the threshold value 1 is given by:<disp-formula id="equ22"><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> decays to the threshold after <inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> than the next <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> peak will be delayed by a time:<disp-formula id="equ23"><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mn>3</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>corresponding to a negative phase shift:<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mi>τ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The predicted PRC as a negative slope equal to –1 and a intercept that depends on the intensity and duration of the light pulse.</p></sec><sec sec-type="appendix" id="s14-2"><title>Case <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula></title> <p>When the pulse arrives before the peak (<inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>) it triggers the decay of <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> (blue trace) which will reach the threshold 1 after a time <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>t</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> given by:<disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>When <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>y</mml:mi></mml:mstyle></mml:math></inline-formula> reaches the threshold, <inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>z</mml:mi></mml:mstyle></mml:math></inline-formula> production will be turned on and quickly reach the threshold for repressing <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula>. From this moment <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>x</mml:mi></mml:mstyle></mml:math></inline-formula> will start decaying and reach the threshold after a time <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>t</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi><mml:mi class="MJX-variant" mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Using the previously obtained expression for the period <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> we can finally find that the phase will be positively shifted by:<disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>ϕ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>This time the PRC is insensitive to the intensity and duration of the light pulse.</p><p>These two analytic expressions for the PRC are reported as black dashed lines in <xref ref-type="fig" rid="app1fig7">Appendix 1—figure 7</xref>.</p></sec></sec><sec sec-type="appendix" id="s15"><title>8. Exploring &quot;Arnold surface&quot; at low forcing</title><fig id="app1fig8" position="float"><label>Appendix 1—figure 8.</label><caption><title>Simulations of optorepressilators’ response to low forcing amplitude at various frequencies.</title><p>(<bold>a</bold>) Arnold surface calculated as in <xref ref-type="fig" rid="fig6">Figure 6</xref> of main text, with red circles to highlight the values of forcing amplitudes and frequencies used for plots in (<bold>b</bold> and <bold>c</bold>). We notice that at a forcing frequency ratios of 1.5 and 1.25, entrainment is achieved only for the higher amplitude values. Interestingly, when moving in between the main plateaus in the Arnold surface we find entrainment at fractional frequency ratios such as <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>2</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>3</mml:mn><mml:mspace width="thickmathspace"/><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> at <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>3</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mspace width="thickmathspace"/><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> at <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.67</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig8-v1.tif"/></fig></sec><sec sec-type="appendix" id="s16"><title>9. Correlation of period and amplitude with growth rate</title><fig id="app1fig9" position="float"><label>Appendix 1—figure 9.</label><caption><title><inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi></mml:mstyle></mml:math></inline-formula> values are changed from <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>1</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>10</mml:mn></mml:mstyle></mml:math></inline-formula> of the standard value (<inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0.75</mml:mn><mml:msup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mtext>h</mml:mtext></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>) to 10 times as much.</title><p>Amplitude is dimensionless, in units of <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>K</mml:mi></mml:mstyle></mml:math></inline-formula>. Dots are simulations, the continuous lines are predictions with <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula> or digital approximation <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig9-v1.tif"/></fig></sec><sec sec-type="appendix" id="s17"><title>10. Strains</title><table-wrap id="app1table1" position="float"><label>Appendix 1—table 1.</label><caption><title><italic>Escherichia coli</italic> strains used in this work.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Bacterial strain</th><th align="left" valign="bottom">Genotype</th><th align="left" valign="bottom">Source</th><th align="left" valign="bottom">Parent</th></tr></thead><tbody><tr><td align="left" valign="bottom">DHL708</td><td align="left" valign="bottom">MC4100<inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>p</mml:mi><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:mstyle></mml:math></inline-formula></td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">MCC0234</td><td align="left" valign="bottom">DHL708 <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi><mml:mo>::</mml:mo><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mn>34</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula><break/><inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>B</mml:mi><mml:mn>0034</mml:mn><mml:mtext> </mml:mtext><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><break/></td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">DHL708</td></tr><tr><td align="left" valign="bottom">MCC0233</td><td align="left" valign="bottom">DHL708 <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi><mml:mo>::</mml:mo><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mn>33</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>B</mml:mi><mml:mn>0033</mml:mn><mml:mtext> </mml:mtext><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>I</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><break/></td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">DHL708</td></tr><tr><td align="left" valign="bottom">MCC0034</td><td align="left" valign="bottom">DHL708 <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi><mml:mo>::</mml:mo><mml:mi>g</mml:mi><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mn>34</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>B</mml:mi><mml:mn>0034</mml:mn><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><break/></td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">DHL708</td></tr><tr><td align="left" valign="bottom">MCC0033</td><td align="left" valign="bottom">DHL708 <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi><mml:mo>::</mml:mo><mml:mi>g</mml:mi><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mn>33</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula><inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mi>a</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi>B</mml:mi><mml:mn>0033</mml:mn><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>f</mml:mi><mml:mi>g</mml:mi><mml:mi>f</mml:mi><mml:mi>p</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula><break/></td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">DHL708</td></tr></tbody></table></table-wrap><fig id="app1fig10" position="float"><label>Appendix 1—figure 10.</label><caption><title>Maps of the original <italic>attB</italic> site and genome insertions.</title><p>Genome sites correspond to <italic>E. coli</italic> strains: MCC0034 top left, MCC0033 bottom left, MCC0234 top right, MCC0233 bottom right. All maps are created with SnapGene.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig10-v1.tif"/></fig></sec><sec sec-type="appendix" id="s18"><title>11. Plasmids</title><table-wrap id="app1table2" position="float"><label>Appendix 1—table 2.</label><caption><title>Plasmids.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Plasmid</th><th align="left" valign="bottom">Description</th><th align="left" valign="bottom">Source</th><th align="left" valign="bottom">Parent</th></tr></thead><tbody><tr><td align="left" valign="bottom">pLPT234</td><td align="left" valign="bottom">core repressilator componentsand reporters</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib31">Riglar et al., 2019</xref></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">pLPT145</td><td align="left" valign="bottom">repressors’ sponge</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib28">Potvin-Trottier et al., 2016</xref></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">pNO286-3</td><td align="left" valign="bottom">light sensor andPCB enzymes</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib24">Ong and Tabor, 2018</xref></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">pSR58.6</td><td align="left" valign="bottom">CcaR, light-drivensfGFP production(RBS BBa_B0034)</td><td align="left" valign="bottom"><xref ref-type="bibr" rid="bib33">Schmidl et al., 2014</xref></td><td align="left" valign="bottom"/></tr><tr><td align="left" valign="bottom">pSR58.b33</td><td align="left" valign="bottom">CcaR, light-drivensfGFP production(RBS BBa_B0033)</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pSR58.6</td></tr><tr><td align="left" valign="bottom">pSR58-0</td><td align="left" valign="bottom">CcaR, no <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>p</mml:mi><mml:mi>c</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>172</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> nor sfGFP<break/></td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pSR58.6</td></tr><tr><td align="left" valign="bottom">pSpongeROG.b34</td><td align="left" valign="bottom">light-driven LacI production (RBS BBa_B0034), repressors’s sponge, CcaR</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pSR58.6 (backbone), pLPT145 (sponge), pLPT234 (lacI)</td></tr><tr><td align="left" valign="bottom">pSpongeROG.b33</td><td align="left" valign="bottom">light-driven LacIproduction(RBS BBa_B0033),repressors’s sponge,CcaR</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pSR58.6 (backbone), pLPT145 (sponge), pLPT234 (lacI)</td></tr><tr><td align="left" valign="bottom">pSpongeROG0</td><td align="left" valign="bottom">repressors’s sponge,CcaR</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pSR58.6 (backbone), pLPT145 (sponge)</td></tr><tr><td align="left" valign="bottom">pKD46-sfGFP.b34</td><td align="left" valign="bottom">genome insertionof light-drivensfGFP cassette</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pKD46 (backbone),pSR58.6</td></tr><tr><td align="left" valign="bottom">pKD46-sfGFP.b33</td><td align="left" valign="bottom">genome insertionof light-drivensfGFP cassette</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pKD46 (backbone),pSR58.b33</td></tr><tr><td align="left" valign="bottom">pKD46-lacI.b34</td><td align="left" valign="bottom">genome insertionof light-drivenlacI cassette</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pKD46 (backbone),pSpongeROG.b34</td></tr><tr><td align="left" valign="bottom">pKD46-lacI.b33</td><td align="left" valign="bottom">genome insertionof light-drivenlacI cassette</td><td align="left" valign="bottom">this work</td><td align="left" valign="bottom">pKD46 (backbone),pSpongeROG.b33<break/></td></tr></tbody></table></table-wrap><fig id="app1fig11" position="float"><label>Appendix 1—figure 11.</label><caption><title>Plasmid maps.</title><p>All maps are created with SnapGene.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig11-v1.tif"/></fig></sec><sec sec-type="appendix" id="s19"><title>12. Antibiotic concentrations</title><table-wrap id="app1table3" position="float"><label>Appendix 1—table 3.</label><caption><title>Antibiotic concentrations.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Antibiotic</th><th align="left" valign="bottom">Working concentration</th></tr></thead><tbody><tr><td align="left" valign="top">Streptomycin</td><td align="left" valign="top">50 μg/ml</td></tr><tr><td align="left" valign="top">Ampicillin</td><td align="left" valign="top">100 μg/ml</td></tr><tr><td align="left" valign="top">Kanamycin</td><td align="left" valign="top">50 μg/ml</td></tr><tr><td align="left" valign="top">Chloramphenicol</td><td align="left" valign="top">20 μg/ml</td></tr><tr><td align="left" valign="top">Spectinomycin</td><td align="left" valign="top">100 μg/ml</td></tr></tbody></table></table-wrap></sec><sec sec-type="appendix" id="s20"><title>13. Microscope setup</title><fig id="app1fig12" position="float"><label>Appendix 1—figure 12.</label><caption><title>Microscope setup used for mothermachine experiments.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-97754-app1-fig12-v1.tif"/></fig></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97754.3.sa0</article-id><title-group><article-title>eLife assessment</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Krishna</surname><given-names>Sandeep</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>National Centre for Biological Sciences­‐Tata Institute of Fundamental Research</institution><country>India</country></aff></contrib></contrib-group><kwd-group kwd-group-type="evidence-strength"><kwd>Convincing</kwd></kwd-group><kwd-group kwd-group-type="claim-importance"><kwd>Valuable</kwd></kwd-group></front-stub><body><p>This study presents a light-entrainable synthetic oscillator in bacteria, the optorepressilator. The authors develop a toolbox using optogenetics that makes the cellular oscillator easily controllable. This toolbox is <bold>valuable</bold>, contributing both to bioengineering and to the understanding of biological dynamical systems. The comparison with a mathematical model, population, and single-cell measurements demonstrate <bold>convincingly</bold> that the planned system was achieved and is suitable to control and study biological oscillators.</p></body></sub-article><sub-article article-type="referee-report" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97754.3.sa1</article-id><title-group><article-title>Reviewer #1 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>The &quot;optorepressilator&quot;, an optically controllable genetic oscillator based on the famous <italic>E. coli</italic> 3-repressor (LacI, TetR, CI) oscillator &quot;repressilator&quot;, was developed. An individual repressilator shows a stable oscillation of the protein levels with a relatively long period that extends a few doubling times of <italic>E. coli</italic>, but when many cells oscillate, their phases tend to desynchronize. The authors introduced an additional optically controllable promoter through a conformal change of CcaS protein and let it control how much additional CI is produced. By tightly controlling the leak from the added promoter, the authors successfully kept the original repressilator oscillation when the added promoter was not activated. In contrast, the oscillation was stopped by expressing the additional CI. Using this system, the authors showed that it is possible to synchronise the phase of the oscillation, especially when the activation happens as a short pulse at the right phase of the repressilator oscillation. The authors further show that, by changing the frequency of the short pulses, the repressilator was entrained to various ratios to the pulse period, and the author could reconstruct the so-called &quot;Arnold tongues&quot;, the signature of entrainment of the nonlinear oscillator to externally added periodic perturbation. The behaviour is consistent with the simplified mathematical model that simulates the protein concentration using ordinary differential equations.</p><p>Strengths:</p><p>Optical control of the oscillation of the protein clock is a powerful and clean tool for studying the synthetic oscillator's response to perturbation in a well-controlled and tunable manner. The article utilizes the plate reader setup for population average measurements and the mother machine setup for single-cell measurements, and they complement nicely to acquire necessary information.</p></body></sub-article><sub-article article-type="referee-report" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97754.3.sa2</article-id><title-group><article-title>Reviewer #2 (Public review):</article-title></title-group><contrib-group><contrib contrib-type="author"><anonymous/><role specific-use="referee">Reviewer</role></contrib></contrib-group></front-stub><body><p>Summary:</p><p>In this manuscript by Cannarsa et. al., the authors describe the engineering of a light-entrainable synthetic biological oscillator in bacteria. It is based on an upgraded version of one of the first synthetic circuits to be constructed, the repressilator. The authors sought to make this oscillator entrainable by an external forcing signal, analogous to the way natural biological oscillators (like the circadian clock) are synchronized. They reasoned that an optogenetic system would provide a convenient and flexible means of manipulation. To this end, the authors exploited the CcaS-CcaA light-switchable system, which allows activation and deactivation of transcription by green and red light, respectively. They used this system to make the expression of one of the repressilator's transcription factors (lacI) light-controlled, from a construct separated from the main repressilator plasmid. This way, under red light the oscillator runs freely, but exposure to green light causes overexpression of the lacI, pushing the system into a specific state. Consequently, returning to red light will restore the oscillations from the same phase in all cells, effectively synchronizing the cell population.</p><p>After demonstrating the functionality of the basic concept, the authors combined modeling and experiments to show how periodic exposure to green light enables efficient entrainment, and how the frequency of the forcing signal affects the oscillatory behavior (detuning).</p><p>This work provides an important demonstration of engineering tunability into a foundational genetic circuit, expands the synthetic biology toolbox, and provides a platform to address critical questions about synchronization in biological oscillators. Due to the flexibility of the experimental system, it is also expected to provide a fertile ground for future testing of theoretical predictions regarding non-linear oscillators.</p><p>Strengths:</p><p>* The study provides a simple and elegant mechanism for the entertainment of a synthetic oscillator. The design relies on optogenetic proteins, which enable efficient experimentation compared to alternative approaches (like using chemical inducers). This way, a static culture (without microfluidics or change of growth media) can be easily exposed to flexible temporal sequences of the zeitgeber, and continuously measured through time.</p><p>* The study makes use of both plate-reader-based population-level readout and mother-machine single-cell measurements. Synchronization through entrainment is a single cell level phenomenon, but with a clear population-level manifestation. Thus, this experimental approach combination provides a strong validation to their system. At the same time, differences between the readout from the two systems have emerged, and provided a further opportunity for model refinement and testing.</p><p>* The authors correctly identified the main optimization goal, namely the effective leakiness of their construct even under red light. Then, they successfully overcame this issue using synthetic biology approaches.</p><p>* The work is supported by a simplified model of the repressilator, which provides a convenient analytical and numerical means to draw testable predictions. The model predictions are well aligned with the experimental evidence.</p><p>Weaknesses:</p><p>* Even after optimizing the expression level of the light-sensitive gene, the system is very sensitive, i.e., a very short exposure is sufficient to elicit the strongest entertainment. This limited dynamic range might hamper some model testing and future usage.</p><p>* As a result of the previous point, the system is entrained by transiently &quot;breaking&quot; the oscillator: each pulse of green light represents a Hopf bifurcation into a single attractor. it means that the system cannot oscillate in constant green light. In comparison, this is generally not the case for natural zeitgebers like light and temperature for the circadian rhythms. Extreme values might prevent oscillations (not necessarily due to breaking the core oscillator), but usually, free running is possible in a wide range of constant conditions. In some cases, the free-running period length will vary as a function of the constant value.</p><p>While the approach presented in this manuscript is valid, a comprehensive analysis of more subtle modes of repressilator entrainment could also be of value.</p><p>* The entire work makes use of a single intensity and single duration of the green pulse to force entrainment. While the model has clear predictions for how different modalities should affect entrainment, more experiments are needed to validate those predictions.</p></body></sub-article><sub-article article-type="author-comment" id="sa3"><front-stub><article-id pub-id-type="doi">10.7554/eLife.97754.3.sa3</article-id><title-group><article-title>Author response</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cannarsa</surname><given-names>Maria Cristina</given-names></name><role specific-use="author">Author</role><aff><institution>Sapienza University of Rome</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff></contrib><contrib contrib-type="author"><name><surname>Liguori</surname><given-names>Filippo</given-names></name><role specific-use="author">Author</role><aff><institution>Sapienza University of Rome</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff></contrib><contrib contrib-type="author"><name><surname>Pellicciotta</surname><given-names>Nicola</given-names></name><role specific-use="author">Author</role><aff><institution>National Research Council</institution><addr-line><named-content content-type="city">Rome</named-content></addr-line><country>Italy</country></aff></contrib><contrib contrib-type="author"><name><surname>Frangipane</surname><given-names>Giacomo</given-names></name><role specific-use="author">Author</role><aff><institution>Sapienza University of Rome</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff></contrib><contrib contrib-type="author"><name><surname>Di Leonardo</surname><given-names>Roberto</given-names></name><role specific-use="author">Author</role><aff><institution>Sapienza University of Rome</institution><addr-line><named-content content-type="city">Roma</named-content></addr-line><country>Italy</country></aff></contrib></contrib-group></front-stub><body><p>The following is the authors’ response to the original reviews.</p><disp-quote content-type="editor-comment"><p><bold>Public Reviews.</bold></p><p><bold>Reviewer #1 (Public Reviews):</bold></p><p>Summary:</p><p>The &quot;optorepressilator&quot;, an optically controllable genetic oscillator based on the famous <italic>E. coli</italic> 3-repressor (LacI, TetR, CI) oscillator &quot;repressilator&quot;, was developed. An individual repressilator shows a stable oscillation of the protein levels with a relatively long period that extends a few doubling times of <italic>E. coli</italic>, but when many cells oscillate, their phases tend to desynchronize. The authors introduced an additional optically controllable promoter through a conformal change of CcaS protein and let it control how much additional CI is produced. By tightly controlling the leak from the added promoter, the authors successfully kept the original repressilator oscillation when the added promoter was not activated. In contrast, the oscillation was stopped by expressing the additional CI. Using this system, the authors showed that it is possible to synchronise the phase of the oscillation, especially when the activation happens as a short pulse at the right phase of the repressilator oscillation. The authors further show that, by changing the frequency of the short pulses, the repressilator was entrained to various ratios to the pulse period, and the author could reconstruct the so-called &quot;Arnold tongues&quot;, the signature of entrainment of the nonlinear oscillator to externally added periodic perturbation. The behaviour is consistent with the simplified mathematical model that simulates the protein concentration using ordinary differential equations.</p><p>Strengths:</p><p>Optical control of the oscillation of the protein clock is a powerful and clean tool for studying the synthetic oscillator's response to perturbation in a well-controlled and tunable manner. The article utilizes the plate reader setup for population average measurements and the mother machine setup for single-cell measurements, and they compensate nicely to acquire necessary information.</p><p>Weakness:</p><p>The current paper added the optogenetically controlled perturbation to control the phase of oscillation and entrainment, but there are a few other works that add external perturbation to a collection of cells that individually oscillate to study phase shift and/or entrainment. The current paper lacks discussion about the pros and cons of the current system compared to previously analyzed systems.</p><p>Recommendations</p><p>Even if the main purpose of the current paper is to develop a toolbox, it is beneficial to emphasize the pros and cons of the current system compared to the existing work. In addition to the ref [36] that authors cite but do not discuss concretely, example literature about entrainment includes:</p><p>- Sanchez, P.G.L., Mochulska, V., Denis, C.M., Mönke, G., Tomita, T., Tsuchida-Straeten, N., Petersen, Y., Sonnen, K., François, P. and Aulehla, A., 2022. Arnold tongue entrainment reveals dynamical principles of the embryonic segmentation clock. Elife, 11, p.e79575.</p><p>- Heltberg M, Kellogg RA, Krishna S, Tay S, Jensen MH. Noise induces hopping between NF-κB entrainment modes. Cell systems. 2016 Dec 21;3(6):532-9.</p><p>There is surely more literature. It is recommended that a solid discussion be added on the relation between existing works and current work.</p></disp-quote><p>We thank the Reviewer for their positive comments on our manuscript. Their main recommendation is to expand literature and discuss how our method compares to previously reported entrainment of genetic oscillators. In summary, we believe that the main advantages of the optorepressilator are the simplicity of the transcriptional network combined with the flexibility of optical control. In the “Discussion” section of the revised manuscript, we now try to highlight this also in connection to the suggested literature.</p><disp-quote content-type="editor-comment"><p><bold>Reviewer #2 (Public Reviews):</bold></p><p>Summary</p><p>In this manuscript by Cannarsa et. al., the authors describe the engineering of a light-entrainable synthetic biological oscillator in bacteria. It is based on an upgraded version of one of the first synthetic circuits to be constructed, the repressilator. The authors sought to make this oscillator entrainable by an external forcing signal, analogous to the way natural biological oscillators (like the circadian clock) are synchronized. They reasoned that an optogenetic system would provide a convenient and flexible means of manipulation. To this end, the authors exploited the CcaS-CcaA light-switchable system, which allows activation and deactivation of transcription by green and red light, respectively. They used this system to make the expression of one of the repressilator's transcription factors (lacI) light-controlled, from a construct separated from the main repressilator plasmid. This way, under red light the oscillator runs freely, but exposure to green light causes overexpression of the lacI, pushing the system into a specific state. Consequently, returning to red light will restore the oscillations from the same phase in all cells, effectively synchronizing the cell population.</p><p>After demonstrating the functionality of the basic concept, the authors combined modeling and experiments to show how periodic exposure to green light enables efficient entrainment, and how the frequency of the forcing signal affects the oscillatory behavior (detuning).</p><p>This work provides an important demonstration of engineering tunability into a foundational genetic circuit, expands the synthetic biology toolbox, and provides a platform to address critical questions about synchronization in biological oscillators. Due to the flexibility of the experimental system, it is also expected to provide a fertile ground for future testing of theoretical predictions regarding non-linear oscillators.</p><p>Strengths:</p><p>The study provides a simple and elegant mechanism for the entertainment of a synthetic oscillator. The design relies on optogenetic proteins, which enable efficient experimentation compared to alternative approaches (like using chemical inducers). This way, a static culture (without microfluidics or change of growth media) can be easily exposed to flexible temporal sequences of the zeitgeber, and continuously measured through time.</p><p>The study makes use of both plate-reader-based population-level readout and mother-machine single-cell measurements. Synchronization through entrainment is a single cell level phenomenon, but with a clear population-level manifestation. Thus, this experimental approach combination provides a strong validation to their system. At the same time, differences between the readout from the two systems have emerged, and provided a further opportunity for model refinement and testing.</p><p>The authors correctly identified the main optimization goal, namely the effective leakiness of their construct even under red light. Then, they successfully overcame this issue using synthetic biology approaches.</p><p>The work is supported by a simplified model of the repressilator, which provides a convenient analytical and numerical means to draw testable predictions. The model predictions are well aligned with the experimental evidence.</p><p>Weaknesses:</p><p>Even after optimizing the expression level of the light-sensitive gene, the system is very sensitive, i.e., a very short exposure is sufficient to elicit the strongest entertainment. This limited dynamic range might hamper some model testing and future usage.</p><p>As a result of the previous point, the system is entrained by transiently &quot;breaking&quot; the oscillator: each pulse of green light represents a Hopf bifurcation into a single attractor. it means that the system cannot oscillate in constant green light. In comparison, this is generally not the case for natural zeitgebers like light and temperature for the circadian rhythms. Extreme values might prevent oscillations (not necessarily due to breaking the core oscillator), but usually, free running is possible in a wide range of constant conditions. In some cases, the free-running period length will vary as a function of the constant value. While the approach presented in this manuscript is valid, a comprehensive analysis of more subtle modes of repressilator entrainment could also be of value.</p><p>The entire work makes use of a single intensity and single duration of the green pulse to force entrainment. While the model has clear predictions for how those modalities should affect entrainment, none of the experiments attempted to validate those predictions.</p></disp-quote><p>While we agree with the Reviewer that all reported experiments were performed with pulses of constant amplitude and duration, we do not see this as a necessary limitation for future studies on the optorepressilator. Using pulse-width modulation, green light intensity could be easily and continuously modulated from zero to a maximum value (as in Fig. 4), exploring a wide range of intermediate intensity levels and therefore of mean LacI production rates from the optogenetic promoter. We do not include additional experiments in the revised manuscript but we have greatly expanded the theoretical discussion on the low amplitude regime, both for a constant illumination (new Supplementary Materials Section 5) and the pulsed case (new Supplementary Fig. 8).</p><disp-quote content-type="editor-comment"><p><bold>Recommendations for the Authors:</bold></p><p>(1) The introduction emphasized the utility of entrainment as a means to achieve population-wide synchrony. It is worth mentioning also that it enables synchronization of the internal oscillator with an external zeitgeber, to achieve a specific phase-locking between them. Often, this is the main utility attributed to entrainment, e.g., in circadian clocks.</p></disp-quote><p>Following Reviewer’s suggestion we now say in the introduction:</p><p>These oscillations maintain a constant phase relation to the external light cue that can act as a zeitgeber.</p><disp-quote content-type="editor-comment"><p>(2) It is sometimes unclear at first glance which of the figure panels show simulation data and which show experimental data (e.g., Figure 5a,b; Figure 6a,b). More explicitly labeling the panels could help.</p></disp-quote><p>We thank the reviewer for pointing this out, we now explicitly label all the panels.</p><disp-quote content-type="editor-comment"><p>(3) Figure 3b - please add a color bar to indicate the meaning of the red-green scale, and enlarge the markers so their color is more visible. Also, can add additional controls of (i) sfGFP expression without the ccaR, and (ii) the autofluorescent signal from wild type. Please also provide the raw data (not the time derivatives) in a supplementary figure.</p></disp-quote><p>A colorbar has been added and markers enlarged.</p><p>(i) Unfortunately we do not have a control for GFP expression without ccaR.</p><p>(ii) autofluorescence signal from “a negative control consisting of DHL708 with plasmids pNO286-3 and pSR58-0 (optogenetic plasmids without sfGFP cassette)” has been added for comparison to Fig.3b. This modification was actually very helpful in understanding that the sensitivity threshold in our experiments is mainly determined by autofluorescence. OD600 and fluorescence raw data are now provided in Supplementary Fig. 6.</p><disp-quote content-type="editor-comment"><p>(4) Figure 3d - the claim in the text is that the purple optorepressilator and the wildtype repressilator have identical periods and amplitude. However, it seems from the figure that there is a small difference in the period length. This deviation is not problematic in any way, but I wondered whether it might actually be explained by the model, assuming that there is still a very weak leak from the new construct. In other words, would the model predict a bifurcation diagram in which an increasing x' concentration causes a gradual decrease in amplitude and increase in period, before the loss of rhythmicity? If so, Figure 3d can serve not only as a technical optimization demonstration but also as a nice validation of the model.</p></disp-quote><p>We thank the reviewer for raising this interesting point. We now report, in Supplementary Materials Section 5, a theoretical prediction of the period with respect to a constant concentration of x'. For our choice of parameters (adjusted to reproduce the main experimental quantitative features) we find a period that decreases with x'. Leakage would therefore lead to a shorter period, contrary to what is observed experimentally. To explain the longer period observed in the optorepressilator we went back to extract the average growth rates of bacteria in the purple optorepressilator and repressilator curves in Fig.3d. As we now discuss in the main text:</p><p>“The slight difference in period can be explained by the presence of additional plasmids in the optorepressilator strain, which results in a lower growth rate (Supplementary Figures 4 and 5). As found in the digital approximation, the repressilator period is mainly controlled by the inverse growth rate (see Figure 1a and Supplementary Figure 9) meaning a lower growth rate results in a longer oscillation period. When we normalize the time with the growth rate the two oscillations overlap nicely (Supplementary Figure 4).”</p><disp-quote content-type="editor-comment"><p>(5) Supplementary Figure 10 has no reference from the main text. it is unclear what's the difference from Figure 3. In general, many items in the supplementary materials are not referenced from the text. In addition, on many occasions, there is a reference to &quot;supplementary information&quot; without a specific address, which is not so useful to the reader. In any case possible, please be more specific. Also, note that there's inconsistency in referring to the supplemental section as &quot;supplementary materials&quot; vs &quot;supplemental information&quot;.</p></disp-quote><p>We now explicitly reference all Supplementary Figures in the main text and use consistent reference to Supplementary Materials.</p><disp-quote content-type="editor-comment"><p>(6) The discussion at the bottom of p.7 (&quot;Optogenetic entrainment&quot;) is missing a reference to the duration and intensity of the zeitgeber: In the example from human circadian rhythms it doesn't indicate light intensity; In the modeling of the PRC, both modalities are absent. it is important at least to indicate the parameters used for the simulation and experiments. It would be even better to explore in the model how these modalities affect the PRC and entrainment. And it would be incredible if the authors could show this also experimentally.</p></disp-quote><p>We now report the light intensity values for:</p><p>- our experiments:</p><p>“We first demonstrate this by monitoring the population signal from CFP (reporting TetR or 𝑦 in the model) in multiwell cultures under constant red illumination (9.82 W/m^2) interrupted by green light pulses (5.64 W/m^2) with a duration of 2 h and period 𝑇 = 18 h.”</p><p>For mother machine experiments “Green and red light stimuli were provided by the two LEDs (Thorlabs M530L4, Thorlabs M660L4) with respective intensities 6 W/m^2 and 26 W/m^2 for the synchronization experiments, and 1.1 W/m^2 and 4.5 W/m^2 for the entrainment experiments.”</p><p>- and simulations:</p><p>“In Fig. 5a we report the phase shift produced by a single pulse (with duration tau=2 h and intensity beta’=80 h-1 fixed for all the simulations) as a function of the pulse arrival phase ϕ.”</p><p>We also added an additional supplementary figure (Supplementary Fig. 7) that explores how the duration and intensity of the light pulses affect the PRC in the model. An approximate analytic result is also derived for the PRC in the digital approximation that compares very well with simulation, providing physical insight into PRC shape (Supplementary Materials Section 7).</p><disp-quote content-type="editor-comment"><p>(7) The experimental validation of the PRC can be much more thorough. Notably, an entrainment experiment with repeated pulses does not provide the same level of validation as a proper PRC experiment. This is because many differently shaped PRCs can give rise to the same entrainment pattern, as long as their fixed-point phases are the same.</p><p>Luckily, there might already be a decent amount of data from the mother machine experiments to fit with the PRC prediction, given the authors have pulsed a non-synchronized population that spans the entire x-axis of the PRC. It is possible that a proper PRC experiment wouldn't be too difficult with the plate reader either, given the throughput of the author's system.</p></disp-quote><p>This is a very interesting suggestion but unfortunately, in our mother machine data, the first pulse arrives before the cells have completed a full cycle, so although different cells receive the first pulse at a sufficiently randomized phase, we can’t extract their individual phases at the pulse arrival time.</p><p>Indeed it would be possible to design a plate reader experiment for the specific purpose of directly measuring the PRC. However, our current protocol involves continuous manual dilutions, which makes it rather laborious. We are currently working on an automated procedure that will allow us to systematically address this and other interesting suggestions in the future.</p><p>An indirect experimental validation of the PRC is however still possible using available data. See added red points in Fig.5a and reply to point 10 below.</p><disp-quote content-type="editor-comment"><p>(8) The discrepancy between the mother machine and plate reader experiments in Figure 5 is explained by a difference in growth rate variability in the two systems. It is not readily obvious how a difference in variability rather than the mean value of the period length can cause a shifted mean phase. It is only hinted in the text that growth rate has two different effects - on the period as well as the amplitude. I hypothesize that because of this period and amplitude correlation, there is a bias contribution to the sum of trajectories that have resulted in a shifted mean phase. Maybe there is another contribution from the asymmetric waveform of the signal? or from the distribution the alpha is sampled from? A direct discussion on that point will make the results much clearer. If the period-amplitude speculation above is right, please add also a panel that shows it. It will also be helpful to show the predicted PRC for the two parameter regimens.</p></disp-quote><p>We thank the reviewer for highlighting this point. In the previous version of the manuscript we omitted the fact that in order to better match experimental signals we chose slightly different values for T_L/T_0 for simulations in Fig. 5d and 5e. We now report the values of all simulation parameters in the revised manuscript. This difference could also contribute to the shift in the mean phase for the two cases. We added this information in the main text.</p><p>“The bottom panel in Fig. 5d shows the result of a numerical simulation with the same parameters as in Fig. 1b and the addition of a periodic light stimulation, with period $T_L/T_0 = 1$} [...] For the simulations in the lower panel of Fig.5e, all parameters remained the same as in Fig.5d with the exception of the period of the light pulses (T_L/T_0 = 0.97) and the standard deviation of the growth rate distribution, which was increased from 0.034 h^-1 to 0.071 h^-1 to better reproduce the experimental observations in the mother machine.”</p><p>Additionally, we added a supplementary figure (Supplementary Fig. 9) demonstrating the correlation between period and amplitude of the oscillations, for simulations with varying growth rate.</p><disp-quote content-type="editor-comment"><p>(9) The results from the detuning experiments are really nice, especially the decomposition in high frequency shown in Figure 6c. However, the experiments explore only the very high forcing amplitude conditions. Is there any way to test the weaker forcing regimens, as these are expected to uncover the interesting areas in between the Arnold's tongues? If this is experimentally difficult, it would be interesting to include at least the model prediction.</p></disp-quote><p>We thank the reviewer for stimulating us to go in this direction. We have performed simulations to explore model predictions for areas between the Arnold’s tongues. We find onset of entrainment as the amplitude increases and also the existence of intermediate plateaus at fractional frequency ratios. These results are now included in the Supplementary Fig. 8.</p><disp-quote content-type="editor-comment"><p>(10) Another prediction from the Arnold's tongue would be the relative phase of entrainment in different f/v0 conditions. The text refers to it very briefly, but this is a quantitative prediction that can be demonstrated clearly in a figure - how well do they match? It can be shown, for example, by a plot with f/v0 on the x-axis, the phase difference between the pulse and peak expression on the y-axis, a curve representing the model prediction for that function, and dots (with error bars) representing the calculated values from the experimental data.</p><p>Generally, when suitable, this kind of direct comparison is more useful to the reader than the way the authors chose to compare simulation and experiments throughout the manuscript.</p></disp-quote><p>We thank the reviewer for this very interesting suggestion. We have completely rewritten the discussion on entrainment commenting on how the same PRC (phase shift vs pulse arrival phase) can be interpreted as a T_L/T_0-1 vs phase difference plot. Indeed in the new Fig.5a we plot over the theoretical PRC curve, the values of the relative phase of entrainment for three values of the period of the light pulses (from the data in Fig. 6b). The agreement is remarkably good, providing a further experimental validation of the predicted PRC.</p><disp-quote content-type="editor-comment"><p>(11) The raw data can be valuable for the community for reanalysis and further hypothesis testing. Hence, it will be very useful to make all of the data (e.g., the fluorescence signal quantification tables from all the experiments) publicly available.</p></disp-quote><p>We prepared files with all raw data, to be made available to the community.</p></body></sub-article></article>