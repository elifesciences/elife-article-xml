<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">61475</article-id><article-id pub-id-type="doi">10.7554/eLife.61475</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A small, computationally flexible network produces the phenotypic diversity of song recognition in crickets</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-30090"><name><surname>Clemens</surname><given-names>Jan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4200-8097</contrib-id><email>clemensjan@gmail.com</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund7"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-200204"><name><surname>Schöneich</surname><given-names>Stefan</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-4503-5111</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-200205"><name><surname>Kostarakos</surname><given-names>Konstantinos</given-names></name><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf2"/></contrib><contrib contrib-type="author" id="author-69436"><name><surname>Hennig</surname><given-names>R Matthias</given-names></name><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="other" rid="fund3"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-53471"><name><surname>Hedwig</surname><given-names>Berthold</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1132-0056</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>European Neuroscience Institute Göttingen – A Joint Initiative of the University Medical Center Göttingen and the Max-Planck Society</institution><addr-line><named-content content-type="city">Göttingen</named-content></addr-line><country>Germany</country></aff><aff id="aff2"><label>2</label><institution>BCCN Göttingen</institution><addr-line><named-content content-type="city">Göttingen</named-content></addr-line><country>Germany</country></aff><aff id="aff3"><label>3</label><institution>University of Cambridge, Department of Zoology</institution><addr-line><named-content content-type="city">Cambridge</named-content></addr-line><country>United Kingdom</country></aff><aff id="aff4"><label>4</label><institution>Friedrich-Schiller-University Jena, Institute for Zoology and Evolutionary Research</institution><addr-line><named-content content-type="city">Jena</named-content></addr-line><country>Germany</country></aff><aff id="aff5"><label>5</label><institution>Institute of Biology, University of Graz</institution><addr-line><named-content content-type="city">Universitätsplatz</named-content></addr-line><country>Austria</country></aff><aff id="aff6"><label>6</label><institution>Humboldt-Universität zu Berlin, Department of Biology</institution><addr-line><named-content content-type="city">Philippstrasse</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Senior Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><pub-date date-type="publication" publication-format="electronic"><day>11</day><month>11</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e61475</elocation-id><history><date date-type="received" iso-8601-date="2020-07-27"><day>27</day><month>07</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-11-03"><day>03</day><month>11</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2020-07-27"><day>27</day><month>07</month><year>2020</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.07.27.221655"/></event></pub-history><permissions><copyright-statement>© 2021, Clemens et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Clemens et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-61475-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-61475-figures-v2.pdf"/><abstract><p>How neural networks evolved to generate the diversity of species-specific communication signals is unknown. For receivers of the signals, one hypothesis is that novel recognition phenotypes arise from parameter variation in computationally flexible feature detection networks. We test this hypothesis in crickets, where males generate and females recognize the mating songs with a species-specific pulse pattern, by investigating whether the song recognition network in the cricket brain has the computational flexibility to recognize different temporal features. Using electrophysiological recordings from the network that recognizes crucial properties of the pulse pattern on the short timescale in the cricket <italic>Gryllus bimaculatus</italic>, we built a computational model that reproduces the neuronal and behavioral tuning of that species. An analysis of the model’s parameter space reveals that the network can provide all recognition phenotypes for pulse duration and pause known in crickets and even other insects. Phenotypic diversity in the model is consistent with known preference types in crickets and other insects, and arises from computations that likely evolved to increase energy efficiency and robustness of pattern recognition. The model’s parameter to phenotype mapping is degenerate – different network parameters can create similar changes in the phenotype – which likely supports evolutionary plasticity. Our study suggests that computationally flexible networks underlie the diverse pattern recognition phenotypes, and we reveal network properties that constrain and support behavioral diversity.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>cricket</kwd><kwd><italic>Gryllus bimaculatus</italic></kwd><kwd>acoustic communication</kwd><kwd>mating signals</kwd><kwd>evolution</kwd><kwd>neural networks</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000268</institution-id><institution>Biotechnology and Biological Sciences Research Council</institution></institution-wrap></funding-source><award-id>BB/J01835X/1</award-id><principal-award-recipient><name><surname>Hedwig</surname><given-names>Berthold</given-names></name><name><surname>Kostarakos</surname><given-names>Konstantinos</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000288</institution-id><institution>Royal Society</institution></institution-wrap></funding-source><award-id>Newton International Fellowship</award-id><principal-award-recipient><name><surname>Kostarakos</surname><given-names>Konstantinos</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001664</institution-id><institution>Leibniz-Gemeinschaft</institution></institution-wrap></funding-source><award-id>SAW 2012-MfN-3</award-id><principal-award-recipient><name><surname>Hennig</surname><given-names>R Matthias</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>HE 2812/4-1</award-id><principal-award-recipient><name><surname>Hennig</surname><given-names>R Matthias</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>HE 2812/5-1</award-id><principal-award-recipient><name><surname>Hennig</surname><given-names>R Matthias</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>CL 596/1-1</award-id><principal-award-recipient><name><surname>Clemens</surname><given-names>Jan</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>CL 596/2-1</award-id><principal-award-recipient><name><surname>Clemens</surname><given-names>Jan</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>SCHO 1822/3-1</award-id><principal-award-recipient><name><surname>Schöneich</surname><given-names>Stefan</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational model of the neuronal network that recognizes mating signals reveals network properties that support and constrain behavioral diversity in a species group.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Many behaviors are driven by the recognition and evaluation of sensory stimuli. For instance, hunting requires the detection and tracking of prey; communication requires the recognition of the sounds, pheromones, or visual displays that serve as signals. The diversity of animal behavior across taxa betrays the capacity of sensory systems to evolve and adapt to reliably and specifically recognize a wide variety of signals. Neural evolution is well understood when behaviors are driven by signals recognized through the response specificity of primary afferent neurons, where the change in a single amino acid can change the tuning of a specific behavior (<xref ref-type="bibr" rid="bib82">Prieto-Godino et al., 2017</xref>; <xref ref-type="bibr" rid="bib84">Ramdya and Benton, 2010</xref>). However, many behaviors are driven by complex temporal and spatial signal patterns, whose recognition is based on the processing and comparison of neural activity across time and space, where changes in many parameters define the tuning of the system. For these behaviors, unraveling the underlying neural computation is challenging since it requires a mapping from circuit parameters to recognition phenotype.</p><p>One prominent behavior involving the recognition of complex temporal patterns is acoustic communication. Many animals – monkeys, mice, bats, birds, frogs, crickets, grasshoppers, katydids, fruit flies – produce species-specific songs to attract and woo conspecifics of the other sex (<xref ref-type="bibr" rid="bib9">Baker et al., 2019</xref>; <xref ref-type="bibr" rid="bib17">Bradbury and Vehrencamp, 2011</xref>; <xref ref-type="bibr" rid="bib62">Kostarakos and Hedwig, 2014</xref>; <xref ref-type="bibr" rid="bib73">Neunuebel et al., 2015</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). During the evolution of acoustic communication, the structure of songs as well as behavioral preferences can evolve rapidly during speciation events (<xref ref-type="bibr" rid="bib14">Blankers et al., 2015</xref>; <xref ref-type="bibr" rid="bib70">Mendelson and Shaw, 2005</xref>), giving rise to the large diversity of species-specific songs. Since the evolution of song is mainly driven by the female (<xref ref-type="bibr" rid="bib42">Gray and Cade, 2000</xref>), the females’ song recognition must be selective and modifiable in order to drive the evolution of distinct, species-specific song patterns in males (<xref ref-type="bibr" rid="bib101">Wagner, 2007</xref>). But how are these changes implemented at the level of the pattern recognition networks? While electrophysiological experiments can demonstrate the principles of their operations at a given time, they are limited in revealing the functional contribution of cellular and synaptic parameters in a network-wide systematic analysis. To overcome these limitations, the ability of biological networks to generate different recognition phenotypes can be investigated using computational modeling.</p><p>Here, we examine the computational capacity of the brain network that recognizes the pulse pattern in the Mediterranean field cricket, <italic>Gryllus bimaculatus</italic>. Cricket song consists of a sinusoidal carrier frequency, modulated in amplitude with temporal structure on short (&lt;100 ms) and long (&gt;100 ms) timescales (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). On the short timescale, the song consists of trains of sound pulses with a species-specific pulse duration and pulse pause. On the long timescale, the pattern is more variable, and pulse trains are either continuous (trills) or grouped into chirps interrupted by a longer chirp pause. The pulse pattern on the short timescale – and the female’s behavioral preference for it – is compactly described in a two-dimensional parameter space spanned by pulse duration and pause (<xref ref-type="fig" rid="fig1">Figure 1B and C</xref>). The diverse song preferences have been extensively mapped in more than 20 species (e.g., <xref ref-type="bibr" rid="bib7">Bailey et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Cros and Hedwig, 2014</xref>; <xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>; <xref ref-type="bibr" rid="bib52">Hennig, 2009</xref>; <xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>; <xref ref-type="bibr" rid="bib88">Rothbart and Hennig, 2012</xref>). This revealed three principal types of preference, defined by selectivity for specific features of the pulse pattern (<xref ref-type="fig" rid="fig1">Figure 1B</xref>): pulse duration, pulse period (duration plus pause), and pulse duty cycle (duration divided by period, corresponds to signal energy) (<xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>). Intermediates between these types are not known. A fourth type of selectivity – for pulse pause – has not been reported in crickets and is only known from katydids (<xref ref-type="bibr" rid="bib96">Schul, 1998</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Song structure and song preference in crickets, and the song recognition network of <italic>Gryllus bimaculatus</italic>.</title><p>(<bold>A</bold>) Parameters of the temporal pattern of cricket song. Short sound pulses are interleaved by pulse pauses. The pulse period is given by the sum of pulse duration and pulse pause. The pulse duty cycle corresponds to signal energy and is given by the ratio between pulse duration and period. In many species, pulses are grouped in chirps and interleaved by a chirp pause, while other species produce continuous pulse trains, called trills. (<bold>B</bold>) The behavioral tuning for pulse patterns can be characterized using response fields, which mark the set of behaviorally preferred pulse parameters in a two-dimensional diagram spanned by pulse duration and pause duration. Shown are schematics derived from behavioral data from particular species illustrating the four principal response types known from crickets and other insects. Traces below each response field show typical song patterns for each species. Response types can be defined based on tolerance (black lines) and selectivity (double headed arrows) for particular stimulus parameters, leading to specific orientations of the response field (see left inset): period tuning (purple, <italic>G. bimaculatus</italic>) is defined by selectivity for pulse period and tolerance for pulse duty cycle, giving an orientation of the response field of –45°. Duration tuning (lilac, <italic>G13</italic>, <xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>) leads to vertically oriented response fields. Duty cycle tuning (cyan, <italic>Gryllus lineaticeps</italic>, <xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>) leads to diagonally oriented response fields. Pause tuning (green) with horizontal response fields is not known from crickets but has been reported in the katydid <italic>Tettigonia viridissima</italic> (<xref ref-type="bibr" rid="bib96">Schul, 1998</xref>). The response field given represents a hypothetical cricket species. (<bold>C</bold>) Example stimulus series illustrating the stimulus features each response type in (<bold>B</bold>) is selective for. Vertical black lines mark the feature that is constant for each stimulus series. For duty cycle (cyan), the ratio between pulse duration and period is constant. (<bold>D</bold>) Song recognition network in the brain of <italic>G. bimaculatus</italic>. The network consists of five neurons, each with a specific computational role, which are connected in a feed-forward manner using excitation (pointed arrowheads) and inhibition (round arrowheads). The excitatory ascending neuron 1 (AN1) relays information from auditory receptors in the prothorax to the brain. The inhibitory local neuron 2 (LN2) inverts the sign of forwarded responses. LN2 inhibits the non-spiking LN5 neuron, which produces a post-inhibitory rebound. LN3 acts as a coincidence detector for excitatory input from AN1 and LN5. Input delays are tuned such that LN3 is maximally driven by the conspecific pulse train with a pulse period of 30–40 ms. LN4 integrates excitatory input from LN3 and inhibitory input from LN2 and further sharpens the output of the network. (<bold>E</bold>) Tuning for pulse period in LN4 (purple) matches the phonotactic behavior (gray) of <italic>G. bimaculatus</italic> females (<bold>D, E </bold>adapted from Figures 5A and 6A; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig1-v2.tif"/><permissions><copyright-statement>© 2015, Schöneich et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Schöneich et al</copyright-holder><license><license-p> Figure 1D &amp; E are adapted E Tuning for pulse period in LN4 (purple) matches the phonotactic behavior (gray) of <italic>G. bimaculatus</italic> females (D, E adapted from Figures 5A and 6A, <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>).</license-p></license></permissions></fig><p>Repetitive patterns of short pulses that are organized in groups on a longer timescale are a common feature of acoustic signaling in insects, fish, and frogs (<xref ref-type="bibr" rid="bib9">Baker et al., 2019</xref>; <xref ref-type="bibr" rid="bib20">Carlson and Gallant, 2013</xref>; <xref ref-type="bibr" rid="bib39">Gerhardt and Huber, 2002</xref>), and the processing and evaluation of these pulse patterns is therefore common to song recognition systems across species. Moreover, circuits analyzing temporal patterns of amplitude modulations are likely building blocks for recognizing the more complex acoustic communication signals found in vertebrates like songbirds or mammals (<xref ref-type="bibr" rid="bib5">Aubie et al., 2012</xref>; <xref ref-type="bibr" rid="bib25">Coffey et al., 2019</xref>; <xref ref-type="bibr" rid="bib26">Comins and Gentner, 2014</xref>; <xref ref-type="bibr" rid="bib38">Gentner, 2008</xref>; <xref ref-type="bibr" rid="bib73">Neunuebel et al., 2015</xref>) including human language (<xref ref-type="bibr" rid="bib75">Oganian and Chang, 2019</xref>; <xref ref-type="bibr" rid="bib72">Neophytou and Oviedo, 2020</xref>). Insights from insects where assumptions on physiologically relevant parameters like synaptic strengths, delays, and membrane properties of individual neurons can be made and systematically tested are therefore relevant for studies of pattern recognition systems and the evolution of acoustic communication systems in general.</p><p>While little is known about the neural substrates that recognize song on the long timescale of chirps, the neuronal circuit that computes the behavioral preference for the pulse pattern on the short timescale has been revealed in the cricket <italic>Gryllus bimaculatus</italic> (<xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). In this species, the selectivity for a narrow range of pulse periods is created in a network of five neurons and six synaptic connections by combining a delay line with a coincidence detector (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). The ascending auditory neuron 1 (AN1) is tuned to the carrier frequency of the male calling song and provides the input to a small, four-cell network in the cricket brain. Driven by AN1, the local neuron 2 (LN2) inhibits the non-spiking neuron LN5, which functions as delay line and produces a post-inhibitory rebound depolarization driven by the end of each sound pulse. The coincidence detector neuron LN3 receives direct excitatory input from AN1 and a delayed excitatory input driven by the rebound of LN5; it fires strongly only if the rebound from LN5 coincides with the onset of the AN1 response to the next syllable. Lastly, the feature detector neuron LN4 receives excitatory input from LN3 and inhibitory input from LN2, which sharpens its selectivity by further reducing responses to pulse patterns that do not produce coincident inputs to LN3. LN4’s selectivity for pulse patterns closely matches the phonotactic behavior of the females (<xref ref-type="fig" rid="fig1">Figure 1E</xref>).</p><p>We here asked whether the network that recognizes features of the pulse pattern on the short timescale in <italic>G. bimaculatus</italic> (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) has the capacity to produce the diversity of recognition phenotypes for pulse duration and pause known from crickets and other insects (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), and what circuit properties support and constrain this capacity. Based on electrophysiological recordings (<xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>), we fitted a computational model that reproduces the response dynamics and the tuning of the neurons in the network. By exploring the network properties over a wide range of physiological parameters, we show that the network of <italic>G. bimaculatus</italic> can be modified to produce all types of preference functions for pulse duration and pause known from crickets and other insect species. The phenotypic diversity generated by the network is shaped by two computations – adaptation and inhibition – that reduce responses and point to fundamental properties of neuronal networks underlying temporal pattern recognition.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A computational model of the song recognition network in <italic>G. bimaculatus</italic></title><p>We tested whether the delay line and coincidence detector network of the cricket <italic>G. bimaculatus</italic> (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) can be modified to produce the known diversity of preference functions for pulse duration and pause in cricket calling songs (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). This network was previously inferred from the anatomical overlap together with the dynamics and the timing of responses of individually recorded neurons to a diverse set of pulse patterns (<xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). Given that electrophysiology is challenging in this system, dual-electrode recordings to prove the existence of the inferred connections do not exist presently. We consider the neurons in the network cell types that may also comprise multiple cells per hemisphere with highly consistent properties across individuals (<xref ref-type="bibr" rid="bib95">Schöneich, 2020</xref>). We fitted a computational model based on intracellularly recorded responses of the network’s neurons to pulse trains. Our goal was to obtain a model that captures the computational capacity of the network without tying it to a specific biophysical implementation, and we reproduced the responses of individual neurons using a phenomenological model based on four elementary computations (<xref ref-type="fig" rid="fig2">Figure 2A</xref>): (1) filtering, (2) nonlinear transfer functions (nonlinearities), (3) adaptation, and (4) linear transmission with a delay. Nevertheless, all model components have straightforward biophysical correlates (see Discussion), which allows us to propose biophysical parameters that tune the network in specific implementations. The computational steps – for instance, whether a neuron had an integrating or a differentiating filter (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) – were selected such that each neuron’s response dynamics could be reproduced (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="table" rid="table1">Table 1</xref>). The model parameters were first manually tuned to initial values that reproduced the key properties of each neuron’s response and then numerically optimized to more precisely fit each neuron’s response dynamics and tuning (<xref ref-type="fig" rid="fig2">Figure 2B–H</xref>). To simplify fitting, we exploited the feed-forward nature of the network: we first optimized the parameters of the input neuron to the network, AN1. Then, we went downstream and fitted the parameters of each neuron’s downstream partners while fixing all parameters of its upstream partners for all neurons in the network. Electrophysiological data used for fitting were the time-varying firing rate for the spiking neurons AN1, LN2, LN3, and LN4, and the membrane voltage for the non-spiking LN5 neuron, all in response to periodical pulse trains with different pulse durations and pauses (<xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). A detailed description of the model parameters, the data used for fitting, and the fitting procedure are described in Materials and methods, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, and <xref ref-type="table" rid="table1">Table 1</xref>.</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>A computational model reproduces the responses of the song recognition network.</title><p>(<bold>A</bold>) The model of the song recognition network (<xref ref-type="fig" rid="fig1">Figure 1D</xref>) combines four elementary computations: linear filtering (yellow), static nonlinearities (blue), adaptation (red), and synaptic transmission (black lines, pointed arrowheads: excitatory inputs; round arrowheads: inhibitory inputs). Multiple inputs to a cell are summed (green). Pictograms inside of each box depict the shapes of the filters and of the nonlinearities. Y scales are omitted for clarity. See <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, and Materials and methods for details. (<bold>B–D</bold>) Tuning for period (<bold>B</bold>), duty cycle (<bold>C</bold>), and pause (<bold>D</bold>) in the data (red, each line is a trial-averaged recording from one individual) and in the model (black) for the five neurons in the network. Thicker red lines depict the recording used for fitting. Stimulus schematics are shown on the top of each plot. Tuning is given by the firing rate (AN1, LN2–4) or integral rebound voltage (LN5) for each chirp and was normalized to peak at 1.0 across the whole set of tuning curves shown in (<bold>B–D</bold>). A duration tuning curve is not shown since it is not contained in the electrophysiological data. See <xref ref-type="fig" rid="fig3">Figure 3</xref> for duration tuning generated by the model. Number of individual recordings is 8/4/3/6/4 for AN1/LN2/5/3/4. (<bold>E</bold>) Firing rate (Hz) or membrane voltage (mV) traces from the recording used for fitting (red) and from the model (black). Stimuli (top) are pulse trains with different pulse periods. (<bold>F</bold>) Firing rate of LN2 in Hz (shaded area) and membrane voltage traces of LN5 in mV (line) in the recording used for fitting (top, red) and in the model (bottom, black) for short (18 ms), intermediate (34 ms), and long (58 ms) periods. The model reproduces the response timing of LN5 and LN2 responses overlap for short and intermediate but not for long periods. (<bold>G</bold>) Goodness of fit for the response dynamics of all neurons at different timescales, quantified as the <inline-formula><mml:math id="inf1"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> between the traces in the data and the model. Fits for AN1<sub>M</sub>, LN2<sub>M</sub>, and LN5<sub>M</sub> are good across all timescales. The fits for LN3<sub>M</sub> and in particular for LN4<sub>M</sub> increase with timescale (&gt;10 ms) due to the sparse and variable spiking of these neurons (see <bold>E</bold>). (<bold>H</bold>) Goodness of fit for the tuning curves, quantified as 1 minus the root mean-square error between the tuning curves from the data and the model (compare black lines and thick red lines in <bold>B–D</bold>). The curves from the data and the model were normalized by the peak of the curve from the data, to make the measure independent of response scale. Performance is high for all neurons. The weaker match for LN5<sub>M</sub> stems from larger model responses for stimuli with long periods or pauses (see <bold>B</bold>, <bold>D</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Working principle of filters and nonlinearities used as building blocks in the model.</title><p>(<bold>A</bold>) Shapes of a low-pass or integrating filter (blue) and of a bandpass or differentiating filter (orange). Filters are unitless. The integrating filter was generated from a Gaussian, and the differentiating filter was obtained by taking the derivative of the integrating filter and scaling the negative filter lobe by ½. A neuron’s filter depicts the stimulus pattern that strongly drives that neuron. The output is generated at the right end of the filter (arrow). (<bold>B</bold>) Output of the two filters in (<bold>A</bold>) for a square pulse (top). The filtered stimulus (bottom) is generated by sliding the filter over the stimulus and computing the sum over the pointwise product between the filter shape and the stimulus. The filtered stimulus is produced at the right end of the filter (vertical lines). The integrating filter (blue) smooths the sharp on- and offsets of the pulse. The differentiating filter is a change detector because it responds strongly to changes in the stimulus (orange): a strong positive response occurs at pulse onset because only the excitatory lobe is ‘activated’ by the stimulus (‘activation’ indicated by the shaded part of the filters on top). A negative response at pulse offset arises because only the negative filter lobe overlaps with the pulse. An intermediate response is produced during the pulse because the excitatory lobe is 2× larger than the inhibitory lobe. A fully symmetrical filter would produce no response for constant stimuli irrespective of the stimulus amplitude. A differentiating filter produces a phasic-tonic response pattern and is therefore useful for reproducing adapting responses in AN1<sub>M</sub>, LN2<sub>M</sub>, or the inputs in LN5<sub>M</sub> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). (<bold>C</bold>) The rebound responses of LN5<sub>M</sub> were reproduced with a differentiating filter. The response (bottom, dashed orange line) of the differentiating filter in (<bold>A</bold>) to a negative input (top) equals the sign-inverted response of that filter to a positive input (compare <bold>B</bold>). The positive response of a differentiating filter for pulse offsets (shaded area) reproduces the post-inhibitory rebound response of the LN5 neuron (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). (<bold>D</bold>) A rectifying nonlinearity (left) and the output of the nonlinearity (right) for the stimulus filtered with a low- and a bandpass filter from (<bold>B</bold>). The nonlinearity with a threshold value of 0 cuts off all negative filter outputs. (<bold>E</bold>) A sigmoidal nonlinearity (left) and the output for the filtered stimulus (right) for both filters from (<bold>B</bold>). This nonlinearity cuts off small and compresses large filter outputs. In the example, it compresses the onset accentuation and cuts off the negative offset response for the differentiating filter (orange). The responses for the differentiating (orange) and the integrating (blue) filter now mainly differ in their delay, with the differentiating filter leading the integrating filter because the peak of the differentiating filter occurs closer to the time of the response (arrow in <bold>A</bold>). (<bold>F</bold>) Divisive normalization acts by scaling its input (from top left, blue, to yellow, right). The input (top left, blue) is filtered by an adaptation filter to produce the adaptation signal <inline-formula><mml:math id="inf2"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (middle left, black), which is linearly transformed to divide the input <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. For this example, the adaptation filter (gray box on the left) of the divisive normalization stage was an exponential kernel with a width <inline-formula><mml:math id="inf4"><mml:mi>γ</mml:mi></mml:math></inline-formula>=40 ms, was scaled to peak at 1, and has units 1 /dB. The orange trace shows the output of the differentiating filter from (<bold>A</bold>). The responses in the right panel were normalized to peak at 1.0 to facilitate comparison of their time courses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Illustration of the model parameters.</title><p>The model combines four elementary computations: filtering (yellow boxes), adaptation (red boxes), nonlinear transfer functions (blue boxes), and delayed transmission (black lines, pointed arrowheads: excitatory inputs; round arrowheads: inhibitory inputs). Summation of synaptic inputs is marked with green boxes. The graphs in the yellow boxes show the filters, x-axis is time. The postsynaptic filter for LN5<sub>M</sub> is very short 3 ms ( = 3 time steps in the model) – the step-like pattern arises because of the discrete time steps at which the filters are presented; individual plateaus correspond to individual time steps in the filter. The graphs in the blue boxes show the nonlinearities, x-axis is the input, y-axis is the output activation. The adaptation stage has three parameters: speed, strength, and offset. The filters shown in the red boxes correspond to the exponential filters that generate the adaptation signal that is used to divide the filtered stimulus (see <xref ref-type="fig" rid="fig1">Figure 1G</xref>). The exponential filter for the adaptation stage in AN1<sub>M</sub> does not reach baseline because it is truncated in the model. The inhibitory lobe of the AN1<sub>M</sub> filter is used to implement adaptation and is enlarged in the plot for clarity. See <xref ref-type="table" rid="table1">Table 1</xref> for all parameter values and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> for an illustration of the working principles of the filters, nonlinearities, and delayed transmission.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>Goodness of fit for the response dynamics for each neuron in the network model, separated by stimulus.</title><p>Firing rate or voltage rate (for the non-spiking LN5) of each recording used for fitting (red) and goodness of fit (<inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula>) at timescales 1, 12, and 24 ms (gray lines; compare <xref ref-type="fig" rid="fig2">Figure 2G</xref>). The <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> at different timescales was obtained by low-pass filtering the firing rate traces from the experimental data and the model with a box filter of the respective duration. The <inline-formula><mml:math id="inf7"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is largely independent of stimulus and timescale for AN1, LN2, LN5, and LN3, which produce dense spiking or voltage responses. Low <inline-formula><mml:math id="inf8"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> values in LN4 arise at short timescales and for stimuli that elicit very few and irregularly timed spikes.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig2-figsupp3-v2.tif"/></fig><fig id="fig2s4" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 4.</label><caption><title>LN4<sub>M</sub> response fields for different amplitudes of the LN5<sub>M</sub> rebound.</title><p>Rebound amplitude is given relative to the value in the original model (1.0). Halving or doubling the amplitude has minor impacts on the model responses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig2-figsupp4-v2.tif"/></fig></fig-group><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Model parameters.</title><p>See <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref> for an illustration and methods for a definition of all parameters. * marks parameters that were fixed during training (9/55). <sup>†</sup> marks parameters that were fixed during parameter and sensitivity analyses (10/55, <xref ref-type="fig" rid="fig4">Figures 4</xref>—<xref ref-type="fig" rid="fig6">6</xref>).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Cell</th><th align="left" valign="bottom">Component</th><th align="left" valign="bottom">Parameters</th></tr></thead><tbody><tr><td align="left" valign="bottom">AN1<sub>M</sub></td><td align="left" valign="bottom">Filter excitatory lobe</td><td align="left" valign="bottom">(Gaussian) width <inline-formula><mml:math id="inf9"><mml:mi>α</mml:mi></mml:math></inline-formula>=0.0005, duration = 9.88 ms, input delay = 7.41 ms</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Filter inhibitory lobe</td><td align="left" valign="bottom">(Gaussian) width <inline-formula><mml:math id="inf10"><mml:mi>α</mml:mi></mml:math></inline-formula>=2.32, gain <inline-formula><mml:math id="inf11"><mml:mi>γ</mml:mi></mml:math></inline-formula>=0.06, duration N = 184 ms</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Nonlinearity</td><td align="left" valign="bottom">(Sigmoidal) slope = 1.5, shift = 1.5, gain = 5, baseline = −0.5</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Adaptation</td><td align="left" valign="bottom">(Divisive normalization) timescale <inline-formula><mml:math id="inf12"><mml:mi>τ</mml:mi></mml:math></inline-formula>=3760 ms, strength w = 2.82, offset x0 = 1*<sup>†</sup></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Output gain</td><td align="left" valign="bottom">Gain=12.8<sup>†</sup></td></tr><tr><td align="left" valign="bottom">LN2<sub>M</sub></td><td align="left" valign="bottom">Input from AN1<sub>M</sub></td><td align="left" valign="bottom">Delay = 0 ms, gain = 0.19</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Filter excitatory lobe</td><td align="left" valign="bottom">(Gaussian) width <inline-formula><mml:math id="inf13"><mml:mi>α</mml:mi></mml:math></inline-formula>=1.07, duration N = 14.2 ms, gain = 0.272</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Filter inhibitory lobe</td><td align="left" valign="bottom">(Exponential) decay <inline-formula><mml:math id="inf14"><mml:mi>γ</mml:mi></mml:math></inline-formula>=5.98 ms, duration N = 1000 ms*<sup>†</sup></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Output nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 0*<sup>†</sup>, gain = 1.33</td></tr><tr><td align="left" valign="bottom">LN5<sub>M</sub></td><td align="left" valign="bottom">Input from LN2<sub>M</sub></td><td align="left" valign="bottom">Delay = 8.39 ms, gain = −0.005</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Postsynaptic filter</td><td align="left" valign="bottom">(Differentiated Gaussian) duration N = 5.0 ms, width <inline-formula><mml:math id="inf15"><mml:mi>α</mml:mi></mml:math></inline-formula>=3.5*<sup>†</sup>, gain of the excitatory lobe = 1.15</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Postsynaptic nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 0*<sup>†</sup>, gain = 1*<sup>†</sup></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Rebound filter exc. lobe</td><td align="left" valign="bottom">(Exponential) decay <inline-formula><mml:math id="inf16"><mml:mi>γ</mml:mi></mml:math></inline-formula>=3.54 ms, duration N = 20.7 ms, gain = 915</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Rebound filter inh. lobe</td><td align="left" valign="bottom">(Exponential) decay <inline-formula><mml:math id="inf17"><mml:mi>γ</mml:mi></mml:math></inline-formula>=30.3 ms, duration N = 500 ms*<sup>†</sup>, gain = 1718</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Output nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 0*<sup>†</sup>, gain = 3.82</td></tr><tr><td align="left" valign="bottom">LN3<sub>M</sub></td><td align="left" valign="bottom">Input from AN1<sub>M</sub></td><td align="left" valign="bottom">Delay = 7.33 ms, gain = 32.1</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Input from LN5<sub>M</sub></td><td align="left" valign="bottom">Delay = 3.16 ms, gain = 3.78</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Postsyn. nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 0.26, gain = 0.014</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Adaptation</td><td align="left" valign="bottom">(Divisive normalization) timescale <inline-formula><mml:math id="inf18"><mml:mi>τ</mml:mi></mml:math></inline-formula>=39.4 ms, strength w = 0.283, offset x0 = 1*<sup>†</sup></td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Output nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 2.33, gain = 7.68</td></tr><tr><td align="left" valign="bottom">LN4<sub>M</sub></td><td align="left" valign="bottom">Input from LN2<sub>M</sub></td><td align="left" valign="bottom">Delay = 17 ms, gain = –1205</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Input from LN3<sub>M</sub></td><td align="left" valign="bottom">Delay = 4.87 ms, gain = 401</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Output nonlinearity</td><td align="left" valign="bottom">(Rectifying) threshold = 738, gain = 0.0052</td></tr></tbody></table></table-wrap></sec><sec id="s2-2"><title>The model faithfully reproduces the neural responses</title><p>The fitted model closely reproduced the responses of the network neurons to stimuli from the electrophysiological data set (<xref ref-type="fig" rid="fig2">Figure 2B–H</xref>). To quantify model performance, we assessed the match in the dynamics and in the tuning between the neuronal and the model responses. First, we computed the squared correlation coefficient (<inline-formula><mml:math id="inf19"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>) between the recorded and the modeled responses (<xref ref-type="fig" rid="fig2">Figure 2G</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). We performed this correlation analysis at different timescales of the traces by low-pass filtering responses and predictions with filters of different durations. At shorter timescales, the measure is sensitive to the precise response timing, whereas at longer timescales it reflects the match in the coarse features of the firing rate or voltage dynamics. The <inline-formula><mml:math id="inf20"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> value is high across all timescales for the model neurons (indexed with ‘M’) AN1<sub>M</sub>, LN2<sub>M</sub>, LN3<sub>M</sub>, and LN5<sub>M</sub>, which respond to a pulse in the biological network with multiple spikes or sustained membrane voltage deflections. By contrast, LN4 produces only a few and irregularly timed spikes during a chirp, and therefore <inline-formula><mml:math id="inf21"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is highest for timescales exceeding the duration of a typical pulse (15 ms) (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>). Second, we calculated the match between the tuning curves derived from the experimental data and the model (<xref ref-type="fig" rid="fig2">Figure 2H</xref>). The model excellently reproduced the tuning curves of AN1<sub>M</sub>, LN2<sub>M</sub>, LN3<sub>M</sub>, and LN4<sub>M</sub>. Performance is lower for LN5<sub>M</sub> since the model produced overly strong rebound responses for patterns with long pulse periods and pauses (<xref ref-type="fig" rid="fig2">Figure 2B and D</xref>). In the electrophysiological data, the rebound amplitude is also variable across individuals. This may reflect interindividual variability, but it could also be an experimental artifact due to the challenges of recordings from the tiny branches of this very small neuron. Despite this variability, the tuning of responses downstream of LN5 – LN3 and LN4 – is not (<xref ref-type="fig" rid="fig2">Figure 2B–D</xref>). This indicates that the biological network is robust to small changes in rebound amplitude and that it primarily relies on rebound timing. This is well reproduced in our model (<xref ref-type="fig" rid="fig2">Figure 2E–G</xref>): the response dynamics and tuning for the downstream neurons LN3<sub>M</sub> and LN4<sub>M</sub> are well reproduced despite the discrepancy in LN5<sub>M</sub> rebound amplitude. Moreover, we find that altering rebound amplitude within the range of the discrepancy only weakly affects model output (<xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). We can also not exclude that there is a population of multiple LN5-type neurons in each hemisphere and that variability between the individual LN5 neurons reflected in our recordings is averaged in their summed input to LN3. Overall, this shows that despite this small discrepancy between the data and the model, our model well captures the computations of the biological network.</p><p>To further assess the model’s performance, we examined each model neuron’s responses over a wide range of pulse and pause durations that covered the range of song parameters found across cricket species (<xref ref-type="bibr" rid="bib104">Weissman and Gray, 2019</xref>). There exist no electrophysiological data for such a wide range of stimuli, but the behavioral data from <italic>G. bimaculatus</italic> indicate that the neural responses should change smoothly with the song parameters (<xref ref-type="bibr" rid="bib44">Grobe et al., 2012</xref>; <xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>; <xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref>). The responses of all neurons in the model – presented as two-dimensional response fields that depict the response rate for each combination of pulse duration and pause in the set of test stimuli – are consistent with this prediction (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). Discontinuities in the responses with a stimulus parameter stem from the discrete nature of the stimulus because the number of pulses per train changes with pulse duration and pause (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A and B</xref>). The response fields illustrate the gradual transformation of tuning in the network: LN2<sub>M</sub> at the beginning of the network responds best to stimuli with large duty cycles, that is, stimuli with long pulse durations and short pauses. Following the network from LN5<sub>M</sub> over LN3<sub>M</sub> to LN4<sub>M</sub>, the responses to large duty cycle stimuli attenuate and the pulse period tuning becomes more and more prominent, with LN4<sub>M</sub> ultimately being selective for a narrow range of pulse periods.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Model responses to novel pulse train stimuli.</title><p>Responses of the model neurons for stimuli with different combinations of pulse and pause durations (1–80 ms, 1600 stimuli per response field, color code corresponds to response magnitude). Each response field depicts the firing rate (for AN1<sub>M</sub>, LN2<sub>M</sub>–4<sub>M</sub>) or the voltage of the rebound (for LN5<sub>M</sub>) of model neurons. Pulse trains had a fixed duration of 140 ms and were interleaved by a pause of 200 ms, mimicking the chirp structure of <italic>G. bimaculatus</italic> calling song. Anti-diagonal step-like patterns in the response fields arise from changes in the number of pulses per train (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A and B</xref>). Although the data set used for fitting did not include stimuli with long pulse durations, the model predicts the weak response known from the behavior for these stimuli. Solid black lines indicate stimuli with 15 ms pause duration (horizontal), 15 ms pulse duration (vertical), 30 ms pulse period (anti-diagonal), and 0.5 pulse duty cycle (diagonal). Dots in the leftmost panel mark the stimuli used for fitting.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Stepwise changes in the response fields arise from the stimulus structure.</title><p>Response field of LN5<sub>M</sub> (<bold>A</bold>) and number of pulses per train in the underlying stimuli (<bold>B</bold>) (see color bar for color coding, color map was scaled to span the range of response values [<bold>A]</bold> and pulse numbers [<bold>B]</bold>). Changes in pulse number are marked by anti-diagonal black lines in both panels (only shown for pulse duration and pauses greater than 20 ms for clarity). Red and yellow dots in the fields in (<bold>A</bold>) and (<bold>B</bold>) refer to the two pulse train stimuli shown on the right of (<bold>B</bold>) with three pulses (red) and four pulses (yellow), and the maximal pulse train duration of 140 ms is shown as a gray shaded area. Steps in the response fields (<bold>A</bold>, <xref ref-type="fig" rid="fig3">Figure 3</xref>) arise from stepwise changes in the number of pulses per train (<bold>B</bold>) due to the fixed pulse train duration.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Preference for pulse parameters is robust to small changes in chirp duration.</title><p>Response fields of LN4<sub>M</sub> for pulse trains with different chirp durations and a fixed chirp pause of 200 ms. The response fields are robust to the addition or removal of a pulse from the chirp.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig3-figsupp2-v2.tif"/></fig></fig-group><p>The song of <italic>G. bimaculatus</italic> is produced with a chirp pattern (<xref ref-type="fig" rid="fig1">Figure 1A</xref>) and female preference for it is broad relative to the tuning for pulse duration and pause (<xref ref-type="bibr" rid="bib44">Grobe et al., 2012</xref>). Consistent with that, the model’s response field is robust to the small changes in the chirp duration like adding or removing a single pulse from a chirp typically found in the natural song of this species (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). This confirms that our results on pulse duration and pause are robust to the small variations on the longer timescale of chirps observed in natural song. Future studies will examine to what extent the network that recognizes song on the short timescale of pulses also contributes to female preference on the longer timescale of chirps.</p><p>In summary, our model reproduces the characteristic response features of each neuron type in the biological network. Using this model of the song recognition mechanism in <italic>G. bimaculatus,</italic> we can now test whether the network has the capacity to produce the behavioral preferences for pulse duration and pause known from other cricket species and identify the parameters that determine the network’s preference.</p></sec><sec id="s2-3"><title>The network can be tuned to produce all known preferences for pulse duration and pause in crickets</title><p>To determine the diversity of behavioral preferences for pulse duration and pause that the network can produce, we created different model variants by altering all model parameters – for instance, the weight and delay of inputs or the amplitude or duration of filters. The model variants were generated by randomly picking values for each of the 45 parameters from an interval around the parameter values of the fit to <italic>G. bimaculatus</italic> (see Materials and methods for details and <xref ref-type="table" rid="table1">Table 1</xref>). Biophysical parameters of a neuron type can vary 10-fold even within a species (<xref ref-type="bibr" rid="bib40">Goaillard et al., 2009</xref>; <xref ref-type="bibr" rid="bib97">Schulz et al., 2007</xref>), and we therefore chose an interval of 1/10 to 10 times the values from the fit to <italic>G. bimaculatus</italic>. Initial experiments with a wider range (1/100 to 100-fold) yielded qualitatively similar results but with a larger fraction of untuned or unresponsive models. Delay parameters were randomly picked from an interval between 1 and 21 ms. Delay parameters correspond to the delay added to a neuron’s inputs and were optimized during fitting to match the timing of the responses of the neuron’s outputs. They therefore account not only for axonal transduction and synaptic transmission delays but also for delays arising from low-pass filtering or integration of inputs to the spiking threshold (<xref ref-type="bibr" rid="bib28">Creutzig et al., 2010</xref>; <xref ref-type="bibr" rid="bib107">Zhou et al., 2019</xref>), justifying the extended range of values. To translate responses of the output neuron of the network – LN4<sub>M</sub> – into phonotaxis, we used a simple model: the firing rate of LN4 is strongly correlated with the female phonotaxis in <italic>G. bimaculatus</italic> (<xref ref-type="fig" rid="fig1">Figure 1E</xref>, <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>), and we therefore took LN4<sub>M</sub>’s firing rate averaged over a chirp to predict phonotaxis from the model responses. Integrative processes over timescales exceeding the chirp are known to affect behavior in crickets and other insects (<xref ref-type="bibr" rid="bib80">Poulet and Hedwig, 2005</xref>, see also <xref ref-type="bibr" rid="bib69">Meckenhäuser et al., 2014</xref>; <xref ref-type="bibr" rid="bib23">Clemens et al., 2014</xref>; <xref ref-type="bibr" rid="bib30">DasGupta et al., 2014</xref>). We omit them here since they do not crucially affect responses for the simple, repetitive stimuli typical for pulse trains produced by crickets. The preference properties of the network models with randomized parameter sets were characterized for a two-dimensional stimulus space using pulse trains with all combinations of pulse durations and pauses between 1 and 80 ms (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). We generated 5 million model variants, 9% of these were responsive and selective and used for all further analyses. This low proportion arises because many parameter combinations produce constant output, for instance, if the firing threshold in AN1 is too low or too high.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>The network generates the diversity of response profiles known from crickets and other insects.</title><p>(<bold>A</bold>) Response field generated from a model variant with randomized parameters. Response magnitude coded in gray colors (see color bar). Tuning was characterized in terms of the preferred pulse and pause durations (red dot) and as tolerant (blue) or selective (purple) directions in the stimulus field. This example is period tuned (purple contour marks the 75% response level) and the set of preferred stimuli is oriented at –45° (see inset in <bold>D </bold>for a definition of the angles), corresponding to selectivity for period (purple) and tolerance for duty cycle (cyan). (<bold>B</bold>) Distribution of preferred pulse and pause parameters for all model variants generated from randomized parameter combinations (coded in gray colors, see color bar). Anti-diagonal patterns arise from the discrete nature of pulse trains (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A and B</xref>). Models that prefer pauses of 0 ms correspond to models that prefer constant tones. Enrichment of models that prefer the maximally tested pause of 80 ms indicates that the network can generate preference for longer pauses than tested. Preferences cover the stimulus field. (<bold>C</bold>) Distribution of preferred pulse parameters (left to right: pulse period, pulse duration, duty cycle, and pause). Gray histograms correspond to the distributions expected from uniform sampling of stimulus space – deviations from this distribution indicate response biases. The network is biased to produce preferences for short pulse periods, short pulse durations, and low duty cycles. Peaks in the histograms arise from the discrete nature of pulse trains (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1A and B</xref>) or from boundary effects (see <bold>B</bold>). (<bold>D</bold>) Distribution of the orientation of the response fields (see <bold>A</bold>) for model variants that are well fitted by an ellipsoid, have a single peak, and are asymmetrical. Colored lines indicate the range of angles (±10°) that correspond to the four principal response types (see inset and <xref ref-type="fig" rid="fig1">Figure 1B</xref>). The network can produce response fields at all angles, including the four principal types of tuning for period, duration, duty cycle, and pause. Response fields with small angles around 0°, corresponding duration tuning, occur most often. (<bold>E</bold>) Examples of tuning profiles for pulse period, duration, duty cycle, and pause. Profiles for all tuning types cover the examined stimulus space. (<bold>F</bold>) To identify model parameters useful for controlling network tuning, we modified each model parameter between 1/100 and 100-fold and calculated the change in the response field. The sensitivity score quantifies how much changing a parameter’s value changes the response field. Examples shown are the parameters with the highest (LN5<sub>M</sub> postsynaptic filter duration, black) and lowest non-zero sensitivity (LN5<sub>M</sub> rebound filter excitatory decay, gray) (see <bold>H</bold>). (<bold>G</bold>) Average sensitivity scores by neuron. LN5<sub>M</sub> has the highest score, it most strongly shapes network tuning, consistent with the rebound and coincidence detection being the core computational motif of the network. (<bold>H</bold>) Model parameters ranked by sensitivity score. Parameters that induce no or only a single step-like change in the response field were excluded. Color indicates cell type (same as in <bold>G</bold>). Parameters of LN5<sub>M</sub> (bright orange) and LN3<sub>M</sub> (dark orange) rank high, demonstrating the importance of the rebound and coincidence detection for shaping model tuning. The model schematic (inset) highlights the most important types of parameters.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Comparison of sensitivity scores for changes of single and pairs of parameters.</title><p>Sensitivity scores obtained from changing single parameters and parameter pairs are correlated (Spearman’s rank correlation <italic>r</italic> = 0.88). The sensitivity scores for single parameters were obtained by quantifying how much the response field of LN4<sub>M</sub> changes when each of the 45 parameters selected for the analysis is changed individually (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). Sensitivity scores for pairs were obtained by changing pairs of parameters (see Materials and methods). Open circles indicate parameters with zero sensitivity in the single parameter analysis and were excluded from the calculation of Spearman’s correlation.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig4-figsupp1-v2.tif"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 2.</label><caption><title>Most responses fields are well fitted by ellipsoids, some are multi-peaked.</title><p>(<bold>A</bold>) Quantification of how well response fields (left column) are represented by ellipses. Ellipses (middle column) were fitted to binarized response fields (left column), obtained by thresholding each field at 50% of its maximum. The match between the binarized response field and the fitted ellipse was quantified using the Jaccard similarity, <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, which corresponds to the fraction of pixels that have the value 1 in the response field out of all pixels that are 1 in the field or the ellipse (intersection over union). Shown are two response fields that are well-fitted (top, <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.69) or ill-fitted (bottom, <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> = 0.38) by an ellipse. (<bold>B</bold>) Jaccard similarity for the responsive and selective response fields obtained by randomizing the model parameters. The distribution is heavily skewed towards high similarity values, indicating that most response fields are well fitted by ellipsoids. Vertical lines show the similarity values for the two examples in (<bold>A</bold>), 0.38 and 0.69. (<bold>C</bold>) Probability distribution of the asymmetry index for all response fields, given by the ratio of the ellipse’s major and minor axes. An asymmetry index of 1.0 means perfect symmetry, the higher the index, the more asymmetrical the response field. The inset shows three ellipses with asymmetry indices 1.25, 1.5, and 2.0. (<bold>D</bold>) Examples of multi-peaked response fields.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig4-figsupp2-v2.tif"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 3.</label><caption><title>Response fields of all neurons in the network for examples from <xref ref-type="fig" rid="fig4">Figure 4E</xref>.</title><p>Shown are examples of response fields obtained by randomizing the model parameters with period tuning (<bold>A</bold>), duration tuning (<bold>B</bold>), duty cycle tuning (<bold>C</bold>), pause tuning (<bold>D</bold>), and a response field with multiple peaks (<bold>E</bold>). The colored lines show the 67% contour (33% contour in <bold>E</bold>) for LN4<sub>M</sub> in all panels. The phonotaxis response is coded in gray colors (see color bar).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig4-figsupp3-v2.tif"/></fig></fig-group><p>As a first step towards characterizing the types of tuning the network can produce, we assessed the preferred pulse duration and pause for each of the 450,000 selective model variants (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). We find that preferences cover the full range of pulse and pause combinations tested (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). However, the model variants do not cover the preference space uniformly but are biased to prefer patterns with short pulse durations, short periods, and low duty cycles (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Peaks at pauses of 0 ms arise from duty cycle-tuned models with a preference for unmodulated stimuli, and peaks at pauses of 80 ms arise from models preferring pauses beyond the range tested here. In conclusion, the network can produce diverse recognition phenotypes, but this diversity is biased towards specific stimulus patterns.</p><p>The preferred pulse parameters – duration, pause, and their combinations period and duty cycle – only incompletely describe a network’s recognition phenotype. In the next step, we focused a more exhaustive description of the response fields on aspects that have been well described in behavioral analyses. This allowed us to assess the match between the diversity of response fields in the model with the known biological diversity. Behavioral analyses in crickets and other insects (<xref ref-type="bibr" rid="bib32">Deutsch et al., 2019</xref>; <xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>; <xref ref-type="bibr" rid="bib96">Schul, 1998</xref>) typically find oriented response fields with a single peak in the two-dimensional parameter space spanned by pulse duration and pause (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). The vast majority of these fields have an elongated major axis defining stimulus parameters the female is most tolerant for, and a shorter minor axis defining parameters the female is most selective for. Multi-peaked response fields have been associated with a resonant recognition mechanism and have so far only been reported in katydids (<xref ref-type="bibr" rid="bib19">Bush and Schul, 2005</xref>; <xref ref-type="bibr" rid="bib103">Webb et al., 2007</xref>), not in crickets. The orientations of response fields measured in more than 20 cricket species cluster around four angles (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) forming four principal types of tuning. Intermediate types of phonotactic tuning may exist but have not been described yet. Specifically, duration tuning is defined as selectivity for pulse duration and tolerance for pause (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, lilac) (<italic>Teleogryllus commodus</italic>, <xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>, see also <xref ref-type="bibr" rid="bib32">Deutsch et al., 2019</xref>). This corresponds to the response field’s major axis being parallel to the pause axis (defined as an orientation <inline-formula><mml:math id="inf25"><mml:mi>θ</mml:mi></mml:math></inline-formula> of 0°, see inset in <xref ref-type="fig" rid="fig4">Figure 4D</xref>). By contrast, pause tuning (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, green) corresponds to an orientation <inline-formula><mml:math id="inf26"><mml:mi>θ</mml:mi></mml:math></inline-formula> of 90°, with the response field’s major axis extending parallel to the pulse duration axis. This type of tuning is not known in crickets, only in katydids (<xref ref-type="bibr" rid="bib96">Schul, 1998</xref>). Pulse period and duty cycle tuning correspond to response fields with diagonal and anti-diagonal orientations, respectively. Period tuning (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, purple) is given by an anti-diagonal orientation (<inline-formula><mml:math id="inf27"><mml:mi>θ</mml:mi></mml:math></inline-formula> = –45°), indicating selectivity for pulse period and tolerance for duty cycle (<italic>G. bimaculatus</italic>, <xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>; <xref ref-type="bibr" rid="bib52">Hennig, 2009</xref>; <xref ref-type="bibr" rid="bib88">Rothbart and Hennig, 2012</xref>). Last, duty cycle tuning (<xref ref-type="fig" rid="fig1">Figure 1C</xref>, cyan) is given by diagonal alignment (<inline-formula><mml:math id="inf28"><mml:mi>θ</mml:mi></mml:math></inline-formula> = 45°) and selectivity for duty cycle but tolerance for period (<italic>Gryllus lineaticeps</italic>, <xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>).</p><p>We first examined to what extent the model produced the single-peaked, asymmetrical response fields typical for crickets. We find that most response fields (80%) produced by the selective model variants were well described by a single ellipse (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2A and B</xref>, see Materials and methods for details). Of these, 83% were asymmetrical (major axis &gt;1.25× longer than minor axis), 17% were symmetrical (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2C</xref>). 12% of all models produce multi-peaked response fields (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2D</xref>), which are only known from katydids (<xref ref-type="bibr" rid="bib103">Webb et al., 2007</xref>). The remaining 8% of the response fields were not well described by ellipses and/or did not have multiple distinct peaks. Thus, while the model produces more diverse responses – including complex, multi-peaked ones – most responses do match those typical for crickets.</p><p>We next assessed the orientation of the single-peaked, asymmetrical response fields to test to what extent they fall into four principal types (<xref ref-type="fig" rid="fig4">Figure 4D</xref>). We find response fields with any orientation, again demonstrating that the network can produce more diverse response fields than has been reported in crickets. However, the orientations are unevenly distributed and are enriched for the principal types known from crickets: 36% of the response fields have an orientation of 0 ± 10°, which corresponds to duration tuning (expectation from uniform distribution: 20°/360° = 5.6%). Duty cycle tuning (45 ± 10°) and period tuning (–45 ± 10°) are also enriched, with 17% and 12%, respectively. Notably, pause tuning (90 ± 10°) is not known in crickets and is the only principal type that is rarer than expected from a uniform distribution of orientations (2.0% vs. 5.6% expected). The rarity of pause tuning is consistent with the bias to prefer short pulse durations observed above (<xref ref-type="fig" rid="fig4">Figure 4C</xref>) since orientations around 90° require response fields that extend parallel to the duration axis. Note that these trends do not depend critically on the ranges of angles chosen for specifying the different response types.</p><p>Overall, the response fields generated by the model are roughly consistent with the behavioral diversity in crickets: most response fields form a single, elongated ellipse, similar to the behaviorally measured response fields. Duration, duty cycle, and period tuning are frequent in the models and in crickets, pause tuning is rare in the models and absent in crickets. Interestingly, the network tends to create a larger diversity of response fields than is known from crickets, for instance, fields that are symmetrical, multi-peaked, or have intermediate orientations. This suggests that biases in the network – like the rarity of pause tuning – constrain the distribution of preferences that evolution can select from, and that additional factors – like robustness to noise or temperature – then determine the ultimate distribution of phenotypes. Our analysis of different model variants suggests that this song recognition network can produce all known preference types for pulse duration and pause over the range of stimulus parameters relevant for crickets. This phenotypic flexibility implies that the network may form the basis for the diversity of song recognition phenotypes. We therefore sought to identify model parameters that support that diversity, that is, parameters that change the preference for pulse period or that switch the preference from one type to another. We also looked for parameters that constrain the diversity, for instance, parameters that induce a bias towards low duty cycles (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>).</p></sec><sec id="s2-4"><title>Post-inhibitory rebound properties and coincidence timing are key parameters that shape preferences</title><p>To determine key parameters that control the network tuning and to identify the computational steps that induce the preference bias, we systematically examined the effect of changing individual model parameters on the response fields. We swept each parameter individually in 21 log-spaced steps over an interval of 1/100 to 100-fold around the value from the original fit (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). We then calculated a sensitivity score for each parameter as the average change in the response field of the network’s output neuron, LN4<sub>M</sub>, over the parameter sweep (see Materials and methods). Parameters that when changed produced mostly unselective or unresponsive models were excluded from subsequent analyses, as were parameters that only induced one or two sudden changes in the response fields. For instance, parameters that control the firing threshold of AN1 were excluded because they turn the input to the network on or off – this produces a large, step-like change in the response field and many unresponsive models. Our sensitivity analysis thereby focuses on parameters suitable for controlling the network’s tuning, that is, whose change induces smooth shifts in the model responses while retaining responsiveness and selectivity.</p><p>The topology of the pattern recognition network is defined by five neurons (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). As a first step, we sought to evaluate the importance of each neuron for controlling the network tuning by averaging the sensitivity scores for the parameters of each neuron (<xref ref-type="fig" rid="fig4">Figure 4G</xref>). This revealed that the network tuning can be least controlled through the parameters of AN1<sub>M</sub>, the input neuron of the network, and best controlled through the parameters of the non-spiking neuron LN5<sub>M</sub>, which generates the delayed post-inhibitory rebound. AN1<sub>M</sub> is unsuitable for control because changes in most parameters of AN1<sub>M</sub> will not induce a gradual change in tuning but will quickly produce no or unselective responses in the network. The importance of LN5<sub>M</sub> is consistent with the idea that the rebound and coincidence detection form the core computations of the network (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>) since the dynamics of the rebound response directly influence what stimulus features result in simultaneous inputs to the coincidence-detector neuron LN3<sub>M</sub>.</p><p>To identify important parameters for tuning the network, we ranked them by their sensitivity score (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). In line with the above analysis for each neuron, the top-ranked parameters directly affect the timing and the amplitude of inputs to LN3<sub>M</sub>. Among these are the delays and gains for the connections upstream of LN3<sub>M</sub> (AN1<sub>M</sub>→LN3<sub>M</sub>, LN2<sub>M</sub>→LN5<sub>M</sub>, LN5<sub>M</sub>→LN3<sub>M</sub>) but also the gain of the excitatory lobe of the LN2 filter (see <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Another group of important parameters affects the dynamics and amplitude of the rebound response in LN5<sub>M</sub>: first, the duration of the ‘postsynaptic’ filter of LN5<sub>M</sub> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), which is required to reproduce the adapting and saturating dynamics of the inputs to LN5<sub>M</sub>, visible as negative voltage components in recordings of LN5 (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). Second, the gain of the inhibitory and the duration of the excitatory lobe of the rebound filter that produces the post-inhibitory rebound (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). A modified sensitivity analysis, in which we changed combinations of two parameters at a time, produced a similar parameter ranking, confirming the robustness of these results (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>).</p><p>Our sensitivity analysis revealed key parameters that change the tuning of the network, but did not address their specific effect, for instance, on the preference for specific pulse durations or periods (<xref ref-type="fig" rid="fig4">Figure 4E</xref>). This is however crucial for understanding which network parameters need to be modified to produce a specific phenotype and where the bias for stimuli with low duty cycles (short pulses and long pauses) arises (<xref ref-type="fig" rid="fig4">Figure 4B–D</xref>). We therefore examined the specific effects of some of the top-ranked parameters (<xref ref-type="fig" rid="fig4">Figure 4H</xref>) on the tuning of the network.</p></sec><sec id="s2-5"><title>Relative timing of inputs to the coincidence detector controls pulse period preference</title><p>Four of the important parameters identified in our sensitivity analysis affect the timing of inputs to the coincidence-detector neuron LN3. Three of these parameters are the delays of the AN1<sub>M</sub>→LN3<sub>M</sub>, the LN2<sub>M</sub>→LN5<sub>M</sub>, and the LN5<sub>M</sub>→LN3<sub>M</sub> connections. The fourth parameter – the duration of the filter that shapes input adaptation in LN5<sub>M</sub> – also affects the input delays to LN3<sub>M</sub> (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). The delay between the spikes from AN1<sub>M</sub> and the rebound from LN5<sub>M</sub> in LN3<sub>M</sub> strongly affects network tuning since it determines which pulse train parameters produce coincident inputs required for driving spikes in LN3<sub>M</sub> (<xref ref-type="fig" rid="fig5">Figure 5A</xref>). Increasing this delay – for instance by delaying the rebound from LN5<sub>M</sub> – increases the preferred pulse period in LN3<sub>M</sub> (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). This delay was hypothesized to be the core parameter that tunes <italic>G. bimaculatus</italic> to a pulse period of 30–40 ms (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>), and our sensitivity analysis identifies this parameter as crucial for shaping the network’s tuning.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Input delays and response suppression control period and duty cycle preference.</title><p>(<bold>A</bold>) Inputs from LN5<sub>M</sub> and AN1<sub>M</sub> (orange and green shaded areas) to LN3<sub>M</sub> and output of LN3<sub>M</sub> (red line) for three input delays from LN5<sub>M</sub> to LN3<sub>M</sub> (‘rebound delay’ <inline-formula><mml:math id="inf29"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula>). The rebound delay is defined as the delay added to the output of LN5<sub>M</sub> in the model. The effective delay between the AN1<sub>M</sub> and LN5<sub>M</sub> inputs to LN3<sub>M</sub> depends on the pulse pattern (black, top, pulse duration 20 ms, pause 18 ms). An intermediate delay of 11 ms produces the most overlap between the AN1<sub>M</sub> and LN5<sub>M</sub> inputs for that stimulus and hence the strongest responses in LN3<sub>M</sub>. Vertical black line marks an AN1<sub>M</sub> response peak, arrows point from the nearest LN5<sub>M</sub> response peak. (<bold>B</bold>) Preferred periods for LN3<sub>M</sub> (red), LN4<sub>M</sub> in an intact model (purple), and LN4<sub>M</sub> in a model without inhibition from LN2<sub>M</sub> to LN4<sub>M</sub> (blue) as a function of the rebound delay. The preferred period increases with rebound delay for all three cases. (<bold>C</bold>) Response fields for LN3<sub>M</sub> (left), LN4<sub>M</sub> in an intact network (middle), and for LN4<sub>M</sub> in a model without inhibition in LN4<sub>M</sub> from LN2<sub>M</sub> (right) (color coded, see color bar). The rebound delay was set to 21 ms, which increases the preferred period in both LN3<sub>M</sub> and LN4<sub>M</sub> to 50 ms (left, compare <bold>B</bold>). However, increasing the delay also decreases the preferred duty cycle in LN4<sub>M</sub> (middle). Removing the inhibition from LN2<sub>M</sub> in LN4<sub>M</sub> abolishes the change in duty cycle preference (right). Anti-diagonal lines mark the preferred period of 50 ms for each response field, and lines starting at the origin mark the preferred duty cycle. (<bold>D</bold>) Same as (<bold>B) </bold>but for the preferred duty cycle. With increasing delay, the preferred duty cycle for LN4<sub>M</sub> approaches 0.25 but is stable for LN3<sub>M</sub> and for LN4<sub>M</sub> without inhibition (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). (<bold>E</bold>) Inputs to LN4<sub>M</sub> (middle, green: inhibition from LN2<sub>M</sub>; red: excitation from LN3<sub>M</sub>) and output of LN4<sub>M</sub> (bottom, purple) for the intact network in (<bold>C</bold>) and for three different stimulus sequences with a pulse period of 54 ms and increasing duty cycles (top, black). Responses are shown for the second pulse in a train. Excitatory input from LN3<sub>M</sub> is weaker and overlaps more with the inhibition for high duty cycles (compare amplitude and latency of response peaks in LN3<sub>M</sub>), leading to a reduction in LN4<sub>M</sub> responses with increasing duty cycle. Y-scales are identical for all three panels and were omitted for clarity. (<bold>F</bold>) Dependence of peak amplitude (top) and peak latency (time from pulse onset to response peak, middle) of inputs to LN4<sub>M</sub> (red: excitation from LN3<sub>M</sub>; green: inhibition from LN2<sub>M</sub>) on pulse duty cycle for the intact network in (<bold>C</bold>). Weaker and later excitation suppresses LN4<sub>M</sub> responses for pulse trains with high duty cycles (bottom, purple). (<bold>G</bold>) Four sources of suppression in the network: the inhibitory lobe in the filter of AN1<sub>M</sub> (green), adaptation in AN1<sub>M</sub> (cyan) and LN3<sub>M</sub> (red), and inhibition in LN4<sub>M</sub> from LN2<sub>M</sub> (purple). Shown are responses to a pulse pattern (top black, 20 ms pulse duration and 20 ms pause) when the source of suppression is present (dashed lines) or absent (solid lines). Removing suppression produces stronger or more sustained responses. ‘A’ and ‘I’ refer to adaptation and inhibition, respectively. (<bold>H</bold>) Response fields (color coded, see color bar) for the network output (LN4<sub>M</sub>) after removing different sources of suppression. The presence or absence of different sources of suppression is marked with a ‘+’ and a ‘–’, respectively. Removing suppression in the network increases the preferred duty cycle. Lines mark the preferred pulse duty cycle, and black dots indicate the preferred pulse duration and pause. (<bold>I</bold>) Preferred duty cycle in LN4<sub>M</sub> as a function of the number of sources of adaption present in the model. Black dots show the preferred duty cycle of individual model variants, the purple line shows the average over models for a given number of adaptation sources. Adaptation decreases the preferred duty cycle (Pearson’s <italic>r</italic> = 0.78, p=3 × 10<sup>-4</sup>). See <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> for details. The pulse trains for all simulations in this figure had a duration of 600 ms and were interleaved by chirp pauses of 200 ms to ensure that trains contained enough pulses even for long pulse durations and pauses. Rebound delay set to 21 ms in (<bold>C</bold>) and (<bold>E–I</bold>) to make changes in the duty cycle preference more apparent.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Increasing the duration of the postsynaptic filter in LN5<sub>M</sub> delays rebound responses and increases the preferred pulse period in LN3<sub>M</sub>.</title><p>(<bold>A</bold>) Rebound responses of LN5<sub>M</sub> (top) and responses of the coincidence detector LN3<sub>M</sub> (bottom) for models with a normal (black) and a long (green) postsynaptic filter in LN5<sub>M</sub> (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). The three stimuli (black) have pulse periods of 12, 16, and 24 ms (from left to right) and duty cycles of 0.5. Increasing the filter duration delays rebound responses in LN5<sub>M</sub> (middle row, arrows) and therefore shifts the pulse period at which LN3<sub>M</sub> is most strongly driven towards higher values (bottom row, arrows). (<bold>B, C</bold>) Period tuning of LN3<sub>M</sub> (<bold>B</bold>) and of the network output LN4<sub>M</sub> (<bold>C</bold>) for LN5<sub>M</sub> with a normal (5 ms, black) and a long (31 ms, green) postsynaptic filter. The differentiating postsynaptic filter (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) mediates adaptation and saturation of the inputs to the rebound filter in LN5<sub>M</sub> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Increasing the filter duration increases the preferred pulse period in LN3<sub>M</sub> (<bold>B</bold>), and this effect is further amplified in LN4<sub>M</sub> (<bold>C</bold>). Vertical black lines indicate the periods for the stimuli shown in (<bold>A</bold>). Response traces (<bold>A</bold>) and tuning curves (<bold>B, C</bold>) were normalized to peak at 1.0.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Preferred pulse and pause parameters for LN3<sub>M</sub> (red), LN4<sub>M</sub> (purple), and LN4<sub>M</sub> without inhibition from LN2<sub>M</sub> over the range of rebound delays tested in <xref ref-type="fig" rid="fig5">Figure 5B and D</xref> (1–21 ms).</title><p>Arrows point in the direction of increasing delays. The anti-diagonal line marks the pulse period of 50 ms, and the diagonal lines mark the pulse duty cycles (DCs) of 0.25 and 0.5. With increasing delay, the preferred duty cycle for LN4<sub>M</sub> approaches 0.25 but is stable at around 0.45 for LN3<sub>M</sub> and LN4<sub>M</sub> without inhibition (compare <xref ref-type="fig" rid="fig5">Figure 5D</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Adaptation decreases the preferred duty cycle and has weak effects on the preferred period.</title><p>(<bold>A</bold>) Preferred duty cycles for models with different sources of suppression present (+) or absent (–) (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). ‘I’ and ‘A’ denote inhibition and adaption, respectively. (<bold>B, C</bold>) Preferred duty cycle (<bold>B</bold>) and period (<bold>C</bold>) as a function of the number of sources of suppression present in the model. The preferred duty cycle decreases with suppression, while the preferred period remains relatively constant. The preferred period for a model without adaptation (zero sources of adaptation) is reduced because this model was tuned for duty cycle, with very broad selectivity for period (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, rightmost panel).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig5-figsupp3-v2.tif"/></fig></fig-group><p>Interestingly, changing the rebound delay has differential effects in LN3<sub>M</sub> and in the output neuron of the network, LN4<sub>M</sub>. In LN3<sub>M</sub>, increasing the rebound delay changes both duration and pause preference and increases the preferred pulse period without changing the duty cycle preference (<xref ref-type="fig" rid="fig5">Figure 5C and D</xref>). However, in LN4<sub>M</sub>, a longer rebound delay only affects pause preference, but not duration preference, and thereby reduces the preferred duty cycle from 0.50 to 0.25 (<xref ref-type="fig" rid="fig5">Figure 5D</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). This reduction of the preferred duty cycle is a correlate of the low duty cycle bias observed in the network (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). We therefore investigated the origin of this effect more closely.</p><p>LN4<sub>M</sub> receives excitatory input from LN3<sub>M</sub> and inhibitory input from LN2<sub>M</sub> and applies a threshold to the summed inputs (see <xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). To determine which computation in LN4<sub>M</sub> reduces the preferred duty cycle, we removed the inhibition from LN2<sub>M</sub> and the threshold in LN4<sub>M</sub>’s output nonlinearity. While the threshold has only minor effects on tuning, removing the inhibition is sufficient to restore the preference for intermediate duty cycles in LN4<sub>M</sub> (<xref ref-type="fig" rid="fig5">Figure 5B–D</xref>, blue). This implies that the inhibition from LN2<sub>M</sub> suppresses the responses to high duty cycles in LN4<sub>M</sub>. We find that changes in the strength and in the timing of excitatory inputs from LN3<sub>M</sub> to LN4<sub>M</sub> contribute to this suppression (<xref ref-type="fig" rid="fig5">Figure 5E and F</xref>). First, the excitatory inputs from LN3<sub>M</sub> weaken with increasing duty cycle, leading to a relatively stronger impact of the inhibition from LN2<sub>M</sub> on the responses of LN4<sub>M</sub> (<xref ref-type="fig" rid="fig5">Figure 5F</xref>). Second, the excitatory inputs from LN3<sub>M</sub> arrive later with increasing duty cycle, resulting in a more complete overlap with the inhibition from LN2<sub>M</sub> and therefore to a more effective suppression of LN4<sub>M</sub> spiking responses (<xref ref-type="fig" rid="fig5">Figure 5E and F</xref>).</p><p>These results demonstrate that response suppression by inhibition in LN4<sub>M</sub> becomes more effective at high duty cycles and is one source of the network’s bias towards low duty cycle preferences (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). We reasoned that other sources of response suppression, like inhibition or response adaptation elsewhere in the network, could further contribute to this bias.</p></sec><sec id="s2-6"><title>Mechanisms of response suppression control duty cycle preference</title><p>Four additional computational steps in the network could contribute to the bias against high duty cycles (<xref ref-type="fig" rid="fig5">Figure 5G</xref>): first, the broad inhibitory lobe of the filter in AN1<sub>M</sub> (<xref ref-type="fig" rid="fig2">Figure 2A</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) reduces responses to subsequent pulses in a train (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, green, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A and B</xref>) because its effect accumulates over multiple pulses. Importantly, this suppression grows with the integral of the stimulus over the duration of the filter lobe and hence with the pulse duration and duty cycle. In AN1<sub>M</sub>, this leads to shorter pulse responses due to thresholding and saturation by the output nonlinearity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>, <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). Second and third, the adaptation in AN1<sub>M</sub> and LN3<sub>M</sub> accumulates during and across pulses and reduces these neuron’s responses (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, teal and red). This effect is again most prominent for pulse patterns with high duty cycles (long pulses, short pauses) since adaptation will be strongest during long pulses and recovery prevented during short pauses. Last, as discussed above, the inhibition from LN2<sub>M</sub> also suppresses responses in LN4<sub>M</sub> most strongly for stimuli with high duty cycle (<xref ref-type="fig" rid="fig5">Figure 5G</xref>, purple).</p><p>To examine how the different sources of suppression shape the model’s tuning, we removed one or more of these computational steps: we set the inhibitory lobe of the AN1<sub>M</sub> filter to zero, we removed the adaptation from AN1<sub>M</sub> and LN3<sub>M</sub>, and we removed the inhibition forwarded from LN2<sub>M</sub> to LN4<sub>M</sub> (<xref ref-type="fig" rid="fig5">Figure 5G</xref>). To accentuate the effects of these manipulations, we increased the delay of the LN5<sub>M</sub>→LN3<sub>M</sub> connection, which led to a preference for longer pulse periods (50 ms) and for short duty cycles (0.25) in LN4<sub>M</sub> when all sources of suppression were present (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, left). Consistent with the prediction that different sources of suppression in the network reduce responses for stimuli with high duty cycles, the network’s preferred duty cycle tended to increase when suppression was removed (Figure 5H and I, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Removing some sources of suppression tended to induce more sustained responses during a pulse train (<xref ref-type="fig" rid="fig5">Figure 5G</xref>) and to increase the preferred duty cycle from 0.25 to 0.50 (<xref ref-type="fig" rid="fig5">Figure 5H and I</xref>). Removing all four sources of suppression abolished period tuning and produced a preference for constant tone stimuli with a duty cycle of 1.0 (<xref ref-type="fig" rid="fig5">Figure 5H</xref>, right). Different sources of suppression sometimes interacted in unexpected ways. For instance, removing the inhibitory lobe and adaptation in AN1<sub>M</sub> decreased rather than increased duty cycle preference because AN1<sub>M</sub> produced stronger responses when adaptation was absent, which in turn induced stronger adaptation downstream in the network.</p><p>Overall, these results identify mechanisms of response suppression by adaptation and inhibition as a cause for the network preferring small duty cycles (short pulses and long pauses). They demonstrate how specific implementation details of a recognition mechanism constrain phenotypic diversity, but also reveal how different model parameters can be used to create phenotypic diversity, like changing the preferred duty cycle (<xref ref-type="fig" rid="fig5">Figure 5D,H, and I</xref>). As a last step in our analysis, we examined a parameter that switches the preference type from period to duration tuning via changes in the rebound dynamics.</p></sec><sec id="s2-7"><title>Changes in rebound dynamics can switch the preference type by engaging suppression</title><p>Switches in preference type occur regularly even among closely related cricket species (<xref ref-type="bibr" rid="bib7">Bailey et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>; <xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>), and we therefore looked for a model parameter that induced such a switch. We found that increasing the gain of the inhibitory lobe of the rebound filter in LN5<sub>M</sub> (‘inhibitory lobe’ in short) (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue) switched the preference from period tuning (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, bottom) to duration tuning (<xref ref-type="fig" rid="fig6">Figure 6B</xref>, top), characterized by high tolerance for pause and high selectivity for duration (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Increasing the inhibitory lobe parameter amplifies but also prolongs the rebound (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue), and we examined which of these two changes creates the switch from period to duration tuning. Other model parameters – like the gain of the input from LN2<sub>M</sub> to LN5<sub>M</sub> or from LN5<sub>M</sub> to LN3<sub>M</sub> (<xref ref-type="fig" rid="fig6">Figure 6A and B</xref>, ‘input gain,’ red) or the LN5<sub>M</sub> output gain – only amplify the rebound and retain period tuning. This indicates that the amplification of the rebound is insufficient, and that the prolongation of the rebound is necessary to cause the preference switch. In the original model, rebounds are short because the inhibition of LN5<sub>M</sub> triggered by LN2<sub>M</sub> activity always cuts off and suppresses rebound responses (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, black, see also <xref ref-type="fig" rid="fig2">Figure 2E and F</xref>), and this happens even when the rebound is amplified (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, red). By contrast, in the model with an increased inhibitory lobe of the LN5<sub>M</sub> rebound filter, the rebound persists during the LN2<sub>M</sub> inhibition (<xref ref-type="fig" rid="fig6">Figure 6A</xref>, blue). The prolonged rebound drives stronger adaptation downstream in LN3<sub>M</sub> (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>), in particular for pulse patterns with short pauses, because shorter pauses prevent recovery from adaptation in LN3<sub>M</sub>. This response suppression for short pauses abolishes the preference for intermediate pause durations necessary for period tuning and switches the preference type to duration tuning (<xref ref-type="fig" rid="fig6">Figure 6C</xref>). This last analysis highlights the dual role of suppression in shaping the recognition phenotype of the network: suppression constrains phenotypic diversity by reducing responses to patterns with long duty cycles (<xref ref-type="fig" rid="fig4">Figure 4C and D</xref>, <xref ref-type="fig" rid="fig5">Figure 5H and I</xref>), but it also contributes to phenotypic diversity by adjusting the network’s preferred duty cycle (<xref ref-type="fig" rid="fig5">Figure 5H, I</xref>) or by switching the preference type (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Changes in LN5<sub>M</sub> rebound dynamics induce a switch in response type.</title><p>(<bold>A</bold>) Increasing the amplitude of the inhibitory lobe of the filter in LN5<sub>M</sub> that generates the rebound (middle, blue, ‘inhibitory lobe’) increases the rebound’s amplitude and duration. By contrast, the gain of the input from LN5<sub>M</sub> to LN3<sub>M</sub> (bottom, red, ‘input gain’) scales the input from the LN5<sub>M</sub> rebound without prolonging it. Pictograms on the right show the parameters for the original model (black) and for a model with a 10-fold increase in the respective parameter value (blue and red). Traces show the rebound inputs from LN5<sub>M</sub> to LN3<sub>M</sub> for the pulse pattern shown on top (black traces, 20 ms pulse duration and 20 ms pause). (<bold>B</bold>) Response fields of LN4<sub>M</sub> for the original model (bottom), and for models with increased inhibitory lobe (top) or input gain (middle). Response magnitudes are color coded (see color bar, scaled to span the range of response magnitudes). Amplifying and prolonging the rebound by increasing the inhibitory lobe (top) produces pause tuning, while only amplifying the rebound via the input gain retains period tuning (bottom). Vertical lines correspond to the stimuli for which pause tuning curves are shown in (<bold>C</bold>). (<bold>C</bold>) Pause tuning curves for LN4<sub>M</sub> at a pulse duration of 20 ms (see lines in <bold>B</bold>) reveal differential effects of the parameters on pause tuning. Amplifying and prolonging the rebound by increasing the inhibitory filter lobe (blue) produces high tolerance for pause duration, in this case high-pass tuning, which is required to obtain duration tuning. By contrast, only amplifying the rebound via the input gain (red) retains the preference for intermediate pauses characteristic for period tuning. The pulse trains had a duration of 600 ms and were interleaved by chirp pauses of 200 ms for all simulations to ensure that the stimuli in the response fields contained enough pulses even for long pulse durations and pauses.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Sustained rebound responses in LN5<sub>M</sub> induce stronger adaptation in LN3<sub>M</sub> for pulse patterns with short pauses.</title><p>Traces of LN5<sub>M</sub>→LN3<sub>M</sub> inputs (middle) and LN3<sub>M</sub> responses (bottom) for models with 10-fold increased input gain (red) or inhibitory lobe (blue). The sustained rebound response for pulse trains with short pauses in models with an increased inhibitory lobe (blue, middle) leads to stronger adaptation in LN3<sub>M</sub> (blue, bottom). This reduces responses specifically for pulse patterns with short pauses (bottom, first two panels) and causes the switch from bandpass to high-pass tuning for pulse pause (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Arrows indicate changes of opposing sign in the input to LN3<sub>M</sub> (middle) and the responses of LN3<sub>M</sub> (bottom). Stimuli (top, black) have pulse durations of 10 ms and pauses of 5, 15, and 35 ms.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-61475-fig6-figsupp1-v2.tif"/></fig></fig-group></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>How diversity in intraspecific communications systems is shaped by neural networks in the sender and in the receiver is an open question. Here, we asked whether the song recognition network in <italic>G. bimaculatus</italic> (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>) has the potential to generate the diversity of song recognition phenotypes known from crickets. In particular, we tested whether the delay line and coincidence-detector network in <italic>G. bimaculatus</italic> can be considered a ‘mother network’ for recognizing the species-specific song pattern in different cricket species (<xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>). A model of the neuronal network reproduced the neurophysiological and behavioral data using simple, elementary computations like filtering, nonlinear transfer functions (nonlinearities), adaptation, and linear transmission with delays (<xref ref-type="fig" rid="fig2">Figures 2</xref> and <xref ref-type="fig" rid="fig3">3</xref>). Examining the model’s responses over a wide range of parameter values revealed that the network can generate all types of song preferences known from different crickets and even other insects (<xref ref-type="fig" rid="fig4">Figure 4A–E</xref>). We then identified key parameters that either support or constrain the phenotypic diversity the network can produce, providing insight into how the network can evolve to become selective for different song parameters (<xref ref-type="fig" rid="fig4">Figures 4F-H</xref>—<xref ref-type="fig" rid="fig6">6</xref>).</p><sec id="s3-1"><title>The delay line and coincidence-detector network can produce the full diversity of preferences for pulse duration and pause in crickets</title><p>Four principal preference types have been identified in crickets and other insects (<xref ref-type="fig" rid="fig1">Figure 1B</xref>): preference for pulse duration (<xref ref-type="bibr" rid="bib32">Deutsch et al., 2019</xref>; <xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>; <xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>), pulse pause (<xref ref-type="bibr" rid="bib96">Schul, 1998</xref>), pulse period (<xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>; <xref ref-type="bibr" rid="bib52">Hennig, 2009</xref>; <xref ref-type="bibr" rid="bib88">Rothbart and Hennig, 2012</xref>; <xref ref-type="bibr" rid="bib89">Rothbart et al., 2012</xref>), and duty cycle (<xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>). Variants of our network model produce all four of these preference types for the range of song parameter values relevant for crickets (<xref ref-type="fig" rid="fig4">Figure 4A–E</xref>).</p><p>While the network model analyzed here is derived from recordings in one species (<italic>G. bimaculatus</italic>), the delay line and coincidence-detector network is likely shared within the closely related cricket species. The phylogenetic position of <italic>G. bimaculatus</italic> close to the base of the phylogenetic tree from which many other species emerged is consistent with this idea (<xref ref-type="bibr" rid="bib42">Gray and Cade, 2000</xref>). Our finding that this network can produce all known preferences for pulse and pause supports this idea and suggests that it forms a common substrate – a ’mother network‘ – for the diversity of song recognition phenotypes in crickets. How can the ‘mother network’ hypothesis be tested? Behavioral tests can provide insight into whether other species use the coincidence-detection algorithm found in <italic>G. bimaculatus</italic> (<xref ref-type="bibr" rid="bib48">Hedwig and Sarmiento-Ponce, 2017</xref>). These experiments can, for instance, test the prediction that the duration of the last pulse in a chirp only weakly impacts network responses. Species that violate this prediction are unlikely to recognize song by the same coincidence mechanism. However, the ‘mother network’ hypothesis does not imply that all crickets implement a coincidence-detection algorithm, just that they reuse the same neurons with largely conserved response properties. In fact, our analyses have shown that coincidence detection can be circumvented through changes in key parameters to produce a different preference type (<xref ref-type="fig" rid="fig6">Figure 6</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). That is why further electrophysiological experiments in <italic>G. bimaculatus</italic> are crucial to reveal the precise biophysical mechanisms that tune the network and ultimately link changes in gene expression, for instance, of specific ion channels, to changes in network tuning. Importantly, these experiments need to be extended to other species by identifying and characterizing homologues of the neurons in the network. Recordings in other species are challenging but feasible since homologous neurons are expected to be found in similar locations in the brain. Our model produces testable predictions based on the known behavioral tuning for how key properties of these neurons may look like in any given species (see below).</p><p>Future studies will also show whether the network can explain more complex preference functions known from some crickets and also other insects. For instance, preference types that betray resonant cellular or network properties are known from katydids (<xref ref-type="bibr" rid="bib19">Bush and Schul, 2005</xref>; <xref ref-type="bibr" rid="bib103">Webb et al., 2007</xref>), and we find that the network can produce these multi-peaked response fields (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2D</xref>), but it remains to be seen whether similar preference types exist in crickets. Several species of crickets produce complex songs that are composed of multiple types of pulse trains, and it is unclear whether the current network can reproduce the known behavioral preference for such complex songs (<xref ref-type="bibr" rid="bib7">Bailey et al., 2017</xref>; <xref ref-type="bibr" rid="bib29">Cros and Hedwig, 2014</xref>; <xref ref-type="bibr" rid="bib50">Hennig and Weber, 1997</xref>).</p><p>In addition, we have not yet explored the network’s ability to reproduce the behavioral selectivity for parameters on the longer timescale of chirps (<xref ref-type="fig" rid="fig1">Figure 1A</xref>; <xref ref-type="bibr" rid="bib44">Grobe et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Blankers et al., 2016</xref>; <xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>). It is likely that the network can explain some properties of the selectivity for chirp known from crickets. For instance, that a minimum of two pulses is required to produce coincidence in the network could at least partly explain the existence of a minimal chirp duration for <italic>G. bimaculatus</italic> (<xref ref-type="bibr" rid="bib44">Grobe et al., 2012</xref>). Likewise, suppression in the network reduces responses to long chirps, which could explain the reduced behavioral preference for long chirps. However, the current electrophysiological data do not sufficiently constrain responses at these long timescales and studies are needed to address this issue more comprehensively.</p><p>Lastly, our model does not address the behaviourally well-documented inter-individual variability in phonotaxis behaviors (<xref ref-type="bibr" rid="bib44">Grobe et al., 2012</xref>; <xref ref-type="bibr" rid="bib69">Meckenhäuser et al., 2014</xref>), which likely arises at multiple levels: At the level of song pattern recognition (inter-individual differences in the network parameters) at the level of phonotaxis behavior (biases and noise in localizing the sound) at the motivational level (low or high motivation leads to more or less selective responses) and at the motor level (variability from motor noise). Identifying the contribution of these different levels is challenging since the full characterization of the behavioral phenotype in terms of the response fields cannot be obtained reliably at the individual level - the stimulus space is too large. Therefore our model of song pattern does not explicitly consider the inder-individual variability but is meant to represent he behavior of an average female.</p></sec><sec id="s3-2"><title>How to tune a pulse pattern detector?</title><p>Our sensitivity analysis of the model identified three classes of parameters that define the model’s tuning (<xref ref-type="fig" rid="fig4">Figure 4H</xref>). First, parameters that control the relative timing of inputs to the coincidence-detector LN3<sub>M</sub> set the network’s preferred pulse period. These include input delays in all upstream neurons (<xref ref-type="fig" rid="fig5">Figure 5A and B</xref>) but also passive and active membrane properties that delay the rebound responses in LN5<sub>M</sub> (<xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Second, parameters that lead to a stronger and more sustained rebound in LN5<sub>M</sub> can shift the preference from pulse period to pulse duration tuning (<xref ref-type="fig" rid="fig6">Figure 6</xref>). Lastly, sources of response suppression, like inhibition or adaptation, reduce responses to long pulses and high duty cycles (<xref ref-type="fig" rid="fig5">Figure 5G–I</xref>). These three classes of parameters account for changes within and transitions across the principal types of song preference in crickets. The model thus provides testable hypotheses for how response properties in the neuronal network may have evolved to compute the preference functions of different species. For instance, species that prefer different pulse periods than <italic>G. bimaculatus</italic> like <italic>Teleogryllus leo</italic> (<xref ref-type="bibr" rid="bib88">Rothbart and Hennig, 2012</xref>), <italic>Gryllus locorojo</italic> (<xref ref-type="bibr" rid="bib89">Rothbart et al., 2012</xref>), <italic>Gryllus firmus</italic> (<xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>), or <italic>Teleogryllus oceanicus</italic> (<xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>) could differ in the delays of inputs to LN3 (<xref ref-type="fig" rid="fig5">Figure 5B</xref>). Duty cycle-tuned species like <italic>G. lineaticeps</italic> or G15 (<xref ref-type="bibr" rid="bib54">Hennig et al., 2016</xref>) may exhibit weaker suppression throughout the network, for instance, reduced adaptation in LN3 (<xref ref-type="fig" rid="fig5">Figure 5G–I</xref>). Lastly, species with duration tuning such as <italic>T. commodus</italic> (<xref ref-type="bibr" rid="bib51">Hennig, 2003</xref>) or G13 (<xref ref-type="bibr" rid="bib43">Gray et al., 2016</xref>) could exhibit longer and stronger rebound responses in LN5 (<xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>How can these changes be implemented in a biological network? Although our phenomenological model is independent of a specific biophysical implementation, all model components have straightforward biophysical correlates. We can therefore propose biophysical parameters that tune specific aspects of the network in a given implementation. To illustrate this point, we will briefly provide examples of how the four elementary computations of the model – filtering, adaptation, nonlinear transfer functions (nonlinearities), and linear transmission with a delay – can be implemented and tuned. First, filters are shaped by active and passive properties of the membrane: individual filter lobes act as low-pass filters that dampen responses to fast inputs and arise from integrating properties of the passive membrane like capacitive currents (<xref ref-type="bibr" rid="bib33">Dewell and Gabbiani, 2019</xref>; <xref ref-type="bibr" rid="bib6">Azevedo and Wilson, 2017</xref>). Increasing the membrane capacitance therefore leads to stronger low-pass filtering. An added negative (inhibitory) lobe makes the stimulus transformation differentiating and can arise from conductances that hyperpolarize the membrane, like potassium or chloride channels (<xref ref-type="bibr" rid="bib71">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib98">Slee et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Lundstrom et al., 2008</xref>). Increasing the potassium conductance in <italic>Drosophila</italic> olfactory receptor neurons makes their responses more differentiating (<xref ref-type="bibr" rid="bib71">Nagel and Wilson, 2011</xref>), while reducing the conductance of delayed-rectifier potassium channels in the auditory brainstem makes responses less differentiating (<xref ref-type="bibr" rid="bib98">Slee et al., 2005</xref>; <xref ref-type="bibr" rid="bib65">Lundstrom et al., 2008</xref>). The filter in LN5<sub>M</sub> that produces the post-inhibitory rebound arises from hyperpolarization-activated cation currents like I<sub>h</sub> (mediated by HCN non-selective cation channels) and I<sub>t</sub> (mediated by T-type calcium channels), which control the PIR’s amplitude and latency, respectively (<xref ref-type="bibr" rid="bib78">Pape, 1996</xref>; <xref ref-type="bibr" rid="bib34">Engbers et al., 2011</xref>). Second, adaptation is implemented in the model either via inhibitory filter lobes or via divisive normalization. Biophysically, adaptation can arise from synaptic depression (<xref ref-type="bibr" rid="bib100">Tsodyks et al., 1998</xref>; <xref ref-type="bibr" rid="bib37">Fortune and Rose, 2001</xref>), or from subthreshold or spike-frequency adaptation (<xref ref-type="bibr" rid="bib35">Farkhooi et al., 2013</xref>; <xref ref-type="bibr" rid="bib71">Nagel and Wilson, 2011</xref>; <xref ref-type="bibr" rid="bib11">Benda and Herz, 2003</xref>; <xref ref-type="bibr" rid="bib12">Benda and Hennig, 2008</xref>). Spike-frequency adaptation can arise from inactivating sodium currents, voltage-gated potassium currents (M-type currents), or calcium-gated potassium currents (AHP currents) (<xref ref-type="bibr" rid="bib98">Slee et al., 2005</xref>; <xref ref-type="bibr" rid="bib49">Heidenreich et al., 2011</xref>). Increasing the expression level of these channels controls the strength of adaptation, while the kinetics specific to each channel type control adaptation speed. AHP currents can last seconds if spiking leads to a long-lasting increase in the intracellular calcium concentration, giving rise to long inhibitory filter lobes or adaptation time constants in the model (<xref ref-type="bibr" rid="bib27">Cordoba-Rodriguez et al., 1999</xref>). Third, nonlinearities translate the integrated synaptic input to firing output. The nonlinearity’s threshold is governed by the density of sodium channels at the spike-initiating zone while the steepness and saturation of the nonlinearity depend on the inactivation kinetics of sodium channels or the spiking dynamics controlled by the Na/K ratio (<xref ref-type="bibr" rid="bib81">Prescott et al., 2008</xref>; <xref ref-type="bibr" rid="bib65">Lundstrom et al., 2008</xref>). Lastly, transmission delays arise from axonal conduction and synaptic delays but also other mechanisms, like low-pass filtering of the membrane voltage at the pre- and postsynapse (<xref ref-type="bibr" rid="bib28">Creutzig et al., 2010</xref>; <xref ref-type="bibr" rid="bib107">Zhou et al., 2019</xref>), latencies arising from integration of inputs to the spiking threshold, or from spike generation (<xref ref-type="bibr" rid="bib57">Izhikevich, 2004</xref>; <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). Synaptic weights are set by the number of synaptic boutons between two neurons (Peter’s rule, see <xref ref-type="bibr" rid="bib86">Rees et al., 2017</xref>) and the amount of neurotransmitter that can be released at the presynapse (vesicle number and loading) and absorbed at the postsynapse (number of transmitter receptors). These examples demonstrate that our phenomenological model has a straightforward, physiologically plausible implementation and can propose experimentally testable hypotheses for transitions between types of behavioral preferences.</p><p>The three computations that define model tuning – response suppression, post-inhibitory rebounds, and coincidence detection – occur across species and modalities. Delay lines are prominent in binaural spatial processing (<xref ref-type="bibr" rid="bib93">Schnupp and Carr, 2009</xref>) but have also been implicated in visual motion detection (<xref ref-type="bibr" rid="bib16">Borst and Helmstaedter, 2015</xref>) or pulse duration selectivity in vertebrate auditory systems (<xref ref-type="bibr" rid="bib5">Aubie et al., 2012</xref>; <xref ref-type="bibr" rid="bib18">Buonomano, 2000</xref>). Suppression is known to act as a high-pass filter for pulse repetition rates (<xref ref-type="bibr" rid="bib8">Baker and Carlson, 2014</xref>; <xref ref-type="bibr" rid="bib11">Benda and Herz, 2003</xref>; <xref ref-type="bibr" rid="bib37">Fortune and Rose, 2001</xref>) that in our case biases the network towards responding to rapidly changing patterns, like those with short pulses (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Finally post-inhibitory rebounds have been implicated in temporal processing in different species like honeybees (<xref ref-type="bibr" rid="bib1">Ai et al., 2018</xref>), fish (<xref ref-type="bibr" rid="bib63">Large and Crawford, 2002</xref>), frogs (<xref ref-type="bibr" rid="bib87">Rose et al., 2015</xref>), or mammals (<xref ref-type="bibr" rid="bib36">Felix et al., 2011</xref>; <xref ref-type="bibr" rid="bib60">Kopp-Scheinpflug et al., 2018</xref>). The computations found to control the song preference in <italic>G. bimaculatus</italic> could therefore also govern pattern recognition in other acoustically communicating animals. For instance, different bird species produce songs with silent gaps of species-specific durations between syllables and auditory neurons in the bird’s brain are sensitive to these gaps (<xref ref-type="bibr" rid="bib4">Araki et al., 2016</xref>). Our analyses suggest that the gap preference can be shifted from longer gaps (low duty cycle: Java sparrow, Bengalese finch) to shorter gaps (high duty cycle, starling, zebra finch) by reducing suppression or adaptation in the network. This could be implemented, for example, by reducing postsynaptic GABA receptors or by lowering the expression levels of voltage-gated potassium channels.</p><p>We here focused on modifying the magnitude of parameters, corresponding, for instance, to the expression levels of neurotransmitters or ion channels. Neuronal networks, however, can also evolve to produce novel phenotypes by changing their topology, through a recruitment of novel neurons, a gain or loss of synapses, or switches in synapse valence from excitatory to inhibitory as has been shown in motor networks in <italic>Caenorhabditis elegans</italic> (<xref ref-type="bibr" rid="bib56">Hong et al., 2019</xref>) and snails (<xref ref-type="bibr" rid="bib59">Katz, 2011</xref>). In addition, we have not considered neuromodulators, which can rapidly alter network tuning (<xref ref-type="bibr" rid="bib10">Bargmann, 2012</xref>; <xref ref-type="bibr" rid="bib66">Marder, 2012</xref>; <xref ref-type="bibr" rid="bib67">Marder et al., 2014</xref>), and which likely play a functional role in the phonotactic response (<xref ref-type="bibr" rid="bib80">Poulet and Hedwig, 2005</xref>).</p></sec><sec id="s3-3"><title>Algorithmic details specify constraints</title><p>Previous studies revealed that Gabor filters can produce the full diversity of song preference functions found in insects (<xref ref-type="bibr" rid="bib21">Clemens and Hennig, 2013</xref>; <xref ref-type="bibr" rid="bib22">Clemens and Ronacher, 2013</xref>; <xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>). However, the computation giving rise to Gabor filters can be implemented with multiple algorithms, each subject to specific constraints. For instance, the period tuning found in <italic>G. bimaculatus</italic> can be produced by the now known delay line and coincidence detection mechanism (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>), but also by the interplay between precisely timed excitation and inhibition (<xref ref-type="bibr" rid="bib5">Aubie et al., 2012</xref>; <xref ref-type="bibr" rid="bib85">Rau et al., 2015</xref>), by cell-intrinsic properties like resonant conductances (<xref ref-type="bibr" rid="bib6">Azevedo and Wilson, 2017</xref>; <xref ref-type="bibr" rid="bib85">Rau et al., 2015</xref>), or by a combination of synaptic depression and facilitation (<xref ref-type="bibr" rid="bib37">Fortune and Rose, 2001</xref>). By considering the implementation of the pattern recognition algorithm in a particular species, we revealed a bias in the diversity of phenotypes that this specific implementation can produce: several sources of suppression induce a bias towards preference for low duty cycle stimuli (<xref ref-type="fig" rid="fig4">Figures 4B–D</xref>–<xref ref-type="fig" rid="fig5">5G–I</xref>). This highlights the importance of studying nervous system function and evolution beyond the computational level at the level of algorithms and implementations (<xref ref-type="bibr" rid="bib68">Marr, 1982</xref>).</p></sec><sec id="s3-4"><title>Functional tradeoffs limit behavioral diversity</title><p>The low duty cycle bias present in the recognition mechanism of <italic>G. bimaculatus</italic> has several implications for the evolution of song preference in crickets and elsewhere: perceptual biases that have evolved in contexts like food or predator detection are known to shape sexual selection (<xref ref-type="bibr" rid="bib45">Guilford and Dawkins, 1993</xref>; <xref ref-type="bibr" rid="bib99">Ter Hofstede et al., 2015</xref>; <xref ref-type="bibr" rid="bib79">Phelps and Ryan, 1998</xref>; <xref ref-type="bibr" rid="bib90">Ryan and Cummings, 2013</xref>). In the case of song recognition in crickets, suppression (adaptation, inhibition, onset accentuation, <xref ref-type="fig" rid="fig5">Figure 5G</xref>) reduces neuronal responses to long-lasting tones and likely evolved to save metabolic energy (<xref ref-type="bibr" rid="bib74">Niven, 2016</xref>) or to make song recognition more robust to changes in overall song intensity (<xref ref-type="bibr" rid="bib12">Benda and Hennig, 2008</xref>; <xref ref-type="bibr" rid="bib55">Hildebrandt et al., 2011</xref>; <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>). As a side effect, adaptation now biases the song recognition mechanism towards preferring pulse trains with low duty cycles (<xref ref-type="fig" rid="fig5">Figure 5H and I</xref>), which is consistent with the apparent absence of pause tuning in crickets (<xref ref-type="bibr" rid="bib53">Hennig et al., 2014</xref>). Interestingly, pause tuning is known from katydids (<xref ref-type="bibr" rid="bib96">Schul, 1998</xref>), suggesting that their song recognition system is not subject to the low duty cycle bias. Katydids may have avoided the low bias either by using a delay line and coincidence detection network like that found in <italic>G. bimaculatus</italic> but with weaker suppression (<xref ref-type="fig" rid="fig5">Figure 5G–I</xref>) or by using a different network design that is subject to different constraints (<xref ref-type="bibr" rid="bib19">Bush and Schul, 2005</xref>). Thus, computations that increase energy efficiency and robustness can constrain the phenotypic diversity of a whole species group.</p></sec><sec id="s3-5"><title>From evolutionary pattern to process</title><p>How can a diversity of neural networks evolve to drive the diversification of species-specific communication signals? Our modeling study of the song recognition network in the cricket brain provides first evidence that the underlying neuronal network is computationally flexible: by adapting physiological parameters, the network can produce all preference types described in crickets (<xref ref-type="fig" rid="fig4">Figure 4B–E</xref>). The computational flexibility of the recognition mechanism may explain the species richness as well as the speed of evolution in a particular taxon like crickets (<xref ref-type="bibr" rid="bib2">Alexander, 1962</xref>; <xref ref-type="bibr" rid="bib14">Blankers et al., 2015</xref>; <xref ref-type="bibr" rid="bib31">Desutter-Grandcolas and Robillard, 2003</xref>; <xref ref-type="bibr" rid="bib76">Oh and Shaw, 2013</xref>; <xref ref-type="bibr" rid="bib77">Otte, 1992</xref>): female preferences drift around with little constraint in signal space, maybe pushed by abiotic (environmental noise selects against preferences for very short pauses) and biotic factors (avoid overlap with heterospecifics, <xref ref-type="bibr" rid="bib3">Amezquita et al., 2011</xref>). The male song evolution follows changes in the female’s preference since only males that sing attractive song will reproduce. In this scenario, a female network that has the capacity to produce many different preference types supports the divergence of the communication system. However, this co-evolution of song preference and song structure requires male song production networks to be as flexible as the female song recognition networks (<xref ref-type="bibr" rid="bib58">Jacob and Hedwig, 2020</xref>; <xref ref-type="bibr" rid="bib95">Schöneich, 2020</xref>). There is also accumulating evidence for genetic coupling between the networks that produce and recognize the song pattern, which may ensure that sender and receiver stay tuned during evolution of song pattern (<xref ref-type="bibr" rid="bib105">Xu and Shaw, 2019</xref>; <xref ref-type="bibr" rid="bib95">Schöneich, 2020</xref>; <xref ref-type="bibr" rid="bib106">Xu and Shaw, 2021</xref>).</p><p>Computational flexibility also needs evolvability – the ability to generate specific and robust phenotypes during evolution (<xref ref-type="bibr" rid="bib14">Blankers et al., 2015</xref>). The ‘mechanistic degeneracy’ of computation in biological neural networks – the fact that specific network outputs can be obtained by tuning disparate parameters – is thought to be a prerequisite for evolvability (<xref ref-type="bibr" rid="bib102">Wagner, 2011</xref>, see also <xref ref-type="bibr" rid="bib47">Hasson et al., 2020</xref>; <xref ref-type="bibr" rid="bib64">Leonardo, 2005</xref>; <xref ref-type="bibr" rid="bib92">Schneider et al., 2021</xref>). The degeneracy concept has been demonstrated extensively for motor networks (<xref ref-type="bibr" rid="bib46">Gutierrez et al., 2013</xref>; <xref ref-type="bibr" rid="bib83">Prinz et al., 2004</xref>), and here we also found evidence of degeneracy in the cricket song recognition network. For instance, the preferred pulse period (<xref ref-type="fig" rid="fig5">Figure 5A and B</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>) or the pulse duty cycle (<xref ref-type="fig" rid="fig5">Figure 5G–I</xref>) can be set by multiple parameters. The hypothesis that high-dimensional and degenerate biological parameter spaces are more evolvable could be tested by assessing the computational flexibility of a minimal model of the network that produces the observed behavior with as few parameters as possible.</p><p>If a neural network is flexible, how can it maintain a robust phenotype within a species? We find that many parameters have only weak impacts on the network’s preference, leading to a relatively large fitness-neutral parameter set and a robust phenotype (<xref ref-type="bibr" rid="bib83">Prinz et al., 2004</xref>). For instance, we observed that the rebound amplitude in LN5 tends to be variable across electrophysiological recordings in different individuals but that the network model’s output is relatively robust to these changes (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="fig" rid="fig2s4">Figure 2—figure supplement 4</xref>). Other parameters crucially affect the recognition phenotype and support evolvability. These fitness-critical parameters likely drive changes in the recognition phenotype during speciation events to ensure species discrimination (<xref ref-type="bibr" rid="bib3">Amezquita et al., 2011</xref>; <xref ref-type="bibr" rid="bib91">Schmidt et al., 2011</xref>). Future studies will employ novel computational methods for characterizing the high-dimensional parameter space (<xref ref-type="bibr" rid="bib13">Bittner et al., 2021</xref>; <xref ref-type="bibr" rid="bib41">Gonçalves et al., 2020</xref>) to more comprehensively characterize the fitness-neutral parameter set leading to interindividual variability and to provide insight into the robustness and evolvability of pattern recognition networks.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Electrophysiological data</title><p>The data used for fitting the model come from intracellular recordings with sharp microelectrodes of AN1, LN2, LN3, LN4, and LN5 and are published in <xref ref-type="bibr" rid="bib61">Kostarakos and Hedwig, 2012</xref> and <xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>. They include (1) 12 stimuli with a pulse duty cycle of ~0.5 and periods ranging from 10 to 98 ms (<xref ref-type="fig" rid="fig2">Figure 2B</xref>), (2) 10 stimuli with a pulse period of 40 ms and duty cycles ranging between 0.1 and 1.0 (<xref ref-type="fig" rid="fig2">Figure 2C</xref>), and (3) 12 stimuli with a pulse duration of 20 ms and pauses varying between 6 and 90 ms (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). During the electrophysiological experiments, each pulse train was presented interleaved by a chirp pause of 230 ms.</p></sec><sec id="s4-2"><title>Quantification of tuning in the recordings and the model responses</title><p>In the recordings, spikes were detected using custom routines that found peaks in the voltage traces robust to changes in baseline. The accuracy of spike detection was checked by visual inspection of the voltage traces. From the spike times, average firing rates were calculated by dividing the number of spikes produced during each chirp (pulse train and chirp pause) by the chirp period (<xref ref-type="fig" rid="fig2">Figure 2B–D</xref>). For the non-spiking LN5, the response corresponds to the voltage of the rebound response. Voltage rates were obtained by first calculating a baseline voltage as the average voltage in the 25 ms preceding a given pulse train, and then integrating the supra-threshold components of the voltage. This integral voltage was then divided by the chirp period to get a rate. Note that the tuning curves for LN5 are not very accurate because the rebound responses have a low amplitude and the baseline voltage fluctuated considerably during recordings of LN5.</p><p>For the model, tuning curves and responses fields were calculated as for the recordings – by integrating the firing rate outputs of the spiking neurons in the model or the rebound voltage for the non-spiking LN5 and dividing the resulting values by the chirp period.</p></sec><sec id="s4-3"><title>Model inputs and simulation</title><p>We built a rate-based, phenomenological model of the song recognition network in <italic>G. bimaculatus</italic>. Sound inputs were presented as the time-varying amplitude of pulse trains with the specified pulse and chirp structure. Model responses were simulated with a temporal resolution of 1 kHz and tested as if pulse trains and chirp pauses were repeated endlessly.</p></sec><sec id="s4-4"><title>Elementary computations</title><p>The model was built from four elementary neural computations. In the following, we will first define the elementary computations and then describe how they were combined to model each neuron in the network. Neurons in the model are referred to with a subscript <italic>M</italic>.</p><sec id="s4-4-1"><title>Filtering</title><p>Filtering was implemented via <inline-formula><mml:math id="inf30"><mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo largeop="true" symmetric="true">∫</mml:mo><mml:mi>τ</mml:mi></mml:msub><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>τ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="inf31"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>y</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the stimulus and response at time <inline-formula><mml:math id="inf33"><mml:mi>t</mml:mi></mml:math></inline-formula>, respectively, and <inline-formula><mml:math id="inf34"><mml:mi>τ</mml:mi></mml:math></inline-formula> is a temporal delay. The causal filter <inline-formula><mml:math id="inf35"><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was constructed from discrete Gaussian and exponential kernels. A discrete Gaussian kernel was defined as <inline-formula><mml:math id="inf36"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>⁢</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with support <inline-formula><mml:math id="inf37"><mml:mi>N</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf38"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and width <inline-formula><mml:math id="inf39"><mml:mi>α</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Exponential kernels were defined as <inline-formula><mml:math id="inf41"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>/</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, with support <inline-formula><mml:math id="inf42"><mml:mi>N</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="inf43"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>τ</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, and decay <inline-formula><mml:math id="inf44"><mml:mi>γ</mml:mi></mml:math></inline-formula>. Note that throughout the article we use ‘filter duration’ as a non-technical synonym for ‘support,’ which specifies the time over which the filter is defined. Gaussian (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) and exponential filters are low-pass or integrating filters, which smooth the stimulus (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). The filters were not normalized. Bandpass filters were implemented as biphasic filters by either differentiating a Gaussian filter <inline-formula><mml:math id="inf45"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>τ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>τ</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A</xref>) or by subtracting two Gaussian and/or exponential filters to form the positive (excitatory) and negative (inhibitory) filter lobes. Parameterizing biphasic filters as combinations of Gaussians and/or exponentials provides greater and more direct control over the timing and the gain of the filters’ excitatory and inhibitory lobes. Differentiating filters respond most strongly to changes in the stimulus, for instance, to the onsets or offsets of pulses (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>). The support parameter was initialized to be sufficiently long and was typically fixed during model fitting (<xref ref-type="table" rid="table1">Table 1</xref>).</p></sec><sec id="s4-4-2"><title>Nonlinear transfer functions</title><p>Nonlinear transfer functions (nonlinearities) transform inputs to implement thresholding or saturation. The model employs two types of nonlinearities: a rectifying nonlinearity thresholds the input <inline-formula><mml:math id="inf46"><mml:mi>x</mml:mi></mml:math></inline-formula> at the threshold value <italic>x</italic><sub>0</sub> and scales it with a gain <inline-formula><mml:math id="inf47"><mml:mi>β</mml:mi></mml:math></inline-formula>:<disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" displaystyle="false" rowspacing=".2em"><mml:mtr><mml:mtd><mml:mi>x</mml:mi><mml:mo>⋅</mml:mo><mml:mi>β</mml:mi></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:msub><mml:mo>&gt;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>(<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>). In many cases, the threshold parameter was used to constrain signals to be purely positive or negative, and it was therefore often fixed to 0. A sigmoidal nonlinearity combines a soft threshold with saturation: <inline-formula><mml:math id="inf48"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> with gain <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, shift <inline-formula><mml:math id="inf50"><mml:mi>b</mml:mi></mml:math></inline-formula>, and minimal and maximal output <italic>y</italic><sub>0</sub> and <inline-formula><mml:math id="inf51"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1E</xref>).</p></sec><sec id="s4-4-3"><title>Linear transmission with delay</title><p>Neuronal connections transmit neural activity linearly with delay <inline-formula><mml:math id="inf52"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> and gain <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Multiple inputs to a neuron are added. The gain <inline-formula><mml:math id="inf54"><mml:mi>α</mml:mi></mml:math></inline-formula> is negative for inhibitory and positive for excitatory synapses and controls the input strength. The delay parameter <inline-formula><mml:math id="inf55"><mml:mi mathvariant="normal">Δ</mml:mi></mml:math></inline-formula> corresponds to the delay that needs to be added to the input of a neuron to reproduce the timing of the output of that neuron. It includes axonal conduction or synaptic transmission delays but also other delay mechanisms, like low-pass filtering of the membrane voltage at the pre- and postsynapse (<xref ref-type="bibr" rid="bib28">Creutzig et al., 2010</xref>; <xref ref-type="bibr" rid="bib107">Zhou et al., 2019</xref>) or latencies arising from integration of inputs to the spiking threshold or from spike generation.</p></sec><sec id="s4-4-4"><title>Adaptation</title><p>Adaptation in AN1<sub>M</sub> and LN2<sub>M</sub> is implemented using differentiating filters (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1A and B</xref>). Such filters produce adaptation via their broad inhibitory lobe, which suppresses subsequent responses (<xref ref-type="bibr" rid="bib71">Nagel and Wilson, 2011</xref>). For AN1<sub>M</sub> and LN3<sub>M</sub>, adaptation effects were better captured using divisive normalization (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1F</xref>). The input to the adaptation stage, <inline-formula><mml:math id="inf56"><mml:mi>x</mml:mi></mml:math></inline-formula>, is low-pass filtered using an exponential filter to generate an adaptation signal <inline-formula><mml:math id="inf57"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> that divides the input: <inline-formula><mml:math id="inf58"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <italic>x</italic><sub>0</sub> and <inline-formula><mml:math id="inf59"><mml:mi>w</mml:mi></mml:math></inline-formula> control the strength of adaptation while the width of the exponential filter, <inline-formula><mml:math id="inf60"><mml:mi>γ</mml:mi></mml:math></inline-formula>, controls the timescale of adaptation. Both implementations of adaptation – differentiating filters and divisive normalization – can produce similar adaptation time courses. However, since adaptation with differentiating filters acts subtractively, the negative response components accumulate over time to a negative filter output (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1F</xref>). For modeling adaptation on longer timescales, this can completely suppress responses to subsequent stimuli. This complete suppression does not occur with divisive normalization since it only scales the response.</p></sec></sec><sec id="s4-5"><title>Model neurons</title><p>The elementary computations described above were combined to reproduce the response of each neuron in the network – the firing rate patterns in the case of spiking neurons and the pattern of the rebound responses in the non-spiking LN5<sub>M</sub> (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). All filters and nonlinearities are plotted in <xref ref-type="fig" rid="fig2">Figure 2A</xref>, and all parameter names and values are listed in <xref ref-type="table" rid="table1">Table 1</xref> and graphically defined in <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref> and <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>. The model was implemented in MATLAB. Code for running the model is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/janclemenslab/cricketnet">https://github.com/janclemenslab/cricketnet</ext-link>, (<xref ref-type="bibr" rid="bib24">Clemens, 2021</xref> copy archived at <ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:173e5e769d56911b1fccb39b57a691f7bd2e8b84;origin=https://github.com/janclemenslab/cricketnet;visit=swh:1:snp:056d12073c91e50304ca5bcd9fcb3ec4410bde07;anchor=swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352">swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352</ext-link>).</p><sec id="s4-5-1"><title>AN1<sub>M</sub> (relay)</title><p>AN1 is the input neuron of the network. It faithfully copies the pulse structure and adapts weakly (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). These response properties were reproduced using a differentiating linear filter (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>): the filter’s narrow and strong excitatory lobe captures the fast and faithful stimulus responses, while the broad inhibitory lobe captures the delayed suppressive effect of past stimulus epochs. AN1<sub>M</sub>’s filter was generated by concatenating two Gaussians as the excitatory and inhibitory lobes. AN1<sub>M</sub> has a sigmoidal nonlinearity that saturates responses to longer pulses. To capture the decrease of the response across pulses, we additionally included a divisive normalization stage.</p></sec><sec id="s4-5-2"><title>LN2<sub>M</sub> (inhibition)</title><p>LN2 responds reliably to individual pulses similar to AN1, but exhibits stronger adaptation during the pulse. This was reproduced using a differentiating filter, composed of a truncating Gaussian function as the excitatory lobe and an exponential function as the inhibitory lobe. A rectifying nonlinearity restricts outputs to be positive.</p></sec><sec id="s4-5-3"><title>LN5<sub>M</sub> (post-inhibitory rebound)</title><p>LN5 is a non-spiking neuron. It receives inhibitory input coupled to the spike activity of LN2 and generates a rebound depolarization when the inhibition terminates (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). The inhibitory input from LN2 over a pulse saturates in LN5, which is modeled using a differentiating input filter followed by a rectifying nonlinearity that restricts the inputs to be negative. The rebound is then produced using a differentiating filter with a narrow excitatory lobe, which further low-pass filters the inhibitory input, and a broad inhibitory lobe, which generates the broad positive voltage deflections at the offset of negative voltage deviations. See <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1C</xref> for an illustration of the principle by which the rebound is produced in the model. The filter was generated by concatenating two exponential filters as negative and excitatory lobes.</p></sec><sec id="s4-5-4"><title>LN3 (coincidence detection)</title><p>LN3 responds strongly when two excitatory synaptic inputs arrive at the same time: a short-latency input from AN1 and a delayed input from LN5. In the neurophysiological data, the input from AN1 alone is often sufficient to drive spiking (e.g., to the first pulse of a train), suggesting that LN3 does not require two coincident inputs to spike. We therefore define LN3<sub>M</sub> as a linear adder (with a threshold) that receives stronger input from AN1<sub>M</sub> than from LN5<sub>M</sub>. From the LN5<sub>M</sub> responses, only the positive components corresponding to the rebound were passed on as the input to LN3<sub>M</sub>, which was separated from the negative components of the LN5<sub>M</sub> responses using a rectifying nonlinearity (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1D</xref>). The sum of the two inputs is thresholded using a rectifying nonlinearity before being passed into an adaptation stage with divisive normalization. The adaptation after summation reduces LN3<sub>M</sub> firing over a pulse train, and a final rectifying nonlinearity ensures positive firing rates, by cutting of all negative responses that can occur in the model, for instance, due to filtering (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1B</xref>).</p></sec><sec id="s4-5-5"><title>LN4 (feature detection)</title><p>Finally, LN4<sub>M</sub> adds excitatory input from LN3<sub>M</sub> and inhibitory input from LN2<sub>M</sub>, which sharpens its selectivity for pulse patterns as compared to LN3<sub>M</sub>. A rectifying nonlinearity restricts the output firing rate to be positive.</p></sec></sec><sec id="s4-6"><title>Prediction of phonotactic behavior from network responses</title><p>For regular pulse trains, the firing rate of LN4 (number of spikes per chirp/chirp duration) predicts phonotactic behavior very well (<xref ref-type="bibr" rid="bib94">Schöneich et al., 2015</xref>; <xref ref-type="fig" rid="fig1">Figure 1E</xref>). We therefore used the firing rate of LN4<sub>M</sub> to predict behavioral responses from network output.</p></sec><sec id="s4-7"><title>Model fitting</title><p>Model parameters were optimized in two phases. First, the model parameters and structure were initialized by hand. This initialization established which computational steps were necessary to reproduce the key response features of the neurons in the network – their response dynamics and tuning – and determined initial parameter values. In the second phase, we used a genetic algorithm to tune the network parameters to optimally fit the data; see <xref ref-type="bibr" rid="bib23">Clemens et al., 2014</xref>. To simplify fitting, we exploited the feed-forward topology of the network: instead of fitting all parameters simultaneously, we adopted a stepwise procedure, in which the model neurons were fitted in order of their position in the network. We started with fitting the parameters of the first neuron in the network, AN1<sub>M</sub>, and reproducing the firing rate traces of AN1<sub>M</sub>. In a seconds step, we held the parameters of AN1<sub>M</sub> constant and fitted parameters of LN2<sub>M</sub>. We then held the parameters of AN1<sub>M</sub> and LN2<sub>M</sub> constant and fitted the temporal dynamics of the rebound response in LN5<sub>M</sub> but not the inhibitory component, since the precise magnitude and dynamics of inhibitory components were highly variable across recordings and since the rebound constitutes the effective output of LN5. We then fitted the parameters of LN3<sub>M</sub> and finally of LN4<sub>M</sub>, again holding those of the upstream neurons constant. For these last two neurons, firing was very sparse and irregularly timed across trials, which complicated fitting. We therefore used information from the firing rate dynamics and from the tuning curves for optimizing the parameters of LN3<sub>M</sub> and LN4<sub>M</sub> by using mixed error functions: <inline-formula><mml:math id="inf61"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="inf62"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the mean square error between the predicted and actual traces, <inline-formula><mml:math id="inf63"><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>u</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the mean absolute error between the predicted and the actual tuning curves, and <inline-formula><mml:math id="inf64"><mml:mi>w</mml:mi></mml:math></inline-formula> was set to 0.1 for LN3<sub>M</sub> and to 1.0 for the even sparser activity of LN4<sub>M</sub>. For the other neurons in the network (LN2<sub>M</sub>, LN3<sub>M</sub>, LN5<sub>M</sub>), only E was used (equivalent to w = 0).<disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p><p>The initial parameters for fitting at each step were drawn from an exponential distribution ranging between 0.1 and 10 around the hand-fitted parameters. The exponential distribution was chosen to have an even number of parameters above and below the hand-fitted values, that is, a uniform distribution after log scaling. While the fitting algorithm is stochastic by nature, it repeatedly found similar optimal parameter sets on independent initializations (not shown).</p><p>The model had a total of 55 parameters. Of these, nine parameters (marked by ‘*’ in <xref ref-type="table" rid="table1">Table 1</xref>) were fixed to the initialized values during fitting to facilitate convergence. For instance, the gain of the input to a neuron is equally set by the output gain of the presynaptic neuron’s nonlinearity, <inline-formula><mml:math id="inf65"><mml:mi>β</mml:mi></mml:math></inline-formula>, or by the synaptic input gain <inline-formula><mml:math id="inf66"><mml:mi>α</mml:mi></mml:math></inline-formula>, and therefore only one of these parameters needs to be optimized. Or the support parameter of an exponential filter sets an upper bound for the timescale of that filter, which in turn is given by the filter’s time constant. In that case, the support was typically set to a sufficiently high value and fixed. Lastly, some of the thresholds were fixed to zero since their sole role was to restrict firing rates to be positive.</p></sec><sec id="s4-8"><title>Evaluation of model performance</title><p>After the fitting procedure, the model performance was evaluated based on the tuning curves and the response traces. The fit for the tuning curves is given by <inline-formula><mml:math id="inf67"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="fig2">Figure 2H</xref>), where <inline-formula><mml:math id="inf68"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi><mml:mo>⁢</mml:mo><mml:mi>S</mml:mi><mml:mo>⁢</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the root-mean-squared error and <italic>a</italic><sub><italic>n</italic></sub> and <italic>b</italic><sub><italic>n</italic></sub> are the tuning curves from the experimental data and the model, each normalized by the maximum of the tuning curve from the data: <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>/</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. This measure of fit is sensitive to the addition of a constant offset and to a mismatch in the scale of responses between the model and the data, but is independent of the overall scale of the responses in the data. The fit for the response traces is given by the squared Pearson correlation coefficient:<disp-formula id="equ3"><mml:math id="m3"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>⁢</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></disp-formula></p><p>where <italic>x</italic> and <italic>y</italic> are the response traces from the model and the data, respectively, and μ and <inline-formula><mml:math id="inf71"><mml:mi>σ</mml:mi></mml:math></inline-formula> are the mean and the standard deviation. The <inline-formula><mml:math id="inf72"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> was calculated for different timescales (<xref ref-type="fig" rid="fig2">Figure 2G</xref>) by low-pass filtering both the prediction and the response with rectangular windows with durations ranging between 1 and 25 ms before computing the <inline-formula><mml:math id="inf73"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. At short timescales, this measure is sensitive to fine details in the firing rate dynamics, while at longer timescales, the measure reflects the match in coarse features of the firing dynamics, for example, the spike counts per pulse.</p></sec><sec id="s4-9"><title>Generation of model variants for the analysis of the parameter space</title><p>To determine the range of preference types the network can produce (<xref ref-type="fig" rid="fig4">Figure 4A–E</xref>), we generated models with random parameter sets taken from a range around that obtained from the fit to <italic>G. bimaculatus</italic>. For that, we chose 45 of the 55 model parameters. The 10 parameters fixed for this analysis (marked by ‘†<sup>’</sup> in <xref ref-type="table" rid="table1">Table 1</xref>) had also been fixed for fitting (see above), but we allowed more of the parameters of AN1’s filter and output nonlinearity to change. All 45 parameters except the synaptic delay parameters were taken from a hypercube spanning the range between 1/10 and 10-fold around the original parameter set, spaced logarithmically such that the fraction of random parameter values below and above the original value was similar. Delay parameters in the model (see <xref ref-type="table" rid="table1">Table 1</xref>) were allowed to range uniformly between 1 and 21 ms, irrespective of the original parameter value. The delay parameters correspond to the delay added to the inputs to a neuron required to produce the desired timing of the output of that neuron and include axonal conduction and synaptic transmission delays, delays induced by low-pass filtering at the pre- and postsynapse, and delays from the integration of inputs to the spiking threshold and from spike generation. To ensure uniform sampling from the 45-dimensional parameter space, we used a quasi-random sampling scheme based on the Sobol set. We used the sobolset function in MATLAB with the following parameters: skip 1e3, leap 1e2, scramble <monospace>MatousekAffineOwen</monospace>. Using this approach, we generated 5 million different model variants. Of these, 9% (450,000 models) were responsive and selective, that is, they responded to at least one pulse train pattern and did not produce the same response for all patterns tested. Initial tests with extended parameter ranges yielded qualitatively similar phenotypic variability but produced many more unresponsive or unselective models.</p></sec><sec id="s4-10"><title>Sensitivity analysis</title><p>For the sensitivity analysis (<xref ref-type="fig" rid="fig4">Figure 4F–H</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), we changed either single parameters or systematically varied pairs of parameters on a grid. We used the same set of 45 parameters as in the analysis of the parameter space above (see <xref ref-type="table" rid="table1">Table 1</xref>). Single-parameter sweeps were generated as 21 logarithmically spaced values between 1/100 and 100-fold around the original value, except for delay parameters, which were generated as 21 values ranging between 1 and 41 ms. While these parameter ranges may appear rather large, in particular for the input delay parameters, they are chosen to facilitate the detection of key parameters controlling the network’s tuning. Their specific and meaningful effects on the model tuning were confirmed and further analyzed within the more restricted parameter range also chosen for the analysis of the network’s phenotypic flexibility above.</p><p>For each model, we calculated the response fields for pulse durations and pauses between 1 and 80 ms (2 ms spacing, 1600 stimuli per response field), with a pulse train duration of 600 ms and a chirp pause of 200 ms. To quantify the model’s sensitivity to changes in each parameter, we first calculated the correlation distance (1 – Pearson’s correlation coefficient) between the response fields from the original model and each modified model in the parameter sweep (<xref ref-type="fig" rid="fig4">Figure 4F</xref>). By using the correlation coefficient, our sensitivity analysis is robust to trivial changes in the response field like scaling or the addition of a constant to all responses. The average correlation distance over a parameter sweep is then taken as a measure of how much changing a parameter affects the model output.</p><p>For some parameters, models produced constant output (e.g., all zeros) over most of the parameter sweep with only one or two step-like changes in the response fields, leading to artificially high sensitivity values. We found that we could reliably exclude such parameters by calculating the median difference in the correlation distance between consecutive parameter values over the parameter sweep and requiring this quantity to be larger than 0.005:<disp-formula id="equ4"><mml:math id="m4"><mml:mrow><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf74"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">…</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula> is the absolute value, and <inline-formula><mml:math id="inf75"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the correlation distance (1 – Pearson’s correlation coefficient) between the response field from the original model, <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and from a model with the modified parameter, <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>R</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. This approach also excluded parameters whose change produced largely untuned models over the sweep. We ensured that none of our results crucially depended on these criteria. For instance, even without the above constraint, the parameters of LN5<sub>M</sub> and LN3<sub>M</sub> were still among the top ranked.</p><p>For the sensitivity analysis over parameter pairs (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>), value grids were generated using the same value ranges as for single parameters for each parameter in the pair, resulting in 21 × 21 = 441 model variants for each of the 1035 unique, unordered parameter pairs.</p></sec><sec id="s4-11"><title>Characterization of response fields</title><p>The response fields known in crickets typically have a roughly ellipsoid shape with a single peak. To assess the extent by which the response fields produced by randomizing the model parameters match these properties, we determined the fraction of fields with a single dominant peak (vs. multiple dominant peaks) and the match of the response fields with a best-fitting ellipse. Dominant peaks were defined as local maxima in the response field exceeding 0.5 of the global maximum value and separated by a trough that is smaller than 0.75 of the value of the lower of the two peaks. This measure is robust to the existence of either small or poorly separated local maxima. Ellipses were fitted to the binarized fields to be robust to the steps in the response fields by the stimulus structure (<xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Binarization was performed by thresholding each response field at 50% of its maximum value. We then fitted a two-dimensional Gaussian to the superthreshold coordinate values using MATLAB’s <monospace>fitgmdist</monospace> and created a best-fitted prediction by setting all pixels inside the 99.9% probability threshold to 1.0. Results are robust to the specific choice of this value. The match between the binarized response field and the binarized ellipsoid was estimated via the Jaccard similarity, <italic>S</italic><sub><italic>J</italic></sub> , between the two binary images. The Jaccard similarity corresponds to the fraction of non-zero pixels that differ between the binarized response fields and the binarized ellipsoid or the intersection over union: <italic>S</italic><sub><italic>J</italic></sub> = |<italic>P</italic> ∩ <italic>T</italic> |/|<italic>P</italic> ∪ <italic>T</italic> |, where | … | denotes the set size and ∩ and ∪ correspond to intersection and union, respectively. Using alternative error measures, like the Hamming distance, produced similar results.</p><p>Deviations from a perfect ellipsoid, like more rectangular shapes or asymmetrical shapes, can reduce the match (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Manual inspection of response fields revealed that most models with a Jaccard similarity <italic>S</italic><sub><italic>J</italic></sub> &gt;0.5 were well described by an ellipse, and we therefore chose this <italic>S</italic><sub><italic>J</italic></sub> as a threshold for considering a response field well fitted by an ellipsoid. For the asymmetry index, we extracted the length of the major and minor axis of the best-fitted ellipse as the eigenvalues of the covariance matrix and took their ratio.</p></sec><sec id="s4-12"><title>Identification of preference types</title><p>Response fields were assigned to one of the four principal types in <xref ref-type="fig" rid="fig1">Figure 1B</xref> based on two inclusion criteria: first, the angle of the main axis had to fall within ± 10° of that of the prototypical angle (–45° for period, 0° for duration, 45° for duty cycle, 90° for pause). Second, the response field had to be sufficiently selective for the designated stimulus parameter and tolerant for the orthogonal stimulus parameter. For instance, a response field was determined to be pause tuned if the angle was ~90 ± 10°, and if it was selective for pause and tolerant for duration. We ensured the validity of these criteria through visual inspection of many response fields (see examples in <xref ref-type="fig" rid="fig4">Figure 4E</xref>). The orientation angle was calculated by fitting a line to the ‘‘ridge of the response field’’ (the set of pause and duration values that elicited maximal responses). We first identified well-responded stimuli as those with response values exceeding 50% of the maximal response value for that field. To make the fits more robust, we determined whether the set of well-responded stimuli extended more along the pause or the duration axis and selected pause and duration values for the fit as follows: if the response field was most extended along the pause axis, then we identified the preferred duration at each pause value for which the response field was above the 50% threshold. For a response field that extended more along the duration axis, we identified the preferred pause at each duration value exceeding the 50% threshold. We then fitted a line to the resulting set of duration and pause values and took the inverse tangent of that line’s slope as the orientation angle.</p></sec></sec></body><back><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Writing - original draft</p></fn><fn fn-type="con" id="con2"><p>Data curation, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Data curation, Writing – review and editing</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Supervision, Writing – review and editing</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Writing – review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-61475-transrepform1-v2.docx"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The data used for fitting the model can be found at <ext-link ext-link-type="uri" xlink:href="https://data.goettingen-research-online.de/dataverse/cricketnet">https://data.goettingen-research-online.de/dataverse/cricketnet</ext-link>. Code for running the model can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/janclemenslab/cricketnet">https://github.com/janclemenslab/cricketnet</ext-link>.</p></sec><ack id="ack"><title>Acknowledgements</title><p>We thank Biswa Sengupta for discussions during an early phase of the project.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ai</surname><given-names>H</given-names></name><name><surname>Kumaraswamy</surname><given-names>A</given-names></name><name><surname>Kohashi</surname><given-names>T</given-names></name><name><surname>Ikeno</surname><given-names>H</given-names></name><name><surname>Wachtler</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Inhibitory Pathways for Processing the Temporal Structure of Sensory Signals in the Insect Brain</article-title><source>Frontiers in Psychology</source><volume>9</volume><elocation-id>1517</elocation-id><pub-id pub-id-type="doi">10.3389/fpsyg.2018.01517</pub-id><pub-id pub-id-type="pmid">30186204</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>RD</given-names></name></person-group><year iso-8601-date="1962">1962</year><article-title>Evolutionary change in cricket acoustical communication</article-title><source>Evolution</source><volume>16</volume><fpage>443</fpage><lpage>467</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1962.tb03236.x</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amezquita</surname><given-names>A</given-names></name><name><surname>Flechas</surname><given-names>SV</given-names></name><name><surname>Lima</surname><given-names>AP</given-names></name><name><surname>Gasser</surname><given-names>H</given-names></name><name><surname>Hodl</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Acoustic interference and recognition space within a complex assemblage of dendrobatid frogs</article-title><source>PNAS</source><volume>108</volume><fpage>17058</fpage><lpage>17063</lpage><pub-id pub-id-type="doi">10.1073/pnas.1104773108</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Araki</surname><given-names>M</given-names></name><name><surname>Bandi</surname><given-names>MM</given-names></name><name><surname>Yazaki-Sugiyama</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mind the gap: Neural coding of species identity in birdsong prosody</article-title><source>Science</source><volume>354</volume><fpage>1282</fpage><lpage>1287</lpage><pub-id pub-id-type="doi">10.1126/science.aah6799</pub-id><pub-id pub-id-type="pmid">27940872</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aubie</surname><given-names>B</given-names></name><name><surname>Sayegh</surname><given-names>R</given-names></name><name><surname>Faure</surname><given-names>PA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Duration Tuning across Vertebrates</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>6373</fpage><lpage>6390</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5624-11.2012</pub-id><pub-id pub-id-type="pmid">22553042</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Azevedo</surname><given-names>AW</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Active Mechanisms of Vibration Encoding and Frequency Filtering in Central Mechanosensory Neurons</article-title><source>Neuron</source><volume>96</volume><fpage>446</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.09.004</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bailey</surname><given-names>NW</given-names></name><name><surname>Moran</surname><given-names>PA</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Divergent mechanisms of acoustic mate recognition between closely related field cricket species (Teleogryllus spp.)</article-title><source>Animal Behaviour</source><volume>130</volume><fpage>17</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/j.anbehav.2017.06.007</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>CA</given-names></name><name><surname>Carlson</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Short-term depression, temporal summation, and onset inhibition shape interval tuning in midbrain neurons</article-title><source>The Journal of Neuroscience</source><volume>34</volume><fpage>14272</fpage><lpage>14287</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2299-14.2014</pub-id><pub-id pub-id-type="pmid">25339741</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>CA</given-names></name><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Murthy</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Acoustic pattern recognition and courtship songs: Insights from insects</article-title><source>Annual Review of Neuroscience</source><volume>42</volume><fpage>129</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-080317-061839</pub-id><pub-id pub-id-type="pmid">30786225</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bargmann</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Beyond the connectome: How neuromodulators shape neural circuits</article-title><source>BioEssays</source><volume>34</volume><fpage>458</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1002/bies.201100185</pub-id><pub-id pub-id-type="pmid">22396302</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benda</surname><given-names>J</given-names></name><name><surname>Herz</surname><given-names>AVM</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>A universal model for spike-frequency adaptation</article-title><source>Neural Computation</source><volume>15</volume><fpage>2523</fpage><lpage>2564</lpage><pub-id pub-id-type="doi">10.1162/089976603322385063</pub-id><pub-id pub-id-type="pmid">14577853</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benda</surname><given-names>J</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Spike-frequency adaptation generates intensity invariance in a primary auditory interneuron</article-title><source>Journal of Computational Neuroscience</source><volume>24</volume><fpage>113</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1007/s10827-007-0044-8</pub-id><pub-id pub-id-type="pmid">17534706</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bittner</surname><given-names>SR</given-names></name><name><surname>Palmigiano</surname><given-names>A</given-names></name><name><surname>Piet</surname><given-names>AT</given-names></name><name><surname>Duan</surname><given-names>CA</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name><name><surname>Miller</surname><given-names>KD</given-names></name><name><surname>Cunningham</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Interrogating theoretical models of neural computation with emergent property inference</article-title><source>eLife</source><volume>10</volume><elocation-id>e56265</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56265</pub-id><pub-id pub-id-type="pmid">34323690</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankers</surname><given-names>T</given-names></name><name><surname>Lübke</surname><given-names>AK</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Phenotypic variation and covariation indicate high evolvability of acoustic communication in crickets</article-title><source>Journal of Evolutionary Biology</source><volume>28</volume><fpage>1656</fpage><lpage>1669</lpage><pub-id pub-id-type="doi">10.1111/jeb.12686</pub-id><pub-id pub-id-type="pmid">26134540</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blankers</surname><given-names>T</given-names></name><name><surname>Gray</surname><given-names>DA</given-names></name><name><surname>Matthias Hennig</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multivariate Phenotypic Evolution: Divergent Acoustic Signals and Sexual Selection in Gryllus Field Crickets</article-title><source>Evolutionary Biology</source><volume>44</volume><fpage>43</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1007/s11692-016-9388-1</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Borst</surname><given-names>A</given-names></name><name><surname>Helmstaedter</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Common circuit design in fly and mammalian motion vision</article-title><source>Nature Neuroscience</source><volume>18</volume><fpage>1067</fpage><lpage>1076</lpage><pub-id pub-id-type="doi">10.1038/nn.4050</pub-id><pub-id pub-id-type="pmid">26120965</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bradbury</surname><given-names>JW</given-names></name><name><surname>Vehrencamp</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Principles of Animal Communication</source><publisher-name>Sinauer Associates Incorporated</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buonomano</surname><given-names>DV</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Decoding temporal information: A model based on short-term synaptic plasticity</article-title><source>The Journal of Neuroscience</source><volume>20</volume><fpage>1129</fpage><lpage>1141</lpage><pub-id pub-id-type="pmid">10648718</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bush</surname><given-names>SL</given-names></name><name><surname>Schul</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Pulse-Rate Recognition in an Insect: Evidence of a Role for Oscillatory Neurons</article-title><source>Journal of Comparative Physiology A</source><volume>192</volume><fpage>113</fpage><lpage>121</lpage><pub-id pub-id-type="doi">10.1007/s00359-005-0053-x</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carlson</surname><given-names>BA</given-names></name><name><surname>Gallant</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>From Sequence to Spike to Spark: Evo-devo-neuroethology of Electric Communication in Mormyrid Fishes</article-title><source>Journal of Neurogenetics</source><volume>27</volume><fpage>106</fpage><lpage>129</lpage><pub-id pub-id-type="doi">10.3109/01677063.2013.799670</pub-id><pub-id pub-id-type="pmid">23802152</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Computational principles underlying the recognition of acoustic signals in insects</article-title><source>Journal of Computational Neuroscience</source><volume>35</volume><fpage>75</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1007/s10827-013-0441-0</pub-id><pub-id pub-id-type="pmid">23417450</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Ronacher</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Feature extraction and integration underlying perceptual decision making during courtship behavior</article-title><source>The Journal of Neuroscience</source><volume>33</volume><fpage>12136</fpage><lpage>12145</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0724-13.2013</pub-id><pub-id pub-id-type="pmid">23864698</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Krämer</surname><given-names>S</given-names></name><name><surname>Ronacher</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Asymmetrical integration of sensory information during mating decisions in grasshoppers</article-title><source>PNAS</source><volume>111</volume><fpage>16562</fpage><lpage>16567</lpage><pub-id pub-id-type="doi">10.1073/pnas.1412741111</pub-id><pub-id pub-id-type="pmid">25368152</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Clemens</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>cricket net</data-title><version designator="swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352">swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352</version><publisher-name>Software Heritage</publisher-name><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:173e5e769d56911b1fccb39b57a691f7bd2e8b84;origin=https://github.com/janclemenslab/cricketnet;visit=swh:1:snp:056d12073c91e50304ca5bcd9fcb3ec4410bde07;anchor=swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352">https://archive.softwareheritage.org/swh:1:dir:173e5e769d56911b1fccb39b57a691f7bd2e8b84;origin=https://github.com/janclemenslab/cricketnet;visit=swh:1:snp:056d12073c91e50304ca5bcd9fcb3ec4410bde07;anchor=swh:1:rev:73ff788143c6afa3adbbb3e0f61f600a13052352</ext-link></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Coffey</surname><given-names>KR</given-names></name><name><surname>Marx</surname><given-names>RG</given-names></name><name><surname>Neumaier</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>DeepSqueak: a deep learning-based system for detection and analysis of ultrasonic vocalizations</article-title><source>Neuropsychopharmacology</source><volume>44</volume><fpage>859</fpage><lpage>868</lpage><pub-id pub-id-type="doi">10.1038/s41386-018-0303-6</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Comins</surname><given-names>JA</given-names></name><name><surname>Gentner</surname><given-names>TQ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Temporal pattern processing in songbirds</article-title><source>Current Opinion in Neurobiology</source><volume>28</volume><fpage>179</fpage><lpage>187</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2014.08.003</pub-id><pub-id pub-id-type="pmid">25201176</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cordoba-Rodriguez</surname><given-names>R</given-names></name><name><surname>Moore</surname><given-names>KA</given-names></name><name><surname>Kao</surname><given-names>JPY</given-names></name><name><surname>Weinreich</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Calcium regulation of a slow post-spike hyperpolarization in vagal afferent neurons</article-title><source>PNAS</source><volume>96</volume><fpage>7650</fpage><lpage>7657</lpage><pub-id pub-id-type="doi">10.1073/pnas.96.14.7650</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Creutzig</surname><given-names>F</given-names></name><name><surname>Benda</surname><given-names>J</given-names></name><name><surname>Wohlgemuth</surname><given-names>S</given-names></name><name><surname>Stumpner</surname><given-names>A</given-names></name><name><surname>Ronacher</surname><given-names>B</given-names></name><name><surname>Herz</surname><given-names>AVM</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Timescale-invariant pattern recognition by feedforward inhibition and parallel signal processing</article-title><source>Neural Computation</source><volume>22</volume><fpage>1493</fpage><lpage>1510</lpage><pub-id pub-id-type="doi">10.1162/neco.2010.05-09-1016</pub-id><pub-id pub-id-type="pmid">20141475</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cros</surname><given-names>E</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Auditory pattern recognition and steering in the cricket <italic>Teleogryllus oceanicus</italic></article-title><source>Physiological Entomology</source><volume>39</volume><fpage>19</fpage><lpage>27</lpage><pub-id pub-id-type="doi">10.1111/phen.12043</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DasGupta</surname><given-names>S</given-names></name><name><surname>Ferreira</surname><given-names>CH</given-names></name><name><surname>Miesenböck</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>FoxP influences the speed and accuracy of a perceptual decision in <italic>Drosophila</italic></article-title><source>Science</source><volume>344</volume><fpage>901</fpage><lpage>904</lpage><pub-id pub-id-type="doi">10.1126/science.1252114</pub-id><pub-id pub-id-type="pmid">24855268</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Desutter-Grandcolas</surname><given-names>L</given-names></name><name><surname>Robillard</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Phylogeny and the evolution of calling songs in Gryllus (Insecta, Orthoptera, Gryllidae)</article-title><source>Zoologica Scripta</source><volume>32</volume><fpage>173</fpage><lpage>183</lpage><pub-id pub-id-type="doi">10.1046/j.1463-6409.2003.00107.x</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deutsch</surname><given-names>D</given-names></name><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Thiberge</surname><given-names>SY</given-names></name><name><surname>Guan</surname><given-names>G</given-names></name><name><surname>Murthy</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Shared Song Detector Neurons in <italic>Drosophila</italic> Male and Female Brains Drive Sex-Specific Behaviors</article-title><source>Current Biology</source><volume>29</volume><fpage>3200</fpage><lpage>3215</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.08.008</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dewell</surname><given-names>RB</given-names></name><name><surname>Gabbiani</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Active membrane conductances and morphology of a collision detection neuron broaden its impedance profile and improve discrimination of input synchrony</article-title><source>Journal of Neurophysiology</source><volume>122</volume><fpage>691</fpage><lpage>706</lpage><pub-id pub-id-type="doi">10.1152/jn.00048.2019</pub-id><pub-id pub-id-type="pmid">31268830</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Engbers</surname><given-names>JDT</given-names></name><name><surname>Anderson</surname><given-names>D</given-names></name><name><surname>Tadayonnejad</surname><given-names>R</given-names></name><name><surname>Mehaffey</surname><given-names>WH</given-names></name><name><surname>Molineux</surname><given-names>ML</given-names></name><name><surname>Turner</surname><given-names>RW</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Distinct roles for IT and IH in controlling the frequency and timing of rebound spike responses</article-title><source>The Journal of Physiology</source><volume>589</volume><fpage>5391</fpage><lpage>5413</lpage><pub-id pub-id-type="doi">10.1113/jphysiol.2011.215632</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Farkhooi</surname><given-names>F</given-names></name><name><surname>Froese</surname><given-names>A</given-names></name><name><surname>Muller</surname><given-names>E</given-names></name><name><surname>Menzel</surname><given-names>R</given-names></name><name><surname>Nawrot</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cellular Adaptation Facilitates Sparse and Reliable Coding in Sensory Pathways</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>10</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003251</pub-id><pub-id pub-id-type="pmid">24098101</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felix</surname><given-names>RA</given-names></name><name><surname>Fridberger</surname><given-names>A</given-names></name><name><surname>Leijon</surname><given-names>S</given-names></name><name><surname>Berrebi</surname><given-names>AS</given-names></name><name><surname>Magnusson</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Sound Rhythms Are Encoded by Postinhibitory Rebound Spiking in the Superior Paraolivary Nucleus</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>12566</fpage><lpage>12578</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2450-11.2011</pub-id><pub-id pub-id-type="pmid">21880918</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fortune</surname><given-names>ES</given-names></name><name><surname>Rose</surname><given-names>GJ</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Short-Term Synaptic Plasticity as a Temporal Filter</article-title><source>Trends in Neurosciences</source><volume>24</volume><fpage>381</fpage><lpage>385</lpage><pub-id pub-id-type="doi">10.1016/s0166-2236(00)01835-x</pub-id><pub-id pub-id-type="pmid">11410267</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentner</surname><given-names>TQ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Temporal scales of auditory objects underlying birdsong vocal recognition</article-title><source>The Journal of the Acoustical Society of America</source><volume>124</volume><fpage>1350</fpage><lpage>1359</lpage><pub-id pub-id-type="doi">10.1121/1.2945705</pub-id><pub-id pub-id-type="pmid">18681620</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gerhardt</surname><given-names>CH</given-names></name><name><surname>Huber</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2002">2002</year><source>Acoustic Communication in Insects and Anurans</source><publisher-name>University of Chicago Press</publisher-name></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goaillard</surname><given-names>JM</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Functional consequences of animal-to-animal variation in circuit parameters</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1424</fpage><lpage>1430</lpage><pub-id pub-id-type="doi">10.1038/nn.2404</pub-id><pub-id pub-id-type="pmid">19838180</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonçalves</surname><given-names>PJ</given-names></name><name><surname>Lueckmann</surname><given-names>JM</given-names></name><name><surname>Deistler</surname><given-names>M</given-names></name><name><surname>Nonnenmacher</surname><given-names>M</given-names></name><name><surname>Öcal</surname><given-names>K</given-names></name><name><surname>Bassetto</surname><given-names>G</given-names></name><name><surname>Chintaluri</surname><given-names>C</given-names></name><name><surname>Podlaski</surname><given-names>WF</given-names></name><name><surname>Haddad</surname><given-names>SA</given-names></name><name><surname>Vogels</surname><given-names>TP</given-names></name><name><surname>Greenberg</surname><given-names>DS</given-names></name><name><surname>Macke</surname><given-names>JH</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Training deep neural density estimators to identify mechanistic models of neural dynamics</article-title><source>eLife</source><volume>9</volume><elocation-id>e56261</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56261</pub-id><pub-id pub-id-type="pmid">32940606</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>DA</given-names></name><name><surname>Cade</surname><given-names>WH</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Sexual Selection and Speciation in Field Crickets</article-title><source>PNAS</source><volume>97</volume><fpage>14449</fpage><lpage>14454</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.26.14449</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gray</surname><given-names>DA</given-names></name><name><surname>Gabel</surname><given-names>E</given-names></name><name><surname>Blankers</surname><given-names>T</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multivariate female preference tests reveal latent perceptual biases</article-title><source>Proceedings. Biological Sciences</source><volume>283</volume><elocation-id>20161972</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2016.1972</pub-id><pub-id pub-id-type="pmid">27807265</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grobe</surname><given-names>B</given-names></name><name><surname>Rothbart</surname><given-names>MM</given-names></name><name><surname>Hanschke</surname><given-names>A</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Auditory processing at two time scales by the cricket Gryllus bimaculatus</article-title><source>The Journal of Experimental Biology</source><volume>215</volume><fpage>1681</fpage><lpage>1690</lpage><pub-id pub-id-type="doi">10.1242/jeb.065466</pub-id><pub-id pub-id-type="pmid">22539735</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guilford</surname><given-names>T</given-names></name><name><surname>Dawkins</surname><given-names>MS</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Receiver psychology and the design of animal signals</article-title><source>Trends in Neurosciences</source><volume>16</volume><fpage>430</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(93)90068-W</pub-id><pub-id pub-id-type="pmid">7507611</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gutierrez</surname><given-names>GJ</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multiple Mechanisms Switch an Electrically Coupled, Synaptically Inhibited Neuron between Competing Rhythmic Oscillators</article-title><source>Neuron</source><volume>77</volume><fpage>845</fpage><lpage>858</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.01.016</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hasson</surname><given-names>U</given-names></name><name><surname>Nastase</surname><given-names>SA</given-names></name><name><surname>Goldstein</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Direct Fit to Nature: An Evolutionary Perspective on Biological and Artificial Neural Networks</article-title><source>Neuron</source><volume>105</volume><fpage>416</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2019.12.002</pub-id><pub-id pub-id-type="pmid">32027833</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hedwig</surname><given-names>B</given-names></name><name><surname>Sarmiento-Ponce</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Song pattern recognition in crickets based on a delay-line and coincidence-detector mechanism</article-title><source>Proceedings. Biological Sciences</source><volume>284</volume><elocation-id>20170745</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2017.0745</pub-id><pub-id pub-id-type="pmid">28539524</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heidenreich</surname><given-names>M</given-names></name><name><surname>Lechner</surname><given-names>SG</given-names></name><name><surname>Vardanyan</surname><given-names>V</given-names></name><name><surname>Wetzel</surname><given-names>C</given-names></name><name><surname>Cremers</surname><given-names>CW</given-names></name><name><surname>De Leenheer</surname><given-names>EM</given-names></name><name><surname>Aránguez</surname><given-names>G</given-names></name><name><surname>Moreno-Pelayo</surname><given-names>MÁ</given-names></name><name><surname>Jentsch</surname><given-names>TJ</given-names></name><name><surname>Lewin</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>KCNQ4 K+ channels tune mechanoreceptors for normal touch sensation in mouse and man</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>138</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1038/nn.2985</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname><given-names>R. M</given-names></name><name><surname>Weber</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Filtering of temporal parameters of the calling song by cricket females of two closely related species: a behavioral analysis</article-title><source>Journal of Comparative Physiology A</source><volume>180</volume><fpage>621</fpage><lpage>630</lpage><pub-id pub-id-type="doi">10.1007/s003590050078</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname><given-names>R M</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Acoustic feature extraction by cross-correlation in crickets?</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>189</volume><fpage>589</fpage><lpage>598</lpage><pub-id pub-id-type="doi">10.1007/s00359-003-0438-7</pub-id><pub-id pub-id-type="pmid">12879353</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Walking in Fourier’s space: algorithms for the computation of periodicities in song patterns by the cricket <italic>Gryllus bimaculatus</italic></article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>195</volume><fpage>971</fpage><lpage>987</lpage><pub-id pub-id-type="doi">10.1007/s00359-009-0473-0</pub-id><pub-id pub-id-type="pmid">19756649</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname><given-names>R. M</given-names></name><name><surname>Heller</surname><given-names>KG</given-names></name><name><surname>Clemens</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Time and timing in the acoustic recognition system of crickets</article-title><source>Frontiers in Physiology</source><volume>5</volume><elocation-id>286</elocation-id><pub-id pub-id-type="doi">10.3389/fphys.2014.00286</pub-id><pub-id pub-id-type="pmid">25161622</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname><given-names>R. M</given-names></name><name><surname>Blankers</surname><given-names>T</given-names></name><name><surname>Gray</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Divergence in male cricket song and female preference functions in three allopatric sister species</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>202</volume><fpage>347</fpage><lpage>360</lpage><pub-id pub-id-type="doi">10.1007/s00359-016-1083-2</pub-id><pub-id pub-id-type="pmid">27026021</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hildebrandt</surname><given-names>KJ</given-names></name><name><surname>Benda</surname><given-names>J</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Multiple Arithmetic Operations in a Single Neuron: The Recruitment of Adaptation Processes in the Cricket Auditory Pathway Depends on Sensory Context</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>14142</fpage><lpage>14150</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2556-11.2011</pub-id><pub-id pub-id-type="pmid">21976499</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hong</surname><given-names>RL</given-names></name><name><surname>Riebesell</surname><given-names>M</given-names></name><name><surname>Bumbarger</surname><given-names>DJ</given-names></name><name><surname>Cook</surname><given-names>SJ</given-names></name><name><surname>Carstensen</surname><given-names>HR</given-names></name><name><surname>Sarpolaki</surname><given-names>T</given-names></name><name><surname>Cochella</surname><given-names>L</given-names></name><name><surname>Castrejon</surname><given-names>J</given-names></name><name><surname>Moreno</surname><given-names>E</given-names></name><name><surname>Sieriebriennikov</surname><given-names>B</given-names></name><name><surname>Hobert</surname><given-names>O</given-names></name><name><surname>Sommer</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Evolution of neuronal anatomy and circuitry in two highly divergent nematode species</article-title><source>eLife</source><volume>8</volume><elocation-id>e47155</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.47155</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Izhikevich</surname><given-names>EM</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Which model to use for cortical spiking neurons?</article-title><source>IEEE Transactions on Neural Networks</source><volume>15</volume><fpage>1063</fpage><lpage>1070</lpage><pub-id pub-id-type="doi">10.1109/TNN.2004.832719</pub-id><pub-id pub-id-type="pmid">15484883</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>PF</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Modular timer networks: abdominal interneurons controlling the chirp and pulse pattern in a cricket calling song</article-title><source>Journal of Comparative Physiology A</source><volume>206</volume><fpage>921</fpage><lpage>938</lpage><pub-id pub-id-type="doi">10.1007/s00359-020-01448-0</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katz</surname><given-names>PS</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Neural mechanisms underlying the evolvability of behaviour</article-title><source>Philosophical Transactions of the Royal Society B</source><volume>366</volume><fpage>2086</fpage><lpage>2099</lpage><pub-id pub-id-type="doi">10.1098/rstb.2010.0336</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopp-Scheinpflug</surname><given-names>C</given-names></name><name><surname>Sinclair</surname><given-names>JL</given-names></name><name><surname>Linden</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>When Sound Stops: Offset Responses in the Auditory System</article-title><source>Trends in Neurosciences</source><volume>41</volume><fpage>712</fpage><lpage>728</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2018.08.009</pub-id><pub-id pub-id-type="pmid">30274606</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kostarakos</surname><given-names>K</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Calling song recognition in female crickets: temporal tuning of identified brain neurons matches behavior</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>9601</fpage><lpage>9612</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1170-12.2012</pub-id><pub-id pub-id-type="pmid">22787046</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kostarakos</surname><given-names>K</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Pattern recognition in field crickets: concepts and neural evidence</article-title><source>Journal of Comparative Physiology A</source><volume>201</volume><fpage>73</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1007/s00359-014-0949-4</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Large</surname><given-names>EW</given-names></name><name><surname>Crawford</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Auditory Temporal Computation: Interval Selectivity Based on Post-Inhibitory Rebound</article-title><source>Journal of Computational Neuroscience</source><volume>13</volume><fpage>125</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1023/a:1020162207511</pub-id><pub-id pub-id-type="pmid">12215726</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leonardo</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Degenerate coding in neural systems</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>191</volume><fpage>995</fpage><lpage>1010</lpage><pub-id pub-id-type="doi">10.1007/s00359-005-0026-0</pub-id><pub-id pub-id-type="pmid">16252121</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lundstrom</surname><given-names>BN</given-names></name><name><surname>Hong</surname><given-names>S</given-names></name><name><surname>Higgs</surname><given-names>MH</given-names></name><name><surname>Fairhall</surname><given-names>AL</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Two computational regimes of a single-compartment neuron separated by a planar boundary in conductance space</article-title><source>Neural Computation</source><volume>20</volume><fpage>1239</fpage><lpage>1260</lpage><pub-id pub-id-type="doi">10.1162/neco.2007.05-07-536</pub-id><pub-id pub-id-type="pmid">18194104</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neuromodulation of Neuronal Circuits: Back to the Future</article-title><source>Neuron</source><volume>76</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.09.010</pub-id><pub-id pub-id-type="pmid">23040802</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marder</surname><given-names>Eve</given-names></name><name><surname>O’Leary</surname><given-names>T</given-names></name><name><surname>Shruti</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neuromodulation of Circuits with Variable Parameters: Single Neurons and Small Circuits Reveal Principles of State-Dependent and Robust Neuromodulation</article-title><source>Annual Review of Neuroscience</source><volume>37</volume><fpage>329</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-071013-013958</pub-id><pub-id pub-id-type="pmid">25032499</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1982">1982</year><source>Vision: A Computational Investigation into the Human Representation and Processing of Visual Information</source><publisher-name>Henry Holt &amp; Company</publisher-name></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meckenhäuser</surname><given-names>G</given-names></name><name><surname>Krämer</surname><given-names>S</given-names></name><name><surname>Farkhooi</surname><given-names>F</given-names></name><name><surname>Ronacher</surname><given-names>B</given-names></name><name><surname>Nawrot</surname><given-names>MP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Neural representation of calling songs and their behavioral relevance in the grasshopper auditory system</article-title><source>Frontiers in Systems Neuroscience</source><volume>8</volume><elocation-id>183</elocation-id><pub-id pub-id-type="doi">10.3389/fnsys.2014.00183</pub-id><pub-id pub-id-type="pmid">25565983</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mendelson</surname><given-names>TC</given-names></name><name><surname>Shaw</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Sexual behaviour: Rapid speciation in an arthropod</article-title><source>Nature</source><volume>433</volume><fpage>375</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1038/433375a</pub-id><pub-id pub-id-type="pmid">15674280</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagel</surname><given-names>KI</given-names></name><name><surname>Wilson</surname><given-names>RI</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Biophysical mechanisms underlying olfactory receptor neuron dynamics</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>208</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1038/nn.2725</pub-id><pub-id pub-id-type="pmid">21217763</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neophytou</surname><given-names>D</given-names></name><name><surname>Oviedo</surname><given-names>HV</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Using Neural Circuit Interrogation in Rodents to Unravel Human Speech Decoding</article-title><source>Frontiers in Neural Circuits</source><volume>14</volume><elocation-id>2</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2020.00002</pub-id><pub-id pub-id-type="pmid">32116569</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Neunuebel</surname><given-names>JP</given-names></name><name><surname>Taylor</surname><given-names>AL</given-names></name><name><surname>Arthur</surname><given-names>BJ</given-names></name><name><surname>Egnor</surname><given-names>SER</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Female mice ultrasonically interact with males during courtship displays</article-title><source>eLife</source><volume>4</volume><elocation-id>e06203</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.06203</pub-id><pub-id pub-id-type="pmid">26020291</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niven</surname><given-names>JE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Neuronal energy consumption: biophysics, efficiency and evolution</article-title><source>Current Opinion in Neurobiology</source><volume>41</volume><fpage>129</fpage><lpage>135</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2016.09.004</pub-id><pub-id pub-id-type="pmid">27664945</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oganian</surname><given-names>Y</given-names></name><name><surname>Chang</surname><given-names>EF</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A Speech Envelope Landmark for Syllable Encoding in Human Superior Temporal Gyrus</article-title><source>Science Advances</source><volume>5</volume><elocation-id>aay6279</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.aay6279</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oh</surname><given-names>KP</given-names></name><name><surname>Shaw</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Multivariate sexual selection in a rapidly evolving speciation phenotype</article-title><source>Proceedings of the Royal Society B</source><volume>280</volume><elocation-id>20130482</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2013.0482</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otte</surname><given-names>D</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Evolution of cricket songs</article-title><source>Journal of Orthoptera Research</source><volume>1(1)</volume><elocation-id>25</elocation-id><pub-id pub-id-type="doi">10.2307/3503559</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pape</surname><given-names>HC</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Queer Current and Pacemaker: The Hyperpolarization-Activated Cation Current in Neurons</article-title><source>Annual Review of Physiology</source><volume>58</volume><fpage>299</fpage><lpage>327</lpage><pub-id pub-id-type="doi">10.1146/annurev.ph.58.030196.001503</pub-id><pub-id pub-id-type="pmid">8815797</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Phelps</surname><given-names>SM</given-names></name><name><surname>Ryan</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neural networks predict response biases of female túngara frogs</article-title><source>Proceedings of the Royal Society of London. Series B</source><volume>265</volume><fpage>279</fpage><lpage>285</lpage><pub-id pub-id-type="doi">10.1098/rspb.1998.0293</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Poulet</surname><given-names>JFA</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Auditory orientation in crickets: pattern recognition controls reactive steering</article-title><source>PNAS</source><volume>102</volume><fpage>15665</fpage><lpage>15669</lpage><pub-id pub-id-type="doi">10.1073/pnas.0505282102</pub-id><pub-id pub-id-type="pmid">16227440</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prescott</surname><given-names>SA</given-names></name><name><surname>Ratté</surname><given-names>S</given-names></name><name><surname>De Koninck</surname><given-names>Y</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Pyramidal neurons switch from integrators in vitro to resonators under in vivo-like conditions</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>3030</fpage><lpage>3042</lpage><pub-id pub-id-type="doi">10.1152/jn.90634.2008</pub-id><pub-id pub-id-type="pmid">18829848</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prieto-Godino</surname><given-names>LL</given-names></name><name><surname>Rytz</surname><given-names>R</given-names></name><name><surname>Cruchet</surname><given-names>S</given-names></name><name><surname>Bargeton</surname><given-names>B</given-names></name><name><surname>Abuin</surname><given-names>L</given-names></name><name><surname>Silbering</surname><given-names>AF</given-names></name><name><surname>Ruta</surname><given-names>V</given-names></name><name><surname>Dal Peraro</surname><given-names>M</given-names></name><name><surname>Benton</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Evolution of Acid-Sensing Olfactory Circuits in Drosophilids</article-title><source>Neuron</source><volume>93</volume><fpage>661</fpage><lpage>676</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.024</pub-id><pub-id pub-id-type="pmid">28111079</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prinz</surname><given-names>AA</given-names></name><name><surname>Bucher</surname><given-names>D</given-names></name><name><surname>Marder</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Similar network activity from disparate circuit parameters</article-title><source>Nature Neuroscience</source><volume>7</volume><fpage>1345</fpage><lpage>1352</lpage><pub-id pub-id-type="doi">10.1038/nn1352</pub-id><pub-id pub-id-type="pmid">15558066</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramdya</surname><given-names>P</given-names></name><name><surname>Benton</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Evolving olfactory systems on the fly</article-title><source>Trends in Genetics</source><volume>26</volume><fpage>307</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2010.04.004</pub-id><pub-id pub-id-type="pmid">20537755</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rau</surname><given-names>F</given-names></name><name><surname>Clemens</surname><given-names>J</given-names></name><name><surname>Naumov</surname><given-names>V</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name><name><surname>Schreiber</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Firing-rate resonances in the peripheral auditory system of the cricket, <italic>Gryllus bimaculatus</italic></article-title><source>Journal of Comparative Physiology A</source><volume>201</volume><fpage>1075</fpage><lpage>1090</lpage><pub-id pub-id-type="doi">10.1007/s00359-015-1036-1</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rees</surname><given-names>CL</given-names></name><name><surname>Moradi</surname><given-names>K</given-names></name><name><surname>Ascoli</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Weighing the Evidence in Peters’ Rule: Does Neuronal Morphology Predict Connectivity?</article-title><source>Trends in Neurosciences</source><volume>40</volume><fpage>63</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2016.11.007</pub-id><pub-id pub-id-type="pmid">28041634</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rose</surname><given-names>GJ</given-names></name><name><surname>Hanson</surname><given-names>JL</given-names></name><name><surname>Leary</surname><given-names>CJ</given-names></name><name><surname>Graham</surname><given-names>JA</given-names></name><name><surname>Alluri</surname><given-names>RK</given-names></name><name><surname>Vasquez-Opazo</surname><given-names>GA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Species-specificity of temporal processing in the auditory midbrain of gray treefrogs: interval-counting neurons</article-title><source>Journal of Comparative Physiology A</source><volume>201</volume><fpage>485</fpage><lpage>503</lpage><pub-id pub-id-type="doi">10.1007/s00359-015-0997-4</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothbart</surname><given-names>M. M</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Calling song signals and temporal preference functions in the cricket <italic>Teleogryllus leo</italic></article-title><source>Journal of Comparative Physiology A</source><volume>198</volume><fpage>817</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1007/s00359-012-0751-0</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothbart</surname><given-names>MM</given-names></name><name><surname>Hennig</surname><given-names>RM</given-names></name><name><surname>Bolhuis</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The Steppengrille (Gryllus spec./assimilis): Selective Filters and Signal Mismatch on Two Time Scales</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e43975</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0043975</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ryan</surname><given-names>MJ</given-names></name><name><surname>Cummings</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Perceptual Biases and Mate Choice</article-title><source>Annual Review of Ecology, Evolution, and Systematics</source><volume>44</volume><fpage>437</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135901</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>AKD</given-names></name><name><surname>Riede</surname><given-names>K</given-names></name><name><surname>Römer</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>High background noise shapes selective auditory filters in a tropical cricket</article-title><source>The Journal of Experimental Biology</source><volume>214</volume><fpage>1754</fpage><lpage>1762</lpage><pub-id pub-id-type="doi">10.1242/jeb.053819</pub-id><pub-id pub-id-type="pmid">21525323</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Schneider</surname><given-names>M</given-names></name><name><surname>Gidon</surname><given-names>A</given-names></name><name><surname>Triesch</surname><given-names>J</given-names></name><name><surname>Jedlicka</surname><given-names>P</given-names></name><name><surname>Cuntz</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Biological Complexity Facilitates Tuning of the Neuronal Parameter Space</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.05.04.442120</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schnupp</surname><given-names>JWH</given-names></name><name><surname>Carr</surname><given-names>CE</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>On hearing with more than one ear: lessons from evolution</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>692</fpage><lpage>697</lpage><pub-id pub-id-type="doi">10.1038/nn.2325</pub-id><pub-id pub-id-type="pmid">19471267</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schöneich</surname><given-names>S</given-names></name><name><surname>Kostarakos</surname><given-names>K</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>An auditory feature detection circuit for sound pattern recognition</article-title><source>Science Advances</source><volume>1</volume><elocation-id>e1500325</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.1500325</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schöneich</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Neuroethology of Acoustic Communication in Field Crickets - from Signal Generationto Song Recognition in an Insect Brain</article-title><source>Progress in Neurobiology</source><volume>194</volume><elocation-id>101882</elocation-id><pub-id pub-id-type="doi">10.1016/j.pneurobio.2020.101882</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schul</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Song recognition by temporal cues in a group of closely related bushcricket species (genus Tettigonia)</article-title><source>Journal of Comparative Physiology A</source><volume>183</volume><fpage>401</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1007/s003590050266</pub-id></element-citation></ref><ref id="bib97"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>DJ</given-names></name><name><surname>Goaillard</surname><given-names>J-M</given-names></name><name><surname>Marder</surname><given-names>EE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Quantitative expression profiling of identified neurons reveals cell-specific constraints on highly variable levels of gene expression</article-title><source>PNAS</source><volume>104</volume><fpage>13187</fpage><lpage>13191</lpage><pub-id pub-id-type="doi">10.1073/pnas.0705827104</pub-id></element-citation></ref><ref id="bib98"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Slee</surname><given-names>SJ</given-names></name><name><surname>Higgs</surname><given-names>MH</given-names></name><name><surname>Fairhall</surname><given-names>AL</given-names></name><name><surname>Spain</surname><given-names>WJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Two-Dimensional Time Coding in the Auditory Brainstem</article-title><source>The Journal of Neuroscience</source><volume>25</volume><fpage>9978</fpage><lpage>9988</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.2666-05.2005</pub-id><pub-id pub-id-type="pmid">16251446</pub-id></element-citation></ref><ref id="bib99"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ter Hofstede</surname><given-names>HM</given-names></name><name><surname>Schöneich</surname><given-names>S</given-names></name><name><surname>Robillard</surname><given-names>T</given-names></name><name><surname>Hedwig</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Evolution of a Communication System by Sensory Exploitation of Startle Behavior</article-title><source>Current Biology</source><volume>25</volume><fpage>3245</fpage><lpage>3252</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2015.10.064</pub-id><pub-id pub-id-type="pmid">26687622</pub-id></element-citation></ref><ref id="bib100"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsodyks</surname><given-names>M</given-names></name><name><surname>Pawelzik</surname><given-names>K</given-names></name><name><surname>Markram</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Neural networks with dynamic synapses</article-title><source>Neural Computation</source><volume>10</volume><fpage>821</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1162/089976698300017502</pub-id><pub-id pub-id-type="pmid">9573407</pub-id></element-citation></ref><ref id="bib101"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Robustness and evolvability: a paradox resolved</article-title><source>Proceedings of the Royal Society B</source><volume>275</volume><fpage>91</fpage><lpage>100</lpage><pub-id pub-id-type="doi">10.1098/rspb.2007.1137</pub-id></element-citation></ref><ref id="bib102"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wagner</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The molecular origins of evolutionary innovations</article-title><source>Trends in Genetics</source><volume>27</volume><fpage>397</fpage><lpage>410</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2011.06.002</pub-id><pub-id pub-id-type="pmid">21872964</pub-id></element-citation></ref><ref id="bib103"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Webb</surname><given-names>B</given-names></name><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Bush</surname><given-names>SL</given-names></name><name><surname>Schul</surname><given-names>J</given-names></name><name><surname>Buchli</surname><given-names>J</given-names></name><name><surname>Ijspeert</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Resonant neurons and bushcricket behaviour</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>193</volume><fpage>285</fpage><lpage>288</lpage><pub-id pub-id-type="doi">10.1007/s00359-006-0199-1</pub-id><pub-id pub-id-type="pmid">17180702</pub-id></element-citation></ref><ref id="bib104"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weissman</surname><given-names>DB</given-names></name><name><surname>Gray</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Crickets of the Genus Gryllus in the United States (Orthoptera: Gryllidae: Gryllinae)</article-title><source>Zootaxa</source><volume>4705</volume><fpage>1</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.11646/zootaxa.4705.1.1</pub-id></element-citation></ref><ref id="bib105"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>M</given-names></name><name><surname>Shaw</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Genetic coupling of signal and preference facilitates sexual isolation during rapid speciation</article-title><source>Proceedings. Biological Sciences</source><volume>286</volume><elocation-id>20191607</elocation-id><pub-id pub-id-type="doi">10.1098/rspb.2019.1607</pub-id><pub-id pub-id-type="pmid">31640515</pub-id></element-citation></ref><ref id="bib106"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>M</given-names></name><name><surname>Shaw</surname><given-names>KL</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Extensive Linkage and Genetic Coupling of Song and Preference Loci Underlying Rapid Speciation in Laupala Crickets</article-title><source>The Journal of Heredity</source><volume>112</volume><fpage>204</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1093/jhered/esab001</pub-id><pub-id pub-id-type="pmid">33438016</pub-id></element-citation></ref><ref id="bib107"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Benson</surname><given-names>NC</given-names></name><name><surname>Kay</surname><given-names>K</given-names></name><name><surname>Winawer</surname><given-names>J</given-names></name><name><surname>Seidemann</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Predicting neuronal dynamics with a delayed gain control model</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1007484</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007484</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61475.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>Clemens et al. present a computational model of the cricket song recognition network, which they show is capable of reasonably reproducing neural activity and song selectivity in <italic>G. bimaculatus</italic>. They then explore the parameter space of this network and find that varying parameters of model cells enable it to produce a range of selectivities for the period, pulse duration, duty cycle, or pause duration of input song. They then identify the network parameters that most affect song selectivity and investigate the relationship between several subsets of parameters and song preference. This is a fascinating exploration of the computational flexibility of a small neural circuit; it is well researched and written and was enjoyable to read.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61475.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Calabrese</surname><given-names>Ronald L</given-names></name><role>Reviewing Editor</role><aff><institution>Emory University</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Kennedy</surname><given-names>Ann</given-names></name><role>Reviewer</role><aff><institution>Northwestern University</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Webb</surname><given-names>Barbara</given-names></name><role>Reviewer</role><aff><institution>University of Edinburgh</institution><country>United Kingdom</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Nawrot</surname><given-names>Martin</given-names></name><role>Reviewer</role></contrib></contrib-group></front-stub><body><boxed-text id="box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;A small, computationally flexible network produces the phenotypic diversity of song recognition in crickets&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, and the evaluation has been overseen by Ronald Calabrese as the Senior and Reviewing Editor. The following individuals involved in review of your submission have agreed to reveal their identity: Ann Kennedy (Reviewer #1); Barbara Webb (Reviewer #2); Martin Paul Nawrot (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Clemens et al., present a computational model of the cricket song recognition network, which they show is capable of reasonably reproducing neural activity and song selectivity in G. bimaculatus. They then explore the parameter space of this network and find that varying parameters of model cells enable it to produce a range of selectivities for the period, pulse duration, duty cycle, or pause duration of input song. They then identify the network parameters that most affect song selectivity and investigate the relationship between several subsets of parameters and song preference. This is a fascinating exploration of the computational flexibility of a small neural circuit; it is well researched and written and was enjoyable to read.</p><p>Essential Revisions:</p><p>There were several concerns that must be addressed before the paper can be accepted.; including justification/discussion of the generality (beyond crickets) of the insights gained.</p><p>1. Explanation of the core principle of function is not clear, particularly as it relates to whether the filter properties in the model have some plausible biophysical counterpart. The authors must present a knowledgeable discussion of the biophysical mechanisms that could generate the described filter functions particularly the seemingly long delays in the linear filter shapes.</p><p>2. The use of LN2 output instead of AN1 output for neurons downstream of AN1 seems like an unnecessary kluge and could have affected the results. &quot;For simplicity and since AN1 and LN2 produce similar responses, we used the output of LN2_M in lieu of AN1_M responses for all neurons postsynaptic to AN1_M&quot;. How is it simpler? It sounds like a mistake in constructing the model. It could strongly affect the results, e.g. by making the excitatory and inhibitory inputs to LN4 more similar, as both are derived from LN2, instead of excitation from AN1 and inhibition from LN2.This should be fixed and the model reassessed.</p><p>Along the same lines the authors should discuss how they would translate the network output into behavioral output. Currently they seemingly compare behavioral response fields with their network output response field – there was considerable confusion about Figure 1B – but this has not been fully explained.</p><p>3. Several of the results in this paper, such as the anti-diagonal bands in Figure 3 and Figure 4b, seem to be a consequence of the fact that all simulated pulse trains had a fixed duration of 140ms. Is it reasonable to assume that pulse trains would have such a precisely fixed duration? Is LN4 also selective for pulse trains of a specific duration? If there isn't data on this, it would be an interesting thing to test with the model: if the input pulse train has one extra pulse or one fewer pulse, how are model LN4 responses affected? Does the model predict a preferred pulse train duration, or could it be the case that (for instance) longer pulse trains always lead to stronger LN4 activation?</p><p>Along the same lines, a cricket song consists of pulse-pause patterns, which are grouped within chirps that are separated by chirp pauses. The present paper ignores this and refers to the pulse-pause pattern filtering as 'song recognition'. This concern relates how the model would perform for an extra pulse.</p><p>4. One of the biggest discrepancies between data and model is the LN5 response at longer periods/pause durations (Figure 2b). Is it possible for the authors to comment on how this discrepancy might impact their other findings in the paper?</p><p>5. The distribution of model tolerances in Figure 4d seems surprising. It seems to suggest that the four categories of tolerances (period/duration/duty cycle/pause) do not correspond to distinct categories of models, but rather that the tolerance axis can take essentially any orientation. Is this true of other cricket species as well? If so, might it be that dividing tolerant axes into these four categories is misleading, in that it imposes discrete categories onto what is really a continuously varying signal?</p><p>6. We wonder how reasonable it is to describe all models as having a narrow &quot;selective&quot; axis and a broad &quot;tolerant&quot; axis as depicted in 4A. Among generated models where LN4m was responsive, was the LN4m response field always reasonably fit by a single ellipse, or did any models have more complex response fields?</p><p>7. The authors should discuss the previously described behavioral inter-individual variability within the species bimacultus in relation to the inter-species variability, which they cover with their parameter distributions.</p><p>These major points are further explained in the individual reviews<italic>Reviewer #1:</italic></p><p>Clemens et al., present a computational model of the cricket song recognition network, which they show is capable of reasonably reproducing neural activity and song selectivity in G. bimaculatus. They then explore the parameter space of this network, and find that varying parameters of model cells enable it to produce a tremendous range of selectivities for the period, pulse duration, duty cycle, or pause duration of input song. They then identify the network parameters that most affect song selectivity, and investigate the relationship between several subsets of parameters and song preference. This is a fantastic exploration of the computational flexibility of a small neural circuit; it is very well researched and written, and was enjoyable to read. Although I had a few questions about the paper contents (see below), I believe that all of these can be addressed by the authors, upon which I would warmly recommend this paper for publication in <italic>eLife</italic>.</p><p>1) Several of the results in this paper, such as the anti-diagonal bands in Figure 3 and Figure 4b, seem to be a consequence of the fact that all simulated pulse trains had a fixed duration of 140ms. Is it reasonable to assume that pulse trains would have such a precisely fixed duration? Is LN4 also selective for pulse trains of a specific duration? If there isn't data on this, it would be an interesting thing to test with the model: if the input pulse train has one extra pulse or one fewer pulse, how are model LN4 responses affected? Does the model predict a preferred pulse train duration, or could it be the case that (for instance) longer pulse trains always lead to stronger LN4 activation?</p><p>2) Because of the number of layers and nonlinearities in this model, it is hard to picture what is happening under the hood to give rise to preferences for a particular period, duration, duty cycle, or pause in Figure 4. I found Figure 3 to be very helpful for the example of G. bimaculatus- would it be possible to generate similar plots for some of the models from Figure 4e, for comparison?</p><p>3) I was a bit surprised by the distribution of model tolerances in Figure 4d. This seems to suggest that the four categories of tolerances (period/duration/duty cycle/pause) do not correspond to distinct categories of models, but rather that the tolerance axis can take essentially any orientation. Is this true of cricket species as well? If so, might it be that dividing tolerant axes into these four categories is misleading, in that it imposes discrete categories onto what is really a continuously varying value?</p><p>4) On a related note, I found myself wondering how reasonable it is to describe all models as having a narrow &quot;selective&quot; axis and a broad &quot;tolerant&quot; axis as depicted in 4A. Among generated models where LN4m was responsive, was the LN4m response field always reasonably fit by a single ellipse, or did any models have more complex response fields? In addition to the orientation and preference of the selective axis, is there anything to be learned from looking at the width of the tolerant/selective axes, or the preference range of the tolerant axis?</p><p>5) One of the biggest discrepancies between data and model is the LN5 response at longer periods/pause durations (Figure 2b). Is it possible for the authors to comment on how this discrepancy might impact their other findings in the paper?<italic>Reviewer #2:</italic></p><p>This paper contributes an interesting study of how parameter variation in a five-neuron network, closely based on identified neurons in the cricket, can establish different temporal tuning properties. The main application is to cricket song recognition; although the paper argues for more general insight into temporal recognition circuits, this is somewhat limited. Similarly, the argument for evolutionary relevance, as explaining how the diversity of cricket song might arise, would be more strongly supported either by showing potential 'pathways' of divergence (ideally through co-evolution models of production and recognition) or a clearer link from the model components to plausible biophysical mechanisms that could produce the relevant properties (e.g. specific filter shapes, especially where these are assumed to be comprised of multiple components within one neuron). As such, though the work is sound, it is of somewhat narrow interest.</p><p>Main contributions: the context of the work is that evolution of sensory preferences has been well explored at receptor level, but not yet for more complex stimulus properties, for which more sophisticated neural processing is needed to identify the preferred property in the signal. The main result of the paper is that different song preferences, as found across cricket species, can be obtained for different parameter settings within the same circuit, with biases in the frequency of preference types that match phenotypic diversity. The specific parameters/neural properties that produce qualitative differences in tuning (preference for period, duration or duty-cycle) are examined in more detail to provide some mechanistic insight into the circuit. This is approached in a very thorough manner, e.g., looking at each neuron's contribution and carrying out a full exploration followed by a sensitivity analysis to focus on the most important properties, and as such is of also of interest from a purely methodological point of view in neural modelling.</p><p>Substantive concerns:</p><p>1) As someone familiar both with cricket song recognition research and neural modelling, I had to work very hard to understand the circuit function from the presented description. The paper seems to assume the reader has very close familiarity with the papers by Kostarakos and Hedwig, 2012 and Schöneich et al., 2015 rather than giving a sufficiently clear account. E.g. in the introduction, the key concept is described as coincidence detection of delayed original input (AN1) and a &quot;post-inhibitory rebound driven by the end of each sound pulse (LN5)&quot;. On the face of it, this seems to be a mechanism for pulse duration tuning, not period tuning, and it is unclear why &quot;feature detector neuron LN4 integrates excitatory input from LN3 and inhibitory input from LN2, …sharpens its selectivity.&quot; From close inspection Figure 2, the mechanism for period selectivity appears to be 1) the timing of the rebound from LN5 from one syllable coincides with the onset of the next syllable 2) the response per syllable without this input decays for repeated syllables, and is further reduced in LN4 by inhibition with the same pattern as AN1. To some extent these phenomena are discussed later in the paper with reference to the effects of specific parameters, e.g. to increase the duration of the rebound from LN5; but it is difficult for the reader to follow without having the initial conceptual understanding of the original model.</p><p>2) The model seems relatively complex (multiple, somewhat arbitrarily chosen filters for each neuron, many parameters) and there is no discussion of whether it could be simplified while retaining the flexibility to be tuned to different song properties. Nor does the reader gain much insight into whether the parameters causing particular effects are plausible, or what might be the biophysical basis (this is discussed only for time delay variables) that could be subject to genetic modification.</p><p>3) The argument for insight into evolution from close examination of this network is not very convincing. Why would the existing network in one species be the &quot;mother network&quot; for other species? In the introduction, it is argued that &quot;song recognition networks must be selective and modifiable to adapt to changing signal patterns&quot; but the evolutionary drive seems more likely to be the opposite – the song should adapt to the recognition. Discussion of the co-evolution of production and recognition is very limited.<italic>Reviewer #3:</italic></p><p>This model study nicely and exemplarily describes how, in a sensory system with highly limited neuronal resources, a small generic network with 5 neuron types can flexibly generate a variety of tuning properties, allowing for species-specific auditory mate-recognition. Building on their previous body of works, the authors here employ a phenomenological (i.e. non-mechanistic) rate-based feed-forward circuit model, fitted to accommodate known single-neuron input/output features. The model faithfully predicts the animals' (average) response behavior to parametrically controlled sensory stimuli. Targeted parameter modifications can tune the network for different auditory pulse patterns. The authors argue that such a flexible generic network motive could allow for evolutionary fast species separation.</p><p>1) The authors state &quot;The neuronal circuit … has been revealed p.4 …&quot;. However, is there clear anatomic evidence for the explicit network wiring of 5 neurons and 6 connections? Does each of these neurons exist only once per hemisphere of any individual or are the authors referring to neuron types? Clear evidence should be referenced or missing evidence should be critically discussed.</p><p>2) The authors present a purely phenomenological model. How are these computations implemented biophysically? Which synaptic, cellular and network mechanisms are involved? Discussion of possible mechanisms and references to relevant works seems mandatory, in particular with respect to the (long) delays / rebound delay in the causal filters and the divisive normalization. Discussing adaptation for type AN1 and LN1 by means of either SFA (Nagel and Wilson, 2011, Nat Neurosci 14(2); Farkhooi et al., 2013, PLoS CB 9(10); Benda et al., 2003,2008) or short-term depressing synapses is straightforward. The phenomenological rate model has its own value. However, the argument that the authors did not aim at a biophysical implementation because ion channels and conductances are not known is not a good argument, this would have prevented 95% of published model studies.</p><p>3) The authors repeatedly refer to &quot;song-recognition&quot;. However, the authors only investigate pulse sequences (Figure 1B) neglecting the impact of chirp tuning (e.g. Grobe et al., 2012, JEB 2015; Meckenhäuser et al., 2013, PloS one, 8; Clemens and Hennig, 2013). This needs to be discussed.</p><p>4) The authors argue their model &quot;has the capacity to reproduce the behavioral preferences&quot; (p.8) with reference to behavioral tuning in Figure 1B. They should make explicit that this refers to the congruence of the LN4 response field (Figure 3) and behavioral response field (Figure 1B) for G. bimaculatus; no attempt was made to explicitly model behavioral output. How could behavior be generated? What is the typical delay between song onset and behavioral response? What is known about the behavioral decision circuit? Please discuss possible mechanisms of behavioral decision making such as the previously suggested drift diffusion models (Hennig et al., 2014, Front. Physiol 5; Clemens et al., 2014, PNAS 11; Meckenhäuser et al., 2014, Front. Sys. Neurosci 8) and possible others?</p><p>5) Inter vs. intra-species variability. To my knowledge there is large inter-individual variability in female G.bimaculatus behavior (Grobe et al., 2012, Meckenhäuser et al., 2013) and the authors sate tenfold neuron parameter variation within species. However, they model only an average animal and do not mention behavioral variability at all. How could parameter variation for inter-individual variability in their network differ from inter-species variability? This should be discussed.</p><p>6) What is the critical test for the existence of a 'multi-purpose' circuit across species? Do the authors expect the same basic network topology across species and did they attempt to identify it (anatomically) in any species other than G. bimaculatus? Can they think of other methods of validation? This should be addressed in the Discussion.</p><p>7) Authors briefly mention various song preference patterns across species. It would be great to see specific examples of song patterns for a few species along with matching model tuning, e.g. in a supplemental figure, possibly together behavioral date / response diagrams.</p><p>8) The core result on multi-species covered in Figure 4 and text indicates all four &quot;principal types&quot; of response fields can be achieved by the model with reference to Figure 1B. Where does Figure 1B come from? Are we looking at sketches? Or behavioral response fields measured in crickets? Please make this clear and give references to the underlying data. Clemens and Hennig 2013 and Hennig et al., 2014 do not show these graphs. Ideally, the authors can reproduce exemplary experimental data from diverse cricket species for illustration.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.61475.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>There were several concerns that must be addressed before the paper can be accepted.; including justification/discussion of the generality (beyond crickets) of the insights gained.</p></disp-quote><p>Beyond crickets many animal groups produce regular series of sound pulses directed at a receiver. If analyzed on the short time scale, there are four axes (pulse rate/period, pulse duration, pulse pause, duty cycle). It is a strength of the model that it identifies the main computations (forward excitation, suppression, rebound depolarization, coincidence detection, summation) needed to extract relevant information along these axes independent of the specific biophysical mechanism. In other words, the same computation may have more than one biophysical implementation.</p><p>Because of this generality (in terms of signal structure and modelling approach), our computational analyses produce hypotheses for how song preference may change from one type to another in different species and we now provide an example for that in the discussion. Since each model element has a straightforward biophysical implementation, we can at the same time propose specific changes in biophysical parameters that will lead to the desired changes in behavior.</p><p>We made the following edits to clarify these points:</p><p>Introduction:</p><p>“Repetitive patterns of short pulses that are organized in groups on a longer time scale are a common feature of acoustic signaling in insects, fish, and frogs (Baker et al., 2019; Carlson and Gallant, 2013; Gerhardt and Huber, 2002) and the processing and evaluation of these pulse patterns is therefore common to song recognition systems across species. […] Insights from insects where assumptions on physiological relevant parameters like synaptic strengths, delays and membrane properties of individual neurons can be made and systematically tested are therefore relevant for studies of pattern recognition systems and the evolution of acoustic communication systems in general.”</p><p>Discussion:</p><p>“The three computations that define model tuning – response suppression, post-inhibitory rebounds, and coincidence detection – occur across species and modalities. […] This could be implemented for example by reducing postsynaptic GABA receptors or by lowering the expression levels of voltage-gated potassium channels.”</p><disp-quote content-type="editor-comment"><p>1. Explanation of the core principle of function is not clear, particularly as it relates to whether the filter properties in the model have some plausible biophysical counterpart. The authors must present a knowledgeable discussion of the biophysical mechanisms that could generate the described filter functions particularly the seemingly long delays in the linear filter shapes.</p></disp-quote><p>We now explain the working principle in more detail in the introduction, based on the reviewers’ suggestions:</p><p>“In this species, the selectivity for a narrow range of pulse periods is created in a network of 5 neurons and 6 synaptic connections by combining a delay-line with a coincidence-detector (Figure 1D). […] Lastly, the feature detector neuron LN4 receives excitatory input from LN3 and inhibitory input from LN2, which sharpens its selectivity by further reducing responses to pulse patterns that do not produce coincident inputs to LN3. LN4’s selectivity for pulse patterns closely matches the phonotactic behavior of the females (Figure 1E).”</p><p>We also added a new section to the Discussion on the biophysical mechanisms generating each model element:</p><p>“How can these changes be implemented in a biological network? Although our phenomenological model is independent of a specific biophysical implementation, all model components have straightforward biophysical correlates. […] These examples demonstrate, that our phenomenological model has a straightforward, physiologically plausible implementations and therefore can propose experimentally testable hypothesis for transitions between types of behavioral preferences.”</p><disp-quote content-type="editor-comment"><p>2. The use of LN2 output instead of AN1 output for neurons downstream of AN1 seems like an unnecessary kluge and could have affected the results. &quot;For simplicity and since AN1 and LN2 produce similar responses, we used the output of LN2_M in lieu of AN1_M responses for all neurons postsynaptic to AN1_M&quot;. How is it simpler? It sounds like a mistake in constructing the model. It could strongly affect the results, e.g. by making the excitatory and inhibitory inputs to LN4 more similar, as both are derived from LN2, instead of excitation from AN1 and inhibition from LN2.This should be fixed and the model reassessed.</p></disp-quote><p>We agree that our simplifying assumption that AN1 and LN2 provide similar inputs to the other neurons in the network could have affected our results, in particular since we removed one degree of freedom, which could restrict the distribution of responses produced by the network. We had done the simplification because we lacked data from AN1.</p><p>To address the concern, we now added AN1 recordings, refitted the model, and repeated all analyses (including the generation of millions of responses from models with randomized parameters). To replicate the adaptation across pulses in a train observable in the AN1 responses, we added an explicit divisive normalization step to AN1. We find that nearly all results obtained are in line with the original model. Importantly, the key results on the biases of the network and the role of delays and inhibition/adaptation can be replicated with the adjusted model. This highlights the robustness of our conclusions.</p><p>Fitting the new model changed some results in minor ways, without affecting our conclusions:</p><p>– The proportion of responsive and sensitive models dropped from ~⅓ to ~1/11. This is because AN1 forms the network’s input and new parameters added to model AN1 lead to more parameter combinations. As a result, very low or very high AN1 responses will lead to no responses or the same response to all patterns, respectively.</p><p>– The sensitivity of the model to changes in AN1 parameters is now reduced (Figure 4G). This is likely because of the addition of new parameters to fit the AN1 response dynamics – most of these parameters do not affect tuning.</p><p>– The ranking of parameters in the sensitivity analysis is different (synaptic delays are slightly less important but still rank highly). However, the general trends remain (Figure 4H) – parameters that were important in the old model are still important in the revised version. The correlation of sensitivity ranking when changing pairs of parameters vs individual parameters is slightly weaker but still substantial (Figure 4—figure supplement 1, before: correlation 0.95, now 0.88).</p><p>– The decrease in the preferred duty cycle in LN4<sub>M</sub> with rebound delay was linear before. This curve has now a weakly decreasing slope, likely because of the adaptation added in AN1 (Figure 5D). In addition, the effect of duty cycle on the amplitude and latency of inputs to LN4<sub>M</sub> is now slightly different but the trend of later and weaker excitation onto LN4<sub>M</sub> with increasing duty cycle remains (Figure 5F).</p><p>– Trends in adaptation remain but addition of one more source of adaptation in AN1 makes the relationship between the number of adaptation/inhibition sources in the model and the preferred duty cycle more complex. However, the general trend, that more adaptation leads to lower preferred duty cycles, remains. We now show a simplified summary plot for this results in Figure 5I and moved the detailed plot to the Figure 5—figure supplement 3. In addition, small details in the response dynamics for trace for LN3<sub>M</sub> and LN4<sub>M</sub> in Figure 5G changed.</p><p>Overall, all these changes concern small details but do not affect any of the conclusions drawn from the model.</p><disp-quote content-type="editor-comment"><p>Along the same lines the authors should discuss how they would translate the network output into behavioral output. Currently they seemingly compare behavioral response fields with their network output response field – there was considerable confusion about Figure 1B – but this has not been fully explained.</p></disp-quote><p>We apologize for not making explicit the connection between model output and behavioral response fields. For the regular patterns used in this study and found in natural cricket songs, the translation from LN4 output to phonotaxis is rather simple – the firing rate over the chirp of LN4 is proportional to the phonotaxis value in <italic>Gryllus bimaculatus</italic>. Integrative processes over timescales that exceed the duration of the chirp shape insect decision making (Meckenhäuser 2014, DasGupta 2014) and these timescales can be characterized using artificial stimuli with conflicting information (Poulet and Hedwig 2005, Clemens 2014). We did not explicitly include them in the model, since the focus of our study was in pulse pattern recognition and these longer integration timescales do not change the responses to the regular pulse trains used in this study.</p><p>We now make explicit that we use the LN4<sub>M</sub> firing rate over a chirp to predict phonotaxis in the Methods (P23, L814):</p><p>“Prediction of phonotactic behavior from network responses</p><p>For regular pulse trains, the firing rate of LN4 (number of spikes per chirp/chirp duration) predicts phonotactic behavior very well (Schöneich et al., 2015) (Figure 1E). We therefore use the firing rate of LN4<sub>M</sub> to predict behavioral response fields from network output.”</p><p>And also discuss the existence of longer integration timescales in cricket phonotaxis in Results:</p><p>“To translate responses of the output neuron of the network – LN4<sub>M</sub> – into phonotaxis, we used a simple model: The firing rate of LN4 is strongly correlated with the female phonotaxis in G. bimaculatus (Figure 1E, Schöneich et al., (2015)) and we therefore took LN4<sub>M</sub>‘s firing rate averaged over a chirp to predict phonotaxis from the model responses. Integrative processes over timescales exceeding the chirp are known to affect behavior in crickets and other insects (Poulet and Hedwig (2005), see also Meckenhäuser et al,. (2014); Clemens et al., (2014); DasGupta et al., (2014)). We omit them here since they do not crucially affect responses for the simple, repetitive stimuli typical for pulse trains produced by crickets<italic>.”</italic></p><p>Regarding the response fields shown in Figure 1B: Initially, the response fields showed manually generated response fields. We have now replaced 3 of them with schematics derived from behavioral data of three different cricket species. The fourth – pause tuning – is not known in crickets and we kept the manually generated field. This is now clarified in the figure’s caption.</p><disp-quote content-type="editor-comment"><p>3. Several of the results in this paper, such as the anti-diagonal bands in Figure 3 and Figure 4b, seem to be a consequence of the fact that all simulated pulse trains had a fixed duration of 140ms. Is it reasonable to assume that pulse trains would have such a precisely fixed duration? Is LN4 also selective for pulse trains of a specific duration? If there isn't data on this, it would be an interesting thing to test with the model: if the input pulse train has one extra pulse or one fewer pulse, how are model LN4 responses affected? Does the model predict a preferred pulse train duration, or could it be the case that (for instance) longer pulse trains always lead to stronger LN4 activation?</p><p>Along the same lines, a cricket song consists of pulse-pause patterns, which are grouped within chirps that are separated by chirp pauses. The present paper ignores this and refers to the pulse-pause pattern filtering as 'song recognition'. This concern relates how the model would perform for an extra pulse.</p></disp-quote><p>This question relates to the selectivity of <italic>G. bimaculatus</italic> for the chirp. <italic>G bimaculatus</italic> males produce song with a relatively fixed number of pulses per chirp – variation is small and amounts to the addition or removal of individual pulses (Schöneich and Hedwig 2012, Jacob and Hedwig 2016). <italic>G. bimaculatus</italic> females do show a chirp selectivity, but with a rather wide tuning and large inter-individual variability (Grobe et al., 2012). Accepted chirp durations range from 120 ms to 300 ms and thus the addition or removal of a single pulse does not make much of a difference to the phonotactic response. We confirm that our model is also robust to addition/removal of a single pulse in a new Figure 3—figure supplement 2.</p><p>Although it remains an interesting question whether the chirp selectivity known from behavioral studies could be part of the present model network, there is no electrophysiological data to test this question available. Such data would require extensive electrophysiological recordings with tests of combinations of different chirp durations and chirp pauses for several combinations of pulse-pause patterns as in Grobe et al., (2012). The <italic>Gryllus</italic> songs are in most cases songs with a chirped structure and as our manuscript focuses on fast time scale recognition of the pulse-pause pattern, we do indeed not assess all aspects of ‘song recognition’. The focus of our analyses on the short timescale of pulse duration and pause is now made explicit throughout the manuscript. For example in the abstract (P1, L22):</p><p>“Using electrophysiological recordings from the network that recognizes crucial properties of the pulse pattern on the short timescale in the cricket Gryllus bimaculatus, we built a computational model that reproduces the neuronal and behavioral tuning of that species. An analysis of the model’s parameter space reveals that the network can provide all recognition phenotypes for pulse duration and pause known in crickets and even other insects.”</p><p>In the introduction (P4, L107):</p><p>“We here asked whether the network that recognizes features of the pulse pattern on the short timescale in G. bimaculatus (Figure 1D) has the capacity to produce the diversity of recognition phenotypes for pulse duration and pause known from crickets and other insects (Figure 1B), and what circuit properties support and constrain this capacity. [..] By exploring the network properties over a wide range of physiological parameters, we show that the network of G. bimaculatus can be modified to produce all types of preference functions for pulse duration and pause known from crickets and other insect species.”</p><p>Results (examples):</p><p>– “We tested whether the delay-line and coincidence-detector network of the cricket G. bimaculatus (Figure 1D) can be modified to produce the known diversity of preference functions for pulse duration and pause in cricket calling songs (Figure 1B).” (P4, L120)</p><p>– Renamed section title from “The network can be tuned to produce all known song preferences of crickets” to “The network can be tuned to produce all known preferences for pulse duration and pause in crickets.” (P7, L212)</p><p>– We also used more precise wording when summarizing our results, for instance: “Our analysis of different model variants suggests that this song recognition network can produce all known preference types for pulse duration and pause over the range of stimulus parameters relevant for crickets.” (P9, L305)</p><p>We now also address the preference for chirp parameters as an open question and discuss possible aspects of chirp preference the network could contribute to (Discussion, P16, L515):</p><p>“In addition, we have not yet explored the network’s ability to reproduce the behavioral selectivity for parameters on the longer timescale of chirps (Figure 1A) (Grobe et al., 2012; Blankers et al., 2016; Hennig et al., 2016). It is likely that the network can explain some properties of the selectivity for chirp known from crickets. For instance, that a minimum of two pulses is required to produce coincidence in the network could at least partly explain the existence of a minimal chirp duration for G. bimaculatus (Grobe et al., 2012). Likewise, suppression in the network reduces responses to long chirps which could explain the reduced behavioral preference for long chirps. However, the current electrophysiological data do not sufficiently constrain responses at these long timescales and studies are needed to address this issue more comprehensively.”</p><disp-quote content-type="editor-comment"><p>4. One of the biggest discrepancies between data and model is the LN5 response at longer periods/pause durations (Figure 2b). Is it possible for the authors to comment on how this discrepancy might impact their other findings in the paper?</p></disp-quote><p>Although it remains an interesting question whether the chirp selectivity known from behavioral studies could be part of the present model network, there is no electrophysiological data to test this question available. Such data would require extensive electrophysiological recordings with tests of combinations of different chirp durations and chirp pauses for several combinations of pulse-pause patterns as in Grobe et al., (2012). The <italic>Gryllus</italic> songs are in most cases songs with a chirped structure and as our manuscript focuses on fast time scale recognition of the pulse-pause pattern, we do indeed not assess all aspects of ‘song recognition’. The focus of our analyses on the short timescale of pulse duration and pause is now made explicit throughout the manuscript. For example (relevant changes in bold) in the abstract (P1, L22):</p><p>“Using electrophysiological recordings from the network that recognizes crucial properties of the pulse pattern on the short timescale in the cricket Gryllus bimaculatus, we built a computational model that reproduces the neuronal and behavioral tuning of that species. An analysis of the model’s parameter space reveals that the network can provide all recognition phenotypes for pulse duration and pause known in crickets and even other insects.”</p><p>In the introduction (P4, L107):</p><p>“We here asked whether the network that recognizes features of the pulse pattern on the short timescale in G. bimaculatus (Figure 1D) has the capacity to produce the diversity of recognition phenotypes for pulse duration and pause known from crickets and other insects (Figure 1B), and what circuit properties support and constrain this capacity. [..] By exploring the network properties over a wide range of physiological parameters, we show that the network of G. bimaculatus can be modified to produce all types of preference functions for pulse duration and pause known from crickets and other insect species.”</p><p>Results (examples):</p><p>– “We tested whether the delay-line and coincidence-detector network of the cricket G. bimaculatus (Figure 1D) can be modified to produce the known diversity of preference functions for pulse duration and pause in cricket calling songs (Figure 1B).” (P4, L120)</p><p>– Renamed section title from “The network can be tuned to produce all known song preferences of crickets” to “The network can be tuned to produce all known preferences for pulse duration and pause in crickets.” (P7, L212)</p><p>– We also used more precise wording when summarizing our results, for instance: “Our analysis of different model variants suggests that this song recognition network can produce all known preference types for pulse duration and pause over the range of stimulus parameters relevant for crickets.” (P9, L305)</p><p>We now also address the preference for chirp parameters as an open question and discuss possible aspects of chirp preference the network could contribute to (Discussion, P16, L515):</p><p>“In addition, we have not yet explored the network’s ability to reproduce the behavioral selectivity for parameters on the longer timescale of chirps (Figure 1A) (Grobe et al., 2012; Blankers et al., 2016; Hennig et al., 2016). It is likely that the network can explain some properties of the selectivity for chirp known from crickets. For instance, that a minimum of two pulses is required to produce coincidence in the network could at least partly explain the existence of a minimal chirp duration for G. bimaculatus (Grobe et al., 2012). Likewise, suppression in the network reduces responses to long chirps which could explain the reduced behavioral preference for long chirps. However, the current electrophysiological data do not sufficiently constrain responses at these long timescales and studies are needed to address this issue more comprehensively.”</p><disp-quote content-type="editor-comment"><p>5. The distribution of model tolerances in Figure 4d seems surprising. It seems to suggest that the four categories of tolerances (period/duration/duty cycle/pause) do not correspond to distinct categories of models, but rather that the tolerance axis can take essentially any orientation. Is this true of other cricket species as well? If so, might it be that dividing tolerant axes into these four categories is misleading, in that it imposes discrete categories onto what is really a continuously varying signal?</p></disp-quote><p>It is true that the network can produce response fields of essentially any orientation. However, this is not true for cricket species, which cluster around the orientations corresponding to the four principal types. The division of the data into four tolerant axes is thus motivated by the diversity of the known behavioral preferences. Focusing on these types allows us to compare the biological diversity with that produced by the model. The fact that the model produces preferences at orientations not found in nature hints at additional selection pressures, like temperature robustness or environmental noise, that lead to the selection of the four types. However, we cannot rule out the existence of intermediate response types in so far uncharacterized species.</p><p>Based on this and the next point in Essential Revisions, we’ve modified our analysis and re-wrote this section. We now make our motivations more explicit and support it with references to behavioral studies that have characterized the response fields in various species of crickets and other insect species (Results):</p><p>“The preferred pulse parameters – duration, pause, and their combinations period, and duty cycle – only incompletely describe a network’s recognition phenotype. […] Last, duty-cycle tuning (Figure 1C, cyan) is given by diagonal alignment (θ=45<sup>o</sup>) and selectivity for duty cycle but tolerance for period (G. lineaticeps, Hennig et al., (2016)).”</p><p>We changed the histogram showing the distribution of orientations of the response fields from a log to a linear scale, to highlight the non-uniform distribution of response types (Figure 4D):</p><p>This shows that duration tuning is strongly over-represented, period and duty-cycle tuning are weakly enriched, and pause tuning is much rarer than expected. This unequal distribution of the orientations reflects the unequal distribution of preference types found in crickets. For instance, we know of no cricket species with pause tuning. This is now made clearer in a re-written section in Results (P9, L285):</p><p>“We find response fields with any orientation, again demonstrating that the network can produce more diverse response fields than has been reported in crickets. However, the orientations are unevenly distributed and are enriched for the principal types known from crickets: 36% of the response fields have an orientation of 0±10° which corresponds to duration tuning (expectation from uniform distribution: 20°/360° = 5.6%). Duty cycle tuning (45 ±10°) and period tuning (-45 ±10°) are also enriched, with 17% and 12%, respectively. Notably, pause tuning (90 ±10°) is not known in crickets and is the only principal type that is rarer than expected from a uniform distribution of orientations (2.0% vs. 2.8% expected). The rarity of pause tuning is consistent with the bias to prefer short pulse durations observed above (Figure 4C), since orientations around 90° requires response fields that extend parallel to the pulse duration axis. Note that these trends do not depend critically on the ranges of angles chosen for specifying different the response types.”</p><p>We also address possible implications of the fact that the model produces intermediate orientations which are not known from crickets (Results, P9, L300):</p><p>“Interestingly, the network tends to create a larger diversity of response fields than is known from crickets, for instance, fields that are symmetrical, multi-peaked, or have intermediate orientations. This suggests that biases in the network – like the rarity of pause tuning – constrain the distribution of preferences that evolution can select from, and that additional factors – like robustness to noise or temperature – then determine the ultimate distribution of phenotypes.”</p><disp-quote content-type="editor-comment"><p>6. We wonder how reasonable it is to describe all models as having a narrow &quot;selective&quot; axis and a broad &quot;tolerant&quot; axis as depicted in 4A. Among generated models where LN4m was responsive, was the LN4m response field always reasonably fit by a single ellipse, or did any models have more complex response fields?</p></disp-quote><p>To show that the response fields of most models are well described by single ellipsoids, we now characterize the response fields more systematically using three new analyses:</p><p>1. We determined whether a given response field was well described by an ellipsoid. We compute the overlap between each response field, binarized by thresholding at 50% of the field’s maximum and a best fitting ellipse. The overlap, given by the Jaccard similarity index is high for most models: the median Jaccard similarity is 0.83, 80% of all response fields have a Jaccard similarity &gt;0.5. Manual inspection of response fields revealed that most models with a Jaccard similarity &gt;0.5 are well described by an ellipse. We show a histogram of similarity values and examples of a high and a low overlap model in the new Figure 4—figure supplement 2A, B.</p><p>2. From the fitted ellipses, we computed an asymmetry index as the ratio between the length of the ellipses’ major and the minor axes. We find that most of the fields fitted well by a single ellipse (Jaccard similarity &gt;0.5) are also asymmetrical (83% with an asymmetry index &gt;1.25). The distribution of asymmetry indices is shown in a new Figure 4—figure supplement 2C.</p><p>3. We detected the number of distinct, well-separated peaks for each response field. “Dominant peaks were defined as local maxima in the response field exceeding 0.5 of the global maximum value and separated by a trough that is smaller than 0.75 of the value of the lower of the two peaks.” (Methods, P25, L929). This analysis revealed that the vast majority of fields (88%) has a single peak (Figure 4—figure supplement 2A). We now show examples from the 12% of the response fields with multiple peaks (new Figure 4—figure supplement 2D).</p><p>The results of these analyses are covered in a new Figure 4—figure supplement 2 and in new section in Results (P9, L275):</p><p>“We first examined to what extent the model produced the single-peaked, asymmetrical response fields typical for crickets. We find that most response fields (80%) produced by the selective model variants were well described by a single ellipse (Figure 4—figure supplement 2A, B, see Methods for details). Of these, 83% where asymmetrical (major axis &gt;1.25x longer than minor axis), 17% were symmetrical (Figure 4—figure supplement 2C). 12% of all models produces multi-peaked response fields (Figure 4—figure supplement 2D), which are only known from katydids (Webb et al., 2007). The remaining 8% of the response fields were not well described by ellipses and/or did not have multiple distinct peaks. Thus, while the model produces more diverse responses – including complex, multi-peaked ones – most responses do match those typical for crickets.”</p><p>The analysis is also described in a new section “Characterization of response fields” in Methods:</p><p>“Characterization of response fields</p><p>The response fields known in crickets all have a single maximum and a roughly ellipsoid shape with a single maximum. […] For the asymmetry index, we extracted the length of the major and minor axis of the best-fitted ellipse as the eigenvalues of the covariance matrix and took their ratio.”</p><p>Taken together, the changes to how we present our results based on #5 and #6 in Essential Revisions provides a more complete and unbiased assessment of the diversity of responses produced by the model.</p><disp-quote content-type="editor-comment"><p>7. The authors should discuss the previously described behavioral inter-individual variability within the species bimacultus in relation to the inter-species variability, which they cover with their parameter distributions.</p></disp-quote><p>The behaviorally well-documented interindividual variability in phonotaxis behaviors (Grobe et al., 2012; Meckenhäuser et al., 2013) likely arises at multiple levels: At the level of song pattern recognition (interindividual differences in the network parameters), at the level of phonotaxis behavior (biases and noise in localizing the sound), at the motivational level (low or high motivation leads to more or less selective responses), and at the motor level (variability from motor noise). Identifying the contribution of variability at the level of song pattern recognition is challenging, since the full characterization of the behavioral phenotype in terms of the response fields cannot be obtained reliably at the individual level (the stimulus space is too large); this would require multiple testing of the same individuals with the same large set of test patterns. Therefore, our model of song pattern recognition does not explicitly consider the interindividual variability but is meant to represent the behavior of an average female.</p><p>Regarding the relation between intra vs inter species variability in network parameters: Our sensitivity analysis (Figure 4H) identified many parameters with little impact on the model tuning, which form one or multiple fitness-neutral subregions in parameter pace. In the biological population, these parameters likely vary between individuals, because they are subject to weak selection. By contrast, parameters with a high sensitivity score that affect crucial aspects of the recognition phenotype undergo stronger selection and are therefore likely less variable across individuals. These fitness-critical parameters are likely the ones driving changes in the recognition phenotype during a speciation event. Our current approach of assessing parameters individually (Figure 4G, H) or in pairs (Figure 4—figure supplement 1) is insufficient to capture the relationship of the fitness-neutral and the fitness-critical parameter subspaces Novel tools (for instance, Bittner et al., (2019) and Gonçalves et al., (2019)) will be employed to more exhaustively characterize the high-dimensional parameter to phenotype map with respect to inter and intra specific variability.</p><p>This point is now discussed in the discussion:</p><p>“We find that many parameters have only weak impacts on the network’s preference, leading to a relatively large fitness-neutral parameter set and a robust phenotype (Prinz et al., 2004). For instance, we observed that the rebound amplitude in LN5 tends to be variable across electrophysiological recordings in different individuals but that the network model’s output is relatively robust to these changes (Figure 2B, Figure 2—figure supplement 4). Other parameters crucially affect the recognition phenotype and support evolvability. These fitness-critical parameters likely drive changes in the recognition phenotype during speciation events to ensure species discrimination (Amézquita et al., 2011; Schmidt et al., 2011). Future studies will employ novel computational methods for characterizing the high-dimensional parameter space (Bittner et al., 2021; Gonçalves et al., 2020) to more comprehensively characterize the fitness-neutral parameter set leading to interindividual variability and to provide insight into the robustness and evolvability of pattern recognition networks.”</p><disp-quote content-type="editor-comment"><p>These major points are further explained in the individual reviews</p><p>Reviewer #1 (Recommendations for the authors):</p><p>Clemens et al., present a computational model of the cricket song recognition network, which they show is capable of reasonably reproducing neural activity and song selectivity in G. bimaculatus. They then explore the parameter space of this network, and find that varying parameters of model cells enable it to produce a tremendous range of selectivities for the period, pulse duration, duty cycle, or pause duration of input song. They then identify the network parameters that most affect song selectivity, and investigate the relationship between several subsets of parameters and song preference. This is a fantastic exploration of the computational flexibility of a small neural circuit; it is very well researched and written, and was enjoyable to read. Although I had a few questions about the paper contents (see below), I believe that all of these can be addressed by the authors, upon which I would warmly recommend this paper for publication in eLife.</p><p>Major comments:</p><p>1) Several of the results in this paper, such as the anti-diagonal bands in Figure 3 and Figure 4b, seem to be a consequence of the fact that all simulated pulse trains had a fixed duration of 140ms. Is it reasonable to assume that pulse trains would have such a precisely fixed duration? Is LN4 also selective for pulse trains of a specific duration? If there isn't data on this, it would be an interesting thing to test with the model: if the input pulse train has one extra pulse or one fewer pulse, how are model LN4 responses affected? Does the model predict a preferred pulse train duration, or could it be the case that (for instance) longer pulse trains always lead to stronger LN4 activation?</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #3’.</p><p>Within a species, pulse trains (chirps) have a highly consistent duration – differences between chirps lie mainly in the addition or removal of a single pulse. Behavioral data show that for the chirp durations used here, female phonotaxis is robust to the addition/removal of a single chirp (Grobe, 2012). We performed a new analysis to show that this robustness to the addition or removal of a single pulse in a chirp is reproduced by the model (new Figure 3—figure supplement 2).</p><p>While the tuning for chirp parameters (chirp duration, chirp pause) is much broader than that for pulse parameters, crickets do indeed exhibit species-specific tuning for the chirp. However, the focus of this manuscript is on the tuning for pulse parameters, which we now make explicit throughout the text (see Essential Rev #3). Some aspects of the known behavioral tuning for chirp parameters are likely explained by the network but some aspects likely require additional mechanisms not captured by the pulse-pattern recognition network. This is now discussed (P16, L515, reproduced in Essential Rev #3).</p><disp-quote content-type="editor-comment"><p>2) Because of the number of layers and nonlinearities in this model, it is hard to picture what is happening under the hood to give rise to preferences for a particular period, duration, duty cycle, or pause in Figure 4. I found Figure 3 to be very helpful for the example of G. bimaculatus- would it be possible to generate similar plots for some of the models from Figure 4e, for comparison?</p></disp-quote><p>We now provide the response fields for all neurons in the network for an example from each response type in Figure 4E in a new Figure 4—figure supplement 3 in the supplement.</p><disp-quote content-type="editor-comment"><p>3) I was a bit surprised by the distribution of model tolerances in Figure 4d. This seems to suggest that the four categories of tolerances (period/duration/duty cycle/pause) do not correspond to distinct categories of models, but rather that the tolerance axis can take essentially any orientation. Is this true of cricket species as well? If so, might it be that dividing tolerant axes into these four categories is misleading, in that it imposes discrete categories onto what is really a continuously varying value?</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #5’.</p><p>Known response fields from crickets fall into three categories – duration, period and duty cycle tuning. Pause tuning is not known. Intermediate types are not yet known. We have edited the text to clarify this. We have rewritten the relevant section in Results with new analyses and figures (Figure 4—figure supplement 2, 3) to provide a more nuanced assessment of the diversity of responses produced by the model.</p><disp-quote content-type="editor-comment"><p>4) On a related note, I found myself wondering how reasonable it is to describe all models as having a narrow &quot;selective&quot; axis and a broad &quot;tolerant&quot; axis as depicted in 4A. Among generated models where LN4m was responsive, was the LN4m response field always reasonably fit by a single ellipse, or did any models have more complex response fields? In addition to the orientation and preference of the selective axis, is there anything to be learned from looking at the width of the tolerant/selective axes, or the preference range of the tolerant axis?</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #6’.</p><p>New analyses now more comprehensively describe the general shape of the response fields (new text in Results (P9, L275) and new Figure 4—figure supplement 2).</p><disp-quote content-type="editor-comment"><p>5) One of the biggest discrepancies between data and model is the LN5 response at longer periods/pause durations (Figure 2b). Is it possible for the authors to comment on how this discrepancy might impact their other findings in the paper?</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #4’.</p><p>We now show that this discrepancy has only minor impact on the model responses (new text in Results, new Figure 2—figure supplement 4).</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>This paper contributes an interesting study of how parameter variation in a five-neuron network, closely based on identified neurons in the cricket, can establish different temporal tuning properties. The main application is to cricket song recognition; although the paper argues for more general insight into temporal recognition circuits, this is somewhat limited. Similarly, the argument for evolutionary relevance, as explaining how the diversity of cricket song might arise, would be more strongly supported either by showing potential 'pathways' of divergence (ideally through co-evolution models of production and recognition) or a clearer link from the model components to plausible biophysical mechanisms that could produce the relevant properties (e.g. specific filter shapes, especially where these are assumed to be comprised of multiple components within one neuron). As such, though the work is sound, it is of somewhat narrow interest.</p><p>Main contributions: the context of the work is that evolution of sensory preferences has been well explored at receptor level, but not yet for more complex stimulus properties, for which more sophisticated neural processing is needed to identify the preferred property in the signal. The main result of the paper is that different song preferences, as found across cricket species, can be obtained for different parameter settings within the same circuit, with biases in the frequency of preference types that match phenotypic diversity. The specific parameters/neural properties that produce qualitative differences in tuning (preference for period, duration or duty-cycle) are examined in more detail to provide some mechanistic insight into the circuit. This is approached in a very thorough manner, e.g., looking at each neuron's contribution and carrying out a full exploration followed by a sensitivity analysis to focus on the most important properties, and as such is of also of interest from a purely methodological point of view in neural modelling.</p><p>Substantive concerns:</p><p>1) As someone familiar both with cricket song recognition research and neural modelling, I had to work very hard to understand the circuit function from the presented description. The paper seems to assume the reader has very close familiarity with the papers by Kostarakos and Hedwig, 2012 and Schöneich et al., 2015 rather than giving a sufficiently clear account. E.g. in the introduction, the key concept is described as coincidence detection of delayed original input (AN1) and a &quot;post-inhibitory rebound driven by the end of each sound pulse (LN5)&quot;. On the face of it, this seems to be a mechanism for pulse duration tuning, not period tuning, and it is unclear why &quot;feature detector neuron LN4 integrates excitatory input from LN3 and inhibitory input from LN2, …sharpens its selectivity.&quot; From close inspection Figure 2, the mechanism for period selectivity appears to be 1) the timing of the rebound from LN5 from one syllable coincides with the onset of the next syllable 2) the response per syllable without this input decays for repeated syllables, and is further reduced in LN4 by inhibition with the same pattern as AN1. To some extent these phenomena are discussed later in the paper with reference to the effects of specific parameters, e.g. to increase the duration of the rebound from LN5; but it is difficult for the reader to follow without having the initial conceptual understanding of the original model.</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #1’.</p><p>We explain the working principle in more detail in the introduction, based on the reviewers’ suggestions (P4, L94).</p><disp-quote content-type="editor-comment"><p>2) The model seems relatively complex (multiple, somewhat arbitrarily chosen filters for each neuron, many parameters) and there is no discussion of whether it could be simplified while retaining the flexibility to be tuned to different song properties. Nor does the reader gain much insight into whether the parameters causing particular effects are plausible, or what might be the biophysical basis (this is discussed only for time delay variables) that could be subject to genetic modification.</p></disp-quote><p>We agree that the number of parameters is large. This stems from our goal to reproduce the crucial aspects of the dynamics of all neurons faithfully. We believe that a high-dimensional and degenerate parameter space is something that our model shares with the biological network and it is key to the network’s computational flexibility. Our sensitivity analyses identified key parameters that shape crucial aspects of the model tuning (Figures 4, 5, 6). Finding a minimally parameterized circuit model that trades fidelity for simplicity while retaining computational capacity would be a fascinating topic for a future study!</p><p>These points are now addressed in Discussion:</p><p>“Computational flexibility also needs evolvability – the ability to generate specific and robust phenotypes during evolution (Blankers et al., 2015). The “mechanistic degeneracy” of computation in biological neural networks – the fact that specific network outputs can be obtained by tuning disparate parameters – is thought to be a prerequisite for evolvability (Wagner (2011), see also Hasson et al., (2020); Leonardo (2005); Schneider et al., (2021)). The degeneracy concept has been demonstrated extensively for motor networks (Gutierrez et al., 2013; Prinz et al., 2004), and here we also found evidence of degeneracy in the cricket song recognition network. For instance, the preferred pulse period (Figure 5A, B, Figure 5—figure supplement 1) or the pulse duty cycle (Figure 5G-I) can be set by multiple parameters. The hypothesis that high-dimensional and degenerate biological parameter spaces are more evolvable could be tested by assessing the computational flexibility of a minimal model of the network that produces the observed behavior with as few parameters as possible.”</p><p>To address the issue of the plausibility of our parameter values, we now discuss the possible biophysical bases for all parameters in the Discussion (P17, L543) (see ‘Essential Revisions #1’).</p><disp-quote content-type="editor-comment"><p>3) The argument for insight into evolution from close examination of this network is not very convincing. Why would the existing network in one species be the &quot;mother network&quot; for other species?</p></disp-quote><p>It is likely that large parts of the network are retained in closely related species and therefore that the network from G. bimaculatus resembles that found in closely related cricket species. This hypothesis is supported post-hoc by our results, which show that this network can produce all known behavioral preferences for pulse pause and duration in the species group. In addition, a recent phylogenetic analysis suggests that G. bimaculatus is close to the base of the phylogenetic tree from which many other species emerged (Gray et al., 2020, Page 17). Although this does not prove that the network of G. bimaculatus is a mother network for other species, phylogeny is in principle consistent with this idea.</p><p>This is now explained in the discussion:</p><p>“While the network model analyzed here is derived from recordings in one species (G. bimaculatus), the delay-line and coincidence-detector network is likely shared within the closely related cricket species. The phylogenetic position of G. bimaculatus close to the base of the phylogenetic tree from which many other species emerged is consistent with this idea (Gray et al., 2020). Our finding that this network can produce all known preferences for pulse and pause supports this idea and suggests that it for ms a common substrate – a “mother network” – for the diversity of song recognition phenotypes in crickets.”</p><disp-quote content-type="editor-comment"><p>In the introduction, it is argued that “song recognition networks must be selective and modifiable to adapt to changing signal patterns” but the evolutionary drive seems more likely to be the opposite – the song should adapt to the recognition. Discussion of the co-evolution of production and recognition is very limited.</p></disp-quote><p>This is true. The most likely scenario for the co-evolution of song preference and structure is the following: Female preferences drift around in signal space, maybe pushed by abiotic (environmental noise selects against preferences for very short pauses) and biotic factors (avoid overlap with heterospecifics (Amezquita, 2011)). Males then “adjust” their song to attract females. In this scenario, a female network that has the capacity to produce many different preference types supports the ability of communication system to diverge. Our finding that the network can produce all preference types confirms this hypothesis.</p><p>This is now clarified in Introduction:</p><p>“Since the evolution of song is largely driven by the female (Gray and Cade, 2000), the females’ song recognition must be selective and modifiable in order to drive the evolution of distinct, species-specific song patterns in males (Wagner, 2008).”</p><p>And in Ddiscussion:</p><p>“The computational flexibility of the recognition mechanism may explain the species richness as well as the speed of evolution in a particular taxon like crickets (Alexander, 1962; Blankers et al., 2015; Desutter Grandcolas and Robillard, 2003; Oh and Shaw, 2013; Otte, 1992): Female preferences drift around with little constraint in signal space, maybe pushed by abiotic (environmental noise selects against preferences for very short pauses) and biotic factors (avoid overlap with heterospecifics, Amézquita et al.,(2011)). The male song evolution follows female evolution since only males that sing attractive songs will reproduce. In this scenario, a female network that has the capacity to produce many different preference types supports the ability of the communication system to diverge. However, this co-evolution of song preference and song structure requires male song production networks to be as flexible as the female song recognition networks (Jacob and Hedwig, 2020; Schöneich, 2020). There is also accumulating evidence for genetic coupling between the networks that produce and recognize the song pattern, which may ensure that sender and receiver stay tuned during evolution of song pattern (Xu and Shaw, 2009; Schöneich, 2020; Xu and Shaw, 2021).”</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>This model study nicely and exemplarily describes how, in a sensory system with highly limited neuronal resources, a small generic network with 5 neuron types can flexibly generate a variety of tuning properties, allowing for species-specific auditory mate-recognition. Building on their previous body of works, the authors here employ a phenomenological (i.e. non-mechanistic) rate-based feed-forward circuit model, fitted to accommodate known single-neuron input/output features. The model faithfully predicts the animals' (average) response behavior to parametrically controlled sensory stimuli. Targeted parameter modifications can tune the network for different auditory pulse patterns. The authors argue that such a flexible generic network motive could allow for evolutionary fast species separation.</p><p>1) The authors state &quot;The neuronal circuit … has been revealed p.4 …&quot;. However, is there clear anatomic evidence for the explicit network wiring of 5 neurons and 6 connections? Does each of these neurons exist only once per hemisphere of any individual or are the authors referring to neuron types? Clear evidence should be referenced or missing evidence should be critically discussed.</p></disp-quote><p>This is correct – the network is not based on a complete wiring diagram of the song recognition circuit in G. bimaculatus – it was reconstructed from anatomical data and single-cell recordings. We now refer to the different neurons in the network as cell types, of which multiple copies could exist per hemisphere.</p><p>This is clarified in Results:</p><p>“This network was previously inferred from the anatomical overlap together with the dynamics and the timing of responses of individually recorded neurons to a diverse set of pulse patterns (Kostarakos and Hedwig, 2012; Schöneich et al., 2015). Given that electrophysiology is challenging in this system, dual-electrode recordings to prove the existence of the inferred connections do not exist presently. We consider the neurons in the network cell types, that may also comprise multiple cells per hemisphere with highly consistent properties across individuals (Schöneich, 2020).”</p><disp-quote content-type="editor-comment"><p>2) The authors present a purely phenomenological model. How are these computations implemented biophysically? Which synaptic, cellular and network mechanisms are involved? Discussion of possible mechanisms and references to relevant works seems mandatory, in particular with respect to the (long) delays / rebound delay in the causal filters and the divisive normalization. Discussing adaptation for type AN1 and LN1 by means of either SFA (Nagel and Wilson, 2011, Nat Neurosci 14(2); Farkhooi et al., 2013, PLoS CB 9(10); Benda et al., 2003,2008) or short-term depressing synapses is straightforward. The phenomenological rate model has its own value. However, the argument that the authors did not aim at a biophysical implementation because ion channels and conductances are not known is not a good argument, this would have prevented 95% of published model studies.</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #1’.</p><p>We added a detailed discussion of the biophysical implementation of all model elements to the discussion. We also now justify our phenomenological modelling approach more clearly (Results):</p><p>“We consider the neurons in the network cell types, that may also comprise multiple cells per hemisphere with highly consistent properties across individuals (Schöneich, 2020). We fitted a computational model based on intracellularly recorded responses of the network’s neurons to pulse trains. Our goal was to obtain a model that captures the computational capacity of the network without tying it to a specific biophysical implementation, we reproduced the responses of individual neurons using a phenomenological model based on four elementary computations (Figure 2A): 1. filtering, 2. nonlinear transfer functions (nonlinearities), 3. adaptation, and 4. linear transmission with a delay. This phenomenological model allows us to assess the network’s computational capacity independent of a specific biophysical implementation. However, all model components have straightforward biophysical correlates (see Discussion), which allows us to propose biophysical parameters that tune the network in specific implementations.”</p><disp-quote content-type="editor-comment"><p>3) The authors repeatedly refer to &quot;song-recognition&quot;. However, the authors only investigate pulse sequences (Figure 1B) neglecting the impact of chirp tuning (e.g. Grobe et al., 2012, JEB 2015; Meckenhäuser et al., 2013, PloS one, 8; Clemens and Hennig, 2013). This needs to be discussed.</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #3’.</p><p>This is correct, we focus on pulse sequences because selectivity for this aspect of the song is typically high while the tuning for chirp parameters tends to be broader. In addition, the network we model has been shown to explain pulse pattern recognition and no data exist that probe the network’s selectivity for long time scales. However, the network likely contributes to the preference for long timescales. This is now discussed (P16, L515) and we now make our focus on the recognition of pulse duration and pause explicit throughout the manuscript in abstract, intro, etc. (see ‘Essential Revisions #1’, reply P3-5).</p><disp-quote content-type="editor-comment"><p>4) The authors argue their model &quot;has the capacity to reproduce the behavioral preferences&quot; (p.8) with reference to behavioral tuning in Figure 1B. They should make explicit that this refers to the congruence of the LN4 response field (Figure 3) and behavioral response field (Figure 1B) for G. bimaculatus; no attempt was made to explicitly model behavioral output. How could behavior be generated? What is the typical delay between song onset and behavioral response? What is known about the behavioral decision circuit? Please discuss possible mechanisms of behavioral decision making such as the previously suggested drift diffusion models (Hennig et al., 2014, Front. Physiol 5; Clemens et al., 2014, PNAS 11; Meckenhäuser et al., 2014, Front. Sys. Neurosci 8) and possible others?</p></disp-quote><p>This is now addressed in detail in ‘Essential Revisions #2’.</p><p>For the regular patterns used in this study and found in natural cricket songs, the translation from LN4 output to phonotaxis is rather simple and we now make explicit that we use the firing rate of LN4 over a chirp as a predictor of phonotaxis (Results P8 L228, Methods P23, L817). We agree that integrative properties that exceed the duration of the pulse exist in insect decision making (Meckenhäuser, Dasgupta 2014) and that they can be revealed using artificial stimuli with conflicting information (Poulet 2005, Clemens 2014). However, these processes do not strongly affect responses to the repetitive stimuli used here. We discuss the existence of integrative processes in Results (P8, L231).</p><disp-quote content-type="editor-comment"><p>5) Inter vs. intra-species variability. To my knowledge there is large inter-individual variability in female G.bimaculatus behavior (Grobe et al., 2012, Meckenhäuser et al., 2013) and the authors sate tenfold neuron parameter variation within species. However, they model only an average animal and do not mention behavioral variability at all. How could parameter variation for inter-individual variability in their network differ from inter-species variability? This should be discussed.</p></disp-quote><p>See Essential Revisions #7.</p><disp-quote content-type="editor-comment"><p>6) What is the critical test for the existence of a 'multi-purpose' circuit across species? Do the authors expect the same basic network topology across species and did they attempt to identify it (anatomically) in any species other than G. bimaculatus? Can they think of other methods of validation? This should be addressed in the Discussion.</p></disp-quote><p>We have not done recordings or anatomical analyses in other species. We now propose behavioral and electrophysiological tests or our hypotheses in a new section in the discussion:</p><p>“How can the mother network hypothesis be tested? Behavioral tests can provide insight into whether other species use the coincidence detection algorithm found in G. bimaculatus (Hedwig and Sarmiento-Ponce, 2017). These experiments can for instance test the prediction that the duration of the last pulse in a chirp only weakly impacts network responses. Species that violate this prediction are unlikely to recognize song by the same coincidence mechanism. However, the “mother network” hypothesis does not imply that all crickets implement a coincidence detection algorithm, just that they reuse the same neurons with largely conserved response properties. In fact, our analyses have shown that through changes in key parameters, coincidence detection can be circumvented to produce a different preference type (Figure 6, Figure 4—figure supplement 1). That is why further electrophysiological experiments in G. bimaculatus are crucial to reveal the precise biophysical mechanisms that tune the network and ultimately link changes in gene expression, for instance, of specific ion channels, to changes in network tuning. Importantly, these experiments need to be extended to other species, by identifying and characterizing homologues of the neurons in the network. Recordings in other species are challenging but feasible, since homologous neurons are expected to be found in similar locations in the brain. Our model produces testable predictions based on the known behavioral tuning for how key properties of these neurons may look like in any given species (see below).”</p><disp-quote content-type="editor-comment"><p>7) Authors briefly mention various song preference patterns across species. It would be great to see specific examples of song patterns for a few species along with matching model tuning, e.g. in a supplemental figure, possibly together behavioral date / response diagrams.</p></disp-quote><p>We agree that an interesting next step would be to compare the model fitted to different species. We now show example response fields from three different species of crickets in Figure 1B and our analyses of the randomized models shows that the network can produce preferences for the pulse durations and pauses found in crickets (Figures 4B, C). However, as mentioned in Results, the preferred pulse-pause combination of the network is insufficient to describe the phenotype. Fitting the networks to the full response fields known from other species would be a large amount of work and is beyond the scope of the current, already quite long paper.</p><disp-quote content-type="editor-comment"><p>8) The core result on multi-species covered in Figure 4 and text indicates all four &quot;principal types&quot; of response fields can be achieved by the model with reference to Figure 1B. Where does Figure 1B come from? Are we looking at sketches? Or behavioral response fields measured in crickets? Please make this clear and give references to the underlying data. Clemens and Hennig 2013 and Hennig et al., 2014 do not show these graphs. Ideally, the authors can reproduce exemplary experimental data from diverse cricket species for illustration.</p></disp-quote><p>This is now addressed in ‘Essential Revisions #2’.</p><p>Figure 1B now shows response fields measured from crickets.</p></body></sub-article></article>