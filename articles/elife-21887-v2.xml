<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">21887</article-id><article-id pub-id-type="doi">10.7554/eLife.21887</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Genomics and Evolutionary Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Microbiology and Infectious Disease</subject></subj-group></article-categories><title-group><article-title>A phylogenetic transform enhances analysis of compositional microbiota data</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-68967"><name><surname>Silverman</surname><given-names>Justin D</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3063-2098</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-71349"><name><surname>Washburne</surname><given-names>Alex D</given-names></name><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-71350"><name><surname>Mukherjee</surname><given-names>Sayan</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="aff" rid="aff7">7</xref><xref ref-type="aff" rid="aff8">8</xref><xref ref-type="aff" rid="aff9">9</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-27291"><name><surname>David</surname><given-names>Lawrence A</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3570-4767</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff10">10</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-3"/><xref ref-type="other" rid="par-4"/><xref ref-type="other" rid="par-5"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution content-type="dept">Program in Computational Biology and Bioinformatics</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff2"><label>2</label><institution content-type="dept">Medical Scientist Training Program</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff3"><label>3</label><institution content-type="dept">Center for Genomic and Computational Biology</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff4"><label>4</label><institution content-type="dept">Nicholas School of the Environment</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff5"><label>5</label><institution content-type="dept">Cooperative Institute for Research in Environmental Sciences (CIRES)</institution>, <institution>University of Colorado</institution>, <addr-line><named-content content-type="city">Boulder</named-content></addr-line>, <country>United States</country></aff><aff id="aff6"><label>6</label><institution content-type="dept">Department of Statistical Science</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff7"><label>7</label><institution content-type="dept">Department of Mathematics</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff8"><label>8</label><institution content-type="dept">Department of Biostatistics and Bioinformatics</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff9"><label>9</label><institution content-type="dept">Department of Computer Science</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff><aff id="aff10"><label>10</label><institution content-type="dept">Department of Molecular Genetics and Microbiology</institution>, <institution>Duke University</institution>, <addr-line><named-content content-type="city">Durham</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Fodor</surname><given-names>Anthony</given-names></name><role>Reviewing editor</role><aff id="aff11"><institution>University of North Carolina at Charlotte</institution></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>lawrence.david@duke.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>15</day><month>02</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>6</volume><elocation-id>e21887</elocation-id><history><date date-type="received"><day>27</day><month>09</month><year>2016</year></date><date date-type="accepted"><day>13</day><month>02</month><year>2017</year></date></history><permissions><copyright-statement>© 2017, Silverman et al</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Silverman et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-21887-v2.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.21887.001</object-id><p>Surveys of microbial communities (microbiota), typically measured as relative abundance of species, have illustrated the importance of these communities in human health and disease. Yet, statistical artifacts commonly plague the analysis of relative abundance data. Here, we introduce the PhILR transform, which incorporates microbial evolutionary models with the isometric log-ratio transform to allow off-the-shelf statistical tools to be safely applied to microbiota surveys. We demonstrate that analyses of community-level structure can be applied to PhILR transformed data with performance on benchmarks rivaling or surpassing standard tools. Additionally, by decomposing distance in the PhILR transformed space, we identified neighboring clades that may have adapted to distinct human body sites. Decomposing variance revealed that covariation of bacterial clades within human body sites increases with phylogenetic relatedness. Together, these findings illustrate how the PhILR transform combines statistical and phylogenetic models to overcome compositional data challenges and enable evolutionary insights relevant to microbial communities.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.001">http://dx.doi.org/10.7554/eLife.21887.001</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>metagenomics</kwd><kwd>compositional data</kwd><kwd>Phylogenetics</kwd><kwd>microbiome</kwd><kwd>microbial evolution</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IIS 1546331</award-id><principal-award-recipient><name><surname>Mukherjee</surname><given-names>Sayan</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>IIS 1418261</award-id><principal-award-recipient><name><surname>Mukherjee</surname><given-names>Sayan</given-names></name></principal-award-recipient></award-group><award-group id="par-3"><funding-source><institution-wrap><institution>Global Probiotics Council</institution></institution-wrap></funding-source><award-id>Young Investigator Grant for Probiotics Research</award-id><principal-award-recipient><name><surname>David</surname><given-names>Lawrence A</given-names></name></principal-award-recipient></award-group><award-group id="par-4"><funding-source><institution-wrap><institution>Searle Scholars Program</institution></institution-wrap></funding-source><award-id>15-SSP-184 Research Agreement</award-id><principal-award-recipient><name><surname>David</surname><given-names>Lawrence A</given-names></name></principal-award-recipient></award-group><award-group id="par-5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id><institution>Alfred P. Sloan Foundation</institution></institution-wrap></funding-source><award-id>BR2014-003</award-id><principal-award-recipient><name><surname>David</surname><given-names>Lawrence A</given-names></name></principal-award-recipient></award-group><award-group id="par-6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100006510</institution-id><institution>Duke University</institution></institution-wrap></funding-source><award-id>Medical Scientist Training Program GM007171</award-id><principal-award-recipient><name><surname>Silverman</surname><given-names>Justin D</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>The PhILR transform uses an evolutionary model to overcome statistical challenges associated with microbiota surveys.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Microbiota research today embodies the data-rich nature of modern biology. Advances in high-throughput DNA sequencing allow for rapid and affordable surveys of thousands of bacterial taxa across hundreds of samples (<xref ref-type="bibr" rid="bib9">Caporaso et al., 2011</xref>). The exploding availability of sequencing data has poised microbiota research to advance our understanding of fields as diverse as ecology, evolution, medicine, and agriculture (<xref ref-type="bibr" rid="bib68">Waldor et al., 2015</xref>). Considerable effort now focuses on interrogating microbiota datasets to identify relationships between bacterial taxa, as well as between microbes and their environment.</p><p>Increasingly, it is appreciated that the relative nature of microbial abundance data in microbiota studies can lead to spurious statistical analyses (<xref ref-type="bibr" rid="bib30">Jackson, 1997</xref>; <xref ref-type="bibr" rid="bib22">Friedman and Alm, 2012</xref>; <xref ref-type="bibr" rid="bib2">Aitchison, 1986</xref>; <xref ref-type="bibr" rid="bib41">Lovell et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Gloor et al., 2016a</xref>; <xref ref-type="bibr" rid="bib8">Britanova et al., 2014</xref>; <xref ref-type="bibr" rid="bib39">Li, 2015</xref>; <xref ref-type="bibr" rid="bib65">Tsilimigras and Fodor, 2016</xref>). With next generation sequencing, the number of reads per sample can vary independently of microbial load (<xref ref-type="bibr" rid="bib41">Lovell et al., 2011</xref>; <xref ref-type="bibr" rid="bib65">Tsilimigras and Fodor, 2016</xref>). In order to make measurements comparable across samples, most studies therefore analyze the relative abundance of bacterial taxa. Analyses are thus not carried out on absolute abundances of community members (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), but rather on relative data occupying a constrained geometric space and represented in a non-Cartesian coordinate system (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). Such relative abundance datasets are often termed compositional. The use of most standard statistical tools (<italic>e.g.,</italic> correlation, regression, or classification) within a compositional space leads to spurious results (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). For example, three-quarters of the significant bacterial interactions inferred by Pearson correlation on a compositional human microbiota dataset were likely false (<xref ref-type="bibr" rid="bib22">Friedman and Alm, 2012</xref>), and over two-thirds of differentially abundant taxa inferred by a t-test on a simulated compositional human microbiota dataset were spurious (<xref ref-type="bibr" rid="bib45">Mandal et al., 2015</xref>). To account for compositional effects in microbial datasets, bioinformatics efforts have re-derived common statistical methods including correlation statistics (<xref ref-type="bibr" rid="bib22">Friedman and Alm, 2012</xref>; <xref ref-type="bibr" rid="bib18">Fang et al., 2015</xref>), hypothesis testing (<xref ref-type="bibr" rid="bib34">La Rosa et al., 2012</xref>), and variable selection (<xref ref-type="bibr" rid="bib11">Chen and Li, 2013</xref>; <xref ref-type="bibr" rid="bib40">Lin et al., 2014</xref>).<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.21887.002</object-id><label>Figure 1.</label><caption><title>PhILR uses an evolutionary tree to transform microbiota data into an unconstrained coordinate system.</title><p>(<bold>A</bold>) Two hypothetical bacterial communities share identical absolute numbers of <italic>Lactobacillus</italic>, and <italic>Ruminococcus</italic> bacteria; they differ only in the absolute abundance of <italic>Bacteroides</italic> which is higher in community A (red circle) compared to community B (blue diamond). (<bold>B</bold>) A ternary plot depicts proportional data typically analyzed in a sequencing-based microbiota survey. Note that viewed in terms of proportions the space is constrained and the axes are not Cartesian. As a result, all three genera have changed in relative abundance between the two communities. (<bold>C</bold>) Schematic of the PhILR transform based on a phylogenetic sequential binary partition. The PhILR coordinates can be viewed as ‘balances’ between the weights (relative abundances) of the two subclades of a given internal node. In community B, the greater abundance of <italic>Bacteroides</italic> tips the balance <inline-formula><mml:math id="inf1"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> to the right. (<bold>D</bold>) The PhILR transform can be viewed as a new coordinate system (grey dashed lines) in the proportional data space. (<bold>E</bold>) The data transformed to the PhILR space. Note that in contrast to the raw proportional data (<bold>B</bold>), the PhILR space only shows a change in the variable associated with <italic>Bacteroides</italic>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.002">http://dx.doi.org/10.7554/eLife.21887.002</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig1-v2"/></fig></p><p>An alternative approach is to transform compositional microbiota data to a space where existing statistical methods may be applied without introducing spurious conclusions. This approach is attractive because of its efficiency: the vast toolbox of existing statistical models can be applied without re-derivation. Normalization methods, for example, have been proposed to modify count data by assuming reads follow certain statistical distributions (<italic>e.g.,</italic> negative binomial) (<xref ref-type="bibr" rid="bib56">Paulson et al., 2013</xref>; <xref ref-type="bibr" rid="bib3">Anders and Huber, 2010</xref>). Alternatively, the field of Compositional Data Analysis (CoDA) has focused on formalizing methods for transforming compositional data into a simpler geometry without having to assume data adhere to a distribution model (<xref ref-type="bibr" rid="bib4">Bacon-Shone, 2011</xref>). Previous microbiota analyses have already leveraged CoDA theory and used the centered log-ratio transform to reconstruct microbial association networks and interactions (<xref ref-type="bibr" rid="bib33">Kurtz et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Lee et al., 2014</xref>) and to analyze differential abundances (<xref ref-type="bibr" rid="bib20">Fernandes et al., 2014</xref>; <xref ref-type="bibr" rid="bib25">Gloor et al., 2016b</xref>). However, the centered log-ratio transform has a crucial limitation: it yields a coordinate system featuring a singular covariance matrix and is thus unsuitable for many common statistical models (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). This drawback can be sidestepped using another CoDA transform, known as the Isometric Log-Ratio (ILR) transformation (<xref ref-type="bibr" rid="bib15">Egozcue et al., 2003</xref>). The ILR transform can be built from a sequential binary partition of the original variable space (<xref ref-type="fig" rid="fig1">Figure 1C</xref>), creating a new coordinate system with an orthonormal basis (<xref ref-type="fig" rid="fig1">Figure 1D and E</xref>) (<xref ref-type="bibr" rid="bib16">Egozcue and Pawlowsky-Glahn, 2005</xref>). However, a known obstacle to using the ILR transform is the choice of partition such that the resulting coordinates are meaningful (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). To date, microbiota studies have chosen ILR coordinates using ad hoc sequential binary partitions of bacterial groups that are not easily interpreted (<xref ref-type="bibr" rid="bib21">Finucane et al., 2014</xref>; <xref ref-type="bibr" rid="bib38">Lê Cao et al., 2016</xref>). Alternatively, external covariates have been used to pick groups of bacterial taxa to contrast (<xref ref-type="bibr" rid="bib54">Morton et al., 2017</xref>).</p><p>Here, we introduce the bacterial phylogenetic tree as a natural and informative sequential binary partition when applying the ILR transform to microbiota datasets (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). Using phylogenies to construct the ILR transform results in an ILR coordinate system capturing evolutionary relationships between neighboring bacterial groups (clades). Analyses of neighboring clades offer the opportunity for biological insight: clade analyses have linked genetic differentiation to ecological adaptation (<xref ref-type="bibr" rid="bib29">Hunt et al., 2008</xref>), and the relative levels of sister bacterial genera differentiate human cohorts by diet, geography, and culture (<xref ref-type="bibr" rid="bib14">De Filippo et al., 2010</xref>; <xref ref-type="bibr" rid="bib69">Wu et al., 2011</xref>; <xref ref-type="bibr" rid="bib70">Yatsunenko et al., 2012</xref>). Datasets analyzed by a phylogenetically aware ILR transform could therefore reveal ecological and evolutionary factors shaping host-associated microbial communities.</p><p>We term our approach the <bold>Ph</bold>ylogenetic <bold>ILR</bold> (PhILR) transform. Using published environmental and human-associated 16S rRNA datasets as benchmarks, we found that simple Euclidean distances calculated on PhILR transformed data provided a compositionally robust alternative to distance/dissimilarity measures like Bray-Curtis, Jaccard, and Unifrac. In addition, we observed that the accuracy of supervised classification methods on our benchmark datasets was matched or improved with PhILR transformed data relative to applying the same models on untransformed (raw) or log transformed relative abundance data. Decomposing distances between samples along PhILR coordinates identified bacterial clades that may have differentiated to adapt to distinct body sites. Similar decomposition of variance along PhILR coordinates showed that, in all human body sites studied, the degree to which neighboring bacterial clades covary tends to increase with the phylogenetic relatedness between clades. Together, these findings demonstrate that the PhILR transform can be used to enhance existing microbiota analysis pipelines, as well as enable novel phylogenetic analyses of microbial ecosystems.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Constructing the PhILR transform</title><p>The PhILR transform has two goals. The first goal is to transform input microbiota data into an unconstrained space with an orthogonal basis while preserving all information contained in the original composition. The second goal is to conduct this transform using phylogenetic information. To achieve these dual goals on a given set of <inline-formula><mml:math id="inf2"><mml:mi>N</mml:mi></mml:math></inline-formula> samples consisting of relative measurements of <inline-formula><mml:math id="inf3"><mml:mi>D</mml:mi></mml:math></inline-formula> taxa (<xref ref-type="fig" rid="fig1">Figure 1B</xref>), we transform data into a new space of <inline-formula><mml:math id="inf4"><mml:mi>N</mml:mi></mml:math></inline-formula> samples and <inline-formula><mml:math id="inf5"><mml:mrow><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> coordinates termed ‘balances’ (<xref ref-type="fig" rid="fig1">Figure 1C–E</xref>) (<xref ref-type="bibr" rid="bib15">Egozcue et al., 2003</xref>; <xref ref-type="bibr" rid="bib16">Egozcue and Pawlowsky-Glahn, 2005</xref>). Each balance <inline-formula><mml:math id="inf6"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is associated with a single internal node <inline-formula><mml:math id="inf7"><mml:mi>i</mml:mi></mml:math></inline-formula> of a phylogenetic tree with the <inline-formula><mml:math id="inf8"><mml:mrow><mml:mi>D</mml:mi> <mml:mo/></mml:mrow></mml:math></inline-formula> taxa as leaves (the asterisk denotes a quantity represented in PhILR space). The balance represents the log-ratio of the geometric mean relative abundance of the two clades of taxa that descend from <inline-formula><mml:math id="inf9"><mml:mi>i</mml:mi></mml:math></inline-formula> (Materials and methods). Although individual balances may share overlapping sets of leaves and thus exhibit dependent behavior, the ILR transform rescales and combines leaves to form a coordinate system whose basis vectors are orthonormal and the corresponding coordinates are Cartesian (<xref ref-type="bibr" rid="bib15">Egozcue et al., 2003</xref>; <xref ref-type="bibr" rid="bib16">Egozcue and Pawlowsky-Glahn, 2005</xref>). The orthogonality of basis vectors allows conventional statistical tools to be used without compositional artifacts. The unit-length of basis vectors makes balances across the tree statistically comparable even when they have differing numbers of descendant tips or exist at different depths in the tree (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). In addition, the unit-length ensures that the variance of PhILR balances has a consistent scale, unlike the variance of log-ratios originally proposed by Aitchison (<xref ref-type="bibr" rid="bib2">Aitchison, 1986</xref>) as a measure of association, in which it can be unclear what constitutes a large or small variance (<xref ref-type="bibr" rid="bib22">Friedman and Alm, 2012</xref>).</p><p>While the above description represents the core of the PhILR transform, we have also equipped the PhILR transform with two sets of weights that can: (1) address the multitude of zero and near-zero counts present in microbiota data; and, (2) incorporate phylogenetic branch lengths into the transformed space. Because zero counts cause problems when computing logs or performing division, zeros are often replaced in microbiota analyses with small non-zero counts. However, to avoid excess zero replacement that may itself introduce bias, stringent hard filtering thresholds are often employed (<italic>e.g</italic>. removing all taxa that are not seen with at least a minimum number of counts in a subset of samples). Still, hard filtering thresholds may remove a substantial fraction of observed taxa and do not account for the low precision (or high variability) of near-zero counts (<xref ref-type="bibr" rid="bib24">Gloor et al., 2016a</xref>; <xref ref-type="bibr" rid="bib26">Good, 1956</xref>; <xref ref-type="bibr" rid="bib52">McMurdie and Holmes, 2014</xref>). We therefore developed a ‘taxon weighting’ scheme that acts as a type of soft-thresholding, supplementing zero replacement methods with a generalized form of the ILR transform that allows weights to be attached to individual taxa (<xref ref-type="bibr" rid="bib17">Egozcue and Pawlowsky-Glahn, 2016</xref>). Weights are chosen with a heuristic designed to down weight the influence of taxa with many zero or near-zero counts (Materials and methods).</p><p>Our second weighting scheme is called branch length weighting. Certain analyses may benefit from incorporating information on evolutionary distances between taxa (<xref ref-type="bibr" rid="bib43">Lozupone and Knight, 2005</xref>; <xref ref-type="bibr" rid="bib23">Fukuyama et al., 2012</xref>; <xref ref-type="bibr" rid="bib60">Purdom, 2011</xref>). For example, because related bacteria may be more likely to share similar traits (<xref ref-type="bibr" rid="bib48">Martiny et al., 2015</xref>), it may be desirable to consider communities differing only in the abundance of closely-related microbes to be more similar than communities differing only in the abundance of distantly-related microbes. Because of the one-to-one correspondence between PhILR balances and internal nodes on the phylogenetic tree, evolutionary information can be incorporated into the PhILR transform by scaling balances using the phylogenetic distance between their direct descendants (Materials and methods). We note that we employ both branch length weighting and taxon weighting throughout our following analyses except where noted; still, these weights should be considered optional additions to the core PhILR transform.</p></sec><sec id="s2-2"><title>Benchmarking community-level analyses in the PhILR coordinate system</title><p>To illustrate how the PhILR transform can be used to perform standard community-level analyses of microbiota datasets, we first examined measures of community dissimilarity. Microbiota analyses commonly compute the dissimilarity or distance between pairs of samples and use these computed pairwise distances as input to a variety of statistical tools. We investigated how Euclidean distances calculated on PhILR transformed data compared to common ecological measures of microbiota distance or dissimilarity (UniFrac, Bray-Curtis, and Jaccard) as well as Euclidean distance applied to raw relative abundance data in standard distance-based analysis. We chose three different microbiota surveys as reference datasets: Costello Skin Sites (CSS), a dataset of 357 samples from 12 human skin sites (<xref ref-type="bibr" rid="bib12">Costello et al., 2009</xref>; <xref ref-type="bibr" rid="bib32">Knights et al., 2011</xref>); Human Microbiome Project (HMP), a dataset of 4743 samples from 18 human body sites (<italic>e.g</italic>., skin, vaginal, oral, and stool) (<xref ref-type="bibr" rid="bib28">Human Microbiome Project Consortium, 2012</xref>); and, Global Patterns (GP), a dataset of 26 samples from nine human or environmental sites (<xref ref-type="bibr" rid="bib9">Caporaso et al., 2011</xref>) (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>).</p><p>Distance-based analyses using Euclidean distances computed on PhILR transformed data exhibited performance rivaling common ecological distance or dissimilarity measures. Principal coordinate analyses (PCoA) qualitatively demonstrated separation of body sites using both Euclidean distances on PhILR transformed data (<xref ref-type="fig" rid="fig2">Figure 2A</xref>) and with several standard distance measures calculated on raw relative abundance data (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>). To quantitatively compare distance measures, we tested how well habitat information explained variability among distance matrices as measured by the R<sup>2</sup> statistic from PERMANOVA (<xref ref-type="bibr" rid="bib10">Chen et al., 2012</xref>). By this metric, the Euclidean distance in the PhILR coordinate system significantly outperformed the five competing distance metrics in all but one case (in comparison to Weighted UniFrac when applied to the HMP dataset; <xref ref-type="fig" rid="fig2">Figure 2B</xref>).<fig-group><fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.21887.003</object-id><label>Figure 2.</label><caption><title>Performance of standard statistical models on PhILR transformed microbiota data.</title><p>Benchmarks were performed using three datasets: Costello Skin Sites (CSS), Global Patterns (GP), Human Microbiome Project (HMP) (a summary of these datasets after preprocessing is shown in <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref> and <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). (<bold>A</bold>) Sample distance visualized using principal coordinate analysis (PCoA) of Euclidean distances computed in PhILR coordinate system. A comparison to PCoAs calculated with other distance measures is shown in <xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>. (<bold>B</bold>) Sample distance (or dissimilarity) was computed by a range of statistics. PERMANOVA R<sup>2</sup> values, which represent how well sample identity explained the variability in sample pairwise distances, were used as a performance metric. Distances in the PhILR transformed space were calculated using Euclidean distance. Distances between samples on raw relative abundance data were computed using Weighted and Unweighted UniFrac (WUnifrac and Unifrac, respectively), Bray-Curtis, Binary Jaccard, and Euclidean distance. Error bars represent standard error measurements from 100 bootstrap replicates and (*) denotes a p-value of ≤0.01 after FDR correction of pairwise tests against PhILR. (<bold>C</bold>) Accuracy of supervised classification methods tested on benchmark datasets. Error bars represent standard error measurements from 10 test/train splits and (*) denotes a p-value of ≤0.01 after FDR correction of all pairwise tests.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.003">http://dx.doi.org/10.7554/eLife.21887.003</ext-link></p><p><supplementary-material id="SD1-data"><object-id pub-id-type="doi">10.7554/eLife.21887.004</object-id><label>Figure 2—source data 1.</label><caption><title>Source data for <xref ref-type="fig" rid="fig2">Figure 2b and c</xref> as well as FDR corrected p-values from tests.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.004">http://dx.doi.org/10.7554/eLife.21887.004</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-21887-fig2-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig2-v2"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.005</object-id><label>Figure 2—figure supplement 1.</label><caption><title>Taxa weighting scheme tends to assign smaller weights to taxa with more zero and near zero counts.</title><p>The weight of a given taxon is calculated as the geometric mean of its counts across all samples times the Euclidean norm of its relative abundance across all samples in the dataset (Materials and methods). Data are plotted on a log scale with a pseudocount of 1 added to ease visualization.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.005">http://dx.doi.org/10.7554/eLife.21887.005</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig2-figsupp1-v2"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.006</object-id><label>Figure 2—figure supplement 2.</label><caption><title>Principal coordinate analyses using different measures of community distance or dissimilarity.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.006">http://dx.doi.org/10.7554/eLife.21887.006</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig2-figsupp2-v2"/></fig></fig-group></p><p>Next, we tested the performance of predictive statistical models in the PhILR coordinate system. We examined four standard supervised classification techniques: logistic regression (LR), support vector machines (SVM), k-nearest neighbors (kNN), and random forests (RF) (<xref ref-type="bibr" rid="bib32">Knights et al., 2011</xref>). We applied these methods to the same three reference datasets used in our comparison of distance metrics. As a baseline, the machine learning methods were applied to raw relative abundance datasets and raw relative abundance data that had been log-transformed.</p><p>The PhILR transform significantly improved supervised classification accuracy in 7 of the 12 benchmark tasks compared to raw relative abundances (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Accuracy improved by more than 90% in two benchmarks (SVM on HMP and GP), relative to results on the raw data. Log transformation of the data also improved classifier accuracy significantly on 6 of the 12 benchmarks but also significantly underperformed on one benchmark compared to raw relative abundances. In addition, the PhILR transform significantly improved classification accuracy in 5 of the 12 benchmarks relative to the log transform. Overall, the PhILR transform often outperformed the raw and log transformed relative abundances with respect to classification accuracy and was never significantly worse.</p></sec><sec id="s2-3"><title>Identifying neighboring clades that differ by body site preference</title><p>While our benchmarking experiments demonstrated how PhILR transformed data performed in community-level analyses, we also wanted to explore potential biological insights afforded by the PhILR coordinate system. We therefore investigated how distances decomposed along PhILR balances using a sparse logistic regression model to examine which balances distinguished human body site microbiota in the HMP dataset. Such balances could be used to identify neighboring bacterial clades whose relative abundances capture community-level differences between body site microbiota. Microbial genetic differentiation may be associated with specialization to new resources or lifestyle preferences (<xref ref-type="bibr" rid="bib29">Hunt et al., 2008</xref>), meaning that distinguishing balances near the tips of the bacterial tree may correspond to clades adapting to human body site environments.</p><p>We identified dozens of highly discriminatory balances, which were spread across the bacterial phylogeny (<xref ref-type="fig" rid="fig3">Figure 3A</xref> and <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Some discriminatory balances were found deep in the tree. Abundances of the Firmicutes, Bacteroidetes, and Proteobacteria relative to the Actinobacteria, Fusobacteria, and members of other phyla, separated skin body sites from oral and stool sites (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). Levels of the genus <italic>Bacteroides</italic> relative to the genus <italic>Prevotella</italic> differentiated stool microbiota from other communities on the body (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). Notably, values of select balances below the genus level also varied by body site. Relative levels of sister <italic>Corynebacterium</italic> species separated human skin sites from gingival sites (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Species-level balances even differentiated sites in nearby habitats; levels of sister <italic>Streptococcus</italic> species or sister <italic>Actinomyces</italic> species vary depending on specific oral sites (<xref ref-type="fig" rid="fig3">Figure 3E and F</xref>). These results show that the decomposition of distances between groups of samples along PhILR balances can be used to highlight ancestral balances that distinguish body site microbiota, as well as to identify more recent balances that may separate species that have adapted to inhabit different body sites.<fig-group><fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.21887.007</object-id><label>Figure 3.</label><caption><title>Balances distinguishing human microbiota by body site.</title><p>Sparse logistic regression was used to identify balances that best separated the different sampling sites (full list of balances provided in <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). (<bold>A</bold>) Each balance is represented on the tree as a broken grey bar. The left portion of the bar identifies the clade in the denominator of the log-ratio, and the right portion identifies the clade in the numerator of the log-ratio. The branch leading from the Firmicutes to the Bacteroidetes has been rescaled to facilitate visualization. (<bold>B–F</bold>) The distribution of balance values across body sites. Vertical lines indicate median values, boxes represent interquartile ranges (IQR) and whiskers extend to 1.5 IQR on either side of the median. Balances between: (<bold>B</bold>) the phyla Actinobacteria and Fusobacteria versus the phyla Bacteroidetes, Firmicutes, and Proteobacteria distinguish stool and oral sites from skin sites; (<bold>C</bold>) <italic>Prevotella spp.</italic> and <italic>Bacteroides spp.</italic> distinguish stool from oral sites; (<bold>D</bold>) <italic>Corynebacterium spp.</italic> distinguish skin and oral sites; (<bold>E</bold>) <italic>Streptococcus spp</italic>. distinguish oral sites; and, (<bold>F</bold>) <italic>Actinomyces spp.</italic> distinguish oral plaques from other oral sites. (†) Includes Bacteroidetes, Firmicutes, Alpha-, Beta-, and Gamma-proteobacteria. (‡) Includes Actinobacteria, Fusobacteria, Epsilon-proteobacteria, Spirochaetes, and Verrucomicrobia.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.007">http://dx.doi.org/10.7554/eLife.21887.007</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig3-v2"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.008</object-id><label>Figure 3—figure supplement 1.</label><caption><title>Balances found to distinguish human body sites by sparse logistic regression.</title><p>Taxa are listed in balance <italic>numerator/denominator</italic> format.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.008">http://dx.doi.org/10.7554/eLife.21887.008</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig3-figsupp1-v2"/></fig></fig-group></p></sec><sec id="s2-4"><title>Balance variance and microbiota assembly</title><p>As a natural extension of our analysis of how distance decomposes along PhILR balances, we next investigated how balance variance decomposed in the PhILR coordinate system. Balance variance is a measure of association between neighboring bacterial clades. When the variance of a balance between two clades approaches zero, the mean abundance of taxa in each of the two clades will be linearly related and thus covary across microbial habitats (<xref ref-type="bibr" rid="bib42">Lovell et al., 2015</xref>). By contrast, when a balance exhibits high variance, related bacterial clades exhibit unlinked or exclusionary patterns across samples. Unlike standard measures of association (<italic>e.g.,</italic> Pearson correlation) balance variance is robust to compositional effects (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>).</p><p>Our preliminary investigation demonstrated a striking pattern in which balance variance decreased for balances closer to the tips of the phylogeny and increased for balances nearer to the root. To determine if this observed pattern was not the result of technical artifact, we took the following three steps. First, we omitted branch length weights from the transform as we anticipated that branch lengths may vary non-randomly as a function of depth in the phylogeny. Second, we anticipated that balances near the tips of the phylogeny would be associated with fewer read counts and thus would be more biased by our chosen heuristics for taxon weighting and zero replacement. We therefore omitted taxon weighting, employed more stringent filtering thresholds, and conditioned our calculation of balance variance on non-zero counts rather than using zero-replacement (Materials and methods). Third, we combined regression and a permutation scheme to test the null hypothesis that the degree to which neighboring clades covary is independent of the phylogenetic distance between them (Materials and methods). By permuting tip labels on the tree, our test generates a restricted subset of random sequential binary partitions that still maintains the count variability (and potential biases due to our zero handling methods) of the observed data.</p><p>With our modified PhILR analysis in place, we observed significantly decreasing balance variances near the tips of the phylogenetic tree for all body sites in the HMP dataset (p&lt;0.01, permutation test with FDR correction; <xref ref-type="fig" rid="fig4">Figure 4A–F</xref> and <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplements 1</xref>–<xref ref-type="fig" rid="fig4s2">2</xref>). Low variance balances predominated near the leaves of the tree. Examples of such balances involved <italic>B. fragilis</italic> species in stool (<xref ref-type="fig" rid="fig4">Figure 4H</xref>), <italic>Rothia mucilaginosa</italic> species in the buccal mucosa (<xref ref-type="fig" rid="fig4">Figure 4J</xref>), and <italic>Lactobacillus</italic> species in the mid-vagina (<xref ref-type="fig" rid="fig4">Figure 4L</xref>). By contrast, higher variance balances tended to be more basal on the tree. Three examples of high variance balances corresponded with clades at the order (<xref ref-type="fig" rid="fig4">Figure 4G</xref>), family (<xref ref-type="fig" rid="fig4">Figure 4I</xref>), and genus (<xref ref-type="fig" rid="fig4">Figure 4K</xref>) levels. We also observed that the relationship between balance variance and phylogenetic depth varied at different taxonomic scales. LOESS regression revealed that trends between variance and phylogenetic depth were stronger above the species level than below it (Materials and methods; <xref ref-type="fig" rid="fig4">Figure 4D–F</xref> and <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). Overall, the observed pattern of decreasing balance variance near the tips of the phylogenetic tree suggested that closely related bacteria tend to covary in human body sites.<fig-group><fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.21887.009</object-id><label>Figure 4.</label><caption><title>Neighboring clades covary less with increasing phylogenetic depth.</title><p>The variance of balance values captures the degree to which neighboring clades covary, with smaller balance variances representing sister clades that covary more strongly (<xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). (<bold>A–C</bold>) Balance variances were computed among samples from stool (<bold>A</bold>), buccal mucosa (<bold>B</bold>), and the mid-vagina (<bold>C</bold>). Red branches indicate small balance variance and blue branches indicate high balance variance. Balances 1–6 are individually tracked in panels (<bold>D–L</bold>). (<bold>D–F</bold>) Balance variances within each body site increased linearly with increasing phylogenetic depth on a log-scale (blue line; p&lt;0.01, permutation test with FDR correction; <italic>Methods</italic>). Significant trends are seen across all other body sites (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplements 2</xref> and <xref ref-type="fig" rid="fig4s3">3</xref>). Non-parametric LOESS regression (green line and corresponding 95% confidence interval) reveals an inflection point in the relation between phylogenetic depth and balance variance. This inflection point appears below the estimated species level (‘s’ dotted line; the median depth beyond which balances no longer involve leaves sharing the same species assignment; Materials and methods). (<bold>G–L</bold>) Examples of balances with high and low variance from panels (<bold>A–F</bold>). Low balance variances (<bold>H, J, L</bold>) reflect a linear relationship between the geometric means of sister clades abundances. High balance variances (<bold>G, I, K</bold>) reflect either unlinked or exclusionary dynamics between the geometric means of sister clades abundances.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.009">http://dx.doi.org/10.7554/eLife.21887.009</ext-link></p><p><supplementary-material id="SD2-data"><object-id pub-id-type="doi">10.7554/eLife.21887.010</object-id><label>Figure 4—source code 1.</label><caption><title>Source code for <xref ref-type="fig" rid="fig4">Figure 4</xref> and associated supplements.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.010">http://dx.doi.org/10.7554/eLife.21887.010</ext-link></p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-21887-fig4-code1-v2.zip"/></supplementary-material></p><p><supplementary-material id="SD3-data"><object-id pub-id-type="doi">10.7554/eLife.21887.011</object-id><label>Figure 4—source data 1.</label><caption><title>FDR corrected p-values from permutation tests.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.011">http://dx.doi.org/10.7554/eLife.21887.011</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-21887-fig4-data1-v2.xlsx"/></supplementary-material></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig4-v2"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.012</object-id><label>Figure 4—figure supplement 1.</label><caption><title>Balances with high and low variance.</title><p>Shown are the 10 highest and the 10 lowest variance balances for the Stool body site in the HMP dataset. Panels 1–10: Low balance variances reflect a linear relationship (through the origin) between levels of the two clades that descend from a given balance. Panels 11–20: High balances variances lack this linear relationship.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.012">http://dx.doi.org/10.7554/eLife.21887.012</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig4-figsupp1-v2"/></fig><fig id="fig4s2" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.013</object-id><label>Figure 4—figure supplement 2.</label><caption><title>Neighboring clades covary less with increasing phylogenetic depth.</title><p>Shown here are all HMP body sites. Dotted lines indicate median species boundaries (see Materials and methods).</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.013">http://dx.doi.org/10.7554/eLife.21887.013</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig4-figsupp2-v2"/></fig><fig id="fig4s3" position="float" specific-use="child-fig"><object-id pub-id-type="doi">10.7554/eLife.21887.014</object-id><label>Figure 4—figure supplement 3.</label><caption><title>The null distribution for <inline-formula><mml:math id="inf10"><mml:mi>β</mml:mi></mml:math></inline-formula>.</title><p><inline-formula><mml:math id="inf11"><mml:mi>β</mml:mi></mml:math></inline-formula> is the slope in the linear regression between balance variance and phylogenetic depth in log space (regressions shown in <xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>). To form null distributions for <inline-formula><mml:math id="inf12"><mml:mi>β</mml:mi></mml:math></inline-formula>, tip labels on the phylogeny were shuffled (<italic>n</italic> = 20,000) and balance values re-calculated. Distributions for <inline-formula><mml:math id="inf13"><mml:mi>β</mml:mi></mml:math></inline-formula> are symmetric about 0 for each body site, suggesting.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.014">http://dx.doi.org/10.7554/eLife.21887.014</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig4-figsupp3-v2"/></fig></fig-group></p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>There exists a symbiosis between our understanding of bacterial evolution and the ecology of host-associated microbial communities (<xref ref-type="bibr" rid="bib49">Matsen, 2015</xref>). Microbiota studies have shown that mammals and bacteria cospeciated over millions of years (<xref ref-type="bibr" rid="bib53">Moeller et al., 2016</xref>; <xref ref-type="bibr" rid="bib37">Ley et al., 2008</xref>), and human gut microbes have revealed the forces driving horizontal gene transfer between bacteria (<xref ref-type="bibr" rid="bib64">Smillie et al., 2011</xref>). Evolutionary tools and theory have been used to explain how cooperation benefits members of gut microbial communities (<xref ref-type="bibr" rid="bib61">Rakoff-Nahoum et al., 2016</xref>), and raise concerns that rising rates of chronic disease are linked to microbiota disruption (<xref ref-type="bibr" rid="bib7">Blaser and Falkow, 2009</xref>). Here, we aimed to continue building links between microbiota evolution and ecology by designing a data transform that uses phylogenetic models to overcome the challenges associated with compositional data while enabling novel evolutionary analyses.</p><p>We found that the resulting PhILR coordinate system, at least with respect to the performance metrics chosen, led to significantly improved performance for a variety of community-level analyses now used in microbiota analysis. While these results add credence to our proposed approach, we underscore that we do not find it essential that PhILR demonstrates superior benchmark performance to motivate its use in microbiota analysis. We believe that the need for compositionally robust tools has already been well established (<xref ref-type="bibr" rid="bib30">Jackson, 1997</xref>; <xref ref-type="bibr" rid="bib22">Friedman and Alm, 2012</xref>; <xref ref-type="bibr" rid="bib2">Aitchison, 1986</xref>; <xref ref-type="bibr" rid="bib41">Lovell et al., 2011</xref>; <xref ref-type="bibr" rid="bib24">Gloor et al., 2016a</xref>; <xref ref-type="bibr" rid="bib39">Li, 2015</xref>; <xref ref-type="bibr" rid="bib65">Tsilimigras and Fodor, 2016</xref>) and intended these benchmarks to showcase the flexibility and utility of working with PhILR transformed data. We also note that for some analyses, a phylogeny-based ILR transform will not outperform an ILR transform built from another sequential binary partition. In fact, in the absence of branch length weights, any random ILR partition would yield equivalent results on our benchmark tasks. Instead, what distinguishes the PhILR transform from other ILR transforms is the interpretability of the transformed coordinates. Balances in PhILR space correspond to speciation events, which can be a source for biological insight.</p><p>For example, performing regression on PhILR transformed data enabled us to decompose the distance between bacterial communities onto individual locations on the phylogeny, highlighting balances near the tips of the tree that distinguished human body sites. These balances may reflect functional specialization, as ecological partitioning among recently differentiated bacterial clades could be caused by genetic adaptation to new environments or lifestyles (<xref ref-type="bibr" rid="bib29">Hunt et al., 2008</xref>). Indeed, among oral body sites, we observed consistent site specificity of neighboring bacterial clades within the genera <italic>Actinomyces</italic> (<xref ref-type="fig" rid="fig3">Figure 3F</xref>) and <italic>Streptococcus</italic> (<xref ref-type="fig" rid="fig3">Figure 3E</xref>). Species within the <italic>Actinomyces</italic> genera have been previously observed to partition by oral sites (<xref ref-type="bibr" rid="bib1">Aas et al., 2005</xref>; <xref ref-type="bibr" rid="bib44">Mager et al., 2003</xref>). Even more heterogeneity has been observed within the <italic>Streptococcus</italic> genus, where species have been identified that distinguish teeth, plaque, mucosal, tongue, saliva, and other oral sites (<xref ref-type="bibr" rid="bib1">Aas et al., 2005</xref>; <xref ref-type="bibr" rid="bib44">Mager et al., 2003</xref>). This partitioning likely reflects variation in the anatomy and resource availability across regions of the mouth (<xref ref-type="bibr" rid="bib1">Aas et al., 2005</xref>), as well as the kinds of surfaces bacterial strains can adhere to (<xref ref-type="bibr" rid="bib44">Mager et al., 2003</xref>).</p><p>We also observed evidence for potential within-genus adaptation to body sites that has not been previously reported. Within the genus <italic>Corynebacterium</italic>, we found ratios of taxa varied among oral plaques and select skin sites (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Although the genus is now appreciated as favoring moist skin environments, the roles played by individual Corynebacteria within skin microbiota remain incompletely understood (<xref ref-type="bibr" rid="bib27">Grice and Segre, 2011</xref>). Precisely linking individual <italic>Corynebacterium</italic> species or strains to body sites is beyond the scope of this study due to the limited taxonomic resolution of 16S rRNA datasets (<xref ref-type="bibr" rid="bib31">Janda and Abbott, 2007</xref>; <xref ref-type="bibr" rid="bib67">Větrovský and Baldrian, 2013</xref>). Nevertheless, we believe the PhILR coordinate system may be used in the future to identify groups of related bacterial taxa that have undergone recent functional adaptation.</p><p>Another example of how the PhILR transform can provide biological insights arose in our analysis of how human microbiota variance decomposes along individual balances. We observed that balances between more phylogenetically related clades were significantly more likely to covary than expected by chance. This pattern could reflect evolutionary and ecological forces structuring microbial communities in the human body. Related bacterial taxa have been hypothesized to have similar lifestyle characteristics (<xref ref-type="bibr" rid="bib48">Martiny et al., 2015</xref>; <xref ref-type="bibr" rid="bib73">Zaneveld et al., 2010</xref>), and may thus covary in human body sites that favor their shared traits (<xref ref-type="bibr" rid="bib36">Levy and Borenstein, 2013</xref>; <xref ref-type="bibr" rid="bib19">Faust et al., 2012</xref>). An alternative explanation for the balance variation patterns we observed is that sequencing errors and read clustering artifacts are likely to produce OTUs (Operational Taxonomic Units) with similar reference sequences and distributions across samples. While we cannot conclusively rule out this alternative hypothesis, we note that it would not explain why signal for taxa co-variation is weakest for balances at higher taxonomic levels and appears to plateau for balances near or below the species level. A biological explanation for the plateauing signal would be that lifestyle characteristics enabling bacteria to persist in human body sites are conserved among strains roughly corresponding to the same species. Follow-up studies are needed to more conclusively understand how balance variance patterns across the phylogenies can be interpreted from an evolutionary standpoint.</p><p>Though the methods presented here provide a coherent geometric framework for performing microbiota analysis free from compositional artifacts, future refinements are possible. Specifically, we highlight issues relating to our choice of weights, the handling of zero values, and information loss during count normalization. Both the taxa weights and the branch lengths weights we introduce here may be viewed as preliminary heuristics; future work will likely yield additional weighting schemes, as well as knowledge for when a given weighting scheme should be matched to an analysis task. In the case of supervised machine learning, weighting selection could be optimized as part of the training process. Additionally, if it is important that the transformed data has meaningful numerical coordinates, such that one desires to interpret the exact numerical value of a given balance in a sample, we suggest that neither branch length weights nor taxa weights be used as these weights can complicate this type of interpretation. Concerning our handling of zero values, this model design choice confronts an outstanding challenge for microbiota and compositional data analysis (<xref ref-type="bibr" rid="bib65">Tsilimigras and Fodor, 2016</xref>; <xref ref-type="bibr" rid="bib46">Martın-Fernandez et al., 2011</xref>). Part of this challenge’s difficulty is whether a zero value represents a value below the detection limit (rounded zero) or a truly absent taxon (essential zero). Here, we employ zero replacement, which implies an assumption that all zero values represent rounded zeros. New mixture models that explicitly allow for both essential and rounded zeros (<xref ref-type="bibr" rid="bib5">Bear and Billheimer, 2016</xref>), as well as more advanced methods of zero replacement (<xref ref-type="bibr" rid="bib46">Martın-Fernandez et al., 2011</xref>; <xref ref-type="bibr" rid="bib47">Martin-Fernandez et al., 2015</xref>), may enable us to handle zeros in a more sophisticated manner. Lastly, in regards to informational loss caused by normalization, it is known that the number of counts measured for a given taxon influences the precision with which we may estimate its relative abundance in a sample (<xref ref-type="bibr" rid="bib24">Gloor et al., 2016a</xref>; <xref ref-type="bibr" rid="bib26">Good, 1956</xref>; <xref ref-type="bibr" rid="bib52">McMurdie and Holmes, 2014</xref>). While our taxa weights are intended to address this idea, a fully probabilistic model of counts would likely provide more accurate error bounds for inference. We believe it would be possible to build such a model in a Bayesian framework by viewing the observed counts as multinomial draws from a point in the PhILR transformed space, as has been done for other log-ratio based spaces (<xref ref-type="bibr" rid="bib6">Billheimer et al., 2001</xref>).</p><p>Beyond refining the PhILR transform itself, future effort may also be directed towards interpreting the transform's results at the single taxon level. Microbiota studies frequently focus on individual taxa for tasks such as identifying specific bacteria that are causal or biomarkers of disease. Log-ratio approaches can provide a compositionally robust approach to identifying biomarkers based on changes in the relative abundance of individual taxa. Due to the one-to-one correspondence between CLR coordinates and individual taxa, the CLR transform has been used previously to build compositionally robust models in terms of individual taxa (<xref ref-type="bibr" rid="bib45">Mandal et al., 2015</xref>; <xref ref-type="bibr" rid="bib33">Kurtz et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Fernandes et al., 2014</xref>). However, CLR transformed data suffer from the drawback of a singular covariance matrix, which can make the development of new models based on the CLR transform difficult (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). ILR transformed data do not suffer this drawback (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>) and moreover, can be analyzed at the single taxon level. To do so, the inverse ILR transform can be applied to model results generated in an ILR coordinate system, yielding analyses in terms of changes in the relative abundance of individual taxa (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>). The use of the inverse ILR transform in this manner is well established (<xref ref-type="bibr" rid="bib58">Pawlowsky-Glahn et al., 2015</xref>; <xref ref-type="bibr" rid="bib66">van den Boogaart and Tolosana-Delgado, 2013</xref>; <xref ref-type="bibr" rid="bib57">Pawlowsky-Glahn and Buccianti, 2011</xref>) and the inverse transform is provided in the <italic>Methods</italic> (<xref ref-type="bibr" rid="bib17">Egozcue and Pawlowsky-Glahn, 2016</xref>).</p><p>Despite these avenues for improvement, modification, or extension we believe the PhILR transform already enables existing statistical methods to be applied to metagenomic datasets, free from compositional artifacts and framed according to an evolutionary perspective. We foresee the PhILR transform being used as a default transformation prior to many microbiota analyses, particularly if a phylogenetic perspective is desired. For example, the PhILR transform could be used in lieu of the conventional log transform, which is often the default choice in microbiota analysis but is not robust to compositional effects. Substituting PhILR into existing bioinformatics pipelines should often be seamless and we emphasize that all statistical tools applied to PhILR transformed data in this study were used 'off-the-shelf' and without modification. Importantly, such a substitution contrasts with the alternative approach for accounting for compositional microbiota data, which is to modify existing statistical techniques. Such modification is often challenging because many statistics were derived assuming an unconstrained space with an orthonormal basis, not a constrained and over-determined compositional space. Therefore, while select techniques have already been adapted (<italic>e.g</italic>. distance measures that incorporate phylogenetic information (<xref ref-type="bibr" rid="bib43">Lozupone and Knight, 2005</xref>) and feature selection methods that handle compositional input (<xref ref-type="bibr" rid="bib11">Chen and Li, 2013</xref>; <xref ref-type="bibr" rid="bib40">Lin et al., 2014</xref>)), it is likely that certain statistical goals, such as non-linear community forecasting or control system modeling, may prove too complex for adapting to the compositional nature of microbiota datasets. Finally, beyond microbiota surveys, we also recognize that compositional metagenomics datasets are generated when studying the ecology of viral communities (<xref ref-type="bibr" rid="bib13">Culley et al., 2006</xref>) or clonal population structure in cancer (<xref ref-type="bibr" rid="bib8">Britanova et al., 2014</xref>; <xref ref-type="bibr" rid="bib72">Yuan et al., 2015</xref>; <xref ref-type="bibr" rid="bib62">Roth et al., 2014</xref>). We expect the PhILR transform to aid other arenas of biological research where variables are measured by relative abundance and related by an evolutionary tree.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>The ILR transform</title><p>A typical microbiome sample consists of measured counts <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for taxa <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>D</mml:mi></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. A standard operation is to take count data and transform it to relative abundances. This operation is referred to as closure in compositional data analysis (<xref ref-type="bibr" rid="bib2">Aitchison, 1986</xref>) and is given by<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="fraktur">C</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents a vector of relative abundances for the <inline-formula><mml:math id="inf17"><mml:mi>D</mml:mi></mml:math></inline-formula> taxa in the sample. We can represent a binary phylogenetic tree of the <inline-formula><mml:math id="inf18"><mml:mi>D</mml:mi></mml:math></inline-formula> taxa using a sign matrix <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as introduced by Pawlowsky-Glahn and Egozcue (<xref ref-type="bibr" rid="bib59">Pawlowsky-Glahn and Egozcue, 2011</xref>) and shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>. Each row of the sign matrix indexes an internal node <inline-formula><mml:math id="inf20"><mml:mi>i</mml:mi></mml:math></inline-formula> of the tree and each column indexes a tip of the tree. A given element in the sign matrix is <inline-formula><mml:math id="inf21"><mml:mrow><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> depending on which of the two clades descending from <inline-formula><mml:math id="inf22"><mml:mi>i</mml:mi></mml:math></inline-formula> that tip is a part of and 0 if that tip is not a descendent of <inline-formula><mml:math id="inf23"><mml:mi>i</mml:mi></mml:math></inline-formula>. The assignment of <inline-formula><mml:math id="inf24"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="inf25"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> determines which clade is represented in the numerator versus the denominator of the corresponding log-ratio (as described below). Exchanging this assignment for a given balance switches which clade is represented in the numerator versus the denominator of the log-ratio. Following Egozcue and Pawlowsky-Glahn (<xref ref-type="bibr" rid="bib17">Egozcue and Pawlowsky-Glahn, 2016</xref>), we represent the ILR coordinate (balance) associated with node <inline-formula><mml:math id="inf26"><mml:mi>i</mml:mi></mml:math></inline-formula> in terms of the shifted composition <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi><mml:mo mathvariant="italic">=</mml:mo><mml:mi mathvariant="italic">x</mml:mi><mml:mrow><mml:mo mathvariant="italic">/</mml:mo></mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> as<disp-formula id="equ2"><label>(1)</label><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.21887.015</object-id><label>Figure 5.</label><caption><title>Sign matrix representation of a phylogenetic tree.</title><p>A binary tree (<bold>Left</bold>) can be represented by a sign matrix (<bold>Right</bold>) denoted <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.015">http://dx.doi.org/10.7554/eLife.21887.015</ext-link></p></caption><graphic mime-subtype="postscript" mimetype="application" xlink:href="elife-21887-fig5-v2"/></fig></p><p>Here, <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the weighted geometric mean of the components of <inline-formula><mml:math id="inf31"><mml:mi>y</mml:mi></mml:math></inline-formula> that represent tips in the <inline-formula><mml:math id="inf32"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf33"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clade descendant from node <inline-formula><mml:math id="inf34"><mml:mi>i</mml:mi></mml:math></inline-formula> respectively. This weighted geometric mean is given by<disp-formula id="equ3"><label>(2)</label><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf35"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the weight assigned to taxa <inline-formula><mml:math id="inf36"><mml:mi>j</mml:mi></mml:math></inline-formula>. The term <inline-formula><mml:math id="inf37"><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="equ2">equation 1</xref> is the scaling term that ensures that the ILR basis element has unit length and the terms <inline-formula><mml:math id="inf38"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> are given by<disp-formula id="equ4"><label>(3)</label><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>±</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that when <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi><mml:mo mathvariant="italic">=</mml:mo><mml:mi mathvariant="italic">x</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ2">Equation 1</xref> represent the ILR transform as originally published (<xref ref-type="bibr" rid="bib15">Egozcue et al., 2003</xref>), <xref ref-type="disp-formula" rid="equ3">Equation 2</xref> represents the standard formula for geometric mean of a vector <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, and <xref ref-type="disp-formula" rid="equ4">equation 3</xref> represents the number of tips that descend from the <inline-formula><mml:math id="inf41"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf42"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clade descendant from node <inline-formula><mml:math id="inf43"><mml:mi>i</mml:mi></mml:math></inline-formula>. However, when <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:mrow><mml:mo>≠</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>, these three equations represent a more generalized form of the ILR transform that allows weights to be assigned to taxa in the transformed space (<xref ref-type="bibr" rid="bib17">Egozcue and Pawlowsky-Glahn, 2016</xref>).</p><p>Following Egozcue and Pawlowsky-Glahn (<xref ref-type="bibr" rid="bib17">Egozcue and Pawlowsky-Glahn, 2016</xref>), we also note that the form of the generalized ILR (which we will denote <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>) transform can be rewritten in terms of a generalized CLR transform (which we will denote <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>). This formulation in terms of the generalized CLR transform can be more efficient to compute and allows the inverse of the transform to be easily described. We can define the generalized CLR transform as<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfrac><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The generalized ILR transform can then be written as<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>with the <inline-formula><mml:math id="inf47"><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>th element of the matrix <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> given by<disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:msqrt></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext> </mml:mtext><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>With these components defined the inverse of generalized ILR transform can be written as <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal">Ψ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="script">𝒞</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:msub><mml:mi mathvariant="normal">r</mml:mi><mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Soft thresholding through weighting taxa</title><p>We make use of this generalized ILR transform to down weight the influence of taxa with many zero and near-zero counts since these are less reliable and therefore more variable (<xref ref-type="bibr" rid="bib26">Good, 1956</xref>). Our choice of taxa weights is a heuristic that combines two terms multiplicatively: a measure of the central tendency of counts, such as the mean or median of the raw counts for a taxon across the <inline-formula><mml:math id="inf51"><mml:mi>N</mml:mi></mml:math></inline-formula> samples in a dataset; and, the norm of the vector of relative abundances of a taxon across the <inline-formula><mml:math id="inf52"><mml:mi>N</mml:mi></mml:math></inline-formula> samples in a dataset. We add this vector norm term to weight taxa by their site-specificity. Preliminary studies showed that the geometric mean of the counts (with a pseudocount added to avoid skew from zero values) outperformed both the arithmetic mean and median as a measure of central tendency for the counts (data not shown). Additionally, while both the Euclidean norm and the Aitchison norm improved preliminary benchmark performance compared to using the geometric mean alone, in one case (classification using support vector machine on the global patterns dataset), the Euclidean norm greatly outperformed the Aitchison norm (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>). Therefore, our chosen taxa weighting scheme uses the geometric mean times the Euclidean norm:<disp-formula id="equ8"><mml:math id="m8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mo>…</mml:mo><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>N</mml:mi></mml:mroot><mml:mtext> </mml:mtext><mml:mo>⋅</mml:mo><mml:mrow><mml:mo symmetric="true">‖</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo symmetric="true">‖</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Note that we add the subscript <inline-formula><mml:math id="inf53"><mml:mi>j</mml:mi></mml:math></inline-formula> to the right-hand side of the above equation to emphasize that this is calculated with respect to a single taxon across the <inline-formula><mml:math id="inf54"><mml:mi>N</mml:mi></mml:math></inline-formula> samples in a dataset. As intended, this scheme tended to assign smaller weights to taxa in our benchmarks with more zero and near-zero counts (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>). Despite their heuristic nature, we found that our chosen weights provide performance improvements over alternative weights (or the lack thereof) as measured by our benchmark tasks (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>).</p><p>Our taxa weighting scheme supplements the use of pseudo-counts and represents a soft-threshold on low abundance taxa. More generally, these taxa weights represent a form of prior information regarding the importance of each taxon. We note that if prior biological information suggests allowing specific taxa to influence the PhILR transform more (or less) strongly, such a weighting could be achieved for taxon <inline-formula><mml:math id="inf55"><mml:mi>j</mml:mi></mml:math></inline-formula> by increasing (or decreasing) <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-3"><title>Incorporating branch lengths</title><p>Beyond utilizing the connectivity of the phylogenetic tree to dictate the partitioning scheme for ILR balances, branch length information can be embedded into the transformed space by linearly scaling ILR balances (<inline-formula><mml:math id="inf57"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>) by the distance between neighboring clades. We call this scaling by phylogenetic distance ‘branch length weighting’. Specifically, for each coordinate <inline-formula><mml:math id="inf58"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, corresponding to node <inline-formula><mml:math id="inf59"><mml:mi>i</mml:mi></mml:math></inline-formula> we use the transform<disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>∙</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf60"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> represent the branch lengths of the two direct children of node <inline-formula><mml:math id="inf61"><mml:mi>i</mml:mi></mml:math></inline-formula>. When <inline-formula><mml:math id="inf62"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, the coordinates are not weighted by branch lengths. The form of this transform was chosen so that the weights <inline-formula><mml:math id="inf63"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>±</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, only influence the corresponding coordinate (<inline-formula><mml:math id="inf64"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>).</p><p>We also investigated the effect of using <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, and based on the results of <xref ref-type="bibr" rid="bib10">Chen et al. (2012)</xref>, <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> on benchmark performance. When coupled with the taxa weights specified above, the square root of the summed distances had the highest rank in 9 of the 12 supervised classification tasks and 2 of the three distance based tasks (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>). Based on these results, except for our analysis of balance variance versus phylogenetic depth (see below), the square root of the summed distances was used throughout our analyses.</p></sec><sec id="s4-4"><title>Implementation</title><p>The PhILR transform, as well as the incorporation of branch length and taxa weightings has been implemented in the R programing language as the package <italic>philr</italic> available at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/philr/.">https://bioconductor.org/packages/philr/.</ext-link></p></sec><sec id="s4-5"><title>Datasets and preprocessing</title><p>All data preprocessing was done in the R programming language using the <italic>phyloseq</italic> package for analysis of microbiome census data (<xref ref-type="bibr" rid="bib51">McMurdie and Holmes, 2013</xref>) as well as the <italic>ape</italic> (<xref ref-type="bibr" rid="bib55">Paradis et al., 2004</xref>) and <italic>phangorn</italic> (<xref ref-type="bibr" rid="bib63">Schliep, 2011</xref>) packages for analysis of phylogenetic trees.</p><sec id="s4-5-1"><title>Data acquisition</title><p>We chose to use previously published OTU tables, taxonomic classifications, and phylogenies as the starting point for our analyses. The Human Microbiome Project (HMP) dataset was obtained from the QIIME Community Profiling Pipeline applied to high-quality reads from the v3-5 region, available at <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/HMQCP/.">http://hmpdacc.org/HMQCP/.</ext-link> The Global Patterns dataset was originally published in Caporaso<italic>, et al.</italic> (<xref ref-type="bibr" rid="bib9">Caporaso et al., 2011</xref>) and is provided with the <italic>phyloseq</italic> R package (<xref ref-type="bibr" rid="bib51">McMurdie and Holmes, 2013</xref>). The Costello Skin Sites dataset (CSS) is a subset of the dataset collected by Costello et al. (<xref ref-type="bibr" rid="bib12">Costello et al., 2009</xref>) featuring only the samples from skin sites. This skin subset was introduced as a benchmark for supervised machine learning by Knights et al. (<xref ref-type="bibr" rid="bib32">Knights et al., 2011</xref>) and can be obtained from <ext-link ext-link-type="uri" xlink:href="http://www.knightslab.org/data">http://www.knightslab.org/data</ext-link>.</p></sec><sec id="s4-5-2"><title>OTU table preprocessing</title><p>To accord with general practice, we performed a minimal level of OTU table filtering for all datasets used in benchmarks and analyses. Due to differences in sequencing depth, sequencing methodology, and the number and diversity of samples between datasets, filtering thresholds were set independently for each dataset. For the HMP dataset, we initially removed samples with fewer than 1000 counts to mimic prior analyses (<xref ref-type="bibr" rid="bib28">Human Microbiome Project Consortium, 2012</xref>). We additionally removed OTUs that were not seen with more than three counts in at least 1% of samples. Preprocessing of the Global Patterns OTU table followed the methods outlined in McMurdie and Holmes (<xref ref-type="bibr" rid="bib51">McMurdie and Holmes, 2013</xref>). Specifically, OTUs that were not seen with more than three counts in at least 20% of samples were removed, the sequencing depth of each sample was standardized to the abundance of the median sampling depth, and finally OTUs with a coefficient of variation ≤3.0 were removed. The CSS dataset had lower sequencing depth than the other two datasets; we chose to filter OTUs that were not seen with greater than 10 counts across the skin samples. The PhILR transform, and more generally our benchmarking results in <xref ref-type="fig" rid="fig2">Figure 2b and C</xref>, were robust to varying our filtering strategies (<xref ref-type="supplementary-material" rid="SD5-data">Supplementary file 2</xref>).</p></sec><sec id="s4-5-3"><title>Preprocessing phylogenies</title><p>For each dataset, the phylogeny was pruned to include only those taxa remaining after OTU table preprocessing. Except for the Global Patterns dataset, which was already rooted, we chose to root phylogenies by manually specifying an outgroup. For the HMP dataset the phylum Euryarchaeota was chosen as an outgroup. For the CSS dataset, the tree was rooted with OTU 12871 (from phylum Plantomycetes) as the outgroup. For all three phylogenies, any multichotomies were resolved with the function multi2di from the <italic>ape</italic> package which replaces multichotomies with a series of dichotomies with one (or several) branch(es) of length zero.</p></sec><sec id="s4-5-4"><title>Zero replacement and normalization</title><p>A pseudocount of 1 was added prior to PhILR transformation to avoid taking log-ratios with zero counts. We found that our benchmarking results were robust to changing the value of this pseudocount from 1 to 2, 3, or 10 (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>).</p></sec><sec id="s4-5-5"><title>Grouping sampling sites</title><p>To simplify subsequent analyses, HMP samples from the left and right retroauricular crease and samples from the left and right antecubital fossa were grouped together, respectively, as preliminary PERMANOVA analysis suggested that these sites were indistinguishable (data not shown).</p></sec></sec><sec id="s4-6"><title>Benchmarking</title><sec id="s4-6-1"><title>Distance/dissimilarity based analysis</title><p>Distance between samples in PhILR transformed space was calculated using Euclidean distance. All other distance measures were calculated using <italic>phyloseq</italic> on the preprocessed data without adding a pseudocount. Principle coordinate analysis was performed for visualization using <italic>phyloseq.</italic> PERMANOVA was performed using the function <italic>adonis</italic> from the R package <italic>vegan</italic> (v2.3.4). The R<sup>2</sup> value from the fitted model was taken as a performance metric. Standard errors were calculated using bootstrap resampling with 100 samples each. Differences between the performance of Euclidean distance in PhILR transformed space and that of each other distance or dissimilarity measure on a given task was tested using two-sided t-tests and multiple hypothesis testing was accounted for using FDR correction.</p></sec><sec id="s4-6-2"><title>Supervised classification</title><p>The performance, as measured by classification accuracy, of PhILR transformed data was compared against data preprocessed using one of two standard strategies for normalizing sequencing depth: the preprocessed data was transformed to relative abundances (<italic>e.g</italic>., each sample was normalized to a constant sum of 1; <italic>raw</italic>); or, a pseudocount of 1 was added, the data was transformed to relative abundances, and finally the relative abundances were log-transformed (<italic>log)</italic>.</p><p>All supervised learning was implemented in Python using the following libraries: <italic>Scikit-learn</italic> (v0.17.1), <italic>numpy</italic> (v1.11.0) and <italic>pandas</italic> (v0.17.1). Four classifiers were used: penalized logistic regression, support vector classification with RBF kernel, random forest classification, and k-nearest-neighbors classification. Each classification task was evaluated using the mean and variance of the test accuracy over 10 randomized test/train (30/70) splits which preserved the percentage of samples from each class at each split. For each classifier, for each split, the following parameters were set using cross-validation on the training set. Logistic regression and Support Vector Classification: the <italic>‘C’</italic> parameter was allowed to vary between <inline-formula><mml:math id="inf68"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="inf69"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and multi-class classification was handled with a one-vs-all loss. In addition, for logistic regression the penalty was allowed to be either <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. K-nearest-neighbors classification: the ‘weights’ argument was set to ‘distance’. Random forest classification: each forest contained 30 trees and the ‘max_features’ argument was allowed to vary between 0.1 and 1. All other parameters were set to default values. Due to the small size of the Global Patterns dataset, the supervised classification task was simplified to distinguishing human vs. non-human samples. Differences between each method's accuracy in each task was tested using two-sided t-tests and multiple hypothesis testing was accounted for using FDR correction.</p></sec></sec><sec id="s4-7"><title>Identifying balances that distinguish sites</title><p>To identify a sparse set of balances that distinguish sampling sites while accounting for the dependencies between nested balances, we fit a multinomial regression model with a grouped l<sub>1</sub> penalty using the R package <italic>glmnet</italic> (<italic>v2.0.5</italic>). The penalization term lambda was set by visually inspecting model outputs for clear body site separation (lambda = 0.1198). This resulted in 35 balances with non-zero regression coefficients. Phylogenetic tree visualization was done using the R package <italic>ggtree</italic> (<xref ref-type="bibr" rid="bib71">Yu et al., 2017</xref>).</p></sec><sec id="s4-8"><title>Variance and depth</title><p>To reduce the likelihood that our analysis of balance variance and phylogenetic depth was affected by statistical artifact, we modified our PhILR transform in several ways. First, we omitted branch length weights (<italic>i.e.,</italic> we set <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) as these may vary non-randomly as a function of phylogenetic depth. Second, we also anticipated that any zero replacement method would likely lead to lower variance measurements, which could have greater effects on balances closer to the tips of the tree. We therefore omitted taxa weights and zero replacement; we instead used stricter hard filtering thresholds and calculated balance values based on non-zero counts. In practice, we used the following filtering thresholds for each body site, taxa present in less than 20% of samples from that site were excluded and subsequently samples that had less than 50 total counts were excluded. To calculate balance values based on non-zero counts we retained balances that met the following criteria: the term <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> had non-zero counts from some taxa within the subcomposition <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (formed by the taxa that descend from the <inline-formula><mml:math id="inf75"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clade of node <inline-formula><mml:math id="inf76"><mml:mi>i</mml:mi></mml:math></inline-formula>) and some other taxa within the subcomposition <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="italic">y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> (formed by the taxa that descend from the <inline-formula><mml:math id="inf78"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clade of node <inline-formula><mml:math id="inf79"><mml:mi>i</mml:mi></mml:math></inline-formula>) in at least 40 samples from that body site. We believe these two modifications to PhILR resulted in a more conservative analysis of balance variance versus phylogenetic depth but are likely not optimal in other situations.</p><p>To investigate the overall relationship between balance variance and phylogenetic depth we used linear regression. A balance’s depth in the tree was calculated as its mean phylogenetic distance to its descendant tips <inline-formula><mml:math id="inf80"><mml:mrow><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. For a given body site the following model was fit:<disp-formula id="equ10"><mml:math id="m10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf81"><mml:mi>d</mml:mi></mml:math></inline-formula> represents mean distance from a balance to its descendant tips. We then set out to test the null hypothesis that <inline-formula><mml:math id="inf82"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, or that the variance of the log-ratio between two clades was invariant to the distance of the two clades from their most recent common ancestor. For each site, a null distribution for <inline-formula><mml:math id="inf83"><mml:mi>β</mml:mi></mml:math></inline-formula> was constructed by permutations of the tip labels of the phylogenetic tree. For each permutation of the labels, the resultant tree was used to transform the data and <inline-formula><mml:math id="inf84"><mml:mi>β</mml:mi></mml:math></inline-formula> was estimated. We chose this permutation scheme to ensure that the increasing variance we saw with increasing proximity of a balance to the root was not because deeper balances had more descendant tips, an artifact of variance scaling with mean abundance, or due to bias introduced due to our handling of zeros. Furthermore, for each body site, we found the null distribution for <inline-formula><mml:math id="inf85"><mml:mi>β</mml:mi></mml:math></inline-formula> was symmetric about <inline-formula><mml:math id="inf86"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> which further supports that balance variance depends on phylogenetic depth through a biological mechanism and not through a statistical artifact (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>). Two tailed p-values were calculated for <inline-formula><mml:math id="inf87"><mml:mi>β</mml:mi></mml:math></inline-formula> based on 20000 samples from each site’s respective null distribution. FDR correction was applied to account for multiple hypothesis testing between body sites.</p><p>To visualize local trends in the relationship between balance variance and phylogenetic depth, a LOESS regression was fit independently for each body site. This was done using the function <italic>geom_smooth</italic> from the R package ggplot2 (v2.1.0) with default parameters.</p><p>The data and code needed to reproduce our analysis of balance variance versus phylogenetic depth is provided in <xref ref-type="supplementary-material" rid="SD3-data">Figure 4—source data 1</xref> and <xref ref-type="supplementary-material" rid="SD2-data">Figure 4—source code 1</xref> respectively.</p></sec><sec id="s4-9"><title>Integrating taxonomic information</title><p>Taxonomy was assigned to OTUs in the HMP dataset using the <italic>assign_taxonomy.py</italic> script from <italic>Qiime</italic> (v1.9.1) to call <italic>uclust</italic> (v1.2.22) with default parameters using the representative OTU sequences obtained as described above. Taxonomic identifiers were assigned to the two descendant clades of a given balance separately using a simple voting scheme and combined into a single name for that balance. The voting scheme occurs as follows: (1) for a given clade, the entire taxonomy table was subset to only contain the OTUs that were present in that clade (2) starting at the finest taxonomic rank the subset taxonomy table was checked to see if any species identifier represented ≥95% of the table entries at that taxonomic rank, if so that identifier was taken as the taxonomic label for the clade (3) if no consensus identifier was found, the table was checked at the next most-specific taxonomic rank.</p><p>Median phylogenetic depths for each taxonomic rank were estimated by first decorating a phylogenetic tree with taxonomy information using <italic>tax2tree</italic> (v1.0) (<xref ref-type="bibr" rid="bib50">McDonald et al., 2012</xref>). For a given taxonomic rank the mean distance to tips was calculated for each internal node possessing a label that ended in that rank. The median of these distances was used to display an estimate of the phylogenetic depth of that given rank. This calculation of median phylogenetic depth of different taxonomic ranks was done separately for each body site.</p><p>The data and code needed to reproduce the taxonomic assignment and estimation of median phylogenetic depths for each taxonomic rank is included in <xref ref-type="supplementary-material" rid="SD3-data">Figure 4—source data 1</xref> and <xref ref-type="supplementary-material" rid="SD2-data">Figure 4—source code 1</xref> respectively.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Rachel Silverman, Aspen Reese, Firas Midani, Heather Durand, Jesse Shapiro, Jonathan Friedman, Simon Levin, and Susan Holmes for their helpful comments, Dan Knights for providing us with the CSS dataset, as well as Klaus Schliep and Liam Revell for their insight into manipulation of phylogenetic trees in the R programming language. JS was supported in part by the Duke University Medical Scientist Training Program (GM007171).</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf1"><p>The authors declare that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>JDS, Conceptualization, Software, Formal analysis, Investigation, Visualization, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con2"><p>ADW, Conceptualization, Investigation, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con3"><p>SM, Formal analysis, Supervision, Funding acquisition, Methodology, Writing—original draft, Writing—review and editing</p></fn><fn fn-type="con" id="con4"><p>LAD, Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Writing—original draft, Project administration, Writing—review and editing</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="SD4-data"><object-id pub-id-type="doi">10.7554/eLife.21887.016</object-id><label>Supplementary file 1.</label><caption><title>Extended benchmarking results including the effects of changing pseudocount and different choices for taxa and branch length weights.</title><p>This file also contains summary information for the benchmark datasets after preprocessing.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.016">http://dx.doi.org/10.7554/eLife.21887.016</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-21887-supp1-v2.xlsx"/></supplementary-material><supplementary-material id="SD5-data"><object-id pub-id-type="doi">10.7554/eLife.21887.017</object-id><label>Supplementary file 2.</label><caption><title>Extended benchmarking results regarding the sensitivity of methods to different OTU filtering schemes.</title><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.21887.017">http://dx.doi.org/10.7554/eLife.21887.017</ext-link></p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-21887-supp2-v2.xlsx"/></supplementary-material><sec id="s7" sec-type="datasets"><title>Major datasets</title><p>The following previously published datasets were used:</p><p><related-object content-type="generated-dataset" id="data-ro1" source-id="http://hmpdacc.org/HMQCP/" source-id-type="uri"><collab>Human Microbiome Project Consortium</collab><x>,</x> <year>2010</year><x>,</x><source>Human Microbiome Project</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://hmpdacc.org/HMQCP/">http://hmpdacc.org/HMQCP/</ext-link><x>,</x> <comment>Publicly available at HMPDACC (v35 download of files 6, 9, and 10).</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro2" source-id="http://www.knightslab.org/data" source-id-type="uri"><collab>Costello EK</collab><x>,</x> <collab>Lauber CL</collab><x>,</x> <collab>Hamady M</collab><x>,</x> <collab>Fierer N</collab><x>,</x> <collab>Gordon JI</collab><x>,</x> <collab>Knight R</collab><x>,</x> <year>2009</year><x>,</x><source>Costello Skin Sites</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="http://www.knightslab.org/data">http://www.knightslab.org/data</ext-link><x>,</x> <comment>Publicly available as part of the FEMS Benchmark dataset (2011) provided by Dan Knights</comment></related-object></p><p><related-object content-type="generated-dataset" id="data-ro3" source-id="https://bioconductor.org/packages/release/bioc/html/phyloseq.html" source-id-type="uri"><collab>Caporaso GJ</collab><x>,</x> <collab>Lauber CL</collab><x>,</x> <collab>Walters WA</collab><x>,</x> <collab>Berg-Lyons D</collab><x>,</x> <collab>Lozupone CA</collab><x>,</x> <collab>Turnbaugh PJ</collab><x>,</x> <collab>Fierer N</collab><x>,</x> <collab>Knight R</collab><x>,</x> <year>2011</year><x>,</x><source>Global Patterns</source><x>,</x> <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/phyloseq.html">https://bioconductor.org/packages/release/bioc/html/phyloseq.html</ext-link><x>,</x> <comment>Publicly available and provided as part of the phyloseq R package as 'GlobalPatterns'</comment></related-object></p></sec></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aas</surname><given-names>JA</given-names></name><name><surname>Paster</surname><given-names>BJ</given-names></name><name><surname>Stokes</surname><given-names>LN</given-names></name><name><surname>Olsen</surname><given-names>I</given-names></name><name><surname>Dewhirst</surname><given-names>FE</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Defining the normal bacterial flora of the oral cavity</article-title><source>Journal of Clinical Microbiology</source><volume>43</volume><fpage>5721</fpage><lpage>5732</lpage><pub-id pub-id-type="doi">10.1128/JCM.43.11.5721-5732.2005</pub-id><pub-id pub-id-type="pmid">16272510</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Aitchison</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1986">1986</year><source>The Statistical Analysis of Compositional Data</source><publisher-loc>London; New York</publisher-loc><publisher-name>Chapman and Hall</publisher-name></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biology</source><volume>11</volume><elocation-id>R106</elocation-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bacon-Shone</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>A Short History of Compositional Data Analysis</chapter-title><person-group person-group-type="editor"><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Buccianti</surname> <given-names>A</given-names></name></person-group><source>Compositional Data Analysis</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name><fpage>1</fpage><lpage>11</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bear</surname><given-names>J</given-names></name><name><surname>Billheimer</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>A logistic normal mixture model for compositional data allowing essential zeros</article-title><source>Austrian Journal of Statistics</source><volume>45</volume><fpage>3</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.17713/ajs.v45i4.117</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Billheimer</surname><given-names>D</given-names></name><name><surname>Guttorp</surname><given-names>P</given-names></name><name><surname>Fagan</surname><given-names>WF</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Statistical interpretation of species composition</article-title><source>Journal of the American Statistical Association</source><volume>96</volume><fpage>1205</fpage><lpage>1214</lpage><pub-id pub-id-type="doi">10.1198/016214501753381850</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blaser</surname><given-names>MJ</given-names></name><name><surname>Falkow</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>What are the consequences of the disappearing human Microbiota?</article-title><source>Nature Reviews Microbiology</source><volume>7</volume><fpage>887</fpage><lpage>894</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2245</pub-id><pub-id pub-id-type="pmid">19898491</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Britanova</surname><given-names>OV</given-names></name><name><surname>Putintseva</surname><given-names>EV</given-names></name><name><surname>Shugay</surname><given-names>M</given-names></name><name><surname>Merzlyak</surname><given-names>EM</given-names></name><name><surname>Turchaninova</surname><given-names>MA</given-names></name><name><surname>Staroverov</surname><given-names>DB</given-names></name><name><surname>Bolotin</surname><given-names>DA</given-names></name><name><surname>Lukyanov</surname><given-names>S</given-names></name><name><surname>Bogdanova</surname><given-names>EA</given-names></name><name><surname>Mamedov</surname><given-names>IZ</given-names></name><name><surname>Lebedev</surname><given-names>YB</given-names></name><name><surname>Chudakov</surname><given-names>DM</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Age-related decrease in TCR repertoire diversity measured with deep and normalized sequence profiling</article-title><source>The Journal of Immunology</source><volume>192</volume><fpage>2689</fpage><lpage>2698</lpage><pub-id pub-id-type="doi">10.4049/jimmunol.1302064</pub-id><pub-id pub-id-type="pmid">24510963</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Lauber</surname><given-names>CL</given-names></name><name><surname>Walters</surname><given-names>WA</given-names></name><name><surname>Berg-Lyons</surname><given-names>D</given-names></name><name><surname>Lozupone</surname><given-names>CA</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Fierer</surname><given-names>N</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title><source>PNAS</source><volume>108 Suppl 1</volume><fpage>4516</fpage><lpage>4522</lpage><pub-id pub-id-type="doi">10.1073/pnas.1000080107</pub-id><pub-id pub-id-type="pmid">20534432</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Bittinger</surname><given-names>K</given-names></name><name><surname>Charlson</surname><given-names>ES</given-names></name><name><surname>Hoffmann</surname><given-names>C</given-names></name><name><surname>Lewis</surname><given-names>J</given-names></name><name><surname>Wu</surname><given-names>GD</given-names></name><name><surname>Collman</surname><given-names>RG</given-names></name><name><surname>Bushman</surname><given-names>FD</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Associating microbiome composition with environmental covariates using generalized UniFrac distances</article-title><source>Bioinformatics</source><volume>28</volume><fpage>2106</fpage><lpage>2113</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts342</pub-id><pub-id pub-id-type="pmid">22711789</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Variable selection for sparse Dirichlet-multinomial regression with an application to microbiome data analysis</article-title><source>The Annals of Applied Statistics</source><volume>7</volume><fpage>418</fpage><lpage>442</lpage><pub-id pub-id-type="doi">10.1214/12-AOAS592</pub-id><pub-id pub-id-type="pmid">24312162</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costello</surname><given-names>EK</given-names></name><name><surname>Lauber</surname><given-names>CL</given-names></name><name><surname>Hamady</surname><given-names>M</given-names></name><name><surname>Fierer</surname><given-names>N</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Bacterial community variation in human body habitats across space and time</article-title><source>Science</source><volume>326</volume><fpage>1694</fpage><lpage>1697</lpage><pub-id pub-id-type="doi">10.1126/science.1177486</pub-id><pub-id pub-id-type="pmid">19892944</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Culley</surname><given-names>AI</given-names></name><name><surname>Lang</surname><given-names>AS</given-names></name><name><surname>Suttle</surname><given-names>CA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Metagenomic analysis of coastal RNA virus communities</article-title><source>Science</source><volume>312</volume><fpage>1795</fpage><lpage>1798</lpage><pub-id pub-id-type="doi">10.1126/science.1127404</pub-id><pub-id pub-id-type="pmid">16794078</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Filippo</surname><given-names>C</given-names></name><name><surname>Cavalieri</surname><given-names>D</given-names></name><name><surname>Di Paola</surname><given-names>M</given-names></name><name><surname>Ramazzotti</surname><given-names>M</given-names></name><name><surname>Poullet</surname><given-names>JB</given-names></name><name><surname>Massart</surname><given-names>S</given-names></name><name><surname>Collini</surname><given-names>S</given-names></name><name><surname>Pieraccini</surname><given-names>G</given-names></name><name><surname>Lionetti</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Impact of diet in shaping gut Microbiota revealed by a comparative study in children from Europe and rural Africa</article-title><source>PNAS</source><volume>107</volume><fpage>14691</fpage><lpage>14696</lpage><pub-id pub-id-type="doi">10.1073/pnas.1005963107</pub-id><pub-id pub-id-type="pmid">20679230</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egozcue</surname><given-names>JJ</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Mateu-Figueras</surname><given-names>G</given-names></name><name><surname>Barcelo-Vidal</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Isometric logratio transformations for compositional data analysis</article-title><source>Mathematical Geology</source><volume>35</volume><fpage>279</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1023/A:1023818214614</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egozcue</surname><given-names>JJ</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Groups of parts and their balances in compositional data analysis</article-title><source>Mathematical Geology</source><volume>37</volume><fpage>795</fpage><lpage>828</lpage><pub-id pub-id-type="doi">10.1007/s11004-005-7381-9</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Egozcue</surname><given-names>JJ</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Changing the reference measure in the simplex and its weighting effects</article-title><source>Austrian Journal of Statistics</source><volume>45</volume><fpage>25</fpage><lpage>44</lpage><pub-id pub-id-type="doi">10.17713/ajs.v45i4.126</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fang</surname><given-names>H</given-names></name><name><surname>Huang</surname><given-names>C</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Deng</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>CCLasso: correlation inference for compositional data through lasso</article-title><source>Bioinformatics</source><volume>31</volume><fpage>3172</fpage><lpage>3180</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btv349</pub-id><pub-id pub-id-type="pmid">26048598</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faust</surname><given-names>K</given-names></name><name><surname>Sathirapongsasuti</surname><given-names>JF</given-names></name><name><surname>Izard</surname><given-names>J</given-names></name><name><surname>Segata</surname><given-names>N</given-names></name><name><surname>Gevers</surname><given-names>D</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><name><surname>Huttenhower</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Microbial co-occurrence relationships in the human microbiome</article-title><source>PLoS Computational Biology</source><volume>8</volume><fpage>e1002606</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002606</pub-id><pub-id pub-id-type="pmid">22807668</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fernandes</surname><given-names>AD</given-names></name><name><surname>Reid</surname><given-names>JN</given-names></name><name><surname>Macklaim</surname><given-names>JM</given-names></name><name><surname>McMurrough</surname><given-names>TA</given-names></name><name><surname>Edgell</surname><given-names>DR</given-names></name><name><surname>Gloor</surname><given-names>GB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16S rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title><source>Microbiome</source><volume>2</volume><fpage>15</fpage><pub-id pub-id-type="doi">10.1186/2049-2618-2-15</pub-id><pub-id pub-id-type="pmid">24910773</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Finucane</surname><given-names>MM</given-names></name><name><surname>Sharpton</surname><given-names>TJ</given-names></name><name><surname>Laurent</surname><given-names>TJ</given-names></name><name><surname>Pollard</surname><given-names>KS</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A taxonomic signature of obesity in the microbiome? getting to the guts of the matter</article-title><source>PLoS One</source><volume>9</volume><elocation-id>e84689</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0084689</pub-id><pub-id pub-id-type="pmid">24416266</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Inferring correlation networks from genomic survey data</article-title><source>PLoS Computational Biology</source><volume>8</volume><elocation-id>e1002687</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id><pub-id pub-id-type="pmid">23028285</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fukuyama</surname><given-names>J</given-names></name><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Dethlefsen</surname><given-names>L</given-names></name><name><surname>Relman</surname><given-names>DA</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Comparisons of distance methods for combining covariates and abundances in microbiome studies</chapter-title><source>Pacific Symposium on Biocomputing</source><publisher-name>NIH Public Access</publisher-name><fpage>213</fpage></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gloor</surname><given-names>GB</given-names></name><name><surname>Macklaim</surname><given-names>JM</given-names></name><name><surname>Vu</surname><given-names>M</given-names></name><name><surname>Fernandes</surname><given-names>AD</given-names></name></person-group><year iso-8601-date="2016">2016a</year><article-title>Compositional uncertainty should not be ignored in high-throughput sequencing data analysis</article-title><source>Austrian Journal of Statistics</source><volume>45</volume><elocation-id>73</elocation-id><pub-id pub-id-type="doi">10.17713/ajs.v45i4.122</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gloor</surname><given-names>GB</given-names></name><name><surname>Wu</surname><given-names>JR</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Egozcue</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2016">2016b</year><article-title>It's all relative: analyzing microbiome data as compositions</article-title><source>Annals of Epidemiology</source><volume>26</volume><fpage>322</fpage><lpage>329</lpage><pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.003</pub-id><pub-id pub-id-type="pmid">27143475</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Good</surname><given-names>IJ</given-names></name></person-group><year iso-8601-date="1956">1956</year><article-title>On the estimation of small frequencies in Contingency-Tables</article-title><source>Journal of the Royal Statistical Society Series B-Statistical Methodology</source><volume>18</volume><fpage>113</fpage><lpage>124</lpage></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grice</surname><given-names>EA</given-names></name><name><surname>Segre</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The skin microbiome</article-title><source>Nature Reviews Microbiology</source><volume>9</volume><fpage>244</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2537</pub-id><pub-id pub-id-type="pmid">21407241</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><collab>Human Microbiome Project Consortium</collab></person-group><year iso-8601-date="2012">2012</year><article-title>Structure, function and diversity of the healthy human microbiome</article-title><source>Nature</source><volume>486</volume><fpage>207</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1038/nature11234</pub-id><pub-id pub-id-type="pmid">22699609</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hunt</surname><given-names>DE</given-names></name><name><surname>David</surname><given-names>LA</given-names></name><name><surname>Gevers</surname><given-names>D</given-names></name><name><surname>Preheim</surname><given-names>SP</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name><name><surname>Polz</surname><given-names>MF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Resource partitioning and sympatric differentiation among closely related bacterioplankton</article-title><source>Science</source><volume>320</volume><fpage>1081</fpage><lpage>1085</lpage><pub-id pub-id-type="doi">10.1126/science.1157890</pub-id><pub-id pub-id-type="pmid">18497299</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jackson</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Compositional data in community ecology: the paradigm or peril of proportions?</article-title><source>Ecology</source><volume>78</volume><fpage>929</fpage><lpage>940</lpage><pub-id pub-id-type="doi">10.1890/0012-9658(1997)078[0929:CDICET]2.0.CO;2</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Janda</surname><given-names>JM</given-names></name><name><surname>Abbott</surname><given-names>SL</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>16s rRNA gene sequencing for bacterial identification in the diagnostic laboratory: pluses, perils, and pitfalls</article-title><source>Journal of Clinical Microbiology</source><volume>45</volume><fpage>2761</fpage><lpage>2764</lpage><pub-id pub-id-type="doi">10.1128/JCM.01228-07</pub-id><pub-id pub-id-type="pmid">17626177</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Costello</surname><given-names>EK</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Supervised classification of human Microbiota</article-title><source>FEMS Microbiology Reviews</source><volume>35</volume><fpage>343</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1111/j.1574-6976.2010.00251.x</pub-id><pub-id pub-id-type="pmid">21039646</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kurtz</surname><given-names>ZD</given-names></name><name><surname>Müller</surname><given-names>CL</given-names></name><name><surname>Miraldi</surname><given-names>ER</given-names></name><name><surname>Littman</surname><given-names>DR</given-names></name><name><surname>Blaser</surname><given-names>MJ</given-names></name><name><surname>Bonneau</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004226</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id><pub-id pub-id-type="pmid">25950956</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>La Rosa</surname><given-names>PS</given-names></name><name><surname>Brooks</surname><given-names>JP</given-names></name><name><surname>Deych</surname><given-names>E</given-names></name><name><surname>Boone</surname><given-names>EL</given-names></name><name><surname>Edwards</surname><given-names>DJ</given-names></name><name><surname>Wang</surname><given-names>Q</given-names></name><name><surname>Sodergren</surname><given-names>E</given-names></name><name><surname>Weinstock</surname><given-names>G</given-names></name><name><surname>Shannon</surname><given-names>WD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Hypothesis testing and power calculations for taxonomic-based human microbiome data</article-title><source>PLoS ONE</source><volume>7</volume><elocation-id>e52078</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0052078</pub-id><pub-id pub-id-type="pmid">23284876</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>SC</given-names></name><name><surname>Tang</surname><given-names>MS</given-names></name><name><surname>Lim</surname><given-names>YA</given-names></name><name><surname>Choy</surname><given-names>SH</given-names></name><name><surname>Kurtz</surname><given-names>ZD</given-names></name><name><surname>Cox</surname><given-names>LM</given-names></name><name><surname>Gundra</surname><given-names>UM</given-names></name><name><surname>Cho</surname><given-names>I</given-names></name><name><surname>Bonneau</surname><given-names>R</given-names></name><name><surname>Blaser</surname><given-names>MJ</given-names></name><name><surname>Chua</surname><given-names>KH</given-names></name><name><surname>Loke</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Helminth colonization is associated with increased diversity of the gut Microbiota</article-title><source>PLoS Neglected Tropical Diseases</source><volume>8</volume><elocation-id>e2880</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pntd.0002880</pub-id><pub-id pub-id-type="pmid">24851867</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Levy</surname><given-names>R</given-names></name><name><surname>Borenstein</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Metabolic modeling of species interaction in the human microbiome elucidates community-level assembly rules</article-title><source>PNAS</source><volume>110</volume><fpage>12804</fpage><lpage>12809</lpage><pub-id pub-id-type="doi">10.1073/pnas.1300926110</pub-id><pub-id pub-id-type="pmid">23858463</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ley</surname><given-names>RE</given-names></name><name><surname>Hamady</surname><given-names>M</given-names></name><name><surname>Lozupone</surname><given-names>C</given-names></name><name><surname>Turnbaugh</surname><given-names>PJ</given-names></name><name><surname>Ramey</surname><given-names>RR</given-names></name><name><surname>Bircher</surname><given-names>JS</given-names></name><name><surname>Schlegel</surname><given-names>ML</given-names></name><name><surname>Tucker</surname><given-names>TA</given-names></name><name><surname>Schrenzel</surname><given-names>MD</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Evolution of mammals and their gut microbes</article-title><source>Science</source><volume>320</volume><fpage>1647</fpage><lpage>1651</lpage><pub-id pub-id-type="doi">10.1126/science.1155725</pub-id><pub-id pub-id-type="pmid">18497261</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lê Cao</surname><given-names>KA</given-names></name><name><surname>Costello</surname><given-names>ME</given-names></name><name><surname>Lakis</surname><given-names>VA</given-names></name><name><surname>Bartolo</surname><given-names>F</given-names></name><name><surname>Chua</surname><given-names>XY</given-names></name><name><surname>Brazeilles</surname><given-names>R</given-names></name><name><surname>Rondeau</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>MixMC: a multivariate statistical framework to gain insight into microbial communities</article-title><source>PLoS One</source><volume>11</volume><elocation-id>e0160169</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0160169</pub-id><pub-id pub-id-type="pmid">27513472</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbiome, metagenomics, and high-dimensional compositional data analysis</article-title><source>Annual Review of Statistics and Its Application</source><volume>2</volume><fpage>73</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>W</given-names></name><name><surname>Shi</surname><given-names>P</given-names></name><name><surname>Feng</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Variable selection in regression with compositional covariates</article-title><source>Biometrika</source><volume>101</volume><fpage>785</fpage><lpage>797</lpage><pub-id pub-id-type="doi">10.1093/biomet/asu031</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lovell</surname><given-names>D</given-names></name><name><surname>Müller</surname><given-names>W</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Zwart</surname><given-names>A</given-names></name><name><surname>Helliwell</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>Proportions, percentages, ppm: do the molecular biosciences treat compositional data right</chapter-title><person-group person-group-type="editor"><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Buccianti</surname> <given-names>A</given-names></name></person-group><source>Compositional Data Analysis: Theory and Applications</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name><fpage>193</fpage><lpage>207</lpage></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lovell</surname><given-names>D</given-names></name><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Egozcue</surname><given-names>JJ</given-names></name><name><surname>Marguerat</surname><given-names>S</given-names></name><name><surname>Bähler</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Proportionality: a valid alternative to correlation for relative data</article-title><source>PLOS Computational Biology</source><volume>11</volume><elocation-id>e1004075</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004075</pub-id><pub-id pub-id-type="pmid">25775355</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lozupone</surname><given-names>C</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title><source>Applied and Environmental Microbiology</source><volume>71</volume><fpage>8228</fpage><lpage>8235</lpage><pub-id pub-id-type="doi">10.1128/AEM.71.12.8228-8235.2005</pub-id><pub-id pub-id-type="pmid">16332807</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mager</surname><given-names>DL</given-names></name><name><surname>Ximenez-Fyvie</surname><given-names>LA</given-names></name><name><surname>Haffajee</surname><given-names>AD</given-names></name><name><surname>Socransky</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Distribution of selected bacterial species on intraoral surfaces</article-title><source>Journal of Clinical Periodontology</source><volume>30</volume><fpage>644</fpage><lpage>654</lpage><pub-id pub-id-type="doi">10.1034/j.1600-051X.2003.00376.x</pub-id><pub-id pub-id-type="pmid">12834503</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mandal</surname><given-names>S</given-names></name><name><surname>Van Treuren</surname><given-names>W</given-names></name><name><surname>White</surname><given-names>RA</given-names></name><name><surname>Eggesbø</surname><given-names>M</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Peddada</surname><given-names>SD</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title><source>Microbial Ecology in Health &amp; Disease</source><volume>26</volume><fpage>27663</fpage><pub-id pub-id-type="doi">10.3402/mehd.v26.27663</pub-id><pub-id pub-id-type="pmid">26028277</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Martın-Fernandez</surname><given-names>JA</given-names></name><name><surname>Palarea-Albaladejo</surname><given-names>J</given-names></name><name><surname>Olea</surname><given-names>RA</given-names></name></person-group><year iso-8601-date="2011">2011</year><chapter-title>Dealing with zeros</chapter-title><person-group person-group-type="editor"><name><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name><name><surname>Buccianti</surname> <given-names>A</given-names></name></person-group><source>Compositional Data Analysis: Theory and Applications</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name><fpage>43</fpage><lpage>58</lpage></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin-Fernandez</surname><given-names>J-A</given-names></name><name><surname>Hron</surname><given-names>K</given-names></name><name><surname>Templ</surname><given-names>M</given-names></name><name><surname>Filzmoser</surname><given-names>P</given-names></name><name><surname>Palarea-Albaladejo</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Bayesian-multiplicative treatment of count zeros in compositional data sets</article-title><source>Statistical Modelling</source><volume>15</volume><fpage>134</fpage><lpage>158</lpage><pub-id pub-id-type="doi">10.1177/1471082X14535524</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martiny</surname><given-names>JB</given-names></name><name><surname>Jones</surname><given-names>SE</given-names></name><name><surname>Lennon</surname><given-names>JT</given-names></name><name><surname>Martiny</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Microbiomes in light of traits: a phylogenetic perspective</article-title><source>Science</source><volume>350</volume><elocation-id>aac9323</elocation-id><pub-id pub-id-type="doi">10.1126/science.aac9323</pub-id><pub-id pub-id-type="pmid">26542581</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsen</surname><given-names>FA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Phylogenetics and the human microbiome</article-title><source>Systematic Biology</source><volume>64</volume><fpage>e26</fpage><lpage>e41</lpage><pub-id pub-id-type="doi">10.1093/sysbio/syu053</pub-id><pub-id pub-id-type="pmid">25102857</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McDonald</surname><given-names>D</given-names></name><name><surname>Price</surname><given-names>MN</given-names></name><name><surname>Goodrich</surname><given-names>J</given-names></name><name><surname>Nawrocki</surname><given-names>EP</given-names></name><name><surname>DeSantis</surname><given-names>TZ</given-names></name><name><surname>Probst</surname><given-names>A</given-names></name><name><surname>Andersen</surname><given-names>GL</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>An improved greengenes taxonomy with explicit ranks for ecological and evolutionary analyses of Bacteria and archaea</article-title><source>The ISME Journal</source><volume>6</volume><fpage>610</fpage><lpage>618</lpage><pub-id pub-id-type="doi">10.1038/ismej.2011.139</pub-id><pub-id pub-id-type="pmid">22134646</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e61217</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id><pub-id pub-id-type="pmid">23630581</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>PJ</given-names></name><name><surname>Holmes</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Waste not, want not: why rarefying microbiome data is inadmissible</article-title><source>PLoS Computational Biology</source><volume>10</volume><elocation-id>e1003531</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id><pub-id pub-id-type="pmid">24699258</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moeller</surname><given-names>AH</given-names></name><name><surname>Caro-Quintero</surname><given-names>A</given-names></name><name><surname>Mjungu</surname><given-names>D</given-names></name><name><surname>Georgiev</surname><given-names>AV</given-names></name><name><surname>Lonsdorf</surname><given-names>EV</given-names></name><name><surname>Muller</surname><given-names>MN</given-names></name><name><surname>Pusey</surname><given-names>AE</given-names></name><name><surname>Peeters</surname><given-names>M</given-names></name><name><surname>Hahn</surname><given-names>BH</given-names></name><name><surname>Ochman</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cospeciation of gut microbiota with hominids</article-title><source>Science</source><volume>353</volume><fpage>380</fpage><lpage>382</lpage><pub-id pub-id-type="doi">10.1126/science.aaf3951</pub-id><pub-id pub-id-type="pmid">27463672</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morton</surname><given-names>JT</given-names></name><name><surname>Sanders</surname><given-names>J</given-names></name><name><surname>Quinn</surname><given-names>RA</given-names></name><name><surname>McDonald</surname><given-names>D</given-names></name><name><surname>Gonzalez</surname><given-names>A</given-names></name><name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name><name><surname>Navas-Molina</surname><given-names>JA</given-names></name><name><surname>Song</surname><given-names>SJ</given-names></name><name><surname>Metcalf</surname><given-names>JL</given-names></name><name><surname>Hyde</surname><given-names>ER</given-names></name><name><surname>Lladser</surname><given-names>M</given-names></name><name><surname>Dorrestein</surname><given-names>PC</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Balance trees reveal microbial niche differentiation</article-title><source>mSystems</source><volume>2</volume><fpage>e00162-16</fpage><pub-id pub-id-type="doi">10.1128/mSystems.00162-16</pub-id><pub-id pub-id-type="pmid">28144630</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paradis</surname><given-names>E</given-names></name><name><surname>Claude</surname><given-names>J</given-names></name><name><surname>Strimmer</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>APE: analyses of phylogenetics and evolution in R language</article-title><source>Bioinformatics</source><volume>20</volume><fpage>289</fpage><lpage>290</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btg412</pub-id><pub-id pub-id-type="pmid">14734327</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Paulson</surname><given-names>JN</given-names></name><name><surname>Stine</surname><given-names>OC</given-names></name><name><surname>Bravo</surname><given-names>HC</given-names></name><name><surname>Pop</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Differential abundance analysis for microbial marker-gene surveys</article-title><source>Nature Methods</source><volume>10</volume><fpage>1200</fpage><lpage>1202</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id><pub-id pub-id-type="pmid">24076764</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Buccianti</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2011">2011</year><source>Compositional Data Analysis: Theory and Applications</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name></element-citation></ref><ref id="bib58"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Egozcue</surname><given-names>JJ</given-names></name><name><surname>Tolosana-Delgado</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><source>Modeling and Analysis of Compositional Data</source><publisher-loc>Hoboken, NJ</publisher-loc><publisher-name>John Wiley &amp; Sons, Ltd</publisher-name></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pawlowsky-Glahn</surname><given-names>V</given-names></name><name><surname>Egozcue</surname><given-names>JJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Exploring compositional data with the CoDa-Dendogram</article-title><source>Austrian Journal of Statistics</source><volume>40</volume><fpage>103</fpage><lpage>113</lpage></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Purdom</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Analysis of a data matrix and a graph: metagenomic data and the phylogenetic tree</article-title><source>The Annals of Applied Statistics</source><volume>5</volume><fpage>2326</fpage><lpage>2358</lpage><pub-id pub-id-type="doi">10.1214/10-AOAS402</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rakoff-Nahoum</surname><given-names>S</given-names></name><name><surname>Foster</surname><given-names>KR</given-names></name><name><surname>Comstock</surname><given-names>LE</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>The evolution of cooperation within the gut microbiota</article-title><source>Nature</source><volume>533</volume><fpage>255</fpage><lpage>259</lpage><pub-id pub-id-type="doi">10.1038/nature17626</pub-id><pub-id pub-id-type="pmid">27111508</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>A</given-names></name><name><surname>Khattra</surname><given-names>J</given-names></name><name><surname>Yap</surname><given-names>D</given-names></name><name><surname>Wan</surname><given-names>A</given-names></name><name><surname>Laks</surname><given-names>E</given-names></name><name><surname>Biele</surname><given-names>J</given-names></name><name><surname>Ha</surname><given-names>G</given-names></name><name><surname>Aparicio</surname><given-names>S</given-names></name><name><surname>Bouchard-Côté</surname><given-names>A</given-names></name><name><surname>Shah</surname><given-names>SP</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>PyClone: statistical inference of clonal population structure in Cancer</article-title><source>Nature Methods</source><volume>11</volume><fpage>396</fpage><lpage>398</lpage><pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id><pub-id pub-id-type="pmid">24633410</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schliep</surname><given-names>KP</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Phangorn: phylogenetic analysis in R</article-title><source>Bioinformatics</source><volume>27</volume><fpage>592</fpage><lpage>593</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id><pub-id pub-id-type="pmid">21169378</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smillie</surname><given-names>CS</given-names></name><name><surname>Smith</surname><given-names>MB</given-names></name><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Cordero</surname><given-names>OX</given-names></name><name><surname>David</surname><given-names>LA</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title><source>Nature</source><volume>480</volume><fpage>241</fpage><lpage>244</lpage><pub-id pub-id-type="doi">10.1038/nature10571</pub-id><pub-id pub-id-type="pmid">22037308</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsilimigras</surname><given-names>MC</given-names></name><name><surname>Fodor</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Compositional data analysis of the microbiome: fundamentals, tools, and challenges</article-title><source>Annals of Epidemiology</source><volume>26</volume><fpage>330</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.002</pub-id><pub-id pub-id-type="pmid">27255738</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>van den Boogaart</surname><given-names>KG</given-names></name><name><surname>Tolosana-Delgado</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2013">2013</year><source>Analyzing Compositional Data with R</source><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Větrovský</surname><given-names>T</given-names></name><name><surname>Baldrian</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The variability of the 16S rRNA gene in bacterial genomes and its consequences for bacterial community analyses</article-title><source>PLoS One</source><volume>8</volume><elocation-id>e57923</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0057923</pub-id><pub-id pub-id-type="pmid">23460914</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Waldor</surname><given-names>MK</given-names></name><name><surname>Tyson</surname><given-names>G</given-names></name><name><surname>Borenstein</surname><given-names>E</given-names></name><name><surname>Ochman</surname><given-names>H</given-names></name><name><surname>Moeller</surname><given-names>A</given-names></name><name><surname>Finlay</surname><given-names>BB</given-names></name><name><surname>Kong</surname><given-names>HH</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name><name><surname>Nelson</surname><given-names>KE</given-names></name><name><surname>Dabbagh</surname><given-names>K</given-names></name><name><surname>Smith</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Where next for microbiome research?</article-title><source>PLOS Biology</source><volume>13</volume><elocation-id>e1002050</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002050</pub-id><pub-id pub-id-type="pmid">25602283</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>GD</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Hoffmann</surname><given-names>C</given-names></name><name><surname>Bittinger</surname><given-names>K</given-names></name><name><surname>Chen</surname><given-names>YY</given-names></name><name><surname>Keilbaugh</surname><given-names>SA</given-names></name><name><surname>Bewtra</surname><given-names>M</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Walters</surname><given-names>WA</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Sinha</surname><given-names>R</given-names></name><name><surname>Gilroy</surname><given-names>E</given-names></name><name><surname>Gupta</surname><given-names>K</given-names></name><name><surname>Baldassano</surname><given-names>R</given-names></name><name><surname>Nessel</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Bushman</surname><given-names>FD</given-names></name><name><surname>Lewis</surname><given-names>JD</given-names></name><name><surname>Gd</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title><source>Science</source><volume>334</volume><fpage>105</fpage><lpage>108</lpage><pub-id pub-id-type="doi">10.1126/science.1208344</pub-id><pub-id pub-id-type="pmid">21885731</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yatsunenko</surname><given-names>T</given-names></name><name><surname>Rey</surname><given-names>FE</given-names></name><name><surname>Manary</surname><given-names>MJ</given-names></name><name><surname>Trehan</surname><given-names>I</given-names></name><name><surname>Dominguez-Bello</surname><given-names>MG</given-names></name><name><surname>Contreras</surname><given-names>M</given-names></name><name><surname>Magris</surname><given-names>M</given-names></name><name><surname>Hidalgo</surname><given-names>G</given-names></name><name><surname>Baldassano</surname><given-names>RN</given-names></name><name><surname>Anokhin</surname><given-names>AP</given-names></name><name><surname>Heath</surname><given-names>AC</given-names></name><name><surname>Warner</surname><given-names>B</given-names></name><name><surname>Reeder</surname><given-names>J</given-names></name><name><surname>Kuczynski</surname><given-names>J</given-names></name><name><surname>Caporaso</surname><given-names>JG</given-names></name><name><surname>Lozupone</surname><given-names>CA</given-names></name><name><surname>Lauber</surname><given-names>C</given-names></name><name><surname>Clemente</surname><given-names>JC</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Human gut microbiome viewed across age and geography</article-title><source>Nature</source><volume>486</volume><fpage>222</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1038/nature11053</pub-id><pub-id pub-id-type="pmid">22699611</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>G</given-names></name><name><surname>Smith</surname><given-names>DK</given-names></name><name><surname>Zhu</surname><given-names>H</given-names></name><name><surname>Guan</surname><given-names>Y</given-names></name><name><surname>Lam</surname><given-names>TT-Y</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ggtree : an r package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title><source>Methods in Ecology and Evolution</source><volume>8</volume><fpage>28</fpage><lpage>36</lpage><pub-id pub-id-type="doi">10.1111/2041-210X.12628</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>K</given-names></name><name><surname>Sakoparnig</surname><given-names>T</given-names></name><name><surname>Markowetz</surname><given-names>F</given-names></name><name><surname>Beerenwinkel</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>BitPhylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title><source>Genome Biology</source><volume>16</volume><elocation-id>36</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-015-0592-6</pub-id><pub-id pub-id-type="pmid">25786108</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zaneveld</surname><given-names>JR</given-names></name><name><surname>Lozupone</surname><given-names>C</given-names></name><name><surname>Gordon</surname><given-names>JI</given-names></name><name><surname>Knight</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Ribosomal RNA diversity predicts genome diversity in gut bacteria and their relatives</article-title><source>Nucleic Acids Research</source><volume>38</volume><fpage>3869</fpage><lpage>3879</lpage><pub-id pub-id-type="doi">10.1093/nar/gkq066</pub-id><pub-id pub-id-type="pmid">20197316</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.21887.024</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Fodor</surname><given-names>Anthony</given-names></name><role>Reviewing editor</role><aff id="aff12"><institution>University of North Carolina at Charlotte</institution></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>Thank you for submitting your article &quot;A phylogenetic transform enhances analysis of compositional microbiota data&quot; for consideration by <italic>eLife</italic>. Your article has been favorably evaluated by Wendy Garrett (Senior Editor) and three reviewers, one of whom, Anthony Fodor, is a member of our Board of Reviewing Editors. The following individual involved in review of your submission has agreed to reveal their identity: Juan José Egozcue (Reviewer #2). All three reviewers found considerable merit in the manuscript praising the originality of the idea, the clarity of the presentation and the effectiveness of the visualizations.</p><p>For your reference, I have attached the three original reviews below. Per the <italic>eLife</italic> policy, you are not required to respond to each individual point raised by each reviewer. Below you will find a summary of the reviews reflecting the consensus of the reviewers of required revisions.</p><p>Summary:</p><p>It has long been recognized that compositional data is best analyzed in ratio space. For 16S rRNA sequence datasets and other genomic datasets, this leads to the rather difficult question of what ratio to take. In this interesting manuscript, Silverman et al. suggest taking ratios on a bifurcating phylogenetic tree. In their approach, the dependent variable for each node of the tree is a &quot;balance&quot;, which is a normalized ratio of all the nodes beneath each node (with the ratio of all the left descendant nodes over all the right descendant nodes). The paper explores the consequences of this normalization showing reasonable performance when used for classification or machine learning. The authors provide an implementation in R and this approach may be of utility for analysts looking for a novel way to analyze microbial data in ratio space.</p><p>Essential revisions:</p><p>1) There was consensus among the reviewers that the normalization scheme seemed a bit ad-hoc and poorly justified. We suggest that it is made clear to the readers that the choice of weights used in the manuscript, both on the taxa and on the tips, are preliminary choices and further work will be required to ultimately determine the best weighting scheme. In addition, some further clarification on how sparsity was treated would strengthen the manuscript.</p><p>2) None of the reviewers were entirely satisfied with the demonstration that the proposed transformation was superior to other transformations. It is unclear what it means, for example, that the PhILR technique sometimes produces a stronger clustering signal and sometimes a weaker clustering signal than weighted UNIFRAC (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). There was some discussion among the reviewers about whether a comparison to random binary partitions would be appropriate since this could reflect your null model (that phylogenetic binary partition is superior). Reviewer #2 was not enthusiastic about this idea and argued that a change on a tree does not alter (Aitchison) distances between data points. Therefore, results would likely not change no matter which tree has been selected for defining ILR coordinates.</p><p>In the end, the consensus of the reviewers was that exploring such null models might be of interest, but would not be appropriate as a requirement for revision. Nonetheless, reviewer #1 would have been interested to see if machine learning algorithms in fact performed better on the phylogenetic partition in comparison to random partitions. We leave it up to the authors as to whether they feel such an inclusion would improve their paper or be worth the effort. However, all reviewers felt that paper would be improved by more discussion of how to tell when one normalization procedure is superior to another. It seemed to reviewer #1 that it might be adequate to say that the proposed transformation appears to be doing no harm relative to weighted Unifrac but was providing some compositional safeguards. Reviewer #2 argued that the main benefit of the proposed procedure was in interpretability in yielding a phylogenetically aware transformation that could be utilized for test-statistics.</p><p>3) There was general consensus among the reviewers that <xref ref-type="fig" rid="fig4">Figure 4</xref> was unconvincing in that technical (non-biological) features of the algorithm could explain the results more easily than exclusionary dynamics. The authors could likely remove <xref ref-type="fig" rid="fig4">Figure 4</xref> without damaging the paper, but if they choose to keep it, they should respond to the concerns below from reviewers #1 and #3 as both reviewers felt that simple lack of association between taxa and stochastic variation in sampling could explain many of the observations in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p><p>4) There was consensus among the reviewers that the authors could provide more guidance to the non-specialists about when this algorithm should be used. As reviewer #3 put it, when and why should a reader choose the PhILR approach and when should it be avoided.</p><p>5) The authors should be explicit about what filtering and other pre-processing steps were used and whether those choices substantially impacted the performance of their algorithm.</p><p><italic>Reviewer #1:</italic> </p><p>It has long been recognized that compositional data is best analyzed in ratio space. For 16S rRNA sequence datasets and other genomic datasets, this leads to the rather difficult question of what ratio to take. In this interesting manuscript, Silverman et al. suggest taking ratios on a bifurcating phylogenetic tree. In their approach, the dependent variable for each node of the tree is a &quot;balance&quot;, which is a normalized ratio of all the nodes beneath each node (with the ratio of all the left descendant nodes over all the right descendant nodes). This is a clever idea and the authors make a reasonably compelling case that this is a useful contribution. While the evidence from the machine learning and clustering portions of the paper provide only modest evidence that this transformation is substantially better than other transformations, the transformation clearly is not making things much worse. As such, the proposed method will be of interest to researchers interested in how best to approach the challenging problem of compositional analyses of microbial datasets.</p><p>Suggestions for improvement follows:</p><p>1) The mathematical description of the algorithm could be improved in terms of its clarity. For example, it is not always clear how the pluses and minuses in the second equation of the subsection “The ILR Transform” are defined. It is not made immediately clear that the leftmost term (sqrt(ni+ * ni- / (ni+ + ni-)) in that equation is a correction for branch length. For the equation in the subsection “Addressing sparsity through weighting taxa”, please use parentheses to emphasize that the formula is sqrt(sum(xj)) * ((sum(cj 1…N)) ^ 1/N and not sqrt(sum(xj))^N * sqrt(sum(cj 1…N))</p><p>2) A limitation of working in ratio space in 16S data is what to do with all of the zeros in the spreadsheet (the &quot;sparse data&quot; problem). There is nothing inherent to the balancing algorithm that can deal with this problem (the sum in the denominator of the balance obviously can't be zero). The authors therefore require some kind of pseudo-count scheme and they have settled on one (given in the equation in subsection “Addressing sparsity through weighting taxa”) which is a function of the number of samples. If I am reading their formula correctly, the weight given to a taxa with 1 read in one sample and zero in all others would be very close to the sqrt(number of samples). The authors might consider giving this as an example and explicitly noting that their method has some similarity to adding the sqrt(number of samples) as a pseudo-count.</p><p>3) I struggled a bit with the variance analysis which concludes the Results sections. In the second paragraph of the subsection 2Balance variance and microbiota assembly” it is argued that &quot;When the variance of a balance between two clades approaches zero, the mean abundance of taxa in each of the two clades will be linearly related and thus exhibit shared dynamics across microbial habitats&quot;. While this is true (and must be true mathematically as when the variance approaches zero, the ratio of the two normalized abundances of the clades is constant, which means they will become perfectly linearly related with a positive slope), it's not clear to me that a high variance necessarily means &quot;exclusionary dynamics across samples&quot;. I don't see how a high variance in this number indicated anything about how direct or indirect the interactions are within the tree. There are lots of reasons two clades could lack perfect linear correlation with a positive slope from direct competition to being completely unrelated biologically with abundances just shifting due to stochastic variation. Also, wouldn't variance have to be lower closer to the tips of the phylogenetic tree as the number of sequences is lower, so the pseudo-count has more of an effect depressing overall variance? Doesn't that explain <xref ref-type="fig" rid="fig4">Figure 4D-F</xref>? And if I am reading these graphs correctly, below the species level there are not enough datapoints to support modeling via localized regression one way or another. Although not central to the arguments of the paper, I found <xref ref-type="fig" rid="fig4">Figure 4</xref> to be less convincing than other sections of the paper.</p><p><italic>Reviewer #2:</italic> </p><p>The manuscript introduces two new powerful ideas. They are: (a)construction of the sequential binary partition used to define</p><p>ILR coordinates on the base of phylogenetic trees; (b) use therecently published balances in weighted compositions to account forphylogenetic distances between OTU's or taxa. Both ideas aredeveloped and applied successfully to benchmark data sets.</p><p>For the originality of main ideas applied to microbiome analysis,the manuscript deserves publication.</p><p><italic>Reviewer #3:</italic> </p><p>The manuscript is, in general, written in a clear and logical manner with a minimum of technical jargon. <xref ref-type="fig" rid="fig1">Figures 1</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig4">4</xref> are outstanding examples of data visualization and demonstrate the utility of this approach over others extant in the field. <xref ref-type="fig" rid="fig5">Figure 5</xref> seems an afterthought and could be combined with <xref ref-type="fig" rid="fig1">Figure 1</xref>, or made supplementary. The binary portion could also be completely described in the Methods without a figure.</p><p><xref ref-type="fig" rid="fig2">Figure 2</xref>, and the associated descriptive text are somewhat underwhelming demonstrations of the utility of the approach, which, in theory, should clearly outperform all other methods if the compositional data approach is necessary. The use of box-plots probably does not aid the visual appeal.</p><p>That the ILR based distance can seriously underperform the weighted unifrac metric is puzzling and cause for concern, since PhILR becomes another metric to be 'mined' to achieve the desired outcome. Does the PhILR partitioning scheme outperform a simple random binary partition? this is crucial to know.</p><p>There needs to be serious guidance given to the reader as to when and why to choose the PhILR approach and when not to. The same can be said for the classification methods shown, where the PhILR generally (but not always) outperforms relative abundance, but not log relative abundance. I am left to wonder if data analysis choices are driving these results.</p><p>Finally, I am puzzled as to why the authors chose to take a rigorous variance-based approach (ILR) and analyze it using a distance-based metric. It is established in the CoDa literature that Mahalanobis distances are often more appropriate for clustering based approaches and for outlier detection (see for example: <ext-link ext-link-type="uri" xlink:href="http://www.statistik.tuwien.ac.at/public/filz/papers/2010Compstat.pdf">http://www.statistik.tuwien.ac.at/public/filz/papers/2010Compstat.pdf</ext-link>). Did the authors examine other distances?</p><p>I believe that <xref ref-type="fig" rid="fig4">Figure 4</xref> is somewhat over-interpreted. Subsection “Balance variance and microbiota assembly”, last paragraph: There are many technical reasons such as inefficient clustering, etc. that closely related sequences (called bacteria here) could exhibit strong correlations. Reading Lovell (referenced in this manuscript), and the points shown in 4G-L, indicate that an alternative explanation to that given in the text (see aforementioned subsection, end of second paragraph) is that a higher balance variance would be compatible with a model of indifference rather than competition since the vast majority of high variance ratio balances are likely to be non-correlated balances (Lovell 2015). Such non-correlated balances persist even out to the extreme tails and there is as yet no general principled approach to identify negative correlations in compositions.</p><p>Introduction, last paragraph: “the accuracy of distance.…” – this is a strong statement to make as the underlying standard of truth is assumed, not known from first principles.</p><p>Subsection “Addressing sparsity through weighting taxa”, first paragraph: I would argue that total read counts contain information on precision, not variance. It is hard to square this statement with the otherwise compositional approach used in the paper.</p><p>Subsection “Addressing sparsity through weighting taxa”, second paragraph: Why use a prior of one. The supplement that I found did not support the assertion that the prior chosen had little effect. This needs to be clarified.</p><p>Subsection “Human Microbiome Project (HMP)”: What is the effect of filtering and preprocessing on the method? As with many methods papers, the arbitrary choices here have the potential to become the accepted norm later without evidence.</p><p>Subsection “Supervised Classification”, first paragraph: Were the log-transformed data not scaled? if not, this is a problem since it is not a fair comparison.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.21887.025</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p><italic>Essential revisions:</italic> </p><p><italic>1) There was consensus among the reviewers that the normalization scheme seemed a bit ad-hoc and poorly justified. We suggest that it is made clear to the readers that the choice of weights used in the manuscript, both on the taxa and on the tips, are preliminary choices and further work will be required to ultimately determine the best weighting scheme. In addition, some further clarification on how sparsity was treated would strengthen the manuscript.</italic> </p><p>We understand the reviewers’ concern regarding the discussion of our chosen weights (both branch length weights and taxa weights) and how sparsity was handled. We also recognize that these chosen weights are heuristics motivated in part on benchmarking results, and that further work is needed to determine optimal weightings in different situations. In response to these comments, we have expanded our discussion of these issues in the Results, Discussion and Methods sections (see subsection “Constructing the PhILR transform”; Discussion, sixth paragraph; subsections “Soft thresholding through weighting taxa”, “Incorporating branch lengths” and “Implementation”). In particular, we now state in the main text:</p><p>“Both the taxa weights and the branch lengths weights we introduce here may be viewed as preliminary heuristics; future work will likely yield additional weighting schemes, as well as knowledge for when a given weighting scheme should be matched to an analysis task.”</p><p>We have also included an additional supplementary figure (<xref ref-type="fig" rid="fig4s2">Figure 4—figure supplement 2</xref>) to provide readers with intuition for our chosen taxa weights behave in the face of data sparsity; namely, that these weights assign smaller influence to taxa with more zero and near-zero counts.</p><p><italic>2) None of the reviewers were entirely satisfied with the demonstration that the proposed transformation was superior to other transformations. It is unclear what it means, for example, that the PhILR technique sometimes produces a stronger clustering signal and sometimes a weaker clustering signal than weighted UNIFRAC (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). There was some discussion among the reviewers about whether a comparison to random binary partitions would be appropriate since this could reflect your null model (that phylogenetic binary partition is superior). Reviewer #2 was not enthusiastic about this idea and argued that a change on a tree does not alter (Aitchison) distances between data points. Therefore, results would likely not change no matter which tree has been selected for defining ILR coordinates.</italic> </p><p><italic>In the end, the consensus of the reviewers was that exploring such null models might be of interest, but would not be appropriate as a requirement for revision. Nonetheless, reviewer #1 would have been interested to see if machine learning algorithms in fact performed better on the phylogenetic partition in comparison to random partitions. We leave it up to the authors as to whether they feel such an inclusion would improve their paper or be worth the effort. However, all reviewers felt that paper would be improved by more discussion of how to tell when one normalization procedure is superior to another. It seemed to reviewer #1 that it might be adequate to say that the proposed transformation appears to be doing no harm relative to weighted Unifrac but was providing some compositional safeguards. Reviewer #2 argued that the main benefit of the proposed procedure was in interpretability in yielding a phylogenetically aware transformation that could be utilized for test-statistics.</italic> </p><p>We recognize from the reviewers’ comments that our rationale for providing the benchmarking results could be improved. Our goal in <xref ref-type="fig" rid="fig2">Figure 2</xref> was to demonstrate that common microbiota analyses could be easily performed on PhILR transformed data with performance on par with current practice. Importantly, we did not intend these benchmarks to justify a compositionally robust approach to microbiota data analysis; we believe that this need has been well established (1-7). Nor do we believe it essential to our manuscript that PhILR outperforms other transforms or that Euclidean distance measured on PhILR transformed data outperforms all other (non-CoDA) distance metrics. In fact, we find it extremely unlikely that PhILR would always outperform any other transformation or distance metric under all situations. For example, while Weighted UniFrac may not be grounded in compositional data analysis theory, it was specifically designed for analysis of mixed microbial communities and we therefore would expect it to preform quite well in these tasks. We do think though that the results of <xref ref-type="fig" rid="fig2">Figure 2B and 2C</xref> are promising and suggest that at least with respect to our chosen metrics, PhILR transformed data can improve the performance of select tools in a variety of situations.</p><p>To reflect the reviewers’ overall concerns and our rationale for benchmarking, we have reworded our description of our benchmarking tasks and results throughout the manuscript. For example, we now motivate our use of benchmarking as follows:</p><p>“[…] we underscore that we do not find it essential that PhILR demonstrates superior benchmark performance to motivate its use in microbiota analysis. We believe that the need for compositionally robust tools has already been well established (1-7) and intended these benchmarks to showcase the flexibility and utility of working with PhILR transformed data.”</p><p>Additionally, we have been more explicit regarding the metrics used to evaluate the performance of PhILR transformed data. For example, we now specify in the text that the R<sup>2</sup> statistic from PERMANOVA is used in <xref ref-type="fig" rid="fig2">Figure 2B</xref> and classification accuracy is used in <xref ref-type="fig" rid="fig2">Figure 2C</xref>.</p><p>With regards to tests involving random binary partitions, we strongly agree with reviewer #2's comments. In the absence of branch length weights, all ILR transforms would be expected to preform equally well on our benchmark tasks. In addition, it is not our intention to show that PhILR exhibits superiority to other ILR transforms with regards to benchmark performance. Rather, we believe much of PhILR’s utility is that, by choosing the phylogeny as the partition, the resulting coordinates have biological meaning. <xref ref-type="fig" rid="fig3">Figure 3</xref> and <xref ref-type="fig" rid="fig4">4</xref> demonstrate how such meaning enables analyses involving evolutionarily relevant balances. Still, because the transformed space can be easily scaled by the phylogenetic distances between taxa (our branch length weighting), we believe the most natural “null” comparison to include is between PhILR with and without branch length weights. We include such an analysis in <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>, which demonstrates that, when coupled with our taxa weights, our chosen branch length weights had the highest rank in 9 of the 12 supervised classifications tasks and 2 of the three distance based tasks. We have updated our Discussion section to reflect the relation between the PhILR transform and other ILR transforms. These updated lines now include the statement:</p><p>“We also note that for some analyses, a phylogeny-based ILR transform will not outperform an ILR transform built from another sequential binary partition. […] Instead, what distinguishes the PhILR transform from other ILR transforms is the interpretability of the transformed coordinates. Balances in PhILR space correspond to speciation events, which can be both a source and target for biological insight.”</p><p><italic>3) There was general consensus among the reviewers that <xref ref-type="fig" rid="fig4">Figure 4</xref> was unconvincing in that technical (non-biological) features of the algorithm could explain the results more easily than exclusionary dynamics. The authors could likely remove <xref ref-type="fig" rid="fig4">Figure 4</xref> without damaging the paper, but if they choose to keep it, they should respond to the concerns below from reviewers #1 and #3 as both reviewers felt that simple lack of association between taxa and stochastic variation in sampling could explain many of the observations in <xref ref-type="fig" rid="fig4">Figure 4</xref>.</italic> </p><p>Based on the reviewers’ astute comments, we have dramatically narrowed our ecological interpretation of <xref ref-type="fig" rid="fig4">Figure 4</xref>. Notably, because we now recognize that high balance variance can be due to either a lack of association or opposing dynamics between neighboring clades, we no longer draw conclusions regarding the importance of competitive exclusion in structuring microbial communities. We have chosen to instead restrict our discussion of <xref ref-type="fig" rid="fig4">Figure 4</xref> to the separate conclusion that more phylogenetically similar clades are more likely to covary within human body sites.</p><p>In addition, to address reviewers’ concerns about technical sources of bias, we have also added a new paragraph in to the Results section which discusses the steps we took to avoid artifact in our analysis (subsection “Balance variance and microbiota assembly”, second paragraph). (We believe this new paragraph also has the benefit of reducing confusion regarding how our zero handling and the use of weights differs from prior sections.) We believe one of the steps to avoid bias that we now detail, which is a permutation-based hypothesis test, accounts for many of the potential technical artifacts that the reviewers alluded to. Histograms from the null distributions for each body site (<xref ref-type="fig" rid="fig4s3">Figure 4—figure supplement 3</xref>) are symmetric about zero, suggesting that any bias introduced by our handing of zero values or stochastic sampling was likely minimal. Still, we do acknowledge that we cannot completely exclude the possibility that inefficient clustering of sequences into OTUs could add to the observed pattern between balance variance and phylogenetic depth. But, due to our observation that this relation appears to be stronger above the species level than below, we believe that inefficient clustering alone could not explain the pattern we observed. We have added a discussion of this issue to our Discussion section (fifth paragraph).</p><p>Ultimately, we believe the variance analyses described in this section to be technically novel and uniquely enabled by PhILR. Even if future work were to determine our ecological conclusions dubious, we believe it a service to the community to highlight new analytical approaches that could eventually prove useful when interpreted in some other manner. Given this novelty, as well as the measures we took to avoid artifact, we therefore elected to retain <xref ref-type="fig" rid="fig4">Figure 4</xref> (albeit in the setting of a more careful discussion). Still, if the reviewers still have strong reservations, we will gladly remove this section from our final manuscript.</p><p><italic>4) There was consensus among the reviewers that the authors could provide more guidance to the non-specialists about when this algorithm should be used. As reviewer #3 put it, when and why should a reader choose the PhILR approach and when should it be avoided.</italic> </p><p>We appreciate this suggestion and have expanded on when the PhILR transform should be used and its limitations in our Discussion (last paragraph): “We foresee the PhILR transform being used as a default transformation prior to many microbiota analyses, particularly if a phylogenetic perspective is desired. For example, the PhILR transform could be used in lieu of the conventional log transform, which is often the default choice in microbiota analysis but not robust to compositional effects.”</p><p>Based on comments of reviewer #3 we have also added a Discussion paragraph discussing inference in terms of the changes of the relative abundance of individual taxa rather than balance values (seventh paragraph). This paragraph points out how single taxon analyses can actually be carried out after the ILR transform, by applying an inverse transform to model results.</p><p><italic>5) The authors should be explicit about what filtering and other pre-processing steps were used and whether those choices substantially impacted the performance of their algorithm.</italic> </p><p>We agree with reviewers that these steps are important components of our analysis. Based on reviewer comments we have entirely rewritten the section of our Methods entitled ‘Datasets and Preprocessing’ in an attempt to clarify the preprocessing steps taken. In addition, we have created a new supplementary figure (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>) to visually illustrate how our taxon weighting scheme assigns weights to taxa based on data sparsity.</p><p>We have also designed and performed new benchmarking analyses showing how data filtering choices affect model output (<xref ref-type="supplementary-material" rid="SD5-data">Supplementary file 2</xref>). For this analysis we redid our benchmarking results from <xref ref-type="fig" rid="fig2">Figure 2B and 2C</xref> for the CSS dataset under 4 different OTU filtering strategies. Notably these results include the performance of the other distance / dissimilarity measures we compared and the Log transformed and Raw relative abundance data. The four filtering strategies were as follows:</p><p>1) Keep taxa seen with at least 10 counts across all samples (this was the settings used in <xref ref-type="fig" rid="fig2">Figure 2B and 2C</xref>);</p><p>2) Keep taxa that are seen with at least 2 counts in more than 1% of samples (settings used by McMurdie and Holmes (8));</p><p>3) Keep all taxa that represent at least 0.005% of total reads (settings suggested by Qiime pipeline (9));</p><p>4) Keep all taxa that are at least 0.1% abundant in any sample (settings used by Gloor and Reid (10)).</p><p>The resulting 4 versions of the CSS dataset varied in the number of OTUs remaining by 16-fold (minimum of 366 and maximum of 6142). In spite of this wide variation, we found PhILR’s results to be robust (<xref ref-type="supplementary-material" rid="SD5-data">Supplementary file 2</xref>).</p><p><italic>Reviewer #1:</italic> </p><p><italic>[…] Suggestions for improvement follows:</italic> </p><p><italic>1) The mathematical description of the algorithm could be improved in terms of its clarity. For example, it is not always clear how the pluses and minuses in the second equation of the subsection “The ILR Transform” are defined. It is not made immediately clear that the leftmost term (sqrt(ni+ * ni- / (ni+ + ni-)) in that equation is a correction for branch length. For the equation in the subsection “Addressing sparsity through weighting taxa”, please use parentheses to emphasize that the formula is sqrt(sum(xj)) * ((sum(cj 1…N)) ^ 1/N and not sqrt(sum(xj))^N * sqrt(sum(cj 1…N))</italic> </p><p>Based on reviewer comments we have made numerous revisions aimed at improving the clarity of the Methods section entitled ‘The ILR Transform’. We do note that the term <italic>(sqrt(ni+ * ni- / (ni+ + ni-))</italic> is not a correction for branch length but is the scaling term that ensures the ILR basis elements have unit length. This term can be thought of as a scaling factor that ensures that balances with different numbers of descendant tips are still comparable on the same scale. We have attempted to clarify this point in our revised manuscript. We have also rearranged the equation for taxa weights in the section entitled ‘Soft thresholding through weighting taxa’ to avoid potential confusion pointed out by the reviewer.</p><p><italic>2) A limitation of working in ratio space in 16S data is what to do with all of the zeros in the spreadsheet (the &quot;sparse data&quot; problem). There is nothing inherent to the balancing algorithm that can deal with this problem (the sum in the denominator of the balance obviously can't be zero). The authors therefore require some kind of pseudo-count scheme and they have settled on one (given in the equation in subsection “Addressing sparsity through weighting taxa”) which is a function of the number of samples. If I am reading their formula correctly, the weight given to a taxa with 1 read in one sample and zero in all others would be very close to the sqrt(number of samples). The authors might consider giving this as an example and explicitly noting that their method has some similarity to adding the sqrt(number of samples) as a pseudo-count.</italic> </p><p>We regret our lack of clarity regarding how sparsity was handled. Please note that the scheme referenced by the reviewer is our ‘taxa weighting’ strategy. This strategy is meant to be independent of how zero-replacement is handled (in our case, we add a pseudo count of 1). We hope the reviewer will find the new description of our taxa weights and sparsity to be clearer (as referenced in response to Essential revision 1). We have also added a new figure (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>), which illustrates the weights assigned by our ‘taxa weighting’ to individual taxa.</p><p><italic>3) I struggled a bit with the variance analysis which concludes the Results sections. In the second paragraph of the subsection 2Balance variance and microbiota assembly” it is argued that &quot;When the variance of a balance between two clades approaches zero, the mean abundance of taxa in each of the two clades will be linearly related and thus exhibit shared dynamics across microbial habitats&quot;. While this is true (and must be true mathematically as when the variance approaches zero, the ratio of the two normalized abundances of the clades is constant, which means they will become perfectly linearly related with a positive slope), it's not clear to me that a high variance necessarily means &quot;exclusionary dynamics across samples&quot;. I don't see how a high variance in this number indicated anything about how direct or indirect the interactions are within the tree. There are lots of reasons two clades could lack perfect linear correlation with a positive slope from direct competition to being completely unrelated biologically with abundances just shifting due to stochastic variation. Also, wouldn't variance have to be lower closer to the tips of the phylogenetic tree as the number of sequences is lower, so the pseudo-count has more of an effect depressing overall variance? Doesn't that explain <xref ref-type="fig" rid="fig4">Figure 4D-F</xref>? And if I am reading these graphs correctly, below the species level there are not enough datapoints to support modeling via localized regression one way or another. Although not central to the arguments of the paper, I found <xref ref-type="fig" rid="fig4">Figure 4</xref> to be less convincing than other sections of the paper.</italic> </p><p>We found these concerns helpful and valid, and we address them more fully in our response above to Essential revision 3. In short, based on these comments, we have dramatically narrowed our ecological interpretation of <xref ref-type="fig" rid="fig4">Figure 4</xref> and more clearly described our multiple efforts to avoid potential artifacts of analysis. We also shared the concern that variance would be lower closer to the tips due to the heightened effects of pseudocounts; we therefore did not use pseudocounts for this analysis and instead conditioned our analysis on non-zero counts while more strictly excluded taxa with many zeros (to avoid analyses involving pseudocounts). We also incorporated a permutation-based hypothesis test, which should account for biases associated with count variation.</p><p><italic>Reviewer #2:</italic> </p><p><italic>The manuscript introduces two new powerful ideas. They are: (a)construction of the sequential binary partition used to define</italic> </p><p><italic>ILR coordinates on the base of phylogenetic trees; (b) use therecently published balances in weighted compositions to account forphylogenetic distances between OTU's or taxa. Both ideas aredeveloped and applied successfully to benchmark data sets.</italic> </p><p><italic>For the originality of main ideas applied to microbiome analysis,the manuscript deserves publication.</italic> </p><p>We thank the reviewer for these comments. On a minor note, we clarify that we do not use the weighted ILR transform as a means for introducing the phylogenetic distances between OTUs. Rather, we use a weighted transform to down-weight the effects of taxa with many zero and near-zero counts. We refer to this as taxa weighting. To account for phylogenetic distances, we simply scale balances by the phylogenetic distance between descendant clades. We do acknowledge that there is a deeper connection between these two sets of weights; that is, there is a close relationship between linearly scaling an ILR balance and changing the reference measure of the simplex (see (11), equation 18 in Appendix B); but for simplicity, we have not highlighted this connection in this manuscript. We hope that the updated description of these weightings in both the Results and Methods sections will make this distinction clearer.</p><p><italic>Reviewer #3:</italic> </p><p><italic>The manuscript is, in general, written in a clear and logical manner with a minimum of technical jargon. <xref ref-type="fig" rid="fig1">Figures 1</xref>, <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig4">4</xref> are outstanding examples of data visualization and demonstrate the utility of this approach over others extant in the field. <xref ref-type="fig" rid="fig5">Figure 5</xref> seems an afterthought and could be combined with <xref ref-type="fig" rid="fig1">Figure 1</xref>, or made supplementary. The binary portion could also be completely described in the Methods without a figure.</italic> </p><p>We agree that <xref ref-type="fig" rid="fig5">Figure 5</xref> is much simpler than <xref ref-type="fig" rid="fig1">Figures 1</xref>–<xref ref-type="fig" rid="fig4">4</xref> and wished to make it a supplementary figure. However, formatting constraints would require making it supplementary to a parent figure. The most natural parent figure would be <xref ref-type="fig" rid="fig1">Figure 1</xref>, but we believe that <xref ref-type="fig" rid="fig5">Figure 5</xref>’s sign matrix representation of a binary tree would confuse readers at that point in the manuscript. For this reason, we have chosen to leave <xref ref-type="fig" rid="fig5">Figure 5</xref> in its current place.</p><p><italic><xref ref-type="fig" rid="fig2">Figure 2</xref>, and the associated descriptive text are somewhat underwhelming demonstrations of the utility of the approach, which, in theory, should clearly outperform all other methods if the compositional data approach is necessary. The use of box-plots probably does not aid the visual appeal.</italic> </p><p><italic>That the ILR based distance can seriously underperform the weighted unifrac metric is puzzling and cause for concern, since PhILR becomes another metric to be 'mined' to achieve the desired outcome.</italic> </p><p>As we describe more fully in our response to Essential revision 2 above, we do not agree that PhILR must always outperform other methods to motivate a compositional data approach to microbiome data. First, we argue that the need for compositionally robust tools for microbiome data analysis is well established (1-7). Second, we include these benchmarks to assuage any concerns that PhILR is somehow not compatible with desired downstream analyses, like ordination analysis or supervised learning. Third, we find it extremely unlikely that PhILR would always outperform any other method on all experiments. This is especially true when comparing to tools tested and specifically designed for microbiota analysis such as Weighted UniFrac.</p><p><italic>Does the PhILR partitioning scheme outperform a simple random binary partition? this is crucial to know.</italic> </p><p>As we state above in Essential revision 2, we strongly agree with reviewer #2’s comments. In the absence of branch length weights, all ILR transforms should perform equally. Moreover, we believe that much of PhILR’s utility derives from casting the resulting coordinates in the evolutionary framework afforded by use of a phylogenetic tree.</p><p><italic>There needs to be serious guidance given to the reader as to when and why to choose the PhILR approach and when not to. The same can be said for the classification methods shown, where the PhILR generally (but not always) outperforms relative abundance, but not log relative abundance. I am left to wonder if data analysis choices are driving these results.</italic> </p><p>We appreciate this guidance and have inserted a statement into the Discussion suggesting the use of PhILR as a default microbiota transformation, prior to further analyses, particularly when a phylogenetic perspective is desired (see Essential revision 4 for more details). Still, we do feel that an in-depth discussion of classification methods is beyond the scope of this work. Such choices are ultimately data driven and the subject of extensive research in the Machine Learning community. Our rationale for choosing 4 separate classification algorithms (both parametric and non-parametric) was simply to demonstrate that a range of algorithms can be applied to PhILR transformed data.</p><p><italic>Finally, I am puzzled as to why the authors chose to take a rigorous variance-based approach (ILR) and analyze it using a distance-based metric. It is established in the CoDa literature that Mahalanobis distances are often more appropriate for clustering based approaches and for outlier detection (see for example: <ext-link ext-link-type="uri" xlink:href="http://www.statistik.tuwien.ac.at/public/filz/papers/2010Compstat.pdf">http://www.statistik.tuwien.ac.at/public/filz/papers/2010Compstat.pdf</ext-link>). Did the authors examine other distances?</italic> </p><p>While the Mahalanobis distance is a very useful tool for CoDa (and data analysis in general), we believe its use is neither simple nor standard practice. We therefore feel it more appropriate to leave this as a potential improvement on the PhILR method for cases where outliers are a chief concern.</p><p><italic>I believe that <xref ref-type="fig" rid="fig4">Figure 4</xref> is somewhat over-interpreted. Subsection “Balance variance and microbiota assembly”, last paragraph: There are many technical reasons such as inefficient clustering, etc. that closely related sequences (called bacteria here) could exhibit strong correlations. Reading Lovell (referenced in this manuscript), and the points shown in 4G-L, indicate that an alternative explanation to that given in the text (see aforementioned subsection, end of second paragraph) is that a higher balance variance would be compatible with a model of indifference rather than competition since the vast majority of high variance ratio balances are likely to be non-correlated balances (Lovell 2015). Such non-correlated balances persist even out to the extreme tails and there is as yet no general principled approach to identify negative correlations in compositions.</italic> </p><p>We thank the reviewer for this astute observation and have removed our ecological interpretation of higher balance variances. Please see our above response to Essential revision #3 for additional details.</p><p><italic>Introduction, last paragraph: “the accuracy of distance…” – this is a strong statement to make as the underlying standard of truth is assumed, not known from first principles.</italic> </p><p>Thank you for pointing this out. We agree it was an overly strong statement and in our revised draft, we have softened it to read:</p><p>“the accuracy of supervised classification methods on our benchmark datasets was matched or improved with PhILR transformed data”</p><p><italic>Subsection “Addressing sparsity through weighting taxa”, first paragraph: I would argue that total read counts contain information on precision, not variance. It is hard to square this statement with the otherwise compositional approach used in the paper.</italic> </p><p>We have updated our discussion of this issue throughout the paper to reference precision rather than variance. Nevertheless, although we are of course strong proponents of compositional approaches, we do believe that including uncertainty from count data could lead to exciting advances in the analysis of microbiota data, which we briefly describe in our revised Discussion (sixth paragraph).</p><p><italic>Subsection “Addressing sparsity through weighting taxa”, second paragraph: Why use a prior of one. The supplement that I found did not support the assertion that the prior chosen had little effect. This needs to be clarified.</italic> </p><p>We regret the lack of clarity in this area. The equation referenced represents our strategy for how taxa weights were chosen. This strategy is meant to be independent of how zero-replacement is handled (in our case, we add a pseudo-count of 1). We acknowledge our choice of pseudo-count is a heuristic, which was supported largely by our benchmarking results (<xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>) and does not come with any optimality guarantees. We did investigate how changing the pseudo-count added to the table affected our benchmarking results. Changing this value from 1 to 2, 3, or 10 had minimal effect (also <xref ref-type="supplementary-material" rid="SD4-data">Supplementary file 1</xref>). We have tried to clarify our description of taxa weights as well as our handling of zero values in the revised manuscript (see our response to Essential revision 1, above).</p><p><italic>Subsection “Human Microbiome Project (HMP)”: What is the effect of filtering and preprocessing on the method? As with many methods papers, the arbitrary choices here have the potential to become the accepted norm later without evidence.</italic> </p><p>We understand this concern and now tested the effects of alternate filtering and preprocessing schemes on our method. In short, the effects are minimal on PhILR. Please see our response to Essential revision 5 above for more detail.</p><p><italic>Subsection “Supervised Classification”, first paragraph: Were the log-transformed data not scaled? if not, this is a problem since it is not a fair comparison.</italic> </p><p>To preface, we understand this comment to be asking whether the log transformed data were scaled in the sense of how scaling is often applied in machine learning; that is, each variable is often scaled to a unit normal distribution or to exist between 0 and 1. If indeed this is what the reviewer was asking, then no, the log-transformed data were not scaled. But, then again, according to this criterion, the PhILR transformed data were also not scaled.</p><p>Alternatively, if the reviewer is referring to the scaling of the ILR basis elements that is part of the definition of the ILR transform (this is the <inline-formula><mml:math id="inf88"><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> term in the transform), we are not aware of an obvious analogy between this and a potential scaling step for the log transform that is commonly used.</p><p>Bibliography:</p><p>1) Jackson DA (1997) Compositional data in community ecology: The paradigm or peril of proportions? Ecology 78(3):929-940.</p><p>2) Friedman J &amp; Alm EJ (2012) Inferring correlation networks from genomic survey data. PLoS Comput Biol 8(9):e1002687.</p><p>3) Aitchison J (1986) The statistical analysis of compositional data (Chapman and Hall, London; New York).</p><p>4) Lovell D, Müller W, Taylor J, Zwart A, &amp; Helliwell C (2011) Proportions, percentages, ppm: do the molecular biosciences treat compositional data right. Compositional Data Analysis: Theory and Applications, eds Pawlowsky-Glahn V &amp; Buccianti A (John Wiley &amp; Sons, Ltd.), pp 193-207.</p><p>5) Gloor GB, Macklaim JM, Vu M, &amp; Fernandes AD (2016) Compositional uncertainty should not be ignored in high-throughput sequencing data analysis. Austrian Journal of Statistics 45(4):73.</p><p>6) Li HZ (2015) Microbiome, Metagenomics, and High-Dimensional Compositional Data Analysis. Annual Review of Statistics and Its Application, Vol 2 2(1):73-94.</p><p>7) Tsilimigras MC &amp; Fodor AA (2016) Compositional data analysis of the microbiome: fundamentals, tools, and challenges. Ann Epidemiol 26(5):330-335.</p><p>8) McMurdie PJ &amp; Holmes S (2013) phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data. PLoS One 8(4):e61217.</p><p>9) Navas-Molina JA, et al. (2013) Advancing our understanding of the human microbiome using QIIME. Methods Enzymol 531:371-444.</p><p>10) Gloor GB &amp; Reid G (2016) Compositional analysis: a valid approach to analyze microbiome high-throughput sequencing data. Can J Microbiol 62(8):692-703.</p><p>11) Egozcue JJ &amp; Pawlowsky-Glahn V (2016) Changing the Reference Measure in the Simplex and its Weightings Effects. Austrian Journal of Statistics 45(4):25-44.</p></body></sub-article></article>