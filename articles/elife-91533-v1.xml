<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">91533</article-id><article-id pub-id-type="doi">10.7554/eLife.91533</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>Theoretical principles explain the structure of the insect head direction circuit</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-332668"><name><surname>Vilimelis Aceituno</surname><given-names>Pau</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1218-4009</contrib-id><email>pau@ini.uzh.ch</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-332669"><name><surname>Dall'Osto</surname><given-names>Dominic</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9549-4490</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-329842"><name><surname>Pisokas</surname><given-names>Ioannis</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7426-3207</contrib-id><email>pisokasi@janelia.hhmi.org</email><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="pa1">‡</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Institute of Neuroinformatics, University of Zürich and ETH Zürich</institution><addr-line><named-content content-type="city">Zurich</named-content></addr-line><country>Switzerland</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01nrxwf90</institution-id><institution>School of Informatics, University of Edinburgh</institution></institution-wrap><addr-line><named-content content-type="city">Edinburgh</named-content></addr-line><country>United Kingdom</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>University of Texas at Austin</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>University of Texas at Austin</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="present-address" id="pa1"><label>‡</label><p>Janelia Research Campus, Howard Hughes Medical Institute, Ashburn, United States</p></fn></author-notes><pub-date publication-format="electronic" date-type="publication"><day>30</day><month>05</month><year>2024</year></pub-date><volume>13</volume><elocation-id>e91533</elocation-id><history><date date-type="received" iso-8601-date="2023-08-02"><day>02</day><month>08</month><year>2023</year></date><date date-type="accepted" iso-8601-date="2024-03-28"><day>28</day><month>03</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2023-07-06"><day>06</day><month>07</month><year>2023</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.07.05.547838"/></event></pub-history><permissions><copyright-statement>© 2024, Vilimelis Aceituno, Dall'Osto et al</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Vilimelis Aceituno, Dall'Osto et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-91533-v1.pdf"/><abstract><p>To navigate their environment, insects need to keep track of their orientation. Previous work has shown that insects encode their head direction as a sinusoidal activity pattern around a ring of neurons arranged in an eight-column structure. However, it is unclear whether this sinusoidal encoding of head direction is just an evolutionary coincidence or if it offers a particular functional advantage. To address this question, we establish the basic mathematical requirements for direction encoding and show that it can be performed by many circuits, all with different activity patterns. Among these activity patterns, we prove that the sinusoidal one is the most noise-resilient, but only when coupled with a sinusoidal connectivity pattern between the encoding neurons. We compare this predicted optimal connectivity pattern with anatomical data from the head direction circuits of the locust and the fruit fly, finding that our theory agrees with experimental evidence. Furthermore, we demonstrate that our predicted circuit can emerge using Hebbian plasticity, implying that the neural connectivity does not need to be explicitly encoded in the genetic program of the insect but rather can emerge during development. Finally, we illustrate that in our theory, the consistent presence of the eight-column organisation of head direction circuits across multiple insect species is not a chance artefact but instead can be explained by basic evolutionary principles.</p></abstract><abstract abstract-type="plain-language-summary"><title>eLife digest</title><p>Insects, including fruit flies and locusts, move throughout their environment to find food, interact with each other or escape danger. To navigate their surroundings, insects need to be able to keep track of their orientation. This tracking is achieved through visual cues and integrating information about their movements whilst flying so they know which direction their head is facing.</p><p>The set of neurons responsible for relaying information about the direction of the head (also known as heading) are connected together in a ring made up of eight columns of cells. Previous studies showed that the level of activity across this ring of neurons resembles a sinusoid shape: a smooth curve with one peak which encodes the animal’s heading. Neurons downstream from this eight-column ring, which relay velocity information, also display this sinusoidal pattern of activation.</p><p>Aceituno, Dall’Osto and Pisokas wanted to understand whether this sinusoidal pattern was an evolutionary coincidence, or whether it offers a particular advantage to insects. To answer this question, they established the mathematical criteria required for neurons in the eight-column ring to encode information about the heading of the animal. This revealed that these conditions can be satisfied by many different patterns of activation, not just the sinusoidal shape.</p><p>However, Aceituno, Dall’Osto and Pisokas show that the sinusoidal shape is the most resilient to variations in neuronal activity which may impact the encoded information. Further experiments revealed that this resilience only occurred if neurons in the circuit were connected together in a certain pattern.</p><p>Aceituno, Dall’Osto and Pisokas then compared this circuit with experimental data from locusts and fruit flies and found that both insects exhibit the predicted connection pattern. They also discovered that animals do not have to be born with this neuronal connection pattern, but can develop it during their lifetime.</p><p>These findings provide fresh insights into how insects relay information about the direction of their head as they fly. They suggest that the structure of the neuronal circuit responsible for encoding head direction was not formed by chance but instead arose due to the evolutionary benefits it provided.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>head direction cells</kwd><kwd>compass system</kwd><kwd>navigation</kwd><kwd>encoding</kwd><kwd>Hebbian plasticity</kwd><kwd><italic>Schistocerca gregaria</italic></kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd><italic>D. melanogaster</italic></kwd><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000332</institution-id><institution>Royal Society of Edinburgh</institution></institution-wrap></funding-source><award-id>Saltire Early Career Fellowship</award-id><principal-award-recipient><name><surname>Pisokas</surname><given-names>Ioannis</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id><institution>Swiss National Science Foundation</institution></institution-wrap></funding-source><award-id>Project Grant 182539</award-id><principal-award-recipient><name><surname>Vilimelis Aceituno</surname><given-names>Pau</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Three theoretical principles explain the neural activity observed in the head direction circuit of insects, the connectivity pattern underlying the circuit, and how the ubiquitous eight-column circuit structure emerged from evolutionary processes.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Insects exhibit an impressive ability to navigate the world, travelling long distances to migrate, find food or reach places of interest before returning to their nests (<xref ref-type="bibr" rid="bib37">Müller and Wehner, 1988</xref>; <xref ref-type="bibr" rid="bib34">Menzel et al., 1996</xref>; <xref ref-type="bibr" rid="bib17">Heinze et al., 2013</xref>; <xref ref-type="bibr" rid="bib5">Collett, 2019</xref>), a feat that requires them to keep track of their orientation across long journeys (<xref ref-type="bibr" rid="bib33">Mappes and Homberg, 2004</xref>; <xref ref-type="bibr" rid="bib35">Merlin et al., 2012</xref>; <xref ref-type="bibr" rid="bib55">Warren et al., 2019</xref>; <xref ref-type="bibr" rid="bib5">Collett, 2019</xref>; <xref ref-type="bibr" rid="bib3">Beetz et al., 2022</xref>). This orientation tracking is achieved by the use of visual cues as well as integrating angular velocity signals over time to maintain a heading estimate relative to a starting angle (<xref ref-type="bibr" rid="bib44">Seelig and Jayaraman, 2015</xref>; <xref ref-type="bibr" rid="bib49">Taube, 2007</xref>), known as <italic>heading integration</italic>.</p><p>Electrophysiological and calcium imaging studies have shown that the neural population encoding the head direction in insects has a sinusoid-shaped activation pattern (<xref ref-type="bibr" rid="bib27">Labhart, 1988</xref>; <xref ref-type="bibr" rid="bib28">Labhart, 2000</xref>; <xref ref-type="bibr" rid="bib31">Loesel and Homberg, 2001</xref>; <xref ref-type="bibr" rid="bib38">Pfeiffer et al., 2005</xref>; <xref ref-type="bibr" rid="bib39">Pfeiffer and Homberg, 2007</xref>; <xref ref-type="bibr" rid="bib25">Kinoshita et al., 2007</xref>; <xref ref-type="bibr" rid="bib16">Heinze et al., 2009</xref>; <xref ref-type="bibr" rid="bib18">Homberg et al., 2011</xref>; <xref ref-type="bibr" rid="bib11">El Jundi et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">El Jundi et al., 2019</xref>). Furthermore, downstream neural populations also encode velocity signals as sinusoidal activations (<xref ref-type="bibr" rid="bib32">Lyu et al., 2022</xref>).</p><p>Theoretical work has speculated that this recurring motif of sinusoidal activity patterns might be so prevalent because it enables easy elementwise vector addition, where vectors encoded as sinusoidal activity waveforms can be added together to give a sinusoidal waveform encoding the sum of the vectors (<xref ref-type="bibr" rid="bib50">Touretzky et al., 1993</xref>; <xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>; <xref ref-type="bibr" rid="bib54">Vickerstaff and Di Paolo, 2005</xref>). This allows the encoded heading to be easily used by downstream circuitry to track the insect’s position (<xref ref-type="bibr" rid="bib36">Mittelstaedt, 1985</xref>; <xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>; <xref ref-type="bibr" rid="bib54">Vickerstaff and Di Paolo, 2005</xref>; <xref ref-type="bibr" rid="bib14">Haferlach et al., 2007</xref>; <xref ref-type="bibr" rid="bib57">Wessnitzer et al., 2008</xref>; <xref ref-type="bibr" rid="bib41">Sakura et al., 2008</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>). Further studies have shown that models closely aligned with biological data can indeed implement heading integration using sinusoidal activity patterns (<xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>; <xref ref-type="bibr" rid="bib52">Turner-Evans et al., 2020</xref>), and that such circuits can be learned (<xref ref-type="bibr" rid="bib53">Vafidis et al., 2022</xref>).</p><p>Here, we show that enabling easy vector addition cannot be the unique driving factor for the presence of sinusoidal heading encodings, as many other circuits with different activity patterns can perform vector addition in the same way. This finding led us to question whether the sinusoidal activation patterns seen in insect navigation circuits are a coincidence, or if they might offer a particular functional advantage that was selected for during evolution.</p><p>To address this question, we consider the basic principles necessary for a circuit encoding direction. Of all the circuits fulfilling these requirements, the sinusoidal activity pattern offers the best resilience to noise for the encoded information. However, obtaining this activity requires a circuit with a specific connectivity pattern between neurons. Thus, our theory predicts that the heading integration circuit will have a sinusoidal connectivity pattern. We compare our predicted circuit with connectivity data for the desert locust (<italic>Schistocerca gregaria</italic>) and fruit fly (<italic>Drosophila melanogaster</italic>) using network analysis tools, showing a strong agreement. We then ask how an insect brain might develop such a circuit, finding that a simple Hebbian learning rule is sufficient. Finally, we combine ideas from replication dynamics with our theory, which leads us to the conclusion that the eight-column structure is a consequence of basic theoretical principles, rather than an evolutionary coincidence.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A theoretical circuit for heading integration</title><p>We consider a population of <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> ‘compass neurons’ with an activity that encodes the direction of the insect as an angular variable <italic>θ</italic>. We represent the activity of this population by a vector where each element corresponds to the activity of one neuron, <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. We take <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> neurons, consistent with data from many insect species which possess an eight-column organisation, with each column encoding a different direction (<xref ref-type="bibr" rid="bib19">Honkanen et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>).</p><p>Each neuron’s activity is updated depending on its current firing rate and the inputs it receives, both from other neurons in the circuit and externally. We formulate this update rule as follows:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the circuit’s weight matrix, representing the connections between neurons; <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϕ</mml:mi></mml:mstyle></mml:math></inline-formula> is the neural activation function, that converts the total neural input into an output firing rate; and <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is the external input that encodes the insect’s angular velocity, via the PEN population of neurons (<xref ref-type="bibr" rid="bib13">Green et al., 2017</xref>; <xref ref-type="bibr" rid="bib51">Turner-Evans et al., 2017</xref>; <xref ref-type="bibr" rid="bib42">Sayre et al., 2021</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>; <xref ref-type="bibr" rid="bib52">Turner-Evans et al., 2020</xref>; <xref ref-type="bibr" rid="bib21">Hulse et al., 2021</xref>).</p><p>To simplify our derivations we allow the neural activity values to be both positive and negative, interpreting these values as being relative to a baseline neural firing rate. Similarly, we allow the weights to be both positive and negative, a common simplification in computational models (<xref ref-type="bibr" rid="bib29">Li et al., 2023</xref>; <xref ref-type="bibr" rid="bib7">Cornford et al., 2020</xref>; <xref ref-type="bibr" rid="bib26">Kriegeskorte and Golan, 2019</xref>). This simplification will be addressed in section ‘Comparing the predicted circuit with biological data’ where we compare our model with experimental data.</p><sec id="s2-1-1"><title>Mathematical principles for neural heading integration</title><p>A circuit capable of performing heading integration must fulfil the requirements outlined in <xref ref-type="table" rid="table1">Table 1</xref>. The first two requirements allow us to establish the family of possible path integration circuits. We then use the principle of noise minimisation to determine which circuits perform best.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Requirements for a heading integration circuit.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"><inline-graphic mimetype="image" mime-subtype="jpeg" xlink:href="elife-91533-inf001-v1.tif"/></th><th align="left" valign="top"><inline-graphic mimetype="image" mime-subtype="jpeg" xlink:href="elife-91533-inf002-v1.tif"/></th><th align="left" valign="top"><inline-graphic mimetype="image" mime-subtype="jpeg" xlink:href="elife-91533-inf003-v1.tif"/></th></tr></thead><tbody><tr><td align="left" valign="top">Circular topology</td><td align="left" valign="top">Rotational symmetry</td><td align="left" valign="top">Noise minimisation</td></tr><tr><td align="left" valign="top">The activity should have the same topology as the variable it is encoding to prevent discontinuities. To encode heading, the activity should have the topology of a 1D circle.</td><td align="left" valign="top">The heading integration circuit should work similarly, irrespective of the direction in which the insect travels. There should not be a bias for any direction.</td><td align="left" valign="top">The circuit should minimise the noise of the neural representation so the insect can navigate as precisely as possible.</td></tr></tbody></table></table-wrap></sec><sec id="s2-1-2"><title>Constraints on the neural activity</title><p>The neural activity should encode the insect’s head direction with a matching topology. Because the heading is a single angular variable, the topology of the activity space should be a 1D circle.</p><p>Furthermore, the symmetry requirement implies that rotating the heading of the insect should rotate the neural activity vector without changing its shape. Concretely, whether the insect is facing north or east, the activity of the neural population as a whole should be the same, but with the identity of the neuron with each activity value being different.</p><p>We can formalise the symmetry requirement by considering a head direction, <italic>θ</italic>, and a rotation by an integer multiple, <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>k</mml:mi></mml:mstyle></mml:math></inline-formula>, of the angular spacing between neurons, <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle></mml:math></inline-formula>. In this case, individual neuron activities follow the relation<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mspace width="0.667em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which enforces that the neural activity vector is circularly rotated as the head direction changes. This relation can be expressed in the Fourier domain where, by the shift property, the circular rotation becomes a multiplication by a complex exponential:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mfrac><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>k</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:msqrt></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the index of the spatial frequency, also called the harmonic. Activity with spatial frequency <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> has <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> ‘bumps’ around the ring.</p><p>Since the complex exponential has unit norm, the magnitude of the Fourier components remains the same for any rotation, <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mspace width="mediummathspace"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Therefore, the shape of the activity pattern, <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>≡</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, can also be fully specified by its Fourier domain representation, <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math></inline-formula>, and the phase of this activity profile around the network encodes the heading of the insect:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>θ</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Taking the inverse Fourier transform with the constraint that the neural activities must be real, we get the following form for the neural activity,<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>It should be noted that the phase offset, <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>θ</mml:mi><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula>, of each cosine waveform scales with the spatial frequency. This is because higher frequency waveforms have shorter wavelengths (in terms of number of neurons), so need their phases to rotate more quickly to move at the same speed around the network.</p><p>To explain this in more detail, we consider the case where this scaling is not used and the phase offset is the same for all harmonics, shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> top row. For <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> (red line in <xref ref-type="fig" rid="fig1">Figure 1</xref>), the waveform has one bump and a wavelength of 8 neurons, so a 180° rotation corresponds to the waveform moving 4 neurons. But for <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> (blue line in <xref ref-type="fig" rid="fig1">Figure 1</xref>), the waveform has two bumps and a wavelength of 4 neurons, so a 180° rotation corresponds to moving only 2 neurons, while a 4 neuron shift would correspond to a full rotation. The fact that the waveforms for different frequencies move at different speeds through the network implies that, if multiple spatial frequencies are used to independently encode the heading, their positions would not be aligned and the combined waveform would change shape as different angles are encoded (purple line in <xref ref-type="fig" rid="fig1">Figure 1</xref>). This violates the rotational symmetry principle, as the activity would look significantly different when the insect is facing north compared to south.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Encoding heading with multiple harmonics.</title><p>Each panel shows the activity profiles encoding a particular heading value. Curves <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>, and <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> respectively denote the waveform of the first harmonic, second harmonic, and the sum of the two. The vertical dashed (<inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> peak) and dotted lines (<inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> peaks) indicate the neurons which respond maximally for the first and second harmonic, respectively. Top row: Encoding the heading as the sum of two independent harmonics causes the waveform to change shape as the insect rotates, because the waveform for each harmonic can only rotate a distance of <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mn>360</mml:mn><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∘</mml:mo></mml:mrow></mml:msup><mml:mi>f</mml:mi></mml:mfrac></mml:mstyle></mml:math></inline-formula> as the insect rotates a full revolution to ensure an unambiguous representation. Bottom row: If all harmonics are aligned to rotate at the same speed, the combined waveform shape does not change. However, this alignment implies that higher harmonic waveforms cannot be uniquely mapped back to a heading: here the <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> encoding is the same for <italic>θ</italic> = 0° and 180°.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig1-v1.tif"/></fig><p>To solve this problem of misaligned harmonics, we return to the case specified in <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> where the phase offset is scaled linearly with the spatial frequency so that all waveforms move at the same speed and rotational symmetry is ensured, which is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref> bottom row. For a network with <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> neurons, a 180° rotation shifts the activity waveform by 4 neurons. This 4 neuron shift corresponds to a <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>4</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mstyle></mml:math></inline-formula> or 180° phase offset for the <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> waveform, which has a wavelength of 8 neurons, but a <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>4</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:mstyle></mml:math></inline-formula> or 360° phase offset for the <inline-formula><mml:math id="inf30"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> waveform, which has a wavelength of 4 neurons. While this maintains rotational symmetry, it implies that the <inline-formula><mml:math id="inf31"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> waveform is the same whether the heading angle 0° or 180° is encoded. As a consequence, a higher harmonic waveform (having <inline-formula><mml:math id="inf32"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) cannot on its own specify the encoded angle. The activity in all harmonics must be considered simultaneously to decode the angle, but even then this decoding might not be unique in the presence of noise (see section ‘Ambiguities in multiple harmonics decoding with drift’). The difficulties associated with encodings utilising multiple harmonics will be further addressed in the following sections.</p></sec><sec id="s2-1-3"><title>Constraints on heading integration circuits</title><p>The basic assumptions outlined earlier also constrain the possible heading integration circuits – such circuits should allow for neural activity with the required topology and rotational symmetry to stably exist and propagate. Together, these two principles require that the activity in the circuit should have a constant total magnitude. We consider that this constraint is enforced by the nonlinear neural activation function, <italic>ϕ</italic>, in <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, as detailed in section ‘Path integration dynamics for heading and position’.</p><p>If the network activity is at the desired level, and the external input <inline-formula><mml:math id="inf33"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is projected onto the ring attractor such that it does not alter the total network activity, then we can consider the network dynamics to be linear at this operating point. Therefore, while within the space of possible activities that corresponds to the ring attractor, our circuit dynamics are effectively described as,<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The rotational symmetry principle also applies to the network. For the same shaped activity waveform to be able to stably exist at any position around the network, the network connectivity should also be rotationally symmetric. For example, the connection strength between the neurons encoding the north and north-east directions should be the same as between those encoding south and south-west. Mathematically, this imposes that the weight matrix, <inline-formula><mml:math id="inf34"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, is circulant, specifically that <inline-formula><mml:math id="inf35"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. This matrix is fully specified by its first row, called the <italic>connectivity profile</italic> and denoted <inline-formula><mml:math id="inf36"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, meaning that we can express the product of the matrix with the neural activity as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which can be simplified in terms of the convolution operation,<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Considering the case where the insect is not moving, <inline-formula><mml:math id="inf37"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, and the network activity is stable, <inline-formula><mml:math id="inf38"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, we can combine <xref ref-type="disp-formula" rid="equ6">Equation 6</xref> and <xref ref-type="disp-formula" rid="equ8">Equation 8</xref> to get a relation for the stable network activity<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>In the Fourier domain, this simplifies into<disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>As for the activity waveform analysis, we note that the Fourier transform is taken on the neural indices, not on the temporal domain.</p><p>Here, we have <inline-formula><mml:math id="inf39"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> equations that have to be satisfied, since the Fourier transform of an <inline-formula><mml:math id="inf40"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional vector is also <inline-formula><mml:math id="inf41"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>-dimensional. For each harmonic frequency <inline-formula><mml:math id="inf42"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula>, <xref ref-type="disp-formula" rid="equ10">Equation 10</xref> has two solutions:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, which implies that activity with this spatial frequency is stable in the network, and therefore that it can encode the insect’s heading.</p></list-item><list-item><p><inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, meaning that the activity in this harmonic is zero, and thus nothing can be encoded in this frequency.</p></list-item></list></sec><sec id="s2-1-4"><title>Minimising noise propagation in the circuit</title><p>The only constraint on the connectivity weights given by <xref ref-type="disp-formula" rid="equ10">Equation 10</xref> is that, if a frequency is used for encoding then <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>. There is no restriction on the weights for the inactive harmonics – they remain free parameters.</p><p>However, non-encoding channels can still propagate noise, which would be prevented by setting <inline-formula><mml:math id="inf46"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>. To illustrate this, we consider white noise, denoted by <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ϵ</mml:mi></mml:mstyle></mml:math></inline-formula>, that is added to the neural activity. When this noisy activity evolves in accordance with the dynamics from <xref ref-type="disp-formula" rid="equ8">Equation 8</xref>, we have<disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the term <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mi>ϵ</mml:mi></mml:mstyle></mml:math></inline-formula> corresponds to noise and should therefore be dampened. We want to minimise the strength of that noise, which is quantified by its variance<disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtext mathvariant="bold">Var</mml:mtext></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext mathvariant="bold">E</mml:mtext></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mi>ϵ</mml:mi><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mtext mathvariant="bold">Var</mml:mtext></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Hence the magnitude of the noise that passes from one time interval to the next is modulated by the magnitude of the weight vector. By Parseval’s theorem,<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which implies that to minimise noise propagation in the network we should impose <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> for all harmonics, <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula>, where <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>. We show this in simulation in <xref ref-type="fig" rid="fig2">Figure 2</xref>, where only the first harmonic encodes information and we vary the weights of the other harmonics. The noise is indeed minimised if the weights for all non-encoding harmonics are set to zero.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Increased number of harmonics introduces more noise.</title><p>Increasing the number of active harmonic frequencies increases the effect of errors in the network. (<bold>A</bold>) Weight matrix profiles, <inline-formula><mml:math id="inf52"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, for networks with increasing numbers of harmonics. (<bold>B</bold>) Normally distributed noise with zero mean and standard deviation 0.3 was added to the network activity, then the network state updated until it reached steady state. Networks with fewer harmonics better filtered out noise. (<bold>C</bold>) Noise variance increases linearly as the number of active harmonics increases, as predicted by <xref ref-type="disp-formula" rid="equ12">Equation 12</xref>. The sample size was n=1000 trials for each active harmonics set, and the error bars show the standard deviation over trials.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig2-v1.tif"/></fig><p>This result establishes that all non-encoding harmonics in the network should be set to 0 to minimise noise propagation, and allows us to recover the circuit connectivity<disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf53"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is the set of harmonics used to encode the head direction, <inline-formula><mml:math id="inf54"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1...</mml:mn><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>:</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. The choice of <inline-formula><mml:math id="inf55"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> therefore determines both the harmonics used for encoding the angle in the activity and the connectivity of the circuit that supports this activity.</p><p>We leverage the same logic to prove that the number of encoding channels does not affect the signal-to-noise ratio in the network. If we have <inline-formula><mml:math id="inf56"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> encoding channels, each with the same activity, the total activity will grow linearly with <inline-formula><mml:math id="inf57"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula>. The noise will also grow with <inline-formula><mml:math id="inf58"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula>, meaning that the signal-to-noise ratio will remain constant.</p><p>We now return to the question of whether using one or multiple harmonics is better. As mentioned, the signal-to-noise ratio in the network remains constant as additional encoding channels, <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula>, are used. But additional channels imply additional harmonics, which by Parseval’s theorem require a higher total neural activity. If the total activity in the network is limited, the signal-to-noise ratio is in fact <italic>decreased</italic> when using more than one harmonic.<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>SNR</mml:mtext><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>c</mml:mi></mml:mfrac></mml:mstyle><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Additionally, as detailed in sections ‘Constraints on the neural activity’ and ‘Ambiguities in multiple harmonics decoding with drift’, circuits using multiple harmonics perform worse in high noise environments because they are not guaranteed to provide an unambiguous orientation encoding. Finally, as we will discuss in sections ‘Learning rules and development’ and ‘Convergence of Oja’s rule with multiple harmonics’, the use of multiple harmonics also complicates the circuit’s development. We therefore only select circuits that use a single harmonic for further analysis, reducing the number of possibilities to <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>.</p></sec></sec><sec id="s2-2"><title>Determining the optimal circuit</title><p>As we consider networks with <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> neurons, consistent with multiple insect species (<xref ref-type="bibr" rid="bib19">Honkanen et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>), the possible single harmonic circuits are <inline-formula><mml:math id="inf62"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula>, where the zeroth harmonic is discarded because it only represents the baseline neural activity. This gives the following activities and weights, derived from <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> and <xref ref-type="disp-formula" rid="equ14">Equation 14</xref><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The circuits for the first four harmonics are plotted in <xref ref-type="fig" rid="fig3">Figure 3</xref>, but not all of these circuits are valid. In particular, circuits with even spatial frequencies have multiple neurons with identical activity values because they share a common divisor with <inline-formula><mml:math id="inf63"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>, as explained in detail in section ‘Degenerate circuits’.</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Circuits for encoding with different harmonics.</title><p>We show four circuits corresponding to each of the individual harmonics <inline-formula><mml:math id="inf64"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> in panels (<bold>A</bold>, <bold>B</bold>, <bold>C</bold>, and <bold>D</bold>), respectively. Excitatory synapses are marked in red and inhibitory in blue. Neurons are shown in yellow with each having a black arrow that marks the direction to which it is tuned from <xref ref-type="disp-formula" rid="equ16">Equation 16</xref>. The <inline-formula><mml:math id="inf65"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> circuit is the simplest and constitutes our baseline. For the other cases we plot the original connectivity in the upper row and the rearranged network in the lower row. We find that the <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> circuit consists of two independent subnetworks encoding orthogonal directions, the <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula> case is identical to <inline-formula><mml:math id="inf68"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> after permuting neuron indices, and the <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> case results in two connected groups of neurons inhibiting each other, hence it can only encode one direction. As such, all cases either have a degenerate ring structure (<inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula>) or are equivalent to <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> after permutation.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig3-v1.tif"/></fig><p>For <inline-formula><mml:math id="inf72"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> there are only two unique activity values, <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>±</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext/><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula>, so this circuit can only encode one dimension, not a circular topology (see <xref ref-type="fig" rid="fig3">Figure 3D</xref>). For <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:math></inline-formula> (not plotted), there are four unique activity values, allowing the angle to be properly encoded. However, these circuits are degenerate because they are composed of two independent subcircuits, each encoding one direction (see <xref ref-type="fig" rid="fig3">Figure 3B</xref>). Because the weights connecting the two subcircuits are all zero, the activity in each subcircuit is independent of the activity in the other, and so the overall activity cannot be constrained to have the required circular topology.</p><p>All circuits with odd harmonic frequencies are equivalent. For example, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the connections in the circuit for <inline-formula><mml:math id="inf76"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula> are the same as those for the <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> circuit after the neuron identities are permuted. As detailed in section ‘Equivalence under permutation’, the frequencies <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> always give the same circuit because the odd frequencies are coprime with the number of neurons <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>.</p><p>Since the activities and weights of all the non-degenerate circuits <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> are the same as the base harmonic <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> up to a permutation, we choose the lowest harmonic <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, which gives us the following activity and weights:<disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>ω</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p></sec><sec id="s2-3"><title>Comparing the predicted circuit with biological data</title><p>Our theory proposes an optimally noise-resistant circuit for heading integration, and its corresponding activity. The prediction that heading should be encoded as a sinusoidal activity bump is consistent with previous theoretical models (<xref ref-type="bibr" rid="bib50">Touretzky et al., 1993</xref>; <xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>; <xref ref-type="bibr" rid="bib15">Hartmann and Wehner, 1995</xref>; <xref ref-type="bibr" rid="bib60">Zhang, 1996</xref>; <xref ref-type="bibr" rid="bib54">Vickerstaff and Di Paolo, 2005</xref>; <xref ref-type="bibr" rid="bib14">Haferlach et al., 2007</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>), as well as experimental evidence in both the locust and fruit fly (<xref ref-type="bibr" rid="bib16">Heinze et al., 2009</xref>; <xref ref-type="bibr" rid="bib51">Turner-Evans et al., 2017</xref>). We note, however, that data from the fruit fly shows a more concentrated activity bump than what would be expected from a perfect sinusoidal profile (<xref ref-type="bibr" rid="bib44">Seelig and Jayaraman, 2015</xref>; <xref ref-type="bibr" rid="bib51">Turner-Evans et al., 2017</xref>), and that calcium imaging (which was used to measure the activity) can introduce biases in the activity measurements (<xref ref-type="bibr" rid="bib45">Siegle et al., 2021</xref>; <xref ref-type="bibr" rid="bib20">Huang et al., 2021</xref>). Thus the sinusoidal activity we model is an approximation of the true biological process rather than a perfect description.</p><p>Importantly, our theory proposes that the optimally noise-resilient heading integration circuit should have synaptic weights that follow a sinusoidal pattern, even though such weights are not necessary for producing sinusoidal activity as discussed in section ‘Minimising noise propagation in the circuit’. This is the main prediction of our theory and we sought to validate it using connectivity data from the locust and fruit fly.</p><p>However, before we can directly compare our model with biological circuits, we must address a number of modelling simplifications:</p><list list-type="bullet"><list-item><p>In the model we considered a population of 8 neurons, but in insects there are eight neural columns, each with several neuron types (EPG, PEG, PEN, Delta7). Of these we model only the EPG (known as the compass neurons) which encode the integrated head direction.</p></list-item><list-item><p>The synaptic connections between neurons in our model can be both positive and negative, while biological neurons follow Dale’s law, meaning that a single neuron can either have only positive or only negative synapses.</p></list-item><list-item><p>The neural activity in the model was centred around zero and could have both positive and negative activity (firing rates), while real neurons only have positive firing rates.</p></list-item></list><p>Therefore, we simplified the biological connectivity to produce an equivalent circuit that could be directly compared with our model prediction. The neural population in our theoretical model corresponds to the biological EPG neurons, as these encode the integrated heading. We considered the other 3 neuron types that are part of the compass circuit (PEG, PEN, and Delta7 – see <xref ref-type="bibr" rid="bib23">Kakaria and de Bivort, 2017</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>) as just implementing connections between EPG neurons in accordance with biological constraints. We counted the number of different paths between EPG neurons, accounting for the sign of the connections (whether the path passed through an inhibitory Delta7 neuron), and used the net path count as a proxy for connectivity strength. This process is explained in detail in section ‘Path counting’.</p><p>We then computed the average connectivity profile, i.e., how each neuron connected to its neighbours around the ring, and compared this profile to the closest fitting sinusoid. Because the neuron gains, absolute synaptic strength and biophysical properties of the neurons are unknown, the units of the net path count are not necessarily equivalent to our abstract connection strength. We therefore fit an arbitrarily scaled and shifted sinusoid to the connection counts:<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> is the circular distance between 2 neurons while <italic>β</italic> and <italic>γ</italic> are constants that are fit to minimise the precision-weighted mean squared error compared with the experimental connectivity profile (see section ‘Fitting weights’).</p><p>Analysing the data from <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, we consider the shortest excitatory and inhibitory paths between EPG (also known as CL1a) neurons in the locust, which have lengths of 2 and 3, respectively. There are no direct connections of length 1, and all the paths of length ≥4 must pass through the same neuron-type multiple times. This path counting analysis for the locust is shown in <xref ref-type="fig" rid="fig4">Figure 4A</xref>, and the procedure is detailed in section ‘Path counting’. We find that the connectivity profile between neurons for the locust is very close to sinusoidal in shape, supporting our theoretical prediction.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Comparison to biological data.</title><p>The biological network models of (<bold>A</bold>) the locust and (<bold>B</bold>) the fruit fly, with four distinct neural populations each were simplified to equivalent networks with one population by counting paths of lengths 1, 2, and 3 between EPG neurons (which encode the integrated heading) and using the net signed path count as a proxy for connectivity strength. The average connectivity profile for each neuron to its neighbours around the ring was compared to the sinusoidal connectivity predicted by our theory. The locust network has no standard deviation because the data in <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, are based on light microscopy which couldn’t resolve variations between columns. Excitatory connections are shown in red and inhibitory connections in blue, while the strength of a connection is indicated by the line width.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig4-v1.tif"/></fig><p>For the fruit fly, we used data from <xref ref-type="bibr" rid="bib43">Scheffer et al., 2020</xref>, which provides synapse counts between pairs of neurons. These synapse counts were used as a proxy for connectivity strength, a view that has been validated in previous experiments (<xref ref-type="bibr" rid="bib30">Liu et al., 2022</xref>; <xref ref-type="bibr" rid="bib2">Barnes et al., 2022</xref>). After identifying the neurons and connections of interest, we grouped the neurons in eight columns following the logic presented in <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, with detailed methodology explained in section ‘Data preprocessing’. We repeated the path counting analysis for the fruit fly with synapse count data (<xref ref-type="fig" rid="fig4">Figure 4B</xref>), and found that while the data are noisy, the connectivity profile fits a single sinusoid pattern reasonably well. However, the high variability in the synapse counts makes our hypothesis difficult to differentiate from alternative shapes (see section ‘Fitting weights’).</p><p>Taken together, this analysis shows that our theory is consistent with experimental data – using binary connectivity data for the desert locust and synapse count data for the fruit fly.</p></sec><sec id="s2-4"><title>Learning rules and development</title><p>Having validated the connectivity of our theoretical circuit by comparing it to experimental data, we ask whether our circuit lends itself to biological development. Specifically, we show that even though our circuit requires precise connection strengths, this connectivity can be developed naturally by a Hebbian learning rule. Our approach follows from previous research which has shown that simple Hebbian learning rules can lead to the emergence of circular line attractors in large neural populations (<xref ref-type="bibr" rid="bib47">Stringer et al., 2002</xref>), and that a head direction circuit can emerge from a predictive rule (<xref ref-type="bibr" rid="bib53">Vafidis et al., 2022</xref>). In contrast to this work, we focus only on the self-sustaining nature of the heading integration circuit in insects and show that our proposed sinusoidal connectivity profile can emerge naturally.</p><p>Because the weight matrix is circulant, its eigenvalues are equal to the Fourier spectrum of its first row, which we derived to only have one nonzero value, for <inline-formula><mml:math id="inf84"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>. The network therefore only has a single eigenvalue and so projects activity into a single dimension. This operation is similar to classical dimensionality reduction methods such as principal component analysis, which can be implemented by Hebbian-like learning rules (<xref ref-type="bibr" rid="bib9">Dayan and Abbott, 2001</xref>). We thus analyse the effects of incorporating a modified Oja’s rule into our model, a classical variant of Hebbian learning where the synaptic strength between 2 neurons grows when both neurons are active simultaneously, and the total synaptic strength is regularised to prevent exploding weight growth,<disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the synaptic connection strength from neuron <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> to neuron <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>a</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are the pre- and post-synaptic activities, respectively, and <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>η</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mstyle></mml:math></inline-formula> is an adaptive learning rate where the plasticity is proportional to the rotational speed, whereas in the classical Oja’s rule it would be constant.</p><p>For our analysis we assume that the insect faces all possible directions, and therefore that the neural activity goes around the full circle. We then integrate the weight updates over some long period of time,<disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <italic>θ</italic> is the integration space. Applying the activity from <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>, we can find the fixed point of this update rule, when <inline-formula><mml:math id="inf91"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>:<disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>η</mml:mi><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>η</mml:mi><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>cos</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Combined with <xref ref-type="disp-formula" rid="equ7">Equation 7</xref> and <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>, this result means that if there is sinusoidal activity in the network, the weights will naturally converge to the optimal sinusoidal values by way of our variant of Oja’s rule. This leads to the emergence of sinusoidal activity and weights from self-consistency: initial noisy sinusoidal activity will enforce weights that are close to a sinusoid, and those weights will filter out noise to make the activity even closer to a sinusoid, which will in turn make the weights more sinusoidal. This process will iteratively make the activity and the weights converge to the solution from <xref ref-type="disp-formula" rid="equ17">Equation 17</xref>.</p><p>An important point in the use of Oja’s rule is that it would tend to concentrate the activity in a single harmonic. In a linear network, the harmonics would compete during learning, leading to one single harmonic emerging and all others being suppressed, as shown in section ‘Linear neurons’. For neurons with a nonlinear activation function, secondary harmonics would emerge, but would remain small under mild assumptions, as shown in section ‘Neurons with nonlinear activations’. Oja’s rule will still cause the weights to converge to approximately sinusoidal connectivity.</p><p>The finding that the weights will converge to a sinusoidal connectivity with learning has two interesting consequences from a biological standpoint: First, our circuit can emerge even when starting with only very coarse initial weights, without the need for high precision initial connectivity. Second, this simple plasticity rule allows the system to repair or recover from perturbations in its synapses as shown by simulations in <xref ref-type="fig" rid="fig5">Figure 5</xref>. However, this learning rule only applies to the weights that ensure stable, self-sustaining activity in the network. The network connectivity responsible for correctly integrating angular velocity inputs (given by the PEN to EPG connections in the fly) might require more elements than a purely Hebbian rule (<xref ref-type="bibr" rid="bib47">Stringer et al., 2002</xref>), such as the addition of a predictive component (<xref ref-type="bibr" rid="bib53">Vafidis et al., 2022</xref>).</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Recovery of synaptic weights with a Hebbian learning rule.</title><p>The synaptic weights converge to a sinusoidal pattern under our modified Oja’s rule when the network activity is dynamic and a sinusoidal input is provided. (<bold>A</bold>) The weights start at zero and slowly converge to the prescribed sinusoidal profile, showing that this connectivity can emerge from scratch. (<bold>B</bold>) The sinusoidal weights are perturbed by noise but learning ensures that the weight profile is corrected. In both cases the network’s initial activity is corrupted with zero mean Gaussian noise. Noisy sinusoidal input is provided to rotate the activity bump around the network at a constant speed of 1/8 neurons per timestep. The simulation runs for 100 periods. Parameters: <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo></mml:mstyle></mml:math></inline-formula> integration timestep <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>W</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig5-v1.tif"/></fig></sec><sec id="s2-5"><title>Evolution of the eight-column circuit</title><p>Having derived and experimentally validated the theoretical circuit, we now address another question: whether there might be a reason that insect head direction circuits have an eight-column architecture (<xref ref-type="bibr" rid="bib19">Honkanen et al., 2019</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>). The derivations leading to <xref ref-type="disp-formula" rid="equ17">Equation 17</xref> are valid for other values of <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>, so there is no a priori reason to expect <inline-formula><mml:math id="inf95"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>.</p><p>Our reasoning follows recent studies in genetics (<xref ref-type="bibr" rid="bib22">Johnston et al., 2022</xref>; <xref ref-type="bibr" rid="bib10">Dingle et al., 2018</xref>), which argue that an observed organism is more likely to have resulted from a simple than a more complex genome: evolution favours simplicity. We note that powers of two are easier to generate with replication dynamics than other numbers, because they just require each cell to divide a set number of times. Other numbers require that, at some point, two cells resulting from a division must behave differently, necessitating more complex signalling mechanisms and rendering this possibility less likely to have been developed by evolution without some other driving factor. We therefore expect <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> to be a power of two unless required to be otherwise.</p><p>As we show in section ‘Circuits with different neuron counts’, not all numbers of neurons enable a working circuit. The circuits for <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> are degenerate – either producing a single dimensional encoding, or two disconnected circuits that do not enforce the required circular topology. <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> is the smallest power of two that could result in a non-degenerate circuit. This hints at the possibility that the eight-column architecture is not a chance evolutionary artefact, but rather that it is the genetically simplest circuit capable of performing heading integration.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In this work we derived an optimal noise-minimising circuit for encoding heading and verified that this circuit matches experimental data from insects. Furthermore, we showed that such a circuit can be developed and maintained by a biological learning rule, and proposed a mathematical argument for the eight-column structure found in insect compass circuits. In this section, we discuss the implications and limitations of these contributions, and outline potential future work.</p><p>Heading integration circuits in insects have been extensively studied, with models ranging in complexity from simplified conceptual networks (<xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>; <xref ref-type="bibr" rid="bib6">Cope et al., 2017</xref>) to sophisticated models constrained by biological data and featuring multiple neuron types (<xref ref-type="bibr" rid="bib23">Kakaria and de Bivort, 2017</xref>; <xref ref-type="bibr" rid="bib48">Su et al., 2017</xref>; <xref ref-type="bibr" rid="bib24">Kim et al., 2017</xref>; <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>; <xref ref-type="bibr" rid="bib32">Lyu et al., 2022</xref>). Previous theoretical work has argued that a sinusoidal activity encoding is such a common motif in insect navigation because it facilitates elementwise vector addition (<xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>). However, this cannot be the only reason because as we show there is a whole family of circuits with different encoding patterns that enable easy vector addition. By showing that sinusoidal activity emerges from the theoretically most noise-resilient heading integration circuit, and verifying that the corresponding circuit matches experimental data, we close this explanatory gap.</p><p>We also show that our proposed circuit can be developed by a simple Hebbian-based learning rule, and that the presence of the eight-column structure can be explained from the perspective of replication dynamics. Both results align with the idea that evolution should be biased towards structures that are easier to encode in the genome (<xref ref-type="bibr" rid="bib22">Johnston et al., 2022</xref>; <xref ref-type="bibr" rid="bib1">Alon, 2007</xref>) and learn (<xref ref-type="bibr" rid="bib59">Zador, 2019</xref>). To the best of our knowledge, this is the first time that such arguments have been put forward in the context of a specific circuit with a specific function.</p><p>Our work still has some unaddressed limitations, in particular regarding the topology of the activity. The use of a circular topology to encode the head direction of the insect is valid only in 2D environments. But many species, including the fruit fly, can navigate in a 3D environment. We argue that even if these insects live in a 3D environment, the third dimension (up-down) is different from the other two due to gravity and the existence of a hard boundary (the ground). Further studies would be required to investigate the full effects of 3D motion.</p><p>We could also investigate circuits that integrate position, not only heading, which would require the activity to have a 2D plane topology instead of a circle. This would be particularly relevant for foraging insects such as bees or ants, whose ability to remember their position with respect to their nest has been the subject of many experimental and computational studies (<xref ref-type="bibr" rid="bib5">Collett, 2019</xref>; <xref ref-type="bibr" rid="bib56">Wehner and Srinivasan, 2003</xref>). The position integrating neurons in these insects are also predicted to have sinusoidal activation patterns (<xref ref-type="bibr" rid="bib58">Wittmann and Schwegler, 1995</xref>; <xref ref-type="bibr" rid="bib54">Vickerstaff and Di Paolo, 2005</xref>; <xref ref-type="bibr" rid="bib46">Stone et al., 2017</xref>).</p><p>Finally, another interesting avenue for future work is to compare the encoding of direction in insects with that of mammals, which encode heading in a fundamentally different way that uses many more neurons. This raises a critical question: why would the circuit and encoding be different if navigation follows similar principles across species? We speculate that the difference might lie in the type of navigation that the two classes of animals use. Insects often rely on a reference system that is globally anchored to a certain point or phenomenon, whether it is their nests for ants and bees, the sunlight polarisation pattern for locusts, or the milky way for dung beetles. On the other hand, mammals such as rodents typically do not use global cues but rely on local landmarks that are context-dependent and only occur in specific locations. Therefore, mammals must employ a flexible encoding that can be updated as different environments are explored. Further investigation of this possibility would require a different set of principles than those selected here.</p></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Path integration dynamics for heading and position</title><p>Here, we make more precise statements about the dynamics of the circuit. The topology of the activity is a circular line attractor, so that any perturbation falls back into a circle and the position of the activity around the circle represents an angle. In our circuit with the dynamics from <xref ref-type="disp-formula" rid="equ1">Equation 1</xref>, this circular line attractor is achieved by setting<disp-formula id="equ22"><label>(22)</label><mml:math id="m22"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mtd><mml:mtd><mml:mi/><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="1em"/><mml:mi mathvariant="normal">∀</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>r</mml:mi></mml:mstyle></mml:math></inline-formula> is the radius of the attractor. Given that the dynamics are effectively linear we can apply a Fourier transform and write the original dynamics around the line attractor directly in the spatial Fourier basis,<disp-formula id="equ23"><label>(23)</label><mml:math id="m23"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which we can expand to obtain<disp-formula id="equ24"><label>(24)</label><mml:math id="m24"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which only applies to the circular activity where the dynamics are linear. To incorporate the dynamics that force the activity to return to the cycle, we add a new term into the network dynamics which fulfils <xref ref-type="disp-formula" rid="equ22">Equation 22</xref> – increasing <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mstyle></mml:math></inline-formula> if <inline-formula><mml:math id="inf102"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and decreasing it if <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. This increase or decrease can be incorporated as a simple scaling factor on the activity decay term<disp-formula id="equ25"><label>(25)</label><mml:math id="m25"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> is a nonlinear smooth function with a single minimum and <inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, which forces the activity to have the appropriate magnitude, <inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>Note that this doesn’t require the neurons to have access to a global activity magnitude signal because each neuron receives a sufficient number of inputs to locally compute the total activity in the network. See the <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> circuit in <xref ref-type="fig" rid="fig3">Figure 3</xref>: each neuron receives inputs from all others except those tuned to an orthogonal direction, but the activity of these orthogonal neurons can be computed from the correlated neurons next to them. For example, neuron 1 receives input from all neurons except 3 and 7, but the activities of these neurons can be computed from the activities of neurons 2 and 4 or 6 and 8, respectively. Note also that this is not the case for degenerate circuits such as <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> in <xref ref-type="fig" rid="fig3">Figure 3</xref>, which would require an activation function with access to global information to constrain the total activity.</p><p>As the activity always falls back to the circular line attractor, the heading integration is linear around the circle. This implies that any small movement of the animal or the perception of a sensory cue is first projected onto the circle, then linearly integrated. We therefore only consider how network inputs cause the activity to rotate around the network,<disp-formula id="equ26"><label>(26)</label><mml:math id="m26"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>˙</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>⊥</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>⊥</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> is the projection of the input signal perpendicular to the current activity pattern.</p><p>In more intuitive terms, the neurons have a saturating nonlinear activation function where they modulate their gain based on the total activity in the network. If the activity in the network is above the desired level, <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>r</mml:mi></mml:mstyle></mml:math></inline-formula>, the gain is reduced and the activity decreases, and when the activity of the network is less than desired level, both the gain and the activity increase. Note that in this scenario transient deviations from the line attractor, which would induce nonlinear behaviour in the circuit dynamics, are tolerable. External inputs, <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, could transiently modify the shape of the activity, producing activity shapes deviating from what the linear model can accommodate. For example, the shape of the bump attractor could be modified through nonlinearities while the insect attains high angular velocity (<xref ref-type="bibr" rid="bib51">Turner-Evans et al., 2017</xref>).</p><p>Such nonlinear dynamics do not conflict with the theory developed here, which only requires linearity when the activity is projected onto the circular line attractor. In our framework, the linearity of integration <italic>at the circular line attractor</italic> is not a computational assumption, but rather it emerges from the principle of symmetry.</p></sec><sec id="s4-2"><title>Ambiguities in multiple harmonics decoding with drift</title><p>We consider the case where multiple harmonics are used, and their phases have drifted from each other. We only focus on angular drift, rather than noise in the full activity, because as noted in section ‘Path integration dynamics for heading and position’, any deviations in the overall activity level in the network will dissipate.</p><p>For example, we consider the harmonics <inline-formula><mml:math id="inf112"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf113"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. The activity is given by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref><disp-formula id="equ27"><label>(27)</label><mml:math id="m27"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If the phase of the second harmonic drifts by <inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mstyle></mml:math></inline-formula>,<disp-formula id="equ28"><label>(28)</label><mml:math id="m28"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>n</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We can calculate the alignment between the activity with drift and the activity without drift as a dot product of the activity vectors,<disp-formula id="equ29"><label>(29)</label><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:munder><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>However, there are other angles where the alignment is better. For example, we can consider an estimate angle, <inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mstyle></mml:math></inline-formula>, with its corresponding activity, <inline-formula><mml:math id="inf116"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, which gives<disp-formula id="equ30"><label>(30)</label><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mo fence="false" stretchy="false">⟨</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">⟩</mml:mo></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For small <inline-formula><mml:math id="inf117"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi></mml:mstyle></mml:math></inline-formula>, this is maximised when <inline-formula><mml:math id="inf118"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi><mml:mi>θ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>. However, since <italic>θ</italic> is circular, if the drift is <inline-formula><mml:math id="inf119"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>π</mml:mi></mml:mstyle></mml:math></inline-formula> then there are two possible positions given by <inline-formula><mml:math id="inf120"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>θ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mi>θ</mml:mi><mml:mo>±</mml:mo><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>.</p><p>This implies that an encoding using multiple harmonics does not necessarily offer a unique decoding in the presence of noise.</p></sec><sec id="s4-3"><title>Equivalent circuits and degeneracies</title><sec id="s4-3-1"><title>Equivalence under permutation</title><p>The activity of neurons given by <xref ref-type="disp-formula" rid="equ5">Equation 5</xref> implies that the preferred angle of neuron <inline-formula><mml:math id="inf121"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> is given by<disp-formula id="equ31"><label>(31)</label><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>φ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>f</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.667em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where in our case <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula>. <xref ref-type="table" rid="table2">Table 2</xref> shows <inline-formula><mml:math id="inf123"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula> evaluated for all neurons in the network using different harmonics. We notice that for <inline-formula><mml:math id="inf124"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> all the numbers from zero to seven appear, while for <inline-formula><mml:math id="inf125"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> we only get the even numbers, for <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> we get only zero and four, and for <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> there is only zero.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>Distribution of neural activity phases for different harmonics.</title><p>We computed <inline-formula><mml:math id="inf128"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mi>n</mml:mi><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf130"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> and found that all possible phases appear for any odd number. This happens because the <inline-formula><mml:math id="inf131"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> operation imposes an abelian group structure, namely <inline-formula><mml:math id="inf132"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> and any coprime with 8 will be a generator of the whole group. If we use instead <inline-formula><mml:math id="inf133"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf134"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:math></inline-formula> we have that we can divide <inline-formula><mml:math id="inf135"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> by 2 and we get the abelian group <inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> which has four elements. The same argument applies to <inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula>, leaving only two elements, and for <inline-formula><mml:math id="inf139"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> we get a single element.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"><inline-formula><mml:math id="inf140"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf141"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf142"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf143"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf144"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf145"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf146"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">2</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">4</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf154"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">2</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf155"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">7</td><td align="char" char="." valign="bottom">6</td><td align="char" char="." valign="bottom">5</td><td align="char" char="." valign="bottom">4</td><td align="char" char="." valign="bottom">3</td><td align="char" char="." valign="bottom">2</td><td align="char" char="." valign="bottom">1</td><td align="char" char="." valign="bottom">1</td></tr><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf156"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">0</td><td align="char" char="." valign="bottom">8</td></tr></tbody></table></table-wrap><p>The explanation is based on number theory. If <inline-formula><mml:math id="inf157"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf158"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> have the greatest common divisor <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo movablelimits="true" form="prefix">gcd</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula>, then <inline-formula><mml:math id="inf160"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mi>f</mml:mi><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> for <inline-formula><mml:math id="inf161"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula>. This implies that the preferred angle of neuron <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> is the same as that of <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula>. When <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mstyle></mml:math></inline-formula> are coprime <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula> goes from 0 to <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> without repeating any value. However, when <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, the neuron <inline-formula><mml:math id="inf169"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi></mml:mstyle></mml:math></inline-formula> has the same tuning as the neuron <inline-formula><mml:math id="inf170"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula>, the neuron <inline-formula><mml:math id="inf171"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> has the same tuning as the neuron <inline-formula><mml:math id="inf172"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> and so on. In other words, the angular tuning of the neurons has a period of <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo movablelimits="true" form="prefix">gcd</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>.</p><p>This divides the possible circuits into the following groups:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf174"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> which contain <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> angular tunings with values <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> because every odd number is coprime with 8 and thus the <inline-formula><mml:math id="inf177"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo movablelimits="true" form="prefix">gcd</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:mstyle></mml:math></inline-formula> which cycle through four possible directions <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> because <inline-formula><mml:math id="inf180"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi>N</mml:mi><mml:mrow><mml:mo movablelimits="true" form="prefix">gcd</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="inf181"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> which can only represent two possible directions <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> which can only represent the direction 0.</p></list-item></list></sec><sec id="s4-3-2"><title>Degenerate circuits</title><p>Given the groupings presented in the previous subsection, we notice that not all of them allow the encoding of a full range of angles, (0°, 360°). Notably, for <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mstyle></mml:math></inline-formula> the neurons only encode one angle, and for <inline-formula><mml:math id="inf185"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> only two complementary angles are encoded, 0 and <inline-formula><mml:math id="inf186"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>π</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. This means that we cannot represent a full circle, because we need two different dimensions to do so, but in both of these cases we can only encode one.</p><p>For <inline-formula><mml:math id="inf187"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mstyle></mml:math></inline-formula> we obtain two groups of neurons, and in each group there are 2 neurons that encode two opposing directions, thus it is possible to cover a full circle. However, the circuit is degenerate, as shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>. In this case there are no connections between even and odd neurons. Thus, we have two groups of neurons that are disconnected, and each group encodes only one direction (either north-south or east-west). While the encoding could work in principle, the circuit is decoupled, meaning that there is nothing in this circuit that prevents the activity from having activities outside the circular topology: as the two circuits are disconnected, a given value of activity in one group does not restrict the activity in the other.</p></sec><sec id="s4-3-3"><title>Circuits with different neuron counts</title><p>We evaluate the viability of circuits with other values of <inline-formula><mml:math id="inf188"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>. From findings in the the previous section, we note that choosing <inline-formula><mml:math id="inf189"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> to be a prime number implies that all frequencies will be coprime with <inline-formula><mml:math id="inf190"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula>, and thus that all the neurons will have a different tuning.</p><p>For <inline-formula><mml:math id="inf191"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>, the two angles are <inline-formula><mml:math id="inf192"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi></mml:mstyle></mml:math></inline-formula>, in which case the circuit can only encode one dimension and thus cannot encode a full circle, as was the case for <inline-formula><mml:math id="inf193"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula> in section ‘Degenerate circuits’.</p><p>For <inline-formula><mml:math id="inf194"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula>, if <inline-formula><mml:math id="inf195"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> the circuit can encode only the angles <inline-formula><mml:math id="inf196"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi></mml:mstyle></mml:math></inline-formula> and we have the same case as for <inline-formula><mml:math id="inf197"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula>. But if <inline-formula><mml:math id="inf198"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> or <inline-formula><mml:math id="inf199"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula>, the neurons are tuned to the angles <inline-formula><mml:math id="inf200"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mi>π</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> which can encode a circle. However, by looking at the connectivity matrix from <xref ref-type="disp-formula" rid="equ16">Equation 16</xref>, we find that neurons 1, 3 are connected to one another, but not to 2, 4, as was the case for <inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> in section ‘Degenerate circuits’. This implies that the circuit does not enforce a circular topology, and thus it does not work.</p><p>Notice that we could think of another structure where each neuron encodes a different direction. Intuitively, we would have a north-south neuron and an east-west neuron, as we would have in Cartesian coordinates. However, this would have the same problem as <inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula>, where the 2 neurons would not interact and thus the topology would be wrong. Additionally, when the insect heads north, the north-south neuron would be very active, while when it heads south it would be very inactive. This means that the circuit as a whole would have a different firing rate depending on the direction, breaking the symmetry assumption.</p></sec></sec><sec id="s4-4"><title>Path counting</title><p>We counted the number of different paths between EPG neurons, accounting for the sign of the connections (whether the path passed through an inhibitory 7 neuron), and used the net path count as a proxy for connectivity strength. The results of this analysis are shown in section ‘Comparing the predicted circuit with biological data’, but we will detail the process here using the locust network from <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, as an example, shown in <xref ref-type="fig" rid="fig6">Figure 6</xref>.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Path counting.</title><p>(<bold>A</bold>) The full locust connectivity network from <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, and (<bold>B</bold>) the connections with path lengths 2 and 3 from <inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to all other <inline-formula><mml:math id="inf204"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neurons in the network. Because the network is rotationally symmetric these path counts generalise to all <inline-formula><mml:math id="inf205"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neurons as shown in <xref ref-type="table" rid="table3">Table 3</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig6-v1.tif"/></fig><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>Net path count profile between <inline-formula><mml:math id="inf206"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neurons in the locust circuit.</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"><inline-formula><mml:math id="inf207"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf208"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf209"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf210"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf211"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf212"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf213"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf214"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula></th><th align="left" valign="bottom"><inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn></mml:mstyle></mml:math></inline-formula></th></tr></thead><tbody><tr><td align="left" valign="bottom">Excitatory path count</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">2</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">0</td></tr><tr><td align="left" valign="bottom">Inhibitory path count</td><td align="center" valign="bottom">4</td><td align="center" valign="bottom">3</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">0</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">3</td></tr><tr><td align="left" valign="bottom">Net path count</td><td align="center" valign="bottom">–4</td><td align="center" valign="bottom">-3</td><td align="center" valign="bottom">–1</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">2</td><td align="center" valign="bottom">1</td><td align="center" valign="bottom">–1</td><td align="center" valign="bottom">–3</td></tr></tbody></table></table-wrap><p>We consider the shortest excitatory and inhibitory pathways between EPG neurons, which have lengths of 2 and 3 respectively. There are no direct paths between <inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neurons in the locust circuit. In this case there are two paths of length 2 that implement self-excitatory connections for <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>And there is one connection of path length 2 that connects <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to each of its nearest neighbours:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>8</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>For inhibitory connections there are four paths of length 3 that connect <inline-formula><mml:math id="inf223"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to the neuron on the opposite side of the ring, <inline-formula><mml:math id="inf224"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. These are:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf225"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf226"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEG</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf227"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf228"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>There are three connections of path length 3 connecting <inline-formula><mml:math id="inf229"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to <inline-formula><mml:math id="inf230"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf231"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf232"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEG</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item><list-item><p><inline-formula><mml:math id="inf233"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>Finally, there is one path of length 3 connecting <inline-formula><mml:math id="inf234"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> to the neuron perpendicular to it around the ring, <inline-formula><mml:math id="inf235"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>:</p><list list-type="bullet"><list-item><p><inline-formula><mml:math id="inf236"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>Delta7</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>PEN</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:msub><mml:mi>EPG</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula></p></list-item></list><p>We then add these connections together to obtain the net path count profile for the network. Because the network is rotationally symmetric, the connections from <inline-formula><mml:math id="inf237"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are the same as the connections from <inline-formula><mml:math id="inf238"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>EPG</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> but with the neurons indices incremented by 1. The generalised profile is shown in <xref ref-type="table" rid="table3">Table 3</xref>.</p></sec><sec id="s4-5"><title>Data preprocessing</title><p>The following section details our data preprocessing to produce a central complex circuit for the fruit fly similar to that in <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, using synaptic counts from the fruit fly connectome dataset (<xref ref-type="bibr" rid="bib43">Scheffer et al., 2020</xref>). Full details are shown in our available code.</p><p>We first identified the 6 neuron types which corresponded to the neurons of interest in the central complex (<xref ref-type="table" rid="table4">Table 4</xref>).</p><table-wrap id="table4" position="float"><label>Table 4.</label><caption><title>Neuron types and their numbers in the fruit fly connectome dataset (<xref ref-type="bibr" rid="bib43">Scheffer et al., 2020</xref>).</title></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Neuron class</th><th align="left" valign="bottom">Number</th></tr></thead><tbody><tr><td align="left" valign="bottom">PEN_a(PEN1)</td><td align="char" char="." valign="bottom">20 neurons</td></tr><tr><td align="left" valign="bottom">PEN_b(PEN2)</td><td align="char" char="." valign="bottom">22 neurons</td></tr><tr><td align="left" valign="bottom">PEG</td><td align="char" char="." valign="bottom">18 neurons</td></tr><tr><td align="left" valign="bottom">EPG</td><td align="char" char="." valign="bottom">46 neurons</td></tr><tr><td align="left" valign="bottom">EPGt</td><td align="char" char="." valign="bottom">4 neurons</td></tr><tr><td align="left" valign="bottom">Delta7 (Δ7)</td><td align="char" char="." valign="bottom">42 neurons</td></tr></tbody></table></table-wrap><p>We grouped the two PEN and two EPG populations together for further analysis.</p><p>From the connectome data we created a connectivity matrix (<xref ref-type="fig" rid="fig7">Figure 7</xref>) containing the number of synapses between all pairs of neurons of the above-mentioned types. This contained 129,473 synapses between 152 neurons in total.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>The connectivity matrix for the fruit fly containing all 152 neurons.</title><p>On the horizontal axis are the names of the pre-synaptic neurons while on the vertical axis the names of the post-synaptic neurons. Neurons of each cell type are ordered by the glomerulus they innervate and arbitrarily within glomerulus.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig7-v1.tif"/></fig><p>Next, neurons in the same glomerulus were grouped together. The EPG neurons were divided between 18 glomeruli, L1-L9 and R1-R9. The PEN neurons were also divided between 16 glomeruli, L2-L9 and R2-R9. The PEG neurons were divided into 18 glomeruli with only 1 neuron in each, L1-L9 and R1-R9. The Delta7 neurons had 10 unique sub-types (<xref ref-type="table" rid="table5">Table 5</xref>) which were grouped into eight glomeruli based on their left glomerulus index – i.e., L4R5_R and L4R6_R were grouped in L4.</p><table-wrap id="table5" position="float"><label>Table 5.</label><caption><title>List of the Delta7 neuron sub-types in the fruit fly connectome dataset (<xref ref-type="bibr" rid="bib43">Scheffer et al., 2020</xref>).</title><p>These differ in the glomeruli their pre- and post-synaptic terminals innervate. We are referring to those altogether as Delta7 neurons in the present account.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Delta7 neuron sub-types</th><th align="left" valign="bottom">Glomerulus group</th></tr></thead><tbody><tr><td align="left" valign="bottom">Delta7(PB15)_L1L9R8_R</td><td align="left" valign="bottom">Delta7 L1</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L2R7_R</td><td align="left" valign="bottom">Delta7 L2</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L3R6_R</td><td align="left" valign="bottom">Delta7 L3</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L4R5_R</td><td align="left" valign="bottom">Delta7 L4</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L4R6_R</td><td align="left" valign="bottom">Delta7 L4</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L5R4_L</td><td align="left" valign="bottom">Delta7 L5</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L6R3_L</td><td align="left" valign="bottom">Delta7 L6</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L6R4_L</td><td align="left" valign="bottom">Delta7 L6</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L7R2_L</td><td align="left" valign="bottom">Delta7 L7</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L7R3_L</td><td align="left" valign="bottom">Delta7 L7</td></tr><tr><td align="left" valign="bottom">Delta7(PB15)_L8R1R9_L</td><td align="left" valign="bottom">Delta7 L8</td></tr></tbody></table></table-wrap><p>After this grouping we had a connectivity matrix of 60 neurons in total (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>The connectivity matrix for the fruit fly neurons grouped by innervated glomerulus so containing 60 groups.</title><p>On the horizontal axis are the names of the pre-synaptic neurons while on the vertical axis the names of the post-synaptic neurons. Neuron groups are ordered by the glomerulus they innervate.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig8-v1.tif"/></fig><p>For the EPG, PEN, and PEG neurons we then grouped glomeruli mirrored in the two hemispheres together – i.e., L1 and R1 were grouped into glomerulus 1. This resulted in a connectivity matrix of 34 neurons (<xref ref-type="fig" rid="fig9">Figure 9</xref>).</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>The connectivity matrix for the fruit fly neurons grouped by glomerulus and aggregated from both hemispheres, so containing 34 groups.</title><p>On the horizontal axis are the names of the pre-synaptic neuron groups while on the vertical axis are the names of the post-synaptic neuron groups. Neuron groups are ordered by the glomerulus they innervate.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig9-v1.tif"/></fig><p>Finally, as in <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, we grouped the PEG9 and PEG1 neurons and EPG9 and EPG1 neurons together. The former because they both output to the same ellipsoid body segment, and the latter because they both receive common input. This resulted in a connectivity matrix with 32 neurons (<xref ref-type="fig" rid="fig10">Figure 10</xref>) which we used for the analysis in <xref ref-type="fig" rid="fig4">Figure 4</xref> as this network had the eightfold rotational symmetry compatible with our theoretical model.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>The connectivity matrix for the fruit fly neurons grouped by glomerulus and aggregated from both hemispheres, with PEG9 and PEG1 neurons and EPG9 and EGP1 neurons grouped, so containing 32 groups in total.</title><p>On the horizontal axis are the names of the pre-synaptic neuron groups while on the vertical axis the names of the post-synaptic neuron groups. Neuron groups are ordered by the glomerulus they innervate.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig10-v1.tif"/></fig></sec><sec id="s4-6"><title>Fitting weights</title><p>Having calculated the paths or synaptic strengths between <inline-formula><mml:math id="inf239"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neurons in the network, we next computed the average connectivity profile for the network – how each <inline-formula><mml:math id="inf240"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>EPG</mml:mi></mml:mstyle></mml:math></inline-formula> neuron connected to its neighbours a certain distance around the ring. We then compared this connectivity profile to the closest fitting sinusoid to quantify to what degree our prediction of sinusoidal weights was consistent with biological data.</p><p>We use the vector<disp-formula id="equ32"><label>(32)</label><mml:math id="m32"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mspace width="1em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>4...3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the signed circular distance from neuron <inline-formula><mml:math id="inf242"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>m</mml:mi></mml:mstyle></mml:math></inline-formula> to neuron <inline-formula><mml:math id="inf243"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>n</mml:mi></mml:mstyle></mml:math></inline-formula>.</p><p>In the networks from <xref ref-type="bibr" rid="bib40">Pisokas et al., 2020</xref>, the weights are rotationally symmetric, so we minimise the mean squared error between the sinusoidal profile and the biological connectivity profile,<disp-formula id="equ33"><label>(33)</label><mml:math id="m33"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>by using least squares.</p><p>The network derived from the synaptic count data in <xref ref-type="bibr" rid="bib43">Scheffer et al., 2020</xref>, is not rotationally symmetric so each value in the average connectivity profile, <inline-formula><mml:math id="inf244"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>ω</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, has a corresponding standard deviation, <inline-formula><mml:math id="inf245"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>. In this case we minimise the precision-weighted mean squared error, which emphasises fitting connectivity profile values that are more consistently seen in the network:<disp-formula id="equ34"><label>(34)</label><mml:math id="m34"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>β</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>ω</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>ω</mml:mi><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The result of fitting sinusoidal profiles to the data is shown in section ‘Comparing the predicted circuit with biological data’. Since the fit for the fruit fly is not as clear as for the locust, we also compared the observed weights in the fruit fly with Gaussian and von Mises curves. Since both the Gaussian and von Mises distributions also have a parameter specifying their width, this requires fitting an extra parameter. For the Gaussian we have<disp-formula id="equ35"><label>(35)</label><mml:math id="m35"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>σ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf246"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are parameters to fit. For the von Mises distribution we have<disp-formula id="equ36"><label>(36)</label><mml:math id="m36"><mml:msub><mml:mi>β</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:msub><mml:mi>κ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf247"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> are parameters to fit. For both the Gaussian and von Mises, we find a good agreement with the weights in <xref ref-type="fig" rid="fig11">Figure 11</xref>, and a lower root mean square error (RMSE) than with any combination of harmonics. However, we note that our sinusoidal model has two parameters instead of three, so to make a fair comparison we use the corrected Akaike information criterion (AICc) (<xref ref-type="bibr" rid="bib4">Burnham and Anderson, 2004</xref>), which is given by<disp-formula id="equ37"><label>(37)</label><mml:math id="m37"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtext>AICc</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>N</mml:mi><mml:mspace width="thinmathspace"/><mml:msup><mml:mtext>RMSE</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>Gaussian and von Mises distributions provide a better fit than the weight profile with sinusoidal weights of frequency 1, but the former two distributions have an extra model parameter.</title><p>When fixing the width parameters of these distributions to match the sinusoid, all three distributions provide a very similar fit. Note that the –4 and 4 neuron indices are the same and just duplicated for visualisation purposes.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig11-v1.tif"/></fig><p>where <inline-formula><mml:math id="inf248"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>p</mml:mi></mml:mstyle></mml:math></inline-formula> is the number of distribution parameters, <inline-formula><mml:math id="inf249"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> the number of samples, and <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> is the log-likelihood, which in this case is the sum of squared errors, <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mtext>RMSE</mml:mtext><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>. We find that the lowest AICc (corresponding to the best model) corresponds to the harmonic <inline-formula><mml:math id="inf252"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> (<xref ref-type="table" rid="table6">Table 6</xref>).</p><table-wrap id="table6" position="float"><label>Table 6.</label><caption><title>Quality of fit for different possible weight structures.</title><p>The root mean square error (RMSE) is weighted by the variance attached to each connection (in units of standard deviations). The corrected Akaike information criterion (AICc) is also shown for the weight profiles in <xref ref-type="fig" rid="fig11">Figure 11</xref>. The best fit after correcting for model size is the Gaussian with fixed standard deviation, but it is very closely matched by the von Mises with fixed kappa and <inline-formula><mml:math id="inf253"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom">Curve</th><th align="left" valign="bottom">RMSE</th><th align="left" valign="bottom">AICc</th></tr></thead><tbody><tr><td align="left" valign="bottom"><inline-formula><mml:math id="inf254"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula></td><td align="char" char="." valign="bottom">0.3213</td><td align="char" char="." valign="bottom">8.05</td></tr><tr><td align="left" valign="bottom">Gaussian</td><td align="char" char="." valign="bottom">0.1941</td><td align="char" char="." valign="bottom">12.60</td></tr><tr><td align="left" valign="bottom">von Mises</td><td align="char" char="." valign="bottom">0.1854</td><td align="char" char="." valign="bottom">12.55</td></tr><tr><td align="left" valign="bottom">Gaussian (fixed stddev)</td><td align="char" char="." valign="bottom">0.3142</td><td align="char" char="." valign="bottom">7.98</td></tr><tr><td align="left" valign="bottom">von Mises (fixed kappa)</td><td align="char" char="." valign="bottom">0.3178</td><td align="char" char="." valign="bottom">8.02</td></tr></tbody></table></table-wrap><p>As a complementary approach to evaluate the shape of the distribution, we first fit the Gaussian and von Mises distributions to the best fit <inline-formula><mml:math id="inf255"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> curve. We then freeze the width parameters of the distributions (<inline-formula><mml:math id="inf256"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>σ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> for the Gaussian and <inline-formula><mml:math id="inf257"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>κ</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> for the von Mises) and only optimise the amplitude and vertical offset parameters (<italic>β</italic> and <italic>γ</italic>) to fit the data. This approach limits the number of free parameters for the Gaussian and von Mises distributions to two, to match the sinusoid. The results are shown in <xref ref-type="fig" rid="fig11">Figure 11</xref> and <xref ref-type="table" rid="table6">Table 6</xref>. Both the fixed-width Gaussian and von Mises distributions are a slightly better fit to the data than the sinusoid, but the differences between the three curves are very small.</p><p>In simplifying the fruit fly connectome data, we assumed all synapses of different types were of equal weight, as no data to the contrary were available. Different synapse types having different strengths could introduce nonlinear distortions between our net synaptic path count and the true synaptic strength, which could in turn make the data a better or worse fit for a sinusoidal compared to a Gaussian profile. As such, we don’t consider the 2% relative difference in RMSE between the <inline-formula><mml:math id="inf258"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> sinusoid and fixed-width Gaussian and von Mises distributions to be conclusive.</p><p>Overall, we find that the cosine weights that emerge from our derivations are a very close match for the locust, but less precise for the fly, where other functions fit slightly better. Given the limitations in using the currently available data to provide an exact estimate of synaptic strength (for the locust), and due to the high variability of the synaptic count (for the fruit fly), we consider that our theory is compatible with the observed data.</p></sec><sec id="s4-7"><title>Convergence of Oja’s rule with multiple harmonics</title><sec id="s4-7-1"><title>Linear neurons</title><p>Integrating our modified Oja’s learning rule updates (<xref ref-type="disp-formula" rid="equ19">Equation 19</xref>) over all angles in the position space gives us the following:<disp-formula id="equ38"><label>(38)</label><mml:math id="m38"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>which we can transform into the Fourier domain:<disp-formula id="equ39"><label>(39)</label><mml:math id="m39"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>The steady-state solution when the weight update is 0 is:<disp-formula id="equ40"><label>(40)</label><mml:math id="m40"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>By Parseval’s theorem, <inline-formula><mml:math id="inf259"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula> so the Fourier spectrum of the steady-state weights is just the normalised Fourier spectrum of the input:<disp-formula id="equ41"><label>(41)</label><mml:math id="m41"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>From this we can see that the stable <inline-formula><mml:math id="inf260"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>L</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> norm of <inline-formula><mml:math id="inf261"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math></inline-formula> is 1,<disp-formula id="equ42"><label>(42)</label><mml:math id="m42"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>If we combine this result with <xref ref-type="disp-formula" rid="equ10">Equation 10</xref>, we find that in the case of a single encoding frequency, <inline-formula><mml:math id="inf262"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, Oja’s rule will result in a single stable harmonic with <inline-formula><mml:math id="inf263"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msup><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> because <inline-formula><mml:math id="inf264"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munder><mml:mo>∑</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:msup><mml:mi>f</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>∗</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mstyle></mml:math></inline-formula>.</p><p>If Oja’s rule has a normalising factor added to account for the number of encoding harmonics used, <inline-formula><mml:math id="inf265"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>,<disp-formula id="equ43"><label>(43)</label><mml:math id="m43"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>∗</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mstyle><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>then the steady-state solution for the weights becomes<disp-formula id="equ44"><label>(44)</label><mml:math id="m44"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where the <inline-formula><mml:math id="inf266"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>L</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> norm of <inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>. In this case multiple harmonics could develop stable values of <inline-formula><mml:math id="inf268"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi class="MJX-tex-caligraphic" mathvariant="script">F</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>ω</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula>, but only if the activity magnitudes for these harmonics are identical. If any perturbation affects the activities, the harmonic which happens to have the larger activity will begin to dominate the other by the dynamics of <xref ref-type="disp-formula" rid="equ43">Equation 43</xref>, until only one remains.</p><p>Therefore, the only case where our learning rule results in a stable solution robust to perturbations is when only one harmonic is used.</p></sec><sec id="s4-7-2"><title>Neurons with nonlinear activations</title><p>An analysis similar to the previous case applies when the firing rate of the neurons has a nonlinear activation. For a given activity profile, <xref ref-type="disp-formula" rid="equ41">Equation 41</xref> still applies. Thus, for an activity profile <inline-formula><mml:math id="inf269"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, it will generate the weight profile<disp-formula id="equ45"><label>(45)</label><mml:math id="m45"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:munder><mml:mo>∑</mml:mo><mml:mi>f</mml:mi></mml:munder><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where we set <inline-formula><mml:math id="inf270"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mi>ω</mml:mi><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:math></inline-formula> for convenience of notation. Note that the squaring process will induce a weight distribution in which the larger harmonic will be enhanced more than the rest.</p><p>Having obtained the weights, the equation for the activity profile can be solved through the self-consistency setting in which <inline-formula><mml:math id="inf271"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mstyle></mml:math></inline-formula> and the activity is maintained,<disp-formula id="equ46"><label>(46)</label><mml:math id="m46"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>ω</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>where <italic>ϕ</italic> is the nonlinear activation function. Given the rotational symmetry from our assumptions, it is enough to solve for <inline-formula><mml:math id="inf272"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mstyle></mml:math></inline-formula>, which gives us a set of <inline-formula><mml:math id="inf273"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> equations which can then be combined with <xref ref-type="disp-formula" rid="equ45">Equation 45</xref>, which gives us the following equation to solve<disp-formula id="equ47"><label>(47)</label><mml:math id="m47"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi/><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:msup><mml:mo fence="false" stretchy="false">‖</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>k</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>cos</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf274"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>−</mml:mo><mml:mi>n</mml:mi><mml:mspace width="0.667em"/><mml:mi>mod</mml:mi><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, we obtain <inline-formula><mml:math id="inf275"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> equations for <inline-formula><mml:math id="inf276"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo>/</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mstyle></mml:math></inline-formula> values of <inline-formula><mml:math id="inf277"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</p><p>Note that there is no closed form solution in general, but some generic properties can be inferred. For example, as long as we have a single bump of activity, <inline-formula><mml:math id="inf278"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mstyle></mml:mrow></mml:mstyle></mml:math></inline-formula>, therefore <inline-formula><mml:math id="inf279"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>ω</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>ω</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>f</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. More specifically,<disp-formula id="equ48"><label>(48)</label><mml:math id="m48"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>ω</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi mathvariant="bold">a</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mstyle><mml:msub><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>ω</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="fig" rid="fig12">Figure 12</xref> shows the results of the same simulation as section ‘Learning rules and development’, but using neurons with a nonlinear (<inline-formula><mml:math id="inf280"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>tanh</mml:mi></mml:mstyle></mml:math></inline-formula>) activation function, and distorting the network input to be a more square wave-like sinusoid. As predicted theoretically, our rule still reinforces the dominant spatial frequency in the network, causing the weights to converge to the sinusoidal profile our theory predicts.</p><fig id="fig12" position="float"><label>Figure 12.</label><caption><title>Recovery of synaptic weights with a Hebbian learning rule.</title><p>The synaptic weights converge to a sinusoidal pattern under Oja’s rule when the neurons have a nonlinear (<inline-formula><mml:math id="inf281"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>tanh</mml:mi></mml:mstyle></mml:math></inline-formula>) activation function and a distorted (more square wave-like) sinusoidal input is provided. (<bold>A</bold>) The weights start at zero and slowly converge to the prescribed sinusoidal profile, showing that this connectivity can emerge from scratch. (<bold>B</bold>) The sinusoidal weights are perturbed by noise but learning ensures that the weight profile is corrected. (<bold>C</bold>) The distorted sinusoidal input (orange) compared to a sinusoid profile (blue). Noise was added to the initial activity, weights, and input with the same parameters as in <xref ref-type="fig" rid="fig5">Figure 5</xref>, the only difference being that these simulations were run for 2500 periods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-91533-fig12-v1.tif"/></fig></sec></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Software, Formal analysis, Validation, Investigation, Visualization, Methodology, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Formal analysis, Supervision, Validation, Investigation, Methodology, Writing – original draft, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-91533-mdarchecklist1-v1.docx" mimetype="application" mime-subtype="docx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. All modelling and analysis code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/Dominic-DallOsto/insect-navigation-sinusoidal-optimality">GitHub</ext-link> (copy archived at <xref ref-type="bibr" rid="bib8">Dall'Osto, 2024</xref>).</p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Scheffer</surname><given-names>L</given-names></name><name><surname>Plaza</surname><given-names>S</given-names></name><name><surname>Januszewski</surname><given-names>M</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Takemura</surname><given-names>SY</given-names></name><name><surname>Hayworth</surname><given-names>K</given-names></name><name><surname>Shinomiya</surname><given-names>K</given-names></name><name><surname>Maitin-Shepard</surname><given-names>J</given-names></name><name><surname>Bogovic</surname><given-names>J</given-names></name><name><surname>Hubbard</surname><given-names>P</given-names></name><name><surname>Kainmueller</surname><given-names>D</given-names></name><name><surname>Katz</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>PH</given-names></name><name><surname>Neubarth</surname><given-names>N</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Neace</surname><given-names>ER</given-names></name><name><surname>Knecht</surname><given-names>CJ</given-names></name><name><surname>Alvarado</surname><given-names>CX</given-names></name><name><surname>Bailey</surname><given-names>D</given-names></name><name><surname>Ballinger</surname><given-names>S</given-names></name><name><surname>Borycz</surname><given-names>JA</given-names></name><name><surname>Canino</surname><given-names>B</given-names></name><name><surname>Cook</surname><given-names>M</given-names></name><name><surname>Duclos</surname><given-names>O</given-names></name><name><surname>Eubanks</surname><given-names>B</given-names></name><name><surname>Finley</surname><given-names>S</given-names></name><name><surname>Forknall</surname><given-names>N</given-names></name><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Hopkins</surname><given-names>GP</given-names></name><name><surname>Joyce</surname><given-names>EE</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Kirk</surname><given-names>NA</given-names></name><name><surname>Kovalyak</surname><given-names>J</given-names></name><name><surname>Lauchie</surname><given-names>SA</given-names></name><name><surname>Lohff</surname><given-names>A</given-names></name><name><surname>Maldonado</surname><given-names>C</given-names></name><name><surname>Manley</surname><given-names>EA</given-names></name><name><surname>McLin</surname><given-names>S</given-names></name><name><surname>Mooney</surname><given-names>C</given-names></name><name><surname>Ndama</surname><given-names>M</given-names></name><name><surname>Ogundeyi</surname><given-names>O</given-names></name><name><surname>Okeoma</surname><given-names>N</given-names></name><name><surname>Ordish</surname><given-names>C</given-names></name><name><surname>Padilla</surname><given-names>N</given-names></name><name><surname>Patrick</surname><given-names>C</given-names></name><name><surname>Phillips</surname><given-names>EE</given-names></name><name><surname>Phillips</surname><given-names>EM</given-names></name><name><surname>Rampally</surname><given-names>N</given-names></name><name><surname>Ribeiro</surname><given-names>C</given-names></name><name><surname>Robertson</surname><given-names>MK</given-names></name><name><surname>Rymer</surname><given-names>JT</given-names></name><name><surname>Ryan</surname><given-names>SM</given-names></name><name><surname>Sammons</surname><given-names>M</given-names></name><name><surname>Scott</surname><given-names>AK</given-names></name><name><surname>Scott</surname><given-names>AL</given-names></name><name><surname>Shinomiya</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>NL</given-names></name><name><surname>Sobeski</surname><given-names>MA</given-names></name><name><surname>Suleiman</surname><given-names>A</given-names></name><name><surname>Takemura</surname><given-names>S</given-names></name><name><surname>Talebi</surname><given-names>R</given-names></name><name><surname>Tarnogorska</surname><given-names>D</given-names></name><name><surname>Tenshaw</surname><given-names>E</given-names></name><name><surname>Tokhi</surname><given-names>T</given-names></name><name><surname>Walsh</surname><given-names>JJ</given-names></name><name><surname>Horne</surname><given-names>JA</given-names></name><name><surname>Parekh</surname><given-names>R</given-names></name><name><surname>Rivlin</surname><given-names>PK</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Meinertzhagen</surname><given-names>I</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Jain</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>Data for A Connectome of the Adult <italic>Drosophila</italic> Central Brain v1.0</data-title><source>Janelia Research Campus</source><pub-id pub-id-type="doi">10.25378/janelia.11676099</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>We would like to thank Benjamin F Grewe for his support and helpful comments.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alon</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Simplicity in biology</article-title><source>Nature</source><volume>446</volume><elocation-id>497</elocation-id><pub-id pub-id-type="doi">10.1038/446497a</pub-id><pub-id pub-id-type="pmid">17392770</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname><given-names>CL</given-names></name><name><surname>Bonnéry</surname><given-names>D</given-names></name><name><surname>Cardona</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Synaptic counts approximate synaptic contact area in <italic>Drosophila</italic></article-title><source>PLOS ONE</source><volume>17</volume><elocation-id>e0266064</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0266064</pub-id><pub-id pub-id-type="pmid">35377898</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beetz</surname><given-names>MJ</given-names></name><name><surname>Kraus</surname><given-names>C</given-names></name><name><surname>Franzke</surname><given-names>M</given-names></name><name><surname>Dreyer</surname><given-names>D</given-names></name><name><surname>Strube-Bloss</surname><given-names>MF</given-names></name><name><surname>Rössler</surname><given-names>W</given-names></name><name><surname>Warrant</surname><given-names>EJ</given-names></name><name><surname>Merlin</surname><given-names>C</given-names></name><name><surname>El Jundi</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Flight-induced compass representation in the monarch butterfly heading network</article-title><source>Current Biology</source><volume>32</volume><fpage>338</fpage><lpage>349</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.11.009</pub-id><pub-id pub-id-type="pmid">34822766</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Burnham</surname><given-names>KP</given-names></name><name><surname>Anderson</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2004">2004</year><chapter-title>A practical information-theoretic approach</chapter-title><person-group person-group-type="editor"><name><surname>Burnham</surname><given-names>KP</given-names></name></person-group><source>Model Selection and Multimodel Inference</source><publisher-name>Springer</publisher-name><fpage>1</fpage><lpage>488</lpage><pub-id pub-id-type="doi">10.1007/b97636</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collett</surname><given-names>TS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Path integration: how details of the honeybee waggle dance and the foraging strategies of desert ants might help in understanding its mechanisms</article-title><source>The Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb205187</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.205187</pub-id><pub-id pub-id-type="pmid">31152122</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cope</surname><given-names>AJ</given-names></name><name><surname>Sabo</surname><given-names>C</given-names></name><name><surname>Vasilaki</surname><given-names>E</given-names></name><name><surname>Barron</surname><given-names>AB</given-names></name><name><surname>Marshall</surname><given-names>JAR</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A computational model of the integration of landmarks and motion in the insect central complex</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0172325</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0172325</pub-id><pub-id pub-id-type="pmid">28241061</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Cornford</surname><given-names>J</given-names></name><name><surname>Kalajdzievski</surname><given-names>D</given-names></name><name><surname>Leite</surname><given-names>M</given-names></name><name><surname>Lamarquette</surname><given-names>A</given-names></name><name><surname>Kullmann</surname><given-names>DM</given-names></name><name><surname>Richards</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Learning to Live with Dale’s Principle: Anns with Separate Excitatory and Inhibitory Units</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2020.11.02.364968</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Dall'Osto</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>Insect-navigation-sinusoidal-optimality</data-title><version designator="swh:1:rev:0890b606d28f33bfbeffbc0d2aa594a91733b63d">swh:1:rev:0890b606d28f33bfbeffbc0d2aa594a91733b63d</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:929999f4015d082bef382f73c325ee23a9809c8d;origin=https://github.com/Dominic-DallOsto/insect-navigation-sinusoidal-optimality;visit=swh:1:snp:f692bc59d87e9dfd12afe3980a933288d1e9a64c;anchor=swh:1:rev:0890b606d28f33bfbeffbc0d2aa594a91733b63d">https://archive.softwareheritage.org/swh:1:dir:929999f4015d082bef382f73c325ee23a9809c8d;origin=https://github.com/Dominic-DallOsto/insect-navigation-sinusoidal-optimality;visit=swh:1:snp:f692bc59d87e9dfd12afe3980a933288d1e9a64c;anchor=swh:1:rev:0890b606d28f33bfbeffbc0d2aa594a91733b63d</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name></person-group><year iso-8601-date="2001">2001</year><source>Theoretical Neuroscience: Computational and Mathematical Modeling of Neural Systems</source><publisher-name>Massachusetts Institute of Technology Press</publisher-name></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dingle</surname><given-names>K</given-names></name><name><surname>Camargo</surname><given-names>CQ</given-names></name><name><surname>Louis</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Input-output maps are strongly biased towards simple outputs</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>761</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-03101-6</pub-id><pub-id pub-id-type="pmid">29472533</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Jundi</surname><given-names>B</given-names></name><name><surname>Pfeiffer</surname><given-names>K</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Integration of polarization and chromatic cues in the insect sky compass</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>200</volume><fpage>575</fpage><lpage>589</lpage><pub-id pub-id-type="doi">10.1007/s00359-014-0890-6</pub-id><pub-id pub-id-type="pmid">24589854</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>El Jundi</surname><given-names>B</given-names></name><name><surname>Baird</surname><given-names>E</given-names></name><name><surname>Byrne</surname><given-names>MJ</given-names></name><name><surname>Dacke</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The brain behind straight-line orientation in dung beetles</article-title><source>The Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb192450</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.192450</pub-id><pub-id pub-id-type="pmid">30728239</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Green</surname><given-names>J</given-names></name><name><surname>Adachi</surname><given-names>A</given-names></name><name><surname>Shah</surname><given-names>KK</given-names></name><name><surname>Hirokawa</surname><given-names>JD</given-names></name><name><surname>Magani</surname><given-names>PS</given-names></name><name><surname>Maimon</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>A neural circuit architecture for angular integration in <italic>Drosophila</italic></article-title><source>Nature</source><volume>546</volume><fpage>101</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1038/nature22343</pub-id><pub-id pub-id-type="pmid">28538731</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haferlach</surname><given-names>T</given-names></name><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Mangan</surname><given-names>M</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Evolving a neural model of insect path integration</article-title><source>Adaptive Behavior</source><volume>15</volume><fpage>273</fpage><lpage>287</lpage><pub-id pub-id-type="doi">10.1177/1059712307082080</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hartmann</surname><given-names>G</given-names></name><name><surname>Wehner</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>The ant's path integration system: a neural architecture</article-title><source>Biological Cybernetics</source><volume>73</volume><fpage>483</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1007/s004220050204</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Gotthardt</surname><given-names>S</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Transformation of polarized light information in the central complex of the locust</article-title><source>The Journal of Neuroscience</source><volume>29</volume><fpage>11783</fpage><lpage>11793</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1870-09.2009</pub-id><pub-id pub-id-type="pmid">19776265</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Florman</surname><given-names>J</given-names></name><name><surname>Asokaraj</surname><given-names>S</given-names></name><name><surname>El Jundi</surname><given-names>B</given-names></name><name><surname>Reppert</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Anatomical basis of sun compass navigation II: the neuronal composition of the central complex of the monarch butterfly</article-title><source>The Journal of Comparative Neurology</source><volume>521</volume><fpage>267</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1002/cne.23214</pub-id><pub-id pub-id-type="pmid">22886450</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Homberg</surname><given-names>U</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Pfeiffer</surname><given-names>K</given-names></name><name><surname>Kinoshita</surname><given-names>M</given-names></name><name><surname>el Jundi</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Central neural coding of sky polarization in insects</article-title><source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source><volume>366</volume><fpage>680</fpage><lpage>687</lpage><pub-id pub-id-type="doi">10.1098/rstb.2010.0199</pub-id><pub-id pub-id-type="pmid">21282171</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Honkanen</surname><given-names>A</given-names></name><name><surname>Adden</surname><given-names>A</given-names></name><name><surname>da Silva Freitas</surname><given-names>J</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The insect central complex and the neural basis of navigational strategies</article-title><source>The Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb188854</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.188854</pub-id><pub-id pub-id-type="pmid">30728235</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>L</given-names></name><name><surname>Ledochowitsch</surname><given-names>P</given-names></name><name><surname>Knoblich</surname><given-names>U</given-names></name><name><surname>Lecoq</surname><given-names>J</given-names></name><name><surname>Murphy</surname><given-names>GJ</given-names></name><name><surname>Reid</surname><given-names>RC</given-names></name><name><surname>de Vries</surname><given-names>SE</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Zeng</surname><given-names>H</given-names></name><name><surname>Buice</surname><given-names>MA</given-names></name><name><surname>Waters</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Relationship between simultaneously recorded spiking activity and fluorescence signal in GCaMP6 transgenic mice</article-title><source>eLife</source><volume>10</volume><elocation-id>e51675</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.51675</pub-id><pub-id pub-id-type="pmid">33683198</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hulse</surname><given-names>BK</given-names></name><name><surname>Haberkern</surname><given-names>H</given-names></name><name><surname>Franconville</surname><given-names>R</given-names></name><name><surname>Turner-Evans</surname><given-names>D</given-names></name><name><surname>Takemura</surname><given-names>S-Y</given-names></name><name><surname>Wolff</surname><given-names>T</given-names></name><name><surname>Noorman</surname><given-names>M</given-names></name><name><surname>Dreher</surname><given-names>M</given-names></name><name><surname>Dan</surname><given-names>C</given-names></name><name><surname>Parekh</surname><given-names>R</given-names></name><name><surname>Hermundstad</surname><given-names>AM</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A connectome of the <italic>Drosophila</italic> central complex reveals network motifs suitable for flexible navigation and context-dependent action selection</article-title><source>eLife</source><volume>10</volume><elocation-id>e66039</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.66039</pub-id><pub-id pub-id-type="pmid">34696823</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname><given-names>IG</given-names></name><name><surname>Dingle</surname><given-names>K</given-names></name><name><surname>Greenbury</surname><given-names>SF</given-names></name><name><surname>Camargo</surname><given-names>CQ</given-names></name><name><surname>Doye</surname><given-names>JPK</given-names></name><name><surname>Ahnert</surname><given-names>SE</given-names></name><name><surname>Louis</surname><given-names>AA</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Symmetry and simplicity spontaneously emerge from the algorithmic nature of evolution</article-title><source>PNAS</source><volume>119</volume><elocation-id>e2113883119</elocation-id><pub-id pub-id-type="doi">10.1073/pnas.2113883119</pub-id><pub-id pub-id-type="pmid">35275794</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kakaria</surname><given-names>KS</given-names></name><name><surname>de Bivort</surname><given-names>BL</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ring attractor dynamics emerge from a spiking model of the entire protocerebral bridge</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>11</volume><elocation-id>8</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2017.00008</pub-id><pub-id pub-id-type="pmid">28261066</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SS</given-names></name><name><surname>Rouault</surname><given-names>H</given-names></name><name><surname>Druckmann</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Ring attractor dynamics in the <italic>Drosophila</italic> central brain</article-title><source>Science</source><volume>356</volume><fpage>849</fpage><lpage>853</lpage><pub-id pub-id-type="doi">10.1126/science.aal4835</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kinoshita</surname><given-names>M</given-names></name><name><surname>Pfeiffer</surname><given-names>K</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Spectral properties of identified polarized-light sensitive interneurons in the brain of the desert locust Schistocerca gregaria</article-title><source>The Journal of Experimental Biology</source><volume>210</volume><fpage>1350</fpage><lpage>1361</lpage><pub-id pub-id-type="doi">10.1242/jeb.02744</pub-id><pub-id pub-id-type="pmid">17401118</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kriegeskorte</surname><given-names>N</given-names></name><name><surname>Golan</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Neural network models and deep learning</article-title><source>Current Biology</source><volume>29</volume><fpage>R231</fpage><lpage>R236</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2019.02.034</pub-id><pub-id pub-id-type="pmid">30939301</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labhart</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Polarization-opponent interneurons in the insect visual system</article-title><source>Nature</source><volume>331</volume><fpage>435</fpage><lpage>437</lpage><pub-id pub-id-type="doi">10.1038/331435a0</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Labhart</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Polarization-sensitive interneurons in the optic lobe of the desert ant Cataglyphis bicolor</article-title><source>Die Naturwissenschaften</source><volume>87</volume><fpage>133</fpage><lpage>136</lpage><pub-id pub-id-type="doi">10.1007/s001140050691</pub-id><pub-id pub-id-type="pmid">10798199</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P</given-names></name><name><surname>Cornford</surname><given-names>J</given-names></name><name><surname>Ghosh</surname><given-names>A</given-names></name><name><surname>Richards</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Learning Better with Dale’s Law: A Spectral Perspective</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.06.28.546924</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>TX</given-names></name><name><surname>Davoudian</surname><given-names>PA</given-names></name><name><surname>Lizbinski</surname><given-names>KM</given-names></name><name><surname>Jeanne</surname><given-names>JM</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Connectomic features underlying diverse synaptic connection strengths and subcellular computation</article-title><source>Current Biology</source><volume>32</volume><fpage>559</fpage><lpage>569</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2021.11.056</pub-id><pub-id pub-id-type="pmid">34914905</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loesel</surname><given-names>R</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Anatomy and physiology of neurons with processes in the accessory medulla of the cockroach Leucophaea maderae</article-title><source>The Journal of Comparative Neurology</source><volume>439</volume><fpage>193</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1002/cne.1342</pub-id><pub-id pub-id-type="pmid">11596048</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyu</surname><given-names>C</given-names></name><name><surname>Abbott</surname><given-names>LF</given-names></name><name><surname>Maimon</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Building an allocentric travelling direction signal via vector computation</article-title><source>Nature</source><volume>601</volume><fpage>92</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1038/s41586-021-04067-0</pub-id><pub-id pub-id-type="pmid">34912112</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mappes</surname><given-names>M</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Behavioral analysis of polarization vision in tethered flying locusts</article-title><source>Journal of Comparative Physiology. A, Neuroethology, Sensory, Neural, and Behavioral Physiology</source><volume>190</volume><fpage>61</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1007/s00359-003-0473-4</pub-id><pub-id pub-id-type="pmid">14648100</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menzel</surname><given-names>R</given-names></name><name><surname>Geiger</surname><given-names>K</given-names></name><name><surname>Chittka</surname><given-names>L</given-names></name><name><surname>Joerges</surname><given-names>J</given-names></name><name><surname>Kunze</surname><given-names>J</given-names></name><name><surname>Müller</surname><given-names>U</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>The knowledge base of bee navigation</article-title><source>Journal of Experimental Biology</source><volume>199</volume><fpage>141</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1242/jeb.199.1.141</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merlin</surname><given-names>C</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Reppert</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Unraveling navigational strategies in migratory insects</article-title><source>Current Opinion in Neurobiology</source><volume>22</volume><fpage>353</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1016/j.conb.2011.11.009</pub-id><pub-id pub-id-type="pmid">22154565</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mittelstaedt</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1985">1985</year><chapter-title>Analytical cybernetics of spider navigation</chapter-title><person-group person-group-type="editor"><name><surname>Barth</surname><given-names>FG</given-names></name></person-group><source>Neurobiology of Arachnids</source><publisher-name>Springer</publisher-name><fpage>298</fpage><lpage>316</lpage><pub-id pub-id-type="doi">10.1007/978-3-642-70348-5_15</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Müller</surname><given-names>M</given-names></name><name><surname>Wehner</surname><given-names>R</given-names></name></person-group><year iso-8601-date="1988">1988</year><article-title>Path integration in desert ants, Cataglyphis fortis</article-title><source>PNAS</source><volume>85</volume><fpage>5287</fpage><lpage>5290</lpage><pub-id pub-id-type="doi">10.1073/pnas.85.14.5287</pub-id><pub-id pub-id-type="pmid">16593958</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>K</given-names></name><name><surname>Kinoshita</surname><given-names>M</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Polarization-sensitive and light-sensitive neurons in two parallel pathways passing through the anterior optic tubercle in the locust brain</article-title><source>Journal of Neurophysiology</source><volume>94</volume><fpage>3903</fpage><lpage>3915</lpage><pub-id pub-id-type="doi">10.1152/jn.00276.2005</pub-id><pub-id pub-id-type="pmid">16049147</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pfeiffer</surname><given-names>K</given-names></name><name><surname>Homberg</surname><given-names>U</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Coding of azimuthal directions via time-compensated combination of celestial compass cues</article-title><source>Current Biology</source><volume>17</volume><fpage>960</fpage><lpage>965</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2007.04.059</pub-id><pub-id pub-id-type="pmid">17524646</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pisokas</surname><given-names>I</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The head direction circuit of two insect species</article-title><source>eLife</source><volume>9</volume><elocation-id>e53985</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.53985</pub-id><pub-id pub-id-type="pmid">32628112</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sakura</surname><given-names>M</given-names></name><name><surname>Lambrinos</surname><given-names>D</given-names></name><name><surname>Labhart</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Polarized skylight navigation in insects: model and electrophysiology of e-vector coding by neurons in the central complex</article-title><source>Journal of Neurophysiology</source><volume>99</volume><fpage>667</fpage><lpage>682</lpage><pub-id pub-id-type="doi">10.1152/jn.00784.2007</pub-id><pub-id pub-id-type="pmid">18057112</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sayre</surname><given-names>ME</given-names></name><name><surname>Templin</surname><given-names>R</given-names></name><name><surname>Chavez</surname><given-names>J</given-names></name><name><surname>Kempenaers</surname><given-names>J</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>A projectome of the bumblebee central complex</article-title><source>eLife</source><volume>10</volume><elocation-id>e68911</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.68911</pub-id><pub-id pub-id-type="pmid">34523418</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scheffer</surname><given-names>LK</given-names></name><name><surname>Xu</surname><given-names>CS</given-names></name><name><surname>Januszewski</surname><given-names>M</given-names></name><name><surname>Lu</surname><given-names>Z</given-names></name><name><surname>Takemura</surname><given-names>S-Y</given-names></name><name><surname>Hayworth</surname><given-names>KJ</given-names></name><name><surname>Huang</surname><given-names>GB</given-names></name><name><surname>Shinomiya</surname><given-names>K</given-names></name><name><surname>Maitlin-Shepard</surname><given-names>J</given-names></name><name><surname>Berg</surname><given-names>S</given-names></name><name><surname>Clements</surname><given-names>J</given-names></name><name><surname>Hubbard</surname><given-names>PM</given-names></name><name><surname>Katz</surname><given-names>WT</given-names></name><name><surname>Umayam</surname><given-names>L</given-names></name><name><surname>Zhao</surname><given-names>T</given-names></name><name><surname>Ackerman</surname><given-names>D</given-names></name><name><surname>Blakely</surname><given-names>T</given-names></name><name><surname>Bogovic</surname><given-names>J</given-names></name><name><surname>Dolafi</surname><given-names>T</given-names></name><name><surname>Kainmueller</surname><given-names>D</given-names></name><name><surname>Kawase</surname><given-names>T</given-names></name><name><surname>Khairy</surname><given-names>KA</given-names></name><name><surname>Leavitt</surname><given-names>L</given-names></name><name><surname>Li</surname><given-names>PH</given-names></name><name><surname>Lindsey</surname><given-names>L</given-names></name><name><surname>Neubarth</surname><given-names>N</given-names></name><name><surname>Olbris</surname><given-names>DJ</given-names></name><name><surname>Otsuna</surname><given-names>H</given-names></name><name><surname>Trautman</surname><given-names>ET</given-names></name><name><surname>Ito</surname><given-names>M</given-names></name><name><surname>Bates</surname><given-names>AS</given-names></name><name><surname>Goldammer</surname><given-names>J</given-names></name><name><surname>Wolff</surname><given-names>T</given-names></name><name><surname>Svirskas</surname><given-names>R</given-names></name><name><surname>Schlegel</surname><given-names>P</given-names></name><name><surname>Neace</surname><given-names>E</given-names></name><name><surname>Knecht</surname><given-names>CJ</given-names></name><name><surname>Alvarado</surname><given-names>CX</given-names></name><name><surname>Bailey</surname><given-names>DA</given-names></name><name><surname>Ballinger</surname><given-names>S</given-names></name><name><surname>Borycz</surname><given-names>JA</given-names></name><name><surname>Canino</surname><given-names>BS</given-names></name><name><surname>Cheatham</surname><given-names>N</given-names></name><name><surname>Cook</surname><given-names>M</given-names></name><name><surname>Dreher</surname><given-names>M</given-names></name><name><surname>Duclos</surname><given-names>O</given-names></name><name><surname>Eubanks</surname><given-names>B</given-names></name><name><surname>Fairbanks</surname><given-names>K</given-names></name><name><surname>Finley</surname><given-names>S</given-names></name><name><surname>Forknall</surname><given-names>N</given-names></name><name><surname>Francis</surname><given-names>A</given-names></name><name><surname>Hopkins</surname><given-names>GP</given-names></name><name><surname>Joyce</surname><given-names>EM</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name><name><surname>Kirk</surname><given-names>NA</given-names></name><name><surname>Kovalyak</surname><given-names>J</given-names></name><name><surname>Lauchie</surname><given-names>SA</given-names></name><name><surname>Lohff</surname><given-names>A</given-names></name><name><surname>Maldonado</surname><given-names>C</given-names></name><name><surname>Manley</surname><given-names>EA</given-names></name><name><surname>McLin</surname><given-names>S</given-names></name><name><surname>Mooney</surname><given-names>C</given-names></name><name><surname>Ndama</surname><given-names>M</given-names></name><name><surname>Ogundeyi</surname><given-names>O</given-names></name><name><surname>Okeoma</surname><given-names>N</given-names></name><name><surname>Ordish</surname><given-names>C</given-names></name><name><surname>Padilla</surname><given-names>N</given-names></name><name><surname>Patrick</surname><given-names>CM</given-names></name><name><surname>Paterson</surname><given-names>T</given-names></name><name><surname>Phillips</surname><given-names>EE</given-names></name><name><surname>Phillips</surname><given-names>EM</given-names></name><name><surname>Rampally</surname><given-names>N</given-names></name><name><surname>Ribeiro</surname><given-names>C</given-names></name><name><surname>Robertson</surname><given-names>MK</given-names></name><name><surname>Rymer</surname><given-names>JT</given-names></name><name><surname>Ryan</surname><given-names>SM</given-names></name><name><surname>Sammons</surname><given-names>M</given-names></name><name><surname>Scott</surname><given-names>AK</given-names></name><name><surname>Scott</surname><given-names>AL</given-names></name><name><surname>Shinomiya</surname><given-names>A</given-names></name><name><surname>Smith</surname><given-names>C</given-names></name><name><surname>Smith</surname><given-names>K</given-names></name><name><surname>Smith</surname><given-names>NL</given-names></name><name><surname>Sobeski</surname><given-names>MA</given-names></name><name><surname>Suleiman</surname><given-names>A</given-names></name><name><surname>Swift</surname><given-names>J</given-names></name><name><surname>Takemura</surname><given-names>S</given-names></name><name><surname>Talebi</surname><given-names>I</given-names></name><name><surname>Tarnogorska</surname><given-names>D</given-names></name><name><surname>Tenshaw</surname><given-names>E</given-names></name><name><surname>Tokhi</surname><given-names>T</given-names></name><name><surname>Walsh</surname><given-names>JJ</given-names></name><name><surname>Yang</surname><given-names>T</given-names></name><name><surname>Horne</surname><given-names>JA</given-names></name><name><surname>Li</surname><given-names>F</given-names></name><name><surname>Parekh</surname><given-names>R</given-names></name><name><surname>Rivlin</surname><given-names>PK</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name><name><surname>Costa</surname><given-names>M</given-names></name><name><surname>Jefferis</surname><given-names>GS</given-names></name><name><surname>Ito</surname><given-names>K</given-names></name><name><surname>Saalfeld</surname><given-names>S</given-names></name><name><surname>George</surname><given-names>R</given-names></name><name><surname>Meinertzhagen</surname><given-names>IA</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Hess</surname><given-names>HF</given-names></name><name><surname>Jain</surname><given-names>V</given-names></name><name><surname>Plaza</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A connectome and analysis of the adult <italic>Drosophila</italic> central brain</article-title><source>eLife</source><volume>9</volume><elocation-id>e57443</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.57443</pub-id><pub-id pub-id-type="pmid">32880371</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seelig</surname><given-names>JD</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neural dynamics for landmark orientation and angular path integration</article-title><source>Nature</source><volume>521</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1038/nature14446</pub-id><pub-id pub-id-type="pmid">25971509</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siegle</surname><given-names>JH</given-names></name><name><surname>Ledochowitsch</surname><given-names>P</given-names></name><name><surname>Jia</surname><given-names>X</given-names></name><name><surname>Millman</surname><given-names>DJ</given-names></name><name><surname>Ocker</surname><given-names>GK</given-names></name><name><surname>Caldejon</surname><given-names>S</given-names></name><name><surname>Casal</surname><given-names>L</given-names></name><name><surname>Cho</surname><given-names>A</given-names></name><name><surname>Denman</surname><given-names>DJ</given-names></name><name><surname>Durand</surname><given-names>S</given-names></name><name><surname>Groblewski</surname><given-names>PA</given-names></name><name><surname>Heller</surname><given-names>G</given-names></name><name><surname>Kato</surname><given-names>I</given-names></name><name><surname>Kivikas</surname><given-names>S</given-names></name><name><surname>Lecoq</surname><given-names>J</given-names></name><name><surname>Nayan</surname><given-names>C</given-names></name><name><surname>Ngo</surname><given-names>K</given-names></name><name><surname>Nicovich</surname><given-names>PR</given-names></name><name><surname>North</surname><given-names>K</given-names></name><name><surname>Ramirez</surname><given-names>TK</given-names></name><name><surname>Swapp</surname><given-names>J</given-names></name><name><surname>Waughman</surname><given-names>X</given-names></name><name><surname>Williford</surname><given-names>A</given-names></name><name><surname>Olsen</surname><given-names>SR</given-names></name><name><surname>Koch</surname><given-names>C</given-names></name><name><surname>Buice</surname><given-names>MA</given-names></name><name><surname>de Vries</surname><given-names>SE</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Reconciling functional differences in populations of neurons recorded with two-photon imaging and electrophysiology</article-title><source>eLife</source><volume>10</volume><elocation-id>e69068</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.69068</pub-id><pub-id pub-id-type="pmid">34270411</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stone</surname><given-names>T</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name><name><surname>Adden</surname><given-names>A</given-names></name><name><surname>Weddig</surname><given-names>NB</given-names></name><name><surname>Honkanen</surname><given-names>A</given-names></name><name><surname>Templin</surname><given-names>R</given-names></name><name><surname>Wcislo</surname><given-names>W</given-names></name><name><surname>Scimeca</surname><given-names>L</given-names></name><name><surname>Warrant</surname><given-names>E</given-names></name><name><surname>Heinze</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An anatomically constrained model for path integration in the bee brain</article-title><source>Current Biology</source><volume>27</volume><fpage>3069</fpage><lpage>3085</lpage><pub-id pub-id-type="doi">10.1016/j.cub.2017.08.052</pub-id><pub-id pub-id-type="pmid">28988858</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stringer</surname><given-names>SM</given-names></name><name><surname>Trappenberg</surname><given-names>TP</given-names></name><name><surname>Rolls</surname><given-names>ET</given-names></name><name><surname>de Araujo</surname><given-names>IET</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Self-organizing continuous attractor networks and path integration: one-dimensional models of head direction cells</article-title><source>Network</source><volume>13</volume><fpage>217</fpage><lpage>242</lpage><pub-id pub-id-type="doi">10.1080/net.13.2.217.242</pub-id><pub-id pub-id-type="pmid">12061421</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Su</surname><given-names>T-S</given-names></name><name><surname>Lee</surname><given-names>W-J</given-names></name><name><surname>Huang</surname><given-names>Y-C</given-names></name><name><surname>Wang</surname><given-names>C-T</given-names></name><name><surname>Lo</surname><given-names>C-C</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Coupled symmetric and asymmetric circuits underlying spatial orientation in fruit flies</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>139</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00191-6</pub-id><pub-id pub-id-type="pmid">28747622</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taube</surname><given-names>JS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>The head direction signal: origins and sensory-motor integration</article-title><source>Annual Review of Neuroscience</source><volume>30</volume><fpage>181</fpage><lpage>207</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.29.051605.112854</pub-id><pub-id pub-id-type="pmid">17341158</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Touretzky</surname><given-names>DS</given-names></name><name><surname>Redish</surname><given-names>AD</given-names></name><name><surname>Wan</surname><given-names>HS</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>Neural representation of space using sinusoidal arrays</article-title><source>Neural Computation</source><volume>5</volume><fpage>869</fpage><lpage>884</lpage><pub-id pub-id-type="doi">10.1162/neco.1993.5.6.869</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner-Evans</surname><given-names>D</given-names></name><name><surname>Wegener</surname><given-names>S</given-names></name><name><surname>Rouault</surname><given-names>H</given-names></name><name><surname>Franconville</surname><given-names>R</given-names></name><name><surname>Wolff</surname><given-names>T</given-names></name><name><surname>Seelig</surname><given-names>JD</given-names></name><name><surname>Druckmann</surname><given-names>S</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Angular velocity integration in a fly heading circuit</article-title><source>eLife</source><volume>6</volume><elocation-id>e23496</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23496</pub-id><pub-id pub-id-type="pmid">28530551</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turner-Evans</surname><given-names>DB</given-names></name><name><surname>Jensen</surname><given-names>KT</given-names></name><name><surname>Ali</surname><given-names>S</given-names></name><name><surname>Paterson</surname><given-names>T</given-names></name><name><surname>Sheridan</surname><given-names>A</given-names></name><name><surname>Ray</surname><given-names>RP</given-names></name><name><surname>Wolff</surname><given-names>T</given-names></name><name><surname>Lauritzen</surname><given-names>JS</given-names></name><name><surname>Rubin</surname><given-names>GM</given-names></name><name><surname>Bock</surname><given-names>DD</given-names></name><name><surname>Jayaraman</surname><given-names>V</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The neuroanatomical ultrastructure and function of a biological ring attractor</article-title><source>Neuron</source><volume>108</volume><fpage>145</fpage><lpage>163</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2020.08.006</pub-id><pub-id pub-id-type="pmid">32916090</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vafidis</surname><given-names>P</given-names></name><name><surname>Owald</surname><given-names>D</given-names></name><name><surname>D’Albis</surname><given-names>T</given-names></name><name><surname>Kempter</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Learning accurate path integration in ring attractor models of the head direction system</article-title><source>eLife</source><volume>11</volume><elocation-id>e69841</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.69841</pub-id><pub-id pub-id-type="pmid">35723252</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vickerstaff</surname><given-names>RJ</given-names></name><name><surname>Di Paolo</surname><given-names>EA</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Evolving neural models of path integration</article-title><source>The Journal of Experimental Biology</source><volume>208</volume><fpage>3349</fpage><lpage>3366</lpage><pub-id pub-id-type="doi">10.1242/jeb.01772</pub-id><pub-id pub-id-type="pmid">16109896</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warren</surname><given-names>TLT</given-names></name><name><surname>Giraldo</surname><given-names>YMY</given-names></name><name><surname>Dickinson</surname><given-names>MMH</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Celestial navigation in <italic>Drosophila</italic></article-title><source>Journal of Experimental Biology</source><volume>222</volume><elocation-id>jeb186148</elocation-id><pub-id pub-id-type="doi">10.1242/jeb.186148</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wehner</surname><given-names>R</given-names></name><name><surname>Srinivasan</surname><given-names>MV</given-names></name></person-group><year iso-8601-date="2003">2003</year><chapter-title>Path integration in insects</chapter-title><person-group person-group-type="editor"><name><surname>Jeffery</surname><given-names>K</given-names></name></person-group><source>The Neurobiology of Spatial Behaviour</source><publisher-name>Oxford University Press</publisher-name><fpage>9</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1093/acprof:oso/9780198515241.003.0001</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wessnitzer</surname><given-names>J</given-names></name><name><surname>Haferlach</surname><given-names>T</given-names></name><name><surname>Mangan</surname><given-names>M</given-names></name><name><surname>Webb</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Path integration using a model of e-vector orientation coding in the insect brain: Reply to vickerstaff and di paolo</article-title><source>Adaptive Behavior</source><volume>16</volume><fpage>277</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1177/1059712308094947</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wittmann</surname><given-names>T</given-names></name><name><surname>Schwegler</surname><given-names>H</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Path integration — a network model</article-title><source>Biological Cybernetics</source><volume>73</volume><fpage>569</fpage><lpage>575</lpage><pub-id pub-id-type="doi">10.1007/BF00199549</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zador</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A critique of pure learning and what artificial neural networks can learn from animal brains</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>3770</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-11786-6</pub-id><pub-id pub-id-type="pmid">31434893</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>K</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Representation of spatial orientation by the intrinsic dynamics of the head-direction cell ensemble: a theory</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>2112</fpage><lpage>2126</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-06-02112.1996</pub-id><pub-id pub-id-type="pmid">8604055</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91533.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>University of Texas at Austin</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><related-object id="sa0ro1" object-id-type="id" object-id="10.1101/2023.07.05.547838" link-type="continued-by" xlink:href="https://sciety.org/articles/activity/10.1101/2023.07.05.547838"/></front-stub><body><p>This important work suggests that the observed cosine-like activity in the head direction circuit of insects not only subserves vector addition but also minimizes noise in the representation. The authors provide solid evidence using the locust and fruit fly connectomes. The work raises important theoretical questions about the organization of the navigation system and will be of interest to theoretical and experimental researchers studying navigation.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91533.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Colgin</surname><given-names>Laura L</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>University of Texas at Austin</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Vafidis</surname><given-names>Pantelis</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05dxps055</institution-id><institution>California Institute of Technology</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>Our editorial process produces two outputs: (i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/2023.07.05.547838">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.07.05.547838v2">the preprint</ext-link> for the benefit of readers; (ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;The insect compass system: From theory to circuitry&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 1 peer reviewer, and the evaluation has been overseen by a Reviewing Editor and Laura Colgin as the Senior Editor.</p><p>The reviewer and the Senior Editor have discussed your submission, and the Senior Editor has drafted this to help you prepare a revised submission.</p><p>Thank you for your patience. It was difficult to find reviewers for your manuscript. Then, one of the reviewers did not submit their review and did not respond to emails over the course of multiple months. In fairness to you, we decided to move forward with the decision on the basis of one review.</p><p>Essential revisions (for the authors):</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>– L. 186 &quot;..these extra encoding channels require a higher total neural activity…&quot; A sentence explaining why this is the case would be helpful to the reader. For example, this might be because we require a localized bump of activity.</p><p>– L. 18 &quot;finding a remarkable agreement between our theory and experimental evidence&quot;, L. 267 &quot;We therefore confirm our prediction…&quot; I believe the language here should be toned down (see weaknesses point 2).</p><p>– Some explanation of how eq. 23 is derived would be beneficial.</p><p>­– Methods section 3.2 is instructive but a sentence explaining the choice to model the impact of noise as a phase drift δθ would be beneficial. ­</p><p>– L. 427 the degeneracy argument holds if the weights between the two sets of neurons are zero. Another argument against this circuit is that it has half the spatial resolution.</p><p>– L. 297-9 This statement seems a bit harsh. Picking up the dominant frequency would still be a great result.</p><p>– L. 342-4 The idea to learn the HD system by simple Hebbian learning rules has been proposed before by Stringer et al. 2002, and potentially others. The authors should cite this work.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.91533.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions (for the authors):</p><p>– L. 186 &quot;..these extra encoding channels require a higher total neural activity…&quot; A sentence explaining why this is the case would be helpful to the reader. For example, this might be because we require a localized bump of activity.</p></disp-quote><p>We added the appropriate explanation (lines 184-188).</p><p>“As mentioned, the signal-to-noise ratio in the network remains constant as additional encoding channels, c, are used. But additional channels imply additional harmonics, which by Parseval's theorem require a higher total neural activity.”</p><disp-quote content-type="editor-comment"><p>– L. 18 &quot;finding a remarkable agreement between our theory and experimental evidence&quot;, L. 267 &quot;We therefore confirm our prediction…&quot; I believe the language here should be toned down (see weaknesses point 2).</p></disp-quote><p>We modified the text accordingly, and now state that our theory is consistent with the data (line 15 and lines 268-274).</p><p>“We repeated the path counting analysis for the fruit fly with synapse count data (Figure 4, B), and found that while the data are noisy, the connectivity profile fits a single sinusoid pattern reasonably well. However, the high variability in the synapse counts makes our hypothesis difficult to differentiate from alternative shapes (see Section 4.6).</p><p>Taken together, this analysis shows that our theory is consistent with experimental data – using connectivity-level data for the desert locust and synapse-count data for the fruit fly.”</p><disp-quote content-type="editor-comment"><p>– Some explanation of how eq. 23 is derived would be beneficial.</p></disp-quote><p>We added an explanation (lines 396-399)</p><p>“To incorporate the dynamics that force the activity to return to the cycle, we add a new term into the network dynamics which fulﬁls Eq. 22 – increasing ‖F_f[a]‖ if ‖a‖&lt; r and decreasing it if ‖a‖&gt; r. This increase or decrease can be incorporated as a simple scaling factor on the activity decay term”</p><disp-quote content-type="editor-comment"><p>– Methods section 3.2 is instructive but a sentence explaining the choice to model the impact of noise as a phase drift δθ would be beneficial.</p></disp-quote><p>We added a sentence explaining that given the circular line attractor dynamics – which emerge from our initial assumptions – any perturbation would eventually be equivalent to a phase drift (lines 422-423).</p><p>“We only focus on angular drift, rather than noise in the full activity, because as noted in Section 4.1, any deviations in the overall activity level in the network will dissipate.”</p><disp-quote content-type="editor-comment"><p>– L. 427 the degeneracy argument holds if the weights between the two sets of neurons are zero. Another argument against this circuit is that it has half the spatial resolution.</p></disp-quote><p>We agree with the statement about the degeneracy, and note that the zero weights would also emerge from a learning rule if the neurons are uncorrelated with zero correlations. The notion of spatial resolution is perhaps slightly confusing here. But in terms of “decoding accuracy” – i.e. how much the represented angle is corrupted by the addition of zero mean noise to each neuron’s activity – the circuits are equivalent. Even though the f=2 circuit only represents half the number of directions as the f=1 circuit, each direction has half the noise variance because the two neurons’ activities can be averaged.</p><disp-quote content-type="editor-comment"><p>– L. 297-9 This statement seems a bit harsh. Picking up the dominant frequency would still be a great result.</p></disp-quote><p>The dominant frequency is indeed amplified with respect to the others. We emphasised this point (lines 307-312).</p><p>“An important point in the use of Oja’s rule is that it would tend to concentrate the activity in a single harmonic. In a linear network, the harmonics would compete during learning, leading to one single harmonic emerging and all others being suppressed, as shown in Section 4.7.1. For neurons with a nonlinear activation function, secondary harmonics would emerge, but would remain small under mild assumptions, as shown in Section 4.7.2. Oja’s rule will still cause the weights to converge to approximately sinusoidal connectivity.”</p><disp-quote content-type="editor-comment"><p>– L. 342-4 The idea to learn the HD system by simple Hebbian learning rules has been proposed before by Stringer et al. 2002, and potentially others. The authors should cite this work..</p></disp-quote><p>We have added this reference (see response to major point 3).</p></body></sub-article></article>