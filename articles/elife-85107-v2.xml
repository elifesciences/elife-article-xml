<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.2"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">85107</article-id><article-id pub-id-type="doi">10.7554/eLife.85107</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>On the normative advantages of dopamine and striatal opponency for learning and choice</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-272987"><name><surname>Jaskir</surname><given-names>Alana</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3538-0827</contrib-id><email>alana_jaskir@brown.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-24218"><name><surname>Frank</surname><given-names>Michael J</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-8451-0523</contrib-id><email>Michael_Frank@brown.edu</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05gq02987</institution-id><institution>Department of Cognitive, Linguistic and Psychological Sciences, Carney Institute for Brain Science, Brown University</institution></institution-wrap><addr-line><named-content content-type="city">Providence</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Liljeholm</surname><given-names>Mimi</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Gold</surname><given-names>Joshua I</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00b30xv10</institution-id><institution>University of Pennsylvania</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>22</day><month>03</month><year>2023</year></pub-date><pub-date pub-type="collection"><year>2023</year></pub-date><volume>12</volume><elocation-id>e85107</elocation-id><history><date date-type="received" iso-8601-date="2022-11-22"><day>22</day><month>11</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2023-03-14"><day>14</day><month>03</month><year>2023</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at .</event-desc><date date-type="preprint" iso-8601-date="2022-03-13"><day>13</day><month>03</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.03.10.483879"/></event></pub-history><permissions><copyright-statement>© 2023, Jaskir and Frank</copyright-statement><copyright-year>2023</copyright-year><copyright-holder>Jaskir and Frank</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-85107-v2.pdf"/><self-uri content-type="figures-pdf" xlink:href="elife-85107-figures-v2.pdf"/><abstract><p>The basal ganglia (BG) contribute to reinforcement learning (RL) and decision-making, but unlike artificial RL agents, it relies on complex circuitry and dynamic dopamine modulation of opponent striatal pathways to do so. We develop the OpAL* model to assess the normative advantages of this circuitry. In OpAL*, learning induces opponent pathways to differentially emphasize the history of positive or negative outcomes for each action. Dynamic DA modulation then amplifies the pathway most tuned for the task environment. This efficient coding mechanism avoids a vexing explore–exploit tradeoff that plagues traditional RL models in sparse reward environments. OpAL* exhibits robust advantages over alternative models, particularly in environments with sparse reward and large action spaces. These advantages depend on opponent and nonlinear Hebbian plasticity mechanisms previously thought to be pathological. Finally, OpAL* captures risky choice patterns arising from DA and environmental manipulations across species, suggesting that they result from a normative biological mechanism.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>basal ganglia</kwd><kwd>dopamine</kwd><kwd>reinforcement learning</kwd><kwd>computational model</kwd><kwd>decision-making</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Human</kwd><kwd>Mouse</kwd><kwd>Rat</kwd><kwd>Rhesus macaque</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>P50MH119467</award-id><principal-award-recipient><name><surname>Frank</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id><institution>National Institute of Mental Health</institution></institution-wrap></funding-source><award-id>R01 MH084840</award-id><principal-award-recipient><name><surname>Frank</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>S10OD025181</award-id><principal-award-recipient><name><surname>Frank</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>A computational model of the opponent neural architecture the basal ganglia, in tandem with adaptive dopamine modulation, exhibits robust advantages over traditional learning algorithms and ties together seemingly aberrant behavioral patterns resulting from dopamine and environmental manipulations across species.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Everyday choices involve integrating and comparing the subjective values of alternative actions. Moreover, the degree to which one prioritizes the benefits or costs in forming subjective preferences may vary between and even within individuals. For example, one may typically use food preference to guide their choice of restaurant, but be more likely to minimize costs (e.g., speed, distance, price) when only low-quality options are available (only fast-food restaurants are open). In this article, we evaluate the computational advantages of such context-dependent choice strategies and how they may arise from biological properties within the basal ganglia (BG) and dopamine (DA) system.</p><p>In ecological settings, there are often multiple available actions, and rewards are sparse. In machine learning, this combination is particularly vexing for reinforcement learning (RL) agents due to a difficult exploration/exploitation tradeoff (<xref ref-type="bibr" rid="bib82">Sutton and Barto, 2018</xref>), and approaches to confront this problem typically require prior task-specific knowledge (<xref ref-type="bibr" rid="bib70">Riedmiller et al., 2018</xref>). We set out to study how the architecture of biological RL might additionally circumvent this problem. We find that biological properties within this system – specifically, the presence of opponent striatal pathways, nonlinear Hebbian plasticity, and dynamic changes in dopamine as a function of reward history – confer decision-making advantages relative to canonical RL models lacking these properties. In so doing, this analysis provides a new lens into various findings regarding how learning and decision-making is altered across species as a function of manipulations of (or individual differences within) the BG and DA systems.</p><p>To begin, we focus on bandit learning tasks, where an agent learns to identify and reliably select the option which yields the highest rate of probabilistic reward. We consider how biological properties with the BG allow an agent to effectively explore early (sample options that are currently estimated as unfavorable but are possibly more rewarding), and subsequently better exploit (reliably select the most rewarding action). As we shall see, this entails (1) learning separate ‘actors’ that magnify the relative benefits of alternative options in highly rewarding environments or the relative costs in sparsely rewarding environments and (2) dynamically shifting the contribution of these actors to govern action selection, depending on which is more specialized for the context. We then show how this dynamic biological mechanism can be recruited for risky decision-making, where increased dopamine amplifies the contribution of benefits over costs, leading to riskier choice; lowered dopamine alternatively amplifies the costs over the benefits.</p><p>In neural network models of such circuitry, the cortex ‘proposes’ candidate actions available for consideration, and the BG facilitates those that are most likely to maximize reward and minimize cost (<xref ref-type="bibr" rid="bib24">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib67">Ratcliff and Frank, 2012</xref>; <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>; <xref ref-type="bibr" rid="bib36">Gurney et al., 2015</xref>; <xref ref-type="bibr" rid="bib20">Dunovan and Verstynen, 2016</xref>). These models are based on the BG architecture in which striatal medium spiny neurons (MSNs) are subdivided into two major populations that respond in opponent ways to DA (due to differential expression of D1 and D2 receptors; <xref ref-type="bibr" rid="bib33">Gerfen, 1992</xref>; <xref ref-type="bibr" rid="bib10">Burke et al., 2017</xref>). Phasic DA signals convey reward prediction errors (<xref ref-type="bibr" rid="bib60">Montague et al., 1996</xref>; <xref ref-type="bibr" rid="bib74">Schultz et al., 1997</xref>), amplifying both activity and synaptic learning in D1 neurons, thereby promoting action selection based on reward. Conversely, when DA levels drop, activity is amplified in D2 neurons, promoting learning and choice that minimizes disappointment (<xref ref-type="bibr" rid="bib24">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib43">Iino et al., 2020</xref>). See <xref ref-type="fig" rid="fig1">Figure 1A</xref> for a visual summary of this opponency.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Overview of OpAL* and dynamics of three-factor Hebbian term.</title><p>(<bold>A</bold>) OpAL* architecture. Akin to the original OpAL model (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>), OpAL* is a modified dual actor-critic model where the critic learns action values and generates reward prediction errors (RPEs); the actors use these RPEs to directly learn a policy (i.e., how to behave). For each action, the representation according to one actor (representing the D1 pathway) is strengthened by positive RPEs and weakened by negative RPEs (encoded by dopamine burst and dips, respectively). In contrast, positive RPEs weaken and negative RPEs strengthen the second actor’s action representations (representing the D2 pathway). Uniquely, OpAL* modulates dopamine levels at the time of choice according to a ‘meta-critic,’ which tracks the value or ‘richness’ of the overall environment according to the agent’s reward history agnostic to action history. OpAL* also introduces additional features, such as annealing and normalization, that provide OpAL* with robustness and flexibility but preserve key properties of the OpAL model necessary for capturing empirical data. (<bold>B</bold>) Schematic of OpAL dynamics with three-factor Hebbian term. Nonlinear weight updates due to Hebbian factor lead to increasing discrimination between high reward probability options in the <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> actor and between low reward probability options in the <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> actor. For intermediate dopamine states (<inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> actors are balanced), there is equal sensitivity to differences in reward probability across the range of rich and lean environments. For high dopamine states (<inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), the action policy emphasizes differences in benefits (as represented in the D1/&quot;G&quot; weights), whereas in low dopamine states (<inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>), the action policy emphasizes differences in costs (as represented in the D2/&quot;N&quot; weights). Changes in dopaminergic state (represented by the purple indicators) affect the policy of OpAL due to its nonlinear and opponent dynamics. OpAL* hypothesizes that modulating dopaminergic state by environmental richness is a normative mechanism for flexible weighting of these representations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Dynamics of G/N/Act without three-factor Hebbian dynamics.</title><p>Schematic of OpAL dynamics without three-factor Hebbian term. Removing nonlinear term in OpAL confers redundancy in G/N weights, which are perfectly anticorrelated and thus do not confer an efficient coding advantage and cannot be differentially leveraged to promote specialization.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig1-figsupp1-v2.tif"/></fig></fig-group><p>Empirically, the BG and DA have been strongly implicated in such motivated action selection and RL across species. For example, in perceptual decisions, striatal D1 and D2 neurons combine information about veridical perceptual data with internal preferences based on potential reward, causally influencing choice toward the more rewarding options (<xref ref-type="bibr" rid="bib19">Doi et al., 2020</xref>; <xref ref-type="bibr" rid="bib9">Bolkan et al., 2022</xref>). Further, striatal DA manipulations influence RL (<xref ref-type="bibr" rid="bib95">Yttri and Dudman, 2016</xref>; <xref ref-type="bibr" rid="bib23">Frank et al., 2004</xref>; <xref ref-type="bibr" rid="bib65">Pessiglione et al., 2006</xref>), motivational vigor (<xref ref-type="bibr" rid="bib62">Niv et al., 2007</xref>; <xref ref-type="bibr" rid="bib6">Beeler et al., 2012</xref>; <xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>), cost–benefit decisions about physical effort (<xref ref-type="bibr" rid="bib73">Salamone et al., 2018</xref>), and risky decision-making. Indeed, as striatal DA levels rise, humans and animals are more likely to select riskier options that offer greater potential payout than those with certain but smaller rewards (<xref ref-type="bibr" rid="bib80">St Onge and Floresco, 2009</xref>; <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>), an effect that has been causally linked to striatal D2 receptor-containing subpopulations (<xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>).</p><p>However, for the large part, this literature has focused on the findings <italic>that</italic> DA has opponent effects on D1 and D2 populations and behavioral patterns, and not what the computational advantage of this scheme might be (i.e., <italic>why</italic>). For example, the Opponent Actor Learning (OpAL) model (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>) summarizes the core functionality of the BG neural network models in algorithmic form, capturing a wide variety of findings of DA and D1 vs. D2 manipulations across species (for review, <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>; <xref ref-type="bibr" rid="bib53">Maia and Frank, 2017</xref>). Two distinguishing features of OpAL (and its neural network inspiration), compared to more traditional RL models, are that (1) it relies on opponent D1/D2 actors that separately learn benefits and costs of actions rather than a single expected reward value for each action and (2) learning in such populations is acquired through nonlinear dynamics, mimicking three-factor Hebbian plasticity rules. This nonlinearity causes the two populations to evolve to specialize in discriminating between options of high or low reward value, respectively (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>), as seen in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. It is also needed to explain pathological conditions such as learned Parkinsonism, whereby low DA states induce hyperexcitability in D2 MSNs, driving aberrant plasticity and, in turn, progression of symptoms (<xref ref-type="bibr" rid="bib92">Wiecki et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Beeler et al., 2012</xref>).</p><p>But why would the brain develop this nonlinear opponent mechanism for action selection and learning, and how could (healthy) DA levels be adapted to capitalize on it? A clue to this question lies in the observation that standard (nonbiological) RL models typically perform worse at selecting the optimal action in ‘lean environments’ with sparse rewards than they do in ‘rich environments’ with plentiful rewards (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). This asymmetry results from a difference in exploration/exploitation tradeoffs across such environments. In rich environments, an agent can benefit from overall higher levels of exploitation: once the optimal action is discovered, an agent can stop sampling alternative actions as it is not important to know their precise values. In contrast, in lean environments, choosing the optimal action typically lowers its value (due to sparse rewards), to the point that it can drop below those of even more suboptimal actions. This causes stochastic switching between options until the worst actions are reliably identified and avoided in the long run. Moreover, while in machine learning applications one can simply tune hyperparameters of an RL model to optimize performance for a given environment, biological agents do not have the luxury as they cannot know whether they are in a rich or lean environment in advance and cannot modify hyperparameters accordingly.</p><p>In this article, we investigate the utility of nonlinear BG opponency for adaptive behavior in rich and lean environments. We propose a new model, OpAL*, which dynamically adapts its dopaminergic state online as a function of learned reward history (as observed empirically; <xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">Mohebi et al., 2019</xref>). Specifically, OpAL* dynamically modulates its dopaminergic states in proportion to its estimates of ‘environmental richness,’ leading to high striatal DA motivational states in rich environments and lower DA states in lean environments with sparse rewards. To do so, it relies on a ‘meta-critic’ that evaluates the richness/sparseness of the environment as a whole. Initially, low confidence in the meta-critic leads the agent to rely equally on both actors, with more stochastic choice as they learn to specialize. Thereafter, OpAL*’s opponent and nonlinear representations serve to directly and quickly optimize the model’s policy. In contrast, standard RL models that focus on learning the expected values of actions are slow to converge on the best policy, particularly as the number of alternative actions grows. In this article, we demonstrate that the specialization of D1 and D2 pathways in OpAL* for discriminating between low rewarding and high rewarding options, rather than estimating veridical reward statistics, allows OpAL* to better equate performance in rich and lean environments. This dynamic modulation amplifies the D1 or D2 actor most well suited to discriminate amongst benefits or costs of choice options for the given environment, akin to an ‘efficient coding’ strategy typically studied in the domain of perception (<xref ref-type="bibr" rid="bib4">Barlow, 2012</xref>; <xref ref-type="bibr" rid="bib49">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib13">Chalk et al., 2018</xref>). We compared the performance of OpAL* to alternative BG models and to several alternative models typically used in machine learning (Q-learning and upper confidence bound models, the latter of which includes an explicit mechanism intended to optimize exploration). We find that OpAL*, across a wide range of parameter settings, exhibits robust advantages over these alternatives across a range of environments with varying reward rates and complexity levels. This advantage depends on opponency, nonlinearity, and adaptive DA modulation and is most prominent in lean environments with large action spaces, an ecologically probable environment which requires more adaptive navigation of explore–exploit as outlined above. OpAL* also addresses limitations of the original OpAL model highlighted by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>, while retaining key properties needed to capture a range of empirical data and afford the normative advantages.</p><p>Finally, we apply OpAL* to capture a range of empirical data across species, including how risk preference changes as a function of D2 MSN activity and manipulations that are not explainable by monolithic RL systems even when made sensitive to risk (<xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>). In humans, we show that OpAL* can reproduce patterns in which dopaminergic drug administration selectively increases risky choices for gambles with potential gains (<xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>). Moreover, we show that even in the absence of biological manipulations, OpAL* also accounts for recently described economic choice patterns as a function of environmental richness. In particular, we simulate data showing that when offered the very same safe and risky choice option, humans are more likely to gamble when that offer had been presented in the context of a richer reward distribution (<xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>). Similarly, we show that the normative objective for policy optimization in OpAL*, while in general facilitating adaptive behavior and transitive preferences, can lead to irrational preferences when options appear in novel contexts differing in reward richness of initial learning, as observed empirically (<xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>). Taken together, our simulations provide a clue as to the normative function of the biology of RL which differs from that assumed by standard models and gives rise to variations in risky decision-making.</p><sec id="s1-1"><title>OpAL overview</title><p>Before introducing OpAL*, we first provide an overview of the original OpAL model (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>), an algorithmic model of the BG whose dynamics mimic the differential effects of dopamine in the D1/D2 pathways described above. OpAL is a modified ‘actor-critic’ architecture (<xref ref-type="bibr" rid="bib82">Sutton and Barto, 2018</xref>). In the standard actor-critic, the critic learns the expected value of an action from rewards and punishments and reinforces the actor to select those actions that maximize rewards. Specifically, after selecting an action (<inline-formula><mml:math id="inf7"><mml:mi>a</mml:mi></mml:math></inline-formula>), the agent experiences a reward prediction error (<inline-formula><mml:math id="inf8"><mml:mi>δ</mml:mi></mml:math></inline-formula>) signaling the difference between the reward received (<inline-formula><mml:math id="inf9"><mml:mi>R</mml:mi></mml:math></inline-formula>) and the critic’s learned expected value of the action (<inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) at time <inline-formula><mml:math id="inf11"><mml:mi>t</mml:mi></mml:math></inline-formula>:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf12"><mml:msub><mml:mi>α</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula> is the critic learning rate. The prediction error generated by the critic is then also used to train the actors. OpAL is distinguished from a standard actor-critic in two critical ways, motivated by the biology summarized above. First, it has two separate opponent actors: one promoting selection (‘Go’) of an action <inline-formula><mml:math id="inf13"><mml:mi>a</mml:mi></mml:math></inline-formula> in proportion to its relative benefit over alternatives, and the other suppressing selection of that action (‘No Go’) in proportion to its relative cost (or disappointment). (See Supplemental note 1 in Appendix 2). Second, the update rule in each of these actors contains a <italic>three-factor Hebbian rule</italic> such that weight updating is proportional not only to learning rates and RPEs (as in standard RL) but is also scaled by <inline-formula><mml:math id="inf14"><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf15"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> themselves. In particular, positive RPEs conveyed by phasic DA bursts strengthen the <inline-formula><mml:math id="inf16"><mml:mi>G</mml:mi></mml:math></inline-formula> (D1) actor and weaken the <inline-formula><mml:math id="inf17"><mml:mi>N</mml:mi></mml:math></inline-formula> (D2) actor, whereas negative RPEs weaken the D1 actor and strengthen the D2 actor.<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf18"><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf19"><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> are learning rates controlling the degree to which D1 and D2 neurons adjust their synaptic weights with each RPE. We will refer to these <inline-formula><mml:math id="inf20"><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf21"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> terms that multiply the RPE in the update as the ‘Hebbian term’ because weight changes grow with activity in the corresponding <inline-formula><mml:math id="inf22"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf23"><mml:mi>N</mml:mi></mml:math></inline-formula> units. As such, the <inline-formula><mml:math id="inf24"><mml:mi>G</mml:mi></mml:math></inline-formula> weights grow to represent the benefits of candidate actions (those that yield positive RPEs more often, thereby making them yet more eligible for learning), whereas the <inline-formula><mml:math id="inf25"><mml:mi>N</mml:mi></mml:math></inline-formula> weights grow to represent the costs or likelihood of disappointment (those that yield negative RPEs more often).</p><p>The resulting nonlinear dynamics capture biological plasticity rules in neural networks, where learning depends on dopamine (<inline-formula><mml:math id="inf26"><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>), presynaptic activation in the cortex (the proposed action <inline-formula><mml:math id="inf27"><mml:mi>a</mml:mi></mml:math></inline-formula> is selectively updated), and postsynaptic activation in the striatum (<inline-formula><mml:math id="inf28"><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> or <inline-formula><mml:math id="inf29"><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>) (<xref ref-type="bibr" rid="bib24">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib92">Wiecki et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Beeler et al., 2012</xref>; <xref ref-type="bibr" rid="bib36">Gurney et al., 2015</xref>; <xref ref-type="bibr" rid="bib29">Frémaux and Gerstner, 2015</xref>; <xref ref-type="bibr" rid="bib68">Reynolds and Wickens, 2002</xref>). Incorporation of this Hebbian term prevents redundancy in the D1 vs. D2 actors and confers additional flexibility, as described in the next section. It is also necessary for capturing a variety of behavioral data, including those associated with pathological aberrant learning in DA-elevated and depleted states, whereby heightened striatal activity in either pathway amplifies learning that escalates over experience (<xref ref-type="bibr" rid="bib92">Wiecki et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Beeler et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). As we shall see in the ‘Mechanism’ section below, this same property allows actors to better represent the probabilistic history of outcomes at the low and high ranges.</p><p>For action selection (decision-making), OpAL combines together <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> into a single action value, <inline-formula><mml:math id="inf32"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, but where the contributions of each opponent actor are weighted by corresponding gains <inline-formula><mml:math id="inf33"><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf34"><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>.<disp-formula id="equ5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf35"><mml:mi>ρ</mml:mi></mml:math></inline-formula> reflects the <italic>dopaminergic state</italic> controlling the relative weighting of <inline-formula><mml:math id="inf36"><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf37"><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="inf38"><mml:mi>β</mml:mi></mml:math></inline-formula> is the overall softmax temperature. Higher <inline-formula><mml:math id="inf39"><mml:mi>β</mml:mi></mml:math></inline-formula> values correspond to higher exploitation, while <inline-formula><mml:math id="inf40"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> would generate random choice independent of learned values. When <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the dopaminergic state is ‘balanced’ and the two actors <inline-formula><mml:math id="inf42"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf43"><mml:mi>N</mml:mi></mml:math></inline-formula> (and hence, learned benefits and costs) are equally weighted during choice. If <inline-formula><mml:math id="inf44"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, benefits are weighted more than costs, and vice versa if <inline-formula><mml:math id="inf45"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. While the original OpAL model assumed a fixed, static <inline-formula><mml:math id="inf46"><mml:mi>ρ</mml:mi></mml:math></inline-formula> per simulated agent to capture individual differences or pharmacological manipulations, below we augmented it to include the contributions of dynamic changes in dopaminergic state, so that <inline-formula><mml:math id="inf47"><mml:mi>ρ</mml:mi></mml:math></inline-formula> can evolve over the course of learning to optimize choice.</p><p>The actor then selects actions based on their relative action propensities, using a softmax decision rule, such that the agent selects those actions that yield the most frequent positive RPEs:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>c</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s1-2"><title>Nonlinear OpAL dynamics support amplification of action-value differences</title><p>After learning, <inline-formula><mml:math id="inf48"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf49"><mml:mi>N</mml:mi></mml:math></inline-formula> weights correlate positively and negatively with expected reward, with appropriate ordinal rankings of each action preserved in the combined action value <inline-formula><mml:math id="inf50"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). However, with extensive learning (particularly after the critic converges), the Hebbian term induces instability and decay in the G and N representations, such that they eventually converge to zero (<xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>). OpAL* addresses this issue by adjusting learning rates as a function of uncertainty, stabilizing learned actor weights while also preserving their ability to flexibly adapt to change points, and by normalizing the prediction error. See ‘Normalization and annealing’ in the next section for a full discussion. These adjustments enable us to preserve the Hebbian contribution, which was previously found to be a necessary component for capturing a range of empirical data (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). Importantly for these findings and for the findings in this article, the Hebbian term produces nonlinear dynamics in the two actors such that they are not redundant and instead specialize in discriminating between different reward probability ranges (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). While the <inline-formula><mml:math id="inf51"><mml:mi>G</mml:mi></mml:math></inline-formula> actor shows greater discrimination among frequently rewarded actions, the <inline-formula><mml:math id="inf52"><mml:mi>N</mml:mi></mml:math></inline-formula> actor learns greater sensitivity among actions with sparse reward. Note that if <inline-formula><mml:math id="inf53"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:mi>N</mml:mi></mml:math></inline-formula> actors are weighted equally in the choice function (<inline-formula><mml:math id="inf55"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), the resultant choice preference is invariant to translations across levels of reward, exhibiting identical discrimination between a 90 and 80% option as it would between a 80% and 70% option. This ‘balanced’ OpAL model therefore effectively reduces to a standard nonopponent actor-critic RL model, but as such fails to capitalize on the underlying specialization of the actors (<inline-formula><mml:math id="inf56"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf57"><mml:mi>N</mml:mi></mml:math></inline-formula>) in ongoing learning. We considered the possibility that such specialization could be leveraged dynamically to amplify a given actor’s contribution when it is most sensitive, akin to an ‘efficient coding’ strategy applied to decision-making (<xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>).</p></sec><sec id="s1-3"><title>OpAL*</title><p>Given the differential specialization of <inline-formula><mml:math id="inf58"><mml:mi>G</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf59"><mml:mi>N</mml:mi></mml:math></inline-formula> actors, we considered whether the agent’s online estimation of environmental richness (reward rate) could be used to control dopaminergic states (as seen empirically; <xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">Mohebi et al., 2019</xref>). Due to its opponent effects on D1 vs. D2 populations, such a mechanism would differentially and adaptively weight <inline-formula><mml:math id="inf60"><mml:mi>G</mml:mi></mml:math></inline-formula> vs. <inline-formula><mml:math id="inf61"><mml:mi>N</mml:mi></mml:math></inline-formula> actor contributions to the choice policy. To formalize this hypothesis, we constructed OpAL*, which uses an online estimation of environment richness to dynamically amplify the contribution of the actor theoretically best specialized for the environment type.</p><p>To provide a robust estimate of reward probability in a given environment, OpAL* uses a ‘meta-critic,’ so-named because it evaluates the reward value of the environment as a whole given the agent’s overall choice history (i.e., policy to that point), rather than that of any particular state or action. The meta-critic summarizes the contributions of various inputs that may regulate the DA system, including those from cortical sources such as orbitofrontal cortex and anterior cingulate, regions which have access to not only the mean reward values but also their confidence (<xref ref-type="bibr" rid="bib46">Kepecs et al., 2008</xref>). Notably, these regions also project to striatal cholinergic cells conveying information about environmental state (<xref ref-type="bibr" rid="bib79">Stalnaker et al., 2016</xref>). These cholinergic cells in turn locally regulate striatal DA release (<xref ref-type="bibr" rid="bib1">Adrover et al., 2020</xref>; <xref ref-type="bibr" rid="bib84">Threlfell et al., 2012</xref>; <xref ref-type="bibr" rid="bib69">Reynolds et al., 2022</xref>) in proportion to reward history (<xref ref-type="bibr" rid="bib58">Mohebi et al., 2019</xref>), and may be sensitive to uncertainty (<xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>). As such, the meta-critic is represented as a beta distribution to estimate <inline-formula><mml:math id="inf62"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for the environment as a whole (i.e., over all states and actions) or ‘context value.’ This distribution can be updated by keeping a running count of the outcomes (e.g., rewards and omissions) on each trial and adding them to the hyperparameters <inline-formula><mml:math id="inf63"><mml:mi>η</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf64"><mml:mi>γ</mml:mi></mml:math></inline-formula>, respectively.<disp-formula id="equ9"><label>(9)</label><mml:math id="m9"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>η</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>η</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ10"><label>(10)</label><mml:math id="m10"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>c</mml:mi></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ11"><label>(11)</label><mml:math id="m11"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>X</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>Beta</mml:mtext><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>η</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>γ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ12"><label>(12)</label><mml:math id="m12"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>The dopaminergic state <inline-formula><mml:math id="inf65"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is then increased when <inline-formula><mml:math id="inf66"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<italic>rich environment</italic>), and decreased when <inline-formula><mml:math id="inf67"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> (<italic>lean environment</italic>). To ensure that dopaminergic states accurately reflect environmental richness, we apply a conservative rule to modulate <inline-formula><mml:math id="inf68"><mml:mi>ρ</mml:mi></mml:math></inline-formula> only when the meta-critic is sufficiently ‘confident’ that the reward rates are above or below 0.5, that is, we take into account not only the mean but also the variance of the beta distribution, parameterized by <inline-formula><mml:math id="inf69"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ13">Equation 13</xref>; for simplicity, we used  <inline-formula><mml:math id="inf70"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> = 1.0 for all simulations). This process is akin to performing inference over the most likely environmental state to guide DA. (See Supplemental note 2 in Appendix 2). Lastly, a constant <inline-formula><mml:math id="inf71"><mml:mi>k</mml:mi></mml:math></inline-formula> controls the strength of the modulation (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref>)<disp-formula id="equ13"><label>(13)</label><mml:math id="m13"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>S</mml:mi></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>ϕ</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ14"><label>(14)</label><mml:math id="m14"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>.5</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mrow><mml:mo rspace="22.5pt">,</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>To illustrate the necessity of nonlinearity for dopamine modulation to be impactful, we plotted how <inline-formula><mml:math id="inf72"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> values change as a function of reward probability and for different DA levels (represented as different colors, <xref ref-type="fig" rid="fig2">Figure 2</xref>). While <inline-formula><mml:math id="inf73"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> values increase monotonically with reward probability, the convexity in the underlying <inline-formula><mml:math id="inf74"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mi>N</mml:mi></mml:math></inline-formula> weights (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) gives rise to stronger <inline-formula><mml:math id="inf76"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> discrimination between more rewarding options (e.g., 80% vs. 70%) with higher dopamine levels. Conversely, <inline-formula><mml:math id="inf77"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> discrimination between less rewarding options (e.g., 30% vs. 20%) is enhanced with lower dopamine levels. Thus, high DA amplifies the G actor’s contributions to choice, increasing the action gap for high-probability options. Conversely, low DA amplifies the N actor’s contributions, increasing the action gap for low-probability options. As the Bayesian meta-critic converges on an estimate of environmental richness, OpAL* can adapt its policy to dynamically emphasize the most discriminative actor and appropriately enhance the ‘action gap’ – <italic>Act</italic> difference between optimal and second best option – to optimize the policy (<xref ref-type="fig" rid="fig2">Figure 2</xref>, left). In contrast, a variant which lacks nonlinearity (No Hebb) induces redundancy in the <inline-formula><mml:math id="inf78"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf79"><mml:mi>N</mml:mi></mml:math></inline-formula> weights and thus essentially reduces to a standard actor-critic agent. As such, dopamine modulation does not change its discrimination performance across environments and the action gap for choice remains fixed (<xref ref-type="fig" rid="fig2">Figure 2</xref>, right; <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>OpAL* capitalizes on convexity of actor weights induced by nonlinearity, allowing adaptation to different environments.</title><p><inline-formula><mml:math id="inf80"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> values are generated by presenting each model with a bandit using a fixed reward probability for 100 trials; curves are averaged over 5000 simulations. Left: nonlinearity in OpAL* update rule induces convexity in <inline-formula><mml:math id="inf81"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> values as a function of reward probability (due to stronger contributions of <inline-formula><mml:math id="inf82"><mml:mi>G</mml:mi></mml:math></inline-formula> weights with higher rewards, and stronger contributions of <inline-formula><mml:math id="inf83"><mml:mi>N</mml:mi></mml:math></inline-formula> weights with sparse reward). OpAL* dynamically adjusts its dopaminergic state over the course of learning as a function of its estimate of environmental richness (indicated by elongated, purple bars), allowing it to traverse different Act curves (high dopamine [DA] in green emphasizes the <inline-formula><mml:math id="inf84"><mml:mi>G</mml:mi></mml:math></inline-formula> actor, low DA in orange emphasizes the <inline-formula><mml:math id="inf85"><mml:mi>N</mml:mi></mml:math></inline-formula> actor). (Note that the agent’s meta-critic first needs to be confident in its estimate of reward richness of the environment during in initial exploration for it to adjust DA to appropriately exploit convexity.) Thereafter, OpAL* can differentially leverage convexity in <inline-formula><mml:math id="inf86"><mml:mi>G</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf87"><mml:mi>N</mml:mi></mml:math></inline-formula> weights, outperforming a ‘balanced’ OpAL+ model (in yellow), which equally weighs the two actors (due to static DA). Vertical bars show discrimination (i.e., action gap) between 80% and 70% actions is enhanced with high DA state, whereas discrimination between 20% and 30% actions is amplified for low DA. Right: due to redundancy in the No Hebb representations, policies are largely invariant to dopaminergic modulation during the course of learning.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig2-v2.tif"/></fig><sec id="s1-3-1"><title>Choice</title><p>To accommodate varying levels of <inline-formula><mml:math id="inf88"><mml:mi>k</mml:mi></mml:math></inline-formula> and maintain biological plausibility, the contribution of each actor is lower-bounded by zero – that is, <inline-formula><mml:math id="inf89"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf90"><mml:mi>N</mml:mi></mml:math></inline-formula> actors can be suppressed but cannot be inverted (firing rates cannot go below zero), while still allowing graded amplification of the other subpopulation.<disp-formula id="equ15"><label>(15)</label><mml:math id="m15"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ16"><label>(16)</label><mml:math id="m16"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ17"><label>(17)</label><mml:math id="m17"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p></sec><sec id="s1-3-2"><title>Normalization and annealing</title><p>The original three-factor Hebbian rule presented in <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref> approximates the learning dynamics in the neural circuit models needed to capture the associated data and also confers flexibility as described above. However, it is also susceptible to instabilities, as highlighted by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>. Specifically, because weight updating scales with the <inline-formula><mml:math id="inf91"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf92"><mml:mi>N</mml:mi></mml:math></inline-formula> values themselves, large reward magnitudes or oscillating prediction errors (due to critic convergence) can cause the weights to decay rapidly toward 0 (see Appendix 1 section ‘Addressing’; <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>). To address this issue, OpAL* introduces two additional modifications based on both functional and biological considerations. First, we apply a transformation to the actor prediction errors such that they are normalized by the range of available reward values (see <xref ref-type="bibr" rid="bib85">Tobler et al., 2005</xref> for evidence of such normalization in dopaminergic signals and <xref ref-type="bibr" rid="bib5">Bavard et al., 2018</xref> for evidence that humans use such range adaptation). Secondly, as is common in machine learning (<xref ref-type="bibr" rid="bib17">Darken and Moody, 1990</xref>; <xref ref-type="bibr" rid="bib7">Bengio, 2012</xref>), the actor learning rate is annealed with experience. Rather than simply decreasing the learning rate with time (which would make the agent insensitive to subsequent volatility in task conditions), we instead anneal actor learning rates as a function of uncertainty within the OpAL* Bayesian meta-critic. (See Supplemental note 3 in Appendix 2). As the variance decreases, the agent is more certain about the environmental statistics, and the actor learning rate declines to stabilize learning (again see <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref> for mechanisms of such uncertainty-based actor learning modulation).<disp-formula id="equ18"><label>(18)</label><mml:math id="m18"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ19"><label>(19)</label><mml:math id="m19"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ20"><label>(20)</label><mml:math id="m20"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>T</mml:mi><mml:mo>∗</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ21"><label>(21)</label><mml:math id="m21"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where X refers to the beta distribution of the meta-critic (<xref ref-type="disp-formula" rid="equ11">Equation 11</xref>) at time <inline-formula><mml:math id="inf93"><mml:mi>t</mml:mi></mml:math></inline-formula>, and T is a hyper-parameter scaling the degree of annealing linearly with the variance of the meta-critic (greater T values indicate more certainty needed for annealing). The reward prediction error <inline-formula><mml:math id="inf94"><mml:mi>δ</mml:mi></mml:math></inline-formula> is produced by a standard critic (<xref ref-type="disp-formula" rid="equ1 equ2">Equations 1 and 2)</xref>. The critic learning rate (<inline-formula><mml:math id="inf95"><mml:msub><mml:mi>α</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></inline-formula>) is constant across trials.</p><p>This mechanism preserves the agent’s ability to remain flexible to potential switch points in reward contingencies (see <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>). These modifications improve robustness of OpAL* and ensure that the actor weights are better behaved (avoiding convergence to zero and maintaining ordinal rankings in the resulting Act values for 1000 trials; <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>), while still preserving the Hebbian mechanism that induces convexity in the weights (which, as shown below, are needed for its normative advantages). Of course, the stability–flexibility tradeoff remains, and the level of annealing could be further optimized dynamically, as shown specifically within OpAL (<xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>) and more broadly in the literature (<xref ref-type="bibr" rid="bib61">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Iglesias et al., 2013</xref>). This stability–flexibility tradeoff is particularly apparent in drifting reward environments (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>), but optimization for this tradeoff is largely orthogonal to the focus of the present work. For further discussion and exploration, please see Appendix 1 (‘Addressing’; <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>) and <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>.</p></sec></sec></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Robust advantages of adaptively modulated dopamine states</title><p>The main claim of this article is that endogenous changes in dopamine levels can leverage specialization afforded by opponent pathways under Hebbian plasticity, and accordingly optimize performance when environmental statistics are unknown. In this section, we therefore characterize the robustness of OpAL* advantages across a large range of parameter settings relative to variants omitting DA modulation (OpAL+) or the Hebbian term (No Hebb). We then explore how such advantages scale with complexity in environments with increasing number of choice alternatives.</p><p>To specifically assess the benefit of adaptive dopaminergic state modulation, we compared OpAL* to two control models to establish the utility of the adaptive dopamine modulation (which was not a feature of the original OpAL model) and to test its dependence on nonlinear Hebbian updates. More specifically, the OpAL+ model equally weights benefits and costs throughout learning (‘<inline-formula><mml:math id="inf96"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>’); as such, any OpAL* improvement would indicate an advantage for dynamic dopaminergic modulation. (See Supplemental note 4 in Apprendix 2). The No Hebb model reinstates the dynamic dopaminergic modulation but omits the Hebbian term in the three-factor learning rule (<xref ref-type="disp-formula" rid="equ16 equ17">Equations 16 and 17</xref>). This model therefore serves as a test as to whether any OpAL* improvements depend on the underlying nonlinear actor weights produced by the three-factor Hebbian rule. The No Hebb model also serves to compare OpAL* to more standard actor-critic RL models; removing the Hebbian term renders each actor redundant, effectively yielding a single-actor model (see the section ‘OpAL*’ for more details). Improvement of OpAL* relative to the No Hebb model would therefore suggest an advantage of OpAL* over standard actor-critic models (we also test OpAL* against a standard Q-learner later in this article). Importantly, models were equated for computational complexity, with modulation hyperparameters (<inline-formula><mml:math id="inf97"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf98"><mml:mi>k</mml:mi></mml:math></inline-formula>) of dynamic DA models (OpAL* and No Hebb) held constant, and were compared using the same random seeds to best equate performance (see ‘Materials and methods’).</p><p>Following an initial comparison in the simplest two choice learning situation, we tested whether OpAL* advantages may be further amplified in more complex environments with multiple choice alternatives. We introduced additional complexity into the task by adding varying numbers of alternative suboptimal actions (e.g., an environment with four actions with probability of reward 80, 70, 70, and 70%). Results were similar for average learning curves and average reward curves; we focus on average learning curves as they are a more refined, asymptotically sound measure of normative behavior.</p><p>For each parameter setting for each model type, we calculated the average softmax probability of selecting the best option (80% in rich environments or 30% in lean environments) across 1000 simulations for 1000 trials. We then took the area under the curve (AUC) of this averaged learning curve for different time horizons (100, 250, 500, and 1000 trials). To statistically investigate where OpAL* (three-factor Hebbian learning and dopaminergic modulation) was most advantageous, we performed one-sample <italic>t</italic>-tests where the null was zero on the difference between the AUC of OpAL* and each control model for every parameter combination over several time horizons (100, 250, 500, and 1000 trials). OpAL* outperformed its OpAL+ (<inline-formula><mml:math id="inf99"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) control and the non-Hebbian version across all time horizons (<inline-formula><mml:math id="inf100"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.0</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mn>13</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), except in the lean environment for 1000 trials when compared to the No Hebb model (no significant difference).</p><p>We can visualize these statistics plotted according to the AUC of the control model as well as the frequency of the AUC differences (<xref ref-type="fig" rid="fig3">Figure 3</xref>). Across parameter settings, OpAL* robustly outperforms comparison models in both environment types. Interestingly, OpAL* advantages in the lean environment over the OpAL+ model show an inverted-U relationship, whereby improvements are most prominent for mid-performing parameter combinations. These lean data also contain distinct sweeps and clustering, which relate to the learning rates of both the critic and the actor (see <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref> for corresponding figures colored according to parameter values). Notably, the most prominent advantages of OpAL* relative to the No Hebb model occur in the lean environment, where the large majority of parameter combinations show advantages (peaks in AUC differences in the positive range). As explored in detail in the ‘Mechanism’ section below, the lean environment requires sophisticated explore–exploit tradeoffs that challenge standard RL models; the Hebbian term of OpAL* induces distortions in the N weights to quickly and preferentially avoid the most suboptimal actions. Moreover, dynamic DA modulation provides additional performance advantages (as evidenced by OpAL*’s performance over OpAL+), by exploiting the actor most suited for the environment, but relies on the Hebbian term to do so (as evident by OpAL*’s performance over No Hebb).</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Parameter-level comparison of OpAL* to OpAL+ and OpAL* to the No Hebb model across a range of plausible parameters.</title><p>Results of two-armed bandit environments – rich (80% vs. 70%) or lean (30% vs. 20%) – for 250 trials. Advantages over the OpAL+ model indicate the need for dynamic dopamine (DA) modulation. Advantages over the No Hebb model indicate the need for the nonlinear three-factor Hebbian rule (found in <xref ref-type="disp-formula" rid="equ18 equ19">Equations 18 and 19)</xref>. Together, advantages over both control models also indicate the need for opponency, particularly given redundancy in G and N weights in the No Hebb model. See ‘Parameter grid search’ for more details. (<bold>A</bold>) OpAL* improves upon a control model which lacks dynamic modulation (OpAL+, <inline-formula><mml:math id="inf101"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula>), with largest improvement for moderately performing parameters. Left: each point represents a single-parameter combination and its difference in learning curve areas under the curve (AUCs) in OpAL* compared to the OpAL+ model. Center: average learning curves of the parameter setting which demonstrates the best improvement of OpAL* over the OpAL+ model (indicated by the red dot) and the parameter setting with the best OpAL+ model performance (indicated by the blue dot). Error bars reflect standard error of the mean over 1000 simulations. Right: histogram of the difference in average learning curve AUCs of the two models with equated parameters. (<bold>B</bold>) Dynamic A modulation is insufficient to induce performance advantage without three-factor Hebbian learning (No Hebb). Comparison descriptions analogous to the above.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Dopamine (DA) contribution colored by parameter values, low complexity.</title><p>DA contributions (OpAL*) relative to absence of dynamic dopamine modulation (OpAL+) in a low complexity (two options), colored by parameter values.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig3-figsupp1-v2.tif"/></fig></fig-group><p>Overall, these results show an advantage for dynamic dopaminergic states as formulated in OpAL* when reward statistics of the environment are unknown. Moreover, note that these improvements over balanced (<inline-formula><mml:math id="inf102"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) OpAL+ provide a lower bound estimate on the advantages of adaptive modulation, given that using any other fixed <inline-formula><mml:math id="inf103"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> would perform worse across environments (see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). This advantage is particularly prominent in the lean (sparse reward) environment, which is computationally more challenging and ecologically more realistic than the rich environment, as we will discuss in the ‘Mechanism’ section. Crucially, dynamic dopaminergic state leverages the full potential of opponency <italic>only</italic> when combined with three-factor Hebbian learning rules, as demonstrated by OpAL*’s advantage over the No Hebb model.</p></sec><sec id="s2-2"><title>OpAL* advantages in sparse reward environments grow with complexity of action space</title><p>We next explored the advantages of dopamine modulation and Hebbian plasticity in progressively more complex environments by increasing the number of available choice alternatives, across several time horizons (100, 250, 500, and 1000 trials). Each complexity level introduced an additional suboptimal action to the rich or lean environment. For example, a complexity level of 4 for the lean environment consisted of four options: a higher rewarding option (30% probability of reward) and three equivalent lower rewarding options (20% probability of reward each).</p><p>OpAL* outperformed the OpAL+ model (differences in AUCs, <inline-formula><mml:math id="inf104"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>2.0</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mn>23</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) across all time horizons and complexity levels. OpAL* also outperformed the non-Hebbian version (<inline-formula><mml:math id="inf105"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1.0</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mn>13</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), except for the lowest complexity lean environments after 1000 trials (<inline-formula><mml:math id="inf106"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; OpAL* advantages were still significant for shorter time horizons).</p><p>We can again visualize these results as the AUC differences between matched parameters (<xref ref-type="fig" rid="fig4">Figure 4</xref>). We visualize the highest complexity here for simplicity. As in the two-option results, the benefits of OpAL* are most evident in the lean environment, particularly relative to the No Hebb model. OpAL* shows better performance across a range of parameters than control models. Notably, the OpAL* and OpAL+ models achieve roughly equivalent performance in rich and lean environments in this parameter range. As noted in the introduction, standard RL models typically suffer in lean environments due to greater demands on exploration (see below for comparisons to more traditional RL models); these simulations show that OpAL* and OpAL+ overcome this robustness limitation that the No Hebb model does not (maximum AUC around 80 for lean and 150 for rich), but OpAL*’s DA modulation contributes above and beyond the flexibility endowed by the opponent and nonlinearity of OpAL+. Again, in lean environments, OpAL* improvements over the OpAL+ model were most evident for mid- and low-performing parameter sets (upside-down bowl trend in the scatter plot). See <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref> for DA contributions according to parameter values.</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Parameter-level comparison of OpAL* to control models in high complexity.</title><p>OpAL* robustly outperforms control models in high-complexity environments, with lean environments showing the greatest advantage. Models completed a six-armed bandit task (with only one optimal action) for 250 trials. See ‘Parameter grid search’ for detailed analysis methods.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Dopamine (DA) contribution colored by parameter values, high complexity.</title><p>DA contributions (OpAL*) relative to absence of dynamic dopamine modulation (OpAL+) in a high complexity (six options), colored by parameter values.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig4-figsupp1-v2.tif"/></fig></fig-group><p>Finally, to specifically assess the advantage of dynamic dopamine modulation, we quantified the OpAL* improvement over the balanced OpAL+ model as a function of complexity levels. Notably, OpAL*’s advantages grow monotonically with complexity, roughly doubling from low- to high-complexity levels in lean environments (<xref ref-type="fig" rid="fig5">Figure 5</xref>). Relative to the OpAL+ model, OpAL* adaptively modulated its choice policy to increase dopamine levels (<inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) in rich environments, but to decrease dopamine levels (<inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>) in lean environments (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Indeed, performance advantages are especially apparent in reward lean environments, providing a computational advantage for low dopamine levels that can accentuate differences between sparsely rewarded options. We see similar trends when comparing to the No Hebb model, with the performance advantage of OpAL* tripling from low to high complexity and the need for Hebbian dynamics most evident in the lean environment.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Advantage of dynamic dopaminergic modulation of OpAL* grows with complexity.</title><p>Complexity corresponds to the number of bandits available in the environment (e.g., a two-armed bandit, which data point corresponds to <xref ref-type="fig" rid="fig3">Figure 3</xref>, or a six-armed bandit, which data point corresponds to <xref ref-type="fig" rid="fig4">Figure 4</xref>). Values reported are the average percentage increase of OpAL* learning curve area under the curve (AUC) compared to a OpAL+ model (top row) or No Hebb model (bottom tow) with equated parameters. That is, we computed the difference in AUC of OpAL* and OpAL+/No Hebb model learning curves for a fixed parameter normalized by the AUC of the balanced OpAL model. We then averaged this percentage increase over all parameters in the grid search. Results are shown for 250 trials of learning. Error bars reflect standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig5-v2.tif"/></fig></sec><sec id="s2-3"><title>OpAL* robustly and optimally outperforms benchmark models</title><p>In the previous section, we demonstrated that the combination of OpAL*’s components (opponency, nonlinearity, and dynamic dopamine modulation) confers adaptive flexibility especially when an agent does not know the statistics of a novel environment. However, these advantages were all shown within the context of an actor-critic model of BG circuitry. In this section, we sought to evaluate whether OpAL* exhibits similar advantages compared to standard alternatives in the reinforcement literature. We include Q-learning (<xref ref-type="bibr" rid="bib89">Watkins and Dayan, 1992</xref>) as it is arguably the most commonly used learning algorithm in both machine learning and biological RL (<xref ref-type="bibr" rid="bib82">Sutton and Barto, 2018</xref>; <xref ref-type="bibr" rid="bib52">Li, 2018</xref>; <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>; <xref ref-type="bibr" rid="bib65">Pessiglione et al., 2006</xref>; <xref ref-type="bibr" rid="bib26">Frank et al., 2007a</xref>; <xref ref-type="bibr" rid="bib63">Niv et al., 2012</xref>). As demonstrated in <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>, a standard Q-learner shows lowered performance in lean environments compared to rich environments due to different exploration/exploitation requirements (even when its parameters are optimized jointly across both environments). We thus consider the Upper Confidence Bound (UCB) algorithm, a more strategic approach to managing the exploration/exploitation tradeoff, which is also used in both machine learning and biological RL (<xref ref-type="bibr" rid="bib34">Gershman, 2018</xref>). The UCB algorithm provides a means for ‘directed exploration’ to options that have not been well-explored and hence the agent is unconfident about its values (see ‘Materials and methods’). UCB further presents a particularly challenging benchmark because it has access to the sample mean of experienced rewards for each option (i.e., it is an ideal observer), whereas RL models and OpAL only have direct access to the most recent RPEs for weight updates. In addition to serving as informative benchmarks, these models both lack the opponent characteristic of OpAL* (G and N); that is, they only learn a single decision value for each possible choice. We reasoned that OpAL* might outperform these established models: while they are guaranteed to converge to expected Q values for each option, such convergence requires repeated sampling of each alternative action, impeding the ability to maximize returns in the interim. Indeed, this limitation of RL algorithms based on action values is well known in machine learning, leading to the greater reliance on policy gradient methods in recent years. We explore these issues in more detail in the ‘Mechanism’ section below, showing that these issues are particularly pernicious in lean environments that are associated with reduced ‘action gaps’ in Q-learning agents, as well as in alternative BG opponency models that are based on value functions (<xref ref-type="bibr" rid="bib55">Mikhael and Bogacz, 2016</xref>; <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>).</p><p>We compared UCB and Q-learning across a large range of parameter settings with that of OpAL*, as we did when comparing OpAL* to OpAL+ and No Hebb. For both the two-choice paradigm (80%/70% or 30%/20%) and six-choice paradigm (80%/70% × 5 or 30%/20% × 5), we conducted a grid search over the parameter space of each model and for each parameter combination calculated an average learning curve (as in <xref ref-type="fig" rid="fig6">Figure 6A</xref>). To ensure that the range of parameters was adequate for the comparison models, we verified that the optimal performing parameter set did not include the boundaries of the grid search, and we also found similar advantages when we only included parameters that were in the top 10% of performance in any given environment or complexity level (not shown). For each parameter combination, we calculated the AUC of the learning curves and then plotted histograms of these AUCs across all parameter sets (<xref ref-type="fig" rid="fig6">Figure 6B</xref>). We found overall the peak and range of the histogram of OpAL* AUCs to be shifted rightward, with particularly notable advantages in lean environments and those with higher complexity.</p><fig-group><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>OpAL* demonstrates flexible performance across environments and complexities compared to standard-RL models, Q-learning and Upper Confidence Bound (UCB).</title><p>UCB is specifically designed for improving explore–exploit tradeoffs like those prevalent in reward lean environments (see ‘Mechanism’ section below). While UCB demonstrates improved performance relative to Q-learning in lean environments, OpAL* outperforms both models robustly over all parameters, included the optimized set for each agent. (<bold>A</bold>) Biological OpAL* mechanisms outperform optimized control models across environments and complexity levels, shown here in a reward rich environment (80% vs. 70% two-armed bandit) and a lean, sparse reward environment (30% vs. 20% six-armed bandit). OpAL* outperforms a standard Q-learning and UCB in the computationally easiest scenario – reward rich environment with only two options – and, more prominently, in the computationally most difficult scenario – reward lean environment with six total options. Notably, OpAL* sustains its advantages in the difficult scenario which requires more exploration, even after extended learning (<xref ref-type="fig" rid="fig6s1">Figure 6—figure supplement 1</xref>). Curves averaged over 1000 simulations, error bars are SEM. Parameters correspond to the optimal performance for each environment according to a grid search, corresponding to the right tail of the histograms in (<bold>B</bold>). (<bold>B</bold>) Biological mechanisms incorporated in OpAL* support robust advantages over standard reinforcement learning models across parameter settings in a reward rich environment (80% vs. 70% two-armed bandit left, six-armed bandit right) and a lean, sparse reward environment (30% vs. 20% two-armed bandit left, six-armed bandit right). Average learning curves were produced for each parameter setting in a grid search over 1000 simulations for 250 trials, and the area under the curve (AUC) was calculated for each parameter. The AUCs of all parameters for a model are shown normalized to account for different sized parameter spaces across models.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig6-v2.tif"/></fig><fig id="fig6s1" position="float" specific-use="child-fig"><label>Figure 6—figure supplement 1.</label><caption><title>Optimal learning curves for other complexities and time horizons.</title><p>Learning curves represent parameters which optimize the area under the curve (AUC) for each model in the specified environment. Parameters were found according the grid search outlined in ‘Materials and methods,’ ‘Parameter grid search.’ Curves for 250 trials correspond to the AUC values at the right tail of the histogram in <xref ref-type="fig" rid="fig6">Figure 6B</xref>. Error bars reflect standard error of the mean over 1000 simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig6-figsupp1-v2.tif"/></fig></fig-group><p>We next sought to assess the best possible performance for each agent across environments, and thus allowed the parameters for that agent to be optimized. We selected the parameter set from the grid search that optimized performance for each model for various multi-bandit environments, including both reward rich (e.g., 80% vs. 70% reward probabilities) and lean (e.g., 30% vs. 20%) settings; for each agent, a different parameter combination was found to optimize performance in a given environment. As the explore–exploit dilemma becomes increasingly difficult with the number of available options, and to explore the generality of our findings, we also explored different complexity levels (two-armed bandit and six-armed bandit, where one of the options was best [e.g., 80%] and all the others were equivalent to each other [e.g., 70%]).</p><p>Notably, OpAL* outperformed both comparison agents in both the ‘easiest’ environment (rich, two options) and especially in the most difficult (lean, six options; <xref ref-type="fig" rid="fig6">Figure 6A</xref>). As expected, UCB demonstrated a clear improvement above Q-learning in the lean scenario (which taxes exploration–exploitation) but not the rich environment. Nevertheless, despite not having an explicit mechanism for exploring uncertain options, and despite the fact that UCB tracks the sample mean of the entire reward history for the options it has chosen, OpAL* still showed robust improvements over UCB in the lean environment. We will consider the reason OpAL* outperforms UCB in the ‘Mechanism’ section below.</p></sec><sec id="s2-4"><title>OpAL* adaptively modulates risk-taking</title><p>Although the above analyses focused on learning effects, the adaptive advantages conferred by dopaminergic contribution were mediated by changes in the choice function (weighting of learned benefits vs. costs) rather than learning parameters per se. We thus next sought to examine whether the same adaptive mechanism could also be leveraged for inferring when it is advantageous to make risky choices.</p><p>Models selected between a sure reward and a gamble of twice the value with unknown but stationary probability. The sure thing (ST) was considered the default reference point (<xref ref-type="bibr" rid="bib45">Kahneman and Tversky, 1979</xref>), and gamble reward was encoded relative to that; that is, <inline-formula><mml:math id="inf109"><mml:msub><mml:mi>R</mml:mi><mml:mtext>mag</mml:mtext></mml:msub></mml:math></inline-formula> =+1 if gamble was won (gamble received an additional point relative to taking ST) or <inline-formula><mml:math id="inf110"><mml:msub><mml:mi>L</mml:mi><mml:mtext>mag</mml:mtext></mml:msub></mml:math></inline-formula> = –1 (loss of the ST). In high-probability gamble states, the probability of reward was drawn uniformly above 50%; in low-probability gamble states, probability of reward was drawn uniformly below 50%. Models were presented with the same gamble for 50 trials. The meta-critic tracked the <inline-formula><mml:math id="inf111"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the gamble and modulated <inline-formula><mml:math id="inf112"><mml:mi>ρ</mml:mi></mml:math></inline-formula> by its estimated expected value, as in <xref ref-type="disp-formula" rid="equ9">Equations 9–14</xref>. G/N actors then tracked the action value of selecting the gamble. The probability of accepting the gamble was selected using the softmax choice function, such that accepting the gamble is more likely as the benefits (G) exceed the costs (N). <inline-formula><mml:math id="inf113"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> definition can be found in <xref ref-type="disp-formula" rid="equ15">Equation 15</xref>.<disp-formula id="equ22"><mml:math id="m22"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi><mml:mo>⁢</mml:mo><mml:mi>m</mml:mi><mml:mo>⁢</mml:mo><mml:mi>b</mml:mi><mml:mo>⁢</mml:mo><mml:mi>l</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>A</mml:mi><mml:mo>⁢</mml:mo><mml:mi>c</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>As expected, OpAL* dynamically updated its probability of gambling and improved performance in comparison to the balanced OpAL+, non-modulated model (<xref ref-type="fig" rid="fig7">Figure 7</xref>). In states with high probability (<inline-formula><mml:math id="inf114"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>50</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), value modulation helped the model infer that the gamble was advantageous. In low-probability gambles (<inline-formula><mml:math id="inf115"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>50</mml:mn><mml:mi mathvariant="normal">%</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), value modulation aided in avoiding the gamble, which was unfavorable in the limit. As observed in the bandit problems, DA modulation showed a larger benefit in the lean environment relative to the rich environment. By lowering its dopamine levels, OpAL* can leverage the specialization of N weights, which are more sample efficient in lean environments relative to standard RL; we elaborate in more detail in the next section the sampling tradeoff in rich and lean environments. This suggests that DA regulation is particularly helpful for avoiding risky decisions with low expected value but whose potential payoffs are larger than a guaranteed reward.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Dynamic dopamine modulation by estimated reward probability helps OpAL* decide when it is beneficial to gamble or to accept a sure reward.</title><p><inline-formula><mml:math id="inf116"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.05</mml:mn></mml:mrow><mml:mo mathvariant="normal">,</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.1</mml:mn></mml:mrow></mml:mrow><mml:mo mathvariant="normal">,</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, annealing parameter <inline-formula><mml:math id="inf117"><mml:mrow><mml:mi>T</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">10</mml:mn></mml:mrow></mml:math></inline-formula>, and modulation parameters <inline-formula><mml:math id="inf118"><mml:mrow><mml:mi>k</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">20</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf119"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1.5</mml:mn></mml:mrow></mml:math></inline-formula>. Results were averaged over 1000 simulated states. Error bars are standard error of the mean. To limit variance, paired OpAL* and OpAL models were again given the same initial random seed.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig7-v2.tif"/></fig></sec><sec id="s2-5"><title>Mechanism</title><p>How does OpAL* confer such an advantage across environments? Intuitively, by specializing on different regions of the reward probability space, OpAL* can leverage the appropriate actor that is most adept at distinguishing between low- or high-probability options. But this presumes that the actors already know the appropriate rankings, which of course they must learn. A satisfactory account of how OpAL* solves this problem must first address why standard RL agents suffer in lean environments. To do so, we discuss two objectives an algorithm may have: learning accurate expected values for each action or directly optimizing a policy (<xref ref-type="bibr" rid="bib82">Sutton and Barto, 2018</xref>). A Q-learner is a prototypical example of the former objective; OpAL* belongs to the latter class. In this section, we contrast these objectives and their implications for cross-environment flexibility before moving on to the empirical implications of OpAL* in the next section (OpAL* captures alterations in learning and choice preference across species).</p></sec><sec id="s2-6"><title>Q learners show poor convergence and reductions in action gap with sparse reward</title><p>A key objective of a Q-learner, by construction, is that Q values converge to the expected reward for each option. However, before the algorithm converges, the policy selects actions that will necessarily be influenced by misestimation errors. Importantly, Q value convergence is impeded when the agent has to select between multiple options via a stochastic choice policy. Indeed, algorithms like Q-learning and UCB converge well when an option is well-sampled, but the speed and accuracy of this convergence are affected by stochastic sampling, leading to value estimation errors. This issue is known to weaken the ‘action gap’: the gap between the expected reward value for the optimal action and that of the next best option (<xref ref-type="bibr" rid="bib31">G. Bellemare et al., 2015</xref>), which in turn impedes performance. In contrast, as a modified actor-critic, the actor propensities in OpAL* adjust to directly optimize performance, without representing the expected rewards for each action per se. Nevertheless, opponent actor weights retain ordinal (but nonlinear) rankings of action–outcome associations which can be used for action selection among novel pairs of actions (<xref ref-type="fig" rid="fig1">Figure 1</xref>; <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). Below we show that value misestimation errors and the action gap are particularly challenged in lean environments, and that OpAL* remedies this difference.</p><p>To investigate estimation errors in algorithms that choose based on learned values, consider two metrics: the difference of a representation to the ground truth (e.g., difference between Q-value and 0.8 for an option that yields reward 80% of the time) and the action gap (the difference between Q-values of the best option and second best option). The former tracks convergence of true expected values and the latter reflects the effectiveness of the current policy (assuming a softmax-like policy, whereby the relative difference in value determines the probability of action selection). An algorithm that has not converged may still nonetheless have an effective policy.</p><p>Note that because an agent typically only learns about what it has chosen, convergence is hindered for those actions it has not selected. When an agent is given full counterfactual information about rewards for all actions irrespective of choice, the best and second best options in rich and lean environments converge quickly to their true targets (0.8 vs. 0.7 or 0.3 vs. 0.2, respectively) and the action gap for both environments converges to the true value of 0.10 at similar rates (<xref ref-type="fig" rid="fig8">Figure 8A</xref>, left). In contrast, when an agent receives feedback only for actions it has chosen, both the action gap and convergence are impeded, with a stark difference in rich versus lean (these differences are further amplified as more actions become available, see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). Notably, the action gap in the rich environment is larger than that of the lean environment (and even than that under full information). This is because in the rich case, once the agent begins exploiting the optimal action, its value converges (black line) while that of the second best option’s value remains underestimated (gray line plateaus). This lack of convergence for the suboptimal action (0.7) is actually helpful for an effective policy as its value remains closer to the initialization value and thereby increasing the action gap. Conversely, as options in the lean environment are sampled, their values <italic>decrease</italic>, and repeated sampling of the best option (0.30) could cause it to become estimated as undesirable relative to a less-explored (but truly suboptimal) action. Thus, misestimation errors are particularly pernicious in a lean environment, preventing exploitation of the best options until all have sufficiently converged. As such, the estimates of both the best and second best options actually converge more reliably on average (though remain slightly underestimated), but the policy suffers until this is the case.</p><fig-group><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Overview of mechanisms contributing to performance differences.</title><p>Simulations in a and b conducted using the cross-environment optimized parameters according to grid search and 1000 simulations. (<bold>A</bold>) Left: stochastic sampling of actions hinders a Q learner’s convergence to true Q-values in lean environments (red lines) relative to rich environments (black/gray lines), causing reduced action gaps in lean environments. This difference is absent when full information is provided to the agent about reward outcomes for each alternative action (top row), implying that it is due to sampling (bottom row). Right: the proportion of simulations where the Q-value of the optimal action (80% or 30%) exceeds that of the suboptimal option (70% or 20%) differs in rich vs. lean, impeding the policy. In contrast, OpAL* capitalizes on the specialization in the N actor to discriminate between sparse reward outcomes, demonstrating comparable performance in both environments, as seen empirically in rodent behavior (<xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>). Similar patterns are seen in higher complexity environments (<xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). Learning curves reflect mean of 1000 simulations; error bars reflect standard error of the mean. (<bold>B</bold>) OpAL* exhibits reduced policy fluctuations in lean environments. Policy fluctuations are indexed by variability within simulations of the sign of <inline-formula><mml:math id="inf120"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="normal">choose </mml:mtext><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">30</mml:mn></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">-</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo mathvariant="normal">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mrow><mml:mtext mathvariant="normal">choose </mml:mtext><mml:mo mathvariant="normal">⁢</mml:mo><mml:mn mathvariant="normal">20</mml:mn></mml:mrow><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. Higher standard deviation of this metric indicates more fluctuations, which are common in comparison models due to convergence issues. (<bold>C</bold>) OpAL* avoids policy fluctuations due to nonlinear accumulation of reward prediction errors (RPEs). Here, each agent experienced a fixed policy and reward sequence for a two-armed bandit (30% vs. 20%) to visualize learning dynamics for a fixed sequence of events. Left, top: each agent’s policy had they been able to freely choose. After initial exploration period, OpAL* reliably selects the optimal action; other agents again showed extended policy fluctuations. Middle: in OpAL*, N weights accumulate nonlinearly with RPEs for suboptimal 20% action, differentiating from 30%. This pattern is not present without Hebbian nonlinearity. Vertical bar indicates where dynamic DA is engaged as meta-critic determines the environment is lean, so OpAL* policy relies on the N actor. Similar patterns were observed for other random seeds.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig8-v2.tif"/></fig><fig id="fig8s1" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 1.</label><caption><title>Q-learning convergence issues are amplified as the number of suboptimal actions increases.</title><p>Q-learning convergence issues are amplified when selecting among multiple actions (here, 6), causing decreased performance in lean relative to rich environments. OpAL* continues to show comparable action gaps between rich and lean environments. Learning curves reflect mean of 1000 simulations; error bars reflect standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig8-figsupp1-v2.tif"/></fig><fig id="fig8s2" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 2.</label><caption><title>Upper Confidence Bound (UCB) convergence impacted by multiaction sampling.</title><p>UCB convergence is impeded when selecting among multiple actions, similar to Q-learning (<xref ref-type="fig" rid="fig8">Figure 8A</xref> and <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>). UCB’s exploration algorithm causes excessive sampling even when the correct answer is known (observe the difference between Q and Q+ bonus in the last 400 trials of the lean two-option environment), which is further exacerbated in high-complexity environments. Learning curves reflect mean of 1000 simulations; error bars reflect standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig8-figsupp2-v2.tif"/></fig><fig id="fig8s3" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 3.</label><caption><title>Alternative opponent model that lacks three-factor Hebbian dynamics (<xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>) is impacted by multiaction sampling.</title><p>Convergence behavior of <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> due to sampling amongst multiple actions. (<bold>A</bold>) While under full information, the Möller and Bogacz model quickly converges, stochastic sampling affects this convergence for similar reasons as in Q-learning. Most notably, the convergence for the rich suboptimal option (70%) is underestimated as the model learns quickly to reliably select the optimal option (80%). Note that ‘Q-true’ here refers to the mean value to which the model converges when sampling a single action. We found that under probabilistic rewards that the Q-value (.5(G – N)) underestimates in rich and overestimates in lean, but reliably and stably provide ordinal rankings useful for decision-making. See panel (<bold>C</bold>). Right: the action gaps for rich and lean environments are divergent under stochastic sampling. (<bold>B</bold>) Under stochastic sampling, the proportion of simulations where the action gap is positive (i.e., in favor of the optimal action) is lower in lean than in rich environments (top), which ultimately translates to slowed policy in the lean environment (bottom). (<bold>C</bold>) G/N learning curves and Q-values –.5(G – N) – under full information (left) and stochastic policy (right). -N is plotted. Rich environment options converge less accurately to their full information representations, particularly the 70% option as it is undersampled and does not need to converge to learn an accurate policy. Both lean environment options are more accurate in their estimations, reflecting the increased exploration and sampling needed in lean environments (which produces worse performance in terms of net returns). (As nicely demonstrated in <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>, actor-critic variants which utilize the state value V(s) as a critic can cause similar G/N misestimations for suboptimal values due to the critic converging to the optimal option. However, in our simulations, misestimations arose for both options even with an actor-only implementation.) Learning curves reflect mean of 1000 simulations; error bars reflect standard error of the mean.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig8-figsupp3-v2.tif"/></fig><fig id="fig8s4" position="float" specific-use="child-fig"><label>Figure 8—figure supplement 4.</label><caption><title>Consistency of reward prediction error (RPE) valence in OpAL* induces convexity.</title><p>From <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>. Higher-order terms in the recursive update caused by three-factor Hebbian dynamics (<xref ref-type="disp-formula" rid="equ23">Equation 22</xref>) implicitly encode <italic>consistency</italic> in the valence of RPEs. This can be illustrated by varying actor learning rates, <inline-formula><mml:math id="inf121"><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf122"><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula>. Higher learning rates imply greater influence of these higher-order terms (e.g., two-way interactions are scaled by <inline-formula><mml:math id="inf123"><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>), inducing exaggerated convexity for G weights in rich environments (more consistency of positive RPEs) and N weights in lean environments (more consistency of negative RPEs).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig8-figsupp4-v2.tif"/></fig></fig-group><p>While the above analysis focuses on average convergence for each individual run, another way to investigate the robustness of an algorithm’s policy is to consider the proportion of simulations where the best action has an estimated Q-value greater than that of the second best (i.e., how often is the action gap positive). This ‘action value ranking’ can then be compared to the analogous rankings in OpAL*, wherein we assess the rankings of G weights on rich environments and N weights in lean environments (given that these weights dominate in their respective environment). Again, we observe that Q-learner shows a higher proportion of simulations in the rich environment with proper rankings than in lean. Importantly, and in contrast, OpAL* shows balanced action value rankings in rich and lean environments, which directly translates to similar rich and lean performance in terms of policy (<xref ref-type="fig" rid="fig8">Figure 8A</xref>, right). Because the rich versus lean asymmetry in the Q-learner stems from the stochastic policy, these effects are amplified further by increasing complexity via the number of suboptimal actions, whereas OpAL* preserves cross-environment performance in these cases (see <xref ref-type="fig" rid="fig8s1">Figure 8—figure supplement 1</xref>).</p></sec><sec id="s2-7"><title>Opponency and Hebbian nonlinearity allows OpAL* to optimize action gaps</title><p>Having characterized the divergent behavior in rich and lean environments for value-based agents, we now illustrate how opponency and nonlinearity allow OpAL* to overcome these differences. Let us first consider OpAL* dynamics given full information. Because of the nonlinearities in opponent actors, convexity in the G and N weights imply that the two actors differentially specialize in discriminating between high and low reward probability options, as shown in <xref ref-type="fig" rid="fig1">Figure 1B</xref>. Thus, increasing DA amplifies the G actor’s contributions to choice, which increases the action gap for high-probability options. Conversely, lowering DA amplifies the N actor’s contributions, which increases the action gap for low-probability options. As the Bayesian meta-critic converges on an estimate of environmental richness, OpAL* can adapt its policy to dynamically emphasize the most discriminative actor and appropriately enhance the action gap to optimize the policy (<xref ref-type="fig" rid="fig2">Figure 2</xref>, left). In contrast, a variant which lacks nonlinearity (No Hebb) induces redundancy in the <inline-formula><mml:math id="inf124"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf125"><mml:mi>N</mml:mi></mml:math></inline-formula> weights and thus essentially reduces to a standard actor-critic agent. As such, dopamine modulation does not change its discrimination performance across environments and the action gap for choice remains fixed (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>However, the above logic depends on the agent having access to properly ranked actions, the question remains as to how OpAL* can leverage this action gap when full information is not provided (and therefore the action gap is not guaranteed to be positive during early learning). As highlighted above, sparse reward environments typically result in more stochastic sampling because repeated selection of the optimal action often leads to its value decreasing below that of suboptimal actions during early learning, causing the agent to switch to those suboptimal actions again until they become worse, and so on until convergence. This vacillation is evident in the comparison models (Q-learning and No Hebb), which are susceptible to substantial policy fluctuations in lean environments (<xref ref-type="fig" rid="fig8">Figure 8B and C</xref>). (Below we will consider policy fluctuations that also impede performance in UCB as the number of alternative actions grow, but that issue is not specific to lean.).</p><p>OpAL* overcomes this issue in the lean environment in two ways. Firstly, in the early stages of learning, neither actor dominates action selection (the weights have not yet accumulated, and dynamic DA has not yet engaged to preferentially select an actor). Thus the nondominant (here, <inline-formula><mml:math id="inf126"><mml:mi>G</mml:mi></mml:math></inline-formula>) actor contributes to the policy early during learning, thereby flattening initial discrimination and enhancing exploration. In this sense, the exploration/exploitation tradeoff in OpAL* operates at the meta-critic level: it needs sufficient exploratory experience early on to be confident that the environment is one that should be exploited primarily by one actor or the other, whereas the actual action is then selected as a function of actor weights therein.</p><p>Secondly, and more critically, OpAL* more quickly allows the N weights to discriminate between low-probability options. In early stages of learning, the Hebbian nonlinearity ensures that negative experiences induce disproportional distortions in <inline-formula><mml:math id="inf127"><mml:mi>N</mml:mi></mml:math></inline-formula> weights (<xref ref-type="fig" rid="fig2">Figure 2</xref>), more rapidly increasing the action gap between optimal and suboptimal options with less stochastic sampling required.</p><p>To evaluate this claim systematically, we fixed both the policy and feedback across all agents so that they experienced the same choices and outcomes in a lean environment (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). We then evaluated how such sequences of events translated into changes in the critic’s evaluation and the resulting N weights/Q values. We also plot the softmax probability of selecting the optimal action had the agent been able to freely choose according to its (forced) experiences. Parameters selected were those which optimized performance across environments for each agent according to a grid search.</p><p>First, we note that OpAL* terminates its exploration earlier than alternative models (No Hebb and Q-learning). Second, we observe while Q-values continue to oscillate in their rankings throughout the trials, OpAL*’s N weights maintain a proper ranking after the first 50 trials. These dynamics importantly rely on the Hebbian term (the No Hebb model, while experiencing fewer fluctuations than the Q-learning model, has a smaller, and at times negative, action gap relative to OpAL*). The central mechanism by which OpAL* maintains consistent adaptive policy in lean environments is that the N weights nonlinearly accumulate with the history of negative RPEs induced by the critic (<xref ref-type="fig" rid="fig8">Figure 8C</xref>). Note that, given the fixed policy and outcomes, the critic itself closely follows the dynamics of both the No Hebb critic and the Q-learner. However, recall that in OpAL*, the update in <inline-formula><mml:math id="inf128"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf129"><mml:mi>N</mml:mi></mml:math></inline-formula> weights occurs in proportion to not only the critic RPEs, but to the prior <inline-formula><mml:math id="inf130"><mml:mi>G</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf131"><mml:mi>N</mml:mi></mml:math></inline-formula> weight itself (i.e., <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4)</xref>. Thus weight updates are influenced not only by the current RPE but also by previous RPEs that the <inline-formula><mml:math id="inf132"><mml:mi>G</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="inf133"><mml:mi>N</mml:mi></mml:math></inline-formula> weights have accumulated.</p><p>Indeed, expanding the recursive actor weight update equations, resulting update in a given trial can be written as:<disp-formula id="equ23"><label>(22)</label><mml:math id="m23"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>See the section ‘Derivation of OpAL actor weights as a function of RPE history’ for full derivation.</p><p>The first term is just the standard actor update as a function of the RPE in the current trial. But one can see that the update is additionally influenced by the sum of all of the previous RPEs, each of them equally weighted by <inline-formula><mml:math id="inf134"><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula>, and thus OpAL* updates implicitly have access to the entire history of RPEs. Moreover, updates are further scaled by higher order terms comprising each pair of previous RPEs, scaled by <inline-formula><mml:math id="inf135"><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula>, and so on. As such, the actor weights grow nonlinearly with the <italic>consistency</italic> of RPE’s: when the preponderance of RPEs is positive (<inline-formula><mml:math id="inf136"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>), the second-order terms will lead to superlinear weight changes, but when they are mostly negative, these higher order terms will pull weight changes in the opposite direction. The same form applies to updates of <inline-formula><mml:math id="inf137"><mml:mi>N</mml:mi></mml:math></inline-formula> weights, but where each <inline-formula><mml:math id="inf138"><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> is replaced by <inline-formula><mml:math id="inf139"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>Note that before the critic has converged, the sum of the accumulated negative RPEs (the first term above) is larger than that of positive RPEs for lean options, and vice versa for rich options. The nonlinear accumulation translates into disproportionately larger N weights for the most suboptimal actions (and conversely, larger G weights for optimal actions in a rich environment). Note also that, unlike standard RL, higher actor learning rates in this scheme do not imply that weight changes are primarily influenced by the current RPE; rather, here they imply more influence of the higher order terms, leading to more convex weights. (See Supplemental note 5 in Appendix 2). See <xref ref-type="disp-formula" rid="equ23">Equation 22</xref> and ‘Derivation of OpAL actor weights as a function of RPE history’ for more details.</p><p>The net result is that OpAL* can optimize and stabilize its policy well before critic or Q value convergence (at which point the expectation over RPEs is zero, and higher order terms induce decay in actor weights, although this is largely mitigated by annealing). (See Supplemental note 6 in Appendix 2). This notably contrasts with Q-learning, where slow convergence to ground truth values is detrimental to performance. By adapting its policy by environmental richness (and confidence therein), OpAL* can dynamically leverage this specialization to quickly optimize performance, well before the critic converges, avoiding an explore–exploit tradeoff that is especially vexing in lean environments.</p><p>A particularly striking result is that OpAL* exhibits advantages over UCB, even though UCB has access to the sample mean of an action’s reward history (i.e., perfect memory). But in order to obtain that sample mean, the agent has to sufficiently explore it. Akin to Q-learning, UCB’s objective is to learn accurate value estimates. The main difference is that while a Q learner explores stochastically via softmax, UCB’s exploration is directed toward those actions for which the values are most uncertain, allowing it to obtain high-certainty upper-bound estimates of the action value. As such, like Q-learning, UCB demonstrates slowed convergence when it has to choose among multiple actions, which is further impeded as the number of actions grows; (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>). In contrast, OpAL* exploration serves to optimize a policy, without seeking precise value estimates. Indeed, while OpAL* does exhibit early exploration before switching to exploitation, this transition occurs earlier due to the growing action gap and dopamine modulation as described above. In contrast, UCB demonstrates a more gradual and prolonged exploration phase (<xref ref-type="fig" rid="fig8">Figure 8B</xref>) even when the correct action is well estimated (<xref ref-type="fig" rid="fig8s2">Figure 8—figure supplement 2</xref>, lean, 600–1000 trials, two options), thereby impeding performance. Notably, this tradeoff is particularly intensified as the number of options grows because the UCB bonus will serve to enhance exploration to all of these options. Accordingly, when we optimized UCB’s exploration bonus parameter, we found that the best it could do is reduce the exploration bonus in high-complexity environments to counter this impediment (not shown; but see histograms in which UCB shows variable performance for different levels of this parameter across environments; <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>We conclude this discussion by considering whether OpAL* might simply induce a more efficient change from exploration to exploitation across learning independent of its specialized opponent actors. The favorable comparison to UCB (<xref ref-type="fig" rid="fig6">Figure 6</xref>) suggests this is not the case because effectively the UCB algorithm is designed to do just that in a more sophisticated way (exploration directed toward options that have not been sampled sufficiently but then exploit after that). To further diagnose whether dynamically modifying the softmax temperature alone is sufficient to improve robustness within an opponency model, we simulated a control variant in which DA levels were used to dynamically increase both <inline-formula><mml:math id="inf140"><mml:msub><mml:mi>β</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf141"><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:math></inline-formula> together, independent of the sign of <inline-formula><mml:math id="inf142"><mml:mi>ρ</mml:mi></mml:math></inline-formula> (<inline-formula><mml:math id="inf143"><mml:mi>β</mml:mi></mml:math></inline-formula> modulation model, see Appendix 1 ‘Comparison to softmax temperature modulation’). OpAL* outperformed the <inline-formula><mml:math id="inf144"><mml:mi>β</mml:mi></mml:math></inline-formula> modulation in rich environments and was able to more rapidly learn in lean environments. These simulations show that while dynamic changes in softmax temperature may be sufficient to improve performance in one environment, the dynamic shift from one specialized actor to another is integral to flexibility across both environments.</p><p>To summarize, agents that prioritize learning accurate action values (including ‘standard’ RL) make qualitative predictions that performance should be significantly hindered in lean compared to rich environments. OpAL* shows substantially improved performance in lean environments due to its opponent and nonlinear properties, especially when DA is modulated dynamically to capitalize on these properties. These are testable predictions. In line with these qualitative patterns, rodents showed equally robust learning in rich environments (90% vs. 50% bandit task) compared to lean environments (50% vs. 10% bandit task) in <xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref> (see Figure 1d of that paper). We explore more detailed simulations of empirical data across species below.</p></sec><sec id="s2-8"><title>Advantages in lean environment are not seen in other opponent BG models lacking Hebbian nonlinearity</title><p>Notably, opponency alone is not sufficient to remediate this divergence in rich and lean performance. Indeed, we also analyzed an alternative model of D1/D2 opponency presented by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>. This model does not include the Hebbian term, but does include a different nonlinearity which allows the <inline-formula><mml:math id="inf145"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf146"><mml:mi>N</mml:mi></mml:math></inline-formula> weights to converge to the mean expected payoffs and costs in the environment. This property serves as a useful comparison: once costs and benefits for each action are known, an agent should be able to choose its policy to maximize reward (and/or manage risk). However, similar to Q-learning, the convergence to expected payoffs and costs in this model is only guaranteed in the limit after repeatedly selecting the same action, and is subject to the same convergence impediments when faced with stochastic action selection. Moreover, this control model serves as another test for the utility of the Hebbian term and the resulting convexity of OpAL* G/N weights as described below. We tested this model with a two-armed bandit with the same reward contingencies as those in the rich and lean environments, but incorporating an explicit cost for incorrect choices (lmag = –1) to better align with the model’s scope. (See Supplemental note 7 in Appendix 2). These simulations revealed similar properties to Q-learning: shallowing of action-gap and value ranking curves between rich and lean environments, and slowed convergence relative to full information models, again showing that they are due to the dependence on action selection (<xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>).</p><p>Notably, for the models proposed by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>, the G weights show stronger discrimination between actions in reward lean environments, whereas the N weights show stronger discrimination in rich environments (<xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3C</xref>), the opposite of OpAL*. If this model were to vary its dopamine states similarly to OpAL* in order to amplify the contribution of the more informative actor, it would require adjusting DA in the opposite direction, with higher dopamine in reward lean environments and lower dopamine in reward-rich environments at choice, contrary to what has been found empirically (<xref ref-type="bibr" rid="bib58">Mohebi et al., 2019</xref>; <xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>). <xref ref-type="bibr" rid="bib57">Moeller et al., 2021</xref> found that human participants do show higher risk-taking for richer reward contexts and lower risk-taking for leaner reward contexts, in line with OpAL* predictions. When they allow stimulus onset to induce an RPE, the <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> model also accounts for this same empirical risk-taking pattern. However, as shown above, it would still show impeded learning in lean environments for discrimination bandit tasks as simulated in this article. Furthermore, in contrast to OpAL*, the nonlinearity used in their model induces concavity rather than convexity in actor weights, and thereby predicts the incorrect pattern of findings for the impact of DA manipulations on discrimination learning and choices amongst high and low rewarding options in Parkinson’s patients (see Figure 10 in <xref ref-type="bibr" rid="bib55">Mikhael and Bogacz, 2016</xref>). Many studies have replicated the pattern predicted by OpAL*, whereby PD patients off medication better discriminate between lean options, whereas on medication they better discriminate between rewarding options (<xref ref-type="bibr" rid="bib27">Frank et al., 2007b</xref>; <xref ref-type="bibr" rid="bib23">Frank et al., 2004</xref>; <xref ref-type="bibr" rid="bib54">McCoy et al., 2019</xref>; <xref ref-type="bibr" rid="bib48">Kobza et al., 2012</xref>; <xref ref-type="bibr" rid="bib90">Weismüller et al., 2018</xref>; <xref ref-type="bibr" rid="bib78">Smittenaar et al., 2012</xref>; <xref ref-type="bibr" rid="bib76">Shiner et al., 2012</xref>). These observations further emphasize the need for the three-factor Hebbian nonlinearity for OpAL*’s normative properties but also its accordance with empirical data.</p></sec><sec id="s2-9"><title>OpAL* captures alterations in learning and choice preference across species</title><p>While all analyses thus far focused on normative advantages, the OpAL* model was motivated by biological data regarding the role of dopamine in modulating striatal contributions to cost/benefit decision-making. We thus sought to examine whether empirical effects of DA and environmental richness on risky choice could be captured by OpAL* and thereby viewed as a by-product of an adaptive mechanism. We focused on qualitative phenomena in empirical data sets that are diagnostic of OpAL* properties (and which should not be overly specific to parameter settings) and that could not be explained individually or holistically by other models. In particular, we consider impacts of optogenetic and drug manipulations of dopamine and striatal circuitry in rodents and humans. We further show that OpAL* can capture economic choice patterns involving manipulation of environmental reward statistics rather than DA.</p></sec><sec id="s2-10"><title>OpAL* accounts for counterintuitive human choice preferences for loss-avoiding options over those that produce net gains</title><p>As noted in the above ‘Mechanism’ section, instead of converging to veridical values, OpAL*’s G/N weights serve to quickly rank the relative value of options, optimizing the policy across environments with varying reward statistics. Importantly, OpAL* retains the ranked values for a given environment (<xref ref-type="fig" rid="fig1">Figures 1B</xref> and <xref ref-type="fig" rid="fig4">4</xref>), affording transitive choice amongst them (as in the probabilistic selection task and impacts of DA manipulations simulated previously by <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>).</p><p>Nevertheless, given that its actor weights are governed by history of critic RPEs, OpAL* does predict that the relative value of other options can influence how an action is learned, which may produce counterintuitive behavior when the overall reward richness of a context changes. Previous research supports this notion (<xref ref-type="bibr" rid="bib47">Klein et al., 2017</xref>; <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Gold et al., 2012</xref>; <xref ref-type="bibr" rid="bib32">Geana et al., 2022</xref>). For example, participants in <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref> learned to select between fixed pairs of stimuli with different reward probabilities (<xref ref-type="fig" rid="fig9">Figure 9</xref>). For some stimuli, participants could maximize rewards, whereas for others they could simply avoid losses. In a post-learning transfer phase, participants were given the option to express preferences among novel combinations of stimuli, participants counterintuitively preferred to choose an option that had mostly avoided a loss but still infrequently produced a loss 25% of the time (L25) over an option that had strictly positive value (infrequent gain; G25). Moreover, this seemingly irrational pattern was observed only when participants were given full information during learning about both the outcome of their action and that of the action they had not chosen. As <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref> describe, these results can only be captured if participants learn not the absolute values of options, but instead the relative value of options within their context. To determine whether these patterns can be captured also by OpAL*, we simulated the same task contingencies and allowed the critic to reflect the context (state) value (<xref ref-type="fig" rid="fig9">Figure 9</xref>). Because full information was given, we allowed the critic to learn quickly here, such that a less frequent loss (L25) stimulus mostly induces a positive prediction error in its relative context (by avoiding a loss 75% of the time), and conversely the less frequent gain (G25) mostly elicits a negative RPE in its context; full information amplifies this effect as the critic has a more accurate estimation of context value. While these qualitative results do not rely on the dopamine modulation component of OpAL*, they highlight the policy optimization that DA leverages. However, OpAL* does raise a new counterintuitive prediction: if participants were in a rich environment or administered DA enhancing drugs prior to the transfer phase, preference for a loss avoider (L25) should <italic>increase</italic> as this would promote the contribution of G weights which dominate in the loss avoider.</p><fig id="fig9" position="float"><label>Figure 9.</label><caption><title>OpAL* captures counterintuitive and context-dependent human choice preference in <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>.</title><p>In <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>, participants learned to select between two stimuli to maximize their rewards. Participants learned about eight stimuli in total, where two stimuli were always paired together during the initial learning phase for a total of four ‘contexts.’ Contexts varied in valence – either rewarding or punishing – and varied in information – either only feedback of the selected action was provided (partial) or counterfactual information was also provided (complete). In the gain contexts, one action had a probability of receiving reward 75% of the time or nothing (G75%); the other received reward 25% of the time or nothing (G25%). In the loss contexts, the preferred action received a punishment 25% of the time or nothing (L25%); the other received a loss 75% of the time or nothing (L75%). In a post-learning transfer phase, participants were presented with stimuli every pair-wise combination regardless of context and were asked to choose which stimuli they preferred. For items learned under complete information, participants counterintuitively preferred the more frequent loss avoider (L25%) to the less frequent rewarding stimulus (G25%). While a standard Q-learner would predict preference according to expected value as is seen in the partial information results, a model which incorporates the relative value of an action to the state value into its prediction error would predict the counterintuitive results as <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref> propose. OpAL* can similarly capture these results by allowing the critic to quickly reflect the context value. Like in the model proposed by <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>, complete information allows the critic to converge more quickly to the state value and produce positive prediction errors for the frequent loss avoider (L25%) and negative prediction errors for the infrequent reward earner (G25%). Error bars for OpAL* show standard error of the mean. Top images (paradigm and empirical findings) reproduced from Figure 1a of <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig9-v2.tif"/></fig></sec><sec id="s2-11"><title>Striatal D2 MSN activity and reward history alter risky choice in rodents</title><p>Perhaps the most germane empirical study to OpAL since the original model was developed is that of <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>, who studied rodent risky choice as it is altered by reward history, dopamine manipulation, and striatal activity. Rats repeatedly chose between a certain option with a small reward or a gamble for larger reward whose expected value matched that of the certain option. Following unsuccessful gambles, they observed increased activity in D2-expressing MSNs in ventral striatum during subsequent decision periods. (See <xref ref-type="fig" rid="fig10">Figure 10</xref> for illustration of these results.) Recall that in OpAL*, reward history alters DA levels, which in turn modulate activity in striatal MSNs and accordingly cost/benefit choice. In this case, a reduced recent reward history should reduce striatal DA, elevate D2 MSN activity, and thus promote choices that avoid costs. Indeed, Zalocusky et al. observed that animals were more likely to make a ‘safe’ choice when D2 MSNs were stimulated during the choice period, and that endogenously, such safe choices were related to increased D2 activity and enhanced following unfavorable outcomes. Together, these results suggest an trial-to-trial adaptation of choice (rather than learning) driven by changes in D2 activity, akin to OpAL* mechanisms. Furthermore, such optogenetic stimulation effects were only seen in animals with a baseline preference for risk-seeking; risk-averse animals exhibited no change in behavior with the phasic manipulation.</p><fig id="fig10" position="float"><label>Figure 10.</label><caption><title>Striatal D2 medium spiny neuron (MSN) activity and reward history alter risky choice in rodents.</title><p>Rodents repeatedly selected between a certain option with low magnitude of reward and a gamble with higher payout when successful. Left column: reproduced from <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>. Right column: model simulations with OpAL* and risk-sensitive RL (RSRL). (<bold>A, B</bold>) Both risk-averse and risk-seeking animals are more likely to avoid a gamble after a gamble ‘loss’ (failure to obtain the large reward). Both OpAL* and RSRL, a standard Q-learner with different learning rates for positive and negative prediction errors, can capture this trend, via changes in either choice function (D1 vs. D2 MSN contributions) or learning rates, respectively. Error bars for OpAL* show standard error of the mean. (<bold>C, D</bold>) D2 MSN activity, measured via photometry, is larger after a gamble loss (red) than a gamble win (green) during the subsequent decision period. This pattern is reproduced in OpAL*, whereby D2 MSN activity is influenced by the product of the <inline-formula><mml:math id="inf147"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> weights and the adaptive <italic>β<sub>n</sub></italic>, which amplifies D2 MSN activity when dopamine levels are low. The simulation peak represents the average of this product after a loss or after a win, which is carried over to subsequent choices; error bars reflect SEM across simulations and dynamics before and after peak were generated by convolving the signal with a sinusoidal kernel for illustrative purposes. (<bold>E, F</bold>) Optogenetic stimulation of D2 MSNs during the choice period induces risk-aversion selectively in risk-seeking rats. OpAL* captures this preferential effect by magnifying the effective D2 MSN activity and inducing avoidance primarily in risk-seeking agents. In contrast, RSRL predicts opposite patterns in risk-seeking and risk-averse animals. Error bars for simulations show standard error of the mean. Parameters OpAL*: <inline-formula><mml:math id="inf148"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1.</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Baseline <inline-formula><mml:math id="inf149"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> risk-seeking (0.85) and risk-averse (–0.75). Parameters RSRL: risk-seeking <inline-formula><mml:math id="inf150"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>; risk-averse <inline-formula><mml:math id="inf151"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Since optogenetic effects were evident primarily during the choice period, we modeled this by changing the choice function in both models: in OpAL, trial-wise <inline-formula><mml:math id="inf152"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> values were decreased by 1.0 to mimic increased D2 MSN activity/decreased DA. In RSRL, the choice function was altered by reducing <inline-formula><mml:math id="inf153"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (to 0.01), leading to opposite directional effects in risk-seeking and risk-averse agents. Agents selected between a certain option and a 50/50 gamble with twice the payout for 100 trials.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig10-v2.tif"/><permissions><copyright-statement>© 2016, Nature Publishing Group</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Nature Publishing Group</copyright-holder><license><license-p>Panels A, C and E are reproduced from Figures 1f, 3f and 4f from <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>, with permission from Nature Publishing Group. They are not covered by the CC-BY 4.0 license and further reproduction of these panels would need permission from the copyright holder.</license-p></license></permissions></fig><p>Note first that these patterns of results are inconsistent with classical models in which striatal D2 activity is related only to motor suppression; here the impact of D2 activity is not to suppress actions altogether but instead to bias choices toward safe options. Instead, these results are consistent with OpAL* in which D2 activity is related to promoting actions with the lowest perceived cost. Indeed, we found that this pattern of results align with the predictions of OpAL* but not alternative risk-sensitive models (see below).</p><p>As in previous sections, we encode gamble outcomes relative to the certain option: <inline-formula><mml:math id="inf154"><mml:msub><mml:mi>R</mml:mi><mml:mtext>mag</mml:mtext></mml:msub></mml:math></inline-formula> = +1 if gamble was won or <inline-formula><mml:math id="inf155"><mml:msub><mml:mi>L</mml:mi><mml:mtext>mag</mml:mtext></mml:msub></mml:math></inline-formula> = –1. For OpAL*, the critic and actors operated as in the section ‘OpAL* adaptively modulates risk-taking.’ G/N actors then tracked the value of selecting the gamble using the prediction error generated by the critic. As before, the probability of accepting the gamble was selected using the softmax choice function.</p><p>To simulate risk-seeking and risk-averse rats, we modified the baseline DA levels (<inline-formula><mml:math id="inf156"><mml:mi>ρ</mml:mi></mml:math></inline-formula>), holding all other parameters constant. Risk-seeking rats were modeled by higher levels of baseline <inline-formula><mml:math id="inf157"><mml:mi>ρ</mml:mi></mml:math></inline-formula> relative to those of simulations for risk-averse rats. To model phasic optogenetic stimulation, <inline-formula><mml:math id="inf158"><mml:mi>ρ</mml:mi></mml:math></inline-formula> values were decreased by a constant amount from this baseline.</p><p>We contrasted OpAL* to alternative models in which risky choice could be adapted. A popular model of dynamics in risky choice is called ‘risk-sensitive RL,’ in which an agent learns at different rates from positive and<disp-formula id="equ24"><mml:math id="m24"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>&gt;=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mtext> </mml:mtext><mml:mrow><mml:mtext>if </mml:mtext><mml:mrow><mml:mi>P</mml:mi><mml:mi>E</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>where actions are selected using softmax function over Q values. If <inline-formula><mml:math id="inf159"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula>, an agent is more sensitive to risks in its environment. This formulation has been useful for characterizing asymmetric impacts of dopamine bursts and dips (<xref ref-type="bibr" rid="bib26">Frank et al., 2007a</xref>; <xref ref-type="bibr" rid="bib63">Niv et al., 2012</xref>), but focuses on learning rather than changes in choice functions. Because the effective manipulations on risky choice were made during the choice period rather than outcome, learning rate manipulations alone could not capture the effects. However, it is possible that DA or D2 manipulations can affect choice in simple RL models via simple changes to the overall softmax temperature, as assumed by many models (<xref ref-type="bibr" rid="bib22">FitzGerald et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Cinotti et al., 2019</xref>; <xref ref-type="bibr" rid="bib21">Eisenegger et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Lee et al., 2015</xref>; <xref ref-type="bibr" rid="bib41">Humphries et al., 2012</xref>). We thus allowed the RSRL model to exhibit changes in risky choice by manipulating softmax gain accordingly, whereby D2 stimulation would mimic low DA levels and hence lower gain.</p><p>We found that both OpAL* and RSRL accounted for the decrease in gamble choices after gamble losses relative to wins, but generated opposing predictions for decision-period manipulation of D2-expressing neurons. While OpAL* predicts a decrease in riskiness in both risk-seeking and risk-averse rats (but more strongly in risk-seeking rats), RSRL predicts a decrease in riskiness in risk-seeking rats but an <italic>increase</italic> in riskiness in risk-averse rats. The reason for this effect is simply that a change in softmax gain leads to reduced exploitation, and thus drives both groups toward random selection. Thus the pattern of choice data is aligned with OpAL* but not with RSRL, or with classical models in which D2 activity inhibits choice altogether. These opposing predictions result from the <italic>architecture</italic> of OpAL* inspired by the biology– including opponency, Hebbian learning, and dynamic DA – rather than specific parameter values. Furthermore, OpAL* also captures the predicted relative activation of D2-expressing cells during the choice period following losses due to changing DA levels (<inline-formula><mml:math id="inf160"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) and the learned cost of the gamble (<inline-formula><mml:math id="inf161"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), in line with Zalocusky’s photometry data.</p></sec><sec id="s2-12"><title>DA drug effects on risky decision-making and individual differences therein</title><p>We next focus on a human risky decision-making paradigm manipulating DA levels (<xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>). Participants were presented with interleaving trials of gain gambles (certain gain vs. potential greater gain or 0), loss gambles (certain loss vs. potential greater loss or 0), and mixed gambles (certain no reward vs. potential gain or potential loss). All gambles were successful with 50% probability. The study tested the effects of levodopa (L-DOPA), a drug which boosts dopamine release, on risky decision-making. The main impact of L-DOPA was to selectively amplify gambling on gain (but not loss or mixed) trials (<xref ref-type="fig" rid="fig11">Figure 11A</xref>, left). This study also found that individual differences in this impact of drug on gambling correlated with effective drug dosage (<xref ref-type="fig" rid="fig11">Figure 11B</xref>, left). The authors reported that the risk-seeking behavior with DA drugs was best described in terms of changes in a Pavlovian approach parameter. Here, we wished to see if the mechanisms introduced above within OpAL* with endogenous changes in dopaminergic state could replicate the pattern of results, thereby providing a normative interpretation.</p><fig id="fig11" position="float"><label>Figure 11.</label><caption><title>OpAL* captures human risk-taking patterns and their manipulation by drug and environmental context.</title><p>(<bold>A, B</bold>) Dopamine (DA) drug effects on risky decision-making and individual differences therein. OpAL* captures behavioral risk patterns of healthy participants on and off L-DOPA, a drug which boosts presynaptic DA. (<bold>A</bold>) L-DOPA administration selectively increased risky choice in gain trials, where choice was between a sure reward and a 50% gamble for a larger reward, as compared to loss trials (sure loss vs. gamble to avoid loss) or mix trials (in which gambles could result in gains or losses). Error bars for OpAL* show standard error of the mean. Left: modified figures from <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>. (<bold>B</bold>) These effects were larger for subjects with higher effective drug doses, Spearman’s <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.47</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. Left: modified figures from <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>. Right: OpAL* simulations reproduce these selective effects. Spearman’s <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>.50</mml:mn><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>.01</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> To model individual differences in effective drug levels, for each pair of model on and off drug, <inline-formula><mml:math id="inf164"><mml:mi>d</mml:mi></mml:math></inline-formula> was drawn from a normal distribution centered at 0.5 with variance 0.25. Parameters: <inline-formula><mml:math id="inf165"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. (<bold>C, D</bold>) Risky decisions are sensitive to environmental richness In contrast to other empirical results discussed where dopamine pathways were directly manipulated, <xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>, manipulated reward statistics of the payoffs in the environment, as in our normative simulations. Participants chose between a certain reward and a 50% gamble over two blocks. The distribution of payoffs in each block was either Rich (higher frequency of large magnitudes) or Lean (higher frequency of small magnitudes). Crucially, each block contained predetermined ‘common trials’ where the payoff of both the gamble and certain option was fixed (e.g., an offer 50% $7.13 vs. 100% $2.70 was presented in <italic>both</italic> the Rich and Lean block). The key finding was that participants were more likely to gamble on these common trials when presented in the Rich context. OpAL* reproduces this pattern due to adaptive <inline-formula><mml:math id="inf166"><mml:mi>ρ</mml:mi></mml:math></inline-formula> increasing DA levels and risk-tasking in the Rich block. Error bars show standard error of the mean. Parameters: <inline-formula><mml:math id="inf167"><mml:mrow><mml:mi>α</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn><mml:mo mathvariant="normal">.</mml:mo><mml:mo mathvariant="normal">,</mml:mo><mml:mi>T</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">10</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi>β</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.5</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1.0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi>k</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0.09</mml:mn></mml:mrow></mml:math></inline-formula>. Figure C modified from <xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-fig11-v2.tif"/></fig><p>We simulated 300 trials (100 gain gambles, 100 loss gambles, and 100 mixed gambles, randomly interleaved, as described in <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>). The probability of gambling was determined as described above in the normative risky choice section, with gambles accepted as the benefits outweigh the costs relative to the ST. <inline-formula><mml:math id="inf168"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf169"><mml:mi>N</mml:mi></mml:math></inline-formula> actor values were explicitly set on each trial according to the instructed gamble and encoded relative to the certain option as in the section ‘OpAL* adaptively modulates risk-taking.’ This reduced the free parameters of OpAL* (no annealing or actor learning rate needed) while retaining its core features of DA reweighting the contributions of opponent representations during choice according to context.</p><p>While values and probabilities were explicitly instructed in the experiment, subjects nevertheless experienced the outcomes of each gamble. The OpAL* model assumes that they thus track the average value of offers across trials, such that a gain trial would elicit a positive dopamine deflection, given that its expected value is larger than that for mixed and loss trials. (As the authors note in discussing their findings, ‘In this task design, even the worst gain trial is better than the average trial and so likely inspires dopamine release.’) We thus modeled the relative DA-state <inline-formula><mml:math id="inf170"><mml:mi>ρ</mml:mi></mml:math></inline-formula> proportional to the expected value of the current gamble offer, approximating how ‘rich’ or ‘lean’ the current offer was relative to all offers in the game. (See Supplemental note 8 in Appendix 2). (We formulate <inline-formula><mml:math id="inf171"><mml:mi>ρ</mml:mi></mml:math></inline-formula> proportional to value here, to be consistent with simulations in the above sections, but very similar results were obtained in a separate set of simulations in which <inline-formula><mml:math id="inf172"><mml:mi>ρ</mml:mi></mml:math></inline-formula> was modulated by RPE.)<disp-formula id="equ26"><label>(23)</label><mml:math id="m26"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mn>.5</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>certain outcome</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mn>.5</mml:mn><mml:mo>×</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>gamble</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>To model L-DOPA, we hypothesized that it would boost positive RPEs via enhancement of evoked (phasic) DA release, as observed in vivo across species (<xref ref-type="bibr" rid="bib87">Voon et al., 2010</xref>; <xref ref-type="bibr" rid="bib65">Pessiglione et al., 2006</xref>; <xref ref-type="bibr" rid="bib66">Qi et al., 2016</xref>; <xref ref-type="bibr" rid="bib40">Harun et al., 2016</xref>). We assumed that L-DOPA amplified endogenous phasic release, which occurs when offers are better than usual (positive RPE). The effect dosage level was represented by <inline-formula><mml:math id="inf173"><mml:mi>d</mml:mi></mml:math></inline-formula> when the gamble had a positive value, as shown below.<disp-formula id="equ27"><label>(24)</label><mml:math id="m27"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ28"><label>(25)</label><mml:math id="m28"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>d</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>As hypothesized, OpAL* captured the selective effects of L-DOPA on gambling in gain trials. It also captured the overall proportion of gambles chosen for different trial types (<xref ref-type="fig" rid="fig11">Figure 11A</xref>), as well as the correlation between effective dosage and difference in gambling on and off drug (<xref ref-type="fig" rid="fig11">Figure 11B</xref>). (See Supplemental note 9 in Appendix 2). Furthermore, the Pavlovian model presented in <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref> would predict that gambling would occur for positive RPEs even if the potential benefit of the gamble was not as high as the sure thing; OpAL* would only predict increased gambling if the benefits are greater than the sure thing.</p><p>Here, we have extended OpAL to account for risky decision-making by dynamically changing dopamine levels at choice proportional to the value of the current state/gamble offer. This accounted for findings of increase attractiveness of high-value risky options with the administration of L-DOPA (<xref ref-type="fig" rid="fig11">Figure 11A</xref>). The model also accounted for individual differences of risk due to effective L-DOPA dosages (<xref ref-type="fig" rid="fig11">Figure 11B</xref>). As highlighted in the previous section, these effects can normatively be explained as behavioral changes reflecting changes of inferred richness of current state. These results also suggest that individual differences in risk preference and sensitivity may be due to learned statistics of the world, casting these individual differences as deriving from an adaptive mechanism to an animal’s or human’s experience niche.</p></sec><sec id="s2-13"><title>Risky decisions are sensitive to environmental richness: Concordance with efficient coding models of economic choice</title><p>Thus far we have focused on data that are informative about the biological mechanisms (striatal opponency and DA modulation thereof) by which OpAL* supports adaptive behavior. But OpAL* also makes straightforward economic choice predictions that do not require biological manipulations. In particular, one way of conceptualizing OpAL* is that it serves as an efficient coding mechanism by amplifying the actor that maximally discriminates between reward values in the current environment. If choice patterns concord with this scheme, one should be able to manipulate the environment and influence choice patterns. For example, consider a gamble in which the benefits outweighs the costs. OpAL* predicts that decision makers should more consistently opt to take this gamble when it is presented in the context of a rich environment. Indeed, this is precisely what was found by economist researchers, who also considered such patterns to be indicative of efficient coding (<xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>).</p><p>In this study, participants were presented with a series of trials where they selected between a gamble with a varying magnitude X with 50% probability and a certain option with varying magnitude C. The task featured two conditions, which we refer to as Rich and Lean. The range (minimum and maximum) of Xs and Cs were equated across the two conditions, but high-magnitude Xs and Cs were more frequent in the Rich environment, whereas low-magnitude Xs and Cs were more frequent in the Lean environment. The distribution of C was set to 0.5*X so that the expected values of the risky lottery and certain option were on average equated. Critically, there were a few carefully selected ‘common trials’ that repeated the exact same high payoff gambles (with identical X and C) across blocks (<xref ref-type="fig" rid="fig11">Figure 11C</xref>). The authors reported that participants were more likely to gamble on common trials in Rich environments than Lean environments. This is in line with their economic efficient-coding model, which predicts subjects allocate more resources to accurately perceive higher payoffs in the Rich condition where higher payoffs are more frequent (and therefore gamble more on common trials which are high payoff).</p><p>To simulate this dataset with OpAL* (<xref ref-type="fig" rid="fig11">Figure 11D</xref>), we assumed that the critic state value would reflect the statistics of the environment. We first set the baseline expectation to reflect the expected value of a uniform prior over the gamble magnitudes and certain magnitudes in the experiment, which serves as a prior for environment richness. <inline-formula><mml:math id="inf174"><mml:mi>ρ</mml:mi></mml:math></inline-formula> was modulated by the learned average gamble offer in the environment relative to this baseline. (See Supplemental note 10 in Appendix 2). As in our earlier risky choice simulations, gambles were encoded relative to the certain option and G/N values were explicitly set according to the instructed gamble, omitting the need again for annealing and actor learning rate while preserving the core dynamics of the full OpAL*. As found empirically and in the authors’ efficient coding model (<xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>), OpAL* predicts increased gambling on common trials in the Rich block relative to the Lean block. According to OpAL*, this result reflects adaptively modulated DA levels in the Rich environment, which emphasized the benefits of the gamble during decision-making. As will be discussed below, OpAL*’s amplification of one striatal subpopulation over another itself can be considered a form of efficient coding, offering a direct mechanistic explanation for recent findings in economic theory. Finally, note that such findings could not be captured by an alternative model in which risky choice is driven by surprise or novelty. Note that for both rich and lean blocks, common trials had larger than usual magnitudes of payoffs. While these payoffs deviated from expectation to a larger degree in the lean block, this should produce a larger RPE (and presumably phasic dopamine signal). Given that increased DA in traditional RL models promotes exploitation (<xref ref-type="bibr" rid="bib41">Humphries et al., 2012</xref>), this account (like the RSRL model above) would predict the opposite pattern than that seen empirically, in this case driving more risky choices in the lean block.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Taken together, our simulations provide a normative account for opponency within the BG and its modulation by DA. In particular, we suggest that nonlinear Hebbian mechanisms give rise to convexity in the learned D1 and D2 actor weights at different ends of the reward spectrum, which can be differentially leveraged to adapt decision-making. To do so, OpAL* alters its dopaminergic state as a function of environmental richness, so as to best discern between the costs or benefits of available options. Conjecturing that such a mechanism is most profitable when the reward statistics of the environment are unknown, we posited and found that the online adaptation robustly outperforms traditional RL and alternative BG models across environment types when sampling across a wide range of plausible parameters. These advantages grow monotonically with the complexity of the environment (number of alternative actions to choose from). Moreover, the unity of all three key features of OpAL* (opponency, three-factor Hebbian nonlinearity, and dynamic DA modulation) offered particularly unique advantages in sparse reward environments, mitigating against a particularly pernicious explore exploit dilemma that arises in such environments by amplifying the action gap in reward sparse environments. Finally, we showed how such a mechanism can adapt risky decision-making according to environmental richness, capturing the impact of DA manipulations and individual differences thereof.</p><p>This article intersects with theoretical (<xref ref-type="bibr" rid="bib62">Niv et al., 2007</xref>) and empirical work (<xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>; <xref ref-type="bibr" rid="bib58">Mohebi et al., 2019</xref>) showing that changes in dopaminergic states locally within striatum reflect reward expectations and impact motivation and vigor. However, this body of literature does not consider how increases or decreases of dopamine affect the decision itself, only its latency or speed. Instead, OpAL/OpAL* can capture both shifts in vigor and cost–benefit choice as seen empirically with drug manipulations across species (<xref ref-type="bibr" rid="bib16">Cousins et al., 1996</xref>; <xref ref-type="bibr" rid="bib72">Salamone et al., 2005</xref>; <xref ref-type="bibr" rid="bib86">Treadway et al., 2012</xref>; <xref ref-type="bibr" rid="bib91">Westbrook et al., 2020</xref>) and more precise optogenetic manipulations of DA and activity of D1 and D2 MSNs (<xref ref-type="bibr" rid="bib19">Doi et al., 2020</xref>; <xref ref-type="bibr" rid="bib8">Bolkan et al., 2021</xref>; <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>; <xref ref-type="bibr" rid="bib83">Tai et al., 2012</xref>; <xref ref-type="bibr" rid="bib94">Yartsev et al., 2018</xref>). Notably, OpAL* suggests that in sparse reward environments, it is <italic>adaptive</italic> to lower dopaminergic levels and not merely avoiding action altogether (as in classical notions of the direct indirect pathways). Rather, lower dopamine helps to choose actions that minimize cost (by discriminating between D2 MSN populations). In physical effort decision tasks, DA depletion does not simply induce more noise or reduced effort overall, but selectively promotes actions that minimize effort when the benefits of exerting effort are relatively low (<xref ref-type="bibr" rid="bib16">Cousins et al., 1996</xref>). For example, while a healthy rat will choose to climb a barrier to obtain four pellets instead of selecting two pellets that do not require physical effort, a dopamine-depleted animal will opt for the two-pellet option. However, in the absence of the two-pellet option, both healthy and dopamine-depleted animals will select to climb the barrier to collect their reward. While OpAL* naturally accounts for such findings, other models often suggest that lowered DA levels would simply produce more randomness and imprecision, as captured by a reduced softmax gain (<xref ref-type="bibr" rid="bib22">FitzGerald et al., 2015</xref>; <xref ref-type="bibr" rid="bib14">Cinotti et al., 2019</xref>; <xref ref-type="bibr" rid="bib21">Eisenegger et al., 2014</xref>; <xref ref-type="bibr" rid="bib50">Lee et al., 2015</xref>). Importantly, empirical evidence for this reduced gain account in low DA situations focused exclusively on reward rich situations (i.e., available options were likely to be rewarding); in these cases, OpAL* also predicts more noise. But as noted above, low dopaminergic states may not always be maladaptive. Indeed, they may be useful in environments with sparse rewards, allowing an agent to adaptively navigate exploration and exploitation and to avoid the most costly options.</p><p>The work described here builds off a preliminary suggestion in <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref> that opponency in OpAL confers advantages over standard RL models across rich environments and lean environments. In particular, when parameters were optimized for each model, the optimal parameters for standard RL diverged across environments, whereas OpAL could maximize rewards across environments with a single set of parameters; biological agents have indeed demonstrated similar learning speeds between lean and rich environments, demonstrating such cross-environment flexibility (<xref ref-type="bibr" rid="bib37">Hamid et al., 2016</xref>). However, this previous work applied to a balanced OpAL model and did not consider how an agent might adaptively modulate dopaminergic state to differentially weigh costs vs. benefits of alternative decisions. Here, we showed that such advantages are robust across a wide range of parameters, that they are amplified in OpAL* by leveraging dynamic DA modulation, and that they grow with the complexity of the environment (number of alternative actions). Importantly, such benefits of OpAL* capitalize on the nonlinear and opponency convexity induced by Hebbian plasticity within D1 and D2 pathways (<xref ref-type="fig" rid="fig2">Figure 2</xref>).</p><p>These findings contrast with Q-learning agents and with other theoretical models of striatal opponency which omit the Hebbian term but leverage alternate nonlinearities so that D1 and D2 weights converge to the veridical benefits and costs of an action (<xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>). This result is somewhat counterintuitive: if an agent knows the actual costs and benefits of each action, they could simply choose the one that maximizes net return. Critically, however, the agents that based choice on expected values exhibited misestimation errors in those values due to delayed convergence, especially in environments with sparse reward and the agent has to select between multiple actions. As a result, the agent stochastically switches between actions until each of their benefits and costs (or Q values) are known, leading to reduced ‘action-gaps.’ Meanwhile, the actors of OpAL* discriminate between the optimal and suboptimal actions well before the critic converges, and thus can rapidly optimize the policy. This difference is related to the recent predominance of policy gradient methods over value-based algorithms in the deep RL literature, particularly in environments with sparse reward and large action spaces. Work has also shown that striatal signals conform more with policy update methods rather than action values (<xref ref-type="bibr" rid="bib51">Li and Daw, 2011</xref>). Notably, <xref ref-type="bibr" rid="bib31">G. Bellemare et al., 2015</xref> showed that large action gaps are helpful for mitigating against estimation errors in the critic in deep RL settings, implying that an OpAL* like approach might be useful in those contexts as well (but this remains to be tested).</p><p>Clearly there is also a normative component to an agent’s ability to properly estimate the true expected values (or costs and benefits) of its actions, which would be needed to more robustly exhibit transitive preferences between options that it has never confronted together. Nevertheless, empirically, violations of such transitive preferences are observed specifically when choosing between actions that had been experienced in the context of expected loss versus expected gains (<xref ref-type="bibr" rid="bib35">Gold et al., 2012</xref>; <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>; <xref ref-type="bibr" rid="bib32">Geana et al., 2022</xref>). Our model captured this pattern because its policy had been optimized to prefer a frequent loss avoider in the loss context, and to avoid an infrequent winner in a gain context (thus our account is similar in spirit to the model proposed by <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>, who used a Q-learning framework but wherein values are learned not in absolute terms, but relative to that of the other options). Finally, as noted above, while we do not leverage this mechanism, in principle an agent could combine the advantages of both frameworks by using OpAL* actors to optimize the policy during learning but then use the critic’s Q values, once converged to select actions based on expected values. Such a pattern would be expected in hybrid Q-learning/actor-critic frameworks (<xref ref-type="bibr" rid="bib35">Gold et al., 2012</xref>; <xref ref-type="bibr" rid="bib32">Geana et al., 2022</xref>), and would naturally arise in an OpAL* agent that allowed its actor weights to decay (i.e., without annealing). Future research should thus test whether transitive violations such as those described by <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref> would continue to be observed had the participants been given more extended training.</p><p>It is notable that the advantages exhibited by OpAL* depended on the nonlinear Hebbian mechanism. While the Hebbian term was originally motivated by the biology of three-factor plasticity as implemented in the neural network version, it is also needed to capture findings in which D2 MSNs become increasingly potentiated as a result of pathological DA depletion or DA blockade, leading to aberrant behavioral learning and progression of Parkinsonism (<xref ref-type="bibr" rid="bib92">Wiecki et al., 2009</xref>; <xref ref-type="bibr" rid="bib6">Beeler et al., 2012</xref>). Ironically, it is this same Hebbian-induced nonlinearity that affords adaptive performance in OpAL* when DA is not depleted or manipulated exogenously. As shown in the ‘Mechanism’ section, nonlinear accumulation allows the actor weight updates to be more sensitive to the probabilistic history of outcomes, preventing the agent from switching back to suboptimal actions. Finally, this adaptive role for activity-dependent Hebbian plasticity beyond standard learning algorithms is complementary to recent observations that such mechanisms can be leveraged to improve beyond gradient descent in neural networks (<xref ref-type="bibr" rid="bib75">Scott and Frank, 2021</xref>). While the computations are leveraged for different purposes (roughly, choice vs. credit assignment) and in different architectures, both findings accord with the notion that mechanisms typically thought to merely approximate adaptive functions inspired by artificial intelligence may in fact confer benefits for biological agents.</p><p>Lastly, while many studies have documented <italic>that</italic> DA manipulations affect risky and effort-based decision-making across species, our results offer a normative explanation for such findings. In this perspective, the brain treats increases or decreases in dopamine as signaling presence in a richer or leaner state. Changes in behavior reflect an adaption to this perceived, artificial environmental change. Hence, a dopamine-depleted animal (or increased activity of D2 MSNs in <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>) would focus on costs of actions, whereas dopamine increases would increase attractiveness of risky actions (<xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>). We reasoned that the well-known impact of exogenous DA modulation on risky decision-making (<xref ref-type="bibr" rid="bib80">St Onge and Floresco, 2009</xref>; <xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>; <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>) may be a by-product of this endogenous adaptive mechanism, showing that OpAL* can be used to modulate appropriately when it is worth taking a risk (<xref ref-type="fig" rid="fig7">Figure 7</xref>). We then demonstrated how behavioral effects of D2-receptor activity and manipulation (<xref ref-type="bibr" rid="bib96">Zalocusky et al., 2016</xref>) reflect unique predictions of OpAL*, including outcome-dependent risk-avoidance paired with increase of D2 activity following a loss (<xref ref-type="fig" rid="fig10">Figure 10A–D</xref>). In conjunction, optogenetic stimulation of D2-expressing neurons induced decrease in risky choice in risk-seeking rodents in line with OpAL* predictions (<xref ref-type="fig" rid="fig10">Figure 10E and F</xref>). Furthermore, we showed that OpAL* can be used to capture changes in risk-taking by dopamine-enhancing medication in healthy human participants (<xref ref-type="fig" rid="fig11">Figure 11A and B</xref>). Our simulations highlighted how individual changes in risk preference may emerge from OpAL*’s adaptive mechanism. While some studies have shown that in unique circumstances increased dopamine may result in preference for a low-risk but low-reward option (<xref ref-type="bibr" rid="bib56">Mikhael and Gershman, 2022</xref>; <xref ref-type="bibr" rid="bib81">St Onge et al., 2010</xref>), these results rely on sequential effects but nonetheless they may be explainable by OpAL*’s sensitivity to environmental reward statistics. Furthermore, we focused on adaptive decision-making on the time scale of a single task in this article, and it is plausible that such an adaptive mechanism may account for larger individual differences across longer time horizons. For example, increased risk-taking has been well documented in adolescents and some evidence suggests that dopaminergic levels may peak during adolescents, attributing to this trend (see <xref ref-type="bibr" rid="bib88">Wahlstrom et al., 2010</xref> for a full review). Speculatively, this may itself be an adaptive mechanism, where higher DA may allow more emphasis on potential benefits of risky but developmentally beneficial actions, such as exploring outside of parent’s home to find a mate.</p><p>OpAL*’s separation and selective amplification of <inline-formula><mml:math id="inf175"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf176"><mml:mi>N</mml:mi></mml:math></inline-formula> actors also is reminiscent of efficient coding principles in sensory processing, which theorizes that neurons maximize information capacity by minimizing redundancy in neural representations (<xref ref-type="bibr" rid="bib4">Barlow, 2012</xref>; <xref ref-type="bibr" rid="bib49">Laughlin, 1981</xref>; <xref ref-type="bibr" rid="bib13">Chalk et al., 2018</xref>). Efficient coding also suggests that resources should be reallocated according to features in an environment which occur more frequently (<xref ref-type="bibr" rid="bib77">Simoncelli and Olshausen, 2001</xref>). In OpAL*, positive prediction errors are more abundant than negative in reward-rich environments and the <inline-formula><mml:math id="inf177"><mml:mi>G</mml:mi></mml:math></inline-formula> actor strengthens disproportionately as this asymmetry grows. Conversely, negative prediction errors are more frequent in reward-lean environments and the <inline-formula><mml:math id="inf178"><mml:mi>N</mml:mi></mml:math></inline-formula> actor specializes in this asymmetry. Changes in dopaminergic state, which modifies the contribution of <inline-formula><mml:math id="inf179"><mml:mi>G</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf180"><mml:mi>N</mml:mi></mml:math></inline-formula> actors, therefore reallocate decision-making resources according to the relative frequency of positive and negative prediction errors in the environment. Recent behavioral work has applied an efficient coding framework to risky choice paradigms, showing participants are riskier in environments which have an increased frequency of large gamble payoffs (<xref ref-type="bibr" rid="bib30">Frydman and Jin, 2021</xref>). Our model provides a mechanistic account of such findings that generalizes to broader behavioral implications. Moreover, while the authors did not test this pattern, OpAL* predicts that if common trials were administered to include unfavorable gambles (gambles whose expected values are less than a certain option), people would more reliably select the certain outcome in the lean environment.</p><sec id="s3-1"><title>Limitations and future directions</title><p>A limitation of the DA modulation mechanism is that its performance advantages depend on relatively accurate estimates of environmental richness. Indeed, performance can suffer with incorrect estimation of the environment richness (<xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>). Thus, it is essential in OpAL* that DA modulation is dynamic across trials so as to reflect sufficient reward history before modulating opponency. As such, while we systematically characterized the advantage of dynamic DA modulation in OpAL* over the balanced OpAL model (<inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) across environments, this advantage should hold over any OpAL model with a fixed asymmetry (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). For robust advantages, the critic estimation of environmental richness must be relatively confident before modulating DA. In the simulations presented, we utilized a Bayesian meta-critic to explicitly track such uncertainty, and only increasing or decreasing DA when the estimate was sufficiently confident. Interestingly, this mechanism provides an intermediate strategy between directed and random exploration (<xref ref-type="bibr" rid="bib93">Wilson et al., 2014</xref>), but at the level of actor (rather than action) selection. In OpAL*, such a strategy amounts to random exploration across both actors until the critic uncertainty is sufficiently reduced, at which point OpAL* exploits the actor most specialized to the task. Future directions will investigate how this strategy may itself be adapted as a function of the environment statistics and may offer potential predictions for understanding individual differences and/or clinical conditions. For example, given inappropriate dopaminergic state is most detrimental to sparse reward environments, an agent which prioritizes avoidance of costs such as those prevalent in sparse reward environments (such as in OCD or in early life stress) may benefit from more caution before changing dopaminergic state (i.e., have a higher threshold for DA modulation and exploiting knowledge) or take longer to integrate information to increase precision of estimates (i.e., lower learning rate).</p><p>There are several future directions to this work. For example, while OpAL* optimizes a single DA signal toward the actor most specialized to rich or lean environments, recent work also suggests that DA signals are not uniform across striatum (<xref ref-type="bibr" rid="bib38">Hamid et al., 2021</xref>). Indeed, this work showed that DA signals can be tailored to striatal subregions specialized for a given task, keeping with a ‘mixture of experts’ model to support credit assignment. Future work should thus consider how the DA signals can be simultaneously adapted to the benefits and costs of alternative actions within subregions that are most suited to govern behavior. Moreover, while we addressed the impact of complexity within the action space, an alternative notion of complexity and sparsity yet to be explored is the length of sequential actions needed to achieve reward. Increasing the distance from initial choice to reward, a problem faced by modern deep RL algorithms (<xref ref-type="bibr" rid="bib39">Hare, 2019</xref>), may also benefit from integrating OpAL*-like opponency and choice modulation into larger architectures, given the improved action gaps that facilitate performance in such settings (<xref ref-type="bibr" rid="bib31">G. Bellemare et al., 2015</xref>). Finally, while our work focuses on asymmetries afforded in the choice function, DA manipulations can also induce asymmetries in learning rates from positive and negative RPEs (<xref ref-type="bibr" rid="bib26">Frank et al., 2007a</xref>; <xref ref-type="bibr" rid="bib63">Niv et al., 2012</xref>; <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>), which can, under some circumstances, be dissociated from choice effects (<xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>). However, it is certainly possible that asymmetries in learning rates can also be optimized as a function of the environment. Indeed, larger learning rates for positive than negative RPEs are beneficial in lean environments (and vice versa) by amplifying the less frequent signal (Cazé and <xref ref-type="bibr" rid="bib12">Cazé and van der Meer, 2013</xref>). Such effects are not mutually exclusive with those described here, but note that they do not address the issue highlighted above with respect to exploration exploitation dilemmas that arise in lean environments, and do not capture the various findings (reviewed above) in which DA manipulations affect performance and choice in the absence of outcomes.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Parameter grid search</title><p>For OpAL* variants, we ran a grid sweep over a parameter space with <inline-formula><mml:math id="inf182"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mn>.025</mml:mn><mml:mo>,</mml:mo><mml:mn>.05</mml:mn><mml:mo>,</mml:mo><mml:mn>.1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf183"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>.05</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with step size of 0.05 and <inline-formula><mml:math id="inf184"><mml:mrow><mml:mi>β</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with step size of 0.5. To equate the model complexity, the annealing parameter (<inline-formula><mml:math id="inf185"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>), the strength of modulation (<inline-formula><mml:math id="inf186"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>), and the confidence needed before modulation (<inline-formula><mml:math id="inf187"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></inline-formula>) were fixed to the specified values across models. These were determined by coarser grid searches of the parameter space for reasonable performance of control models. For each parameter combination, we matched the starting random seed for three models – OpAL*, OpAL* with <inline-formula><mml:math id="inf188"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (OpAL+), and OpAL* with no three-factor Hebbian term (No Hebb). For each parameter setting for each model type, we calculated the average softmax probability of selecting the best option (80% in rich environments or 30% in lean environments) across 1000 simulations for 1000 trials. We then took the AUC of this averaged learning curve for different time horizons (100, 250, 500, and 1000 trials) and took the difference between the AUCs of OpAL* and OpAL* with <inline-formula><mml:math id="inf189"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> or OpAL* No Hebb of matched parameters. We conducted a one-sample <italic>t</italic>-test on these differences, where a difference of zero was the null hypothesis.</p><p>We conducted the same set of analyses with the learning curves for the actual rewards received and received mirror results. We therefore only report the analysis according to the probability of selecting an action, which is a finer grain measure of average performance.</p><p>For Q-learner, we ran a grid sweep over a parameter space with learning rate <inline-formula><mml:math id="inf190"><mml:mrow><mml:mi>α</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>.05</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with step size of 0.05 and softmax temperature <inline-formula><mml:math id="inf191"><mml:mrow><mml:mi>β</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with step size of 2.</p><p>For UCB, the exploration parameter <italic>c</italic> (see next section) was searched over the space <inline-formula><mml:math id="inf192"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with increments of .01.</p></sec><sec id="s4-2"><title>Upper Confidence Bound</title><p>To implement UCB (<xref ref-type="bibr" rid="bib82">Sutton and Barto, 2018</xref>; <xref ref-type="bibr" rid="bib3">Auer et al., 2002</xref>), rather than calculating a Q-value incrementally, we used the sample mean of receiving reward for each action. The algorithm began by selecting each action once in a random order, thus amounting to full information for one trial of each action. The agent then greedily selected the action <italic>a</italic> with the largest mean combined with an exploration factor, determined by the hyperparameter <italic>c</italic>. In order to calculated the choice <inline-formula><mml:math id="inf193"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> for each trial, <italic>t</italic>, we used the following:<disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>==</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="2em"/><mml:mtext>Number of times action {a} was selected</mml:mtext></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ30"><mml:math id="m30"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mn mathvariant="double-struck">1</mml:mn></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>==</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math></disp-formula><disp-formula id="equ31"><mml:math id="m31"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mspace width="thinmathspace"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:munder><mml:mo>⁡</mml:mo><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">[</mml:mo></mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em">]</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>During optimization, the hyperparameter, <italic>c</italic>, was optimized across environments using a grid search where <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with increments of 0.01.</p></sec><sec id="s4-3"><title>Möller and Bogacz 2019 model</title><p>The Möller and Bogacz model (<xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>) offers another computational account of how benefits and costs may be encoded in the D1/D2 striatal subpopulations. First note that this model defines benefits and costs as the <italic>absolute magnitude</italic> of positive and negative outcome for each action. In contrast, benefits and costs as represented in OpAL/OpAL* are relative metrics (accordingly, for gamble simulations, an outcome of 0 is encoded as a cost relative to the sure thing, similar to other models of reference dependence; see also simulations of <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref> above in the case of full information). Second, both OpAL and Möller and Bogacz’s model have nonlinearities in the learning rule (otherwise, as seen in our No Hebb model, the two pathways are redundant). However, rather than using Hebbian plasticity, Möller and Bogacz transform the prediction error itself (such that the impact of negative prediction errors is smaller in the G actor, and vice versa, parameterized by <inline-formula><mml:math id="inf195"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>) and impose a weak decay (<inline-formula><mml:math id="inf196"><mml:mi>λ</mml:mi></mml:math></inline-formula>), as expressed below. Similar to OpAL, dopamine levels, D, modulate the contribution of D1/D2 to choice.<disp-formula id="equ32"><label>(26)</label><mml:math id="m32"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>ϵ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ33"><label>(27)</label><mml:math id="m33"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ34"><label>(28)</label><mml:math id="m34"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>ϵ</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mml:mtr><mml:mtd><mml:mi>δ</mml:mi><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ϵ</mml:mi><mml:mi>δ</mml:mi><mml:mspace width="2em"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>δ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ35"><label>(29)</label><mml:math id="m35"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="equ36"><label>(30)</label><mml:math id="m36"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>.5</mml:mn></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>This learning rule allows the G and N weights to converge to the expected payoffs and costs of alternative actions with sufficient learning. However, as noted above and shown in <xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref>, just like in Q-learning, convergence can be impeded in lean environments with stochastic action selection, leading to slowed acquisition of an effective policy.</p><p>To select between actions, we used a softmax policy. While <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> explicitly do not use a softmax function in their simulations, they did so only because they were simulating behaviors in which an action may not be selected at all (i.e., they did not subject their agent to choose between different actions). In contrast, for all of our experiments, our agents must select an action each trial. We therefore generate a choice as follows using the softmax function by using the value of the action, <inline-formula><mml:math id="inf197"><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig8s3">Figure 8—figure supplement 3</xref> uses parameters reported in Figure 5c of <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>, where the authors demonstrate that G and N weights should appropriately converge in a simulation analogous to a one-armed bandit with reward probability of 50%. We selected beta using a grid search from 10 to 100 in steps of 10 and found comparable results.</p><p>We also explored optimizing the Möller et al. model over all four free parameters – <inline-formula><mml:math id="inf198"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> – for cross-environment performance. Parameters were found using scipy.optimize.differential_evolution routine, optimizing for the best average softmax probability selecting the best option over 1000 simulations across rich and lean. For convergence to expected payoffs and costs, <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> demonstrate approximate constraints and relationships that the parameters should adhere to, specifically the decay parameter (<inline-formula><mml:math id="inf199"><mml:mi>λ</mml:mi></mml:math></inline-formula>) must be close to 0 and smaller than the learning rate and the nonlinearity parameter (<inline-formula><mml:math id="inf200"><mml:mi>ϵ</mml:mi></mml:math></inline-formula>) must be approximately 1. We found for optimization over shorter time horizons (e.g., less than 250 trials), the optimized value for epsilon was closer to zero than 1 (&lt;0.1), but for 500 trials its estimated value was more appropriate (&gt;0.9) though the relative relationship of lambda and alpha did not hold. Nonetheless, as in Q-learning, the action gap was consistently divergent between the rich and lean environments in these different iterations.<disp-formula id="equ37"><label>(31)</label><mml:math id="m37"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="equ38"><label>(32)</label><mml:math id="m38"><mml:mtable columnspacing="5pt" displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mstyle displaystyle="false"><mml:msub><mml:mo largeop="true" symmetric="true">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>⁢</mml:mo><mml:mi>V</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:math></disp-formula></p></sec><sec id="s4-4"><title>Code</title><p>Code repository available at <ext-link ext-link-type="uri" xlink:href="https://github.com/amjaskir/opal-star">https://github.com/amjaskir/opal-star</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib44">Jaskir, 2023</xref>).</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn><fn fn-type="COI-statement" id="conf2"><p>Senior editor, eLife</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Software, Formal analysis, Validation, Investigation, Visualization, Writing – original draft, Writing – review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Formal analysis, Supervision, Funding acquisition, Validation, Project administration, Writing – review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-85107-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>The current manuscript is a computational study, so no data have been generated for this manuscript. Simulation code is available on the authors' GitHub repositories <ext-link ext-link-type="uri" xlink:href="https://github.com/amjaskir/opal-star">https://github.com/amjaskir/opal-star</ext-link>, (copy archived at <xref ref-type="bibr" rid="bib44">Jaskir, 2023</xref>).</p></sec><ack id="ack"><title>Acknowledgements</title><p>AJ was partly supported by NIMH training grant T32MH115895 (PIs: Frank, Badre, Moore). The project was also supported by NIMH R01 MH084840-08A1 and NIMH P50 MH119467-01. Computing hardware was supported by NIH Office of the Director grant S10OD025181. We thank Pete Hitchock and Lucas Lehnert for comments.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adrover</surname><given-names>MF</given-names></name><name><surname>Shin</surname><given-names>JH</given-names></name><name><surname>Quiroz</surname><given-names>C</given-names></name><name><surname>Ferré</surname><given-names>S</given-names></name><name><surname>Lemos</surname><given-names>JC</given-names></name><name><surname>Alvarez</surname><given-names>VA</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Prefrontal cortex-driven dopamine signals in the striatum show unique spatial and pharmacological properties</article-title><source>The Journal of Neuroscience</source><volume>40</volume><fpage>7510</fpage><lpage>7522</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1327-20.2020</pub-id><pub-id pub-id-type="pmid">32859717</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashby</surname><given-names>FG</given-names></name><name><surname>Ennis</surname><given-names>JM</given-names></name><name><surname>Spiering</surname><given-names>BJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>A neurobiological theory of automaticity in perceptual categorization</article-title><source>Psychological Review</source><volume>114</volume><fpage>632</fpage><lpage>656</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.114.3.632</pub-id><pub-id pub-id-type="pmid">17638499</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Auer</surname><given-names>P</given-names></name><name><surname>Cesa-Bianchi</surname><given-names>N</given-names></name><name><surname>Fischer</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Finite-time analysis of the multiarmed bandit problem</article-title><source>Machine Learning</source><volume>47</volume><fpage>235</fpage><lpage>256</lpage><pub-id pub-id-type="doi">10.1023/A:1013689704352</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Barlow</surname><given-names>HB</given-names></name></person-group><year iso-8601-date="2012">2012</year><chapter-title>Possible principles underlying the transformations of sensory messages</chapter-title><person-group person-group-type="editor"><name><surname>Rosenblith</surname><given-names>WA</given-names></name></person-group><source>Sensory Communication</source><publisher-name>The MIT Press</publisher-name><fpage>216</fpage><lpage>234</lpage></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bavard</surname><given-names>S</given-names></name><name><surname>Lebreton</surname><given-names>M</given-names></name><name><surname>Khamassi</surname><given-names>M</given-names></name><name><surname>Coricelli</surname><given-names>G</given-names></name><name><surname>Palminteri</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Reference-point centering and range-adaptation enhance human reinforcement learning at the cost of irrational preferences</article-title><source>Nature Communications</source><volume>9</volume><elocation-id>4503</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-018-06781-2</pub-id><pub-id pub-id-type="pmid">30374019</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beeler</surname><given-names>JA</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>McDaid</surname><given-names>J</given-names></name><name><surname>Alexander</surname><given-names>E</given-names></name><name><surname>Turkson</surname><given-names>S</given-names></name><name><surname>Bernardez Sarria</surname><given-names>MS</given-names></name><name><surname>McGehee</surname><given-names>DS</given-names></name><name><surname>Zhuang</surname><given-names>X</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>A role for dopamine-mediated learning in the pathophysiology and treatment of Parkinson’s disease</article-title><source>Cell Reports</source><volume>2</volume><fpage>1747</fpage><lpage>1761</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2012.11.014</pub-id><pub-id pub-id-type="pmid">23246005</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bengio</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Practical Recommendations for Gradient-Based Training of Deep Architectures</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1206.5533">https://arxiv.org/abs/1206.5533</ext-link></element-citation></ref><ref id="bib8"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bolkan</surname><given-names>SS</given-names></name><name><surname>Stone</surname><given-names>IR</given-names></name><name><surname>Pinto</surname><given-names>L</given-names></name><name><surname>Ashwood</surname><given-names>ZC</given-names></name><name><surname>Iravedra Garcia</surname><given-names>JM</given-names></name><name><surname>Herman</surname><given-names>AL</given-names></name><name><surname>Singh</surname><given-names>P</given-names></name><name><surname>Bandi</surname><given-names>A</given-names></name><name><surname>Cox</surname><given-names>J</given-names></name><name><surname>Zimmerman</surname><given-names>CA</given-names></name><name><surname>Cho</surname><given-names>JR</given-names></name><name><surname>Engelhard</surname><given-names>B</given-names></name><name><surname>Koay</surname><given-names>SA</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Witten</surname><given-names>IB</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Strong and Opponent Contributions of Dorsomedial Striatal Pathways to Behavior Depends on Cognitive Demands and Task Strategy</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.07.23.453573</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolkan</surname><given-names>SS</given-names></name><name><surname>Stone</surname><given-names>IR</given-names></name><name><surname>Pinto</surname><given-names>L</given-names></name><name><surname>Ashwood</surname><given-names>ZC</given-names></name><name><surname>Iravedra Garcia</surname><given-names>JM</given-names></name><name><surname>Herman</surname><given-names>AL</given-names></name><name><surname>Singh</surname><given-names>P</given-names></name><name><surname>Bandi</surname><given-names>A</given-names></name><name><surname>Cox</surname><given-names>J</given-names></name><name><surname>Zimmerman</surname><given-names>CA</given-names></name><name><surname>Cho</surname><given-names>JR</given-names></name><name><surname>Engelhard</surname><given-names>B</given-names></name><name><surname>Pillow</surname><given-names>JW</given-names></name><name><surname>Witten</surname><given-names>IB</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Opponent control of behavior by dorsomedial striatal pathways depends on task demands and internal state</article-title><source>Nature Neuroscience</source><volume>25</volume><fpage>345</fpage><lpage>357</lpage><pub-id pub-id-type="doi">10.1038/s41593-022-01021-9</pub-id><pub-id pub-id-type="pmid">35260863</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Burke</surname><given-names>DA</given-names></name><name><surname>Rotstein</surname><given-names>HG</given-names></name><name><surname>Alvarez</surname><given-names>VA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Striatal local circuitry: a new framework for lateral inhibition</article-title><source>Neuron</source><volume>96</volume><fpage>267</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2017.09.019</pub-id><pub-id pub-id-type="pmid">29024654</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Castro</surname><given-names>DD</given-names></name><name><surname>Meir</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>A convergent online single time scale actor critic algorithm</article-title><source>The Journal of Machine Learning Research</source><volume>11</volume><fpage>367</fpage><lpage>410</lpage></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cazé</surname><given-names>RD</given-names></name><name><surname>van der Meer</surname><given-names>MAA</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Adaptive properties of differential learning rates for positive and negative outcomes</article-title><source>Biological Cybernetics</source><volume>107</volume><fpage>711</fpage><lpage>719</lpage><pub-id pub-id-type="doi">10.1007/s00422-013-0571-5</pub-id><pub-id pub-id-type="pmid">24085507</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chalk</surname><given-names>M</given-names></name><name><surname>Marre</surname><given-names>O</given-names></name><name><surname>Tkačik</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Toward a unified theory of efficient, predictive, and sparse coding</article-title><source>PNAS</source><volume>115</volume><fpage>186</fpage><lpage>191</lpage><pub-id pub-id-type="doi">10.1073/pnas.1711114115</pub-id><pub-id pub-id-type="pmid">29259111</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cinotti</surname><given-names>F</given-names></name><name><surname>Fresno</surname><given-names>V</given-names></name><name><surname>Aklil</surname><given-names>N</given-names></name><name><surname>Coutureau</surname><given-names>E</given-names></name><name><surname>Girard</surname><given-names>B</given-names></name><name><surname>Marchand</surname><given-names>AR</given-names></name><name><surname>Khamassi</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dopamine blockade impairs the exploration-exploitation trade-off in rats</article-title><source>Scientific Reports</source><volume>9</volume><elocation-id>6770</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-019-43245-z</pub-id><pub-id pub-id-type="pmid">31043685</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>AGE</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Opponent actor learning (opal): modeling interactive effects of striatal dopamine on reinforcement learning and choice incentive</article-title><source>Psychological Review</source><volume>121</volume><fpage>337</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1037/a0037015</pub-id><pub-id pub-id-type="pmid">25090423</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cousins</surname><given-names>MS</given-names></name><name><surname>Atherton</surname><given-names>A</given-names></name><name><surname>Turner</surname><given-names>L</given-names></name><name><surname>Salamone</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>Nucleus accumbens dopamine depletions alter relative response allocation in a T-maze cost/benefit task</article-title><source>Behavioural Brain Research</source><volume>74</volume><fpage>189</fpage><lpage>197</lpage><pub-id pub-id-type="doi">10.1016/0166-4328(95)00151-4</pub-id><pub-id pub-id-type="pmid">8851929</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Darken</surname><given-names>C</given-names></name><name><surname>Moody</surname><given-names>J</given-names></name></person-group><year iso-8601-date="1990">1990</year><article-title>Note on learning rate schedules for stochastic optimization</article-title><conf-name>In Advances in Neural Information Processing Systems</conf-name></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Balleine</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Reward, motivation, and reinforcement learning</article-title><source>Neuron</source><volume>36</volume><fpage>285</fpage><lpage>298</lpage><pub-id pub-id-type="doi">10.1016/s0896-6273(02)00963-7</pub-id><pub-id pub-id-type="pmid">12383782</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doi</surname><given-names>T</given-names></name><name><surname>Fan</surname><given-names>Y</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name><name><surname>Ding</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>The caudate nucleus contributes causally to decisions that balance reward and uncertain visual information</article-title><source>eLife</source><volume>9</volume><elocation-id>e56694</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.56694</pub-id><pub-id pub-id-type="pmid">32568068</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunovan</surname><given-names>K</given-names></name><name><surname>Verstynen</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Believer-skeptic meets actor-critic: rethinking the role of basal ganglia pathways during decision-making and reinforcement learning</article-title><source>Frontiers in Neuroscience</source><volume>10</volume><elocation-id>106</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2016.00106</pub-id><pub-id pub-id-type="pmid">27047328</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisenegger</surname><given-names>C</given-names></name><name><surname>Naef</surname><given-names>M</given-names></name><name><surname>Linssen</surname><given-names>A</given-names></name><name><surname>Clark</surname><given-names>L</given-names></name><name><surname>Gandamaneni</surname><given-names>PK</given-names></name><name><surname>Müller</surname><given-names>U</given-names></name><name><surname>Robbins</surname><given-names>TW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Role of dopamine D2 receptors in human reinforcement learning</article-title><source>Neuropsychopharmacology</source><volume>39</volume><fpage>2366</fpage><lpage>2375</lpage><pub-id pub-id-type="doi">10.1038/npp.2014.84</pub-id><pub-id pub-id-type="pmid">24713613</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>FitzGerald</surname><given-names>THB</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Friston</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dopamine, reward learning, and active inference</article-title><source>Frontiers in Computational Neuroscience</source><volume>9</volume><elocation-id>136</elocation-id><pub-id pub-id-type="doi">10.3389/fncom.2015.00136</pub-id><pub-id pub-id-type="pmid">26581305</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Seeberger</surname><given-names>LC</given-names></name><name><surname>O’reilly</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>By carrot or by stick: cognitive reinforcement learning in parkinsonism</article-title><source>Science</source><volume>306</volume><fpage>1940</fpage><lpage>1943</lpage><pub-id pub-id-type="doi">10.1126/science.1102941</pub-id><pub-id pub-id-type="pmid">15528409</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Dynamic dopamine modulation in the basal ganglia: a neurocomputational account of cognitive deficits in medicated and nonmedicated parkinsonism</article-title><source>Journal of Cognitive Neuroscience</source><volume>17</volume><fpage>51</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1162/0898929052880093</pub-id><pub-id pub-id-type="pmid">15701239</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Claus</surname><given-names>ED</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Anatomy of a decision: striato-orbitofrontal interactions in reinforcement learning, decision making, and reversal</article-title><source>Psychological Review</source><volume>113</volume><fpage>300</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1037/0033-295X.113.2.300</pub-id><pub-id pub-id-type="pmid">16637763</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Moustafa</surname><given-names>AA</given-names></name><name><surname>Haughey</surname><given-names>HM</given-names></name><name><surname>Curran</surname><given-names>T</given-names></name><name><surname>Hutchison</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2007">2007a</year><article-title>Genetic triple dissociation reveals multiple roles for dopamine in reinforcement learning</article-title><source>PNAS</source><volume>104</volume><fpage>16311</fpage><lpage>16316</lpage><pub-id pub-id-type="doi">10.1073/pnas.0706111104</pub-id><pub-id pub-id-type="pmid">17913879</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Samanta</surname><given-names>J</given-names></name><name><surname>Moustafa</surname><given-names>AA</given-names></name><name><surname>Sherman</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2007">2007b</year><article-title>Hold your horses: impulsivity, deep brain stimulation, and medication in parkinsonism</article-title><source>Science</source><volume>318</volume><fpage>1309</fpage><lpage>1312</lpage><pub-id pub-id-type="doi">10.1126/science.1146157</pub-id><pub-id pub-id-type="pmid">17962524</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franklin</surname><given-names>NT</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A cholinergic feedback circuit to regulate striatal population uncertainty and optimize reinforcement learning</article-title><source>eLife</source><volume>4</volume><elocation-id>e12029</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.12029</pub-id><pub-id pub-id-type="pmid">26705698</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frémaux</surname><given-names>N</given-names></name><name><surname>Gerstner</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Neuromodulated spike-timing-dependent plasticity, and theory of three-factor learning rules</article-title><source>Frontiers in Neural Circuits</source><volume>9</volume><elocation-id>85</elocation-id><pub-id pub-id-type="doi">10.3389/fncir.2015.00085</pub-id><pub-id pub-id-type="pmid">26834568</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frydman</surname><given-names>C</given-names></name><name><surname>Jin</surname><given-names>LJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Efficient coding and risky choice</article-title><source>The Quarterly Journal of Economics</source><volume>137</volume><fpage>161</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1093/qje/qjab031</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>G. Bellemare</surname><given-names>M</given-names></name><name><surname>Ostrovski</surname><given-names>G</given-names></name><name><surname>Guez</surname><given-names>A</given-names></name><name><surname>Thomas</surname><given-names>P</given-names></name><name><surname>Munos</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Increasing the action gap: new operators for reinforcement learning</article-title><conf-name>Proceedings of the AAAI Conference on Artificial Intelligence</conf-name><pub-id pub-id-type="doi">10.1609/aaai.v30i1.10303</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geana</surname><given-names>A</given-names></name><name><surname>Barch</surname><given-names>DM</given-names></name><name><surname>Gold</surname><given-names>JM</given-names></name><name><surname>Carter</surname><given-names>CS</given-names></name><name><surname>MacDonald</surname><given-names>AW</given-names></name><name><surname>Ragland</surname><given-names>JD</given-names></name><name><surname>Silverstein</surname><given-names>SM</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Using computational modeling to capture schizophrenia-specific reinforcement learning differences and their implications on patient classification</article-title><source>Biological Psychiatry. Cognitive Neuroscience and Neuroimaging</source><volume>7</volume><fpage>1035</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1016/j.bpsc.2021.03.017</pub-id><pub-id pub-id-type="pmid">33878489</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerfen</surname><given-names>CR</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>The neostriatal mosaic: multiple levels of compartmental organization</article-title><source>Trends in Neurosciences</source><volume>15</volume><fpage>133</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1016/0166-2236(92)90355-c</pub-id><pub-id pub-id-type="pmid">1374971</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershman</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deconstructing the human algorithms for exploration</article-title><source>Cognition</source><volume>173</volume><fpage>34</fpage><lpage>42</lpage><pub-id pub-id-type="doi">10.1016/j.cognition.2017.12.014</pub-id><pub-id pub-id-type="pmid">29289795</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gold</surname><given-names>JM</given-names></name><name><surname>Waltz</surname><given-names>JA</given-names></name><name><surname>Matveeva</surname><given-names>TM</given-names></name><name><surname>Kasanova</surname><given-names>Z</given-names></name><name><surname>Strauss</surname><given-names>GP</given-names></name><name><surname>Herbener</surname><given-names>ES</given-names></name><name><surname>Collins</surname><given-names>AGE</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Negative symptoms and the failure to represent the expected reward value of actions: behavioral and computational modeling evidence</article-title><source>Archives of General Psychiatry</source><volume>69</volume><fpage>129</fpage><lpage>138</lpage></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gurney</surname><given-names>KN</given-names></name><name><surname>Humphries</surname><given-names>MD</given-names></name><name><surname>Redgrave</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>A new framework for cortico-striatal plasticity: behavioural theory meets in vitro data at the reinforcement-action interface</article-title><source>PLOS Biology</source><volume>13</volume><elocation-id>e1002034</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1002034</pub-id><pub-id pub-id-type="pmid">25562526</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamid</surname><given-names>AA</given-names></name><name><surname>Pettibone</surname><given-names>JR</given-names></name><name><surname>Mabrouk</surname><given-names>OS</given-names></name><name><surname>Hetrick</surname><given-names>VL</given-names></name><name><surname>Schmidt</surname><given-names>R</given-names></name><name><surname>Vander Weele</surname><given-names>CM</given-names></name><name><surname>Kennedy</surname><given-names>RT</given-names></name><name><surname>Aragona</surname><given-names>BJ</given-names></name><name><surname>Berke</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Mesolimbic dopamine signals the value of work</article-title><source>Nature Neuroscience</source><volume>19</volume><fpage>117</fpage><lpage>126</lpage><pub-id pub-id-type="doi">10.1038/nn.4173</pub-id><pub-id pub-id-type="pmid">26595651</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamid</surname><given-names>AA</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Moore</surname><given-names>CI</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Wave-like dopamine dynamics as a mechanism for spatiotemporal credit assignment</article-title><source>Cell</source><volume>184</volume><fpage>2733</fpage><lpage>2749</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2021.03.046</pub-id><pub-id pub-id-type="pmid">33861952</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Hare</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dealing with Sparse Rewards in Reinforcement Learning</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1910.09281">https://arxiv.org/abs/1910.09281</ext-link></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harun</surname><given-names>R</given-names></name><name><surname>Hare</surname><given-names>KM</given-names></name><name><surname>Brough</surname><given-names>EM</given-names></name><name><surname>Munoz</surname><given-names>MJ</given-names></name><name><surname>Grassi</surname><given-names>CM</given-names></name><name><surname>Torres</surname><given-names>GE</given-names></name><name><surname>Grace</surname><given-names>AA</given-names></name><name><surname>Wagner</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Fast-Scan cyclic voltammetry demonstrates that L-dopa produces dose-dependent, regionally selective bimodal effects on striatal dopamine kinetics in vivo</article-title><source>Journal of Neurochemistry</source><volume>136</volume><fpage>1270</fpage><lpage>1283</lpage><pub-id pub-id-type="doi">10.1111/jnc.13444</pub-id><pub-id pub-id-type="pmid">26611352</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>MD</given-names></name><name><surname>Khamassi</surname><given-names>M</given-names></name><name><surname>Gurney</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dopaminergic control of the exploration-exploitation trade-off via the basal ganglia</article-title><source>Frontiers in Neuroscience</source><volume>6</volume><elocation-id>9</elocation-id><pub-id pub-id-type="doi">10.3389/fnins.2012.00009</pub-id><pub-id pub-id-type="pmid">22347155</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iglesias</surname><given-names>S</given-names></name><name><surname>Mathys</surname><given-names>C</given-names></name><name><surname>Brodersen</surname><given-names>KH</given-names></name><name><surname>Kasper</surname><given-names>L</given-names></name><name><surname>Piccirelli</surname><given-names>M</given-names></name><name><surname>den Ouden</surname><given-names>HEM</given-names></name><name><surname>Stephan</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hierarchical prediction errors in midbrain and basal forebrain during sensory learning</article-title><source>Neuron</source><volume>80</volume><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.009</pub-id><pub-id pub-id-type="pmid">24139048</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iino</surname><given-names>Y</given-names></name><name><surname>Sawada</surname><given-names>T</given-names></name><name><surname>Yamaguchi</surname><given-names>K</given-names></name><name><surname>Tajiri</surname><given-names>M</given-names></name><name><surname>Ishii</surname><given-names>S</given-names></name><name><surname>Kasai</surname><given-names>H</given-names></name><name><surname>Yagishita</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dopamine D2 receptors in discrimination learning and spine enlargement</article-title><source>Nature</source><volume>579</volume><fpage>555</fpage><lpage>560</lpage><pub-id pub-id-type="doi">10.1038/s41586-020-2115-1</pub-id><pub-id pub-id-type="pmid">32214250</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Jaskir</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2023">2023</year><data-title>Amjaskir/opal-star</data-title><version designator="swh:1:rev:cfe869a3e1e370e0d996b5f78c89b4f8550fe475">swh:1:rev:cfe869a3e1e370e0d996b5f78c89b4f8550fe475</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:524faa1378ea1dd36fed496c32ae5f85fc80145b;origin=https://github.com/amjaskir/opal-star;visit=swh:1:snp:cf742390c30c2af3f02a0d1bac6e9d169ee9f6fd;anchor=swh:1:rev:cfe869a3e1e370e0d996b5f78c89b4f8550fe475">https://archive.softwareheritage.org/swh:1:dir:524faa1378ea1dd36fed496c32ae5f85fc80145b;origin=https://github.com/amjaskir/opal-star;visit=swh:1:snp:cf742390c30c2af3f02a0d1bac6e9d169ee9f6fd;anchor=swh:1:rev:cfe869a3e1e370e0d996b5f78c89b4f8550fe475</ext-link></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kahneman</surname><given-names>D</given-names></name><name><surname>Tversky</surname><given-names>A</given-names></name></person-group><year iso-8601-date="1979">1979</year><article-title>Prospect theory: an analysis of decision under risk</article-title><source>Econometrica</source><volume>47</volume><elocation-id>263</elocation-id><pub-id pub-id-type="doi">10.2307/1914185</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kepecs</surname><given-names>A</given-names></name><name><surname>Uchida</surname><given-names>N</given-names></name><name><surname>Zariwala</surname><given-names>HA</given-names></name><name><surname>Mainen</surname><given-names>ZF</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Neural correlates, computation and behavioural impact of decision confidence</article-title><source>Nature</source><volume>455</volume><fpage>227</fpage><lpage>231</lpage><pub-id pub-id-type="doi">10.1038/nature07200</pub-id><pub-id pub-id-type="pmid">18690210</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klein</surname><given-names>TA</given-names></name><name><surname>Ullsperger</surname><given-names>M</given-names></name><name><surname>Jocham</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Learning relative values in the striatum induces violations of normative decision making</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>16033</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms16033</pub-id><pub-id pub-id-type="pmid">28631734</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobza</surname><given-names>S</given-names></name><name><surname>Ferrea</surname><given-names>S</given-names></name><name><surname>Schnitzler</surname><given-names>A</given-names></name><name><surname>Pollok</surname><given-names>B</given-names></name><name><surname>Südmeyer</surname><given-names>M</given-names></name><name><surname>Bellebaum</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dissociation between active and observational learning from positive and negative feedback in parkinsonism</article-title><source>PLOS ONE</source><volume>7</volume><elocation-id>e50250</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0050250</pub-id><pub-id pub-id-type="pmid">23185586</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laughlin</surname><given-names>S</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>A simple coding procedure enhances a neuron’s information capacity</article-title><source>Zeitschrift Fur Naturforschung. Section C, Biosciences</source><volume>36</volume><fpage>910</fpage><lpage>912</lpage><pub-id pub-id-type="pmid">7303823</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>E</given-names></name><name><surname>Seo</surname><given-names>M</given-names></name><name><surname>Dal Monte</surname><given-names>O</given-names></name><name><surname>Averbeck</surname><given-names>BB</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Injection of a dopamine type 2 receptor antagonist into the dorsal striatum disrupts choices driven by previous outcomes, but not perceptual inference</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>6298</fpage><lpage>6306</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4561-14.2015</pub-id><pub-id pub-id-type="pmid">25904783</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Signals in human striatum are appropriate for policy update rather than value prediction</article-title><source>The Journal of Neuroscience</source><volume>31</volume><fpage>5504</fpage><lpage>5511</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6316-10.2011</pub-id><pub-id pub-id-type="pmid">21471387</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Deep Reinforcement Learning: An Overview</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1701.07274">https://arxiv.org/abs/1701.07274</ext-link></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maia</surname><given-names>TV</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An integrative perspective on the role of dopamine in schizophrenia</article-title><source>Biological Psychiatry</source><volume>81</volume><fpage>52</fpage><lpage>66</lpage><pub-id pub-id-type="doi">10.1016/j.biopsych.2016.05.021</pub-id><pub-id pub-id-type="pmid">27452791</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCoy</surname><given-names>B</given-names></name><name><surname>Jahfari</surname><given-names>S</given-names></name><name><surname>Engels</surname><given-names>G</given-names></name><name><surname>Knapen</surname><given-names>T</given-names></name><name><surname>Theeuwes</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dopaminergic medication reduces striatal sensitivity to negative outcomes in Parkinson’s disease</article-title><source>Brain</source><volume>142</volume><fpage>3605</fpage><lpage>3620</lpage><pub-id pub-id-type="doi">10.1093/brain/awz276</pub-id><pub-id pub-id-type="pmid">31603493</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mikhael</surname><given-names>JG</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Learning reward uncertainty in the basal ganglia</article-title><source>PLOS Computational Biology</source><volume>12</volume><elocation-id>e1005062</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005062</pub-id><pub-id pub-id-type="pmid">27589489</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mikhael</surname><given-names>JG</given-names></name><name><surname>Gershman</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Impulsivity and risk-seeking as Bayesian inference under dopaminergic control</article-title><source>Neuropsychopharmacology</source><volume>47</volume><fpage>465</fpage><lpage>476</lpage><pub-id pub-id-type="doi">10.1038/s41386-021-01125-z</pub-id><pub-id pub-id-type="pmid">34376813</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moeller</surname><given-names>M</given-names></name><name><surname>Grohn</surname><given-names>J</given-names></name><name><surname>Manohar</surname><given-names>S</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>An association between prediction errors and risk-seeking: theory and behavioral evidence</article-title><source>PLOS Computational Biology</source><volume>17</volume><elocation-id>e1009213</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1009213</pub-id><pub-id pub-id-type="pmid">34270552</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mohebi</surname><given-names>A</given-names></name><name><surname>Pettibone</surname><given-names>JR</given-names></name><name><surname>Hamid</surname><given-names>AA</given-names></name><name><surname>Wong</surname><given-names>JMT</given-names></name><name><surname>Vinson</surname><given-names>LT</given-names></name><name><surname>Patriarchi</surname><given-names>T</given-names></name><name><surname>Tian</surname><given-names>L</given-names></name><name><surname>Kennedy</surname><given-names>RT</given-names></name><name><surname>Berke</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Dissociable dopamine dynamics for learning and motivation</article-title><source>Nature</source><volume>570</volume><fpage>65</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1038/s41586-019-1235-y</pub-id><pub-id pub-id-type="pmid">31118513</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Möller</surname><given-names>M</given-names></name><name><surname>Bogacz</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Learning the payoffs and costs of actions</article-title><source>PLOS Computational Biology</source><volume>15</volume><elocation-id>e1006285</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1006285</pub-id><pub-id pub-id-type="pmid">30818357</pub-id></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montague</surname><given-names>PR</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A framework for mesencephalic dopamine systems based on predictive Hebbian learning</article-title><source>The Journal of Neuroscience</source><volume>16</volume><fpage>1936</fpage><lpage>1947</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.16-05-01936.1996</pub-id><pub-id pub-id-type="pmid">8774460</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname><given-names>MR</given-names></name><name><surname>Rumsey</surname><given-names>KM</given-names></name><name><surname>Wilson</surname><given-names>RC</given-names></name><name><surname>Parikh</surname><given-names>K</given-names></name><name><surname>Heasly</surname><given-names>B</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Rational regulation of learning dynamics by pupil-linked arousal systems</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1040</fpage><lpage>1046</lpage><pub-id pub-id-type="doi">10.1038/nn.3130</pub-id><pub-id pub-id-type="pmid">22660479</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niv</surname><given-names>Y.</given-names></name><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Joel</surname><given-names>D</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Tonic dopamine: opportunity costs and the control of response vigor</article-title><source>Psychopharmacology</source><volume>191</volume><fpage>507</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1007/s00213-006-0502-4</pub-id><pub-id pub-id-type="pmid">17031711</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Niv</surname><given-names>Yael</given-names></name><name><surname>Edlund</surname><given-names>JA</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>O’Doherty</surname><given-names>JP</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Neural prediction errors reveal a risk-sensitive reinforcement-learning process in the human brain</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>551</fpage><lpage>562</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5498-10.2012</pub-id><pub-id pub-id-type="pmid">22238090</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palminteri</surname><given-names>S</given-names></name><name><surname>Khamassi</surname><given-names>M</given-names></name><name><surname>Joffily</surname><given-names>M</given-names></name><name><surname>Coricelli</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Contextual modulation of value signals in reward and punishment learning</article-title><source>Nature Communications</source><volume>6</volume><elocation-id>8096</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms9096</pub-id><pub-id pub-id-type="pmid">26302782</pub-id></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pessiglione</surname><given-names>M</given-names></name><name><surname>Seymour</surname><given-names>B</given-names></name><name><surname>Flandin</surname><given-names>G</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Frith</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Dopamine-Dependent prediction errors underpin reward-seeking behaviour in humans</article-title><source>Nature</source><volume>442</volume><fpage>1042</fpage><lpage>1045</lpage><pub-id pub-id-type="doi">10.1038/nature05051</pub-id><pub-id pub-id-type="pmid">16929307</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>L</given-names></name><name><surname>Thomas</surname><given-names>E</given-names></name><name><surname>White</surname><given-names>SH</given-names></name><name><surname>Smith</surname><given-names>SK</given-names></name><name><surname>Lee</surname><given-names>CA</given-names></name><name><surname>Wilson</surname><given-names>LR</given-names></name><name><surname>Sombers</surname><given-names>LA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Unmasking the effects of L-dopa on rapid dopamine signaling with an improved approach for Nafion coating carbon-fiber microelectrodes</article-title><source>Analytical Chemistry</source><volume>88</volume><fpage>8129</fpage><lpage>8136</lpage><pub-id pub-id-type="doi">10.1021/acs.analchem.6b01871</pub-id><pub-id pub-id-type="pmid">27441547</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname><given-names>R</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reinforcement-based decision making in corticostriatal circuits: mutual constraints by neurocomputational and diffusion models</article-title><source>Neural Computation</source><volume>24</volume><fpage>1186</fpage><lpage>1229</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00270</pub-id><pub-id pub-id-type="pmid">22295983</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>JNJ</given-names></name><name><surname>Wickens</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dopamine-dependent plasticity of corticostriatal synapses</article-title><source>Neural Networks</source><volume>15</volume><fpage>507</fpage><lpage>521</lpage><pub-id pub-id-type="doi">10.1016/s0893-6080(02)00045-x</pub-id><pub-id pub-id-type="pmid">12371508</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>JNJ</given-names></name><name><surname>Avvisati</surname><given-names>R</given-names></name><name><surname>Dodson</surname><given-names>PD</given-names></name><name><surname>Fisher</surname><given-names>SD</given-names></name><name><surname>Oswald</surname><given-names>MJ</given-names></name><name><surname>Wickens</surname><given-names>JR</given-names></name><name><surname>Zhang</surname><given-names>YF</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Coincidence of cholinergic pauses, dopaminergic activation and depolarisation of spiny projection neurons drives synaptic plasticity in the striatum</article-title><source>Nature Communications</source><volume>13</volume><elocation-id>1296</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-022-28950-0</pub-id><pub-id pub-id-type="pmid">35277506</pub-id></element-citation></ref><ref id="bib70"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Riedmiller</surname><given-names>M</given-names></name><name><surname>Hafner</surname><given-names>R</given-names></name><name><surname>Lampe</surname><given-names>T</given-names></name><name><surname>Neunert</surname><given-names>M</given-names></name><name><surname>Degrave</surname><given-names>J</given-names></name><name><surname>Wiele</surname><given-names>T</given-names></name><name><surname>Mnih</surname><given-names>V</given-names></name><name><surname>Heess</surname><given-names>N</given-names></name><name><surname>Springenberg</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Learning by Playing Solving Sparse Reward Tasks from Scratch</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1802.10567">https://arxiv.org/abs/1802.10567</ext-link></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rutledge</surname><given-names>RB</given-names></name><name><surname>Skandali</surname><given-names>N</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Dopaminergic modulation of decision making and subjective well-being</article-title><source>The Journal of Neuroscience</source><volume>35</volume><fpage>9811</fpage><lpage>9822</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0702-15.2015</pub-id><pub-id pub-id-type="pmid">26156984</pub-id></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salamone</surname><given-names>JD</given-names></name><name><surname>Correa</surname><given-names>M</given-names></name><name><surname>Mingote</surname><given-names>SM</given-names></name><name><surname>Weber</surname><given-names>SM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Beyond the reward hypothesis: alternative functions of nucleus accumbens dopamine</article-title><source>Current Opinion in Pharmacology</source><volume>5</volume><fpage>34</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1016/j.coph.2004.09.004</pub-id><pub-id pub-id-type="pmid">15661623</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salamone</surname><given-names>JD</given-names></name><name><surname>Correa</surname><given-names>M</given-names></name><name><surname>Yang</surname><given-names>JH</given-names></name><name><surname>Rotolo</surname><given-names>R</given-names></name><name><surname>Presby</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Dopamine, effort-based choice, and behavioral economics: basic and translational research</article-title><source>Frontiers in Behavioral Neuroscience</source><volume>12</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.3389/fnbeh.2018.00052</pub-id><pub-id pub-id-type="pmid">29628879</pub-id></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schultz</surname><given-names>W</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Montague</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>A neural substrate of prediction and reward</article-title><source>Science</source><volume>275</volume><fpage>1593</fpage><lpage>1599</lpage><pub-id pub-id-type="doi">10.1126/science.275.5306.1593</pub-id><pub-id pub-id-type="pmid">9054347</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>DN</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Beyond Gradients: Noise Correlations Control Hebbian Plasticity to Shape Credit Assignment</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2021.11.19.466943</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shiner</surname><given-names>T</given-names></name><name><surname>Seymour</surname><given-names>B</given-names></name><name><surname>Wunderlich</surname><given-names>K</given-names></name><name><surname>Hill</surname><given-names>C</given-names></name><name><surname>Bhatia</surname><given-names>KP</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dopamine and performance in a reinforcement learning task: evidence from Parkinson’s disease</article-title><source>Brain</source><volume>135</volume><fpage>1871</fpage><lpage>1883</lpage><pub-id pub-id-type="doi">10.1093/brain/aws083</pub-id><pub-id pub-id-type="pmid">22508958</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simoncelli</surname><given-names>EP</given-names></name><name><surname>Olshausen</surname><given-names>BA</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Natural image statistics and neural representation</article-title><source>Annual Review of Neuroscience</source><volume>24</volume><fpage>1193</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1146/annurev.neuro.24.1.1193</pub-id><pub-id pub-id-type="pmid">11520932</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smittenaar</surname><given-names>P</given-names></name><name><surname>Chase</surname><given-names>HW</given-names></name><name><surname>Aarts</surname><given-names>E</given-names></name><name><surname>Nusselein</surname><given-names>B</given-names></name><name><surname>Bloem</surname><given-names>BR</given-names></name><name><surname>Cools</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Decomposing effects of dopaminergic medication in Parkinson’s disease on probabilistic action selection -- learning or performance?</article-title><source>The European Journal of Neuroscience</source><volume>35</volume><fpage>1144</fpage><lpage>1151</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2012.08043.x</pub-id><pub-id pub-id-type="pmid">22487043</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stalnaker</surname><given-names>TA</given-names></name><name><surname>Berg</surname><given-names>B</given-names></name><name><surname>Aujla</surname><given-names>N</given-names></name><name><surname>Schoenbaum</surname><given-names>G</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Cholinergic interneurons use orbitofrontal input to track beliefs about current state</article-title><source>The Journal of Neuroscience</source><volume>36</volume><fpage>6242</fpage><lpage>6257</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0157-16.2016</pub-id><pub-id pub-id-type="pmid">27277802</pub-id></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>St Onge</surname><given-names>JR</given-names></name><name><surname>Floresco</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Dopaminergic modulation of risk-based decision making</article-title><source>Neuropsychopharmacology</source><volume>34</volume><fpage>681</fpage><lpage>697</lpage><pub-id pub-id-type="doi">10.1038/npp.2008.121</pub-id><pub-id pub-id-type="pmid">18668030</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>St Onge</surname><given-names>JR</given-names></name><name><surname>Chiu</surname><given-names>YC</given-names></name><name><surname>Floresco</surname><given-names>SB</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Differential effects of dopaminergic manipulations on risky choice</article-title><source>Psychopharmacology</source><volume>211</volume><fpage>209</fpage><lpage>221</lpage><pub-id pub-id-type="doi">10.1007/s00213-010-1883-y</pub-id><pub-id pub-id-type="pmid">20495787</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname><given-names>RS</given-names></name><name><surname>Barto</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2018">2018</year><source>Reinforcement Learning</source><publisher-loc>Cambridge, MA</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tai</surname><given-names>LH</given-names></name><name><surname>Lee</surname><given-names>AM</given-names></name><name><surname>Benavidez</surname><given-names>N</given-names></name><name><surname>Bonci</surname><given-names>A</given-names></name><name><surname>Wilbrecht</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Transient stimulation of distinct subpopulations of striatal neurons mimics changes in action value</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>1281</fpage><lpage>1289</lpage><pub-id pub-id-type="doi">10.1038/nn.3188</pub-id><pub-id pub-id-type="pmid">22902719</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Threlfell</surname><given-names>S</given-names></name><name><surname>Lalic</surname><given-names>T</given-names></name><name><surname>Platt</surname><given-names>NJ</given-names></name><name><surname>Jennings</surname><given-names>KA</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name><name><surname>Cragg</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Striatal dopamine release is triggered by synchronized activity in cholinergic interneurons</article-title><source>Neuron</source><volume>75</volume><fpage>58</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.04.038</pub-id><pub-id pub-id-type="pmid">22794260</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tobler</surname><given-names>PN</given-names></name><name><surname>Fiorillo</surname><given-names>CD</given-names></name><name><surname>Schultz</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Adaptive coding of reward value by dopamine neurons</article-title><source>Science</source><volume>307</volume><fpage>1642</fpage><lpage>1645</lpage><pub-id pub-id-type="doi">10.1126/science.1105370</pub-id><pub-id pub-id-type="pmid">15761155</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treadway</surname><given-names>MT</given-names></name><name><surname>Buckholtz</surname><given-names>JW</given-names></name><name><surname>Cowan</surname><given-names>RL</given-names></name><name><surname>Woodward</surname><given-names>ND</given-names></name><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Ansari</surname><given-names>MS</given-names></name><name><surname>Baldwin</surname><given-names>RM</given-names></name><name><surname>Schwartzman</surname><given-names>AN</given-names></name><name><surname>Kessler</surname><given-names>RM</given-names></name><name><surname>Zald</surname><given-names>DH</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Dopaminergic mechanisms of individual differences in human effort-based decision-making</article-title><source>The Journal of Neuroscience</source><volume>32</volume><fpage>6170</fpage><lpage>6176</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6459-11.2012</pub-id><pub-id pub-id-type="pmid">22553023</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Voon</surname><given-names>V</given-names></name><name><surname>Pessiglione</surname><given-names>M</given-names></name><name><surname>Brezing</surname><given-names>C</given-names></name><name><surname>Gallea</surname><given-names>C</given-names></name><name><surname>Fernandez</surname><given-names>HH</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Hallett</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Mechanisms underlying dopamine-mediated reward bias in compulsive behaviors</article-title><source>Neuron</source><volume>65</volume><fpage>135</fpage><lpage>142</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2009.12.027</pub-id><pub-id pub-id-type="pmid">20152119</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wahlstrom</surname><given-names>D</given-names></name><name><surname>Collins</surname><given-names>P</given-names></name><name><surname>White</surname><given-names>T</given-names></name><name><surname>Luciana</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Developmental changes in dopamine neurotransmission in adolescence: behavioral implications and issues in assessment</article-title><source>Brain and Cognition</source><volume>72</volume><fpage>146</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1016/j.bandc.2009.10.013</pub-id><pub-id pub-id-type="pmid">19944514</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Watkins</surname><given-names>CJCH</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="1992">1992</year><article-title>Q-learning</article-title><source>Machine Learning</source><volume>8</volume><fpage>279</fpage><lpage>292</lpage><pub-id pub-id-type="doi">10.1007/BF00992698</pub-id></element-citation></ref><ref id="bib90"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weismüller</surname><given-names>B</given-names></name><name><surname>Ghio</surname><given-names>M</given-names></name><name><surname>Logmin</surname><given-names>K</given-names></name><name><surname>Hartmann</surname><given-names>C</given-names></name><name><surname>Schnitzler</surname><given-names>A</given-names></name><name><surname>Pollok</surname><given-names>B</given-names></name><name><surname>Südmeyer</surname><given-names>M</given-names></name><name><surname>Bellebaum</surname><given-names>C</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Effects of feedback delay on learning from positive and negative feedback in patients with Parkinson’s disease off medication</article-title><source>Neuropsychologia</source><volume>117</volume><fpage>46</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1016/j.neuropsychologia.2018.05.010</pub-id><pub-id pub-id-type="pmid">29758227</pub-id></element-citation></ref><ref id="bib91"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westbrook</surname><given-names>A</given-names></name><name><surname>van den Bosch</surname><given-names>R</given-names></name><name><surname>Määttä</surname><given-names>JI</given-names></name><name><surname>Hofmans</surname><given-names>L</given-names></name><name><surname>Papadopetraki</surname><given-names>D</given-names></name><name><surname>Cools</surname><given-names>R</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Dopamine promotes cognitive effort by biasing the benefits versus costs of cognitive work</article-title><source>Science</source><volume>367</volume><fpage>1362</fpage><lpage>1366</lpage><pub-id pub-id-type="doi">10.1126/science.aaz5891</pub-id><pub-id pub-id-type="pmid">32193325</pub-id></element-citation></ref><ref id="bib92"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiecki</surname><given-names>TV</given-names></name><name><surname>Riedinger</surname><given-names>K</given-names></name><name><surname>von Ameln-Mayerhofer</surname><given-names>A</given-names></name><name><surname>Schmidt</surname><given-names>WJ</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>A neurocomputational account of catalepsy sensitization induced by D2 receptor blockade in rats: context dependency, extinction, and renewal</article-title><source>Psychopharmacology</source><volume>204</volume><fpage>265</fpage><lpage>277</lpage><pub-id pub-id-type="doi">10.1007/s00213-008-1457-4</pub-id><pub-id pub-id-type="pmid">19169674</pub-id></element-citation></ref><ref id="bib93"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RC</given-names></name><name><surname>Geana</surname><given-names>A</given-names></name><name><surname>White</surname><given-names>JM</given-names></name><name><surname>Ludvig</surname><given-names>EA</given-names></name><name><surname>Cohen</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Humans use directed and random exploration to solve the explore-exploit dilemma</article-title><source>Journal of Experimental Psychology. General</source><volume>143</volume><fpage>2074</fpage><lpage>2081</lpage><pub-id pub-id-type="doi">10.1037/a0038199</pub-id><pub-id pub-id-type="pmid">25347535</pub-id></element-citation></ref><ref id="bib94"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yartsev</surname><given-names>MM</given-names></name><name><surname>Hanks</surname><given-names>TD</given-names></name><name><surname>Yoon</surname><given-names>AM</given-names></name><name><surname>Brody</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Causal contribution and dynamical encoding in the striatum during evidence accumulation</article-title><source>eLife</source><volume>7</volume><elocation-id>e34929</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.34929</pub-id><pub-id pub-id-type="pmid">30141773</pub-id></element-citation></ref><ref id="bib95"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yttri</surname><given-names>EA</given-names></name><name><surname>Dudman</surname><given-names>JT</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Opponent and bidirectional control of movement velocity in the basal ganglia</article-title><source>Nature</source><volume>533</volume><fpage>402</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1038/nature17639</pub-id><pub-id pub-id-type="pmid">27135927</pub-id></element-citation></ref><ref id="bib96"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zalocusky</surname><given-names>KA</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Lerner</surname><given-names>TN</given-names></name><name><surname>Davidson</surname><given-names>TJ</given-names></name><name><surname>Knutson</surname><given-names>B</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Nucleus accumbens D2R cells signal prior outcomes and control risky decision-making</article-title><source>Nature</source><volume>531</volume><fpage>642</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1038/nature17400</pub-id><pub-id pub-id-type="pmid">27007845</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><sec sec-type="appendix" id="s8"><title>Incorrect modulation impairs performance</title><p>As noted in the main text, it is important that the critic estimate of environmental richness is reasonably accurate (on the correct side of 0.5) for OpAL* to confer advantages. Indeed, pathological behavior arises if DA states are altered in opposing direction to environmental richness. In <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>, we see the effect of flipping the sign of OpAL*’s calculation of dopaminergic state (<xref ref-type="disp-formula" rid="equ14">Equation 14</xref>). For this demonstration, if the critic of OpAL* estimated that it was in a rich environment (positive value of ρ, high dopaminergic state), it would emphasize the N instead of G actor (as if it were in a lean environment). We see that the lean environment shows high sensitivity to incorrect modulation. The rich environment shows greater robustness but nonetheless has decreased performance in comparison to the standard simulations. This result confirms that the direction of modulation in OpAL* is important, and moreover that it is particularly important to have lower DA in lean environments.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Effects of dopaminergic states that inaccurately reflect environmental richness.</title><p>Parameters optimized the average area under the curve (AUC) across both rich <italic>and</italic> lean environments according to the grid search. See ‘Parameter grid’ search for details.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig1-v2.tif"/></fig></sec><sec sec-type="appendix" id="s9"><title>Comparison to softmax temperature modulation</title><p>As noted in the main text, OpAL* confers larger benefits in lean environments, in part by mitigating against an exploration/exploitation dilemma. In particular, during early learning, OpAL* relies on both actors equally and thereby distributes its policy more randomly, but after it estimates the richness of the environment, it exploits the more specialized actor. To evaluate whether similar benefits could be mimicked by simply increasing softmax gain over trials (transitioning from exploration to exploitation), we considered an OpAL* variant that symmetrically increased the softmax temperature according equally across the G and the N actor. As the richness (or leanness) of the environment grew, the agent would progressively exploit both actors equally using the same Bayesian meta-critic as in OpAL*.<disp-formula id="equ39"><label>(33)</label><mml:math id="m39"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula><disp-formula id="equ40"><label>(34)</label><mml:math id="m40"><mml:mrow><mml:mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Given the difference in exploration–exploitation demands across rich and lean environments, we compared the average AUCs of OpAL* and beta-modulation (B-Mod). Overall we found that OpAL* exhibited improved maximal cross-environment robustness and specifically improved maximal performance in the rich environment. Thus, global changes in explore–exploit the softmax temperature alone are insufficient to capture the full performance benefit in lean environments induced by dopaminergic modulation in OpAL*, which capitalizes on specialized learned representations across actors.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Comparison of OpAL* to dynamic modulation of softmax temperature (bmod).</title><p>Figure shows average areas under the curve (AUCs) of models for fixed parameter in both lean and rich environments for varying complexity. Histograms show differences in AUC of paired parameters. Across horizons and complexity levels, OpAL* significantly outperformed Bmod in the rich environment (<inline-formula><mml:math id="inf201"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mn>10</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>). As time horizons increase, Bmod outperforms begins to outperform OpAL* in lower complexity levels for lean environments (levels 2 and 3 for 500 trials, all complexity levels for 1000 trials [<inline-formula><mml:math id="inf202"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo></mml:mrow></mml:msup><mml:mn>7</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>]), though with smaller effect sizes than OpAL*’s relative performance in rich.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig2-v2.tif"/></fig></sec><sec sec-type="appendix" id="s10"><title>Addressing <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref></title><p>We incorporated normalization and weight decay for the actors to address weaknesses of the original OpAL model raised by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>. The (valid) critique outlined by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> is that its three-factor Hebbian update gives rise to unstable actor dynamics, specifically after the critic converges. They demonstrated that when OpAL is sequentially presented with a reward of 2 followed by a cost of –1, the dynamics of G and N rapidly converge to 0 (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, left). As described in their text (<xref ref-type="disp-formula" rid="equ1 equ1 equ1">Equations 39–41)</xref>, stable oscillations in reward prediction errors cause G and N weights to decay towards zero. This decay is indeed a characteristic of the standard OpAL model without annealing: once the critic begins to converge, RPEs for disconfirmatory outcomes induce larger changes in the weights due to higher order terms (see expanded weight update <xref ref-type="disp-formula" rid="equ23">Equation 22</xref> for intuition). (Arguably, this decay is akin to an advantage-learning action value curve, whereby once the critic begins to converge, the ‘advantage’ of the option [difference between the action value and the average value of the environment] decreases overtime [<xref ref-type="bibr" rid="bib18">Dayan and Balleine, 2002</xref>]. While the current section addresses the decay via annealing, we do not view the existence of decay itself to be necessarily problematic. First, in neural network versions of our and other BG models, striatal action selection contributes primarily to early learning; once a policy is repeated sufficiently [e.g., when convergence is more likely], the cortex can directly select an action in a stimulus–response fashion [<xref ref-type="bibr" rid="bib25">Frank and Claus, 2006</xref>; <xref ref-type="bibr" rid="bib67">Ratcliff and Frank, 2012</xref>; see also <xref ref-type="bibr" rid="bib2">Ashby et al., 2007</xref>]. Alternatively, although we do not explore this here, it is also possible that the decay is a feature rather than a bug: since the weights decline once the critic has converged, the decay itself is an indicator that the learned Q value from the critic is well estimated, and the agent could potentially use that Q value directly for action selection itself, using a hybrid Q learner/actor-critic model. In that case, the actor weights would dominate the policy early during learning but once they decay the hybrid action selection mechanism would agent could rely on [the now converged] Q values. Such hybrid models have been used to simulate choice preferences in tasks similar to that of <xref ref-type="bibr" rid="bib64">Palminteri et al., 2015</xref>; <xref ref-type="bibr" rid="bib35">Gold et al., 2012</xref>; <xref ref-type="bibr" rid="bib32">Geana et al., 2022</xref>.)</p><p>The rapid decay evident in <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, left, was constructed to highlight a particularly pernicious example of this issue. The following simulations suggest that the introduction of larger reward magnitudes, rather than the oscillating PEs, has driven such expedited instability. Larger reward magnitudes yield larger reward prediction error signals, which in turn yield larger G/N values as evident by <xref ref-type="disp-formula" rid="equ3 equ4">Equations 3 and 4</xref>, which, through the Hebbian positive feedback cycle, further increase effective learning rate. One simple correction is to simply rescale and shrink the magnitudes by some constant (<inline-formula><mml:math id="inf203"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>c</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>); this slows decay in this example (simulations not shown). Note also that <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> simulations used a relatively large critic learning rate (0.3), which speeds convergence and exacerbates these effects. Adaptive behavior in OpAL* involves a relatively low critic learning rate, as highlighted above (due to contributions of the higher order terms in the G/N recursive updates that drive decay). Simply decreasing the critic learning rate (e.g., 0.05) thus also dampens the decay (not shown).</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Scenario presented in <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>, where oscillating payout of +2 and loss of –1 induces accelerated decay of G and N weights to zero, caused both by large reward magnitudes and quick convergence of the critic.</title><p>To protect against such decay, we introduce normalization of reward prediction errors and learning rate annealing (middle and right).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig3-v2.tif"/></fig><p>Nevertheless, we sought to more robustly address these issues because the above modifications only prolong the decay. We introduced two modifications in OpAL* to address these concerns. First, prediction errors used to update G and N actors (<xref ref-type="disp-formula" rid="equ18 equ19">Equations 18 and 19)</xref> are normalized by the range of known reward magnitudes in the environment (<xref ref-type="disp-formula" rid="equ1">Equation 21</xref>). Importantly, OpAL* is not provided any reward statistics beyond the range of reward feedback, and in theory this value could be adjusted as the agent learns, reflecting how dopamine neurons rapidly adapt to the range of reward values in the environment (<xref ref-type="bibr" rid="bib85">Tobler et al., 2005</xref>).</p><p><xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, center, shows the effect of normalization for the example in question. We see that the rapid decay is substantially decreased, and simulating into a farther time horizon of 100 trials shows a trend toward, but not final convergence at, zero (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, right). (Note that OpAL* behaves well for several hundred trials in the experiments we simulated in this article.) While there remains a general decay over time, as previously stated, the behavior is reminiscent of advantage learning curves, which have the positive feature that such decay can encourage the agent to explore after many trials in the event the world has changed. Furthermore, it is plausible that other learning mechanisms, such as more habitual stimulus–response learning, also contribute to choice after many learning trials (<xref ref-type="bibr" rid="bib25">Frank and Claus, 2006</xref>). Thus striatal weight decay, which has been documented empirically (<xref ref-type="bibr" rid="bib95">Yttri and Dudman, 2016</xref>), may not be detrimental for procedural performance. Normalizing, therefore, addresses one factor (large RPE magnitudes) contributing to the rapid decay in early trials demonstrated by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> while still preserving core OpAL dynamics, which allow it to capture a range of biological phenomenon as well as hypotheses for advantages of dopaminergic states presented in this article.</p><p>Secondly, to address the original issue raised by <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref> that OpAL weights decay with oscillating prediction errors, we introduced annealing of the actor learning rate. This is a common addition to reinforcement learning algorithms where the learning rate is large in early stages of learning to avoid local minimums and slowly decreases with time to protect values in later stages of learning from rapid updating. (To allow for change points in reward statistics, other mechanisms capturing the effects of cholinergic interneurons have been shown to be useful in BG networks and OpAL variants; <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>). <xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3</xref>, right, shows that while actor weights still decrease with the addition of annealing, they no longer converge to zero and lose all prior learning as demonstrated in <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>. Ordinal rankings of G and N weights for various probability of rewards are also preserved after extended learning (1000 trials, <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref>). Since fixed annealing with time would hinder an agent’s ability to respond to sudden changes in the environment, we modulate annealing according to the uncertainty generated by the Bayesian meta-critic. This allows OpAL* to adequately respond to sudden changes in environmental statistics (e.g., when the rewarding option changes). Further augmenting OpAL* with decay of actor weights as proposed by <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>, thought to be implemented by cholinergic neurons, also allows OpAL* to remain flexible to extremely volatile environments, such as when reward rate varies trial-by-trial according to a random walk (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>), but optimizing for these types of scenarios is beyond the scope of this article.</p><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Our proposed annealing preserves ordinal rankings for extended learning.</title><p>Curves averaged over 100 simulations.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig4-v2.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>Combination of decay and annealing can also improve OpAL* responses to highly volatile environments, such as in a random walk (left, probability of reward).</title><p>Middle: OpAL* annealing slows convergence of G weights (green) and N weights (red) to zero but the model still suffers from decay. Right: OpAL* with decay and Bayesian annealing allow flexibility, though the optimization of this combined mechanism for variable environments is beyond the scope of this article.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig5-v2.tif"/></fig><p>Notably, annealing intensifies a common tradeoff of increased stability for decreased flexibility. While lowering the learning rate protects the actor weights from converging to zero and allows the model to retain a useful policy, the actor weights become insensitive to changes in reward contingencies when the variance of the meta-critic is sufficiently small. In this article, our scope focus on stationary reward environments (where rewards do not change) and this flexibility is not required. However, in environments where reward consistently drifts, OpAL* can track such rapid reward fluctuations with less annealing, but suffers from gradual decay as a result (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>), albeit less so than the OpAL model without annealing (not shown). However, it is possible to further improve OpAL*’s flexibility by simply incorporating decay of actor weights as proposed by <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref>, who introduced this mechanism to approximate the impact of cholinergic neurons and which specifically addressed the flexibility stability dilemma. One can see that a simple version of this decay does improve flexibility (<xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>, right, and <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>, right). Assessing whether OpAL* advantage could be further improved when optimizing for weight decay in conjunction with annealing parameters (held fixed in this paper) is left for future work, though we did verify that including decay for the optimized parameters presented in <xref ref-type="fig" rid="fig6">Figure 6A</xref> demonstrated similar performance advantages for OpAL* while enhancing flexibility. Furthermore, the effect of learning rate on stability in drifting reward environments should also be explored; the higher order terms present implicitly in the G/N weights (<xref ref-type="disp-formula" rid="equ23">Equation 22</xref>) imply that lower actor learning rates throughout learning will support enhanced stability because larger learning rates increase contribution of the higher order terms which drive decay – even though larger learning rates may be optimal in short time horizons and in stable environments such as those presented. The general stability–flexibility tradeoff is an issue studied beyond BG-circuitry (<xref ref-type="bibr" rid="bib61">Nassar et al., 2012</xref>; <xref ref-type="bibr" rid="bib42">Iglesias et al., 2013</xref>) and can never fully be eliminated, though approaches such as those we outline here may help improve OpAL*’s flexibility across a broader range of environments.</p><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Left: Bayesian annealing allows OpAL* to remain flexible when the rewarding option suddenly changes.</title><p>Two-armed bandit task where option A is rewarded 80% of the time and option B is reward 50% of the time. After 150 trials, the reward contingencies reverse and option A is the least rewarding. Right: augmenting OpAL* further with decay as proposed by <xref ref-type="bibr" rid="bib28">Franklin and Frank, 2015</xref> increases adaptiveness to a switch point.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-app1-fig6-v2.tif"/></fig></sec><sec sec-type="appendix" id="s11"><title>Derivation of OpAL actor weights as a function of RPE history</title><p>The actor weight updates are recursive, whereby the G and N weights are updated not only as a function of RPE on trial i (<inline-formula><mml:math id="inf204"><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>) but also as a function of the previous actor weights (<inline-formula><mml:math id="inf205"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf206"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). Consider <inline-formula><mml:math id="inf207"><mml:mi>t</mml:mi></mml:math></inline-formula> successive trials of selecting action <inline-formula><mml:math id="inf208"><mml:mi>a</mml:mi></mml:math></inline-formula>. Expanding <xref ref-type="disp-formula" rid="equ3">Equation 3</xref> using an initial <inline-formula><mml:math id="inf209"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (as used in all simulations so that the first update reduces to a standard RL algorithm, with weight changes directly proportional to the first RPE), we have<disp-formula id="equ41"><mml:math id="m41"><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>G</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">…</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Collecting all the terms and rearranging:<disp-formula id="equ42"><label>(35)</label><mml:math id="m42"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>and similarly, the update <inline-formula><mml:math id="inf210"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> can be written as:<disp-formula id="equ43"><label>(36)</label><mml:math id="m43"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The same equations apply for the <inline-formula><mml:math id="inf211"><mml:mi>N</mml:mi></mml:math></inline-formula> weights, replacing each <inline-formula><mml:math id="inf212"><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> with <inline-formula><mml:math id="inf213"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The higher order terms in the above equations introduce distortions in the G and N weights such that they grow nonlinearly as a function of the consistency of prior RPEs (e.g., when most pairs <inline-formula><mml:math id="inf214"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are of the same sign they have greater impact on the weight update and the ultimate weight itself than the sum of their individual contributions). Note also that these terms introduce decay in the weights after the critic has converged (as long as there remain both positive and negative RPEs that sum to zero), but OpAL* stabilizes the weights via annealing.</p></sec></app><app id="appendix-2"><title>Appendix 2</title><sec sec-type="appendix" id="s12"><title>Supplemental note 1</title><p>For clarity, ‘benefits’ and ‘costs’ are evaluations relative to the critic’s expectation. The exact numeric value is not interpretable. Rather, high benefits (<inline-formula><mml:math id="inf215"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) convey that an action is better than expected more often; high costs (<inline-formula><mml:math id="inf216"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>) convey that an action more often disappoints relative to the critic’s expectations.</p></sec><sec sec-type="appendix" id="s13"><title>Supplemental note 2</title><p>One can adjust DA without the conservative inference process but there is a cost to misestimation of environmental richness that can arise due to stochasticity in any given environment, which can lead to reliance on the wrong actor; see <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref>. Although we focus on the Bayesian implementation here, other heuristics for achieving the same desideratum can be applied, for example, waiting a fixed number of trials before changing the dopaminergic state by integrating information from the standard RL critic to estimate context value. However, using a beta distribution (whose mean implicitly incorporates uncertainty) and explicitly adapting according to the distributions’ standard deviation isolates whether any differences in performance between OpAL* and a baseline model with fixed dopaminergic states were a result of dopamine modulation rather than an ineffective use of the meta-critic (e.g., waiting too few trials) or a suboptimal meta-critic (e.g., poorly tuned learning rate for RL version).</p></sec><sec sec-type="appendix" id="s14"><title>Supplemental note 3</title><p>The meta-critic provides a proxy for the agent’s uncertainty about the task which can be used to uniformly anneal learning rates across actions. Other implementations are possible, however, for example, the critic itself could be Bayesian and have access to uncertainty within individual state-action values to guide annealing. We chose the current implementation for simplicity.</p></sec><sec sec-type="appendix" id="s15"><title>Supplemental note 4</title><p>In our simulations, the OpAL+ model includes the annealing and normalization additions as discussed in the section ‘OpAL*.’ While these features were not present in the original version presented in <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>, we found that they are necessary to address pathological behavior as discussed in the section ‘OpAL*’ and in Appendix 1 (‘Addressing’; <xref ref-type="bibr" rid="bib59">Möller and Bogacz, 2019</xref>). The crucial distinction we emphasize between OpAL+ and OpAL* is the non-dynamic versus dynamic adaptation of DA, respectively.</p></sec><sec sec-type="appendix" id="s16"><title>Supplemental note 5</title><p>As such, relatively larger leads to better discrimination among highly rewarded options, and relatively larger leads to better discrimination among lean options, consistent with the many effects of DA manipulation on asymmetric learning in the literature; <xref ref-type="bibr" rid="bib15">Collins and Frank, 2014</xref>, see <xref ref-type="fig" rid="fig8s4">Figure 8—figure supplement 4</xref>.</p></sec><sec sec-type="appendix" id="s17"><title>Supplemental note 6</title><p>It is worth noting that in more standard actor-critic models, slower actor learning relative to critic learning is often preferable in order for the critic to properly evaluate the value of a stable policy (<xref ref-type="bibr" rid="bib11">Castro and Meir, 2010</xref>). It is therefore also noteworthy that OpAL* stabilizes its policy via annealing actor learning rates as function of uncertainty, so that when the critic value does converge, it is based on a stable policy. The prediction errors generated by the critic could then in principle be used in temporal-difference sequential decision settings just as in standard actor-critic models.</p></sec><sec sec-type="appendix" id="s18"><title>Supplemental note 7</title><p>The G weights of this model are designed to converge to the expected payoffs of an action, while the N weights are designed to converge to the expected costs. With lmag = 0, actions have no explicit expected costs and in theory reduces to a nonopponent mechanism. To best equate scope and explore the role of different [Hebbian vs. non-Hebbian] nonlinearities in combination with opponency, we explicitly included a cost in these simulations. Given the normalization of reward values used in OpAL*, we expect it would perform similarly for lmag = -1 as it does for lmag = 0; the actor weights and performance OpAL* depend on the experienced consistency of positive and negative outcomes, not their absolute magnitudes. See <xref ref-type="disp-formula" rid="equ23">Equation 22</xref>.</p></sec><sec sec-type="appendix" id="s19"><title>Supplemental note 8</title><p>As gamble offers were explicit, removing uncertainty in trial richness, we omitted the parameter which modulated DA levels by degree of certainty in environmental richness, further reducing model complexity. OpAL*’s ability to capture shifting patterns of risky choice should thus be viewed as a by-product of interacting opponent, nonlinear, and dynamic DA mechanisms rather than a result of high degrees of freedom.</p></sec><sec sec-type="appendix" id="s20"><title>Supplemental note 9</title><p>For clarification, <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref> highlighted that the drug effects appear ‘value-independent,’ whereas here we explicitly are changing risk sensitivity according to the interaction between drug and offer value. It is important to note, however, that their definition of value differs than that used to modulate dopaminergic state in these simulations. In <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>, value is defined as the advantage of the gamble, i.e., the difference between the expected value of the gamble and the sure reward. Here, we considered value to be the combined overall value of the offer presented, such that positive RPEs exist when values are greater than expected, and are in turn was modified by drug dosage. It is this component that captures the selective increase in gambling in gain trials. Note that the model does predict that such gambles would be yet more likely when the potential benefit of gambling is larger [i.e., when gains are particularly large] – but that this effect would also be present off drug. It is also possible that the value-independence in <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref> resulted from a ceiling effect for gambling in higher gain trials.</p></sec><sec sec-type="appendix" id="s21"><title>Supplemental note 10</title><p>This reference-dependent modulation is analogous to our learning experiments, in which the implicit baseline used a mean reward probability of 50%, and where environments with higher estimated reward probabilities were considered ‘rich’ and those below 50% were considered ‘lean.’ One could more generally apply the terms ‘rich’ and ‘lean’ to any values which deviate from a determined baseline, where <inline-formula><mml:math id="inf217"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>R</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the estimated richness of the current environment and <inline-formula><mml:math id="inf218"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> represents the mean of an uninformative prior over the expected outcomes,<inline-formula><mml:math id="inf219"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mrow><mml:mover><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi>B</mml:mi><mml:mo>.</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>ρ</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> would be considered ‘rich’; <inline-formula><mml:math id="inf220"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> would be considered ‘lean.’ Indeed, previous work has suggested that of a single environment may be encoded by tonic levels of dopamine, inducing changes in vigor of actions (<xref ref-type="bibr" rid="bib62">Niv et al., 2007</xref>), but does not model changes in the choices themselves as we do here. A similar approach is used in average reward RL. Rather than maximizing the total cumulative reward, average reward RL additionally optimizes the average reward per timestep. Reward prediction errors are therefore computed relative to the long-term average reward per time step (<inline-formula><mml:math id="inf221"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula>), resulting in <inline-formula><mml:math id="inf222"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>r</mml:mi><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mspace width="thinmathspace"/><mml:mi>ρ</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as operationalized in OpAL* resembles a prediction error at the task/environment level, though may additionally be influenced by trial-by-trial prediction errors when trials are sufficiently distinct as in the interleaved gambles in <xref ref-type="bibr" rid="bib71">Rutledge et al., 2015</xref>.</p></sec></app></app-group></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85107.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Liljeholm</surname><given-names>Mimi</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>This paper provides a formal analysis of the normative advantage of the opponent pathways of the basal ganglia circuit for cost-benefit decision-making. Specifically, a previously introduced Hebbian nonlinearity is combined with reward-based DA modulation to optimize exploration across lean and rich environments, and across a range of pharmacological and contextual manipulations. The scope of the model, its biological plausibility, and its normative and descriptive aspects are likely to have a significant impact.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85107.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Liljeholm</surname><given-names>Mimi</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Liljeholm</surname><given-names>Mimi</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>[Editors’ note: the authors submitted for reconsideration following the decision after peer review. What follows is the decision letter after the first round of review.]</p><p>Thank you for submitting the paper &quot;On the normative advantages of dopamine and striatal opponency for learning and choice&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Mimi Liljeholm as the Reviewing Editor and Reviewer #, and the evaluation has been overseen by a Senior Editor.</p><p>Comments to the Authors:</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that this work will not be considered further for publication by <italic>eLife</italic>.</p><p>Specifically, concerns about the stability and adaptivity of the model, based on actual simulations, were judged serious enough to preclude an invitation to revise. However, if you feel confident that you can compellingly address all issues raised by the reviewers, and the matter of environmental dynamics in particular, we would be happy to consider a resubmission.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors aim to demonstrate the normative advantage of opponent basal ganglia pathways, using dynamic dopamine (DA) modulation by environmental reward statistics. The finding that well-known neurophysiological and psychopharmacological mechanisms yield rational decision-making in ecologically plausible environments is a major strength of the paper. The methods are rigorous, and the advantage of the model is reliable across a range of parameters and paradigms. More could be done to explain the optimality of certain model predictions, to map the correspondence between model predictions and animal behavior, and to articulate the conceptual relationship between relevant constructs, such as exploration, discrimination, and risk-taking. Nevertheless, the scope of the model, its biological plausibility, and its normative and descriptive aspects suggest that it may have a significant impact.</p><p>1. More could be done to detail the, sometimes counterintuitive, optimality of certain model predictions. For example, while it is straightforward that you need to explore to discover better options, the need to sample sub-optimal options so that you know to avoid them makes less sense: if you don't sample them, you are already avoiding them, and when you do choose them, you learn the values – why is it adventitious to do the sampling early in the process as opposed to later? Another example is the claimed optimality of avoiding gambles in lean environments, despite the expected value of the gamble being greater than that of the ST.</p><p>2. It would be helpful if there was a description, early in the Introduction, and perhaps again in the Discussion, of how the relevant constructs (i.e., exploration, discrimination, and risk-taking), are related conceptually – note that exploration can be characterized as risk-taking and that the decision to gamble may reflect either exploration or value-based discrimination.</p><p>3. In Figure 10a, it is unclear why L-DOPA does not boost G weights and reduce N weights, yielding a greater probability of gambling, on loss trials as it does on gain trials?</p><p>4. In Equations 1-3, why not show the updating of Act values, or, if identical to V(a), be explicit about that. Also, Equation 14 is referred to as a prediction error in the text, but the notation indicates an action value [i.e., V(a)].</p><p>5. It is argued that OpAL* eliminates the need for a priori knowledge about environmental reward statistics, but DA-modulation depends on confident estimates of the values (i.e., reward probabilities) of all available actions – the implications of this reliance on reward estimates seem under-explored in simulations.</p><p>6. It is unclear from the curves in Figure 7 whether the models reach equilibrium by 100 trials. Please show asymptotic performance.</p><p>7. Why use only forced-choice simulations? It is hard to imagine a real-world scenario in which &quot;no action&quot; is not an alternative. Failure to include such an option detracts from the ecological validity of the experiments.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>I really enjoyed this paper that significantly advance our understanding of the basal ganglia circuit. I have some suggestions for additional simulations that can allow establishing to which extent previous findings in reinforcement learning can be accounted for by the OpAL(*) models.</p><p>A key concept of the model is its sensitivity to environmental richness (i.e., whether the agent is in a lean or in a rich environment). The concept behind the &quot;rho&quot; variable is very closely related to that of &quot;state value&quot; or &quot;reference point&quot; as it has been applied to reinforcement learning and valuation since Palminteri et al. (2015). The key demonstration of a crucial role of overall &quot;environmental richness&quot; in learning and valuation came from a task, which, explicitly coupling features of the Frank (2004) and Pessiglione (2006) tasks, showed that transfer learning performance is highly context-dependent (see Palminteri and Lebreton, 2021; Daw and Hunter, 2021 for review of these results). My question here is whether or not the OpAL(*) models are sufficient to generate such context-dependent preferences. Does this (very robust) behavioral effect naturally emerge from the model? Or do we need to specify an additional process to explain this? Can you simulate Palminteri et al. (2015) using the OpAL(*) models and show what are the performance in the learning and transfer phase?</p><p>A robust and replicable finding in human (and nonhuman) reinforcement learning is that when fitting the model with two learning rates for positive or negative prediction errors (starting from Frank et al. 2007, supplementary materials, continuing in Lefebvre et al. 2017; Gagne et al. 2020; Farashahi et al. 2019; Ohta et al. 2021; Chambon et al. 2020 – the rare occurrences of the opposite pattern are generally explained by wrongly initializing the Q-values at pessimistic values). The optimality of this bias has been sometimes investigated (see Cazé and Van den Merr 2013; Lefebvre et al. 2022). My question here is whether and/or under which circumstances do the OpAL(*) models explain the ubiquity of this pattern? If you simulate OpAL(*) models and then fit the asymmetric model, would you (quasi-)systematically retrieve the asymmetric pattern?</p><p>Finally, the actor prediction errors are normalized. I can see the logic of this. I was nonetheless puzzled by the functional form of the normalization that is not really a range normalization (Lmag is lacking at the numerator). Consider for example Bavard et al. (2021), which propose a full range normalization rule. What is the rationale for this particular form of normalization? Are Lmag and Rmag learned (via δ rule or other, see Bavard et al.) or specified in advance?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>This manuscript proposes a refined version of the OpAL model, which aims to address the numerical instability problems present in the previous version and demonstrate the normative advantages of the model in learning tasks. Unfortunately, the instability problems still persist in the proposed model, and the normative comparison is unconvincing due to the limited range of scenarios and tasks investigated.</p><p>Comments</p><p>1. It has been previously pointed out that the OpAL model is numerically unstable: all synaptic weights converge to 0 with learning, and as a result, the model has a tendency to make random choices with practice. The authors claim that the proposed model &quot;addresses limitations of the original OpAL&quot;, but in fact, it does not – it just postpones their effect by introducing learning rates that decay with time, which ensures that the weights simply stop changing as learning progresses. Consequently, there are several problems with the proposed argumentation in the paper:</p><p>a. The paper does not adequately describe the scale of the stability problem faced by the original OpAL model. A cartoon in Figure 1 falsely suggests that the weights in the OpAL model converge to stable values with learning, by contrast even for this scenario all weights decay to 0. The appendix attached below this review contains Matlab code simulating the OpAL model, and the first figure generated by this code shows OpAL model simulations corresponding to Figure 1. Running the code clearly shows that all weights decay to 0 in this simulation. Therefore, weight evolution in the OpAL model in Figure 1, needs to show the actual simulation of the OpAL model rather than cartoons with qualitatively different behaviour of the weights.</p><p>b. Similarly, a reader may get a false impression that the instability problems only occur in the scenario in Figure 13, because the manuscript states in lines 1104-1105 that the OpAL model &quot;in carefully constructed situations, gives rise to unstable actor dynamics&quot;. However, as pointed out in my previous comment, these problems are ubiquitous, and in fact, Mikhael and Bogacz (2016) also illustrated this problem in Figure 9 of their paper for randomly generated rewards. The reason why Moeller and Bogacz (2019) considered the scenario in Figure 13 is that for this case one can easily show analytically that the weights in the OpAL model converge to 0.</p><p>c. To solve the stability problem, the authors modify the model such that the learning slows with time. However, they admit in l.1130: that the model loses its memory with time, and they propose that the habit system may take over learning and rescue animal bahaviour. However, animals with lesions of dorso-lateral striatum (which is known to underlie habitual behaviour) still can perform learned tasks (Yin HH, Knowlton BJ, Balleine BW. 2004. Lesions of dorsolateral striatum preserve outcome expectancy but disrupt habit formation in instrumental learning. European Journal of Neuroscience 19:181-189.) which is not consistent with the decay of memory of goal directed system.</p><p>d. The reduction in learning rate with time introduced in OpAL* only makes sense in stable environments. In changing environments decaying learning rate does not make sense, because the animal would be unable to adapt to changing rewards. However, the second figure generated by the code in the Appendix shows that the weights also decrease to 0 in environments where the reward probability constantly fluctuates according to a random walk (in this simulation the rewards are binary, so the normalization of prediction error introduced in OpAL* does not make any difference). In summary, the learning rules of the OpAL model decay to 0 even if the reward probability is constantly changing, so for this case the model is unable to track reward probability no matter if the decrease of learning rate is introduced or not.</p><p>2. The manuscript shows that the OpAL* model can achieve higher rewards than alternative models in simple tasks with constant reward probabilities. However, there are severe problems with the arguments in the paper.</p><p>a. All the simulations are run with a small number of trials (i.e. 100). Beyond this number of trials the OpAL model suffers from decay of weights (see my previous comment), so it is questionable whether it would have performance advantages. Therefore, it is critically important that the performance comparison includes simulations with more (e.g. 1000) trials.</p><p>b. The simple tasks simulated in the paper has been a focus of much research. There is known optimal learning algorithm (Gittins index) and several well performing ones (e.g. Thomson sampling, Upper confidence bound algorithms). I feel that the normative comparison needs to include a comparison with some of these known solutions.</p><p>c. The reason why the OpAL* achieves best performance in the chosen scenario is not well explained. Lines 339-343 present the key of the mechanism: &quot;opponency allows the non-dominant (here, <italic>G</italic>) actor to contribute early during learning (before <italic>N</italic> weights accumulate), thereby flattening initial discrimination and enhancing exploration. Second, the Hebbian nonlinearity ensures that negative experiences induce disproportional distortions in <italic>N</italic> weights for the most suboptimal actions after they have been explored (Figure 6a), thereby allowing the agent to more robustly avoid them (Figures 6b and 6c).&quot; However, the cited figures do not illustrate this mechanism, and to show this, it would be better to show how the weights change during learning.</p><p>d. The performance of model is compared in two ways: (i) for the best parameters for each model and (ii) for an average over the range of parameters. I think that method (i) is valid, but method (ii) may introduce a bias if the range is chosen such that the optimal range for one model overlaps with the tested range for one model more than for another. Therefore, I feel that method (ii) should not be included in the manuscript.</p><p>3. The manuscript also describes comparison of performance of OpAL* with the model by Moeller and Bogacz (2019), however the manuscript includes incorrect statements about the latter model, and the way it is parameters are chosen does not reflect the conditions in simulated scenarios.</p><p>a. The manuscript states in l. 392: &quot;However, in actuality, the convergence to expected payoffs and costs in this model depends on having a constrained relationship between parameters optimized by a priori access to the distributions of rewards in the environment.&quot; This is not true. For a given set of parameters, the convergence to payoffs and costs is guaranteed for any reward distribution – derivation of the condition for encoding payoff and costs in Eq 22 and 23 in Moeller and Bogacz does not make any assumptions about knowledge of reward distribution. Please remove this sentence.</p><p>b. The condition on parameters derived by Moeller and Bogacz are only necessary to learn payoffs and costs if every trial includes a cost (e.g. an effort to make an action) and a payoff (e.g. the outcome of the action). This is not the case in the presented simulations, so the model parameters do not even need to satisfy the conditions of Moeller and Bogacz.</p><p>c. The model is simulated with constant &quot;tonic dopamine&quot; level, and by mathematical construction, in this case the models described by Moeller and Bogacz is mathematically equivalent to Q-learning with decay controlled by parameter λ, and will reduce to the standard Q-learning for λ = 0. Since the Authors simulated Q-learning, it is not even clear if it is necessary to simulate Moeller and Bogacz model because by its definition it will have identical (with λ=0) or very similar performance.</p><p>d. The manuscript states in l. 415: &quot;Finally, the model in Möller and Bogacz (2019) demonstrated poor across-environment performance, performing only slightly above chance in the rich environment. Results are not shown for this model&quot; – one should not make such statements without actually presenting evidence for them.</p><p>Appendix – code simulating OpAL model</p><p>function run_OpAL</p><p>figure(1)</p><p>trials = 2000;</p><p>pr = [0.9 0.8 0.7; 0.1 0.2 0.3];</p><p>labels = {'rich', 'lean'};</p><p>for env = 1:2</p><p>subplot (2,1,env);</p><p>for action = 1:3</p><p>p = zeros (1,trials)+pr(env,action);</p><p>[G,N] = opal (p);</p><p>plot (G, 'g');</p><p>hold on</p><p>plot (N, 'r');</p><p>end</p><p>xlabel ('Trials');</p><p>title (labels{env});</p><p>legend ('G','N');</p><p>end</p><p>figure(2)</p><p>trials = 1000;</p><p>p = zeros (1,trials)+0.1;</p><p>for t = 1:trials<sup>-1</sup></p><p>p(t+1) = p(t) – 0.1*(p(t)-0.5) + 0.1*randn;</p><p>if p(t+1) &gt; 1</p><p>p(t+1) = 1;</p><p>elseif p(t+1) &lt; 0</p><p>p(t+1) = 0;</p><p>end</p><p>end</p><p>[G,N] = opal (p);</p><p>subplot (2,1,1);</p><p>plot (p);</p><p>ylabel ('Reward probability')</p><p>xlabel ('Trials');</p><p>subplot (2,1,2);</p><p>plot (G, 'g');</p><p>hold on</p><p>plot (N, 'r');</p><p>legend ('G','N');</p><p>xlabel ('Trials');</p><p>end</p><p>function [G,N] = opal (p)</p><p>trials = length(p);</p><p>V = zeros (1,trials)+0.5;</p><p>G = zeros (1,trials)+0.1;</p><p>N = zeros (1,trials)+0.1;</p><p>α = 0.2;</p><p>for t = 1:trials<sup>-1</sup></p><p>r = (rand</p><p>δ = r – V(t);</p><p>V(t+1) = V(t) + α*δ;</p><p>G(t+1) = G(t) + G(t)*α*δ;</p><p>N(t+1) = N(t) – N(t)*α*δ;</p><p>end</p><p>end</p><p>Thank you for resubmitting your work entitled &quot;On the normative advantages of dopamine and striatal opponency for learning and choice&quot; for further consideration by <italic>eLife</italic>. Your revised article has been evaluated by Joshua Gold (Senior Editor) and a Reviewing Editor.</p><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>Essential revisions:</p><p>Reviewer 3 still has significant concerns about the stability of the model, and about the mechanisms accounting for its superior performance. Please make sure to fully address all requests for clarification detailed below.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors have successfully addressed my concerns.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors successfully addressed my suggestions.</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>This manuscript proposes a refined version of the OpAL model, which aims to address the numerical instability problems present in the previous version, and demonstrate normative advantages of the model in tasks involving balancing exploration and exploitation.</p><p>I thank the Authors for replying to my review. I feel that the manuscript has been significantly improved, and the comparison of performance with UCB is particularly interesting. Nevertheless, there are still issues that need to be addressed. In particular, it is not clear from the analysis why OpAL* can outperform UCB, and multiple statements about the stability of the model are still misleading.</p><p>Comments:</p><p>1. It needs to be further clarified why OpAL* outperforms UCB and Q-learning. I have to admit that I am surprised by the higher performance of OpAL* over UCB, because UCB is not an easy algorithm to outperform. Unlike Q-learning, UCB has perfect memory of all rewards and does not forget them. Then I realized that OpAL* also has such perfect memory, as its Bayesian critic counts the rewarded and unrewarded trials for each option. I feel this is the main reason why OpAL* outperform Q-learning. I suggest explaining this important property of OpAL* in the text, and it would be good to test it, e.g. by replacing Bayesian critic by a normal forgetful critic, and testing &quot;Contribution of perfect memory&quot;. Please also discuss if such perfect memory is biologically realistic – how could it be implemented in biological neural network?</p><p>However, the most surprising result is that OpAL* outperforms UCB. This cannot be explained by most of the discussion of Mechanism section focussing on the gaps between weights for different options, because such gaps are only important if an algorithm choses actions stochastically based on weights, while UCB is practically a deterministic algorithm (beyond initial few trials it will deterministically chose an option). The only mechanism which can explain outperforming UCB is explained in a paragraph starting in line 574. Please investigate further, and provide a clear explanation for how it is possible for OpAL* to outperform UCB.</p><p>2. The stability of OpAL* model needs to be honestly presented. The main issue pointed by Mikhael and Bogacz (2016) and then by Moeller and Bogacz (2019) is that the weights in OpAL will asymptotically converge to 0. It is still evident from simulations of the OpAL* in the manuscript and in the response letter that on average the weights decay with trials. There is no demonstration that OpAL* can prevent its weights from converging to 0 eventually, and at the same time can respond to changing rewards. In the revised version, such demonstration has been added in Figures 15c right and 15d right, but it is not possible to understand how these simulations were performed from the paper, and it seems that they are for a model with &quot;weight decay&quot;, which is not described in the manuscript. It is not clear if the model with weight decay has the advantages of OpAL* in exploration/exploitation that are the focus of the manuscript. Therefore, I feel that the manuscript has to be modified in one of two ways: The Authors may change the model in the paper to one with weight decay and analyse its performance in exploration/exploitation task. Alternatively, if the current OpAL* model remains the focus of the paper, it needs to be honestly admitted that the OpAL* model suffers from the problem that weights will eventually converge to 0 or the model will stop adapting to changes in the rewards.</p><p>Specific comments:</p><p>Equation 15 – How is std X estimated? Is it computed from the analytic expression for β distribution? If so, this expression is complex (involving division, square, etc.), so please comment on how such computation could be made by biological networks of neurons.</p><p>Equation 22 – Please explain parameter T. As above, please explain how X is computed in the simulation.</p><p>Line 293: &quot;These modifications improve the robustness of OpAL* and ensure that the actor weights are well-behaved&quot; – I do not agree with this statement, because in the OpAL* model the weights still converge to 0 unless they are prevented from convergence to 0 by making the model non-adaptive. Please replace &quot;well behaved&quot; in the cited statement, by a more specific description.</p><p>Line 499: &quot;Indeed, algorithms like Q-learning and UCB converge well when an option is well-sampled, but the speed and accuracy of this convergence is affected by stochastic sampling&quot;. This argument does not apply to UCB, which is deterministic, and hence the sampling in UCB is NOT stochastic.</p><p>Line 582 – this again does not seem to apply to UCB, which is deterministic.</p><p>Figure 6a is very interesting, but I have a few suggestions to make it more informative. I simulated UCB on the problems in Figure 6a and verified that it indeed gives similar performance to that visualized in this figure, but found that with 1000 iterations there is still substantial variability in the results, and sometimes you get non-monotonic changes in accuracy as shown in blue curve in Figure 6a left, which disappear if the number of iterations is increased. Hence, I suggest to increase the number of iterations (repetitions) in Figure 6a to 10,000 to get less noisy curves.</p><p>In Figure 6a the gap between UCB and OpAL* is higher in the right panel but it is not clear if this is due to change in richness or in the number of options. It would be helpful to add two more panels ([0.2 0.3] and [0.8 0.7 0.7 0.7 0.7 0.7]). Also for an easier replicability, it would be good to list the parameters used in simulations of each model.</p><p>l. 1478: &quot;Normalizing, therefore, addresses the valid concerns of Möller and Bogacz (2019) while still preserving core OpAL dynamics&quot;. I do not agree – the key concern of Möller and Bogacz (2019) was that the weights decay to 0 eventually. The normalization does not fix the problem. In the simulations I did in the previous round of the review, rewards were 0 and 1, so the normalization had no effect.</p><p>Equation 30 – I guess the last 2 &quot;cases&quot; were included accidentally (they are a typo), and should be removed.</p><p>l.1112: UCB – Please provide the reference for the paper describing UCB. In this algorithm, the model is initialized to selecting each action once before relying on estimated values. Do you do such initial selection? If so, please say this.</p><p>Throughout – In many places in the manuscript there are references to appendix, but the appendix is long, and it takes time to find information. Hence whenever you point the reader to the appendix, please point to a specific section or figure.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.85107.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the authors resubmitted a revised version of the paper for consideration. What follows is the authors’ response to the first round of review.]</p><disp-quote content-type="editor-comment"><p>Comments to the Authors:</p><p>We are sorry to say that, after consultation with the reviewers, we have decided that this work will not be considered further for publication by eLife.</p><p>Specifically, concerns about the stability and adaptivity of the model, based on actual simulations, were judged serious enough to preclude an invitation to revise. However, if you feel confident that you can compellingly address all issues raised by the reviewers, and the matter of environmental dynamics in particular, we would be happy to consider a resubmission.</p></disp-quote><p>We provide a full point-by-point response below to all Reviewer comments (including adding several new simulations, new account of empirical data, and a favorable comparison to additional RL models with more adaptive exploration mechanisms such as Upper Confidence Bound). But because concerns of stability (i.e., that actor weights decayed to zero with more training) and adaptivity (the ability to flexibly switch policies) were the basis for the decision, this letter focuses first on these issues. We then highlight that, in response to all reviewers, we have now more fully exposed the mechanism by which OpAL* advantages are borne out, and in so doing provide a crisper analysis of how it relates to a broader class of RL algorithms. Addressing the reviews also allowed us to clarify the sense in which our model is normative – in terms of policy optimization – which is different in scope to models that aim to learn the expected values. As we point out below, this comparison is akin to Q learning vs policy gradient or other direct policy search methods in modern RL.</p><p>This stability concern regarding the original model was articulated in the work by Mikhael and Bogacz and Möller and Bogacz, who addressed it by removing the Hebbian term from weight updates in the opponent actors, but adding in other nonlinearities in learning from positive and negative RPEs. Instead, we sought to retain the Hebbian nonlinearity, given its biologically motivation and the several modeling studies showing that it is needed to capture choice performance, motor learning, and plasticity studies across species (Beeler et al. 2012, Cockburn et al. 2014, Wiecki et al. 2009), which we now further emphasize and discuss. But moreover, our main goals were to explore why this seemingly pathological mechanism might be normative in terms of an efficient coding mechanism for choice, especially when DA is properly regulated as a function of reward history. Our main results were (and are) that this combination of mechanisms is more robust and adaptive than not including either of them on their own (or neither of them), including when comparing to standard RL and other algorithms.</p><p>To begin, we note that the main stability concerns highlighted by R3 were based on simulations provided in MATLAB code that did <italic>not</italic> reflect the proposed model in our original submission, but rather the original 2014 OpAL model with particularly pathological parameters that exacerbate these effects. Our newer model did adjust some mechanisms to substantively ameliorate, if not completely eliminate, these stability issues, as we show in more detail below, and as we have now further improved in response to these concerns.</p><p>Stability</p><p>First, as Reviewer 3 correctly points out, initialization of G and N weights affects performance. The standard for OpAL is to initialize such values at 1, which reduces the first trial to a standard TD update rule; any future changes in learning are a function of the whole reward history. Simulations provided by Reviewer 3 initialize this value at.1, leading to rapid decay. Second, the adaptive growth dynamics of the G/N actors in OpAL(*) rely on slow critic convergence relative to actor learning, as we now elaborate in our Mechanism section “Opponency and Hebbian nonlinearity allows OpAL* to optimize action gaps”. The simulations provided by Reviewer 3 include a high learning rate (.2) shared by both the actor and the critic. If we simply reduce actor learning rate to.1 and critic learning rate to.05, the decay is much reduced and the actor weights discriminate between options after extensive learning even within the original OpAL model. We show the results of these simulations in <xref ref-type="fig" rid="sa2fig1">Author response images 1</xref>–<xref ref-type="fig" rid="sa2fig3">3</xref> for completeness, but the actual paper focuses instead on the new model (which is more stable).</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><caption><title>Initial simulations from with Reviewer 3’s code and parameters (more positive G(N) values correspond to actions with higher reward probability in rich(lean)).</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig1-v2.tif"/></fig><fig id="sa2fig2" position="float"><label>Author response image 2.</label><caption><title>Modified learning rates.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig2-v2.tif"/></fig><fig id="sa2fig3" position="float"><label>Author response image 3.</label><caption><title>Modified learning rates and actor initialization.</title></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig3-v2.tif"/></fig><p>We show these more systematically across multiple simulations in response to R3 comments below. In any case, we agree that the decay in the original model needed to be addressed, especially given that a main theme of our paper is that the model should be robust across a range of parameters. In our first submission, we included annealing and normalization to address this. Reviewer 3 noted that our new model “just postpones their effect by introducing learning rates that decay with time, which ensures that the weights simply stop changing as learning progresses.” But (beside the more central contribution on adaptive modulation / efficient coding), the model in the original submission also introduced a Bayesian critic with which to compute RPEs, and a soft annealing of learning rates with time. Simulations from this model <italic>do</italic> show that the (i) weights no longer converge to zero with extensive training, (ii) that the rank order of reward probabilities is still preserved asymptotically, both of which address the limitations highlighted by Mikhael/Moller/Bogacz that resulted from prolonged experience, while retaining the Hebbian nonlinearity (again, needed for the model’s adaptive contributions and for capturing various empirical data). See <xref ref-type="fig" rid="sa2fig4">Author response image 4</xref>, which averages G/N learning curves over 1000 trials (as requested) from the model of original submission (actor learning rate = .5, annealing parameter T = 10):</p><p>We also confirmed that although the learning rates annealed with time, it is not the case that the weights “simply stop changing” altogether – indeed, while the Möller example produced weights that converge to 0 within 20 trials, our simulations in the original manuscript showed that learning continued to improve over 100 trials; we had noted parenthetically that similar advantages hold for multiple hundreds of trials, but we now show this explicitly.</p><fig id="sa2fig4" position="float"><label>Author response image 4.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig4-v2.tif"/></fig><p>We also confirmed that our updated OpAL* annealing mechanism in the new submission also stabilizes actor weights and preferences over prolonged periods. Simulations in the main text were previously for 100 trials but because multiple reviewers were interested in longer asymptotic behavior we have now presented those simulations for 250 trials. See Appendix 1—figure 4 average learning curves for the updated model over 1000 trials, which includes bayesian annealing (critic learning rate = .05, actor learning rate = .5, annealing parameter T = 10). Panels show G weights, N weights, and net Actor values for the same parametrically varying reward probabilities as above.</p><p>Adaptivity</p><p>Nevertheless, we take the reviewer’s point that a simple reduction of learning rate as a function of time is too limiting, and a constant progressive annealing mechanism would eventually impede adaptivity to change points. Indeed, we have previously focused on this stability/flexibility tradeoff in the basal ganglia, showing that it can be optimized by incorporating the role of striatal cholinergic signaling, which gates plasticity induced by dopaminergic RPEs (Franklin and Frank, 2015, <italic>eLife</italic>; see https://www.nature.com/articles/s41467-022-28950-0 for recent evidence of this mechanism). Our model showed that this mechanism can be adaptive when cholinergic signaling is itself modulated by uncertainty across the population of striatal MSNs, stabilizing learning when task contingencies are stationary but increasing adaptivity when they change, mimicking a Bayesian learner. Accordingly, we have now adjusted the OpAL* annealing mechanism to better approximate this mechanism: rather than annealing with time, we now anneal as a function of uncertainty within the Bayesian “meta-critic” (which evaluates the reward statistics of the policy/environment). As the meta-critic becomes more certain about the reward statistics, actor learning rate declines, consistent with Bayesian learning. This annealing is also more adaptive in that when task statistics change, the uncertainty rises and learning rate increases again (see Franklin and Frank for a more thorough investigation).</p><p>To demonstrate the impact of this new annealing mechanism on adaptivity, consider the following switch points in reward contingencies. In <xref ref-type="fig" rid="sa2fig5">Author response image 5</xref>, action A is rewarded 80% of the time and action B is rewarded 50% of the time. After 150 trials the reward contingencies flip. Plots show the softmax probability of selecting action A. On the left is our initial submission with fixed annealing. To the right is our new submission with Bayesian annealing.</p><fig id="sa2fig5" position="float"><label>Author response image 5.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig5-v2.tif"/></fig><p>This flexibility can be further augmented by incorporating decay in the actor weights as proposed by Franklin and Frank, also allowing OpAL* to handle highly volatile environments such as random walks in reward probability. <xref ref-type="fig" rid="sa2fig6">Author response image 6</xref>, the left panel shows random fluctuations in reward contingencies assigned to an action; middle and right the G/N weights of OpAL and OpAL* (with bayesian annealing and decay), respectively. OpAL* actor G/N weights closely follow the random reward schedule. These parameters could be further optimized, but we wished to keep the model in the current paper as simple as possible to equate parameters with competitor models, and switch points are not the focus here. Moreover it is known that more rapid switching involves other brain mechanisms not modeled here, such as prefrontal cortex and hippocampus.</p><fig id="sa2fig6" position="float"><label>Author response image 6.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig6-v2.tif"/></fig><p>We hope these simulations and discussion clarifies that these issues are addressed.</p><p>Finally, while not the main basis for the original <italic>eLife</italic> decision, multiple Reviewers noted that it would be important to provide a clearer explanation of the mechanism for how OpAL* improves performance relative to Q learning and the Moeller and Bogacz model (as well as others). We have now added a much more detailed consideration of this issue, conceptually, analytically, and via simulations, which we unpack here before turning to the point-by-point rebuttal.</p><p>The key issue is that the two classes of models have different normative aims. Möller’s model proves that G and N weights can converge to the expected payoffs and costs of an action, much like a Q value converges to the net expected return. But in both cases, this proof is asymptotic, with no guarantees on how long it takes for such convergence to occur, which can be prolonged when an agent is forced to select among multiple actions to learn their expected outcomes. In RL terms, as a modified actor critic, the OpAL* model is more like a <italic>policy gradient</italic> mechanism that directly optimizes its policy to maximize the return, while obtaining a rapid estimate of the relative <italic>ranking</italic> among alternative actions. Indeed, actor-critics are policy gradient algorithms and neuromodulated activity-dependent plasticity rules such as REINFORCE also implement policy gradients. OpAL* explicitly leverages activity-dependent plasticity together with opponency, and capitalizes on the dynamic DA modulation thereof. In contrast, Q learning and Moller/Bogacz models obtain long-run estimates of the expected values of these actions. It is widely known that policy gradient methods in RL are more suited for environments with large action spaces, consistent with our finding that OpAL* advantages grow with the number of actions, and that Q learning models suffer from reduced “action-gaps” (differences in Q values between the best and next best option) in these environments.</p><p>To unpack this more clearly, we now show that both Q learning and Moller’s model exhibit delays in convergence when selecting among multiple actions, and reduced action gaps, particularly in environments with sparse reward – specifically the setting in which OpAL* advantages are most prominent. We also further elaborate the mechanism by which OpAL* actor weights can quickly discriminate between actions before the Q learning critic converges. We do this (1) via additional simulations directly comparing the evolution of OpAL* weights to those of alternatives for a fixed policy and sequence of outcomes; and (2) analytically we unpack how the OpAL* learning rule allows weights to be updated as a function of the entire history of previous RPEs and is thus less sensitive to spurious outcomes. We also now (3) show that this same learning rule accounts for counterintuitive choice preferences in a new simulated task, as requested by R2.</p><p>However, we do not challenge the notion that it would be useful to obtain estimates of expected costs and benefits explicitly, and it remains possible that the Moller and Bogacz mechanism, or some adaptation thereof, may apply to some aspects of BG function. Indeed we also note that OpAL* still retains access to a Q learning critic which could be leveraged.</p><p>In sum, the central message of our paper is that although the Hebbian mechanism within OpAL* does not produce asymptotic estimates of ground truth expected action cost and benefits, it (i) allows for more rapid assessment of the relative rankings of costs and benefits, (ii) affords an adaptive choice algorithm that is robust to task contingencies, (iii) capitalizes on knowledge about the inferred richness of the environment, (iv) produces benefits that scale monotonically with number of actions in the task, and (v) can account for several datasets across species that can also rationalize the findings that are pathological on the extreme, in a way that is not accommodated by other models.</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The authors aim to demonstrate the normative advantage of opponent basal ganglia pathways, using dynamic dopamine (DA) modulation by environmental reward statistics. The finding that well-known neurophysiological and psychopharmacological mechanisms yield rational decision-making in ecologically plausible environments is a major strength of the paper. The methods are rigorous, and the advantage of the model is reliable across a range of parameters and paradigms. More could be done to explain the optimality of certain model predictions, to map the correspondence between model predictions and animal behavior, and to articulate the conceptual relationship between relevant constructs, such as exploration, discrimination, and risk-taking. Nevertheless, the scope of the model, its biological plausibility, and its normative and descriptive aspects suggest that it may have a significant impact.</p><p>1. More could be done to detail the, sometimes counterintuitive, optimality of certain model predictions. For example, while it is straightforward that you need to explore to discover better options, the need to sample sub-optimal options so that you know to avoid them makes less sense: if you don't sample them, you are already avoiding them, and when you do choose them, you learn the values – why is it adventitious to do the sampling early in the process as opposed to later? Another example is the claimed optimality of avoiding gambles in lean environments, despite the expected value of the gamble being greater than that of the ST.</p></disp-quote><p>Thank you for this comment and opportunity to further explain the adaptive nature of the choice mechanism for learning. We agree the mechanism is counterintuitive and we have expanded the Mechanism section to more clearly expose it. We focus here on the sparse reward (lean) conditions, in which the advantages of OpAL* are more clear. The key issue is that in “vanilla” RL, when the optimal action produces few rewards, its value declines, causing the agent to switch away from it toward sub-optimal actions. The agent will eventually choose the sub-optimal actions enough to learn they are even worse and switch back to the optimal action. The net result is more stochastic switching between actions during early learning, especially in lean environments. This effect is amplified as the number of actions increases. Thus it is indeed true that “when you do choose the [suboptimal actions], you learn the values”, but learning the values of all suboptimal actions requires repeated choices of each of these actions, leading to suboptimal performance.</p><p>In OpAL*, once the meta-critic detects it is in a sparse reward environment, dynamic DA modulation allows it to rely preferentially on its N actor. Initial exploration of sub-optimal actions early allows the Hebbian nonlinearity to amplify those weights sufficiently so that they are avoided robustly, producing less switching (retaining the ability to switch if change points are encountered). Thus while a Q learner may, after much more experience, produce more robust estimates of action values for all actions, OpAL* instead optimizes how quickly the agent can <italic>rank</italic> the best action over the others.</p><p>To help communicate this counterintuitive point, we have now expanded our mechanism section and have included exemplar simulations and analysis. These show that Q learning (and related agents that rely on expected values of alternative actions) show impeded convergence of those values when making choices, unless they receive full feedback not only on the rewards of the actions they chose but also those they didn’t choose; (ii) this results in a reduced “action-gap” (difference between Q values for optimal and second best option), specifically in sparse reward environments; (iii) this is accompanied by more stochastic switching. We then show (analytically and via simulations) that OpAL* circumvents this issue because its nonlinear update rule allows the actor weights to be sensitive to not just the most recent RPE, but the history of such RPEs, thereby accentuating its ability to discriminate between different reward probabilities in either the high (G) or low (N) range. The dynamic DA modulation based on the meta-critic can then guide action selection according to the actor most specialized for the environment (efficient coding).</p><disp-quote content-type="editor-comment"><p>2. It would be helpful if there was a description, early in the Introduction, and perhaps again in the Discussion, of how the relevant constructs (i.e., exploration, discrimination, and risk-taking), are related conceptually – note that exploration can be characterized as risk-taking and that the decision to gamble may reflect either exploration or value-based discrimination.</p></disp-quote><p>We agree that these terms require clarifying as they can carry multiple meanings. We have included a description of the scope and definitions of terms that we explore in the introduction.</p><disp-quote content-type="editor-comment"><p>3. In Figure 10a, it is unclear why L-DOPA does not boost G weights and reduce N weights, yielding a greater probability of gambling, on loss trials as it does on gain trials?</p></disp-quote><p>In our simulations, L-DOPA amplifies endogenous changes in dopamine: because it enhances presynaptic DA synthesis, we modeled it as boosting the phasic signal that would have occurred naturally (see also Collins and Frank 2014). According to OpAL*, only gambles whose net expected values are larger than average will induce an increase in DA levels during choice, and it is these transient increases that are then further amplified by L-DOPA, leading to the selective change in gambling in gain gambles.</p><disp-quote content-type="editor-comment"><p>4. In Equations 1-3, why not show the updating of Act values, or, if identical to V(a), be explicit about that. Also, Equation 14 is referred to as a prediction error in the text, but the notation indicates an action value [i.e., V(a)].</p></disp-quote><p>Thank you for this feedback. The definition for Act was defined later in the section, which is an unhelpful ordering. We therefore have switched the order of this section for clarity and introduce the softmax equation only after properly defining Act.</p><disp-quote content-type="editor-comment"><p>5. It is argued that OpAL* eliminates the need for a priori knowledge about environmental reward statistics, but DA-modulation depends on confident estimates of the values (i.e., reward probabilities) of all available actions – the implications of this reliance on reward estimates seem under-explored in simulations.</p></disp-quote><p>The critical distinction is that OpAL* does not need advance knowledge about reward statistics to select its hyper parameters – the DA modulation only occurs once the agent has accrued enough information about reward statistics in the current environment, at which point it can leverage the nonlinearity in the G/N weights to improve its policy. Furthermore, to clarify, the confidence estimates of reward statistics needed for DA modulation concern the <italic>overall</italic> environmental richness (in the “meta-critic”), NOT the accuracy of action values. In this sense, the explore-exploit dilemma here is one in which uncertainty is used to first guide more stochastic action selection according to both actors, and then transition to exploiting the <italic>actor</italic> more adept for the task, without specifying which <italic>action</italic> should be selected per se. In our simulations, for simplicity we fixed the degree of confidence required before modulating DA (phi) to be 1.0 (i.e. one standard deviation). In theory this parameter could also be optimized to improve performance further, but that would make the agent more complex and more difficult to compare with alternatives.</p><disp-quote content-type="editor-comment"><p>6. It is unclear from the curves in Figure 7 whether the models reach equilibrium by 100 trials. Please show asymptotic performance.</p></disp-quote><p>We now have added simulations up to 1000 trials, with a minimum of 250 trials, showing asymptotic performance. All performance advantages hold in these new simulations.</p><disp-quote content-type="editor-comment"><p>7. Why use only forced-choice simulations? It is hard to imagine a real-world scenario in which &quot;no action&quot; is not an alternative. Failure to include such an option detracts from the ecological validity of the experiments.</p></disp-quote><p>Previous work with the OpAL model explored how the model may account for “no action” scenarios in effort based decisions, by including a threshold to compare Act, i.e. benefits must outweigh costs by a sufficient amount for actions to be emitted. Specifically, Collins and Frank demonstrated OpAL’s architecture captures impacts of DA depletion on effort base choice (e.g., work by Salamone) and number of actions emitted, and how they interact with learning. This model also simulated the impacts of DA depletion on learned catalepsy (avoidance of actions that increase with time in DA depletion), as in Beeler el al, 2012 and Wiecki et al., 2009. (Notably those effects depend on the Hebbian term to manifest, which is pathological when DA is depleted; our point here is that this same mechanism is adaptive under healthy endogenous DA). While we do not reproduce those effects here, we do explore gambling simulations which are formulated such that the model is learning whether or not to select a gamble, which is encoded relative to the sure thing. That is, the agent is learning whether to take an action (e.g. select the gamble) or not take an action (and receive some default). The default can be defined as any desired threshold of value below which alternatives are not selected.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>I really enjoyed this paper that significantly advance our understanding of the basal ganglia circuit. I have some suggestions for additional simulations that can allow establishing to which extent previous findings in reinforcement learning can be accounted for by the OpAL(*) models.</p><p>A key concept of the model is its sensitivity to environmental richness (i.e., whether the agent is in a lean or in a rich environment). The concept behind the &quot;rho&quot; variable is very closely related to that of &quot;state value&quot; or &quot;reference point&quot; as it has been applied to reinforcement learning and valuation since Palminteri et al. (2015). The key demonstration of a crucial role of overall &quot;environmental richness&quot; in learning and valuation came from a task, which, explicitly coupling features of the Frank (2004) and Pessiglione (2006) tasks, showed that transfer learning performance is highly context-dependent (see Palminteri and Lebreton, 2021; Daw and Hunter, 2021 for review of these results). My question here is whether or not the OpAL(*) models are sufficient to generate such context-dependent preferences. Does this (very robust) behavioral effect naturally emerge from the model? Or do we need to specify an additional process to explain this? Can you simulate Palminteri et al. (2015) using the OpAL(*) models and show what are the performance in the learning and transfer phase?</p></disp-quote><p>We are delighted to hear the paper was enjoyable and we thank the reviewer for their feedback. We agree that the connection of our work to the reference point literature cited is quite clear. We have now included simulations of the Palminteri et al. (2015) task as an additional example of counter-intuitive experimental data, which OpAL* can indeed capture. This is accomplished when the critic considers context-value rather than action value, so that the less frequently rewarded stimuli (gain 25) induce negative RPEs relative to what could have been obtained had the other action been selected (this is justified given that full information was provided to participants in this condition). As such the N weights grow for Gain 25, and conversely the G weights grow for the more frequent loss avoider (loss 25). In principle, one could also directly use the meta-critic tracking state value as formulated currently to then influence the Q-learning critic’s, akin to the model proposed by Palminteri. We considered the context-value critic as a more parsimonious model within the OpAL* framework, and therefore now feature it in our Results section.</p><disp-quote content-type="editor-comment"><p>A robust and replicable finding in human (and nonhuman) reinforcement learning is that when fitting the model with two learning rates for positive or negative prediction errors (starting from Frank et al. 2007, supplementary materials, continuing in Lefebvre et al. 2017; Gagne et al. 2020; Farashahi et al. 2019; Ohta et al. 2021; Chambon et al. 2020 – the rare occurrences of the opposite pattern are generally explained by wrongly initializing the Q-values at pessimistic values). The optimality of this bias has been sometimes investigated (see Cazé and Van den Merr 2013; Lefebvre et al. 2022). My question here is whether and/or under which circumstances do the OpAL(*) models explain the ubiquity of this pattern? If you simulate OpAL(*) models and then fit the asymmetric model, would you (quasi-)systematically retrieve the asymmetric pattern?</p></disp-quote><p>We agree that it is also worthwhile to consider the optimality of learning asymmetries, which could be manifest by changes in learning rates from positive vs negative RPES as in the above studies, or in OpAL* it could be considered as imbalances in learning rates within G and N actors. Our focus in the present manuscript is on how dynamic DA optimizes the policy during decision making, and show that this can impact risky choice and learning without requiring additional asymmetries in learning rates per se. Moreover, in the original OpAL paper, Collins and Frank showed that empirically one can reproduce empirical patterns resulting from DA manipulations on learning from positive vs negative RPEs in a more parsimonious and monotonic fashion when simulating asymmetries in alphaG vs alphaN instead of positive vs negative RPEs (see Figure 8 and Figure A1 in the appendix of that paper for comparison).</p><p>While we could additionally explore the optimality of asymmetries in learning rates, as per the above studies, this would again add further complexity and degrees of freedom. Moreover, the manuscript has become quite extensive (including many normative comparisons, simulations and analysis to unpack the mechanism, robustness to stability and adaptivity, and simulations of 6 different empirical datasets across species). We therefore prefer to maintain the focus here.</p><disp-quote content-type="editor-comment"><p>Finally, the actor prediction errors are normalized. I can see the logic of this. I was nonetheless puzzled by the functional form of the normalization that is not really a range normalization (Lmag is lacking at the numerator). Consider for example Bavard et al. (2021), which propose a full range normalization rule. What is the rationale for this particular form of normalization? Are Lmag and Rmag learned (via δ rule or other, see Bavard et al.) or specified in advance?</p></disp-quote><p>The Rmag and Lmag are specified in advance, but in theory can be learned via a δ rule. The specific formulation was designed to constrain prediction errors within the range of 1 and -1, which absolutely can be achieved with alternative formulations. Our results are not dependent on this exact formulation; indeed, the vast majority of our main results utilize a reward magnitude of 1 and a loss magnitude of 0, so normalization as proposed by Bavard et al. would generate the same results. In either case, the effect of normalization is negligible as it reduces to dividing by one. We also note that the PE normalization we used is that projected to the ACTORS, not that is used by the critic; that is, rather than normalizing the reward directly, we are modifying the RPE signal used to learn a policy. As we now further unpack in the Mechanism section, the normative contribution of OpAL* concerns the actor policy and not accurately estimating values. Because the actors also learn via a three factor hebbian term where high G/N weights cause excess variance, we therefore feel it reasonable to modify the RPE used by the actors only. For our simulations that do include various magnitudes (the gambling simulations), G and N weights are set explicitly and therefore no normalization applies. The sole exception is the simulations proposed by Moller and Bogacz (which prompted the inclusion of normalization) that demonstrate rapid decay with rewards of 2 and losses of -1. Here, again, either normalization formulation is sufficient and helps stabilize the G and N weights. As our primary focus was to characterize flexibility of OpAL*, we believe the proposed normalization is sufficient to demonstrate how normalization in general may be applied to stabilize OpAL* weights but we leave the exact formulation (and the learning of its Rmag and Lmag parameters) for future work.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>This manuscript proposes a refined version of the OpAL model, which aims to address the numerical instability problems present in the previous version and demonstrate the normative advantages of the model in learning tasks. Unfortunately, the instability problems still persist in the proposed model, and the normative comparison is unconvincing due to the limited range of scenarios and tasks investigated.</p><p>Comments</p><p>1. It has been previously pointed out that the OpAL model is numerically unstable: all synaptic weights converge to 0 with learning, and as a result, the model has a tendency to make random choices with practice. The authors claim that the proposed model &quot;addresses limitations of the original OpAL&quot;, but in fact, it does not – it just postpones their effect by introducing learning rates that decay with time, which ensures that the weights simply stop changing as learning progresses. Consequently, there are several problems with the proposed argumentation in the paper:</p></disp-quote><p>Please see introduction to this response, where we have extensively considered these issues. While we did not fully agree with the characterization, we do appreciate that the reviewer forced us to confront these issues more thoroughly and improve our model using Bayesian annealing.</p><disp-quote content-type="editor-comment"><p>a. The paper does not adequately describe the scale of the stability problem faced by the original OpAL model. A cartoon in Figure 1 falsely suggests that the weights in the OpAL model converge to stable values with learning, by contrast even for this scenario all weights decay to 0. The appendix attached below this review contains Matlab code simulating the OpAL model, and the first figure generated by this code shows OpAL model simulations corresponding to Figure 1. Running the code clearly shows that all weights decay to 0 in this simulation. Therefore, weight evolution in the OpAL model in Figure 1, needs to show the actual simulation of the OpAL model rather than cartoons with qualitatively different behaviour of the weights.</p></disp-quote><p>Figure 1 came from the original OpAL paper and actual simulations (using low fixed learning rates and initializing G/N weights to 1). The decay to 0 would happen within that model with much longer time horizons. We now show explicitly that weights do not decay to 0 (even in the original OpAL model, but especially with the new model). As noted above the simulations provided here (which were the basis of rejecting the paper) were from the previous model, not from the new one! Much time was invested in adapting the model and simulating the various scenarios described in this paper and we feel this comment was overly dismissive, particularly as the normative advantages we showed clearly would not have held had the weights decayed to zero so quickly. Nevertheless, again as noted in the introduction we have now improved the annealing mechanism further so that it is sensitive to uncertainty and retains adaptivity, while still providing stable ranked estimates of actor weights.</p><disp-quote content-type="editor-comment"><p>b. Similarly, a reader may get a false impression that the instability problems only occur in the scenario in Figure 13, because the manuscript states in lines 1104-1105 that the OpAL model &quot;in carefully constructed situations, gives rise to unstable actor dynamics&quot;. However, as pointed out in my previous comment, these problems are ubiquitous, and in fact, Mikhael and Bogacz (2016) also illustrated this problem in Figure 9 of their paper for randomly generated rewards. The reason why Moeller and Bogacz (2019) considered the scenario in Figure 13 is that for this case one can easily show analytically that the weights in the OpAL model converge to 0.</p></disp-quote><p>The Reviewer is correct that the stability issue from the original OpAL model goes beyond that of the Moeller and Bogacz scenario; we meant that this situation was carefully constructed to show a particularly pernicious version of it, given that the decay happened within 20 trials of experience. This is why we addressed that particularly problematic scenario with the new model and showed that OpAL* preserves rankings of G/N weights for 1000 trials (as per <xref ref-type="fig" rid="app1fig4">Appendix 1—figure 4</xref> we now adapt it further to address your other comments). In more canonical reward probability learning scenarios, even the original OpAL doesn’t decay until much later (unless fast learning rates or initial weight values &lt; 1 are used). Moreover, in <xref ref-type="fig" rid="sa2fig7">Author response image 7</xref> you can see that despite the decay, even at 1000 trials the rankings of the actor values are preserved, with the dominant actor still showing a large action gap for high (G) or low (N) reward probabilities.</p><fig id="sa2fig7" position="float"><label>Author response image 7.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig7-v2.tif"/></fig><p>Original OpAL model, average G/N/Act over 100 simulations, critic learning rate = .05, actor learning rate = .1</p><disp-quote content-type="editor-comment"><p>c. To solve the stability problem, the authors modify the model such that the learning slows with time. However, they admit in l.1130: that the model loses its memory with time, and they propose that the habit system may take over learning and rescue animal bahaviour. However, animals with lesions of dorso-lateral striatum (which is known to underlie habitual behaviour) still can perform learned tasks (Yin HH, Knowlton BJ, Balleine BW. 2004. Lesions of dorsolateral striatum preserve outcome expectancy but disrupt habit formation in instrumental learning. European Journal of Neuroscience 19:181-189.) which is not consistent with the decay of memory of goal directed system.</p></disp-quote><p>As noted above our newer model addresses this issue via Bayesian annealing. Moreover, although some researchers consider the DLS to be the seat of habitual behavior, several neural network models suggest that striatum is only needed to <italic>learn</italic> the habit, but that automatized behavior is supported directly by Hebbian stimulus-response learning from sensory to motor cortex. Please see Beiser Hua and Houk 1996, Ashby et al. (“SPEED model” focusing on just this), as well as neural net models preceding OpAL by our group, Frank 2005, Frank and Claus 2006, Ratcliff and Frank 2012 (see http://ski.clps.brown.edu/BGmodel_movies.html for an animation of this; search ‘habit’). The finding that animals with DLS lesions still perform learned tasks is precisely what is expected from these models, which propose that the BG is only needed for gating motor responses that the cortex can’t resolve without a disinhibitory boost. Indeed Parkinson’s patients can famously execute very well learned skills but not novel ones, and cats with striatal lesions only have trouble converting a learned reward value into action but not executing familiar actions. Nevertheless, as we now unpack below and in the manuscript, it is also possible that the agent could make use of the critic value for action selection once it is converged, even if the actor weights were to decay (we do not leverage this mechanism in the manuscript).</p><disp-quote content-type="editor-comment"><p>d. The reduction in learning rate with time introduced in OpAL* only makes sense in stable environments. In changing environments decaying learning rate does not make sense, because the animal would be unable to adapt to changing rewards. However, the second figure generated by the code in the Appendix shows that the weights also decrease to 0 in environments where the reward probability constantly fluctuates according to a random walk (in this simulation the rewards are binary, so the normalization of prediction error introduced in OpAL* does not make any difference). In summary, the learning rules of the OpAL model decay to 0 even if the reward probability is constantly changing, so for this case the model is unable to track reward probability no matter if the decrease of learning rate is introduced or not.</p></disp-quote><p>Thank you for this point, which motivated us to improve our model. As mentioned in the introduction to this letter, OpAL can account for this varying reward giving a slower critic and actor learning rates, though exhibits mild decay. But we agree that annealing will indeed decrease an agent’s responsiveness to change points in task contingencies, and as such, we now prescribe our annealing as a function of uncertainty of the meta-critic to remain sensitive to switch points in the environment (see more details above). We also highlight above in the Adaptivity section how further augmenting OpAL* with weight decay, as proposed by Franklin and Frank, allows OpAL* to flexibly track highly volatile environments such as random walks of rewards. We again note that changing the parameters of the original OpAL model such that the critic learning rate and actor learning rates are smaller (0.05 and.1, respectively) allows even the original OpAL to adequately follow random walks in rewards with milder decay.</p><disp-quote content-type="editor-comment"><p>2. The manuscript shows that the OpAL* model can achieve higher rewards than alternative models in simple tasks with constant reward probabilities. However, there are severe problems with the arguments in the paper.</p><p>a. All the simulations are run with a small number of trials (i.e. 100). Beyond this number of trials the OpAL model suffers from decay of weights (see my previous comment), so it is questionable whether it would have performance advantages. Therefore, it is critically important that the performance comparison includes simulations with more (e.g. 1000) trials.</p></disp-quote><p>As requested, we have now modified our explorations so that the minimum number of trials used is 250, but we also show advantages for up to 1000 trials. Moreover, while we focus on these simple reward probability tasks for the normative advantages, the general issue we highlight with sparse reward and large action spaces is appreciated in the RL literature, and thus the key points that we address should in principle scale to those situations involving model-free RL. We also simulate several other task set ups to compare our model to empirical data, and we do not know of other models that can capture this range of data.</p><disp-quote content-type="editor-comment"><p>b. The simple tasks simulated in the paper has been a focus of much research. There is known optimal learning algorithm (Gittins index) and several well performing ones (e.g. Thomson sampling, Upper confidence bound algorithms). I feel that the normative comparison needs to include a comparison with some of these known solutions.</p></disp-quote><p>Because the Gittins index does not scale to other scenarios, and requires explicit computation not typically considered in the realm of model-free RL, we focus instead on the upper confidence bound heuristic that is featured in both biological and machine learning, and which does not require a posterior distribution to sample from. We now include UCB in our models for comparison and demonstrate that OpAL* exceeds or achieves comparable performance for various time horizons, including 1000 trials in the most difficult environment we explored (lean with 6 options). We unpack this in the manuscript.</p><disp-quote content-type="editor-comment"><p>c. The reason why the OpAL* achieves best performance in the chosen scenario is not well explained. Lines 339-343 present the key of the mechanism: &quot;opponency allows the non-dominant (here, G) actor to contribute early during learning (before N weights accumulate), thereby flattening initial discrimination and enhancing exploration. Second, the Hebbian nonlinearity ensures that negative experiences induce disproportional distortions in N weights for the most suboptimal actions after they have been explored (Figure 6a), thereby allowing the agent to more robustly avoid them (Figures 6b and 6c).&quot; However, the cited figures do not illustrate this mechanism, and to show this, it would be better to show how the weights change during learning.</p></disp-quote><p>In response to your comments and that of R1, we have expanded our mechanism section, including explicit demonstration of how the N weights evolve over learning and compare relative to Q learner and a non hebbian alternative (equivalent of vanilla actor critic model). Please see details above and in the Mechanism section.</p><disp-quote content-type="editor-comment"><p>d. The performance of model is compared in two ways: (i) for the best parameters for each model and (ii) for an average over the range of parameters. I think that method (i) is valid, but method (ii) may introduce a bias if the range is chosen such that the optimal range for one model overlaps with the tested range for one model more than for another. Therefore, I feel that method (ii) should not be included in the manuscript.</p></disp-quote><p>A critical feature of OpAL* (and central point of the paper) is that it enhances performance across a range of hyper parameter settings, without requiring the model to know which parameters are optimal. We interpret this finding as evidence for OpAL*’s flexibility when the statistics of a novel environment are unknown or incorrectly assumed. Given the divergent explore/exploit trade-offs across environments (we use rich and lean here as extreme examples), OpAL*’s ability to adapt quickly and robustly is a key characteristic. Therefore, we felt that including performance over a range of parameters as well as the optimal performance is informative. Nevertheless, we ensured that the optimal cross-environment parameters for comparison models fell within the specified range and conducted additional analysis verifying that our conclusions held when only considering the top 10% performing parameters for each agent in each environment. That is, a Q learner may have high performance for one set of parameters in one environment, but when that parameter set is used in another environment performance suffers.</p><disp-quote content-type="editor-comment"><p>3. The manuscript also describes comparison of performance of OpAL* with the model by Moeller and Bogacz (2019), however the manuscript includes incorrect statements about the latter model, and the way it is parameters are chosen does not reflect the conditions in simulated scenarios.</p><p>a. The manuscript states in l. 392: &quot;However, in actuality, the convergence to expected payoffs and costs in this model depends on having a constrained relationship between parameters optimized by a priori access to the distributions of rewards in the environment.&quot; This is not true. For a given set of parameters, the convergence to payoffs and costs is guaranteed for any reward distribution – derivation of the condition for encoding payoff and costs in Eq 22 and 23 in Moeller and Bogacz does not make any assumptions about knowledge of reward distribution. Please remove this sentence.</p></disp-quote><p>We agree that we incorrectly summarized the limitation of Moeller and Bogacz, and we have removed this sentence (we did see performance advantages relative to that model and wrongly assumed that it must be due to parameter specification). As noted in the Introduction to this letter and response to R1, the Reviewers’ comments have motivated us to better unpack the source of the differences between models. We thus now focus on the difference in the scope / aims of these models in context of the larger RL literature regarding models that learn expected values vs those that optimize policies. Given the Moeller and Bogacz model falls in the former class, we show that it faces similar explore/exploit, convergence, and action-gap difficulties in the lean environment akin to Q-learning. We further demonstrated in this manuscript revision how stochastic sampling causes misestimations in convergence, akin to Q-learning, with differing patterns across rich and lean environments. We then expose how the OpAL* mechanism can speed learning in lean environments with multiple actions, via new simulations and analysis (see response to R1 and the new manuscript under “Mechanism”).</p><disp-quote content-type="editor-comment"><p>b. The condition on parameters derived by Moeller and Bogacz are only necessary to learn payoffs and costs if every trial includes a cost (e.g. an effort to make an action) and a payoff (e.g. the outcome of the action). This is not the case in the presented simulations, so the model parameters do not even need to satisfy the conditions of Moeller and Bogacz.</p></disp-quote><p>We now explicitly expose the Moeller and Bogacz model to tasks with explicit payoffs and costs, similar to the probabilistic one-armed bandit of Figure 5c of their paper.</p><disp-quote content-type="editor-comment"><p>c. The model is simulated with constant &quot;tonic dopamine&quot; level, and by mathematical construction, in this case the models described by Moeller and Bogacz is mathematically equivalent to Q-learning with decay controlled by parameter λ, and will reduce to the standard Q-learning for λ = 0. Since the Authors simulated Q-learning, it is not even clear if it is necessary to simulate Moeller and Bogacz model because by its definition it will have identical (with λ=0) or very similar performance.</p></disp-quote><p>We agree with the authors that there is overlap between the performance predictions of Q learning and the Moeller and Bogacz model, nonetheless we find it informative to include both in our paper to highly that OpAL*’s advantages are not only a product of opponency but also Hebbian nonlinearity. The Moeller and Bogacz model provides a useful comparison in this light.</p><disp-quote content-type="editor-comment"><p>d. The manuscript states in l. 415: &quot;Finally, the model in Möller and Bogacz (2019) demonstrated poor across-environment performance, performing only slightly above chance in the rich environment. Results are not shown for this model&quot; – one should not make such statements without actually presenting evidence for them.</p></disp-quote><p>We have since discovered in our initial submission that the value of β was not properly being applied in the softmax choice function of this model for certain simulations. Therefore, the model, particularly in high complexity environments, was performing near chance as it was not able to effectively exploit its learning. We have since corrected this bug, and removed this sentence, although the general result remains re: OpAL* advantages across environments.</p><p>[Editors’ note: what follows is the authors’ response to the second round of review.]</p><disp-quote content-type="editor-comment"><p>The manuscript has been improved but there are some remaining issues that need to be addressed, as outlined below:</p><p>Reviewer #3 (Recommendations for the authors):</p><p>This manuscript proposes a refined version of the OpAL model, which aims to address the numerical instability problems present in the previous version, and demonstrate normative advantages of the model in tasks involving balancing exploration and exploitation.</p><p>I thank the Authors for replying to my review. I feel that the manuscript has been significantly improved, and the comparison of performance with UCB is particularly interesting. Nevertheless, there are still issues that need to be addressed. In particular, it is not clear from the analysis why OpAL* can outperform UCB, and multiple statements about the stability of the model are still misleading.</p><p>Comments:</p><p>1. It needs to be further clarified why OpAL* outperforms UCB and Q-learning. I have to admit that I am surprised by the higher performance of OpAL* over UCB, because UCB is not an easy algorithm to outperform. Unlike Q-learning, UCB has perfect memory of all rewards and does not forget them. Then I realized that OpAL* also has such perfect memory, as its Bayesian critic counts the rewarded and unrewarded trials for each option. I feel this is the main reason why OpAL* outperform Q-learning. I suggest explaining this important property of OpAL* in the text, and it would be good to test it, e.g. by replacing Bayesian critic by a normal forgetful critic, and testing &quot;Contribution of perfect memory&quot;. Please also discuss if such perfect memory is biologically realistic – how could it be implemented in biological neural network?</p></disp-quote><p>Thanks for encouraging us to further clarify this issue. In fact, the revised OpAL* uses a standard critic with a fixed learning rate and does not have access to the full sequence of rewards. Only the “meta-critic”, which evaluates whether the environment as a whole is rich or lean, is Bayesian, providing it a measure of confidence (uncertainty) in the richness of the environment before it modulates dopamine – but crucially, it does not represent Bayesian values for each action and cannot use its estimation for action selection. Regarding biological mechanism, as we discuss in the manuscript (beginning line 236), we envision the meta-critic to involve prefrontal regions that represent such reward statistics / task state and in turn modulate striatal dopamine via projections to cholinergic interneurons. There are several computational papers that suggest full posterior distributions may be represented in biological neural networks (e.g., Ma et al. 2006 and 2008, Pecevski and Maass 2016, Deneve 2008, Deneve et al. 1999), and in this case the computational demands are simpler due to the use of a β distribution (which simply requires incrementing two counts, from which the mean and variance can be easily accessed). Moreover, while we use a Bayesian implementation of the meta-critic because it has a principled measure of certainty, this is likely not essential for the advantages we report: indeed, we only use the posterior distribution in a rudimentary way – we simply imposed an arbitrary threshold for the amount of uncertainty (precisely 1 standard deviation) tolerated before dopamine is modulated, and we did not adjust this hyperparameter. Thus many other non-Bayesian heuristic approximations would behave very similarly, including a traditional RL critic that simply evaluates whether its estimate of environmental richness is above or below 0.5 for multiple trials in a row before modulating dopamine. In sum, the perfect memory, at least in this context, is a red herring.</p><p>However, as we emphasized in the previous submission and the current one (Equation 24 in the Mechanism section), OpAL*’s actor learning rule implicitly does contain information about the entire history of reward (prediction errors) due to its recursive update rule. The analytic expansion showed that each weight update is influenced not only by the current RPE (as in standard RL) but also by each of the previous RPEs with equal weight (ie scaled by α) and their higher order interactions (scaled by α^2 and so on). This is what enables the nonlinear actors to accentuate differences in reward statistics within rich or lean environments and to exploit the best option (this is perhaps best demonstrated by the fixed policy simulations in Figure 8c).</p><disp-quote content-type="editor-comment"><p>However, the most surprising result is that OpAL* outperforms UCB. This cannot be explained by most of the discussion of Mechanism section focussing on the gaps between weights for different options, because such gaps are only important if an algorithm choses actions stochastically based on weights, while UCB is practically a deterministic algorithm (beyond initial few trials it will deterministically chose an option). The only mechanism which can explain outperforming UCB is explained in a paragraph starting in line 574. Please investigate further, and provide a clear explanation for how it is possible for OpAL* to outperform UCB.</p></disp-quote><p>We agree the advantage over UCB is striking, given its access to the sample mean of each option and a strategic exploration strategy. We have now further clarified (via simulations and text) why UCB still suffers in policy performance as the number of actions grows. While UCB is deterministic, the sample mean that it obtains for a given action shows impeded performance due to (i) partial sampling (first and third, column Figure 8—figure supplement 2) and (ii) the exploration bonus (second and fourth column, Figure 8—figure supplement 2). The partial sampling effect on convergence is similar to Q-learning, i.e, the precise expected value of an action is only accurate after it has been chosen sufficiently often, thus requiring the agent to choose all actions sufficiently often to converge. The exploration bonus is aimed at ensuring the agent revisits actions for which its values are not sufficiently well estimated, and in a partial sampling environment, this continues to impact UCB policy even at 1000 trials (RICH/LEAN Q+BONUS vs. RICH/LEAN, second and fourth column). Both the convergence and exploratory bonus issues are further amplified in higher complexity (with more actions). Thus while choice is deterministic on a single trial, the UCB agent still switches between actions across trials and thus vacillates in its policy.</p><p>In contrast, OpAL* progressively becomes more deterministic in its policy. The nonlinear update rule is sensitive to the full sequence of RPEs, and once it sufficiently discriminates between the options, it can exploit the best one, which progressively increases the action gap and dynamic dopamine modulation then further amplifies this action gap. This can be seen in the variance of the policy of UCB compared to OpAL* in Figure 8b.</p><p>Lastly, while we examine optimal learning curves to illustrate differences in performance across agents, our main focus is on the robustness of performance across parameter settings. UCB performance is highly sensitive to its exploration parameter, evidenced by the decreasing trend in its histograms (Figure 6b). To further illustrate this point, in (<xref ref-type="fig" rid="sa2fig8">Author response image 8</xref>) we plot the UCB top-performing parameters by cross-environment performance. We see that UCB has a narrow range in which its performance is optimized and moreover, the best-performing exploration bonus parameter differs according to the complexity of the environment. In particular, as the number of actions grows, the UCB agent has to reduce its exploration bonus in order to achieve greater performance, because this bonus serves to encourage excessive exploration that impedes the policy.</p><fig id="sa2fig8" position="float"><label>Author response image 8.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig8-v2.tif"/></fig><p>We have updated our text to reflect this discussion and included the convergence figures in our supplementary section.</p><disp-quote content-type="editor-comment"><p>2. The stability of OpAL* model needs to be honestly presented. The main issue pointed by Mikhael and Bogacz (2016) and then by Moeller and Bogacz (2019) is that the weights in OpAL will asymptotically converge to 0. It is still evident from simulations of the OpAL* in the manuscript and in the response letter that on average the weights decay with trials. There is no demonstration that OpAL* can prevent its weights from converging to 0 eventually, and at the same time can respond to changing rewards. In the revised version, such demonstration has been added in Figures 15c right and 15d right, but it is not possible to understand how these simulations were performed from the paper, and it seems that they are for a model with &quot;weight decay&quot;, which is not described in the manuscript. It is not clear if the model with weight decay has the advantages of OpAL* in exploration/exploitation that are the focus of the manuscript. Therefore, I feel that the manuscript has to be modified in one of two ways: The Authors may change the model in the paper to one with weight decay and analyse its performance in exploration/exploitation task. Alternatively, if the current OpAL* model remains the focus of the paper, it needs to be honestly admitted that the OpAL* model suffers from the problem that weights will eventually converge to 0 or the model will stop adapting to changes in the rewards.</p></disp-quote><p>We of course agree with the reviewer that (in general), increased stability can trade off with flexibility. This is not surprising as stability and flexibility naturally trade-off more broadly in the literature and many modeling and empirical papers focus on this trade-off. We now mention this explicitly in the main text and appendix.</p><p>“Of course, the stability-flexibility tradeoff remains, and the level of annealing could be further optimized dynamically, as shown specifically within OpAL (Franklin and Frank, 2015) and more broadly in the literature (Nassar et al., 2012; Iglesias et al., 2013). This stability-flexibility trade-off is particularly apparent in drifting reward environments (Appendix; Figure A3d), but optimization for this tradeoff is largely orthogonal to the focus of the present work.…”</p><p>Also see the full portion of the following section: “Notably, annealing intensifies a common trade-off of increased stability for decreased flexibility. While lowering the learning rate protects the actor weights from converging to zero and allows the model to retain a useful policy, the actor weights become insensitive to changes in reward contingencies when the variance of the meta-critic is sufficiently small. In this paper, our scope focus on stationary reward environments (where rewards do not change) and this flexibility is not required. However, in environments where reward consistently drifts, OpAL* suffers from gradual decay when annealing is lowered to track reward fluctuations (Figure A3d), though such decay is improved relative to the OpAL model without annealing (not shown)…”</p><p>Nevertheless, to address the point regarding annealing, note that the learning curves presented in Appendix 1—figure 4 show stabilization of OpAL* weights and corresponding Act curves for 1000 trials, as originally requested by the reviewer. While there is mild decay in the first 200 trials for some reward contingencies, the weights and policy stabilize and the ordinal rankings (which determine the policy) are robust. With the same parameter settings, we can extend this to 2000 trials and observe similar dynamics (G/N/Act) (not shown).</p><p>Without Bayesian annealing, in <xref ref-type="fig" rid="sa2fig9">Author response image 9</xref> we observe the dynamics which starkly show the detriment relative to annealing:</p><p>As we now mention in the revised paper, this annealing could be further optimized to be sensitive to volatility in the environment, as other models have done (including within OpAL). Nonetheless, Bayesian annealing used here does allow for some flexibility, as evidenced by the simple change-point scenario in <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>, left. <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>, left demonstrated that the model as formulated in the paper and used for all simulations (i.e. without decay) can indeed adapt to an environmental switch point. This is achievable even with more extensive pre-switch learning (<xref ref-type="fig" rid="sa2fig10">Author response image 10</xref>) :</p><fig id="sa2fig9" position="float"><label>Author response image 9.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig9-v2.tif"/></fig><fig id="sa2fig10" position="float"><label>Author response image 10.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig10-v2.tif"/></fig><p>Regarding weight decay in <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref> right and <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> right, this was meant to demonstrate that OpAL*’s adaptability to change points, which was raised in the first review, could be further enhanced with biologically plausible weight decay mechanisms that have been explored in Franklin and Frank within OpAL* but which are not the focus of this paper. While we don’t include weight decay in the main simulations for this paper, we merely chose to omit this mechanism to minimize the number of parameters explored and for comparison to other models. Adding such decay should not impede the advantages described in the paper in stationary environments since these advantages predominate during early learning; Indeed, we have now verified that if we simply add the decay to prior used above to the simulations that optimize learning curves in stationary environments, the advantages remained. Nevertheless, future work could assess whether OpAL* advantages could be further improved when optimizing parameters jointly with weight decay over long time horizons.</p><p>Finally, the reviewer notes that “it is still evident that on average the weights decay with trials”. As shown in (<xref ref-type="fig" rid="sa2fig11">Author response image 11</xref>) this decay is minimal up to 2000 trials, although we agree that there are parameter regimes in which this may be more apparent (for example, lower actor learning rates are related to less decay), but as we also note above this can be mitigated in principle, and as we noted in the manuscript, the decay specifically occurs when the critic converges (at which point the Q value could be in principle used for action selection, but this transition is left for future work).</p><fig id="sa2fig11" position="float"><label>Author response image 11.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig11-v2.tif"/></fig><p>Perhaps the reviewer was referring to the drifting reward environment, in which case annealing helps but does not completely prevent decay (though the G/N ordering for OpAL* can still reasonably track the value of an action and reach a value of approximately.6). <xref ref-type="fig" rid="sa2fig11">Author response image 11</xref> is without annealing, Appendix 1—figure 5 is with annealing.</p><p>This simulation was added given the reviewer’s earlier comments, to show that this is not a fundamental limitation of OpAL* and that it can adapt to these volatile scenarios, and that again this can be further enhanced with decay to prior (Appendix 1—figure 5). But as noted, we feel that these volatile drifting-reward environments are beyond the main scope of this paper, which focuses on performance advantages in novel stationary environments by optimizing action gaps, and hence we consider these simulations as supplemental rather than central.</p><p>Nonetheless, we have adjusted the text to emphasize that additional mechanisms and considerations (e.g. decay, optimizing T) are required to optimize adaptability for drifting reward environments in the section &quot;Normalization and annealing”.</p><disp-quote content-type="editor-comment"><p>Specific comments:</p><p>Equation 15 – How is std X estimated? Is it computed from the analytic expression for β distribution? If so, this expression is complex (involving division, square, etc.), so please comment on how such computation could be made by biological networks of neurons.</p></disp-quote><p>Yes, this is calculated by taking the analytic expression for the β distribution, but as noted in response to point 1, several computational papers suggest summary statistics may be represented in biological neural networks (e.g., Ma et al. 2006 and 2008, Pecevski and Maass 2016, Deneve 2008, Deneve et al. 1999), and that only a rough proxy for this is needed for our purposes in any case. There is also evidence that orbitofrontal regions represent confidence and task states, and modulate striatal dopamine in proportion to reward history, via projections to cholinergic neurons (Kepecs et al., 2008, Stalnaker et al., 2016; Adrover et al. 2020; Mohebi et al. 2019), as cited in the manuscript. Our focus here is not on the mechanisms of such uncertainty computations but their downstream impacts on the striatal machinery for learning and choice, and moreover that the benefits of doing so require opponency and the hebbian nonlinearity according to OpAL*.</p><disp-quote content-type="editor-comment"><p>Equation 22 – Please explain parameter T. As above, please explain how X is computed in the simulation.</p></disp-quote><p>Thank you for asking; revisiting this section, there was not enough detail to make this clear. var(X) is the analytical variance of the β distribution of the meta-critic (X is defined in Equation 12). T is a hyper-parameter that determines how variance is converted to annealing. We have updated the text to clarify these definitions.</p><disp-quote content-type="editor-comment"><p>Line 293: &quot;These modifications improve the robustness of OpAL* and ensure that the actor weights are well-behaved&quot; – I do not agree with this statement, because in the OpAL* model the weights still converge to 0 unless they are prevented from convergence to 0 by making the model non-adaptive. Please replace &quot;well behaved&quot; in the cited statement, by a more specific description.</p></disp-quote><p>We have replaced “well behaved” with a more specific description:</p><p>“These modifications improve robustness of OpAL* and ensure that the actor weights are better behaved (avoiding convergence to zero and maintaining ordinal rankings in the resulting Act values for 1000 trials; Figure A3b)…”</p><disp-quote content-type="editor-comment"><p>Line 499: &quot;Indeed, algorithms like Q-learning and UCB converge well when an option is well-sampled, but the speed and accuracy of this convergence is affected by stochastic sampling&quot;. This argument does not apply to UCB, which is deterministic, and hence the sampling in UCB is NOT stochastic.</p><p>Line 582 – this again does not seem to apply to UCB, which is deterministic.</p></disp-quote><p>For both the above points, we have now clarified that the key issue is not whether the choice on a given trial is stochastic, but rather that the speed and accuracy of convergence for UCB is impeded with the requirement to choose among multiple actions (and switching between then across trials), yielding partial information on reward statistics across all options. Thus even though UCB chooses deterministically on a given trial, it still only chooses a single option on that trial and eventually will shift to other options and learn about those, depending on the value and the number of times it has selected those options, and the C parameter, as noted above. We now show explicitly (Supplementary Figure S4) that UCB suffers convergence when choosing between multiple actions.</p><disp-quote content-type="editor-comment"><p>Figure 6a is very interesting, but I have a few suggestions to make it more informative. I simulated UCB on the problems in Figure 6a and verified that it indeed gives similar performance to that visualized in this figure, but found that with 1000 iterations there is still substantial variability in the results, and sometimes you get non-monotonic changes in accuracy as shown in blue curve in Figure 6a left, which disappear if the number of iterations is increased. Hence, I suggest to increase the number of iterations (repetitions) in Figure 6a to 10,000 to get less noisy curves.</p></disp-quote><p>In response to a later comment, we have modified this figure to use the updated UCB algorithm (which explicitly samples each action once before exploring) and to reflect the optimal parameters for each environment. The learning curves presented are those that generated that data point on the rightmost tail on the AUC histograms for each agent. Because those histograms were based on 1000 simulations, we find it more parsimonious to show the 1000 simulations that went into these histograms, but we present the 10,000 simulations here to confirm comparable dynamics (<xref ref-type="fig" rid="sa2fig12">Author response image 12</xref>) Results for extended time horizons again were comparable (<xref ref-type="fig" rid="sa2fig13">Author response image 13</xref>).</p><fig id="sa2fig12" position="float"><label>Author response image 12.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig12-v2.tif"/></fig><fig id="sa2fig13" position="float"><label>Author response image 13.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig13-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>In Figure 6a the gap between UCB and OpAL* is higher in the right panel but it is not clear if this is due to change in richness or in the number of options. It would be helpful to add two more panels ([0.2 0.3] and [0.8 0.7 0.7 0.7 0.7 0.7]). Also for an easier replicability, it would be good to list the parameters used in simulations of each model.</p></disp-quote><p>We have updated the figure so that the learning curves directly illustrate the data that underlies the AUC in the histograms for best performing parameters in each agent, and (as the reviewer suggested elsewhere) to use the modified UCB algorithm (i.e. sampling each option once on the first trial before exploring, giving it a further advantage). We keep just two illustrative examples of these learning curves in the figure because it is already multi-panel and they merely illustrate data that are already in the histograms. Nevertheless, we have now added the corresponding optimal learning curves for the other cases that the reviewer mentions, as well as other time horizons (1000 trials), in the supplementary figures. Code will be made available for the replicability of these learning curves.</p><disp-quote content-type="editor-comment"><p>l. 1478: &quot;Normalizing, therefore, addresses the valid concerns of Möller and Bogacz (2019) while still preserving core OpAL dynamics&quot;. I do not agree – the key concern of Möller and Bogacz (2019) was that the weights decay to 0 eventually. The normalization does not fix the problem. In the simulations I did in the previous round of the review, rewards were 0 and 1, so the normalization had no effect.</p></disp-quote><p>We agree that normalization on its own does not prevent the decay to zero due to the critic convergence as analytically shown in Moller and Bogacz (2019). However, in the provided scenario, the decay is exacerbated by large reward magnitudes. In <xref ref-type="fig" rid="sa2fig14">Author response image 14</xref>, the left figure is a replication of the figure from Moller and Bogacz (2019); the right shows the effect of normalization only (no annealing). Without annealing the weights WILL eventually decay as helpfully outlined by Moller and Bogacz; however, the rapid decay to zero in approximately 20-30 trials resulted in part from large RPE magnitudes (in the range of -3 to 3).</p><fig id="sa2fig14" position="float"><label>Author response image 14.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-85107-sa2-fig14-v2.tif"/></fig><p>We have adjusted our wording in this section to better emphasize that the normalization serves to address issues caused by the magnitude of RPE. This is distinctive from the decay effects caused by the oscillations in the critic prediction error, for which we introduced annealing.</p><p>“Normalizing, therefore, addresses one factor (large RPE magnitudes) contributing to the rapid decay in early trials demonstrated by Möller and Bogacz (2019)…”</p><disp-quote content-type="editor-comment"><p>Equation 30 – I guess the last 2 &quot;cases&quot; were included accidentally (they are a typo), and should be removed.</p></disp-quote><p>Thank you, this has been adjusted.</p><disp-quote content-type="editor-comment"><p>l.1112: UCB – Please provide the reference for the paper describing UCB. In this algorithm, the model is initialized to selecting each action once before relying on estimated values. Do you do such initial selection? If so, please say this.</p></disp-quote><p>We had not originally included this initialization step, in part because this provides UCB with another advantage, in that it effectively gets full information for one trial, and our main intent was to demonstrate that partial information was more detrimental to value-based algorithms like Q learning and UCB than to OpAL*. However, upon reflection, we decided to implement this initialization step to better reflect how UCB is actually used. We have rerun our simulations with such initialization and found comparable results, albeit with some slight improvement to UCB performance given this additional information about each option. We have updated our figures and methods accordingly. References to Sutton and Barto and Auer et al. (2002) have been added.</p><disp-quote content-type="editor-comment"><p>Throughout – In many places in the manuscript there are references to appendix, but the appendix is long, and it takes time to find information. Hence whenever you point the reader to the appendix, please point to a specific section or figure.</p></disp-quote><p>We have now included links to the appropriate sections of the appendix and supplementary figures in the main text.</p></body></sub-article></article>