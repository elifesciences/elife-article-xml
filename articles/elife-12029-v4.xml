<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1d3" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="hwp">eLife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">12029</article-id><article-id pub-id-type="doi">10.7554/eLife.12029</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group><subj-group subj-group-type="heading"><subject>Neuroscience</subject></subj-group></article-categories><title-group><article-title>A cholinergic feedback circuit to regulate striatal population uncertainty and optimize reinforcement learning</article-title></title-group><contrib-group><contrib contrib-type="author" id="author-33323"><name><surname>Franklin</surname><given-names>Nicholas T</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-24218"><name><surname>Frank</surname><given-names>Michael J</given-names></name><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8451-0523</contrib-id><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="other" rid="par-1"/><xref ref-type="other" rid="par-2"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><institution content-type="dept">Department of Cognitive, Linguistic and Psychological Sciences, Brown Institute for Brain Science</institution>, <institution>Brown University</institution>, <addr-line><named-content content-type="city">Providence</named-content></addr-line>, <country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder S</given-names></name><role>Reviewing editor</role><aff id="aff2"><institution>National Centre for Biological Sciences</institution>, <country>India</country></aff></contrib></contrib-group><author-notes><corresp id="cor1"><email>Michael_Frank@brown.edu</email></corresp></author-notes><pub-date date-type="pub" publication-format="electronic"><day>25</day><month>12</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>4</volume><elocation-id>e12029</elocation-id><history><date date-type="received"><day>03</day><month>10</month><year>2015</year></date><date date-type="accepted"><day>24</day><month>12</month><year>2015</year></date></history><permissions><copyright-statement>© 2015, Franklin et al</copyright-statement><copyright-year>2015</copyright-year><copyright-holder>Franklin et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-12029-v4.pdf"/><abstract><object-id pub-id-type="doi">10.7554/eLife.12029.001</object-id><p>Convergent evidence suggests that the basal ganglia support reinforcement learning by adjusting action values according to reward prediction errors. However, adaptive behavior in stochastic environments requires the consideration of uncertainty to dynamically adjust the learning rate. We consider how cholinergic tonically active interneurons (TANs) may endow the striatum with such a mechanism in computational models spanning three Marr's levels of analysis. In the neural model, TANs modulate the excitability of spiny neurons, their population response to reinforcement, and hence the effective learning rate. Long TAN pauses facilitated robustness to spurious outcomes by increasing divergence in synaptic weights between neurons coding for alternative action values, whereas short TAN pauses facilitated stochastic behavior but increased responsiveness to change-points in outcome contingencies. A feedback control system allowed TAN pauses to be dynamically modulated by uncertainty across the spiny neuron population, allowing the system to self-tune and optimize performance across stochastic environments.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.001">http://dx.doi.org/10.7554/eLife.12029.001</ext-link></p></abstract><abstract abstract-type="executive-summary"><object-id pub-id-type="doi">10.7554/eLife.12029.002</object-id><title>eLife digest</title><p>One of the keys to successful learning is being able to adjust behavior on the basis of experience. In simple terms, it pays to repeat behaviors with positive outcomes and avoid those with negative outcomes. A group of brain regions known collectively as the basal ganglia supports this process by guiding behavior based on trial and error.</p><p>However, circumstances can and do change: a behavior that routinely produces a positive outcome now will not necessarily always do so in the future. The outcome of a given behavior can also vary from time to time purely by chance: even the most appropriate action can sometimes lead to a negative outcome but should be repeated again. Exactly how the basal ganglia take into account this uncertainty over behavioral outcomes to appropriately guide learning is unclear.</p><p>Franklin and Frank have now come up with a possible explanation by building on an existing computational model of the basal ganglia. Whereas the old model assumes that the rate of learning given an unexpected outcome always remains constant, in the new model learning occurs more quickly when the outcome of a behavior is uncertain. This makes intuitive sense, in that rapid learning is especially useful during the initial stages of learning a new task or following a sudden change in circumstances.</p><p>The new model proposes that a group of cells called tonically active interneurons (TANs), which release the chemical acetylcholine, enable the basal ganglia to take account of uncertainty. TANs are found in a basal ganglia structure called the striatum and have a characteristic firing pattern during important outcomes, consisting of a burst of activity followed by a pause lasting several hundred milliseconds. The model suggests that when the outcome of a behavior is uncertain, the length of this pause is increased. This boosts the activity of another group of neurons in the striatum, known as spiny neurons, and this in turn increases the rate of learning.</p><p>Franklin and Frank found that by varying the length of the TAN pause, the basal ganglia can adjust learning rates based on the degree of uncertainty over behavioral outcomes. Comparisons show that the TAN computational model optimizes the accuracy and flexibility of learning across different environments, while also accounting for findings which show that TAN lesions induce insensitivity to changes in decision outcomes. The next step is to test some of the new predictions about uncertainty experimentally.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.002">http://dx.doi.org/10.7554/eLife.12029.002</ext-link></p></abstract><kwd-group kwd-group-type="author-keywords"><title>Author Keywords</title><kwd>reinforcement learning</kwd><kwd>basal ganglia</kwd><kwd>striatum</kwd><kwd>cholinergic interneuron</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research Organism</title><kwd>Human</kwd><kwd>Mouse</kwd><kwd>Rat</kwd></kwd-group><funding-group><award-group id="par-1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id># 1460604</award-id><principal-award-recipient><name><surname>Frank</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><award-group id="par-2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>R01 MH080066-01</award-id><principal-award-recipient><name><surname>Frank</surname><given-names>Michael J</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta><meta-name>elife-xml-version</meta-name><meta-value>2.5</meta-value></custom-meta><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Computational modeling suggests that feedback between striatal cholinergic neurons and spiny neurons dynamically adjusts learning rates to optimize behavior in a variable world.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>When tasked with taking an action in an unknown environment, there can be considerable uncertainty about which actions will lead to the best outcomes. A principled way to resolve this uncertainty is to use previous experience to guide behavior towards actions that have led to positive outcomes in the past and away from actions that have led to negative outcomes. Convergent evidence suggests that the basal ganglia can guide behavior by incorporating positive and negative feedback in a reinforcement learning process (<xref ref-type="bibr" rid="bib62">O'Doherty et al., 2003</xref>; <xref ref-type="bibr" rid="bib9">Barnes et al., 2005</xref>; <xref ref-type="bibr" rid="bib34">Frank, 2005</xref>). However, learning can be complicated in a changing environment, as the validity of past experiences and the relationship between actions and outcomes become uncertain as well. Mathematical models suggest that it is optimal to take uncertainty into account in learning and decision making (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Mathys et al., 2011</xref>), but it is unclear whether the basal ganglia can directly consider uncertainty in feedback-based learning.</p><p>Basal ganglia-dependent learning is often described within the normative framework of reinforcement learning (RL) following the observation that signaling from dopaminergic afferents matches the pattern of a reward prediction error (RPE) (<xref ref-type="bibr" rid="bib59">Montague et al., 1996</xref>; <xref ref-type="bibr" rid="bib10">Bayer et al., 2007</xref>). An RPE is the signed difference between the observed and expected outcomes and is often used in RL to generate point-estimates of action-values (<xref ref-type="bibr" rid="bib79">Sutton and Barto, 1998</xref>). Phasic dopamine (DA) is thought to provide an RPE signal to striatal medium spiny neurons (MSNs) and induce learning through changes in corticostriatal plasticity (<xref ref-type="bibr" rid="bib59">Montague et al., 1996</xref>; <xref ref-type="bibr" rid="bib72">Reynolds and Wickens, 2002</xref>; <xref ref-type="bibr" rid="bib17">Calabresi et al., 2007</xref>), with opponent learning signals in the direct and indirect pathways (<xref ref-type="bibr" rid="bib34">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib22">Collins and Frank, 2014</xref>). Within these pathways, separate populations code for the (positive and negative) values of distinct action plans (<xref ref-type="bibr" rid="bib74">Samejima et al., 2005</xref>). Multiple lines of evidence in humans and animals support this model, including optogenetic manipulations (<xref ref-type="bibr" rid="bib82">Tsai et al., 2009</xref>; <xref ref-type="bibr" rid="bib49">Kravitz et al., 2012</xref>), synaptic plasticity studies (<xref ref-type="bibr" rid="bib75">Shen et al., 2008</xref>), functional imaging (<xref ref-type="bibr" rid="bib57">McClure et al., 2003</xref>; <xref ref-type="bibr" rid="bib62">O'Doherty et al., 2003</xref>), genetics and pharmacology in combination with imaging (<xref ref-type="bibr" rid="bib66">Pessiglione et al., 2006</xref>; <xref ref-type="bibr" rid="bib32">Frank et al., 2009</xref>; <xref ref-type="bibr" rid="bib46">Jocham et al., 2011</xref>) and evidence from medication manipulations in Parkinson’s patients (<xref ref-type="bibr" rid="bib33">Frank et al., 2004</xref>).</p><p>Despite the substantial empirical support for RPE signals conveyed by dopamine, the simple RL mechanisms used to model the basal ganglia are inflexible in the degree to which they learn in a changing environment. RL models typically adopt a fixed learning rate, such that every RPE of similar magnitude equally drives learning. However, a more adaptive strategy in a changing environment is to adjust learning rates as a function of uncertainty, so that unexpected outcomes have greater influence when one is more uncertain of which action to take (e.g., initially before contingencies are well known, or following a change-point), but less influence once the contingencies appear stable and the task is well known (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>; <xref ref-type="bibr" rid="bib55">Mathys et al., 2011</xref>; <xref ref-type="bibr" rid="bib65">Payzan-LeNestour et al., 2011</xref>). This Bayesian perspective presents the additional challenge for basal ganglia-dependent learning: in order to take advantage of its own uncertainty over action selection, the basal ganglia would need a mechanism to translate its uncertainty into a learning rate.</p><p>Cholinergic signaling within the striatum offers a potential solution to this challenge. With few exceptions (<xref ref-type="bibr" rid="bib80">Tan and Bullock, 2008</xref>; <xref ref-type="bibr" rid="bib7">Ashby and Crossley, 2011</xref>), models of the basal ganglia typically do not incorporate striatal acetylcholine. Within the striatum, cholinergic interneurons are the predominant source of acetylcholine (<xref ref-type="bibr" rid="bib87">Woolf and Butcher, 1981</xref>). These interneurons, also known as tonically active neurons (TANs) due to their intrinsic 2–10-Hz firing pattern, are giant, spanning large areas of the striatum with dense axonal arborization and broad synaptic input (<xref ref-type="bibr" rid="bib38">Goldberg and Reynolds, 2011</xref>). TANs appear to be necessary to learning only when flexibility is required (<xref ref-type="bibr" rid="bib68">Ragozzino et al., 2009</xref>; <xref ref-type="bibr" rid="bib14">Bradfield et al., 2013</xref>), suggesting that they might modulate the learning rate as a function of changes in outcome statistics (i.e., uncertainty). Similar to dopaminergic neurons, TANs show sensitivity to rewarding events and develop a learned phasic response to predictive cues (<xref ref-type="bibr" rid="bib2">Aosaki et al., 1994</xref>; <xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>). This response consists of a phasic burst in TAN activity followed by a pause that lasts a few hundred milliseconds (<xref ref-type="bibr" rid="bib3">Aosaki et al., 1995</xref>). While the temporal pattern of the burst–pause response is temporally concomitant to the dopamine response (<xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>), the unidirectional TAN response is not consistent with a bivalent RPE (<xref ref-type="bibr" rid="bib47">Joshua et al., 2008</xref>) but instead is thought to provide a permissive signal for dopaminergic plasticity (<xref ref-type="bibr" rid="bib41">Graybiel et al., 1994</xref>; <xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>; <xref ref-type="bibr" rid="bib23">Cragg, 2006</xref>).</p><p>But how would such a permissive signal be modulated by the network’s own uncertainty about which action to select? Because TANs receive broad inhibitory synaptic input from local sources, including MSNs and GABAergic interneurons (<xref ref-type="bibr" rid="bib13">Bolam et al., 1986</xref>; <xref ref-type="bibr" rid="bib18">Chuhma et al., 2011</xref>), we hypothesized that the pause would be modulated by a global measure of uncertainty across the population of spiny neurons. Given that MSN sub-populations code for distinct action values (<xref ref-type="bibr" rid="bib74">Samejima et al., 2005</xref>; <xref ref-type="bibr" rid="bib34">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib50">Lau and Glimcher, 2008</xref>), co-activation of multiple populations can signal enhanced uncertainty over action selection, which would translate into greater inhibition onto TANs. The synchrony in the TAN response suggests a global signal (<xref ref-type="bibr" rid="bib41">Graybiel et al., 1994</xref>), which can then be modulated by inhibitory MSN collaterals across a large range of spiny inputs. The TAN pause response is consistent with a signal of uncertainty that adjusts learning. First, it increases with the unpredictability of a stochastic outcome (<xref ref-type="bibr" rid="bib5">Apicella et al., 2009</xref>, <xref ref-type="bibr" rid="bib6">2011</xref>). Second, pharmacological blockade or lesioning excitatory input to TANs impairs learning, specifically after a change in outcome contingencies (<xref ref-type="bibr" rid="bib67">Ragozzino et al., 2002</xref>; <xref ref-type="bibr" rid="bib14">Bradfield et al., 2013</xref>). For an optimal learner, both increases in stochasticity and changes in outcome contingencies results in an increase in uncertainty (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>).</p><p>Here, we augment a well-established computational model of the basal ganglia (BG) to include a mechanism by which the effective learning rate is modulated by cholinergic signaling, and where this signaling is, in turn, modulated by uncertainty in the MSN population code via reciprocal TAN–MSN interactions. In the model, cholinergic signals dynamically modulate the efficacy of reinforcement feedback, driving changes in the number of neurons available for synaptic plasticity during reinforcement, hence the effective learning rate of the network as a whole. Thus, TANs allow the basal ganglia to tailor its learning rate to its environment, balancing the tradeoff between learning flexibility and robustness to noise by adjusting learning as a function of policy uncertainty embedded in the MSN population code. We show that this behavior is consistent with a normative account using an approximately Bayesian model and that its main functionality can be simplified in algorithmic form using a modified RL model, thus spanning Marr’s levels of implementation, algorithm, and computation. The model is consistent with several existing lines of evidence and makes falsifiable predictions.</p></sec><sec id="s2" sec-type="results"><title>Results</title><p>We extended a previously published neural network model of the basal ganglia to examine the potential role for TANs in learning. <xref ref-type="fig" rid="fig1">Figure 1</xref> shows a graphical representation of the model, which has been adapted from <xref ref-type="bibr" rid="bib35">Frank, 2006</xref> to include TANs. The basic mechanics of the BG model without TANs have been reviewed elsewhere (e.g., <xref ref-type="bibr" rid="bib53">Maia and Frank, 2011</xref>; <xref ref-type="bibr" rid="bib70">Ratcliff and Frank, 2012</xref>) but are summarized here before articulating the TAN mechanisms. In the network, striatonigral and striatopallidal MSNs are simulated with separate populations of ‘Go’ and ‘NoGo’ units (rate-coded point neurons), which act to facilitate or suppress selection of specific actions. These MSN units receive excitatory input from a sensory input cortical layer and a motor cortical layer representing specific candidate responses. A given response is executed when its motor cortical firing rate exceeds a threshold.<fig id="fig1" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.003</object-id><label>Figure 1.</label><caption><title>Neural network model.</title><p>(<bold>A</bold>) A simplified diagram of the neural network. Sensory input excites candidate motor actions and corresponding Go (blue circles) and NoGo (red circles) MSN units in the striatum. Distinct columns of Go and NoGo units provide the thalamus with positive and negative evidence for alternative motor responses, learned via DA reinforcement signals. Positive prediction errors result in increased DA during feedback and an increase of Go excitability relative to NoGo units. TANs are endogenously active units that modulate MSN excitability during reinforcement feedback, altering the efficacy of the reinforcement signal. (<bold>B</bold>) Stereotypical TAN response is temporally concomitant to reward-related phasic DA increase (Adapted from Figure 7 part C, <xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>). (<bold>C</bold>) Schematic representation of TAN–MSN signaling (see below). TAN firing inhibits presynaptic glutamatergic signaling of D1 and D2 MSNs through M2 receptors, but also selectively excites D2 MSNs via M1 receptors. (<bold>D</bold>) Sensory input provides excitatory signaling to preSMA (representing two candidate motor actions) and corresponding Go and NoGo MSN units in the striatum. Each of (here, two) motor responses is coded by distinct columns of Go and NoGo units, representing positive and negative evidence for alternative that responses, learned via reinforcement conveyed by DA signals in the SNc. The basal ganglia contribute to action selection by disinhibiting thalamocortical activity for representing thatthe response having the largest Go–NoGo activation differential. Go units inhibit globus pallidus internal segment (GPi) units, which otherwise tonically inhibit the thalamus. NoGo units have the opposite effect by inhibiting the external segment (GPe), which in turn inhibits GPi. TANs are represented as a separate layer of endogenously active units that modulate MSN excitability during the dynamic burst–pause pattern windowing the dopaminergic reward prediction error signals. This pause duration can be fixed, or sensitive to the population uncertainty of MSNs (see below). Dotted black lines correspond to proposed feedback mechanism from MSNs to TANs. The STN modulates the threshold by which actions are disinhibited by the BG, included here for consistency with prior work. DA, dopamine; MSN, medium spiny neuron; preSMA, pre-suplementary motor cortex; SNc, substantia nigra pars compacta; STN, subthalamic nucleus.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.003">http://dx.doi.org/10.7554/eLife.12029.003</ext-link></p></caption><graphic xlink:href="elife-12029-fig1-v4.tif"/></fig></p><p>The basal ganglia participate in action selection by selectively disinhibiting thalamocortical activity for a given response while inhibiting thalamocortical activity for alternative responses, via MSN projections through different basal ganglia nuclei (<xref ref-type="bibr" rid="bib35">Frank, 2006</xref>; <xref ref-type="bibr" rid="bib44">Humphries et al., 2006</xref>). Activity in Go units contributes evidence toward the selection of an action in the thalamus and ultimately the cortex, while NoGo unit activity suppresses action selection and effectively provides evidence against particular responses. The difference in Go and NoGo unit activity for each candidate action effectively provides a decision variable, each represented in distinct columns of cortico-BG-thalamic circuits. The greater the relative Go–NoGo activity difference for a particular response, the more likely the corresponding column of thalamus will be disinhibited, and hence the corresponding action selected. Initially, network choices are determined by random synaptic weights favoring one or the other action and the additional intra-trial noise in unit activity favoring exploration of alternative actions, but choices stabilize via dopamine-dependent learning, as described next.</p><p>Dopamine modulates excitability in the Go and NoGo pathways and has opposing effects on the two populations. D1 receptor activity simulated in the Go units results in increased excitability while D2 receptor activity simulated in NoGo units has the opposite effect. Consequently, an increase in dopamine leads to increased Go activity relative to NoGo activity; this can influence both the choice process through acute changes in excitability and the learning process through consequent changes in synaptic efficacy during phasic changes in dopamine-related to positive and negative outcomes.</p><p>Several predictions of this model have been validated empirically across species, including effects of pharmacological manipulations, genetic variants, and optogenetic manipulations (<xref ref-type="bibr" rid="bib22">Collins and Frank, 2014</xref> for review and quantitative simulations) but as of yet, it has not explored the role of TANs. Furthermore, while it can account for general effects of dopaminergic manipulation on probabilistic reversal learning (<xref ref-type="bibr" rid="bib34">Frank, 2005</xref>), it fails to appropriately modulate its learning as a function of environmental noise and internal action uncertainty. Finally, while BG RL models depend on DA-driven learning, they do not provide a mechanism that would allow striatal learning to occur selectively during reward prediction errors as opposed to various other factors that could also change DA levels (e.g., <xref ref-type="bibr" rid="bib43">Howe et al., 2013</xref>). We investigated whether the TAN pause, by windowing dopaminergic RPEs, can provide such a permissive signal on learning.</p><p>The stereotypical TAN burst–pause response modulates excitability and presynaptic corticostriatal signaling in both MSN populations (<xref ref-type="bibr" rid="bib36">Gerfen and Surmeier, 2011</xref>). In our model, a TAN pause was simulated at the onset of feedback to create a window around the dopaminergic reinforcement signal (<xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>); to isolate the effects solely attributable to learning, TAN activity levels were constant during action selection itself (<xref ref-type="fig" rid="fig2">Figure 2</xref>, left; see Materials and methods). Cholinergic signaling within the striatum is extensive and complex, involving a diversity of cholinergic receptors. For tractability, we mainly focused our investigation on the effects of TAN signaling on MSN excitability, simulating the effects of M1- and M2-muscarinic acetylcholine receptors on MSNs and nicotinic receptors on GABAergic interneurons (we further explore the ACh effects on DA release in the final section). Changes in muscarinic activity modulate MSN excitability during TAN pauses, allowing the MSN population to be more or less excitable during reinforcement (see Materials and methods for details of biophysics and implementation in our model). Longer (or deeper) TAN pauses increase corticostriatal input and hence MSN activity in response to reinforcement, compared to shorter TAN pauses.<fig id="fig2" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.004</object-id><label>Figure 2.</label><caption><title>Network activity in a probabilistic reversal learning task. </title><p><italic>Top left</italic>: Mean within-trial normalized firing rate across population of Go units (simulated striatonigral MSNs) and TANs during action selection during the first epoch of training ('early'). Individual traces represent the mean population activity in a single trial and are collapsed across response for Go units. In the examples shown, Go unit activity ultimately facilitates the selected response (due to disinhibition of thalamus; not shown, see <xref ref-type="bibr" rid="bib35">Frank, 2006</xref>). <italic>Bottom left</italic>: Mean within-trial firing rate during action selection in the last epoch of training ('late') prior to reversal. As a consequence of training, an increased differential in Go activity between the selected and non-selected response results in low action-selection uncertainty. <italic>Center:</italic> Mean firing rate for Go and TAN units during reinforcement for both correct (<italic>top</italic>) and incorrect (<italic>bottom</italic>) trials. TAN pauses occur for both types of feedback, providing a window during which the dopaminergic signals differentially modulate Go unit activity and plasticity (long-term potentiation vs long-term depression). <italic>Top right</italic>: Entropy in population of Go units across training trials. Population-level entropy declined over time prior to reversal (trial 200; dotted line) as the stochastic population of simulated neurons learned the correct action. Following reversal, entropy rose briefly as the network starts to activate the alternative Go response while the learned one still remained active for some time, after which entropy declines once more. This dynamic modulation of entropy is more pronounced in a network with simulated TANs than a control network without TANs. MSNs, medium spiny neurons; TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.004">http://dx.doi.org/10.7554/eLife.12029.004</ext-link></p></caption><graphic xlink:href="elife-12029-fig2-v4.tif"/></fig></p><p>We conducted a series of simulations in which this neural network was confronted with a two alternative, forced choice reversal learning task. On each trial, one of two input stimuli was presented and the network had to select one of two responses. For the initial simulations, one response was rewarded 80% of the trials and the other 20% of the trials. (Subsequent simulations described later varied the stochasticity of the environment.) The network was trained on 20 epochs of 20 trials for each stimulus, or 400 trials total. Performance was probed prior to the first training epoch as a baseline and following the completion of each training epoch. The first 10 training epochs comprised the 'acquisition' phase in which the reward schedule remained constant. Adaptive behavior in this context demands learning from unexpected outcomes during initial stages of the task but ignoring spurious outcomes (i.e. the 20% of negative outcomes) once the contingencies are well known. The reward contingencies were then reversed for the remaining 10 epochs ('reversal' phase) such that the response with the lower value during acquisition was now rewarded in 80% of trials. An adaptive learner would show renewed sensitivity to unexpected outcomes when the contingencies change, and then stabilize again asymptotically.</p><p>Because the TAN pause results in MSN disinhibition, it modulates their excitability during outcome presentation (when phasic dopaminergic signals are presented) via modulation of M1 and M2 receptors (see Materials and methods). TAN pauses elicit greater activation of the most excitable units, which then, due to activity-dependent plasticity, are most subject to dopaminergic learning. In turn, the resultant synaptic weight changes affect the subsequent distribution of active MSNs during action selection. This distribution can be quantified by the uncertainty in action selection across the MSN population, which we define here as the Shannon’s entropy based on the firing rates <italic>y</italic> of units associated with each action <italic>a</italic> across all time points <italic>t</italic> during action selection within a trial:</p><p><disp-formula id="equ1"><mml:math id="m1"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>t</mml:mi></mml:munder><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>a</mml:mi></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <italic>p<sub>a</sub>(t)</italic> reflects the population’s probability assigned to selecting action <italic>a</italic> based on normalized firings rates coding for that action (see Materials and methods). A population with low entropy has a few strongly active units representing primarily the dominant motor response, whereas a population with high entropy has many weakly active units representing multiple alternative responses. As the network learns, entropy across Go units declines over time and the network becomes more likely to strongly activate Go units associated with the correct response, and less likely to activate those for the opposing response (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top right). Following the reversal, the entropy of the Go units increases as the network un-learns the previous correct response (making those units more weakly active) while beginning to activate those associated with the alternative response. While this pattern is evident in networks without TANs, it is more pronounced in TAN networks: the selective modulation of excitability during outcomes amplifies the effect of dopamine on Go activity for the dominant response, progressively differentiating from the less rewarded response and leading to low entropy Go representations (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top right).</p><p>The decline in MSN entropy translates into reduced stochasticity in action selection, as the MSN population becomes dominated by a single strongly active population, providing stronger evidence for the frequently rewarded action. Consequently, TAN networks exhibit higher accuracy when a stochastic task is well learned than a network without TANs (<xref ref-type="fig" rid="fig3">Figure 3</xref>, left). However, this property alone reduces the flexibility of the network to respond to change points, because a single strongly active population is harder to unlearn, and the network will perseverate in selecting the previously learned response. This tradeoff will become evident below, where we show that TAN pause durations can be dynamically modulated to optimize the tradeoff between flexibility and stability.<fig id="fig3" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.005</object-id><label>Figure 3.</label><caption><title>Performance of the neural network on reversal learning task.</title><p><italic>Left</italic>: Accuracy during acquisition of probabilistic contingencies. During initial acquisition, accuracy for networks simulated with TANs (black) is similar to accuracy in control networks that do not contain TANs (grey). Simulated M1 blockade (red) does not meaningfully impair performance during acquisition. <italic>Right</italic>: Accuracy following reversal. Networks with TANs (black) reach higher asymptotic performance than control networks (grey). Networks with simulated M1 blockade (red) show pronounced performance impairments. TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.005">http://dx.doi.org/10.7554/eLife.12029.005</ext-link></p></caption><graphic xlink:href="elife-12029-fig3-v4.tif"/></fig></p><p>To directly study the impact of TANs on learning, we first parametrically varied the duration of the TAN pause exogenously (below we explore how this pause may be endogenously self-regulated by the network). Varying pause duration across networks reveals a behavioral trade-off between learning speed following probabilistic reversal and asymptotic accuracy (<xref ref-type="fig" rid="fig4">Figure 4</xref>, top row). During acquisition, learning speed is similar across a range of TAN pause durations, but networks with long pauses exhibit higher levels of asymptotic accuracy. Long pauses facilitate a disproportionate increase in synaptic efficacy for the most frequently rewarded response despite the occasional spurious outcome (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom right), driving MSNs to focus their activity to a single dominant action (as quantified by MSN entropy; <xref ref-type="fig" rid="fig4">Figure 4</xref>, bottom). However, this same property makes such networks slow to reverse. Conversely, networks with short TAN pause durations learn more quickly following reversal but at a cost of asymptotic accuracy. Mechanistically, this occurs as short TAN pauses elicit weaker activation of spiny units, and hence elicit less activity-dependent plasticity, leading to a smaller learned divergence in synaptic weights between alternative responses (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom right). This stunted divergence allows for continued co-activation of multiple response alternatives during subsequent action selection, and hence more stochastic choice, but this same property supports the network’s ability to quickly reinforce alternative actions following change points. Thus, although in these simulations the TAN pause modulates excitability only during window of the phasic dopaminergic reinforcement signal, it influences which MSNs learn and hence the population activity and action selection entropy thereof during subsequent choices.<fig id="fig4" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.006</object-id><label>Figure 4.</label><caption><title>Network behavior as a function of TAN pause duration.</title><p>(<bold>A, B</bold>): Accuracy of the neural network simulations over a range of fixed pause durations (120–280 ms) during initial acquisition (<bold>A</bold>) and following reversal (<bold>B</bold>). Networks with short TAN pauses (red) learned more quickly following reversal than networks with a long TAN pauses (blue) but did not achieve the same level of asymptotic accuracy during either acquisition or following reversal. (<bold>C</bold>) Final MSN entropy after training for both acquisition and reversal, as a function of TAN pause duration. Longer pauses elicited lower entropic MSN representations, facilitating asymptotic performance, whereas the higher entropy in short pause networks facilitated faster reversal. (<bold>D</bold>) Action selection uncertainty across MSN population across all trials for both stimuli. Entropy in networks with a long TAN pause (black) declines over time and reaches asymptotic level both prior to and following reversal. (<bold>E</bold>) Mean difference in corticostriatal Go weights (synaptic efficacy) coding for the more rewarded versus less rewarded response (defined during acquisition) are shown across training trials for a single stimulus, in an 85:15% reward environment. Greater accumulation in weight differences result in more deterministic choice but difficulty in unlearning. Data shown for networks trained on with a long (270 ms) or short (150 ms) fixed duration TAN pause. Reversal at trial 200 denoted with dotted line. MSN, medium spiny neurons; TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.006">http://dx.doi.org/10.7554/eLife.12029.006</ext-link></p></caption><graphic xlink:href="elife-12029-fig4-v4.tif"/></fig><fig id="fig5" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.007</object-id><label>Figure 5.</label><caption><title>Schematic Representation of MSN entropy and self-tuning mechanism.</title><p><italic>Top left</italic>: Action potentials (horizontal lines) for a population of neurons with both high and low population entropy are shown across time. In the example, both entropy conditions produce the same number of action potentials in the displayed time window. In the population with high entropy, action potentials are distributed equally across the neurons thus reflecting more competition across MSNs representing different behavioral actions, and hence uncertainty about which action to select. In the population with low entropy, spike rates are concentrated in fewer neurons. <italic>Top right</italic>: Homeostatic feedback mechanism. The population entropy across spiny neurons can influence the duration of TAN pauses, which reciprocally influences the excitability of spiny neurons and hence entropy. This feedback control system optimizes the TAN pause duration and allows the population to be dynamically sensitive to unexpected outcomes. A high-entropy MSN population firing rate distribution (top, black line) leads to a longer TAN pause (bottom, black line), increasing weight divergence and creating downward pressure on MSN entropy. Low MSN entropy (top, dotted line) decreases TAN pause duration (bottom, dotted line) creating upward pressure on MSN entropy. <italic>Bottom left:</italic> Feedback-mechanism self-regulates TAN pause duration (ms) as a function of entropy across learning. Pauses become shorter for more deterministic environments as a function of learning, preventing divergence in synaptic weights and over-learning, but then increase at change points. Reversal at trial 200 denoted with dotted line. <italic>Bottom right:</italic> Feedback mechanism adaptively regulates synaptic weights to facilitate learning. Mean difference in corticostriatal Go weights (synaptic efficacy) coding for the more rewarded versus less rewarded response (defined during acquisition) are shown across training trials, in an 85:15% reward environment. Greater accumulation in weight differences result in more deterministic choice but difficulty in unlearning. Data shown for networks trained on with a long (270 ms) or short (150 ms) fixed duration TAN pause, as well as a network employing an entropy-driven feedback mechanism. Reversal at trial 200 denoted with dotted line. MSNs, medium spiny neurons; TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.007">http://dx.doi.org/10.7554/eLife.12029.007</ext-link></p></caption><graphic xlink:href="elife-12029-fig5-v4.tif"/></fig></p><p>The importance of this trade-off is most evident across different levels of predictable stochasticity, which was manipulated by varying the reward schedule. In a probabilistic reversal learning task in which the optimal action was rewarded with an 85% reward rate (suboptimal action rewarded 15%), networks with a short TAN pause outperformed networks with a longer TAN pause (<xref ref-type="fig" rid="fig6">Figure 6</xref>, left). Accuracy (percent choice of the optimal action) across all trials was 78% (SD<italic>=</italic>7%) for the shortest pause compared with 70% (SD=5%) for the longest TAN pause [t(148) = 7.3, p&lt;3x10<sup>–10</sup>, Cohen’s d = 1.2]. In a more stochastic task with only 40% reward rates for the optimal action (10% for the suboptimal action), the pattern is reversed: long pause networks obtained an overall accuracy level of 53% (SD = 10%) compared to 65% (SD = 10%) for long pause networks [t(148) = 8.1, p&lt;3x10<sup>–13</sup>, Cohen’s d = 1.3] (<xref ref-type="fig" rid="fig6">Figure 6</xref>, center). In both environments, overall accuracy varies parametrically with pause duration and degrades gracefully. These simulations show that, for each environment, the optimal pause duration is dependent on the cost of sensitivity to noise and the need for flexible behavior. The high MSN entropy generated by a short TAN pause allows for increased flexibility, which is advantageous in a highly deterministic environment with a single reversal, where spurious negative outcomes are less common, lowering the cost of sensitivity to noise. In contrast, the lower entropy MSN representation generated by longer TAN pauses (due to divergent weights) is advantageous when the task is highly stochastic. The ability to ignore spurious negative outcomes allows the network to maintain a stable estimate of an action value, which can be more important than behavioral flexibility. As a result, the performance of a network with fixed pause duration is dependent on the environmental statistics.<fig id="fig6" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.008</object-id><label>Figure 6.</label><caption><title>Learning in the neural network across multiple reward schedules.</title><p><italic>Left</italic>: Networks with fixed short TAN pauses across training (red) exhibited higher performance in an environment with 85:15% reward contingencies for the optimal and suboptimal actions, compared with networks with long TAN pauses (blue), due to increased learning speed following reversal. <italic>Center</italic>: Networks with long TAN pauses (blue) were able to acquire a task with 40:10% contingency, unlike networks with a short TAN pause (red). Networks with variable pause durations as a function of MSN entropy are shown in black, with good performance in both environments. <italic>Right</italic>: Across both reward schedules, networks in which TAN pause duration was allowed to vary with MSN entropy (black) made fewer errors than networks of any fixed duration. Reversal is denoted with dotted line in all panels. MSNs, medium spiny neurons; TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.008">http://dx.doi.org/10.7554/eLife.12029.008</ext-link></p></caption><graphic xlink:href="elife-12029-fig6-v4.tif"/></fig></p><sec id="s2-1"><title>Adaptive tuning of TAN pauses and learning rates using MSN population entropy</title><p>A principled way to balance this trade-off is to use the learner’s uncertainty over its action values to anneal the learning rate, similar to the gain in a Kalman filter (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>). For an ideal observer, the proper measure of this uncertainty depends on the parameterization of the generative processes of the task, which may require several levels of hierarchical representations (<xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Mathys et al., 2011</xref>) that may be unavailable in a local striatal network. However, as noted above, entropy over multiple MSN populations can be used as a proxy as it can be interpreted as the uncertainty with which the network selects an action. Although we have thus far described this entropy as an observable variable to provide an explanation for how TAN pauses affect the trade-off between flexibility and stability because it can be read out from the distribution of MSN firing rates, we hypothesized that this same measure may be used to reciprocally influence TAN pauses and hence learning. In this way, the system could self-detect its own uncertainty in a way that (unlike any given fixed pause duration) is not dependent on the parameterization of a particular task and is implicitly available in the population response.</p><p>Given their size and broad connectivity across large areas of striatum spanning many MSNs, it is plausible that TANS are sensitive to population MSN entropy or a correlate thereof by summing activity over multiple neurons coding for different actions. As noted earlier, TANs receive substantial GABAergic innervation from medium spiny neurons (<xref ref-type="bibr" rid="bib13">Bolam et al., 1986</xref>; <xref ref-type="bibr" rid="bib18">Chuhma et al., 2011</xref>; <xref ref-type="bibr" rid="bib39">Gonzales et al., 2013</xref>). While the initiation of a TAN pause is dependent on thalamic and dopaminergic signaling (<xref ref-type="bibr" rid="bib2">Aosaki et al., 1994</xref>; <xref ref-type="bibr" rid="bib27">Ding et al., 2010</xref>), we propose that local signaling from MSNs can modulate the response by elongating the duration of the pause (or simply further reducing the firing rate during the pause) through direct inhibition. If TANs are sensitive to MSN entropy and can modulate their pause durations accordingly, they may provide a mechanism to adjust to changes in uncertainty.</p><p>To assess this potentially adaptive mechanism, we first conducted simulations in which the TAN pause was dynamically modulated by an analytical computation of MSN entropy (see Materials and methods); below, we will consider a more mechanistic implementation by which TANs respond to local circuits that approximate entropy. These simulations confirmed that dynamic modulations of TAN pause as a function of MSN mitigated the trade-off between flexible learning and sensitivity to noise. When trained on an 85% reward schedule, the network with a variable duration pause learned relatively quickly following reversal while still achieving a high level of asymptotic accuracy (<xref ref-type="fig" rid="fig6">Figure 6</xref>, left). When trained on a 40% reward schedule, performance was comparable to the best network trained with a long fixed duration pause (<xref ref-type="fig" rid="fig6">Figure 6</xref>, center). While in both the cases it was possible to find a particular fixed duration pause that can perform as well as a variable pause duration, networks with entropy-modulated pause durations performed better across both reward schedules than any fixed pause network [Accuracy ~ <italic>N</italic>(<inline-formula><mml:math id="inf1"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>,I<inline-formula><mml:math id="inf2"><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>); <inline-formula><mml:math id="inf3"><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:menclose notation="top"><mml:mtext>μ</mml:mtext></mml:menclose><mml:mi>variable</mml:mi></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mo>-</mml:mo><mml:mo> </mml:mo><mml:mi>max</mml:mi><mml:mo> </mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:menclose notation="top"><mml:mtext>μ</mml:mtext></mml:menclose><mml:mi>fixed</mml:mi></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>]</mml:mo><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>5</mml:mn><mml:mo>.</mml:mo><mml:mn>76</mml:mn><mml:mo>%</mml:mo><mml:mo>;</mml:mo></mml:math></inline-formula> <inline-formula><mml:math id="inf4"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>variable</mml:mi></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo> </mml:mo><mml:mo>≤</mml:mo><mml:mo> </mml:mo><mml:mi>max</mml:mi><mml:mo> </mml:mo><mml:mo>∥</mml:mo><mml:msub><mml:mover><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>fixed</mml:mi></mml:msub><mml:msub><mml:mo>∥</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> = 1.03x10<sup>-3</sup>]. Thus, while a fixed TAN pause may perform well in any one environment, any given fixed setting is suboptimal when the environment is unknown. Varying TAN behavior with MSN entropy allows the network to learn robustly over a wider range of environment statistics, thereby allowing learning rates to be sensitive to the network’s own uncertainty.</p><p>This behavioral flexibility occurs as the feedback mechanism induces longer pauses during periods of higher uncertainty. In the 85% reward environment, the feedback mechanism results in dynamic behavior: TAN pauses last greater than 250 ms both at the beginning of the task and following reversal, while pauses reach 200 ms immediately prior to reversal and at the end of the training session when less learning is required (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom left). As such, the long TAN pause early in acquisition results in increased synaptic efficacy for Go units associated with the dominant response relative to the suboptimal response (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom right). As the entropy and the pause duration decline, the rate of change in synaptic efficacy slows, resulting in faster reversal learning as the network can unlearn the previous reward association more quickly. In contrast, uncertainty remains elevated in the in the highly stochastic 40% reward environment and the TAN pause consequently remains elevated throughout training (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom left). As such, the feedback mechanism results in changes in synaptic efficacy that are similar to changes induced by a long fixed duration TAN pause.</p></sec><sec id="s2-2"><title>Normative and algorithmic descriptions of TAN pause behavior</title><p>Before further analyzing biophysical mechanisms within the model—including a mechanism for computation of entropy, the effects of M1 receptor manipulations, and additional roles of the post–pause burst on DA release—we first develop higher level (computational and algorithmic) models that summarize the key trade-off identified above in functional terms (<xref ref-type="bibr" rid="bib54">Marr and Poggio, 1976</xref>). While the neural network model makes empirical predictions at the biophysical level, the core computational and algorithmic problems solved by the network can be imbedded in simpler formulations. To describe the computational and algorithmic problems solved by the network, we compared the network’s behavior with two models: (1) an approximately Bayesian model that considers the higher-level computational problem of learning under uncertainty, and (2) an algorithmic model that more closely matches learning in the basal ganglia mechanistically, modified from <xref ref-type="bibr" rid="bib22">Collins and Frank (2014)</xref> to include the role of TANs.</p><p>The core computational problem solved by the addition of TANs in the network addresses how to integrate noisy experiences in a changing environment. <xref ref-type="bibr" rid="bib11">Behrens et al. (2007)</xref> noted that in a changing environment, a hierarchical representation of volatility can be used to adjust the learning rate in an optimal way. If rewards are distributed probabilistically with rate <italic>r</italic> and changes from trial to trial, an optimal agent can estimate the volatility of <italic>r</italic> as well as their distrust in the trial-to-trial volatility of the reward rate. It is unlikely that this hierarchical inference is implemented in the basal ganglia; thus, we consider here an approximation by which this computation need not be performed explicitly but where the striatum has access to its own uncertainty and adjust its learning rate accordingly.</p><p>In the tasks simulated, rewards were of equal value and delivered stochastically. In a stationary task with binomial outcomes, the posterior distribution of the reward rate for an optimal learner is a Beta distribution (<xref ref-type="bibr" rid="bib25">Daw et al., 2005</xref>) parameterized by the counts of rewarded and non-rewarded trials. Because reversal tasks are, by definition, non-stationary, the Beta distribution does not represent the exact posterior distribution of expected values and is slow to adjust to a reversal: it becomes too certain about reward contingencies. A Bayesian treatment allowing for the possibility that the outcome statistics can change can be approximated using a mixture distribution combining the posterior of expected values with a uniform distribution (<xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>). In this approximation, the mixture component is the probability a change has occurred to some other unknown contingencies. Instead, we use a multiplicative parameter <inline-formula><mml:math id="inf5"><mml:mi>γ</mml:mi></mml:math></inline-formula> to decay the counts of the Beta hyper-parameters towards the prior after each trial, an approximation that has been used previously to model rodent and human behavior (<xref ref-type="bibr" rid="bib25">Daw et al., 2005</xref>; <xref ref-type="bibr" rid="bib30">Doll et al., 2009</xref>). Decaying the counts multiplicatively maintains the mode expected value for each action but increases the variance (uncertainty) of the distribution. This effectively reduces the model’s confidence of the expected value without changing its best estimate. Hence, a faster decay rate allows for greater effective learning rate, analogous to the mechanism in the BG model, whereby MSN weights are prevented from overlearning.</p><p>We simulated the Bayesian model with both fixed values of <inline-formula><mml:math id="inf6"><mml:mi>γ</mml:mi></mml:math></inline-formula> as well as a <inline-formula><mml:math id="inf7"><mml:mi>γ</mml:mi></mml:math></inline-formula> that varied as a function of entropy in action selection. Models with fixed values of <inline-formula><mml:math id="inf8"><mml:mi>γ</mml:mi></mml:math></inline-formula> are analogous to neural networks with a fixed duration TAN pause, both constituting static strategies to balance asymptotic accuracy and learning speed. Varying <inline-formula><mml:math id="inf9"><mml:mi>γ</mml:mi></mml:math></inline-formula> as a function of action selection entropy is similar to the strategy employed by the neural network, as MSN entropy corresponds to the decision uncertainty of the network.</p><p>Over both manipulations, the Bayesian model shows the same qualitative pattern of behavior as the neural network (<xref ref-type="fig" rid="fig7">Figure 7</xref>, right). For fixed values of <inline-formula><mml:math id="inf10"><mml:mrow><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mtext/></mml:mrow></mml:math></inline-formula> we found the same tradeoff between asymptotic accuracy and learning speed following reversal. Likewise, varying the decay rate with uncertainty mitigated the effects of the trade-off, facilitating faster learning following reversal than possible with a slow, fixed decay rate without the cost of asymptotic accuracy associated with high, fixed decay (<xref ref-type="fig" rid="fig7">Figure 7</xref>, right, black line). Given that it is an idealized statistical model and not implementational, the Bayesian learner responds with an overall higher level of accuracy than the neural network. Unlike the Bayesian learner, the neural network does not learn an estimate of each action value directly but instead learns relative preferences for actions. Nevertheless, overall, the Bayesian learner provides a normative description of the neural network as the effect of manipulating the decay parameter <inline-formula><mml:math id="inf11"><mml:mi>γ</mml:mi></mml:math></inline-formula> is qualitatively similar to what we see when manipulating TAN duration, suggesting that TAN duration affects the uncertainty of representations in MSNs.<fig id="fig7" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.009</object-id><label>Figure 7.</label><caption><title>Comparison of behavior between neural network and Bayesian learner collapsed across multiple reward schedules.</title><p>The performance of the Bayesian learner (i) is qualitatively similar to the performance of the neural network model (<italic>left</italic>). A slow decay rate in the Bayesian learner (<italic>right, blue</italic>) has the same effect as a long TAN pause (<italic>left, blue</italic>) and results in higher asymptotic accuracy at a cost of slower learning following reversal. A fast decay rate (<italic>right, red</italic>) has the same effect as a short TAN pause (<italic>left, red</italic>) and results in fasters learning following reversal with lower asymptotic accuracy. Varying the decay rate and pause duration with entropy in the Bayesian learner and neural network, respectively, mitigates the trade-off. Reversal is denoted with dotted line in both panels.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.009">http://dx.doi.org/10.7554/eLife.12029.009</ext-link></p></caption><graphic xlink:href="elife-12029-fig7-v4.tif"/></fig></p><p>The OpAL model proposed by <xref ref-type="bibr" rid="bib22">Collins and Frank (2014)</xref> provides a more algorithmic summary of the basal ganglia network, as an expansion of an actor–critic model to include opponent (D1/D2) actor values. The OpAL model provides a normative advantage over traditional RL while quantitatively capturing a variety of data across species implicating opponent processes in both learning and action selection, where dopamine manipulations affect the asymmetry with which humans and animals make decisions, in a model with few free parameters. In the OpAL model, reward prediction errors are computed within a critic that evaluates the expected value of each state, and are used to update these values and train the G and <italic>N</italic> actors, summarizing the population activity of Go and NoGo units with point values (see Materials and methods). To simulate the effect of TANs in OpAL, the <italic>G</italic> and <italic>N</italic> weights were decayed multiplicatively after each trial by either a constant rate (to simulate the effects of a fixed-duration TAN pause), or as a function of <italic>G</italic> and <italic>N</italic> entropy (to simulate the effects of the proposed feedback mechanism). A fast rate of decay (closer to zero) simulated a short TAN pause whereas a slow rate of decay (closer to one) simulated a long TAN pause.</p><p>Simulations over a range of fixed rates of decay shows a similar pattern as in the neural network and Bayesian learner, as slow rates of decay showed high asymptotic accuracy but with a decreased learning speed following reversal in a deterministic environment (<xref ref-type="fig" rid="fig8">Figure 8</xref>, left). Likewise, a faster rate of decay showed a similar pattern to networks with short TAN pause durations and showed increased flexibility after reversal at a cost of asymptotic accuracy. As in the neural network, the trade-off between asymptotic accuracy and speeded learning after reversal was marked by a divergence in the <italic>G</italic> weights (<xref ref-type="fig" rid="fig8">Figure 8</xref>, right). For models with a slow decay, the difference between <italic>G</italic> weights for the initially rewarded response and the initially sub-optimal response was much more pronounced than models with a faster decay. This divergence declined more rapidly in models with a slow decay, allowing these models to unlearn the previously rewarded response more quickly.<fig id="fig8" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.010</object-id><label>Figure 8.</label><caption><title>Peformance of OpAL in an 85% reward environment.</title><p><italic>Left:</italic> Fast decay in synaptic weights (red lines) result in lower asymptotic accuracy but speeded learning following reversal while slow weight decay (blue lines) result in the opposite pattern. A model that varies the decay rate with policy uncertainty (black line) mitigates this trade-off. <italic>Right</italic>: Slow decay rates result in a large divergence between G weights for the two possible actions prior to reversal (trial 200) that correlates with high asymptotic accuracy and slower learning speed following reversal, as this divergence must be unlearned. An entropy modulated decay rate shows a high initial rate of divergence sufficient to improve accuracy but slows as the model learns the task, facilitating reversal.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.010">http://dx.doi.org/10.7554/eLife.12029.010</ext-link></p></caption><graphic xlink:href="elife-12029-fig8-v4.tif"/></fig></p><p>Allowing the decay rate to vary as a function of uncertainty also showed the same pattern of behavior found in the neural network, mitigating the trade-off and resulting in both high asymptotic accuracy as well as speeded learning following reversal (<xref ref-type="fig" rid="fig8">Figure 8</xref>, left). Overall, varying decay with entropy resulted in higher reward rate compared with the next best performing model with fixed decay [t(198)=3.7, p&lt;3x10<sup>–4</sup>, Cohen’s d = 0.5]. Varying decay with entropy also optimized the divergence of <italic>G</italic> weights relative to fixed decay. The initial rate of divergence of the variable model is similar to that of a slow decay model, improving asymptotic accuracy. This rate of divergence declines as the model learns, preventing overlearning and facilitating faster learning following reversal. This is the same pattern observed in the divergence of Go weights in the neural model (<xref ref-type="fig" rid="fig5">Figure 5</xref>, bottom right), where varying pause duration with entropy optimized the divergence of weights relative to fixed duration pauses.</p></sec><sec id="s2-3"><title>A local mechanism for entropy modulation of TAN duration</title><p>In the neural network simulations we proposed that TANs may have access to entropy over MSNs, given that they span large regions of the striatum and receive inputs from many MSNs and GABAergic interneurons. However, the biophysical details by which spiny neuron modulate TAN activity are not fully understood. Direct transmission of entropy may not be trivial as population entropy is a nonlinear function of the units’ activity. Here we consider a more explicit mechanism by which TANs directly approximate MSN entropy through synaptic integration. First, consider the minimalist case of just two MSNs coding for alternative actions. Here, the entropy is high when both are active or inactive, but low when either of the two units alone is active. In terms of a Boolean function, the entropy of the two MSNs is the logical opposite of an 'exclusive OR', a non-linear problem that typically requires interneurons to detect (<xref ref-type="bibr" rid="bib73">Rumelhart and McClelland, 1986</xref>). While one potential mechanism for TANs to detect MSN entropy is by including interneurons, this non-linear detection is linearly solvable if the problem is split into two separate detections: the detection of when both neurons are active and the detection of when neither is active (<xref ref-type="fig" rid="fig8">Figure 8</xref>, top left). Consequently, a potential approximation for MSN entropy would be the detection of coincident activity (or inactivity) of pairs of MSNs. While an active readout of joint inactivity is implausible, this problem is solved by the opponent nature of MSN pathways in the BG (<xref ref-type="bibr" rid="bib34">Frank, 2005</xref>; <xref ref-type="bibr" rid="bib49">Kravitz et al., 2012</xref>), where the TANs could detect either coincident activity of two D1 MSNs signaling Go activity or two D2 MSNs signaling NoGo activity.</p><p>This scheme would require a synaptic organization such that two MSNs associated with different motor responses synapse close together on the dendrite of a TAN to facilitate coincidence detection (<xref ref-type="fig" rid="fig9">Figure 9</xref>, top right). Coincidence detection between distinct signals is thought to be an important mechanism both for cellular plasticity (<xref ref-type="bibr" rid="bib83">Wang et al., 2000</xref>) as well as the coordination of sensory input (<xref ref-type="bibr" rid="bib48">Kapfer et al., 2002</xref>). If synaptic signaling from both MSNs is needed to propagate an action potential to the cell body, then the pair of synapses can be thought of as a coincidence detector. In logical terms, the synapse pairs perform Boolean 'AND' detection (<xref ref-type="fig" rid="fig9">Figure 9</xref>, top left). Several pair of D1 synapses located on the dendrites of a single TAN could result in the summation of these signals in the cell body of the TAN, approximating half of the entropy function signaling that there is evidence for multiple motor responses. Similarly, multiple pairs of D2 synapses contributes to the other half of the entropy function, signaling that there is evidence against multiple responses. Thus, these two measures could effectively approximate decision uncertainty in the MSN population and are detectable by a single TAN via direct synapses from MSNs. In principle, other mechanisms within the striatum could transmit the population uncertainty (e.g., via further interactions between MSNs and fast-spiking interneurons). Our exercise below thus presents but a single plausible mechanism.<fig id="fig9" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.011</object-id><label>Figure 9.</label><caption><title>Approximations of MSN population uncertainty.</title><p>(<bold>A</bold>) Shannon’s entropy for two MSNs can be expressed with Boolean logic. Low entropy occurs when only one MSN is active (bottom left or top right box) and is the exclusive-OR function. High entropy is the logical opposite. (<bold>B</bold>) Spatially organized synapses could allow the detection of activity in two MSNs associated with separate motor responses, indicating high entropy. Activity in pairs of D1-MSNs signal high uncertainty given evidence for multiple responses, activity in pairs of D2-MSNs signal high uncertainty given evidence against multiple responses. (<bold>C</bold>) Detection of 'AND' pairs in Go population approximates Shannon’s entropy across time, whereas simple summation of all Go unit activity does not. Dotted line denotes reversal at mid-point in training. (<bold>D</bold>) Neural network with AND detection performs well in both an 85% reward (<italic>left</italic>) and 40% reward (<italic>right</italic>) environments as compared to networks with fixed TAN behavior. (<bold>E</bold>) Varying pause duration with Shannon’s entropy (green line) or the detection of AND conjunctions (orange line) results in similar behavior. MSNs, medium spiny neurons; TANs, tonically active neurons.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.011">http://dx.doi.org/10.7554/eLife.12029.011</ext-link></p></caption><graphic xlink:href="elife-12029-fig9-v4.tif"/></fig></p><p>We simulated the network varying the TAN pause with AND detection in the Go units (see Materials and methods). In a network with a fixed duration TAN pause (180 ms) and trained on an 80% reward schedule, AND detection in Go units followed a similar temporal pattern to Shannon’s entropy (<xref ref-type="fig" rid="fig9">Figure 9</xref>, center left). Both AND detection and entropy decline as the network learns the task and rise following the reversal of the reward contingencies. Not all summary statistics of MSN activity follow this pattern: for example, the simple summation of all activity in the Go population gradually declines over training and consequently, is not suitable for an approximation of entropy (<xref ref-type="fig" rid="fig9">Figure 9</xref>, center right). Notably, modulating TAN pause duration with the AND detection can also mitigate the behavioral trade-off between flexibility and stability, similar to the patterns observed using entropy (<xref ref-type="fig" rid="fig9">Figure 9</xref>, bottom right).</p></sec><sec id="s2-4"><title>Simulated ablation of M1-receptors</title><p>In the neural network model, varying the duration of the TAN pause alters the degree to which MSNs are disinhibited during reward feedback. Mechanistically, this depends solely on M2 receptors, which are responsible for inhibition of the TANs in the model, and does not involve changes in the activity of M1 receptors (see Materials and methods). However, previous empirical studies have linked M1 receptors to learning after reversal. Both TAN ablations and muscarinic antagonists impair reversal learning but do not affect acquisition in deterministic tasks (<xref ref-type="bibr" rid="bib67">Ragozzino et al., 2002</xref>; <xref ref-type="bibr" rid="bib86">Witten et al., 2010</xref>), an effect that is specific to M1 receptors (<xref ref-type="bibr" rid="bib58">McCool et al., 2008</xref>).</p><p>To investigate the effects of M1 receptors in the model, we simulated selective M1 receptor ablations (see Materials and methods). In our simulations, the simulated ablation of M1 receptors only modestly decreases performance during acquisition, resulting in similar asymptotic accuracy as a control model that does not contain TANs (<xref ref-type="fig" rid="fig3">Figure 3</xref>, left). Following reversal, the effects are much more pronounced as simulated M1 ablation results in severely degraded accuracy (<xref ref-type="fig" rid="fig3">Figure 3</xref>, right). These results are qualitatively consistent with empirical findings showing impairment in reversal learning following M1 antagonists. It is noteworthy that the impairment with simulated M1 ablations only occur as a consequence of the disinhibitory effects of the TAN pause that drive MSN activity to a lower entropic state: control networks simulated without TANs do not show the same degree of impairment (<xref ref-type="fig" rid="fig3">Figure 3</xref>, right). Without this decrease in entropy or the increase in NoGo excitability, the network is able to learn following the reversal. However, both effects combine to allow the network to adapt more flexibly, perseverating in the correct action when it is rewarded but more sensitive to negative feedback facilitating reorienting.<fig id="fig10" position="float"><object-id pub-id-type="doi">10.7554/eLife.12029.012</object-id><label>Figure 10.</label><caption><title>Post-pause TAN burst.</title><p>An increase in phasic TAN activity following the feedback-related pause modulates asymptotic performance following reversal. Simulations shown with a fixed TAN pause of intermediate duration (190 ms) in an 85% reward environment, post-pause TAN firing rates are presented in normalized units of change relative over a baseline firing rate corresponding to the tonic firing rate. TAN, tonically active neuron.</p><p><bold>DOI:</bold> <ext-link ext-link-type="doi" xlink:href="10.7554/eLife.12029.012">http://dx.doi.org/10.7554/eLife.12029.012</ext-link></p></caption><graphic xlink:href="elife-12029-fig10-v4.tif"/></fig></p></sec><sec id="s2-5"><title>Simulations of post-pause TAN rebound burst</title><p>A phasic increase or rebound burst in TAN activity above tonic firing rates is commonly observed immediately following the reward-related pause (<xref ref-type="bibr" rid="bib4">Aosaki et al., 2010</xref>). The functional significance of this burst is an open question but one likely function of the post-pause burst is to facilitate synaptic plasticity through the release of dopamine during an important time window. Optogentic stimulation of TAN neurons leads to the release of dopamine through the activity of the nicotinic receptors on striatal dopamine terminals (<xref ref-type="bibr" rid="bib15">Cachope et al., 2012</xref>; <xref ref-type="bibr" rid="bib81">Threlfell et al., 2012</xref>). Dopamine release precipitated by post-pause TAN activity would result in the delivery of dopamine immediately following a period in which striatal spiny neurons were disinhibited. This timing has important plasticity consequences as dopamine release following glutamatergic input promotes spine enlargement (<xref ref-type="bibr" rid="bib88">Yagishita et al., 2014</xref>). Consequently, we hypothesize the post-pause TAN burst promotes plasticity by releasing dopamine during a sensitive time window following increased spiny neuron activity, while concurrently suppressing potentially interfering activity with muscarinic inhibition. To investigate the consequences of this hypothesis, we modeled the effects of a phasic increase in TAN activity following the feedback pause in the reversal learning task in an 85% reward environment. We found higher post-pause TAN firing rates resulted in higher asymptotic accuracy following reversal as compared to lower firing rates <xref ref-type="fig" rid="fig10">Figure 10</xref>. Interestingly, this effect was selective to reversal: there was no additional effect of of post-pause TAN activity on learning speed, both prior to and following reversal, and no effects on asymptotic performance prior to reversal. Together, the effects of TAN pause and rebound burst act to enhance the BG network’s ability to reverse and stabilize newly learned contingencies.</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>To act purposefully, a learner needs to ignore predictable irrelevant feedback driven by environmental stochasticity, while also flexibly adapting to a changing environment. This problem is general to learning with several proposed solutions (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Mathys et al., 2011</xref>). Here, we proposed how the striatum may incorporate uncertainty to an adaptive process in line with these general principals of learning with a model in which striatal cholinergic signaling promotes encoding uncertainty in the MSN population. Across all simulations, incorporating TANs increased asymptotic performance over the previously published BG model (<xref ref-type="bibr" rid="bib34">Frank, 2005</xref>). Simulated lesions of M1-AChRs revealed a qualitatively similar pattern of behavior as reported in rodent ablation and optogenetic studies (<xref ref-type="bibr" rid="bib58">McCool et al., 2008</xref>; <xref ref-type="bibr" rid="bib86">Witten et al., 2010</xref>). Parametric manipulations of TAN pauses revealed a trade-off between asymptotic accuracy and flexible learning driven by changes in MSN entropy. As a result, a network with any fixed TAN behavior can perform well in one task but may perform poorly in others. MSN entropy decreased over time in networks with long, fixed duration TAN pauses, making them less sensitive to stochastic noise, and facilitating performance in highly stochastic, sparsely rewarded environments. In contrast, networks with short, fixed duration TAN pauses had relatively constant levels of MSN entropy, resulting in labile representations sensitive to noise. As these networks are sensitive to negative feedback, they were able to learn quickly following a reversal, particularly in more deterministic environments.</p><p>The behavioral trade-off seen in the network is a product of a fixed learning behavior in a stochastic and non-stationary environment. Optimal behavior in such environments requires balancing the need to create precise estimates of an action’s value with the flexibility to respond to sudden changes (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>). These goals are counter-posed, thus any fixed learning rule that treats each observation equally at the time of observation will not be able to achieve both. If a learner is sensitive to recent events, she will be quick to detect changes but sensitive to any noise in the observations. Conversely, if a learner considers a longer time window to determine the best course of action, she will be slower to detect a change but be able to ignore irrelevant outcomes. Computationally, this pattern can be described by decay rate in the approximately Bayesian model as a fast decay rate considers recent events more strongly than a slow decay rate, which considers a longer history of events.</p><p>These findings suggest that TANs may provide an effective way of annealing the learning rate at the population level by implicitly coding uncertainty in the spiny neuron population code and making learning in the basal ganglia more (though not perfectly) Bayesian. Short TAN pauses are computationally similar to a high learning rate (fast decay in the Bayesian model) and long TAN pauses are similar to a low learning rate (slow decay). These effects are driven by relative differences in disinhibition of MSNs during reinforcement, and are not dependent on temporal dynamics of the pause (the same tradeoff between flexible and stable learning was seen when the magnitude of the pause rather than duration was manipulated). During the TAN pause, the reduction in TAN activity lowers the level of MSN inhibition, increasing the differential of activity between response selection and feedback. The greater disinhibition associated with longer TAN pauses results in a higher differential of activity and stronger reinforcement, driving the MSN population towards a lower entropy representation. Conceptually, embedding uncertainty into the population code of spiny neurons is similar to proposals that probabilistic population codes are used to maintain distributions for Bayesian inference (<xref ref-type="bibr" rid="bib52">Ma et al., 2006</xref>). In both cases, the entropy of the population code can represent uncertainty, but here we explore the implication of this notion for learning within the basal ganglia, rather than inference in sensory cortex.</p><p>The reduction in MSN entropy with learning results in a lower population-level learning rate. This happens because the reduction in entropy reflects a reduction in the number of units active during reinforcement, such that the highly active units representing the dominant (most rewarded) action will persist in the face of spurious outcomes. Highly active units require more reinforcement to unlearn the association while inactive units are not available for reinforcement due to activity-dependent plasticity. As a result, an MSN population with lower entropy learns more slowly. As previously pointed out with the basal ganglia acetylcholine-based entropy (BABE) model, a reduction in MSN entropy will also decrease stochastic exploration as a decrease in MSN entropy lowers noise in the evidence for action (<xref ref-type="bibr" rid="bib78">Stocco, 2012</xref>). In this work, we provide a single mechanism that affects learning rate and exploration as a function of entropy, but we note that even the exploration effect is learned and is collinear with the change in learning rate: we manipulated TAN pauses only during reinforcement, the window in which pauses overlap with phasic dopamine responses (<xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>). Both changes arise as changes in synaptic weights alter the entropic representations in future trials, allowing the network to anneal its learning rate and change its stochastic exploration adaptively with its own uncertainty.</p><p>Given the size and extensive connectivity of TANs within the striatum, it is plausible that TANs are responsive to MSN entropy or a correlate, such as the coincident detection of pairs of active Go or NoGo neurons associated with separate motor responses. TANs receive substantial GABAergic innervation from MSNs (<xref ref-type="bibr" rid="bib39">Gonzales et al., 2013</xref>) and are regulated by the neuropeptides enkephalin and substance P from MSN axons (<xref ref-type="bibr" rid="bib40">Gonzales and Smith, 2015</xref>). This connectivity appears to be involved in learning as Pavlovian learning has been associated with an increase of δ-opioid receptor expression in TANs in rodent accumbens (<xref ref-type="bibr" rid="bib14">Bradfield et al., 2013</xref>; <xref ref-type="bibr" rid="bib51">Laurent et al., 2014</xref>). We have proposed, given this connectivity and the potential for MSNs to represent action selection uncertainty within a population code, it is plausible that a measure of uncertainty could be approximated directly with signaling from MSNs to TANs.</p><p>Differences in TAN pause duration have been reported in several cases that lead us to the hypothesis that the TAN pause duration may be an important modulator of cellular activity. In a behavioral context, differences in TAN pause duration have been reported to the motivational valence of a stimuli (<xref ref-type="bibr" rid="bib71">Ravel et al., 2003</xref>) and to the presence or omission of reward (<xref ref-type="bibr" rid="bib5">Apicella et al., 2009</xref>). In vitro, application of dopamine can elongate the TAN pause response (<xref ref-type="bibr" rid="bib26">Deng et al., 2007</xref>) and the duration of the pause has been linked to the magnitude of initial excitatory input (<xref ref-type="bibr" rid="bib28">Doig et al., 2014</xref>). These results suggest the duration of the TAN pause may be an important regulator mechanism and we further hypothesize that the local collaterals from many spiny neurons across the striatum onto a single giant TAN would allow the TAN to reciprocally modulate MSN population activity.</p><p>However, an important caveat to this hypothesis is that while the MSN to TAN synaptic connections are established and influence inhibitory currents within TANs (<xref ref-type="bibr" rid="bib13">Bolam et al., 1986</xref>; <xref ref-type="bibr" rid="bib18">Chuhma et al., 2011</xref>), we are not aware of direct in vivo evidence that TAN pauses are modulated by MSN activity. This constitutes a core prediction of the model. We propose that coincident MSN activity is largely involved in regulating the TAN pause that occurs during novel and/or rewarding events (forming a window around phasic dopaminergic signaling) and may be less relevant at other periods of time. However, the exact influence of MSNs signaling on TAN activity and the mechanism for its transduction remain open to questions.</p><p>An alternate hypothesis is that pause duration is not modulated by MSN activity at all and reflects excitatory and dopamine input (<xref ref-type="bibr" rid="bib27">Ding et al., 2010</xref>). In this case, we might still expect TAN activity to reflect uncertainty signals relevant to learning, relayed from other brain areas. The source of an uncertainty signal might originate through an explicit system that could signal a change-point in the reward rate (<xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>; <xref ref-type="bibr" rid="bib85">Wilson et al., 2010</xref>) or infer a change in a latent context or rule-structure (<xref ref-type="bibr" rid="bib37">Gershman et al., 2010</xref>; <xref ref-type="bibr" rid="bib31">Donoso et al., 2014</xref>). In principle, MSN entropy could also be influenced by hierarchical inputs from cortical areas that either further constrain action selection or increase noise, based on other factors such as perceived volatility. Human functional MRI (fMRI) studies have identified correlates of uncertainty processing in multiple areas, notably in the anterior cingulate cortex and striatum (<xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib8">Bach et al., 2011</xref>), leaving open multiple possible mechanism to consider uncertainty at the whole brain level, including the top-down modulation of MSN entropy or TAN signals. Interestingly, a recent fMRI study have linked abstract prediction errors to the basal-forebrain, a separate source of cholinergic signaling (<xref ref-type="bibr" rid="bib45">Iglesias et al., 2013</xref>). A final possibility is that uncertainty can be communicated to the TANs via more complex local striatal networks involving both MSNs and GABAergic interneurons, or an external source, such as a derivative of the dopamine learning signal. Nevertheless, while we have proposed that MSN synapses on TANs may directly relay an uncertainty cue, the core model prediction that TANs promote adaptive striatal learning via some representation of uncertainty is not itself sensitive to the source of the uncertainty cue.</p><p>Accordingly, the model makes several novel empirical predictions. A central prediction of the model is that MSN entropy should correlate with decision uncertainty during a task, which interacts with task stochasticity, and should covary with the degree of TAN pause inhibition. Similarly, we predict TAN pause duration (or equivalently, TAN firing rate) should correlate with decision uncertainty. Whereas previous studies have found a link between TAN activity and reversal learning (<xref ref-type="bibr" rid="bib67">Ragozzino et al., 2002</xref>; <xref ref-type="bibr" rid="bib86">Witten et al., 2010</xref>), our model makes the more specific prediction that M2 blockade would correspond with a decrease in overall accuracy during the performance of a probabilistic reversal learning task with multiple reward schedules. Notably, these manipulations were performed in the medial striatum, an area typically thought to be more involved in reversal than acquisition (<xref ref-type="bibr" rid="bib19">Clarke et al., 2008</xref>). It is an open question whether TAN ablations would affect acquisition performance in other striatal areas, and in fact our model does predict changes in acquisition depending on the probabilities of reinforcement. We also expect M2 blockade would affect the tradeoff between exploration and exploitation by interfering with the striatum’s ability to anneal it’s own exploration policy with uncertainty. We would expect this effect to extend to overtraining; M2 blockade may lessen the effects of overtraining on stochastic tasks. We would expect optogentic silencing of TANs entirely to have similar effects.</p><p>While there are several previously proposed solutions to the general learning problem posed here (<xref ref-type="bibr" rid="bib89">Yu and Dayan, 2005</xref>; <xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib55">Mathys et al., 2011</xref>), the model we provide here is not meant as an alternative to these high level descriptions. Rather, we propose how a specific system, the striatum, can modulate its own behavior adaptively in line with Bayesian accounts and provide an interpretation of the role of TANs, tying together electrophysiological, pharmacological, lesion and behavioral data. This poses an additional theoretical question, as there is evidence to suggest that people learn in an adaptive way when faced with change points (<xref ref-type="bibr" rid="bib11">Behrens et al., 2007</xref>; <xref ref-type="bibr" rid="bib61">Nassar et al., 2010</xref>), and in different contexts in a process that likely involves the frontal cortex (<xref ref-type="bibr" rid="bib20">Collins and Koechlin, 2012</xref>; <xref ref-type="bibr" rid="bib21">Collins and Frank, 2013</xref>): why would the striatum consider uncertainty in a heuristic fashion if other systems are able to consider uncertainty explicitly? One benefit such a heuristic system that approximates optimal behavior could offer would be a lack of complexity. Optimal adaptation in a changing environment requires knowledge of the generative process underlying change, a problem that is complex and potentially ill-posed. Inference over the generative model may be too costly in highly complex, rapidly change or novel environments. In such an environment, striatal uncertainty could still be available and alter behavior in an adaptive way, encouraging exploration and weighing recent feedback strongly.</p><sec id="s3-1"><title>Limitations</title><p>While there is some evidence that the duration of the TAN response may be an important regulator of cellular activity, the duration of the TAN pause has often not been linked to signaled probability of reward (<xref ref-type="bibr" rid="bib60">Morris et al., 2004</xref>). It is important to note that the uncertainty over which actions are selected is independent of signaled probability of reward. As such, we would not expect the TAN response to vary with signaled probability of reward in well-trained animals performing a task in which the reward contingencies do not change. If the animals have learned the task well, then the uncertainty about the frequency of reward in a fixed schedule will be low.</p><p>Furthermore, the predictions of our model are not sensitive to the choice of TAN pause duration as a parameter of interest. In the implementation proposed, the duration of the TAN pause controls the degree to which spiny neurons are disinhibited. The algorithm we have used to simulate learning in the neural network model is sensitive to differences in excitation between stimulus presentation and feedback and these changes in disinhibition result in changes to the degree weights are updated in the neural network model. The model would make the same prediction if we varied the overall firing rate during the pause or altered inhibition directly.</p><p>An additional limitation is the focus of the current work on the effects of TAN behavior on MSN excitability relative to other components of striatal cholinergic signaling. The initiation of the TAN response depends on both dopamine and thalamic signaling, (<xref ref-type="bibr" rid="bib2">Aosaki et al., 1994</xref>; <xref ref-type="bibr" rid="bib27">Ding et al., 2010</xref>) both of which convey behaviorally relevant information (<xref ref-type="bibr" rid="bib59">Montague et al., 1996</xref>; <xref ref-type="bibr" rid="bib56">Matsumoto et al., 2001</xref>) and which we have not considered in the current work. Rather, we have only considered the modulation of such signals by MSN activity via collaterals. TANs may play a role integrating thalamic and dopaminergic signaling, but we are unable to make predictions about changes in the TAN response motivated by cell signaling or receptor activation.</p></sec></sec><sec id="s4" sec-type="materials|methods"><title>Materials and methods</title><sec id="s4-1"><title>Neural network model of the basal ganglia</title><p>The neural network model presented here was adapted from the basal ganglia model presented by <xref ref-type="bibr" rid="bib35">Frank (2006)</xref> and implemented within the emergent neural network software (<xref ref-type="bibr" rid="bib1">Aisa et al., 2008</xref>). The model is available on our online repository at <ext-link ext-link-type="uri" xlink:href="http://ski.clps.brown.edu/BG_Projects/Emergent_7.0+/">http://ski.clps.brown.edu/BG_Projects/Emergent_7.0+/</ext-link>. The model uses point neurons with excitatory, inhibitory and leak conductance that contribute to an integrated membrane potential transformed into a rate-code. Learning in the model is accomplished with the Leabra algorithm (<xref ref-type="bibr" rid="bib64">O’Reilly and Munakata, 2000</xref>) and a reinforcement learning version based on dopaminergic modulation of Hebbian plasticity (<xref ref-type="bibr" rid="bib34">Frank, 2005</xref>).</p><p>The neural network model is an attractor network organized into layers of point neurons (units), in which layers represent neural structures (c.f. <xref ref-type="bibr" rid="bib35">Frank, 2006</xref> for a more detailed description of the model). The network is dynamic across time, and units within the network have stochastic behavior. The membrane potential <inline-formula><mml:math id="inf12"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of each unit within a layer is updated at each cycle (discrete time-point) as a function of its net current <inline-formula><mml:math id="inf13"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and a time constant <inline-formula><mml:math id="inf14"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ2"><mml:math id="m2"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo/><mml:msub><mml:mi>τ</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>The net current of a unit is, in turn, a stochastic function of its excitatory, inhibitory, and leak conductances (<inline-formula><mml:math id="inf15"><mml:mi>g</mml:mi></mml:math></inline-formula>) updated at each cycle as follows:</p><p><disp-formula id="equ3"><mml:math id="m3"><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mover><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ4"><mml:math id="m4"><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced><mml:msub><mml:mover><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ5"><mml:math id="m5"><mml:msub><mml:mover><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ6"><mml:math id="m6"><mml:mo>…</mml:mo></mml:math></disp-formula></p><p>where <italic>V<sub>m</sub></italic> is the membrane potential of the unit, <italic>E<sub>C</sub></italic> is the equilibrium potential for current <italic>c</italic>, and where the subscripts <italic>e, l</italic>, and <italic>i</italic> refer to the excitatory, leak, and inhibitory currents, respectively. The total conductance of each channel <italic>g<sub>c</sub></italic> are decomposed into the constant and time varying components <inline-formula><mml:math id="inf16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>g<sub>c</sub></italic>(<italic>t</italic>). Units in the network are connected via synaptic weights, which can be excitatory or inhibitory. The total excitatory input/conductance <italic>g<sub>e</sub></italic>(<italic>t</italic>) to a unit is a function of the mean of the product the firing rate of each sending unit <inline-formula><mml:math id="inf17"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the corresponding synaptic weights <italic>w<sub>i</sub></italic>, a time constant <inline-formula><mml:math id="inf18"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and a scaling factor κ:</p><p><disp-formula id="equ7"><mml:math id="m7"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo/><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo/><mml:mo/><mml:msub><mml:mi>g</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Inhibitory conductance is computed similarly, but applied to synaptic inputs that come from inhibitory neurons, while leak conductance does not vary with time. Gaussian noise (<inline-formula><mml:math id="inf19"><mml:mi>σ</mml:mi></mml:math></inline-formula>) is added to the membrane potential <italic>V<sub>m</sub></italic> of a subset of units in the network (units in the motor cortex and substantia nigra layers, <inline-formula><mml:math id="inf20"><mml:mi>σ</mml:mi></mml:math></inline-formula> =. 0015 and. 002 respectively, sampled from at each cycle of processing). As the conductances of each unit vary across time and between trial to trial as a function of input activity, the rate-coded activity of each unit with a layer varies with its inputs and noise. This added noise induces stochasticity in network choices (and their latencies; Ratcliff and Frank 2012) for any given set of synaptic weights, encouraging exploration: noise in motor cortex induces changes in the degree to which a candidate response is active and hence subject to disinhibition by gating via striatum, and noise in the SNc facilitates within-trial variation in the balance between Go and NoGo unit activity, differentially emphasizing learned positive versus negative outcomes and their effect on gating. Together, these sources of variance yield stochastic choice and dynamics within the striatum shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>.</p><p>The activity communicated to other units in the network, <inline-formula><mml:math id="inf21"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, is a threshold sigmoid function of the membrane potential:</p><p><disp-formula id="equ8"><mml:math id="m8"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo/><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf22"><mml:mi>γ</mml:mi></mml:math></inline-formula> is a gain parameter and where <inline-formula><mml:math id="inf23"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>X</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is a function that returns 0 if <inline-formula><mml:math id="inf24"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf25"><mml:mi>X</mml:mi></mml:math></inline-formula> otherwise. This function is discontinuous at <inline-formula><mml:math id="inf26"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>Θ</mml:mi></mml:mrow></mml:math></inline-formula>, and is smoothed with a Gaussian noise kernel (<inline-formula><mml:math id="inf27"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf28"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>) to produce a softer threshold and represent the intrinsic processing noise in neurons:</p><p><disp-formula id="equ9"><mml:math id="m9"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo/><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi><mml:mo/></mml:mrow></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>σ</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf29"><mml:mi>x</mml:mi></mml:math></inline-formula> is the value <inline-formula><mml:math id="inf30"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf31"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the noise-convoluted activation.</p><p>The layers in the network represent neural structures within the basal ganglia and thalamus. As a first approximation, action selection in the neural network is mediated by two simulated populations of MSNs. The populations of 'Go' and 'NoGo' units, representing striatonigral ('D1') and striatopallidal ('D2') MSNs, respectively, receive excitatory input from a cortical layer corresponding to a unique stimulus. Both the Go and NoGo layer contain 18 units, half of which, through their downstream targets, are connected to one of two motor responses. Reciprocal connections with a layer of inhibitory interneurons (simulating the GABergic fast-spiking interneurons in the striatum) control the overall excitability of the two populations. Activity in Go units inhibits a population in the globus pallidus interal segment (GPi), which results in disinhibition of the thalamus. Activity in the NoGo units inhibits a population in the globus pallidus external segment (GPe), which results in disinhibition of the GPi and inhibition of the thalamus. If there is sufficient activity in the thalamus, it provides a bolus of activity to a corresponding motor cortical column, which can then inhibit its competitors via lateral inhibition, and an action will be selected. This process is stochastic at a network level and depends both on interactions between units that vary with time (learning) as well as noise in the network within trials. However, while this process has trial to trial variability, activity in the Go pathway will facilitate the selection of an action through its downstream effects on the thalamus while activity in the NoGo pathway will suppress response selection.</p><p>Learning in the model occurs through weight updating in corticostriatal synapses without a supervised learning signal. A combination of a Hebbian learning rule and a contrastive Hebbian learning rule are used to determine the weight updates. Variants of contrastive Hebbian learning are consistent with large scale simulations of spike-time dependent plasticity (<xref ref-type="bibr" rid="bib63">O'Reilly et al., 2015</xref>) and serve as a simplifying assumption to a more detailed mechanism of synaptic plasticity. The Hebbian component of the learning rule assumes that the coactivation of MSNs and their cortical inputs proportionally determines the synaptic weight change. The contrastive Hebbian component is determined by the difference in coactivation of pre- and postsynaptic activity across response selection ('minus phase') and outcome feedback ('plus phase'). The equation for the Hebbian weight change <inline-formula><mml:math id="inf32"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> between sending unit <italic>x<sub>i </sub></italic>and receiving unit <italic>y<sub>j</sub></italic> is defined:</p><p><disp-formula id="equ10"><mml:math id="m10"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf33"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> refers to the activity of the receiving unit during outcome feedback ('plus' phase) and <inline-formula><mml:math id="inf34"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is the activity of the sending unit. The contrastive Hebbian weight change is</p><p><disp-formula id="equ11"><mml:math id="m11"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Where <inline-formula><mml:math id="inf35"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf36"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> are the activity of the receiving and sending units during action selection ('minus' phase). The contrastive Hebbian term is subject to a soft-weight bound to keep between 0 and 1:</p><p><disp-formula id="equ12"><mml:math id="m12"><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>b</mml:mi><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf37"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>X</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is a function that returns <inline-formula><mml:math id="inf38"><mml:mi>X</mml:mi></mml:math></inline-formula> if <inline-formula><mml:math id="inf39"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and 0 otherwise and where <inline-formula><mml:math id="inf40"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>X</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> is a function that returns <inline-formula><mml:math id="inf41"><mml:mi>X</mml:mi></mml:math></inline-formula> if <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and 0 otherwise. The Hebbian and contrastive Hebbian terms are combined additively with a normalized mixing constant <inline-formula><mml:math id="inf43"><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p><p><disp-formula id="equ13"><mml:math id="m13"><mml:mo>∆</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ε</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>∆</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>b</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mo>∆</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>b</mml:mi><mml:mi>C</mml:mi><mml:mi>H</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>Dopamine acts as a training signal in the model, providing a phasic increase during feedback for correct responses and a phasic pause for incorrect responses. Dopamine is simulated to act through D1 receptors in Go units, increasing excitability. In addition, D1 receptors were simulated to enhance contrast by increasing the striatal unit’s activation gain and activation threshold. This has the effect of increasing the activity of highly active Go units and decreasing the activity of weakly active units, increasing the signal-to-noise ratio. D2 receptors were simulated in NoGo units such that an increase in dopamine decreases NoGo excitability. As a result, a phasic increase in dopamine during feedback has the effect of increasing Go activity relative to NoGo activity while a phasic decrease in dopamine will have the reverse effect. Altering the activity of Go and NoGo units in response to phasic changes in dopamine during feedback alters coritcostriatal weights through the contrastive Hebbian component of the learning rule. This facilitates error driven learning without providing the network a supervised learning signal.</p></sec><sec id="s4-2"><title>TAN behavior</title><p>TANs are endogenously active in the absence of synaptic activity (<xref ref-type="bibr" rid="bib12">Bennett and Wilson, 1999</xref>) and were modeled as a separate endogenously active layer in which the leak channel equilibrium potential <italic>E<sub>l</sub></italic> was typically higher than <italic>V<sub>m</sub></italic>. Unlike striatal Go and NoGo units, the activity of TANs were not dependent on synaptic signaling from other units in the network and TANs were simulated with little stochasticity. During stimulus presentation and action selection, TAN activity was held constant across all trials in all simulations (<xref ref-type="fig" rid="fig2">Figure 2</xref>, top left). Following action selection, a TAN burst–pause was simulated during outcome feedback. The burst was simulated at the onset of feedback to mirror the TAN burst by transiently increasing <italic>V<sub>m</sub></italic> above the equilibrium potential. The subsequent pause was generated with an accommodation current, which allows the initial burst of TAN activity to create a subsequent hyperpolarization. This simulates the after-hyperpolarization that has been found to follow a depolarization in TANs via calcium-dependent potassium current (<xref ref-type="bibr" rid="bib84">Wilson and Goldberg, 2006</xref>).</p><p>An accommodation current <italic>I<sub>a</sub></italic> drives the membrane potential toward a low value which is added to <italic>I<sub>net</sub>:</italic> <inline-formula><mml:math id="inf44"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. A high accommodation current has the effect of hyperpolarizing the neuron as a function of how active it has been, simulating gated ion channels that accumulated with activity and driving the membrane potential to a low value. Consequently, the initial high firing rate at the onset of reinforcement causes the activity-dependent accommodation current to hyperpolarize the TAN units, silencing them for a length of time during feedback. The accommodation current is updated at each time step as a function of its time constant, <inline-formula><mml:math id="inf45"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ14"><mml:math id="m14"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo/><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo/><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>Θ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf46"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the time constant of the channel conductance,<inline-formula><mml:math id="inf47"><mml:mrow><mml:mo/><mml:msub><mml:mi>Θ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf48"><mml:mrow><mml:msub><mml:mi>Θ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the activation and deactivation thresholds required to invoke accommodation, respectively. The basis variable <inline-formula><mml:math id="inf49"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a time average of the activation state:</p><p><disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf50"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the time basis variable time constant and <inline-formula><mml:math id="inf51"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the unit activity. During periods of persistently high activity, the basis variable <inline-formula><mml:math id="inf52"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will increase in proportion to its time constant <inline-formula><mml:math id="inf53"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. When the basis variable exceeds the activation threshold <inline-formula><mml:math id="inf54"><mml:mrow><mml:msub><mml:mi>Θ</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, the accommodation conductance will increase, resulting in a net decline in current and a lower TAN firing rate. This process simulates the Ca<sup>2+</sup> dependent potassium currents in TANs: the basis variable simulates the build up of Ca<sup>2+</sup> in the cell and the effects of the basis variable on accommodation conductance simulates the opening (or closure) of Ca<sup>2+</sup> dependent channels. During the subsequent pause, <inline-formula><mml:math id="inf55"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is negative as activity is low, causing the accommodation current to subside as the basis variable falls below the deactivation threshold <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>Θ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, resulting in an increase in <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at the end of feedback (post-pause rebound, <xref ref-type="fig" rid="fig2">Figure 2</xref>, bottom left).</p><p>The behavior of the TAN pause was manipulated by varying <inline-formula><mml:math id="inf58"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Networks with fixed TAN pauses were simulated by specifying a constant value of <inline-formula><mml:math id="inf59"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> such that the duration of the TAN pause lasted a pre-specified duration. The duration of the pause is reported in milliseconds (ms), which converted from cycles (the base unit of time within the network) at an assumed rate of 10 ms/cycle (Ratcliff and Frank, 2012). Pause durations were simulated ranging from 120 ms to 280 ms in 10 ms steps. For networks with a variable TAN pause, we simulated the impact of inhibitory collaterals from MSNs onto TANs such that the time constant <inline-formula><mml:math id="inf60"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was proportional to MSN activity (using either entropy or a more realistic approximation thereof, see below). This embodies our assumption that MSNs do not directly induce the TAN pause (which is driven by external inputs, e.g. from thalamus) but modulate its duration via accommodation (potentially via calcium-dependent potassium currents; <xref ref-type="bibr" rid="bib84">Wilson and Goldberg, 2006</xref>) leading to an MSN activity-dependent reduction in TAN activity via direct signaling.</p><p>For the initial simulations of an adaptive mechanism to control pause duration, <inline-formula><mml:math id="inf61"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was updated as a function of the Shannon’s entropy across the population of Go units on a trial to trial basis. On each time step during stimulus presentation, the rate-coded activity of each Go unit was normalized such that the normalized activity of all Go units summed to one. The normalized activity was then treated as a decision variable for the purposes of calculating entropy: the sum of activity over all units that contributed to a single response was treated as the probability of the selection of that response:</p><p><disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo/><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf62"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the activity of unit <italic>i</italic> corresponding to action <italic>a</italic> at time <italic>t</italic>. This assumption conforms with other interpretations of population activity within typical network models, where a probability distribution can be created by normalizing activation levels within a finite set of units (<xref ref-type="bibr" rid="bib42">Hinton and Sejnowski, 1983</xref>; <xref ref-type="bibr" rid="bib69">Rao, 2005</xref>; <xref ref-type="bibr" rid="bib24">D'Angiulli et al., 2013</xref>). While the model presented here is more biologically complex, the same principle applies when treating the firing rates of discrete units as a probability distribution over actions. Shannon’s entropy was calculated with <inline-formula><mml:math id="inf63"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and summing across all cycles within the action selection phase:</p><p><disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>t</mml:mi></mml:munder><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>a</mml:mi></mml:munder><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>High entropy indicates that there is more competition between actions in the Go units and low entropy indicates low competition. We leverage this same quantity for controlling TAN pauses via adaptive feedback (as described above) and also as a statistic to approximate the uncertainty of the network over its action selection policy, and how this evolves across learning.</p><p>A second more biophysical feedback mechanism was simulated, where instead of using an analytical expression for MSN entropy, TANs directly approximate MSN population entropy through synaptic integration. In these simulations, co-activation of pairs of MSNs co-localized on TAN dendrites were assumed to drive changes in TAN pause behavior. Thus the TAN time-constant <inline-formula><mml:math id="inf64"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was adjusted as a function of supra-threshold activity in pairs of Go units, in which each member of the pair corresponded to a different action (<xref ref-type="fig" rid="fig9">Figure 9</xref>). The 9 Go units corresponding to each of the 2 available actions were organized into 9 pairs of units. The activity in each unit was threshold and if the activity in both units were above threshold, the pair was counted as having an 'AND conjunction' (as the detection of supra-threshold activity is equivalent to the Boolean function AND):</p><p><disp-formula id="equ18"><mml:math id="m18"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>if</mml:mi><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>&gt;</mml:mo><mml:mo> </mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo><mml:mo> </mml:mo><mml:mi>AND</mml:mi><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>&gt;</mml:mo><mml:mo> </mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf65"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the Boolean value (0 or 1) of the 'AND conjunction' for the pair of units <italic>j</italic>, <inline-formula><mml:math id="inf66"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf67"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>l</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are the activities for the units associated with actions <italic>k</italic> and <italic>l,</italic> respectively, <inline-formula><mml:math id="inf68"><mml:mi>θ</mml:mi></mml:math></inline-formula> is the threshold value. The value of <inline-formula><mml:math id="inf69"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> across over all the actions and across all cycles in the action selection phase of a trial:</p><p><disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>t</mml:mi></mml:munder><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The time constant <inline-formula><mml:math id="inf70"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was set as a function of <inline-formula><mml:math id="inf71"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> which accumulated during response selection and hence affected the duration of subsequent accommodation hyperpolarization during the pause induced by the initial burst in the subsequent reinforcement phase.</p></sec><sec id="s4-3"><title>Synaptic effects of TAN activity</title><p>TANs were simulated to modulate Go and NoGo activity largely through the activity of M2 and M1 muscarinic receptors. The effects of M1 and M2 receptors are relatively well understood (<xref ref-type="bibr" rid="bib38">Goldberg and Reynolds, 2011</xref>) and thus suitable for modeling. M1 and M2 receptors have opposing effects on MSN excitability: M1 activity increases dendritic excitability of indirect pathway MSNs through the post-synaptic closure of Kir2 K+ channels (<xref ref-type="bibr" rid="bib77">Shen et al., 2007</xref>), while M2 receptors inhibit glutamate release in presynaptic terminals of both direct and indirect pathway MSNs (<xref ref-type="bibr" rid="bib16">Calabresi et al., 1998</xref>; <xref ref-type="bibr" rid="bib27">Ding et al., 2010</xref>). Cholinergic signaling can also modulate MSN excitability through increased GABAergic inhibition (<xref ref-type="bibr" rid="bib86">Witten et al., 2010</xref>). Crucially, these effects act at different time scales: M1 activity is longer lasting and slower to initiate than the pre-synaptic effects of M2 receptors (<xref ref-type="bibr" rid="bib76">Shen et al., 2005</xref>; <xref ref-type="bibr" rid="bib27">Ding et al., 2010</xref>). Thus, the different temporal dynamics receptor activity may interact with the time-course of the TAN response: whereas the TAN burst activates M1 receptors and increases excitability in indirect pathway MSNs, the subsequent TAN pause reduces M2-mediated presynaptic inhibition and postsynaptic GABAergic inhibition (<xref ref-type="bibr" rid="bib36">Gerfen and Surmeier, 2011</xref>).</p><p>M2-like muscarinic receptors are located on pre- and postsynaptic glutamatergic afferents of MSNs have the effect of inhibiting corticostriatal glutamate transmission (<xref ref-type="bibr" rid="bib38">Goldberg and Reynolds, 2011</xref>). The effects of M2-like receptors were modeled with inhibitory synaptic connections from TANs to the Go and NoGo units. Excitatory synaptic connections to inhibitory interneurons were also used to simulate the nicotinic stimulation on GABAergic interneurons (<xref ref-type="bibr" rid="bib86">Witten et al., 2010</xref>). These interneurons project to both Go and NoGo units and have an inhibitory effect. The effects of simulated M2 receptors and excitatory connections to the interneurons results in increased inhibition of both layers during action selection when TAN activity is constant (Figure 2, left) and disinhibition during the feedback pause (Figure 2, center).</p><p>M1 muscarinic receptors were simulated with a transitory increase in the leak channel Equilibrium potential <italic>E<sub>l</sub></italic> for NoGo units during feedback. This was done to simulate the effects of M1 activity on inward rectifying potassium currents (<xref ref-type="bibr" rid="bib38">Goldberg and Reynolds, 2011</xref>). Although M1-mRNA is found in both striatopallidal and striatonigral MSNs, the effect was simulated in the NoGo Layer only as increased sensitivity to glutamatergic signaling is selective to striatopallidal MSNs (<xref ref-type="bibr" rid="bib77">Shen et al., 2007</xref>). In order to simulate M1 antogonists, the transitory increase in leak channel equilibrium potential in NoGo units during the simulated TAN pause was removed. No effects of M1 receptors were simulated during the action selection phase.</p><p>Where noted, a rebound post–pause phasic increase in TAN activity was also modeled. A phasic increase in TAN activity is commonly reported following the feedback related TAN pause (<xref ref-type="bibr" rid="bib4">Aosaki et al., 2010)</xref>. Mediated by nicotinic acetylcholine receptors located on dopamine terminals in the striatum, the release of acetylcholine associated with a phasic increase in TAN activity evokes dopamine release (<xref ref-type="bibr" rid="bib15">Cachope et al., 2012</xref>; <xref ref-type="bibr" rid="bib81">Threlfell et al., 2012</xref>). The release of DA during the post–pause phasic TAN burst may modulate cortico-straital plasticity in relation to activity during the feedback related pause DA release promotes spine growth specifically when stimulated after spiny neuron activity (<xref ref-type="bibr" rid="bib88">Yagishita et al., 2014</xref>). The effects of the post-pause TAN burst were modeled by simulating the modulation of dopamine release by nicotinic receptors through the modulation of the dopamine membrane potential during the plus phase. The observed dynamic range of effects were normed as change TAN firing rate above baseline from 0 to 1.</p></sec><sec id="s4-4"><title>Bayesian model</title><p>An approximately Bayesian reinforcement learning model was used as a computational level description of the behavior of the neural network model. For i.i.d. Bernoulli trials in a stationary task (a reasonable approximation of the task), the exact posterior distribution of expected values is a beta distribution parameterized with α and β (<xref ref-type="bibr" rid="bib25">Daw et al., 2005</xref>)</p><p><disp-formula id="equ20"><mml:math id="m20"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo/><mml:mo>~</mml:mo><mml:mo/><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mo/><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The parameters α and β can be updated online after each trial with the following rules:</p><p><disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo/><mml:mo>=</mml:mo><mml:mo/><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo/><mml:mo>+</mml:mo><mml:mo/><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ22"><mml:math id="m22"><mml:msub><mml:mi>β</mml:mi><mml:mfenced><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mfenced><mml:mi>t</mml:mi></mml:mfenced></mml:msub></mml:math></disp-formula></p><p>where the reward on the current trial, r<sub>(t)</sub>, is either 0 or 1. Because the task is non-stationary, a multiplicative parameter γ ranging from 0 to 1 was used to decay the parameters α and β during the update:</p><p><disp-formula id="equ23"><mml:math id="m23"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo/><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo/><mml:mo>+</mml:mo><mml:mo/><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p><disp-formula id="equ24"><mml:math id="m24"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo/><mml:mo>=</mml:mo><mml:mi>γ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p><p>This multiplicative decay parameter increases the flexibility of the learner and has been used previously to model human learning (<xref ref-type="bibr" rid="bib25">Daw et al., 2005</xref>; <xref ref-type="bibr" rid="bib30">Doll et al., 2009</xref>, <xref ref-type="bibr" rid="bib29">2011</xref>). In simulations, γ was either held constant throughout training (analogous to fixed pause duration) or varied as a function of trial-to-trial changes in uncertainty with two free parameters, <inline-formula><mml:math id="inf72"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf73"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>:</p><p><disp-formula id="equ25"><mml:math id="m25"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo/><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mi>Δ</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:math></disp-formula></p><p>The free parameters <inline-formula><mml:math id="inf74"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf75"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> determine the baseline decay rate and sensitivity to trial-to-trial variations in uncertainty. Importantly, <inline-formula><mml:math id="inf76"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was negative as performance is best when the model decays more quickly (and hence learns more from individual outcomes) during conditions of high uncertainty/volatility, analogous to shorter TAN pauses with more MSN uncertainty. Uncertainty was defined as the Shannon’s entropy of the action selection probability, determined by integrating the expected values of both actions over the belief distributions:</p><p><disp-formula id="equ26"><mml:math id="m26"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p><p>The difference in entropy between trials was smoothed using a delta rule algorithm with the learning rate <inline-formula><mml:math id="inf77"><mml:mi>η</mml:mi></mml:math></inline-formula> as a parameter. <inline-formula><mml:math id="inf78"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> was initialized at the 1 bit (the maximum possible entropy) and updated after each trial with the following rule:</p><p><disp-formula id="equ27"><mml:math id="m27"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>H</mml:mi><mml:mo>←</mml:mo><mml:mi>Δ</mml:mi><mml:mi>H</mml:mi><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:mi>δ</mml:mi></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ28"><mml:math id="m28"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mo>∆</mml:mo><mml:mi>H</mml:mi><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>Smoothing the difference in entropy between trials reduces the influence of trial-to-trial variance and allows for entropy for previous recent trials to influence the decay rate.</p><p>Action selection was accomplished through sampling Q-values. This allows for the consideration of uncertainty during the action selection. For each trial, a Q-value from the belief distribution of each available action was randomly sampled. The action with the highest Q-value was selected for the given trial.</p></sec><sec id="s4-5"><title>OpAL</title><p>An algorithmic model of the basal ganglia adapted from the OpAL model (<xref ref-type="bibr" rid="bib22">Collins and Frank, 2014</xref>) was used to provide a mechanistic description of the feedback-control mechanism proposed in the neural network. OpAl is an actor–critic reinforcement learning model that mimics the opponent (D1/D2) actor system in the neural network. In OpAL, a single critic learns the value of a stimulus with its own learning rate (<inline-formula><mml:math id="inf79"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). A prediction error (<inline-formula><mml:math id="inf80"><mml:mi>δ</mml:mi></mml:math></inline-formula>), the difference between the observed reward <inline-formula><mml:math id="inf81"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>) on a trial and the learned value of the critic on trial <inline-formula><mml:math id="inf82"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, is used to update the estimate on each trial.</p><p><disp-formula id="equ29"><mml:math id="m29"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ30"><mml:math id="m30"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>δ</mml:mi></mml:math></disp-formula></p><p>The prediction error on each trial is also used to update to actor values, a 'Go' (<inline-formula><mml:math id="inf83"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) and 'NoGo' (<inline-formula><mml:math id="inf84"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) value, for the chosen action conditional on the current stimulus with two separate learning rates:</p><p><disp-formula id="equ31"><mml:math id="m31"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo/><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mi>δ</mml:mi></mml:mrow></mml:math></disp-formula></p><p><disp-formula id="equ32"><mml:math id="m32"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mi>δ</mml:mi></mml:math></disp-formula></p><p>where <inline-formula><mml:math id="inf85"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf86"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the learning rates for the <italic>G</italic> and <italic>N</italic> weights, respectively. These two actor values correspond to the Go and NoGo units in the neural network and model learned contributions of striatonigral and striatopallidal MSNs to action selection. Choices between actions were made using a softmax policy choice on the linear combination of actor weights:</p><p><disp-formula id="equ33"><mml:math id="m33"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>{</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf87"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf88"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> control the degree to which each of the weights influence action and <inline-formula><mml:math id="inf89"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the probability action <inline-formula><mml:math id="inf90"><mml:mi>a</mml:mi></mml:math></inline-formula> is selected. <xref ref-type="bibr" rid="bib22">Collins and Frank (2014)</xref> simulate a variety of documented effects with this model, including how dopamine affects the asymmetry in learning and choice incentive (sensitivity to gains vs costs of alternative actions), show how its behavior converges to expected values and provide a normative interpretation.</p><p>Here, we expand OpAL to include the effect of TANs on modulating learning rate, using a multiplicative decay term, <inline-formula><mml:math id="inf91"><mml:mi>γ</mml:mi></mml:math></inline-formula>. On each trial, following the update of the actor weights, the weights were decayed to a naïve prior with the inverse logit transform of <inline-formula><mml:math id="inf92"><mml:mi>γ</mml:mi></mml:math></inline-formula> as follows:</p><p><disp-formula id="equ34"><mml:math id="m34"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p><disp-formula id="equ35"><mml:math id="m35"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mfenced><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></disp-formula></p><p>The inverse logit transform of <inline-formula><mml:math id="inf93"><mml:mi>γ</mml:mi></mml:math></inline-formula> range bounds the decay rate between zero and one. Gamma was either held fixed, simulating fixed duration TAN pauses, or was allowed to vary with as a linear function of entropy in the model. Entropy in the model was the Shannon’s entropy of the policy function:</p><p><disp-formula id="equ36"><mml:math id="m36"><mml:mrow><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mi>a</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p></sec><sec id="s4-6"><title>Simulated task</title><p>Both the neural network and Bayesian models were trained on a series of two alternative forced choice tasks. In each trial, the models were presented with one of two stimuli and made one of two responses. Equal valued rewards were delivered pseudo-randomly on a fixed stochastic schedule over epochs of 20 trials. The reward schedule for the two options were not yoked, such that sampling one action did not provide full information of the other’s reward schedule. After 10 epochs of 20 trials (or 200 trials), the reward contingencies for each action were exchanged and the models were trained on an additional 10 epochs.</p><p>For both the neural network and the Bayesian models, each parameterization was trained on 50 instantiations. Initial weights of the neural network were randomized for each simulation. Simulations were run over eight reward schedules. The payout schedules for the best action were 85, 80, 75, 70, 65, 60, 55 and 40%. The payout schedules for the lowest rewarded action action were 15, 20, 25, 30, 35, 40, 45 and 10%. Comparisons between the neural network with and without TANs, as well as the manipulation of pause duration, were shown in networks trained on an 80/20% reward schedule.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Anne Collins and Matthew Nassar for helpful comments on an earlier version of this manuscript.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="conflict" id="conf2"><p>MJF: Reviewing editor, <italic>eLife.</italic></p></fn><fn fn-type="conflict" id="conf1"><p>The other author declares that no competing interests exist.</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>NTF, Conception and design, Acquisition of data, Analysis and interpretation of data, Drafting or revising the article</p></fn><fn fn-type="con" id="con2"><p>MJF, Conception and design, Analysis and interpretation of data, Drafting or revising the article</p></fn></fn-group></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aisa</surname><given-names>B</given-names></name><name><surname>Mingus</surname><given-names>B</given-names></name><name><surname>O’Reilly</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>The emergent neural modeling system</article-title><source>Neural Networks</source><volume>21</volume><fpage>1146</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2008.06.016</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aosaki</surname><given-names>T</given-names></name><name><surname>Graybiel</surname><given-names>A</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>Effect of the nigrostriatal dopamine system on acquired neural responses in the striatum of behaving monkeys</article-title><source>Science</source><volume>265</volume><fpage>412</fpage><lpage>415</lpage><pub-id pub-id-type="doi">10.1126/science.8023166</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aosaki</surname><given-names>T</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Temporal and spatial characteristics of tonically active neurons of the primate's striatum</article-title><source>Journal of Neurophysiology</source><volume>73</volume><fpage>1234</fpage><lpage>1252</lpage></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aosaki</surname><given-names>T</given-names></name><name><surname>Miura</surname><given-names>M</given-names></name><name><surname>Suzuki</surname><given-names>T</given-names></name><name><surname>Nishimura</surname><given-names>K</given-names></name><name><surname>Masuda</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Acetylcholine-dopamine balance hypothesis in the striatum: an update</article-title><source>Geriatrics &amp; Gerontology International</source><volume>10</volume><fpage>S148</fpage><lpage>S157</lpage><pub-id pub-id-type="doi">10.1111/j.1447-0594.2010.00588.x</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Apicella</surname><given-names>P</given-names></name><name><surname>Deffains</surname><given-names>M</given-names></name><name><surname>Ravel</surname><given-names>S</given-names></name><name><surname>Legallet</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Tonically active neurons in the striatum differentiate between delivery and omission of expected reward in a probabilistic task context</article-title><source>European Journal of Neuroscience</source><volume>30</volume><fpage>515</fpage><lpage>526</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.2009.06872.x</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Apicella</surname><given-names>P</given-names></name><name><surname>Ravel</surname><given-names>S</given-names></name><name><surname>Deffains</surname><given-names>M</given-names></name><name><surname>Legallet</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The role of striatal tonically active neurons in reward prediction error signaling during instrumental task performance</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>1507</fpage><lpage>1515</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4880-10.2011</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashby</surname><given-names>FG</given-names></name><name><surname>Crossley</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A computational model of how cholinergic interneurons protect striatal-dependent learning</article-title><source>Journal of Cognitive Neuroscience</source><volume>23</volume><fpage>1549</fpage><lpage>1566</lpage><pub-id pub-id-type="doi">10.1162/jocn.2010.21523</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bach</surname><given-names>DR</given-names></name><name><surname>Hulme</surname><given-names>O</given-names></name><name><surname>Penny</surname><given-names>WD</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The known unknowns: neural representation of second-order uncertainty, and ambiguity</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>4811</fpage><lpage>4820</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1452-10.2011</pub-id></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barnes</surname><given-names>TD</given-names></name><name><surname>Kubota</surname><given-names>Y</given-names></name><name><surname>Hu</surname><given-names>D</given-names></name><name><surname>Jin</surname><given-names>DZ</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Activity of striatal neurons reflects dynamic encoding and recoding of procedural memories</article-title><source>Nature</source><volume>437</volume><fpage>1158</fpage><lpage>1161</lpage><pub-id pub-id-type="doi">10.1038/nature04053</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bayer</surname><given-names>HM</given-names></name><name><surname>Lau</surname><given-names>B</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Statistics of midbrain dopamine neuron spike trains in the awake primate</article-title><source>Journal of Neurophysiology</source><volume>98</volume><fpage>1428</fpage><lpage>1439</lpage><pub-id pub-id-type="doi">10.1152/jn.01140.2006</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behrens</surname><given-names>TEJ</given-names></name><name><surname>Woolrich</surname><given-names>MW</given-names></name><name><surname>Walton</surname><given-names>ME</given-names></name><name><surname>Rushworth</surname><given-names>MFS</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Learning the value of information in an uncertain world</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1214</fpage><lpage>1221</lpage><pub-id pub-id-type="doi">10.1038/nn1954</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bennett</surname><given-names>BD</given-names></name><name><surname>Wilson</surname><given-names>CJ</given-names></name></person-group><year iso-8601-date="1999">1999</year><article-title>Spontaneous activity of neostriatal cholinergic interneurons in vitro</article-title><source>The Journal of Neuroscience</source><volume>19</volume><fpage>5586</fpage><lpage>5596</lpage></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolam</surname><given-names>JP</given-names></name><name><surname>Ingham</surname><given-names>CA</given-names></name><name><surname>Izzo</surname><given-names>PN</given-names></name><name><surname>Levey</surname><given-names>AI</given-names></name><name><surname>Rye</surname><given-names>DB</given-names></name><name><surname>Smith</surname><given-names>AD</given-names></name><name><surname>Wainer</surname><given-names>BH</given-names></name></person-group><year iso-8601-date="1986">1986</year><article-title>Substance p-containing terminals in synaptic contact with cholinergic neurons in the neostriatum and basal forebrain: a double immunocytochemical study in the rat</article-title><source>Brain Research</source><volume>397</volume><fpage>279</fpage><lpage>289</lpage><pub-id pub-id-type="doi">10.1016/0006-8993(86)90629-3</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradfield</surname><given-names>LA</given-names></name><name><surname>Bertran-Gonzalez</surname><given-names>J</given-names></name><name><surname>Chieng</surname><given-names>B</given-names></name><name><surname>Balleine</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>The thalamostriatal pathway and cholinergic control of goal-directed action: interlacing new with existing learning in the striatum</article-title><source>Neuron</source><volume>79</volume><fpage>153</fpage><lpage>166</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.04.039</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cachope</surname><given-names>R</given-names></name><name><surname>Mateo</surname><given-names>Y</given-names></name><name><surname>Mathur</surname><given-names>BN</given-names></name><name><surname>Irving</surname><given-names>J</given-names></name><name><surname>Wang</surname><given-names>H-L</given-names></name><name><surname>Morales</surname><given-names>M</given-names></name><name><surname>Lovinger</surname><given-names>DM</given-names></name><name><surname>Cheer</surname><given-names>JF</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Selective activation of cholinergic interneurons enhances accumbal phasic dopamine release: setting the tone for reward processing</article-title><source>Cell Reports</source><volume>2</volume><fpage>33</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1016/j.celrep.2012.05.011</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calabresi</surname><given-names>P</given-names></name><name><surname>Centonze</surname><given-names>D</given-names></name><name><surname>Gubellini</surname><given-names>P</given-names></name><name><surname>Pisani</surname><given-names>A</given-names></name><name><surname>Bernardi</surname><given-names>G</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Blockade of M2-like muscarinic receptors enhances long-term potentiation at corticostriatal synapses</article-title><source>European Journal of Neuroscience</source><volume>10</volume><fpage>3020</fpage><lpage>3023</lpage><pub-id pub-id-type="doi">10.1111/j.1460-9568.1998.00348.x</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Calabresi</surname><given-names>P</given-names></name><name><surname>Picconi</surname><given-names>B</given-names></name><name><surname>Tozzi</surname><given-names>A</given-names></name><name><surname>Di Filippo</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Dopamine-mediated regulation of corticostriatal synaptic plasticity</article-title><source>Trends in Neurosciences</source><volume>30</volume><fpage>211</fpage><lpage>219</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2007.03.001</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chuhma</surname><given-names>N</given-names></name><name><surname>Tanaka</surname><given-names>KF</given-names></name><name><surname>Hen</surname><given-names>R</given-names></name><name><surname>Rayport</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Functional connectome of the striatal medium spiny neuron</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>1183</fpage><lpage>1192</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3833-10.2011</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clarke</surname><given-names>HF</given-names></name><name><surname>Robbins</surname><given-names>TW</given-names></name><name><surname>Roberts</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Lesions of the medial striatum in monkeys produce perseverative impairments during reversal learning similar to those produced by lesions of the orbitofrontal cortex</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>10972</fpage><lpage>10982</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1521-08.2008</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>A</given-names></name><name><surname>Koechlin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reasoning, learning, and creativity: frontal lobe function and human decision-making</article-title><source>PLoS Biology</source><volume>10</volume><elocation-id>e1001293</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.1001293</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>AGE</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Cognitive control over learning: creating, clustering, and generalizing task-set structure</article-title><source>Psychological Review</source><volume>120</volume><fpage>190</fpage><lpage>229</lpage><pub-id pub-id-type="doi">10.1037/a0030852</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>AGE</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Opponent actor learning (opAL): modeling interactive effects of striatal dopamine on reinforcement learning and choice incentive</article-title><source>Psychological Review</source><volume>121</volume><fpage>337</fpage><lpage>366</lpage><pub-id pub-id-type="doi">10.1037/a0037015</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cragg</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Meaningful silences: how dopamine listens to the ACh pause</article-title><source>Trends in Neurosciences</source><volume>29</volume><fpage>125</fpage><lpage>131</lpage><pub-id pub-id-type="doi">10.1016/j.tins.2006.01.003</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>D'Angiulli</surname><given-names>A</given-names></name><name><surname>Runge</surname><given-names>M</given-names></name><name><surname>Faulkner</surname><given-names>A</given-names></name><name><surname>Zakizadeh</surname><given-names>J</given-names></name><name><surname>Chan</surname><given-names>A</given-names></name><name><surname>Morcos</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Vividness of visual imagery and incidental recall of verbal cues, when phenomenological availability reflects long-term memory accessibility</article-title><source>Frontiers in Psychology</source><volume>4</volume><fpage>1</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.3389/fpsyg.2013.00001</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daw</surname><given-names>ND</given-names></name><name><surname>Niv</surname><given-names>Y</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Uncertainty-based competition between prefrontal and dorsolateral striatal systems for behavioral control</article-title><source>Nature Neuroscience</source><volume>8</volume><fpage>1704</fpage><lpage>1711</lpage><pub-id pub-id-type="doi">10.1038/nn1560</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deng</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Xu</surname><given-names>ZC</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Involvement of ih in dopamine modulation of tonic firing in striatal cholinergic interneurons</article-title><source>Journal of Neuroscience</source><volume>27</volume><fpage>3148</fpage><lpage>3156</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.5535-06.2007</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>JB</given-names></name><name><surname>Guzman</surname><given-names>JN</given-names></name><name><surname>Peterson</surname><given-names>JD</given-names></name><name><surname>Goldberg</surname><given-names>JA</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Thalamic gating of corticostriatal signaling by cholinergic interneurons</article-title><source>Neuron</source><volume>67</volume><fpage>294</fpage><lpage>307</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2010.06.017</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doig</surname><given-names>NM</given-names></name><name><surname>Magill</surname><given-names>PJ</given-names></name><name><surname>Apicella</surname><given-names>P</given-names></name><name><surname>Bolam</surname><given-names>JP</given-names></name><name><surname>Sharott</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Cortical and thalamic excitation mediate the multiphasic responses of striatal cholinergic interneurons to motivationally salient stimuli</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>3101</fpage><lpage>3117</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4627-13.2014</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doll</surname><given-names>BB</given-names></name><name><surname>Hutchison</surname><given-names>KE</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dopaminergic genes predict individual differences in susceptibility to confirmation bias</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>6188</fpage><lpage>6198</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.6486-10.2011</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doll</surname><given-names>BB</given-names></name><name><surname>Jacobs</surname><given-names>WJ</given-names></name><name><surname>Sanfey</surname><given-names>AG</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Instructional control of reinforcement learning: a behavioral and neurocomputational investigation</article-title><source>Brain Research</source><volume>1299</volume><fpage>74</fpage><lpage>94</lpage><pub-id pub-id-type="doi">10.1016/j.brainres.2009.07.007</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoso</surname><given-names>M</given-names></name><name><surname>Collins</surname><given-names>AGE</given-names></name><name><surname>Koechlin</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Foundations of human reasoning in the prefrontal cortex</article-title><source>Science</source><volume>344</volume><fpage>1481</fpage><lpage>1486</lpage><pub-id pub-id-type="doi">10.1126/science.1252254</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Doll</surname><given-names>BB</given-names></name><name><surname>Oas-Terpstra</surname><given-names>J</given-names></name><name><surname>Moreno</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Prefrontal and striatal dopaminergic genes predict individual differences in exploration and exploitation</article-title><source>Nature Neuroscience</source><volume>12</volume><fpage>1062</fpage><lpage>1068</lpage><pub-id pub-id-type="doi">10.1038/nn.2342</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name><name><surname>Seeberger</surname><given-names>LC</given-names></name><name><surname>O'Reilly</surname><given-names>RC</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>By carrot or by stick: cognitive reinforcement learning in parkinsonism</article-title><source>Science</source><volume>306</volume><fpage>1940</fpage><lpage>1943</lpage><pub-id pub-id-type="doi">10.1126/science.1102941</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Dynamic dopamine modulation in the basal ganglia: a neurocomputational account of cognitive deficits in medicated and nonmedicated parkinsonism</article-title><source>Journal of Cognitive Neuroscience</source><volume>17</volume><fpage>51</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1162/0898929052880093</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Hold your horses: a dynamic computational role for the subthalamic nucleus in decision making</article-title><source>Neural Networks</source><volume>19</volume><fpage>1120</fpage><lpage>1136</lpage><pub-id pub-id-type="doi">10.1016/j.neunet.2006.03.006</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gerfen</surname><given-names>CR</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Modulation of striatal projection systems by dopamine</article-title><source>Annual Review of Neuroscience</source><volume>34</volume><fpage>441</fpage><lpage>466</lpage><pub-id pub-id-type="doi">10.1146/annurev-neuro-061010-113641</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gershman</surname><given-names>SJ</given-names></name><name><surname>Blei</surname><given-names>DM</given-names></name><name><surname>Niv</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Context, learning, and extinction</article-title><source>Psychological Review</source><volume>117</volume><fpage>197</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1037/a0017808</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldberg</surname><given-names>JA</given-names></name><name><surname>Reynolds</surname><given-names>JNJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Spontaneous firing and evoked pauses in the tonically active cholinergic interneurons of the striatum</article-title><source>Neuroscience</source><volume>198</volume><fpage>27</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.1016/j.neuroscience.2011.08.067</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzales</surname><given-names>KK</given-names></name><name><surname>Pare</surname><given-names>J-F</given-names></name><name><surname>Wichmann</surname><given-names>T</given-names></name><name><surname>Smith</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>GABAergic inputs from direct and indirect striatal projection neurons onto cholinergic interneurons in the primate putamen</article-title><source>Journal of Comparative Neurology</source><volume>521</volume><fpage>2502</fpage><lpage>2522</lpage><pub-id pub-id-type="doi">10.1002/cne.23295</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonzales</surname><given-names>KK</given-names></name><name><surname>Smith</surname><given-names>Y</given-names></name><name><surname>Uhl</surname><given-names>GR</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Cholinergic interneurons in the dorsal and ventral striatum: anatomical and functional considerations in normal and diseased conditions</article-title><source>Annals of the New York Academy of Sciences</source><volume>1349</volume><fpage>1</fpage><lpage>45</lpage><pub-id pub-id-type="doi">10.1111/nyas.12762</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graybiel</surname><given-names>A</given-names></name><name><surname>Aosaki</surname><given-names>T</given-names></name><name><surname>Flaherty</surname><given-names>A</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="1994">1994</year><article-title>The basal ganglia and adaptive motor control</article-title><source>Science</source><volume>265</volume><fpage>1826</fpage><lpage>1831</lpage><pub-id pub-id-type="doi">10.1126/science.8091209</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hinton</surname><given-names>GE</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Optimal perceptual inference</article-title><source>Proceedings of The IEEE Conference on Computer Vision and Pattern Recognition</source><fpage>448</fpage><lpage>453</lpage></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Howe</surname><given-names>MW</given-names></name><name><surname>Tierney</surname><given-names>PL</given-names></name><name><surname>Sandberg</surname><given-names>SG</given-names></name><name><surname>Phillips</surname><given-names>PEM</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Prolonged dopamine signalling in striatum signals proximity and value of distant rewards</article-title><source>Nature</source><volume>500</volume><fpage>575</fpage><lpage>579</lpage><pub-id pub-id-type="doi">10.1038/nature12475</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Humphries</surname><given-names>MD</given-names></name><name><surname>Stewart</surname><given-names>RD</given-names></name><name><surname>Gurney</surname><given-names>KN</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>A physiologically plausible model of action selection and oscillatory activity in the basal ganglia</article-title><source>Journal of Neuroscience</source><volume>26</volume><fpage>12921</fpage><lpage>12942</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3486-06.2006</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iglesias</surname><given-names>S</given-names></name><name><surname>Mathys</surname><given-names>C</given-names></name><name><surname>Brodersen</surname><given-names>KH</given-names></name><name><surname>Kasper</surname><given-names>L</given-names></name><name><surname>Piccirelli</surname><given-names>M</given-names></name><name><surname>den Ouden</surname><given-names>HEM</given-names></name><name><surname>Stephan</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Hierarchical prediction errors in midbrain and basal forebrain during sensory learning</article-title><source>Neuron</source><volume>80</volume><fpage>519</fpage><lpage>530</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2013.09.009</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jocham</surname><given-names>G</given-names></name><name><surname>Klein</surname><given-names>TA</given-names></name><name><surname>Ullsperger</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Dopamine-mediated reinforcement learning signals in the striatum and ventromedial prefrontal cortex underlie value-based choices</article-title><source>Journal of Neuroscience</source><volume>31</volume><fpage>1606</fpage><lpage>1613</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3904-10.2011</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Joshua</surname><given-names>M</given-names></name><name><surname>Adler</surname><given-names>A</given-names></name><name><surname>Mitelman</surname><given-names>R</given-names></name><name><surname>Vaadia</surname><given-names>E</given-names></name><name><surname>Bergman</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Midbrain dopaminergic neurons and striatal cholinergic interneurons encode the difference between reward and aversive events at different epochs of probabilistic classical conditioning trials</article-title><source>Journal of Neuroscience</source><volume>28</volume><fpage>11673</fpage><lpage>11684</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.3839-08.2008</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kapfer</surname><given-names>C</given-names></name><name><surname>Seidl</surname><given-names>AH</given-names></name><name><surname>Schweizer</surname><given-names>H</given-names></name><name><surname>Grothe</surname><given-names>B</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Experience-dependent refinement of inhibitory inputs to auditory coincidence-detector neurons</article-title><source>Nature Neuroscience</source><volume>5</volume><fpage>247</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1038/nn810</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kravitz</surname><given-names>AV</given-names></name><name><surname>Tye</surname><given-names>LD</given-names></name><name><surname>Kreitzer</surname><given-names>AC</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Distinct roles for direct and indirect pathway striatal neurons in reinforcement</article-title><source>Nature Neuroscience</source><volume>15</volume><fpage>816</fpage><lpage>818</lpage><pub-id pub-id-type="doi">10.1038/nn.3100</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lau</surname><given-names>B</given-names></name><name><surname>Glimcher</surname><given-names>PW</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Value representations in the primate striatum during matching behavior</article-title><source>Neuron</source><volume>58</volume><fpage>451</fpage><lpage>463</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2008.02.021</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laurent</surname><given-names>V</given-names></name><name><surname>Bertran-Gonzalez</surname><given-names>J</given-names></name><name><surname>Chieng</surname><given-names>BC</given-names></name><name><surname>Balleine</surname><given-names>BW</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title> -opioid and dopaminergic processes in accumbens shell modulate the cholinergic control of predictive learning and choice</article-title><source>Journal of Neuroscience</source><volume>34</volume><fpage>1358</fpage><lpage>1369</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.4592-13.2014</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>WJ</given-names></name><name><surname>Beck</surname><given-names>JM</given-names></name><name><surname>Latham</surname><given-names>PE</given-names></name><name><surname>Pouget</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Bayesian inference with probabilistic population codes</article-title><source>Nature Neuroscience</source><volume>9</volume><fpage>1432</fpage><lpage>1438</lpage><pub-id pub-id-type="doi">10.1038/nn1790</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maia</surname><given-names>TV</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>From reinforcement learning models to psychiatric and neurological disorders</article-title><source>Nature Neuroscience</source><volume>14</volume><fpage>154</fpage><lpage>162</lpage><pub-id pub-id-type="doi">10.1038/nn.2723</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Marr</surname><given-names>DC</given-names></name><name><surname>Poggio</surname><given-names>T</given-names></name></person-group><year iso-8601-date="1976">1976</year><source>From Understanding Computation to Understanding Neural Circuitry</source><publisher-name>Massachusetts Institute of Technology Cambridge Artificial Intelligence Lab</publisher-name></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mathys</surname><given-names>C</given-names></name><name><surname>Daunizeau</surname><given-names>J</given-names></name><name><surname>Friston</surname><given-names>KJ</given-names></name><name><surname>Stephan</surname><given-names>KE</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>A bayesian foundation for individual learning under uncertainty</article-title><source>Frontiers in Human Neuroscience</source><volume>5</volume><fpage>39</fpage><pub-id pub-id-type="doi">10.3389/fnhum.2011.00039</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsumoto</surname><given-names>N</given-names></name><name><surname>Minamimoto</surname><given-names>T</given-names></name><name><surname>Graybiel</surname><given-names>AM</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Neurons in the thalamic CM-pf complex supply striatal neurons with information about behaviorally significant sensory events</article-title><source>Journal of Neurophysiology</source><volume>85</volume><fpage>960</fpage><lpage>976</lpage></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McClure</surname><given-names>SM</given-names></name><name><surname>Berns</surname><given-names>GS</given-names></name><name><surname>Montague</surname><given-names>PR</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Temporal prediction errors in a passive learning task activate human striatum</article-title><source>Neuron</source><volume>38</volume><fpage>339</fpage><lpage>346</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00154-5</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCool</surname><given-names>MF</given-names></name><name><surname>Patel</surname><given-names>S</given-names></name><name><surname>Talati</surname><given-names>R</given-names></name><name><surname>Ragozzino</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Differential involvement of M1-type and M4-type muscarinic cholinergic receptors in the dorsomedial striatum in task switching</article-title><source>Neurobiology of Learning and Memory</source><volume>89</volume><fpage>114</fpage><lpage>124</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2007.06.005</pub-id></element-citation></ref><ref id="bib59"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montague</surname><given-names>PR</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Sejnowski</surname><given-names>TJ</given-names></name></person-group><year iso-8601-date="1996">1996</year><article-title>A framework for mesencephalic dopamine systems based on predictive hebbian learning</article-title><source>Journal of Neuroscience</source><volume>16</volume><fpage>1936</fpage><lpage>1947</lpage></element-citation></ref><ref id="bib60"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>G</given-names></name><name><surname>Arkadir</surname><given-names>D</given-names></name><name><surname>Nevet</surname><given-names>A</given-names></name><name><surname>Vaadia</surname><given-names>E</given-names></name><name><surname>Bergman</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Coincident but distinct messages of midbrain dopamine and striatal tonically active neurons</article-title><source>Neuron</source><volume>43</volume><fpage>133</fpage><lpage>143</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2004.06.012</pub-id></element-citation></ref><ref id="bib61"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname><given-names>MR</given-names></name><name><surname>Wilson</surname><given-names>RC</given-names></name><name><surname>Heasly</surname><given-names>B</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>An approximately bayesian delta-rule model explains the dynamics of belief updating in a changing environment</article-title><source>Journal of Neuroscience</source><volume>30</volume><fpage>12366</fpage><lpage>12378</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.0822-10.2010</pub-id></element-citation></ref><ref id="bib62"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Doherty</surname><given-names>JP</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name><name><surname>Friston</surname><given-names>K</given-names></name><name><surname>Critchley</surname><given-names>H</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Temporal difference models and reward-related learning in the human brain</article-title><source>Neuron</source><volume>38</volume><fpage>329</fpage><lpage>337</lpage><pub-id pub-id-type="doi">10.1016/S0896-6273(03)00169-7</pub-id></element-citation></ref><ref id="bib63"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O'Reilly</surname><given-names>RC</given-names></name><name><surname>Hazy</surname><given-names>TE</given-names></name><name><surname>Herd</surname><given-names>SA</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>The leabra cognitive architecture</article-title><source>Oxford Handbooks Online</source><pub-id pub-id-type="doi">10.1093/oxfordhb/9780199842193.013.8</pub-id></element-citation></ref><ref id="bib64"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>O’Reilly</surname><given-names>RC</given-names></name><name><surname>Munakata</surname><given-names>Y</given-names></name></person-group><year iso-8601-date="2000">2000</year><source>Computational Explorations in Cognitive Neuroscience</source><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib65"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Payzan-LeNestour</surname><given-names>E</given-names></name><name><surname>Bossaerts</surname><given-names>P</given-names></name><name><surname>Behrens</surname><given-names>T</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Risk, unexpected uncertainty, and estimation uncertainty: bayesian learning in unstable settings</article-title><source>PLoS Computational Biology</source><volume>7</volume><elocation-id>e1001048</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001048</pub-id></element-citation></ref><ref id="bib66"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pessiglione</surname><given-names>M</given-names></name><name><surname>Seymour</surname><given-names>B</given-names></name><name><surname>Flandin</surname><given-names>G</given-names></name><name><surname>Dolan</surname><given-names>RJ</given-names></name><name><surname>Frith</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Dopamine-dependent prediction errors underpin reward-seeking behaviour in humans</article-title><source>Nature</source><volume>442</volume><fpage>1042</fpage><lpage>1045</lpage><pub-id pub-id-type="doi">10.1038/nature05051</pub-id></element-citation></ref><ref id="bib67"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ragozzino</surname><given-names>ME</given-names></name><name><surname>Jih</surname><given-names>J</given-names></name><name><surname>Tzavos</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Involvement of the dorsomedial striatum in behavioral flexibility: role of muscarinic cholinergic receptors</article-title><source>Brain Research</source><volume>953</volume><fpage>205</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1016/S0006-8993(02)03287-0</pub-id></element-citation></ref><ref id="bib68"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ragozzino</surname><given-names>ME</given-names></name><name><surname>Mohler</surname><given-names>EG</given-names></name><name><surname>Prior</surname><given-names>M</given-names></name><name><surname>Palencia</surname><given-names>CA</given-names></name><name><surname>Rozman</surname><given-names>S</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Acetylcholine activity in selective striatal regions supports behavioral flexibility</article-title><source>Neurobiology of Learning and Memory</source><volume>91</volume><fpage>13</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1016/j.nlm.2008.09.008</pub-id></element-citation></ref><ref id="bib69"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rao</surname><given-names>RPN</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Hierarchical bayesian inference in networks of spiking neurons</article-title><source>Advances in Neural Information Processing Systems</source><volume>17</volume><fpage>1113</fpage><lpage>1120</lpage></element-citation></ref><ref id="bib70"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ratcliff</surname><given-names>R</given-names></name><name><surname>Frank</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Reinforcement-based decision making in corticostriatal circuits: mutual constraints by neurocomputational and diffusion models</article-title><source>Neural Computation</source><volume>24</volume><fpage>1186</fpage><lpage>1229</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00270</pub-id></element-citation></ref><ref id="bib71"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ravel</surname><given-names>S</given-names></name><name><surname>Legallet</surname><given-names>E</given-names></name><name><surname>Apicella</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Responses of tonically active neurons in the monkey striatum discriminate between motivationally opposing stimuli</article-title><source>The Journal of Neuroscience</source><volume>23</volume><fpage>8489</fpage><lpage>8497</lpage></element-citation></ref><ref id="bib72"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reynolds</surname><given-names>JNJ</given-names></name><name><surname>Wickens</surname><given-names>JR</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dopamine-dependent plasticity of corticostriatal synapses</article-title><source>Neural Networks</source><volume>15</volume><fpage>507</fpage><lpage>521</lpage><pub-id pub-id-type="doi">10.1016/S0893-6080(02)00045-X</pub-id></element-citation></ref><ref id="bib73"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Rumelhart</surname><given-names>DE</given-names></name><name><surname>McClelland</surname><given-names>JL</given-names></name><collab>the PDP Research Group</collab></person-group><year iso-8601-date="1986">1986</year><chapter-title>Parallel distributed processing: Explorations in the microstructure of cognition</chapter-title><source>Computational Models of Cognition and Perception</source><edition>(Vol. 1)</edition></element-citation></ref><ref id="bib74"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samejima</surname><given-names>K</given-names></name><name><surname>Ueda</surname><given-names>Y</given-names></name><name><surname>Doya</surname><given-names>K</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Representation of action-specific reward values in the striatum</article-title><source>Science</source><volume>310</volume><fpage>1337</fpage><lpage>1340</lpage><pub-id pub-id-type="doi">10.1126/science.1115270</pub-id></element-citation></ref><ref id="bib75"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Flajolet</surname><given-names>M</given-names></name><name><surname>Greengard</surname><given-names>P</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Dichotomous dopaminergic control of striatal synaptic plasticity</article-title><source>Science</source><volume>321</volume><fpage>848</fpage><lpage>851</lpage><pub-id pub-id-type="doi">10.1126/science.1160575</pub-id></element-citation></ref><ref id="bib76"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Hamilton</surname><given-names>SE</given-names></name><name><surname>Nathanson</surname><given-names>NM</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Cholinergic suppression of KCNQ channel currents enhances excitability of striatal medium spiny neurons</article-title><source>Journal of Neuroscience</source><volume>25</volume><fpage>7449</fpage><lpage>7458</lpage><pub-id pub-id-type="doi">10.1523/JNEUROSCI.1381-05.2005</pub-id></element-citation></ref><ref id="bib77"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>W</given-names></name><name><surname>Tian</surname><given-names>X</given-names></name><name><surname>Day</surname><given-names>M</given-names></name><name><surname>Ulrich</surname><given-names>S</given-names></name><name><surname>Tkatch</surname><given-names>T</given-names></name><name><surname>Nathanson</surname><given-names>NM</given-names></name><name><surname>Surmeier</surname><given-names>DJ</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Cholinergic modulation of Kir2 channels selectively elevates dendritic excitability in striatopallidal neurons</article-title><source>Nature Neuroscience</source><volume>10</volume><fpage>1458</fpage><lpage>1466</lpage><pub-id pub-id-type="doi">10.1038/nn1972</pub-id></element-citation></ref><ref id="bib78"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stocco</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Acetylcholine-based entropy in response selection: a model of how striatal interneurons modulate exploration, exploitation, and response variability in decision-making</article-title><source>Frontiers in Neuroscience</source><volume>6</volume><fpage>18</fpage><pub-id pub-id-type="doi">10.3389/fnins.2012.00018</pub-id></element-citation></ref><ref id="bib79"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Sutton</surname><given-names>RS</given-names></name><name><surname>Barto</surname><given-names>AG</given-names></name></person-group><year iso-8601-date="1998">1998</year><source>Reinforcement Learning: An Introduction</source><publisher-loc>Cambridge</publisher-loc><publisher-name>MIT Press</publisher-name></element-citation></ref><ref id="bib80"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tan</surname><given-names>CO</given-names></name><name><surname>Bullock</surname><given-names>D</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>A dopamine-acetylcholine cascade: simulating learned and lesion-induced behavior of striatal cholinergic interneurons</article-title><source>Journal of Neurophysiology</source><volume>100</volume><fpage>2409</fpage><lpage>2421</lpage><pub-id pub-id-type="doi">10.1152/jn.90486.2008</pub-id></element-citation></ref><ref id="bib81"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Threlfell</surname><given-names>S</given-names></name><name><surname>Lalic</surname><given-names>T</given-names></name><name><surname>Platt</surname><given-names>NJ</given-names></name><name><surname>Jennings</surname><given-names>KA</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name><name><surname>Cragg</surname><given-names>SJ</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Striatal dopamine release is triggered by synchronized activity in cholinergic interneurons</article-title><source>Neuron</source><volume>75</volume><fpage>58</fpage><lpage>64</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2012.04.038</pub-id></element-citation></ref><ref id="bib82"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsai</surname><given-names>H-C</given-names></name><name><surname>Zhang</surname><given-names>F</given-names></name><name><surname>Adamantidis</surname><given-names>A</given-names></name><name><surname>Stuber</surname><given-names>GD</given-names></name><name><surname>Bonci</surname><given-names>A</given-names></name><name><surname>de Lecea</surname><given-names>L</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Phasic firing in dopaminergic neurons is sufficient for behavioral conditioning</article-title><source>Science</source><volume>324</volume><fpage>1080</fpage><lpage>1084</lpage><pub-id pub-id-type="doi">10.1126/science.1168878</pub-id></element-citation></ref><ref id="bib83"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>SS</given-names></name><name><surname>Denk</surname><given-names>W</given-names></name><name><surname>Häusser</surname><given-names>M</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Coincidence detection in single dendritic spines mediated by calcium release</article-title><source>Nature Neuroscience</source><volume>3</volume><fpage>1266</fpage><lpage>1273</lpage><pub-id pub-id-type="doi">10.1038/81792</pub-id></element-citation></ref><ref id="bib84"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>CJ</given-names></name><name><surname>Goldberg</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Origin of the slow afterhyperpolarization and slow rhythmic bursting in striatal cholinergic interneurons</article-title><source>Journal of Neurophysiology</source><volume>95</volume><fpage>196</fpage><lpage>204</lpage><pub-id pub-id-type="doi">10.1152/jn.00630.2005</pub-id></element-citation></ref><ref id="bib85"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname><given-names>RC</given-names></name><name><surname>Nassar</surname><given-names>MR</given-names></name><name><surname>Gold</surname><given-names>JI</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Bayesian online learning of the hazard rate in change-point problems</article-title><source>Neural Computation</source><volume>22</volume><fpage>2452</fpage><lpage>2476</lpage><pub-id pub-id-type="doi">10.1162/NECO_a_00007</pub-id></element-citation></ref><ref id="bib86"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Witten</surname><given-names>IB</given-names></name><name><surname>Lin</surname><given-names>S-C</given-names></name><name><surname>Brodsky</surname><given-names>M</given-names></name><name><surname>Prakash</surname><given-names>R</given-names></name><name><surname>Diester</surname><given-names>I</given-names></name><name><surname>Anikeeva</surname><given-names>P</given-names></name><name><surname>Gradinaru</surname><given-names>V</given-names></name><name><surname>Ramakrishnan</surname><given-names>C</given-names></name><name><surname>Deisseroth</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Cholinergic interneurons control local circuit activity and cocaine conditioning</article-title><source>Science</source><volume>330</volume><fpage>1677</fpage><lpage>1681</lpage><pub-id pub-id-type="doi">10.1126/science.1193771</pub-id></element-citation></ref><ref id="bib87"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woolf</surname><given-names>NJ</given-names></name><name><surname>Butcher</surname><given-names>LL</given-names></name></person-group><year iso-8601-date="1981">1981</year><article-title>Cholinergic neurons in the caudate-putamen complex proper are intrinsically organized: a combined evans blue and acetylcholinesterase analysis</article-title><source>Brain Research Bulletin</source><volume>7</volume><fpage>487</fpage><lpage>507</lpage><pub-id pub-id-type="doi">10.1016/0361-9230(81)90004-6</pub-id></element-citation></ref><ref id="bib88"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yagishita</surname><given-names>S</given-names></name><name><surname>Hayashi-Takagi</surname><given-names>A</given-names></name><name><surname>Ellis-Davies</surname><given-names>GCR</given-names></name><name><surname>Urakubo</surname><given-names>H</given-names></name><name><surname>Ishii</surname><given-names>S</given-names></name><name><surname>Kasai</surname><given-names>H</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>A critical time window for dopamine actions on the structural plasticity of dendritic spines</article-title><source>Science</source><volume>345</volume><fpage>1616</fpage><lpage>1620</lpage><pub-id pub-id-type="doi">10.1126/science.1255514</pub-id></element-citation></ref><ref id="bib89"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>AJ</given-names></name><name><surname>Dayan</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Uncertainty, neuromodulation, and attention</article-title><source>Neuron</source><volume>46</volume><fpage>681</fpage><lpage>692</lpage><pub-id pub-id-type="doi">10.1016/j.neuron.2005.04.026</pub-id></element-citation></ref></ref-list></back><sub-article article-type="article-commentary" id="SA1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.12029.013</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Bhalla</surname><given-names>Upinder S</given-names></name><role>Reviewing editor</role><aff id="aff3"><institution>National Centre for Biological Sciences</institution>, <country>India</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife includes the editorial decision letter and accompanying author responses. A lightly edited version of the letter sent to the authors after peer review is shown, indicating the most substantive concerns; minor comments are not usually included.</p></boxed-text><p>[Editors’ note: a previous version of this study was rejected after peer review, but the authors submitted for reconsideration. The first decision letter after peer review is shown below.]</p><p>Thank you for choosing to send your work entitled &quot;TANs adjust striatal learning as a function of population uncertainty: Computational models in stochastic environments&quot; for consideration at <italic>eLife</italic>. Your full submission has been evaluated by Timothy Behrens (Senior editor) and three peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the decision was reached after discussions between the reviewers. Based on our discussions and the individual reviews below, we regret to inform you that your work will not be considered further for publication in <italic>eLife</italic> in its current form.</p><p>The reviewers felt that the modelling and results sections were not explained with sufficient clarity for them to properly evaluate the manuscript. They felt that the question was important and that the findings would potentially be important. However, on top of technical questions, there were substantial concerns about the clarity and articulation of the work, which meant that the reviewers were not comfortable offering a clear recommendation.</p><p>The reviewers all agreed that there were some specific aspects of the paper presentation that needed to be addressed should the authors wish to resubmit the paper:</p><p>1) The model and previous work were poorly explained, figures incomplete and the explanations assumed familiarity with the authors' previously published work.</p><p>2) It would be desirable to have more detailed figures of activity and connectivity in the network, rather than high-level summaries.</p><p>3) The relationship to experiments should be much better defined. Specific model explanations and predictions of experimental results should be presented.</p><p>4) The use of the terms 'entropy' and 'uncertainty' was unclear and needs to be better defined and motivated.</p><p>In addition, each of the reviewers felt there were specific gaps in the completeness of the study that weakened its conclusions. These are detailed in the reviewer comments. At least some of these specific suggestions should be incorporated, should the authors wish to resubmit the paper.</p><p>The two technical points that raised most concern in reviewer discussions were the points that relating to the effect of rebound phase after the TAN pause (Reviewer 3 point 1), and the possible mechanisms for computation of uncertainty or entropy within the network.</p><p><italic>Reviewer #1:</italic></p><p>This study pulls together existing models of reinforcement learning and several streams of experimental results to develop an interesting model of learning in a changing environment.</p><p>The study develops a model of a striatal learning, adding a critical component by asking what would happen if variability in the MSN pool could be treated as a measure of uncertainty about a changing environment. Under such circumstances, the authors show how modulation by TANs may allow the network to improve its learning rate depending on uncertainty.</p><p>Major comments:</p><p>1) I had some difficulty understanding how the TAN input acted on the MSN population. This was presented in the text in words, and in the figures through secondary readouts such as accuracy and entropy. I would like to see the simulated activity patterns (e.g., spike rasters) reported for TANS and MSNs in the various conditions. Additionally, an input-output relationship of TAN activity, pauses, and MSN excitability would help to clarify the physiological assumptions of the model.</p><p>2) As per Methods, the time constant of the TANs &quot;was transformed such that pause duration in the network varied linearly with entropy.&quot;</p><p>I was disappointed that the study fell short of modeling how the TANs would compute the entropy of the network. This is just plugged in to the firing patterns. Given that the model incorporates the MSN population, it would have been nice to see a mechanistic implementation of the entropy computation step. The authors don't clearly state a mechanism for this: the closest sees to be a line in the Discussion:</p><p>&quot;A measure of uncertainty could be approximated by summing the activity over multiple sources, either directly from MSNs or indirectly through other interneurons. &quot;</p><p>I'm not sure how just summing activity will give this measure. I feel that the authors must suggest a more detailed mechanism for this essential step. I would strongly prefer that they also model such a mechanism; it would complete a missing link in the model.</p><p><italic>Reviewer #2:</italic></p><p>This paper addresses the question of reinforcement learning in an uncertain environment. The theoretical premise is that common reinforcement learning algorithms are not sensitive to uncertainty, and would not operate well in such an environment. They propose that Cholinergic interneurons in striatum can sense this uncertainty and modulate circuit dynamics and plasticity to make the system operate better in an uncertain environment.</p><p>Major concerns:</p><p>The notion of uncertainty is not well defined here. I suppose they mean an uncertain environment, but this in itself is still not well defined. It could be an environment that is not stationary as in a reversal task, or an environment in which reward is uncertain, that is a reward is given just with a certain probability. This is just the beginning of the problem here, because the uncertainty of the environment becomes confounded with the response distribution of MSN neurons.</p><p>This is a complex rate based network, and its behavior is not at all clear. This seems like a deterministic system, so why does it have any entropy? Entropy seems like an important concept here because somehow entropy of the network represents the uncertainty of the environment. I think what they do is that they make a histogram of (deterministic) network activity and use that as a probability distribution (even though the N dim state space is unique) and use that for the &quot;Entropy&quot; calculation. Note though that the network has no uncertainty. The term entropy here seems to obfuscate rather than clarify, but I think what they mean is that in an uncertain environment the network response is more spatially variable than in a certain environment. This leaves many questions. First, what is the origin of spatial variability in this network? I don't know how many units there are in this network, and have no idea why different units do not respond identically. Second, if there is this mapping from uncertainty to network variability, how does this happen? This is an example of a general problem with this paper, they run complex simulations and treat the results as an experimentalist would they describe the results, but seldom explain why the network generates these results.</p><p>The model needs to be rewritten. For example the acronym TAN is used in the title. How should a reader, who is not exactly in the same field, know what TAN's are? The Abstract is very technical, and can really only be appreciated by a very small group of scientists. Additionally, some statements that are made are too strong. For example the sentence: &quot;The basal ganglia support adaptive reinforcement learning in accordance with algorithms that adjust action values using a static learning rate.&quot; Is this a fact, or a postulate supported by some evidence? Additionally, the rest of the paper is also hard to understand. The methods relay on previous papers, and there is never a good heuristic explanation of the network behavior. Even the training task is badly described, has no figures, and is mostly in the Methods section.</p><p>There is hardly any physiological data that this model is trying to account for, if it exists it is not evident in the paper. So this is a complex network, accounting for behavior, but it can receive little validation at the physiological level. Do we need this much complexity given the current state of the experimental data?</p><p><italic>Reviewer #3:</italic></p><p>This is an interesting manuscript, which incorporates ChIs into a basal ganglia model. ChIs are of ever-growing interest because of their increasingly apparent involvement in key functions of the basal ganglia and dysfunction in disease. The timely manuscript by Franklin &amp; Frank is a follow-up study by this group (Frank, 2005). The authors incorporate striatal ChIs into their previous computational model which successfully mimics the basal ganglia function in normal and Parkinsonism conditions. In this study, the authors tested the role of ChIs in acquisition and reversal learning, by simulating M1, M2 receptormediated currents on medium spiny neurons (MSNs) and nicotinic receptor-mediated currents on GABAergic interneurons. The results replicated the experimental observations. In addition, the authors claimed that MSN entropy and ChIs pause feedback mechanism might control the pause duration which reveals a tradeoff between asymptotic accuracy and flexible learning.</p><p>This is an interesting and timely model but I have some concerns.</p><p>1) The major concern is that the model ignored the rebound phase of the pause response. The lack of this component will significantly lower the power and impact of the model. Compared to the initial excitation, which is only observed in about half of TANs, the rebound of the pause response, which has similar duration as the pause, is much more consistent observed across TANs (Aosaki et al., 2010). Combined with the facts that dopamine signals in striatum might last longer than phasic activities in cell bodies, and that the model only includes fast responses in MSNs, i.e. excitatory, inhibitory and leaking current, will the rebound of the pause response rewrite the learning process?</p><p>2) The authors propose a feedback loop from MSNs to ChIs. Although activating MSNs can induce inhibitory currents in ChIs, the currents are thought to be weak (Chuhma et al., 2011). Also the MSNs have very low firing frequency (Berke et al., 2004). Will these facts influence the conclusion of feedback loop of MSNs and ChIs? The conclusion that inhibitory currents from MSNs will slow the firing rate of ChIs is natural, especially from a model's point of view, but is that reasonable when compared with experimental data? Any justification, like the inhibitory current intensity, or average firing rate of MSNs needs to be provided.</p><p>3) The model used Go and NoGo units activities to represent the &quot;weight for specific actions&quot; and &quot;the evidence against particular responses&quot; respectively. At the same time, the model claimed that Go neurons are striatonigral MSNs and NoGo are striatopallidal MSNs, and further used their electrophysiological data, e.g. M1 only act on striatopallidal MSNs. This is a common setup of computational models, however, the reversal learning process, e.g. left v.s. right turn (Ragozzino et al., 2002), lever press for food v.s. water (Bradfield et al., 2013), are task choices rather than task stops. Is it appropriate to use Shannon's entropy across the population of MSNs here?</p><p>4) It would be useful to have the duration of pause in time rather than 15-25 (<xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig6">Figure 6</xref>).</p><p>[Editors’ note: what now follows is the decision letter after the authors submitted for further consideration.]</p><p>Thank you for resubmitting your work entitled &quot;A cholinergic feedback circuit to regulate striatal population uncertainty and optimize reinforcement learning&quot; for further consideration at <italic>eLife</italic>. Your revised article has been favorably evaluated by Timothy Behrens (Senior editor) and three reviewers, one of whom is a member of our Board of Reviewing Editors. The manuscript has been improved but there are some remaining issues that need to be addressed before acceptance, as outlined below:</p><p>The reviewers all felt that the paper was significantly improved from the previous submission, but that there were important aspects that needed to be addressed.</p><p>1) The model lacked a rebound phase in the pause response. The authors should analyze whether this might alter learning processes.</p><p>2) The authors should address the possibility that pause duration in TANs may simply reflect excitatory and DA input.</p><p>3) The authors must clear up a continuing lack of clarity about how uncertainty maps to entropy, stochasticity, and to sparseness of the distributed response.</p><p>4) The authors should address the concern that the presented model is complex yet at the same time biophysically implausible. Can they embed the core concepts in a much simpler model?</p><p>5) The authors should make extensive improvements in clarity throughout the paper, as indicated in many comments by the reviewers.</p><p>6) The authors should also suggest some other simple testable predictions in addition to the ones mentioned in paragraph nine, Discussion.</p><p><italic>Reviewer #1:</italic></p><p>Significance:</p><p>This modeling study considers how striatal reinforcement learning may incorporate uncertainty about the environment into controlling learning rate. This allows the system to ignore chance fluctuations in reliable environments, but also to learn more rapidly in cases where the environment is changeable. The revision is considerably improved and addresses all the main concerns I had previously raised.</p><p>Major comments:</p><p>1) <xref ref-type="fig" rid="fig8">Figure 8</xref> results are good to see, they take the argument full circle by showing that a purely network-based implementation is able to achieve high performance in changing environments by appropriate control of TAN behavior.</p><p>2) The implication of <xref ref-type="fig" rid="fig6">Figure 6</xref> is a bit confusing, especially the last panel. How do the network weight differences map to the performance in <xref ref-type="fig" rid="fig5">Figure 5</xref>? What would be a good outcome from the point of view of performance? Is the black line close to optimal?</p><p><italic>Reviewer #2:</italic> </p><p>This manuscript incorporates cholinergic interneurons (Chls) into a basal ganglia model built by the same group (Frank, 2005). It is good to see that authors incorporate striatal ChIs into a computational model and simulated the interaction between spiny projection neurons and TANs. With this new model, the authors successfully tested their hypotheses of 1) changing of the duration of 'pause' in TANs could affect the balance of asymptotic accuracy and flexible learning in striatum, and 2) the spiny projection neurons and TANs system showed self-tuning property in learning rate and optimizing performance across stochastic environment.</p><p>This is an exciting model with some concerns.</p><p>1) The missing of rebound phase of the pause response will significantly lower the power of the model. The initial excitation of the pause response, which is included in the model, is only observed in about half of TANs. However, the rebound of the pause response showed in all the reported pause response (Aosaki et al., 2010). While the dopamine signals last longer in striatum than the phasic activities in cell bodies, will the rebound component of the pause response re-write the learning process, which built only upon the initial excitation and pause, of the model?</p><p>2) The hypothesis of the duration of the pause in TANs affecting the learning process is clever. However, the original studies of the pause response only compare the durations of pauses that are induced by aversive and appetitive stimuli (Apicella et al., 2009; Ravel et al., 2003). As mentioned in the Discussion, the model would not be suitable for the animals that are well trained. It is a little bit hard to argue the interaction between spiny projection neuron and TANs play the important role in regulating pause duration. Would it be possible that the pause duration in TANs might only reflect the excitatory and dopamine input (Ding et al., 2010)?</p><p><italic>Reviewer #3:</italic></p><p>This version of the paper is improved compared to the previous one, but I still have some concerns.</p><p>The basic idea here is that learning should depend on the level of uncertainty. The assumption is that the level of uncertainty is represented by the network of MSN neurons. If they are sparsely activated this implied high certainty and if they are activated in a distributed manner this means uncertainty. A key phase is &quot;treated as uncertainty&quot;. The equations for entropy are not for true entropy, and the stochasticity to the extent it exists plays little role here, they are simply quantifications of a sparse or distributed response.</p><p>One improvement here is that rather than modulating the TAN pause completely via an external and biophysically implausible mechanism the detection of the &quot;uncertainty&quot; is now more biophysical, however if I understood correctly the control of the TAN pause duration is still external and non-biophysical.</p><p>This is a very complex model, yet it is not biophysically plausible. I have the feelings that the general concepts could be embedded in a much simpler model that would not obscure the main points in a mountain of details, on the other hand if it were truly biophysical it could be more directly compared to experimental results. Therefore, this is neither a clear lucid theory, nor a reasonable computational model.</p></body></sub-article><sub-article article-type="reply" id="SA2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.12029.014</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><p>[Editors’ note: the author responses to the first round of peer review follow.]</p><p><italic>[…] The reviewers all agreed that there were some specific aspects of the paper presentation that needed to be addressed should the authors wish to resubmit the paper:</italic> </p><p><italic>1) Model and previous work were poorly explained, figures incomplete and the explanations assumed familiarity with the authors' previously published work.</italic> </p><p><italic>2) It would be desirable to have more detailed figures of activity and connectivity in the network, rather than high-level summaries.</italic> </p><p><italic>3) The relationship to experiments should be much better defined. Specific model explanations and predictions of experimental results should be presented.</italic> </p><p><italic>4) The use of the terms 'entropy' and 'uncertainty' was unclear and needs to be better defined and motivated.</italic> </p><p><italic>In addition, each of the reviewers felt there were specific gaps in the completeness of the study that weakened its conclusions. These are detailed in the reviewer comments. At least some of these specific suggestions should be incorporated, should the authors wish to resubmit the paper. The two technical points that raised most concern in reviewer discussions were the points that relating to the effect of rebound phase after the TAN pause (Reviewer 3 point 1), and the possible mechanisms for computation of uncertainty or entropy within the network.</italic></p><p>We would like to thank the editor and reviewers for their encouragement as well as their critical comments and feedback. The review process was extremely useful for encouraging us to clarify what our model is positing. It motivated us to better articulate the key model features, but moreover to conduct several new analyses and simulations that reveal the underlying mechanisms, and which address the key issues highlighted in the first submission. We further demonstrate a plausible implementation of the feedback mechanism we had posited.</p><p>In more detail, we have made the following changes to the manuscript to address their concerns:</p><p>1) We added several new figures to better illustrate the assumptions of the model, the model’s behavior and its connectivity. These include: a schematic description of the effects of TAN signaling on MSNs (<xref ref-type="fig" rid="fig1">Figure 1</xref>), multiple individual examples of simulated activity for both MSNs and TANs (<xref ref-type="fig" rid="fig2">Figure 2</xref>), synaptic weight changes over time as a function of TAN pause duration and its regulation by our feedback mechanism (<xref ref-type="fig" rid="fig3">Figure 3</xref>) as well as changes in TAN behavior as a consequence of the proposed feedback mechanism (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><p>2) We have clarified the assumptions and predictions of the model as they relate to experimental data. This includes a mechanistic account of how the model accounts for previous behavioral findings and a discussion of the proposed feedback mechanism in relation to experimental findings.</p><p>3) We have expanded our Discussion of uncertainty and entropy and more concretely defined both in terms of the model.</p><p>4) We have added new simulations of a biologically plausible mechanism for implementing the feedback mechanism, whereas our earlier model only assumed that TANs would have access to some analytical computation of entropy within the network (<xref ref-type="fig" rid="fig8">Figure 8</xref>). We argue these simulations demonstrate the feasibility of local consideration of uncertainty and show that such a mechanism is capable of adaptive behavior.</p><p>In addition, we have revised the manuscript for clarity and to address individual points raised by reviewers. We have also changed the title of the manuscript to “A cholinergic feedback circuit to regulate striatal population uncertainty and optimize reinforcement learning.” Below we include detailed point by point responses to reviewers’ comments.</p><p><italic>Reviewer #1:</italic> </p><p><italic>1) I had some difficulty understanding how the TAN input acted on the MSN population. This was presented in the text in words, and in the figures through secondary readouts such as accuracy and entropy. I would like to see the simulated activity patterns (e.g., spike rasters) reported for TANS and MSNs in the various conditions on page 9 and 10. Additionally, an input-output relationship of TAN activity, pauses, and MSN excitability would help to clarify the physiological assumptions of the model.</italic> </p><p>We have added a schematic depiction of the effects of TAN signaling on MSNs to <xref ref-type="fig" rid="fig1">Figure 1</xref> and have added multiple individual examples of simulated activity for both TAN and MSNs (<xref ref-type="fig" rid="fig2">Figure 2</xref>). We show mean activity for individual simulations in lieu of spike raster plots as we feel these are more easily interpretable for rate-coded networks. In addition, we have clarified our language as to how the secondary readout of entropy is informative of the unit activity and added a visual comparison between a low entropy and high entropy population (<xref ref-type="fig" rid="fig2">Figure 2</xref>). More generally, we have been much more specific about the sense of entropy (across the population, as a marker of decision uncertainty) that we are using throughout the manuscript.</p><p><italic>2) As per Methods, the time constant of the TANs &quot;was transformed such that pause duration in the network varied linearly with entropy.&quot;</italic> </p><p><italic>I was disappointed that the study fell short of modeling how the TANs would compute the entropy of the network. This is just plugged in to the firing patterns. Given that the model incorporates the MSN population, it would have been nice to see a mechanistic implementation of the entropy computation step. The authors don't clearly state a mechanism for this: the closest sees to be a line in the Discussion:</italic> </p><p><italic>&quot;A measure of uncertainty could be approximated by summing the activity over multiple sources, either directly from MSNs or indirectly through other interneurons. &quot;</italic></p><p><italic>I'm not sure how just summing activity will give this measure. I feel that the authors must suggest a more detailed mechanism for this essential step. I would strongly prefer that they also model such a mechanism; it would complete a missing link in the model.</italic> </p><p>We agree with the reviewer that this is an important question and have included new simulations to address this critique (detailed in the new sub-section “A local mechanism for entropy modulation of TAN duration” in the results and summarized in <xref ref-type="fig" rid="fig8">Figure 8</xref>). We propose a mechanism by which pairs of MSNs synapse closely together on the dendrites of TANs in such a way that facilitates the detection of coincident MSN activity coding for alternative actions. This detection is the Boolean function AND and we argue that AND detection is biologically plausible, e.g. via non-linear dendritic summation, and can be used to approximate entropy. We implemented this mechanism in the neural network using AND detection to modulate the duration of the TAN pause and show that doing so results in very similar behavior as reliance on the analytical computation of Shannon’s entropy.</p><p>We note that this is just one plausible mechanism by which TANs could be sensitive to choice uncertainty across a population of MSNs, and we highlight other potential mechanisms in the text. The main important prediction of our model is that TAN pauses affect the striatum’s uncertainty and hence learning rate, and that if it also has access to a source of uncertainty (whatever the source) in modulating TAN pauses, it can adaptively respond to the tradeoff in flexibility vs stability.</p><p><italic>Reviewer #2:</italic> </p><p><italic>[…] The notion of uncertainty is not well defined here. I suppose they mean an uncertain environment, but this in itself is still not well defined. It could be an environment that is not stationary as in a reversal task, or an environment in which reward is uncertain, that is a reward is given just with a certain probability. This is just the beginning of the problem here, because the uncertainty of the environment becomes confounded with the response distribution of MSN neurons.</italic> </p><p>In our new manuscript, we have taken great care to clarify the sense in which the MSN population represents the uncertainty over its choice policy, how it does so, and the relation to activity in MSN subpopulations (<xref ref-type="fig" rid="fig2">Figure 2</xref>). In broad terms, we are concerned with the uncertainty about which action will be selected on an individual trial. We have defined this as the Shannon’s entropy over the probability mass function representing alternative actions (see text for elaboration).</p><p>In normative models, three sources of uncertainty are often considered in the decision making process: estimation uncertainty, expected uncertainty, and unexpected uncertainty (Payzan-LeNestour, et al 2013). Estimation uncertainty reflects the lack of knowledge about the outcome statistics; expected uncertainty reflects the predictable trial to trial outcome variability (risk), and unexpected uncertainty reflects a change in outcome statistics, i.e. when outcomes occur outside the predictive distribution. All three forms of uncertainty are meaningful, however, we have avoided the use of these terms because the sources of uncertainty interact during learning, and their definition, depend on the generative process.</p><p>The neural network does not track each source of uncertainty separately, but nevertheless represents the net uncertainty about which action to select. Such a measure decreases with accumulated knowledge (i.e., as estimation uncertainty decreases) but also increases when statistics change (unexpected uncertainty), and our feedback mechanism capitalizes on both of these components to adaptively modulate learning rate. Indeed, the trajectory of MSN entropy over learning and reversal is similar to the uncertainty (again quantified by Shannon’s entropy) within the Bayesian learner.</p><p><italic>This is a complex rate based network, and its behavior is not at all clear. This seems like a deterministic system, so why does it have any entropy? Entropy seems like an important concept here because somehow entropy of the network represents the uncertainty of the environment. I think what they do is that they make a histogram of (deterministic) network activity and use that as a probability distribution (even though the N dim state space is unique) and use that for the &quot;Entropy&quot; calculation. Note though that the network has no uncertainty. The term entropy here seems to obfuscate rather than clarify, but I think what they mean is that in an uncertain environment the network response is more spatially variable than in a certain environment. This leaves many questions. First, what is the origin of spatial variability in this network? I don't know how many units there are in this network, and have no idea why different units do not respond identically. Second, if there is this mapping from uncertainty to network variability, how does this happen? This is an example of a general problem with this paper, they run complex simulations and treat the results as an experimentalist would they describe the results, but seldom explain why the network generates these results.</italic> </p><p>We appreciate the reviewer’s remarks as the description of the network and the mechanisms involved was not clear and we have substantially revised the manuscript. We have updated the text describing the function of the network and how it implements action selection by representing alternative action values in separate sub-populations, and their effects on downstream pathways. We clarified throughout the manuscript (and including the equation in the text where it is first introduced) that the entropy we refer to is that over action selection. Thus although the units in the model are rate-coded, the population nevertheless can be more or less ‘certain’ in that activity can be more or less restricted to just the most dominant action or can be distributed across multiple alternative actions. This would be true even for a purely deterministic network, where uncertainty could still evolve with learning (synaptic weight changes that then affect the relative distribution of activity). But we note here that the network is also not a deterministic system – there is stochastic noise added to membrane potentials of cortical and striatal units, which aid in producing stochastic choices (exploration) early in learning before synaptic weights have evolved. This also means that greater entropy is associated with greater choice stochasticity.</p><p>Perhaps even more importantly, we have also responded to this Reviewer’s comments to show more explicitly how the results manifest in terms of underlying mechanisms. We included examples of MSN and TAN population activity as a function of early and late learning and how they correspond to different levels of entropy (<xref ref-type="fig" rid="fig2">Figure 2</xref>). We have shown that the effect of TAN pauses on modulating MSN excitability during reinforcement is to alter the divergence in corticostriatal synaptic weights coding for the optimal vs. sub-optimal action, and that the TAN feedback-mechanism regulates this divergence (<xref ref-type="fig" rid="fig6">Figure 6</xref>) to stabilize performance after initial learning (as in networks with long pauses) but also remain flexible to change-points (as in networks with short pauses). These were very useful exercises and we feel the resulting manuscript is substantially clearer.</p><p><italic>The model needs to be rewritten. For example the acronym TAN is used in the title. How should a reader, who is not exactly in the same field, know what TAN's are? The Abstract is very technical, and can really only be appreciated by a very small group of scientists. Additionally, some statements that are made are too strong. For example the sentence: &quot;The basal ganglia support adaptive reinforcement learning in accordance with algorithms that adjust action values using a static learning rate.&quot; Is this a fact, or a postulate supported by some evidence? Additionally, the rest of the paper is also hard to understand. The methods relay on previous papers, and there is never a good heuristic explanation of the network behavior. Even the training task is badly described, has no figures, and is mostly in the Methods section.</italic> </p><p>We appreciate the reviewer’s comments and have made the appropriate changes for clarity throughout.</p><p><italic>There is hardly any physiological data that this model is trying to account for, if it exists it is not evident in the paper. So this is a complex network, accounting for behavior, but it can receive little validation at the physiological level. Do we need this much complexity given the current state of the experimental data?</italic> </p><p>We agree that the system is complex and not fully understood. Nevertheless, there is substantial physiological data showing that distinct MSN populations code for action values in their firing rates (e.g., Samejima et al 2005) and that manipulating excitability of these Go and NoGo populations acts to bias animal choices accordingly (Tai et al, 2012). There is also physiological data showing that TAN pauses window the phasic dopaminergic signals during reinforcement (we now include a panel in <xref ref-type="fig" rid="fig1">Figure 1</xref> of these data from Morris et al 2004 because they are central to the effects we simulate). There is further evidence that TAN signaling is relevant for modulating MSN synaptic plasticity and excitability (cites), and that ablation of TANs results in reversal learning deficits. Together with the vast literature linking basal ganglia function to normative reinforcement learning models, we believe it is appropriate to ask questions driven by physiology as well as by what we expect to find in adaptive behavior with the intent of making explicit predictions of physiology. Finally, our model makes further falsifiable, but as of yet untested, physiological predictions which we highlight in the Discussion.</p><p><italic>Reviewer #3:</italic> </p><p><italic>1) The major concern is that the model ignored the rebound phase of the pause response. The lack of this component will significantly lower the power and impact of the model. Compared to the initial excitation, which is only observed in about half of TANs, the rebound of the pause response, which has similar duration as the pause, is much more consistent observed across TANs (Aosaki et al., 2010). Combined with the facts that dopamine signals in striatum might last longer than phasic activities in cell bodies, and that the model only includes fast responses in MSNs, i.e. excitatory, inhibitory and leaking current, will the rebound of the pause response rewrite the learning process?</italic> </p><p>We agree that both the initial excitation and the rebound burst are interesting and relevant, in addition to the pause itself. We have modeled some of the effects of the initial excitation (via M1 signaling). However, as we understand it, the main concern highlighted here is that the rebound burst may offset the effects of the pause that we simulate. However, the key point is that TAN signaling modulates the effect of dopamine on the excitability of recently active MSNs. It has recently been shown that DA promotes spine growth associated with synaptic plasticity only in a narrow time window (0.3 to 2 seconds) following glutamatergic input to the MSN, and only for the specific spines that were excited (Yagashita et al., 2014, Science). Thus the effects of TAN pauses would be to further enhance the excitability of relevant MSNs in the precise window during which DA modulates plasticity. The subsequent TAN rebound burst could further enhance DA signaling (via nicotinic receptors) that occurs immediately after this increase in excitability, which would only further enhance the plasticity credited to the recently active MSN (even if that MSN is now inactive due to the burst – the key point is that it was active a few hundred milliseconds prior, as per Yagashita et al.).</p><p><italic>2) The authors propose a feedback loop from MSNs to ChIs. Although activating MSNs can induce inhibitory currents in ChIs, the currents are thought to be weak (Chuhma et al., 2011). Also the MSNs have very low firing frequency (Berke et al., 2004). Will these facts influence the conclusion of feedback loop of MSNs and ChIs? The conclusion that inhibitory currents from MSNs will slow the firing rate of ChIs is natural, especially from a model's point of view, but is that reasonable when compared with experimental data? Any justification, like the inhibitory current intensity, or average firing rate of MSNs needs to be provided.</italic> </p><p>While Chuhma and colleagues found the effects of GABAergic signaling to be weak, these effects were found in vitro and were not measured during the TAN pause. We have proposed that modulation by MSNs may occur during the TAN pause, a period in which TANs may be more sensitive to inhibition due to a reduction in intrinsic pace making activity. Additionally, there may be an additional modulatory effect of TANs once the pause is elicited by other sources (for example, the thalamus) that simply extend the duration or its depth.</p><p>While MSNs have a low firing frequency, they are active in response to reward feedback (Asaad and Eskander, J Neuro 2011), the period of time when we have proposed TANs to be sensitive to MSN activity. If their activity is coincident with the TAN response, then the low firing frequency may not be as critical of an issue.</p><p>We would also note that this is but one potential mechanism and that uncertainty could also be conveyed to TANs through other mechanisms, such as cortical signaling as we highlight in the text. The main important prediction of our model is that TAN pauses affect the striatum’s uncertainty and hence learning rate, and that if it also has access to a source of uncertainty (whatever the source) in modulating TAN pauses, it can adaptively respond to the tradeoff in flexibility vs stability.</p><p><italic>3) The model used Go and NoGo units activities to represent the &quot;weight for specific actions&quot; and &quot;the evidence against particular responses&quot; respectively. At the same time, the model claimed that Go neurons are striatonigral MSNs and NoGo are striatopallidal MSNs, and further used their electrophysiological data, e.g. M1 only act on striatopallidal MSNs. This is a common setup of computational models, however, the reversal learning process, e.g. left v.s. right turn (Ragozzino et al., 2002), lever press for food v.s. water (Bradfield et al., 2013), are task choices rather than task stops. Is it appropriate to use Shannon's entropy across the population of MSNs here?</italic> </p><p>This reflects a somewhat unfortunate historical labeling of the units in our model in terms of “Go” and “NoGo” because it may give the impression that the NoGo units are involved solely in stopping. But instead the NoGo units simply provide evidence against a response during a choice, allowing for the response with higher net difference in Go-NoGo activity to be selected, so that both populations are active during choice. Indeed, emprically both striatonigral and straitopallidal neurons are active during action selection (Cui et al., 2013 Nature), and activation of striatopallidal neurons acts to lower the action value of the specific response under consideration in favor of the alternative one, and not to directly inhibit the action irrespective of value (Tai et al., 2012, Nature Neuroscience).</p><p>Nonetheless, it was sufficient for our simulations to rely on Shannon’s entropy over only the Go units (i.e. only the positive evidence for each action). This measure of entropy is highest when there is evidence towards both choices but also analytically, entropy is high when there is no positive evidence for either response. Physiologically that would be conveyed by high activation of the NoGo units, which can be accommodated in the revised scheme (<xref ref-type="fig" rid="fig8">Figure 8</xref>) in which we consider AND conjunctions over both Go and NoGo units.</p><p><italic>4) It would be useful to have the duration of pause in time rather than 15-25 (<xref ref-type="fig" rid="fig3">Figure 3</xref>, <xref ref-type="fig" rid="fig5">Figure 5</xref>, <xref ref-type="fig" rid="fig6">Figure 6</xref>).</italic> </p><p>We have converted our pause durations from cycles of membrane potential updating (the base unit of time in the network) to milliseconds.</p><p>[Editors' note: the author responses to the re-review follow.]</p><p><italic>The reviewers all felt that the paper was significantly improved from the previous submission, but that there were important aspects that needed to be addressed.</italic> </p><p><italic>1) The model lacked a rebound phase in the pause response. The authors should analyze whether this might alter learning processes. 2) The authors should address the possibility that pause duration in TANs may simply reflect excitatory and DA input. 3) The authors must clear up a continuing lack of clarity about how uncertainty maps to entropy, stochasticity, and to sparseness of the distributed response. 4) The authors should address the concern that the presented model is complex yet at the same time biophysically implausible. Can they embed the core concepts in a much simpler model? 5) The authors should make extensive improvements in clarity throughout the paper, as indicated in many comments by the reviewers. 6) The authors should also suggest some other simple testable predictions in addition to the ones mentioned in paragraph nine, Discussion.</italic> </p><p>We have made the following changes to address the reviewers’ concerns:</p><p>1) We have added simulations of a post-pause rebound phase in the section “Simulations of Post-Pause TAN Burst” of the manuscript, focusing on the effects to which we had previously only discussed conceptually – that TAN bursts reciprocally modulate DA release via nicotinic receptors on DA terminals. We show how this effect further enhances the network’s ability to reverse in stochastic environments by amplifying phasic DA signaling associated with newly correct actions; interestingly, the effects of this modulation were selective to reversal.</p><p>2) In our Discussion, we have addressed the possibility that TAN pause duration may reflect excitatory and DA input rather than (or in addition to) local modulation by MSNs, and note that this possibility does not invalidate many of the predictions of the model.</p><p>3) We have further clarified our definition of uncertainty and entropy in the neural model. We have also included additional detail of the basic assumptions of the model and the biophysical mechanism by which MSNs adjust TAN pause duration (via modulation of after-hyperpolarization) to provide additional clarity.</p><p>4) We have added new simulations to summarize the main contributions of the TANs, supplementing the implementational level neural model and the computational level Bayesian model with a previously described opponent actor learning model (OpAL) that provides an intermediate, algorithmic level of description. With this model, we were able to summarize much of the functional properties by which TANs modulate learning, embedding the core concepts in a simpler model, as suggested. These simulations are presented in <xref ref-type="fig" rid="fig8">Figure 8</xref>.</p><p>5) We have added additional empirical predictions of the model.</p><p>In addition, we have revised the manuscript for clarity and addressed the individual points raised by the reviewers.</p><p><italic>Reviewer #1:</italic></p><p><italic>1) <xref ref-type="fig" rid="fig8">Figure 8</xref> results are good to see, they take the argument full circle by showing that a purely network-based implementation is able to achieve high performance in changing environments by appropriate control of TAN behavior.</italic> </p><p>We thank the reviewer for their encouraging comments.</p><p><italic>2) The implication of <xref ref-type="fig" rid="fig6">Figure 6</xref> is a bit confusing, especially the last panel. How do the network weight differences map to the performance in <xref ref-type="fig" rid="fig5">Figure 5</xref>? What would be a good outcome from the point of view of performance? Is the black line close to optimal?</italic> </p><p>Thank you for allowing us to further clarify this analysis, which gives insight into the mechanism by which TAN pauses modulate learning rate in MSNs. The weight difference in <xref ref-type="fig" rid="fig6">Figure 6</xref> shows how the Go weights for one action over the other diverge across time; greater weight divergence translates into more deterministic choice.</p><p>Thus the weight divergence prior to reversal relates to asymptotic accuracy but is inversely related to reversal speed as more evidence is required to counteract the initial divergence. The black line shows that the feedback mechanism, whereby TANs are modulated by network entropy, allows the network to adapt so that divergence does occur (facilitating asymptotic accuracy) but is tempered to prevent overlearning, and thus also facilitates rapid reversal. This is analogous to the decay of the hyperparameters in the Bayesian model. In response to Reviewer 3, we have further adapted a simpler intermediate algorithmic model of striatal learning which summarizes the learning dynamics of the neural network (Collins &amp; Frank, 2014), which similarly captures these weight divergences and feedback modulation thereof. This model is presented briefly as a complement to the network implementation and is described in the section “Normative descriptions of TAN pause behavior”.</p><p><italic>Reviewer #2:</italic></p><p><italic>1) The missing of rebound phase of the pause response will significantly lower the power of the model. The initial excitation of the pause response, which is included in the model, is only observed in about half of TANs. However, the rebound of the pause response showed in all the reported pause response (Aosaki et al., 2010). While the dopamine signals last longer in striatum than the phasic activities in cell bodies, will the rebound component of the pause response re-write the learning process, which built only upon the initial excitation and pause, of the model?</italic> </p><p>We thank the reviewer for their encouraging comments. We agree that the pause rebound likely plays an important role in the learning process, separately from the effects of the pause itself (which still comprises the main focus of the paper).</p><p>We have now included simulations examining the effects of the post pause rebound in the new section “Simulations of Post-Pause TAN Burst”. We focus on the effects to which we had previously only discussed conceptually – that TAN bursts modulate DA release via nicotinic receptors on DA terminals (Threlfell et al., 2012; Capoche et al., 2012) which facilitates spiny neuron plasticity as a consequence of glutamatergic synaptic activity in the immediately preceding time-window (Yagishita et al., 2014). We find that this effect further enhances the network’s ability to reverse in stochastic environments by amplifying phasic DA signaling associated with newly correct actions; interestingly the effects of this modulation were selective to reversal. This does not however change the qualitative pattern of results reported elsewhere in the paper, related to the TAN pauses and modulation of learning rate.</p><p><italic>2) The hypothesis of the duration of the pause in TANs affecting the learning process is clever. However, the original studies of the pause response only compare the durations of pauses that are induced by aversive and appetitive stimuli (Apicella et al., 2009; Ravel et al., 2003). As mentioned in the Discussion, the model would not be suitable for the animals that are well trained. It is a little bit hard to argue the interaction between spiny projection neuron and TANs play the important role in regulating pause duration. Would it be possible that the pause duration in TANs might only reflect the excitatory and dopamine input (Ding et al., 2010)?</italic> </p><p>While we maintain that weak inhibitory effects of individual MSNs on TAN would conspire to have observable effects across the population, particular as entropy in multiple MSNs grows, we agree that it is possible that the TAN pause duration could only reflect the excitatory (e.g., thalamic) and dopaminergic input. In this case, the downstream effects of TANs on MSN excitability and modulation of learning rate could still hold, as long as these excitatory signals provided to TANs covaried with a measure of uncertainty. fMRI correlates of an uncertainty signal have been identified in the frontal cortex and anterior cingulate (Behrens et al., 2007; McGuire et al. 2014), leaving open an alternative possibility that cortical inputs to TANs signal uncertainty. Were this to be the case, our hypothesized mechanism of local MSN entropy feeding into TANs would be wrong, but the reciprocal modulation of MSN entropy and learning by TANs – and hence many of our core predictions – would remain. We mention these issues in the Discussion section.</p><p><italic>Reviewer #3:</italic> </p><p><italic>This version of the paper is improved compared to the previous one, but I still have some concerns.</italic></p><p><italic>The basic idea here is that learning should depend on the level of uncertainty. The assumption is that the level of uncertainty is represented by the network of MSN neurons. If they are sparsely activated this implied high certainty and if they are activated in a distributed manner this means uncertainty. A key phase is &quot;treated as uncertainty&quot;. The equations for entropy are not for true entropy, and the stochasticity to the extent it exists plays little role here, they are simply quantifications of a sparse or distributed response.</italic> </p><p>We have amended our Methods to clarify the role stochasticity plays in network behavior, the interpretation of the striatal activity as a discrete distribution over the set of actions, and our precise definition of uncertainty. In addition, we have added simulations of an actor-critic model that mirrors the neural network to better illustrate the parallel. We address each of these points below.</p><p>We maintain that the network does reflect uncertainty, quantified by an estimate of the entropy in the action selection probability, which we make explicit. We agree with the reviewer that individual neurons do not represent entropy in their stochastic firing (but see below re: stochasticity), but nevertheless, even a deterministic network can have uncertainty in its weights evidence for multiple actions. As such, we believe it is appropriate to treat the normalized activity of units in the striatal layers as a discrete probability distribution over the set of actions available to the network. We also note that the interpretation of normalized unit activity as encoding probability is common in network models (Hinton &amp; Sejnowski, 1983; Rao 2005; McClelland, 2013) and we now refer to these papers for the basic assumption. Finally, note that the activity of striatal units are closely analogous to actor weights in an algorithmic actor-critic model. In an actor-critic model, actor weights reflect the tendency of the model to select an action but these weights are not constrained by expected value and approximate the probability an action will be selected (via a sigmoidal choice function). The striatal units share this property. As such, we treat the normalized striatal unit activity as an approximation of the discrete probability distribution over the set of actions, not due to a lack of stochasticity in the network.</p><p>It is also important to that the network does have several sources of stochasticity. A noise term is added to the membrane potential of several units, and random initial weights in the network makes this noise have a greater impact than when multiple weights conspire to select the same response. Consequently, noise in the network can cause the network to settle in an attractor that results in a low valued response, even if the weights between the input and striatal layers are larger for units associated with the high-value response. The probability that the network will settle in a sub-optimal attractor will decline as the difference in the input-striatal weight becomes larger for the high value response relative to the low value response.</p><p>We have included the relevant section of the Methods below explaining the relationship between added stochastic noise to membrane potential and behavior:</p><p>“This added noise induces stochasticity in network choices (and their latencies; Ratcliff &amp; Frank 2012) for any given set of synaptic weights, encouraging exploration: […] Together, these sources of variance yield stochastic choice and dynamics within the striatum shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>.”</p><p><italic>One improvement here is that rather than modulating the TAN pause completely via an external and biophysically implausible mechanism the detection of the &quot;uncertainty&quot; is now more biophysical, however if I understood correctly the control of the TAN pause duration is still external and non-biophysical.</italic> </p><p>We apologize for the lack of clarity. We have indeed modeled the control of the TAN pause duration biophysically through the modulation of an accommodation current in TANs by coincident activation of Go units (AND pairs). The accommodation current corresponds to the after-hyperpolarization following the initial TAN burst, and which is thought to contribute to the TAN pause (Wilson and Goldberg, 2006). Thus Go activity accumulates during response selection, modulating accommodation currents, such that their effects on TAN firing are observable once the feedback-related TAN burst triggers the hyperpolarization. We have amended our Methods to clarify how the accommodation current works in the network and its biological basis.</p><p><italic>This is a very complex model, yet it is not biophysically plausible. I have the feelings that the general concepts could be embedded in a much simpler model that would not obscure the main points in a mountain of details, on the other hand if it were truly biophysical it could be more directly compared to experimental results. Therefore, this is neither a clear lucid theory, nor a reasonable computational model.</italic> </p><p>We take the reviewer’s concerns about model complexity and parsimony seriously. Although we maintain that the more complex network is useful – it represents a self-consistent theory about corticostriatal network function that also comprises many previously explored effects which have been repeatedly tested in the literature, including the roles of D1 and D2 neurons in learning and choice incentive, the role of the subthalamic nucleus in online modulation of decision threshold, etc, and now adds the role of the TANs within this network. We feel that cumulative science – building on prior work – is important for modeling. Nevertheless, we appreciate the point that some of the basic functions of the TANS could be captured in a simpler model which does not require all of these dynamics. Although we had already previously included the Bayesian interpretation of the network, which is much simpler, we now supplement this higher level normative description with an intermediate algorithmic RL model, building on our previously described opponent actor learning (OpAL) model which was designed specifically to summarize the functional properties of the neural network in learning and choice. We show that the OpAL model shows the same tradeoffs in learning and reversal as a function of how much the actor weights accumulate, with TANs acting to modulate the decay rate of these actor weights.</p><p>These simulations show that the TAN effects can be summarized with a single parameter, and that varying this parameter with model uncertainty produces the same performance benefit shown in the neural network, and is also paralleled by analogous changes in actor weights. We hope this simplified depiction will appeal to readers who prefer this level of description.</p><p>However, we still believe the complexity in the neural network is useful, over and beyond the above issues related to coherency of a theory of basal ganglia. For example, in the OpAL model, we are unable to directly simulate the well-understood properties of muscarinic receptors. We are able to summarize their effects, but only because we have observed these effects in the more complex neural network in which we are able to directly simulate biophysical properties. The network does make simplifying assumptions that leaves it more biophysically detailed than most striatal RL models but still less biophysically detailed than some other networks that focus on spike timing etc. The level of modeling afforded by our network allows us to ask questions about behavioral dynamics while still incorporating relevant biophysical detail. As such, the three models we have included in the paper addresses the role TANs play in feedback-based learning at different levels of analysis, with the Bayesian learner providing a computational description of the reversal learning problem, the neural network providing a biological implementation and the actor-critic model summarizes the algorithm implemented by the network.</p></body></sub-article></article>