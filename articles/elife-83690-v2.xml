<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN"  "JATS-archivearticle1-3-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn publication-format="electronic" pub-type="epub">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">83690</article-id><article-id pub-id-type="doi">10.7554/eLife.83690</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational and Systems Biology</subject></subj-group></article-categories><title-group><article-title>Metabolic model-based ecological modeling for probiotic design</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-293602"><name><surname>Brunner</surname><given-names>James D</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-8147-2522</contrib-id><email>jdbrunner@lanl.gov</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund2"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" id="author-46523"><name><surname>Chia</surname><given-names>Nicholas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9652-691X</contrib-id><email>chia@anl.gov</email><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01e41cf67</institution-id><institution>Biosciences Division, Los Alamos National Laboratory</institution></institution-wrap><addr-line><named-content content-type="city">Los Alamos</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01e41cf67</institution-id><institution>Center for Nonlinear Studies, Los Alamos National Laboratory</institution></institution-wrap><addr-line><named-content content-type="city">Los Alamos</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05gvnxz63</institution-id><institution>Data Science and Learning, Argonne National Laboratory</institution></institution-wrap><addr-line><named-content content-type="city">Lemont</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Momeni</surname><given-names>Babak</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02n2fzt79</institution-id><institution>Boston College</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Walczak</surname><given-names>Aleksandra M</given-names></name><role>Senior Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a0dhs15</institution-id><institution>École Normale Supérieure - PSL</institution></institution-wrap><country>France</country></aff></contrib></contrib-group><pub-date publication-format="electronic" date-type="publication"><day>21</day><month>02</month><year>2024</year></pub-date><volume>13</volume><elocation-id>e83690</elocation-id><history><date date-type="received" iso-8601-date="2022-09-24"><day>24</day><month>09</month><year>2022</year></date><date date-type="accepted" iso-8601-date="2024-02-19"><day>19</day><month>02</month><year>2024</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2022-10-06"><day>06</day><month>10</month><year>2022</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2210.03198"/></event></pub-history><permissions><copyright-statement>© 2024, Brunner and Chia</copyright-statement><copyright-year>2024</copyright-year><copyright-holder>Brunner and Chia</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-83690-v2.pdf"/><abstract><p>The microbial community composition in the human gut has a profound effect on human health. This observation has lead to extensive use of microbiome therapies, including over-the-counter ‘probiotic’ treatments intended to alter the composition of the microbiome. Despite so much promise and commercial interest, the factors that contribute to the success or failure of microbiome-targeted treatments remain unclear. We investigate the biotic interactions that lead to successful engraftment of a novel bacterial strain introduced to the microbiome as in probiotic treatments. We use pairwise genome-scale metabolic modeling with a generalized resource allocation constraint to build a network of interactions between taxa that appear in an experimental engraftment study. We create induced sub-graphs using the taxa present in individual samples and assess the likelihood of invader engraftment based on network structure. To do so, we use a generalized Lotka-Volterra model, which we show has strong ability to predict if a particular invader or probiotic will successfully engraft into an individual’s microbiome. Furthermore, we show that the mechanistic nature of the model is useful for revealing which microbe-microbe interactions potentially drive engraftment.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd><italic>C. difficile</italic></kwd><kwd><italic>B. longum</italic></kwd><kwd><italic>L. plantarum</italic></kwd><kwd>probiotics</kwd><kwd>genome-scale metabolic modeling</kwd><kwd>microbiome</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id><institution>U.S. Department of Energy</institution></institution-wrap></funding-source><award-id>F255LANL2018</award-id><principal-award-recipient><name><surname>Brunner</surname><given-names>James D</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100008902</institution-id><institution>Los Alamos National Laboratory</institution></institution-wrap></funding-source><award-id>Center For Nonlinear Studies</award-id><principal-award-recipient><name><surname>Brunner</surname><given-names>James D</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000871</institution-id><institution>Mayo Clinic</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Chia</surname><given-names>Nicholas</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Genome-scale metabolic models can be used to predict the engraftment of probiotics.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Microbiome research has come to encompass key areas of disease, ranging from infections (<xref ref-type="bibr" rid="bib2">Antharam et al., 2013</xref>; <xref ref-type="bibr" rid="bib26">Honda and Littman, 2012</xref>; <xref ref-type="bibr" rid="bib3">Battaglioli et al., 2018</xref>) and cancer prevention (<xref ref-type="bibr" rid="bib38">Moss and Blaser, 2005</xref>; <xref ref-type="bibr" rid="bib52">Walther-António et al., 2016</xref>; <xref ref-type="bibr" rid="bib29">Kim et al., 2020</xref>) to systemic immune and neurological responses (<xref ref-type="bibr" rid="bib47">Severance et al., 2016</xref>; <xref ref-type="bibr" rid="bib28">Kang et al., 2014</xref>; <xref ref-type="bibr" rid="bib12">Chen et al., 2016</xref>). The effect of the microbiome on health is now undeniable, and every year in the US over 400,000 people collectively spend $1 billion dollars on over-the-counter probiotics intended to alter their microbiome (<xref ref-type="bibr" rid="bib31">Kristensen et al., 2016</xref>). Many of the purported interactions between microbes and health involve <italic>resident</italic> microbiota and their interactions with the host, i.e., the interface between microbial ecology and human health. The goal of microbiome-targeted interventions is therefore to promote health by ‘restoring and maintaining the microbiota and the crucial health-associated ecosystem services that it provides’ (<xref ref-type="bibr" rid="bib13">Costello et al., 2012</xref>).</p><p>Despite the many links between the microbiome and health, our ability to deploy probiotics to modify the microbiome as intended has been met with relatively little success (<xref ref-type="bibr" rid="bib39">Mullard, 2016</xref>; <xref ref-type="bibr" rid="bib56">Zhu et al., 2019</xref>; <xref ref-type="bibr" rid="bib54">Yuan et al., 2017</xref>; <xref ref-type="bibr" rid="bib55">Zhao et al., 2021</xref>; <xref ref-type="bibr" rid="bib53">Wu et al., 2017</xref>; <xref ref-type="bibr" rid="bib33">Lawson et al., 2019</xref>). Studies looking at the ecological effects of probiotic administration show that administration of a probiotic is not sufficient to alter the community in the desired way. Specifically, engraftment of the administered microbial species is often limited, with only one-third to one-half of patients showing any signs of medium- or long-term engraftment (<xref ref-type="bibr" rid="bib36">Maldonado-Gómez et al., 2016</xref>; <xref ref-type="bibr" rid="bib44">Pudgar et al., 2021</xref>). We offer the argument that probiotic interventions are primarily ecological in nature; their purpose is to reshape the complex microbial communities in our body in beneficial ways. Therefore, to predict whether a probiotic has the desired effects in the gut microbial community, we need more studies examining the ecology of probiotic interventions (<xref ref-type="bibr" rid="bib51">Walter et al., 2018</xref>; <xref ref-type="bibr" rid="bib50">van den Berg et al., 2022</xref>). A mechanistic, personalized approach to probiotic design—one rooted in empirical metabolic data and ecological principles—has the potential to propel the field forward.</p><p>Previous work trying to predict engraftment has been mostly restricted to fecal microbiome transplant (FMT) studies using non-mechanistic classifiers (<xref ref-type="bibr" rid="bib48">Smillie et al., 2018</xref>; <xref ref-type="bibr" rid="bib43">Podlesny et al., 2021</xref>). While potentially predictive, such classifier approaches are sensitive to the underlying assumptions or conditions in which the study is carried out. Because such models are built using statistical methods on data that is assumed to be uniformly collected, these models cannot be generalized to new circumstances. It would be unexpected to see predictions built from patients with diarrhea, undergoing bowel prep, taking antibiotics, and given an FMT accurately predict what happens in patients taking orally administered probiotics. For these reasons, more detailed mechanistic approaches, such as genome-scale metabolic modeling, have been recently explored as more generalizable alternatives (<xref ref-type="bibr" rid="bib23">Heinken et al., 2021a</xref>; <xref ref-type="bibr" rid="bib24">Heinken et al., 2021b</xref>; <xref ref-type="bibr" rid="bib15">Dillard et al., 2021</xref>; <xref ref-type="bibr" rid="bib27">Jenior et al., 2021</xref>).</p><p>The goal of this work is to examine the use of metabolic modeling-informed population dynamic approaches. This builds on top of related work in both constraint-based metabolic modeling and population models such as Lotka-Volterra (LV). It is worth highlighting that the use of dynamic flux balance analysis (FBA) for population models has also been a well-published approach. Despite these successes, there are a number of practical drawbacks for communities of high complexity such as labor-intensive interpretation and high computational complexity.</p><p>Population models such as the generalized LV (gLV) model are popular tools for understanding microbial community dynamics in a mechanistic manner (<xref ref-type="bibr" rid="bib49">Stein et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Friedman et al., 2017</xref>; <xref ref-type="bibr" rid="bib1">Angulo et al., 2019</xref>; <xref ref-type="bibr" rid="bib32">Kuntal et al., 2019</xref>). However, these models are in general difficult to parameterize, with state-of-the-art gradient-matching procedures requiring somewhat dense time-longitudinal data with many replicates (<xref ref-type="bibr" rid="bib10">Bucci et al., 2016</xref>). Furthermore, it has previously been shown that parameters fit from data to these models do not extend to novel environmental situations, and may even change with the addition of a new taxa to the community (<xref ref-type="bibr" rid="bib5">Brunner and Chia, 2019</xref>; <xref ref-type="bibr" rid="bib37">Momeni et al., 2017</xref>). These drawbacks make such mechanistic population models impractical for predicting engraftment. However, by leveraging metabolic modeling we are able to parameterize population models in a way that can be easily adapted to novel environments and does not require dense time-longitudinal data. This allows us to use these models to predict microbial engraftment into a community. See <xref ref-type="fig" rid="fig1">Figure 1</xref> for a comparison of our method with standard parameter fitting.</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Population models such as Lotka-Volterra generally require dense time-longitudinal data to accurately parameterize, and directly fit interactions between species (solid arrow in right panel).</title><p>In this work, we leverage genome-scale metabolic modeling to parameterize population models with only genomic data from a single time-point. This is accomplished by modeling microbial interactions with their shared environment (colored circles in the left panel).</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-fig1-v2.tif"/></fig><p>Genome-scale metabolic models (GSMs) encode the metabolic pathways available in a cell, allowing simulation of cellular metabolism and growth (<xref ref-type="bibr" rid="bib34">Lewis et al., 2012</xref>). These tools have been used extensively to understand and engineer microbial mono-cultures, and have recently begun to be used to understand and predict the composition and metabolic function of microbial communities (<xref ref-type="bibr" rid="bib11">Chan et al., 2017</xref>; <xref ref-type="bibr" rid="bib14">Diener et al., 2020</xref>; <xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>). Community methods using GSMs often suffer from a number of drawbacks. These can include a focus on equilibrium states, high complexity and computational cost, and the difficulty of providing accurate GSMs for each community member. By layering simple, pairwise GSM community modeling with population models, we allow for prediction that includes transient behavior (e.g. how quickly an extinction happens within a community) and reduces computational complexity. The availability of accurate GSMs remains a major difficulty, but we demonstrate that progress can be made using algorithmically generated models from whole genomes.</p><p>In this paper, we present a method to predict engraftment of an invader into a microbial community in the following manner. First, we construct an interaction network of the microbial taxa found in a sample from the community using pairwise FBA with resource allocation constraints (<xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>), which requires a GSM for each taxa. To construct the necessary GSMs, we matched taxa found in the sample to the genomes found in the RefSeq database (<xref ref-type="bibr" rid="bib41">O’Leary et al., 2016</xref>), and used these genomes to build models using ModelSEED (<xref ref-type="bibr" rid="bib46">Seaver et al., 2021</xref>). A complete list of the genomes used can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>. We then simulated pairwise growth using community FBA with growth media adapted from the AGORA genome-scale modeling project (<xref ref-type="bibr" rid="bib25">Heinken et al., 2023</xref>); precise details are available in <italic>S1 Data</italic>.</p><p>After network construction, we make a prediction based off of simulations with the gLV model (<xref ref-type="bibr" rid="bib16">Edelstein-Keshet, 2005</xref>; <xref ref-type="bibr" rid="bib49">Stein et al., 2013</xref>; <xref ref-type="bibr" rid="bib20">Friedman et al., 2017</xref>), and test the model’s predictive potential by predicting the outcomes of microbiome invasion experiments (<xref ref-type="bibr" rid="bib36">Maldonado-Gómez et al., 2016</xref>) from the initial presence/absence of species in each sample. The LV model is widely used, but we found that this model could lead to uncontrolled simulated growth. We therefore also investigated alterations to the LV model that dampen the numerical instability.</p><p>Despite the drawbacks to both population models and GSMs, limitations in our ability to construct high-quality GSMs, and the limited data requirement of our method, our method produces positive predictive value in the scenario in which it was tested. Our method therefore represents a ‘low-budget’ tool that nevertheless can be useful. This success is also evidence that more complex methods that expand on our simple approach could provide great predictive value with a still limited data requirement. Furthermore, we perform two types of sensitivity analysis to demonstrate that the mechanistic nature of the model provides additional insight into the impact of the various components of the network. We perform simulated knock-out experiments to test how sensitive engraftment is to each community member, and we use parameter sensitivity analysis to test how sensitive engraftment is to each network connection.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>Predictive value of the method</title><p>We first examine the ability of our metabolic modeling-based approach to successfully predict engraftment versus non-engraftment for different microbial species introduced orally across different experimental or clinical trial settings. The study that we use to test predictive power, authored by <xref ref-type="bibr" rid="bib36">Maldonado-Gómez et al., 2016</xref>, involved the introduction of candidate probiotic into an established microbial community. In the study, <italic>Bifidobacterium longum</italic> AH1206 was administered as an oral probiotic to 23 subjects, with data available for 22 of these subjects. We predicted engraftment of the candidate probiotic using the ‘baseline’ samples, which were taken before introduction of the probiotic, and the ‘treatment’ samples, which were taken during probiotic administration. We compared our predictions to a binary ‘engrafter’ or ‘non-engrafter’ classification based on cell culture at later time-points.</p><p>As a metric of classification success for the data set, we use the area under the curve of the receiver operator characteristic (AUC-ROC). This metric provides a measure of performance based on the model’s ability to identify true positives while avoiding false positives, so that 1 is perfect classifier performance and o.5 is equivalent to random classification (i.e. flipping a coin for each sample). We used six sets of parameters inferred from joint FBA with different hyperparameters to parameterize the gLV model, and report the resulting predictive value in <xref ref-type="table" rid="table1">Table 1</xref>.</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Area under the receiver operating characteristic curves for our method’s predictions of 22 samples from each of two time-points (TP) using six sets of parameters inferred from joint flux balance analysis (FBA) with six different sets of hyperparameters.</title><p>The first three sets of inferred parameters differ in the ‘resource allocation constraint (RAC)’ in joint FBA. We used values of 35 and 70 for this parameter, as well as using joint FBA without RAC. The next three sets of parameters were inferred using an RAC value of 35 but changes to the model environments. EU average diet (C halved/doubled) had the major carbon sources of the ‘EU average diet’ (D-maltose, sucrose, D-fructose, and D-glucose) halved or doubled in availability, and ‘complete medium’ simulated the availability of any exchangeable metabolite at uniform simulated inflow.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top">Baseline TP (p-value)</th><th align="left" valign="top">Treatment TP (p-value)</th></tr></thead><tbody><tr><td align="left" valign="top">EU average diet (RAC 35)</td><td align="char" char="." valign="top">0.6161 (0.1020)</td><td align="char" char="." valign="top">0.8482 (&lt;0.001)</td></tr><tr><td align="left" valign="top">EU average diet (No RAC)</td><td align="char" char="." valign="top">0.6161 (0.1020)</td><td align="char" char="." valign="top">0.8571 (&lt;0.001)</td></tr><tr><td align="left" valign="top">EU average diet (RAC 70)</td><td align="char" char="." valign="top">0.6429 (0.0741)</td><td align="char" char="." valign="top">0.8482 (&lt;0.001)</td></tr><tr><td align="left" valign="top">EU average diet (C halved)</td><td align="char" char="." valign="top">0.6071 (0.1107)</td><td align="char" char="." valign="top">0.8393 (&lt;0.001)</td></tr><tr><td align="left" valign="top">EU average diet (C doubled)</td><td align="char" char="." valign="top">0.6339 (0.0808)</td><td align="char" char="." valign="top">0.8304 (0.0010)</td></tr><tr><td align="left" valign="top">Complete medium</td><td align="char" char="." valign="top">0.6071 (0.1155)</td><td align="char" char="." valign="top">0.7143 (0.0221)</td></tr></tbody></table></table-wrap><p>Our method showed moderate positive predictive value on predictions from the baseline samples, and good predictive value on predictions made from samples taken during treatment. Improved prediction between baseline and treatment samples suggests that a change in microbiome as a response to the introduction of the probiotic impacts our method. This in turn suggests that our method captures at least part of the underlying biological processes that determine engraftment. Furthermore, these results were mostly robust to choice of hyperparameters, with the exception being that the complete medium showed significantly worse predictive value on the samples taken during treatment.</p><p>In <xref ref-type="fig" rid="fig2">Figure 2</xref>, we show the estimated significance of our results when compared to the null model (720 samples of the null model). We use an approximate ‘edge swapping’ procedure as a null model, which draws interaction parameters randomly from the set of inferred interaction parameters, with replacement. In other words, our null model shuffles the original set of interaction parameters so that any <inline-formula><mml:math id="inf1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> in the null model is some <inline-formula><mml:math id="inf2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> in the inferred parameter set. This ensures that the network of interactions in our null model has the same edge weight distribution as that of our inferred model so that we may test the significance of the interactions inferred, rather than summary statistics such as diversity.</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Comparison of AUC-ROC Between Inferred Parameters &amp; Null Model.</title><p>(<bold>A, B</bold>) The power to predict engraftment versus non-engraftment of the <italic>B</italic>. <italic>longum</italic> probiotic was relatively robust to the joint flux balance analysis (FBA) hyperparameter setup, as shown and measured by the area under the receiver operator characteristic curve (AUC-ROC) (with 1 being perfect classification of engraftment and 0.5 being random). The null model had generally less predictive power than inferred parameters, in particular when predictions were made with samples from the ‘treatment’ time-point. The overall improvement in predictions for the ‘treatment’ time-point vs. the ‘baseline’ time-point suggests that early changes to the microbiome after introduction of a probiotic play a significant role in determining eventual engraftment. p-Values were estimated based on over 1000 samples from a null model.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-fig2-v2.tif"/></fig><p>We also compared our method with two standard machine learning techniques: a support vector machine (SVM) and a random forest (RF) classifier. Unlike our method, which does not use known classifications to ‘learn’ a model, both of these techniques require a ‘training’ set of data in which samples are labeled according to their known classification. We trained these models on 16 of the 22 samples (∼70% of the data), and tested their ability to predict the remaining 6 samples. We repeated this procedure 1000 times with randomly chosen testing/training sets. For both classifiers, we used the relative abundance data of the set of taxa that our model considered, as well as binarized presence/absence version of the data. We did this because our method only considers presence or absence of taxa, rather than relative abundance. The SVM classifier did not outperform random assignment, while the RF classifier performed, on average across train/test splits, about as well as our method. Our method, therefore, provides the same ability to classify unknown samples as an RF classifier without the need for any a priori known sample classifications (<xref ref-type="fig" rid="fig3">Figure 3</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>AUC-ROC of Standard Classifier Predictions.</title><p>(<bold>A</bold>) Our method (horizontal lines) significantly outperformed the support vector machine classifier, which was assessed with 1000 random train/test splits. (<bold>B</bold>) The random forest classifier, also assessed with 1000 train/test splits, performed similarly on average to our method.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-fig3-v2.tif"/></fig></sec><sec id="s2-2"><title>Uniform shifts in interaction parameters</title><p>One consequence of using the gLV model in our method is the possibility of finite-time blow-up in simulation. This happens when one or more taxa approach infinite biomass in finite simulation time. In practice, whenever one or more taxa increase to a level much higher than the initial total biomass of the simulated system, simulation is slowed down and results may be less reliable. There are two simple methods to prevent this from happening. The first is to alter every interaction parameter to be more negative (see <xref ref-type="disp-formula" rid="equ3">Equation 3</xref>), making the system uniformly more antagonistic and less likely to show finite-time blow-up. The second is to include negative self-inhibition (e.g. add <inline-formula><mml:math id="inf3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> parameters [see <xref ref-type="disp-formula" rid="equ4">Equation 4</xref>]).</p><p>We tested both of these alterations by implementing them and computing predictions and the AUC-ROC of those predictions. <xref ref-type="fig" rid="fig4">Figure 4</xref> shows that these changes did not have a significant impact on the performance of our predictions, as long as only antagonism was considered. When we shifted parameters in the positive direction (simulating commensalism or mutualism), finite-time blow-up was more likely and our results were much less stable.</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Effect of Uniform Parameter Shifts in the Lotka-Volterra Model.</title><p>(<bold>A, B</bold>) We altered the generalized Lotka-Volterra model with uniform shifts in parameters which added either antagonism or self-inhibition to the model. We tested self-inhibition with values from 0 to 1 (no self-promotion) and antagonism with values from 1 (complete antagonism) to –1 (complete commensalism), with all <inline-formula><mml:math id="inf4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math></inline-formula>. Neither change had a significant impact on the area under the receiver operator characteristic curve (AUC-ROC) of our method’s predictions, although adding commensalism to the model made the model and resulting predictions much less stable due to increased finite-time blow-up.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-fig4-v2.tif"/></fig></sec><sec id="s2-3"><title>Interpreting mechanism—sensitivity to inferred parameters</title><p>One major advantage to any mechanistic model is that we may measure the sensitivity of our results to perturbations in the model. Here, we investigate the results of perturbing the model of the <italic>B. longum</italic> experiments in two ways: simulating ‘knock-out’ experiments and computing sensitivity to changes in interaction strength.</p><p>First, we simulate knock-out experiments by removing a taxa from the full network of interactions. As a result, this organism will be removed from any sample it was previously present in. We then measure the effect this has on our prediction of <italic>B. longum</italic>’s likelihood of engrafting based on the LV dynamics.</p><p>Next, we measure the sensitivity of <italic>B. longum</italic> growth to each interaction parameter in the LV model. That is, we measure the effect of perturbing each parameter individually on the simulated abundance of <italic>B. longum</italic> at equilibrium according to antagonistic LV dynamics.</p><sec id="s2-3-1"><title>Sensitivity to community members</title><p>In order to investigate how sensitive <italic>B. longum</italic> engraftment is to each of the other species present in any sample of the <italic>B. longum</italic> experimental data set, we simulate ‘knock-out’ experiments and observe the effect this has on our prediction of engraftment. For each simulated knock-out, we removed a taxa from every sample it was present in and repeated our predictive procedure. We recorded the difference in sample score for engraftment of <italic>B. longum</italic> (<xref ref-type="disp-formula" rid="equ2">Equation 2</xref>) as well as the change in AUC-ROC of our set of predictions. We simulated knock-outs for the five most abundant taxa in the data (averaging across samples).</p><p><xref ref-type="table" rid="table2">Table 2</xref> shows the summary statistics of the simulated knock-out experiments. Of the five knock-outs and two sample time-points that we tested, all but one increased predicted engraftment by a slight amount. Interestingly, most of these also increased prediction accuracy slightly, suggesting that the increase in engraftment was more pronounced among the true engrafter samples.</p><table-wrap id="table2" position="float"><label>Table 2.</label><caption><title>We experimented with simulated knock-outs for the top 5 taxa in average abundance in the data.</title><p>The ‘sample proportion’ column gives the proportion of samples in the data set that contain the organism that was knocked out. The ‘average score difference’ is the average effect of the knock-out on our computed engraftment score, with a positive number indicating an average increase in engraftment after knock-out of the organism (implying a negative interaction between the organism and <italic>B. longum)</italic>. The final column shows the impact on our predictions of removing the organism from the analysis.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="bottom"/><th align="left" valign="bottom"/><th align="left" valign="bottom">Sample proportion</th><th align="left" valign="bottom">Average score difference</th><th align="left" valign="bottom">AUC-ROC difference</th></tr></thead><tbody><tr><td align="left" valign="bottom">Baseline TP</td><td align="left" valign="bottom"><italic>Bifidobacterium adolescentis</italic></td><td align="char" char="." valign="bottom">0.954545</td><td align="char" char="." valign="bottom">0.010114</td><td align="char" char="." valign="bottom">0.017857</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Uncultured <italic>Ruminococcus</italic> sp.</td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.012803</td><td align="char" char="." valign="bottom">0.026786</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Uncultured <italic>Clostridium</italic> sp.</td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.006259</td><td align="char" char="." valign="bottom">–0.008929</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>Eubacterium rectale</italic></td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.006183</td><td align="char" char="." valign="bottom">0.017857</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>Faecalibacterium prausnitzii</italic></td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">–0.002250</td><td align="char" char="." valign="bottom">0.000000</td></tr><tr><td align="left" valign="bottom">Treatment TP</td><td align="left" valign="bottom"><italic>B. adolescentis</italic></td><td align="char" char="." valign="bottom">0.954545</td><td align="char" char="." valign="bottom">0.015415</td><td align="char" char="." valign="bottom">0.000000</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Uncultured <italic>Ruminococcus</italic> sp.</td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.016707</td><td align="char" char="." valign="bottom">0.008929</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom">Uncultured <italic>Clostridium</italic> sp.</td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.014424</td><td align="char" char="." valign="bottom">0.017857</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>E. rectale</italic></td><td align="char" char="." valign="bottom">1.000000</td><td align="char" char="." valign="bottom">0.011133</td><td align="char" char="." valign="bottom">0.026786</td></tr><tr><td align="left" valign="bottom"/><td align="left" valign="bottom"><italic>F. prausnitzii</italic></td><td align="char" char="." valign="bottom">0.954545</td><td align="char" char="." valign="bottom">0.013323</td><td align="char" char="." valign="bottom">0.035714</td></tr></tbody></table></table-wrap><p>This experiment demonstrates that incorporating mechanism into prediction can provide useful insight beyond prediction. Because our model considers the network of interactions between microbial taxa, we are able to experiment with the effects of each individual taxa by using simulated experiments like knock-outs.</p></sec><sec id="s2-3-2"><title>Sensitivity to interactions</title><p>Our method is based on the network of interactions between microbial species, which ties together the individual interactions between each pair of species into one complex picture. This means that the interaction between two species unrelated to <italic>B. longum</italic> may have an effect on <italic>B. longum</italic>’s growth. We can compute this effect by computing how <italic>B. longum</italic>’s simulated abundance changes as we vary each parameter. Precisely, we can compute the derivative of <italic>B. longum</italic> with respect to each parameter <inline-formula><mml:math id="inf5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> in the model.</p><p>We computed the sensitivity of our engraftment score to 8 of the interaction parameters in the model, using an RAC value of 35 and the ‘EU average diet’. For each of the baseline and treatment time-point sample sets, we chose the 2 strongest negative and 2 strongest positive interactions that appeared in at least half of all samples, as well as the 2 strongest positive and 2 strongest negative interactions that have <italic>B. longum</italic> as a target (and so act directly on the probiotic) that appeared in at least half of all samples. We observed that engraftment score was very sensitive to all the parameters chosen. In <xref ref-type="table" rid="table3">Table 3</xref>, we show the average sensitivity across the 22 baseline and 22 treatment samples and 8 edges, as well as the average (across edges) variance across the samples. We also include the average (across samples) of the variance in engraftment score across the hyperparameter choices that we tested (with different environmental conditions and RAC values) for comparison. We notice that, in contrast to the model interaction parameters <inline-formula><mml:math id="inf6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, engraftment score was not particularly sensitive to hyperparameter choices.</p><table-wrap id="table3" position="float"><label>Table 3.</label><caption><title>The average sensitivity of engraftment score across 8 parameters and the 22 baseline and 22 treatment samples, as well as the average (across samples) variance across the 8 edges.</title><p>The 8 edges were chosen because they were the 2 strongest positive edges, 2 strongest negative edges, the 2 strongest positive direct edges (i.e. with <italic>B. longum</italic> as a target) and the 2 strongest negative direct edges. Detailed sensitivity results for these 8 edges can be found in <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="top"/><th align="left" valign="top">Baseline time-point</th><th align="left" valign="top">Treatment time-point</th></tr></thead><tbody><tr><td align="left" valign="top">Variance across setups</td><td align="char" char="hyphen" valign="top">4.270608e-06</td><td align="char" char="hyphen" valign="top">2.621430e-05</td></tr><tr><td align="left" valign="top">Average sensitivity (8 tested edges)</td><td align="char" char="plus" valign="top">3.435107e+33</td><td align="char" char="plus" valign="top">7.504735e+10</td></tr><tr><td align="left" valign="top">Variance of sensitivity (8 tested edges)</td><td align="char" char="plus" valign="top">6.250203e+68</td><td align="char" char="plus" valign="top">1.626682e+23</td></tr></tbody></table></table-wrap></sec></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>Our work examines the scenario where the goal of probiotic intervention is a long-lasting alteration of the resident host microbiota. Given that the links between microbes and health have a basis in observations of the resident human microbiota (<xref ref-type="bibr" rid="bib22">Gupta et al., 2020</xref>), one common assumption is that alterations to resident microbiota would impact health outcomes. Along those lines, we demonstrate that genome-scale metabolic modeling can be used in a simple way to predict the outcome of species invasion experiments with minimal study data required. This suggests that GSMs can provide value in understanding microbial community dynamics from cross-sectional microbiome relative abundance profiling.</p><p>Genome-scale metabolic modeling uses genomic data to predict the growth and resource use of a microbial population by considering the entire internal metabolism of the species. This technique can be extended to community modeling in a number of ways (<xref ref-type="bibr" rid="bib58">Zomorrodi and Maranas, 2012</xref>; <xref ref-type="bibr" rid="bib11">Chan et al., 2017</xref>; <xref ref-type="bibr" rid="bib14">Diener et al., 2020</xref>; <xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>; <xref ref-type="bibr" rid="bib21">Frioux et al., 2020</xref>), all with relatively high levels of complexity. Community dynamics can be inferred from GSMs using a model known as dynamic FBA, which uses a GSM for each taxa in the community to infer growth rates and dynamic resource usage (<xref ref-type="bibr" rid="bib6">Brunner and Chia, 2020</xref>). While dynamic FBA provides a complete picture of community dynamics according to GSMs, it represents a very complex model that is difficult to analyze and simulate, and still contains a set of unknown parameters.</p><p>As a limitation, it is worth noting that all GSM-based methods, including our own, are limited to a large extent by the accuracy of the metabolic model reconstructions. Low-quality reconstructions often omit key reactions, or worse, may include reactions that should not have been included. In all cases, this creates the potential for reaction fluxes or interactions that do not reflect reality. Improving the quality of metabolic model reconstruction is the subject of challenging and nuanced research that includes automated pipelines (<xref ref-type="bibr" rid="bib4">Benedict et al., 2014</xref>; <xref ref-type="bibr" rid="bib46">Seaver et al., 2021</xref>; <xref ref-type="bibr" rid="bib18">Faria et al., 2023</xref>) and hand-curation efforts (<xref ref-type="bibr" rid="bib25">Heinken et al., 2023</xref>). These efforts are essential to improve the accuracy of community metabolic modeling, but are beyond the scope of this particular study.</p><p>Here, we present a simpler model—a network of emergent interactions between microbes, whose interaction parameters we can approximate from pairwise genome-scale modeling. The gLV model and other similar microbial network models are popular tools for understanding community dynamics (<xref ref-type="bibr" rid="bib20">Friedman et al., 2017</xref>; <xref ref-type="bibr" rid="bib19">Fisher and Mehta, 2014</xref>; <xref ref-type="bibr" rid="bib1">Angulo et al., 2019</xref>; <xref ref-type="bibr" rid="bib9">Bucci and Xavier, 2014</xref>). Such models are difficult to parameterize for a myriad of reasons. Good parameterization requires relatively dense time-longitudinal data of absolute, rather than relative, community abundance (<xref ref-type="bibr" rid="bib10">Bucci et al., 2016</xref>; <xref ref-type="bibr" rid="bib32">Kuntal et al., 2019</xref>). By taking advantage of GSMs, we provide a parameterized network that does not require any time-longitudinal data. In fact, our method as presented here makes use of previously published GSMs or genomes, meaning that only binary presence/absence information is necessary for a prediction. Additionally, GSMs can be built directly from the genomes found in a sample using automated tools such as <italic>CarveMe</italic> (<xref ref-type="bibr" rid="bib35">Machado et al., 2018</xref>) or ModelSEED (<xref ref-type="bibr" rid="bib46">Seaver et al., 2021</xref>), meaning that our method can be extended to include taxa not found in any database.</p><p>Another strength of our approach is its interpretability. The <italic>B. longum</italic> engraftment analysis provides us with an example motivation, which would be to identify other partner microbes that could improve the responsiveness to the engraftment of a target probiotic. In this instance, we demonstrate how this might be done by quantifying the impact of five high-abundance microbes on <italic>B. longum</italic> engraftment. We see, for example, that <italic>B. adolescentis</italic> has a negative impact on <italic>B. longum</italic> engraftment (simulated knock-outs increased engraftment score), while <italic>F. prausnitzii</italic> has a positive impact on <italic>B. longum</italic> engraftment. Although time consuming, a complete set of simulated knock-out experiments is is readily possible using our method, which could identify the largest positive and negative relationships between specific taxa and <italic>B. longum</italic> engraftment.</p><p>Inspecting the sensitivity of our method’s engraftment score revealed that it is very sensitive to the individual interaction parameters <inline-formula><mml:math id="inf7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> but quite robust to changes in hyperparameters. This suggests that the method is sensitive to the interactions between microbes, while robust to changes in computational and environmental parameters. It also suggests that individual interactions between microorganisms can have an out-sized impact on the downstream composition of a microbial community. This is consistent with the idea that probiotics may have a role in treating human disease by reorganizing the microbiome through the addition of one or a few species.</p><p>Lastly, we note that we have previously shown that species-species interaction modeling, i.e., models built from interactions between microbes, do not capture the complexities of microbial community dynamics that emerge as communities change in composition (<xref ref-type="bibr" rid="bib5">Brunner and Chia, 2019</xref>). Here, we mitigate this shortcoming by determining interaction parameters from pairwise models under specific metabolic conditions, providing limited environmental context to our method. However, it is unlikely that these interactions remain constant as the microbial community manipulates its environment. We conjecture that prediction can be improved by accounting for changes in microbial interaction as the environment changes. In upcoming work (<xref ref-type="bibr" rid="bib7">Brunner et al., 2023</xref>), we demonstrate that dynamic FBA implies that a microbial community behaves according to a discrete sequence of interaction networks over time. Incorporating this dynamic behavior may improve prediction with only a modest increase in model complexity, as long as this sequence of networks can be efficiently determined.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>Our method, as shown in <xref ref-type="fig" rid="fig5">Figure 5</xref>, is based on the generalized Lotka-Volterra model. Using genome-scale metabolic models, we infer interaction parameters from pairwise joint flux balance analysis for all pairs of taxa in a dataset. We then predict engraftment of an invader for each sample by simulating the invasion using the generalized Lotka-Volterra dynamics with the taxa present in the sample.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Schematic of the modeling process.</title><p>In brief, we generate an interaction network of genome-scale models using pairwise joint flux balance analysis. To produce a prediction of engraftment for a given sample, we use the taxa present in the sample to generate an induced sub-graph of the full network. This is then used to define the parameters in the generalized Lotka-Volterra dynamical system to generate a prediction of engraftment.</p></caption><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-fig5-v2.tif"/></fig><sec id="s4-1"><title>Assessing receptivity with the gLV model</title><p>In order to assess how receptive a sub-graph is to an invading taxa, we used the gLV model, which can be associated with any pairwise graph. We simulated the community represented by each sample to equilibrium and scored the performance of the invading taxa by simulated final abundance or time to extinction.</p><p>The gLV model (<xref ref-type="bibr" rid="bib16">Edelstein-Keshet, 2005</xref>) of a community of <inline-formula><mml:math id="inf8"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>N</mml:mi></mml:mstyle></mml:math></inline-formula> species is written as follows:<disp-formula id="equ1"><label>(1)</label><mml:math id="m1"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>Notice that we use a version of this model that assumes an intrinsic growth rate of 1 for each taxa because fitting accurate intrinsic growth rates would require additional data, while we wish to assess the performance of our methods without the need for parameter fitting. Our predictions were based on the equilibrium relative abundance of the target variable (e.g. the variable representing a candidate probiotic) in the dynamical system.</p><p>The gLV model can display an array of behaviors, including multi-stability and chaos. For this reason, we use a Monte-Carlo sampling approach to generating predictions, taking repeated random draws of initial conditions and simulating forward. In our experiments, we used 1000 draws (i.e. we compute 1000 separate ODE so) for each sample. In each trial, we scored the network based on the simulated relative abundance of the invader at some large time <inline-formula><mml:math id="inf9"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi></mml:mstyle></mml:math></inline-formula>. It is possible that the invading taxa either dominates the community (i.e. relative abundance approaches 1) or becomes extinct in our simulation. We take this into account by setting a score as follows:<disp-formula id="equ2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mtext>time to extinction</mml:mtext><mml:mi>T</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mtext>relative abundance at time </mml:mtext><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mtext>time to community dominance</mml:mtext><mml:mi>T</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>for each trial <inline-formula><mml:math id="inf10"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> and averaging over all trials.</p><p>To test changes in the structure of the gLV model and control for possible finite-time blow-up of model solutions, we tested two general alterations to the model. The first is a constant shift of the interaction parameters:<disp-formula id="equ3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>and the second is a shift only in the self-interaction terms:<disp-formula id="equ4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>For both alterations, we used a single constant <inline-formula><mml:math id="inf11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula> across the entire model, and experimented with changes in the value of <inline-formula><mml:math id="inf12"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>c</mml:mi></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-2"><title>Inferring interaction parameters</title><p>To infer the interaction parameters <inline-formula><mml:math id="inf13"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> of the dynamical system, we use a network of interactions implied by a technique known as FBA. FBA is a technique used to predict growth rates of microbes using genome-scale information about their internal metabolisms (<xref ref-type="bibr" rid="bib34">Lewis et al., 2012</xref>). This technique requires a GSM which represents the set of metabolic pathways of a microbe, as well as information about the environmental metabolites available. An optimization problem is then solved to predict a growth rate of the microbe. Similarly, a technique known as ‘joint FBA’ (<xref ref-type="bibr" rid="bib58">Zomorrodi and Maranas, 2012</xref>; <xref ref-type="bibr" rid="bib11">Chan et al., 2017</xref>; <xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>) can be used to estimate growth rates of pairs of microbes using a GSM from each microbe.</p><p>FBA and joint FBA allow us to simulate singleton and pair growth experiments in silico and use the results of these simulated experiments to parameterize our dynamical model. Simulated biomass when grown in a pair was compared to simulated biomass when grown alone in order to determine an implied interaction between microbes. This interaction is then used as a parameter in the dynamical model, which can be conceptualized as an edge in a network of interactions.</p><p>To compute growth simulations, we use joint FBA with a set of resource allocation constraints, which have been shown to improve predictions in pairwise experiments (<xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>). Briefly, joint FBA with resource allocation constraints solves a linear program defined by the GSMs of the community members. The linear program maximizes total community biomass with the standard FBA constraints as well as the added constraints that each microbe grows a fixed known rate (simulating chemostatic equilibrium), that mass is balanced community wide (with inflow and outflow of nutrients), that there is forced leak of nutrients out of the community (introduced by <xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref> to prevent unrealistically efficient cross-feeding), and that each community member’s total internal reaction flux is bounded (the resource allocation constraint). Our problem setup is identical to that described in <xref ref-type="bibr" rid="bib30">Kim et al., 2022</xref>, and we provide Python code to carry out the computation in our supplemental repository.</p><p>To perform joint FBA, simulated inflow of nutrients was determined by medium defined as ‘EU average diet’ by the Virtual Metabolic Human project (<xref ref-type="bibr" rid="bib40">Noronha et al., 2019</xref>; <xref ref-type="bibr" rid="bib17">Ernährungsbericht and Elmadfa, 2012</xref>), with inflow of 10 mmol/day for nutrients not included in the medium but essential for simulated growth. Growth rates of microorganisms were set to be 0.04 g/day, and forced leak of nutrients was set to be 0.1 mmol/day. For our main experiment, we set the RAC constraint to 35 mmol/day as was shown to lead to accurate prediction in Kim et al. We also adjusted this value, as well as the defined medium, in order to assess our method’s robustness to meta-parameters.</p><p>In order to test the impact of joint FBA hyperparameters including medium and resource allocation on our predictions, we also created networks of interaction parameters by performing joint FBA with five alternative sets of hyperparameters. Two of these networks were made with alterations to the RAC constraint we used in computing joint FBA. We computed interactions using an RAC value of 70, which relaxes the constraint on total flux, and without a resource allocation constraint. The final three networks were constructed with different media, simulating differences in the external environment. We constructed a network with the major carbon sources of the ‘EU average diet’ halved in availability, and a second with these carbons doubled. The major carbon sources were taken to be D-maltose, sucrose, D-fructose, and D-glucose. Finally, we computed a network with a ‘complete medium’ in which any exchangeable metabolite for each model was made available with uniform simulated inflow.</p><p>We use the log-ratio of simulated growth in pairs and alone as the implied effect of one microbe on another. That is, if simulated growth of species <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> alone is <inline-formula><mml:math id="inf15"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, and growth of species <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> when coupled in a pair with species <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> is <inline-formula><mml:math id="inf18"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>x</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, we weight the edge from species <inline-formula><mml:math id="inf19"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>j</mml:mi></mml:mstyle></mml:math></inline-formula> to species <inline-formula><mml:math id="inf20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>i</mml:mi></mml:mstyle></mml:math></inline-formula> as<disp-formula id="equ5"> <label>(5)</label><mml:math id="m5"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p>We use the log-ratio because it is the simplest choice of translating simulated data to interaction that accounts for fold-changes. Of course, the simple difference in simulated biomass is another possible choice, but this will be much more sensitive to absolute scaling in simulation, so, for example, slow growing taxa will be biased toward smaller interactions in the network. Furthermore, our in silico growth experiments only provide simulated biomass values at chemostatic equilibrium, meaning that fitting LV parameters directly to these data is an underdetermined problem, particularly when pair growth leads to a simulated extinction.</p><p>We also re-scale our network so that all edge weights are in the interval <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math></inline-formula>, meaning we take as our edge weights<disp-formula id="equ6"><label>(6)</label><mml:math id="m6"><mml:msub><mml:mi>w</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msubsup><mml:mi>w</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow><mml:munder><mml:mo movablelimits="true" form="prefix">max</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">(</mml:mo><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mrow class="MJX-TeXAtom-ORD"><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>This re-scaling is done for computational convenience, and can be viewed as a time re-scaling of the network dynamics which does not effect our predictions. Additionally, we tested the approach after adjusting either all parameters by addition of a single constant value to every <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>, as well as by adjusting the parameters by addition of a single constant value to every self-regulatory parameter <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s4-3"><title>Creation of GSMs</title><p>In order to carry out our analysis, we needed to construct GSMs for the taxa found in the data. To do this, we matched taxa in the data by NCBI taxa ID to genomes in the NCBI RefSeq database (<xref ref-type="bibr" rid="bib41">O’Leary et al., 2016</xref>). We matched taxa to the nearest (by tree distance according to NCBI’s taxonomic database) genome that was listed as ‘Chromosome’ or ‘Complete Genome’, or contained at least 1000 genes. On average, this approach allowed us to perform our experiments with ∼87–88% coverage of each sample. Taxa for which we failed to match a genome were removed from the data, and all analysis was performed on the remaining. For full details on the coverage of each sample, see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>.</p><p>Next, we used the ModelSEED database through ModelSEEDPy (<xref ref-type="bibr" rid="bib46">Seaver et al., 2021</xref>) to reconstruct 390 GSMs for each genome that we matched to the data. All models constructed showed positive 391 simulated growth rates using FBA on the ‘EU average diet’ medium.</p></sec><sec id="s4-4"><title>Prediction and evaluation</title><p>We used data from <xref ref-type="bibr" rid="bib36">Maldonado-Gómez et al., 2016</xref>, in order to test the predictive power of the method. This data consisted of bacterial community composition of fecal samples taken over the course of experiments in which <italic>B. longum</italic> AH1206 was administered as an oral probiotic to 23 subjects, with data available for 22 of these. Subjects were then differentiated into ‘engrafters’ and ‘non-engrafters’ based on the survival of the probiotic strain, as determined by cell culture at later time-points, allowing us to use our method as a classifier. We note that our method ‘learns’ using joint FBA, and so there is no need to split the data into training and testing sets. In fact, the ‘learning’ procedure does not make use of any known sample classifications, as a traditional machine learning algorithm would. This allows us to test our predictions on the entire data set, which provides greater confidence in our results. We made and evaluated predictions using two sets of samples, one taken at a ‘baseline’ time-point before administration of the the probiotic, and one taken at a ‘treatment’ time-point during administration of the probiotic.</p><p>We computed scores for each sample using simulation to time <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle></mml:math></inline-formula>, and varied the discrimination threshold for the binary prediction across the observed values. From this, we computed an ROC curve and its integral (commonly referred to as finding the ‘AUC-ROC’). AUC-ROCs take values in the interval [0, 1] and, in general, an AUC-ROC greater than 0.5 indicates positive predictive value of the model. We compared the AUC-ROC to classification using SVM and RF classification (<xref ref-type="bibr" rid="bib42">Pedregosa et al., 2011</xref>). The SVM and RF classifications were performed using both the relative abundances from the data and binary (presence/absence) forms of the data, which matches our method.</p><p>We estimated the significance of our predictions against predictions from a null model created by parameterizing an LV system from an ‘edge-swapped’ full network. The ‘edge-swapped’ network was constructed by drawing edge weights from the original full network, with replacement, as is commonly done to create a null model in network analysis (<xref ref-type="bibr" rid="bib45">Röttjers et al., 2021</xref>). This approach allows us to create random models that preserve the statistical characteristics of the models that we test on, while changing the specific interactions between taxa. That is, the distribution of the entire set of parameters in the null models <inline-formula><mml:math id="inf25"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mstyle></mml:math></inline-formula> will be approximately the same as the distribution of parameters <inline-formula><mml:math id="inf26"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> determined by joint FBA. Using this null model ensures that our conclusions are drawn from the joint FBA parameter learning method, and not simply a result of simpler characteristics, e.g., total connectedness of the community. We used 1039 samples from the null model to estimate the significance of our results.</p></sec><sec id="s4-5"><title>SVM and RF classification</title><p>We compared the performance of our method to the performance of two traditional machine learning approaches: SVM and RF classifiers. We used 1000-fold cross-validation of the predictions made by these tools (i.e. 1000 independent train/test splits). Each trial consisted of splitting the data randomly into 16 training samples and 6 testing samples, fitting both an SVM and an RF classifier to the training samples using standard Python libraries (from scikit-learn v. 0.23.2; <xref ref-type="bibr" rid="bib42">Pedregosa et al., 2011</xref>), and evaluating the 432 model’s predictions of the testing samples. This was repeated for both the ‘baseline’ and ‘treatment’ sets of samples.</p></sec><sec id="s4-6"><title>Sensitivity to community members and interaction parameters</title><p>We compute <italic>B. longum</italic> AH1206 engraftment predictions using simulated knock-out experiments simply by removing select taxa from the model. The result is a prediction score computed according to <xref ref-type="disp-formula" rid="equ2">Equation 2</xref>. This score can be compared to the non-knock-out experiment score to determine if the knock-out increased or decreased the predicted probability of <italic>B. longum</italic> engraftment. We compute and report the relative change in predicted engraftment score as<disp-formula id="equ7"><label>(7)</label><mml:math id="m7"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>score with knock-out taxa removed</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>score with knock-out taxa included</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>score with knock-out taxa included</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>We compute the sensitivity of <italic>B. longum</italic>’s growth to an interaction parameter <inline-formula><mml:math id="inf27"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msub><mml:mi>β</mml:mi><mml:mrow class="MJX-TeXAtom-ORD"><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:math></inline-formula> directly by using the chain rule (see, for example, <xref ref-type="bibr" rid="bib57">Zi, 2011</xref>). This has the following form:<disp-formula id="equ8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mi mathvariant="normal">∂</mml:mi><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:mrow></mml:math></disp-formula></p><p><xref ref-type="disp-formula" rid="equ8">Equation 8</xref> allows us to solve a system of differential equations to determine the sensitivity of invader growth to that parameter. We solve this system of equations to a large time <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle></mml:math></inline-formula> and report the weighted average of some late-time interval <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mstyle></mml:math></inline-formula>, with later time-points weighted more heavily, using the final 40 simulation time-points.</p></sec></sec></body><back><sec sec-type="additional-information" id="s5"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>is an employee of Triad National Security, LLC</p></fn><fn fn-type="COI-statement" id="conf2"><p>is an employee of UChicago Argonne, LLC</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Software, Formal analysis, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Resources, Formal analysis, Supervision, Funding acquisition, Investigation, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn></fn-group></sec><sec sec-type="supplementary-material" id="s6"><title>Additional files</title><supplementary-material id="mdar"><label>MDAR checklist</label><media xlink:href="elife-83690-mdarchecklist1-v2.pdf" mimetype="application" mime-subtype="pdf"/></supplementary-material><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Supplementary tables.</title><p>(<bold>Relative_Abundance_Table</bold>) Relative abundance of each taxa in each sample in the data-set, product of Bracken analysis on original data. (<bold>RefSeq_Genomes_Used</bold>) Genomes matched to taxa in data from RefSeq database, used to create models. (<bold>Taxa_Names</bold>) Names of taxa in the data, matched with Taxa ID. (<bold>Baseline_Sample_Coverage</bold>) Coverage (as proportion of relative abundance) of models used in analysis of Baseline time point samples (i.e. taxa for which we could identify a high quality close match genome). (<bold>Treatment_Sample_Coverage</bold>) Coverage (as proportion of relative abundance) of models used in analysis of Treatment time point samples (i.e. taxa for which we could identify a high quality close match genome). (<bold>EU_Average_Diet</bold>) Main media file used, from vmh.life. (<bold>Probiotic_Cell_Counts</bold>) Cell counts of <italic>B. longum</italic> probiotic, provided by Maldonado-Gomez et al. (<bold>Paramater_Sensitivity</bold>) Summary of parameter sensitivity results (average and variance across samples). (<bold>Baseline_Sample_Sensitivity</bold>) Parameter sensitivity in baseline time-point samples (2 strongest positive and 2 strongest negative edges, 2 strongest positive and 2 strongest negative edges with <italic>B. longum</italic> as target). (<bold>Treatment_Sample_Sensitivity</bold>) Parameter sensitivity in treatment time-point samples (2 strongest positive and 2 strongest negative edges, 2 strongest positive and 2 strongest negative edges with <italic>B. longum</italic> as target).</p></caption><media xlink:href="elife-83690-supp1-v2.xlsx" mimetype="application" mime-subtype="xlsx"/></supplementary-material></sec><sec sec-type="data-availability" id="s7"><title>Data availability</title><p>Data from the study that we used to evaluate our method can be found at the following source: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA324129/">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA324129/</ext-link> (<xref ref-type="bibr" rid="bib36">Maldonado-Gómez et al., 2016</xref>). Our method is implemented as the friendlyNets package, available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/lanl/friendlyNets">https://github.com/lanl/friendlyNets</ext-link> (copy archived at <xref ref-type="bibr" rid="bib8">Brunner, 2024</xref>) along with re-formatted data and python scripts for the analysis found in this paper.</p><p>The following previously published dataset was used:</p><p><element-citation publication-type="data" specific-use="references" id="dataset1"><person-group person-group-type="author"><name><surname>Maldonado-Gómez</surname><given-names>MX</given-names></name><name><surname>Martínez</surname><given-names>I</given-names></name><name><surname>Bottacini</surname><given-names>F</given-names></name><name><surname>O'Callaghan</surname><given-names>A</given-names></name><name><surname>Ventura</surname><given-names>M</given-names></name><name><surname>van Sinderen</surname><given-names>D</given-names></name><name><surname>Hillmann</surname><given-names>B</given-names></name><name><surname>Vangay</surname><given-names>P</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Hutkins</surname><given-names>RW</given-names></name><name><surname>Walter</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><data-title>Human fecal microbiome before and after consumption of AH1206 - Raw sequence reads</data-title><source>NCBI BioProject</source><pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA324129">PRJNA324129</pub-id></element-citation></p></sec><ack id="ack"><title>Acknowledgements</title><p>The authors would like to thank Dr. Marie Kroeger for her thoughtful comments in helping to prepare this article. JB was supported in this work by the US Department of Energy, Office of Science, Biological and Environmental Research Division using Award number F255LANL2018 and the Los Alamos National Laboratory Center for Nonlinear Studies. This study was partially supported by funds from Mayo Clinic’s Center for Individualized Medicine.</p></ack><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angulo</surname><given-names>MT</given-names></name><name><surname>Moog</surname><given-names>CH</given-names></name><name><surname>Liu</surname><given-names>YY</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>A theoretical framework for controlling complex microbial communities</article-title><source>Nature Communications</source><volume>10</volume><elocation-id>1045</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-019-08890-y</pub-id><pub-id pub-id-type="pmid">30837457</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antharam</surname><given-names>VC</given-names></name><name><surname>Li</surname><given-names>EC</given-names></name><name><surname>Ishmael</surname><given-names>A</given-names></name><name><surname>Sharma</surname><given-names>A</given-names></name><name><surname>Mai</surname><given-names>V</given-names></name><name><surname>Rand</surname><given-names>KH</given-names></name><name><surname>Wang</surname><given-names>GP</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Intestinal dysbiosis and depletion of butyrogenic bacteria in Clostridium difficile infection and nosocomial diarrhea</article-title><source>Journal of Clinical Microbiology</source><volume>51</volume><fpage>2884</fpage><lpage>2892</lpage><pub-id pub-id-type="doi">10.1128/JCM.00845-13</pub-id><pub-id pub-id-type="pmid">23804381</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Battaglioli</surname><given-names>EJ</given-names></name><name><surname>Hale</surname><given-names>VL</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Jeraldo</surname><given-names>P</given-names></name><name><surname>Ruiz-Mojica</surname><given-names>C</given-names></name><name><surname>Schmidt</surname><given-names>BA</given-names></name><name><surname>Rekdal</surname><given-names>VM</given-names></name><name><surname>Till</surname><given-names>LM</given-names></name><name><surname>Huq</surname><given-names>L</given-names></name><name><surname>Smits</surname><given-names>SA</given-names></name><name><surname>Moor</surname><given-names>WJ</given-names></name><name><surname>Jones-Hall</surname><given-names>Y</given-names></name><name><surname>Smyrk</surname><given-names>T</given-names></name><name><surname>Khanna</surname><given-names>S</given-names></name><name><surname>Pardi</surname><given-names>DS</given-names></name><name><surname>Grover</surname><given-names>M</given-names></name><name><surname>Patel</surname><given-names>R</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Nelson</surname><given-names>H</given-names></name><name><surname>Sonnenburg</surname><given-names>JL</given-names></name><name><surname>Farrugia</surname><given-names>G</given-names></name><name><surname>Kashyap</surname><given-names>PC</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title><italic>Clostridioides difficile</italic> uses amino acids associated with gut microbial dysbiosis in a subset of patients with diarrhea</article-title><source>Science Translational Medicine</source><volume>10</volume><elocation-id>eaam7019</elocation-id><pub-id pub-id-type="doi">10.1126/scitranslmed.aam7019</pub-id><pub-id pub-id-type="pmid">30355801</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benedict</surname><given-names>MN</given-names></name><name><surname>Mundy</surname><given-names>MB</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Price</surname><given-names>ND</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Likelihood-based gene annotations for gap filling and quality assessment in genome-scale metabolic models</article-title><source>PLOS Computational Biology</source><volume>10</volume><elocation-id>e1003882</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003882</pub-id><pub-id pub-id-type="pmid">25329157</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>JD</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Metabolite-mediated modelling of microbial community dynamics captures emergent behaviour more effectively than species-species modelling</article-title><source>Journal of the Royal Society, Interface</source><volume>16</volume><elocation-id>20190423</elocation-id><pub-id pub-id-type="doi">10.1098/rsif.2019.0423</pub-id><pub-id pub-id-type="pmid">31640497</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>JD</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Minimizing the number of optimizations for efficient community dynamic flux balance analysis</article-title><source>PLOS Computational Biology</source><volume>16</volume><elocation-id>e1007786</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007786</pub-id><pub-id pub-id-type="pmid">32991583</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>JD</given-names></name><name><surname>Gallegos-Graves</surname><given-names>LA</given-names></name><name><surname>Kroeger</surname><given-names>ME</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Inferring microbial interactions with their environment from genomic and metagenomic data</article-title><source>PLOS Computational Biology</source><volume>19</volume><elocation-id>e1011661</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1011661</pub-id><pub-id pub-id-type="pmid">37956203</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Brunner</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2024">2024</year><data-title>friendlyNets</data-title><version designator="swh:1:rev:9727a80584335699a718e7cdd7d881fad3e1c585">swh:1:rev:9727a80584335699a718e7cdd7d881fad3e1c585</version><source>Software Heritage</source><ext-link ext-link-type="uri" xlink:href="https://archive.softwareheritage.org/swh:1:dir:5e8c53bbfa9c2eebe0793edaafd85762a717d834;origin=https://github.com/lanl/friendlyNets;visit=swh:1:snp:9b2c0b26154b188b8e43198c6ae25a4b00b0593b;anchor=swh:1:rev:9727a80584335699a718e7cdd7d881fad3e1c585">https://archive.softwareheritage.org/swh:1:dir:5e8c53bbfa9c2eebe0793edaafd85762a717d834;origin=https://github.com/lanl/friendlyNets;visit=swh:1:snp:9b2c0b26154b188b8e43198c6ae25a4b00b0593b;anchor=swh:1:rev:9727a80584335699a718e7cdd7d881fad3e1c585</ext-link></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bucci</surname><given-names>V</given-names></name><name><surname>Xavier</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Towards predictive models of the human gut microbiome</article-title><source>Journal of Molecular Biology</source><volume>426</volume><fpage>3907</fpage><lpage>3916</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2014.03.017</pub-id><pub-id pub-id-type="pmid">24727124</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bucci</surname><given-names>V</given-names></name><name><surname>Tzen</surname><given-names>B</given-names></name><name><surname>Li</surname><given-names>N</given-names></name><name><surname>Simmons</surname><given-names>M</given-names></name><name><surname>Tanoue</surname><given-names>T</given-names></name><name><surname>Bogart</surname><given-names>E</given-names></name><name><surname>Deng</surname><given-names>L</given-names></name><name><surname>Yeliseyev</surname><given-names>V</given-names></name><name><surname>Delaney</surname><given-names>ML</given-names></name><name><surname>Liu</surname><given-names>Q</given-names></name><name><surname>Olle</surname><given-names>B</given-names></name><name><surname>Stein</surname><given-names>RR</given-names></name><name><surname>Honda</surname><given-names>K</given-names></name><name><surname>Bry</surname><given-names>L</given-names></name><name><surname>Gerber</surname><given-names>GK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>MDSINE: microbial dynamical systems inference engine for microbiome time-series analyses</article-title><source>Genome Biology</source><volume>17</volume><elocation-id>121</elocation-id><pub-id pub-id-type="doi">10.1186/s13059-016-0980-6</pub-id><pub-id pub-id-type="pmid">27259475</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chan</surname><given-names>SHJ</given-names></name><name><surname>Simons</surname><given-names>MN</given-names></name><name><surname>Maranas</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>SteadyCom: Predicting microbial abundances while ensuring community stability</article-title><source>PLOS Computational Biology</source><volume>13</volume><elocation-id>e1005539</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005539</pub-id><pub-id pub-id-type="pmid">28505184</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Kalari</surname><given-names>KR</given-names></name><name><surname>Yao</surname><given-names>JZ</given-names></name><name><surname>Novotna</surname><given-names>M</given-names></name><name><surname>Paz Soldan</surname><given-names>MM</given-names></name><name><surname>Luckey</surname><given-names>DH</given-names></name><name><surname>Marietta</surname><given-names>EV</given-names></name><name><surname>Jeraldo</surname><given-names>PR</given-names></name><name><surname>Chen</surname><given-names>X</given-names></name><name><surname>Weinshenker</surname><given-names>BG</given-names></name><name><surname>Rodriguez</surname><given-names>M</given-names></name><name><surname>Kantarci</surname><given-names>OH</given-names></name><name><surname>Nelson</surname><given-names>H</given-names></name><name><surname>Murray</surname><given-names>JA</given-names></name><name><surname>Mangalam</surname><given-names>AK</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Multiple sclerosis patients have a distinct gut microbiota compared to healthy controls</article-title><source>Scientific Reports</source><volume>6</volume><fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="doi">10.1038/srep28484</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Costello</surname><given-names>EK</given-names></name><name><surname>Stagaman</surname><given-names>K</given-names></name><name><surname>Dethlefsen</surname><given-names>L</given-names></name><name><surname>Bohannan</surname><given-names>BJM</given-names></name><name><surname>Relman</surname><given-names>DA</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The application of ecological theory toward an understanding of the human microbiome</article-title><source>Science</source><volume>336</volume><fpage>1255</fpage><lpage>1262</lpage><pub-id pub-id-type="doi">10.1126/science.1224203</pub-id><pub-id pub-id-type="pmid">22674335</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diener</surname><given-names>C</given-names></name><name><surname>Gibbons</surname><given-names>SM</given-names></name><name><surname>Resendis-Antonio</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>MICOM: metagenome-scale modeling to infer metabolic interactions in the gut microbiota</article-title><source>mSystems</source><volume>5</volume><elocation-id>e00606-19</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00606-19</pub-id><pub-id pub-id-type="pmid">31964767</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dillard</surname><given-names>LR</given-names></name><name><surname>Payne</surname><given-names>DD</given-names></name><name><surname>Papin</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Mechanistic models of microbial community metabolism</article-title><source>Molecular Omics</source><volume>17</volume><fpage>365</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1039/d0mo00154f</pub-id><pub-id pub-id-type="pmid">34125127</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Edelstein-Keshet</surname><given-names>L</given-names></name></person-group><year iso-8601-date="2005">2005</year><source>Mathematical Models in Biology</source><publisher-name>SIAM</publisher-name><pub-id pub-id-type="doi">10.1137/1.9780898719147</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="report"><person-group person-group-type="author"><name><surname>Ernährungsbericht</surname><given-names>Ö</given-names></name><name><surname>Elmadfa</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2012">2012</year><source>Austrian nutrition report</source><publisher-name>University of Vienna</publisher-name></element-citation></ref><ref id="bib18"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Faria</surname><given-names>JP</given-names></name><name><surname>Liu</surname><given-names>F</given-names></name><name><surname>Edirisinghe</surname><given-names>JN</given-names></name><name><surname>Gupta</surname><given-names>N</given-names></name><name><surname>Seaver</surname><given-names>SMD</given-names></name><name><surname>Freiburger</surname><given-names>AP</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Weisenhorn</surname><given-names>P</given-names></name><name><surname>Conrad</surname><given-names>N</given-names></name><name><surname>Zarecki</surname><given-names>R</given-names></name><name><surname>Song</surname><given-names>H-S</given-names></name><name><surname>DeJongh</surname><given-names>M</given-names></name><name><surname>Best</surname><given-names>AA</given-names></name><name><surname>Cottingham</surname><given-names>RW</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>ModelSEED v2: High-Throughput Genome-Scale Metabolic Model Reconstruction with Enhanced Energy Biosynthesis Pathway Prediction</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/2023.10.04.556561</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>CK</given-names></name><name><surname>Mehta</surname><given-names>P</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Identifying keystone species in the human gut microbiome from metagenomic timeseries using sparse linear regression</article-title><source>PLOS ONE</source><volume>9</volume><elocation-id>e102451</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0102451</pub-id><pub-id pub-id-type="pmid">25054627</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Higgins</surname><given-names>LM</given-names></name><name><surname>Gore</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Community structure follows simple assembly rules in microbial microcosms</article-title><source>Nature Ecology &amp; Evolution</source><volume>1</volume><elocation-id>109</elocation-id><pub-id pub-id-type="doi">10.1038/s41559-017-0109</pub-id><pub-id pub-id-type="pmid">28812687</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frioux</surname><given-names>C</given-names></name><name><surname>Singh</surname><given-names>D</given-names></name><name><surname>Korcsmaros</surname><given-names>T</given-names></name><name><surname>Hildebrand</surname><given-names>F</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>From bag-of-genes to bag-of-genomes: metabolic modelling of communities in the era of metagenome-assembled genomes</article-title><source>Computational and Structural Biotechnology Journal</source><volume>18</volume><fpage>1722</fpage><lpage>1734</lpage><pub-id pub-id-type="doi">10.1016/j.csbj.2020.06.028</pub-id><pub-id pub-id-type="pmid">32670511</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gupta</surname><given-names>VK</given-names></name><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Bakshi</surname><given-names>U</given-names></name><name><surname>Cunningham</surname><given-names>KY</given-names></name><name><surname>Davis</surname><given-names>JM</given-names></name><name><surname>Lazaridis</surname><given-names>KN</given-names></name><name><surname>Nelson</surname><given-names>H</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Sung</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>A predictive index for health status using species-level gut microbiome profiling</article-title><source>Nature Communications</source><volume>11</volume><elocation-id>4635</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-020-18476-8</pub-id><pub-id pub-id-type="pmid">32934239</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Basile</surname><given-names>A</given-names></name><name><surname>Hertel</surname><given-names>J</given-names></name><name><surname>Thinnes</surname><given-names>C</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021a</year><article-title>Genome-scale metabolic modeling of the human microbiome in the era of personalized medicine</article-title><source>Annual Review of Microbiology</source><volume>75</volume><fpage>199</fpage><lpage>222</lpage><pub-id pub-id-type="doi">10.1146/annurev-micro-060221-012134</pub-id><pub-id pub-id-type="pmid">34314593</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Basile</surname><given-names>A</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2021">2021b</year><article-title>Advances in constraint-based modelling of microbial communities</article-title><source>Current Opinion in Systems Biology</source><volume>27</volume><elocation-id>100346</elocation-id><pub-id pub-id-type="doi">10.1016/j.coisb.2021.05.007</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Hertel</surname><given-names>J</given-names></name><name><surname>Acharya</surname><given-names>G</given-names></name><name><surname>Ravcheev</surname><given-names>DA</given-names></name><name><surname>Nyga</surname><given-names>M</given-names></name><name><surname>Okpala</surname><given-names>OE</given-names></name><name><surname>Hogan</surname><given-names>M</given-names></name><name><surname>Magnúsdóttir</surname><given-names>S</given-names></name><name><surname>Martinelli</surname><given-names>F</given-names></name><name><surname>Nap</surname><given-names>B</given-names></name><name><surname>Preciat</surname><given-names>G</given-names></name><name><surname>Edirisinghe</surname><given-names>JN</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name><name><surname>Fleming</surname><given-names>RMT</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2023">2023</year><article-title>Genome-scale metabolic reconstruction of 7,302 human microorganisms for personalized medicine</article-title><source>Nature Biotechnology</source><volume>41</volume><fpage>1320</fpage><lpage>1331</lpage><pub-id pub-id-type="doi">10.1038/s41587-022-01628-0</pub-id><pub-id pub-id-type="pmid">36658342</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Honda</surname><given-names>K</given-names></name><name><surname>Littman</surname><given-names>DR</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>The microbiome in infectious disease and inflammation</article-title><source>Annual Review of Immunology</source><volume>30</volume><fpage>759</fpage><lpage>795</lpage><pub-id pub-id-type="doi">10.1146/annurev-immunol-020711-074937</pub-id><pub-id pub-id-type="pmid">22224764</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenior</surname><given-names>ML</given-names></name><name><surname>Leslie</surname><given-names>JL</given-names></name><name><surname>Powers</surname><given-names>DA</given-names></name><name><surname>Garrett</surname><given-names>EM</given-names></name><name><surname>Walker</surname><given-names>KA</given-names></name><name><surname>Dickenson</surname><given-names>ME</given-names></name><name><surname>Petri</surname><given-names>WA</given-names></name><name><surname>Tamayo</surname><given-names>R</given-names></name><name><surname>Papin</surname><given-names>JA</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Novel drivers of virulence in clostridioides difficile identified via context-specific metabolic network analysis</article-title><source>mSystems</source><volume>6</volume><elocation-id>e0091921</elocation-id><pub-id pub-id-type="doi">10.1128/mSystems.00919-21</pub-id><pub-id pub-id-type="pmid">34609164</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>SS</given-names></name><name><surname>Jeraldo</surname><given-names>PR</given-names></name><name><surname>Kurti</surname><given-names>A</given-names></name><name><surname>Miller</surname><given-names>MEB</given-names></name><name><surname>Cook</surname><given-names>MD</given-names></name><name><surname>Whitlock</surname><given-names>K</given-names></name><name><surname>Goldenfeld</surname><given-names>N</given-names></name><name><surname>Woods</surname><given-names>JA</given-names></name><name><surname>White</surname><given-names>BA</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Fryer</surname><given-names>JD</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Diet and exercise orthogonally alter the gut microbiome and reveal independent associations with anxiety and cognition</article-title><source>Molecular Neurodegeneration</source><volume>9</volume><fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="doi">10.1186/1750-1326-9-36</pub-id><pub-id pub-id-type="pmid">25217888</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Vogtmann</surname><given-names>E</given-names></name><name><surname>Ahlquist</surname><given-names>DA</given-names></name><name><surname>Devens</surname><given-names>ME</given-names></name><name><surname>Kisiel</surname><given-names>JB</given-names></name><name><surname>Taylor</surname><given-names>WR</given-names></name><name><surname>White</surname><given-names>BA</given-names></name><name><surname>Hale</surname><given-names>VL</given-names></name><name><surname>Sung</surname><given-names>J</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Sinha</surname><given-names>R</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Fecal metabolomic signatures in colorectal adenoma patients are associated with gut microbiota and early events of colorectal cancer pathogenesis</article-title><source>mBio</source><volume>11</volume><elocation-id>e03186-19</elocation-id><pub-id pub-id-type="doi">10.1128/mBio.03186-19</pub-id><pub-id pub-id-type="pmid">32071266</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Sung</surname><given-names>J</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Resource-allocation constraint governs structure and function of microbial communities in metabolic modeling</article-title><source>Metabolic Engineering</source><volume>70</volume><fpage>12</fpage><lpage>22</lpage><pub-id pub-id-type="doi">10.1016/j.ymben.2021.12.011</pub-id><pub-id pub-id-type="pmid">34990848</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname><given-names>NB</given-names></name><name><surname>Bryrup</surname><given-names>T</given-names></name><name><surname>Allin</surname><given-names>KH</given-names></name><name><surname>Nielsen</surname><given-names>T</given-names></name><name><surname>Hansen</surname><given-names>TH</given-names></name><name><surname>Pedersen</surname><given-names>O</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Alterations in fecal microbiota composition by probiotic supplementation in healthy adults: a systematic review of randomized controlled trials</article-title><source>Genome Medicine</source><volume>8</volume><elocation-id>52</elocation-id><pub-id pub-id-type="doi">10.1186/s13073-016-0300-5</pub-id><pub-id pub-id-type="pmid">27159972</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuntal</surname><given-names>BK</given-names></name><name><surname>Gadgil</surname><given-names>C</given-names></name><name><surname>Mande</surname><given-names>SS</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Web-gLV: a web based platform for lotka-volterra based modeling and simulation of microbial populations</article-title><source>Frontiers in Microbiology</source><volume>10</volume><elocation-id>288</elocation-id><pub-id pub-id-type="doi">10.3389/fmicb.2019.00288</pub-id><pub-id pub-id-type="pmid">30846976</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawson</surname><given-names>CE</given-names></name><name><surname>Harcombe</surname><given-names>WR</given-names></name><name><surname>Hatzenpichler</surname><given-names>R</given-names></name><name><surname>Lindemann</surname><given-names>SR</given-names></name><name><surname>Löffler</surname><given-names>FE</given-names></name><name><surname>O’Malley</surname><given-names>MA</given-names></name><name><surname>García Martín</surname><given-names>H</given-names></name><name><surname>Pfleger</surname><given-names>BF</given-names></name><name><surname>Raskin</surname><given-names>L</given-names></name><name><surname>Venturelli</surname><given-names>OS</given-names></name><name><surname>Weissbrodt</surname><given-names>DG</given-names></name><name><surname>Noguera</surname><given-names>DR</given-names></name><name><surname>McMahon</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Common principles and best practices for engineering microbiomes</article-title><source>Nature Reviews. Microbiology</source><volume>17</volume><fpage>725</fpage><lpage>741</lpage><pub-id pub-id-type="doi">10.1038/s41579-019-0255-9</pub-id><pub-id pub-id-type="pmid">31548653</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewis</surname><given-names>NE</given-names></name><name><surname>Nagarajan</surname><given-names>H</given-names></name><name><surname>Palsson</surname><given-names>BO</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>Constraining the metabolic genotype-phenotype relationship using a phylogeny of in silico methods</article-title><source>Nature Reviews. Microbiology</source><volume>10</volume><fpage>291</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1038/nrmicro2737</pub-id><pub-id pub-id-type="pmid">22367118</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Machado</surname><given-names>D</given-names></name><name><surname>Andrejev</surname><given-names>S</given-names></name><name><surname>Tramontano</surname><given-names>M</given-names></name><name><surname>Patil</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Fast automated reconstruction of genome-scale metabolic models for microbial species and communities</article-title><source>Nucleic Acids Research</source><volume>46</volume><fpage>7542</fpage><lpage>7553</lpage><pub-id pub-id-type="doi">10.1093/nar/gky537</pub-id><pub-id pub-id-type="pmid">30192979</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maldonado-Gómez</surname><given-names>MX</given-names></name><name><surname>Martínez</surname><given-names>I</given-names></name><name><surname>Bottacini</surname><given-names>F</given-names></name><name><surname>O’Callaghan</surname><given-names>A</given-names></name><name><surname>Ventura</surname><given-names>M</given-names></name><name><surname>van Sinderen</surname><given-names>D</given-names></name><name><surname>Hillmann</surname><given-names>B</given-names></name><name><surname>Vangay</surname><given-names>P</given-names></name><name><surname>Knights</surname><given-names>D</given-names></name><name><surname>Hutkins</surname><given-names>RW</given-names></name><name><surname>Walter</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Stable engraftment of bifidobacterium longum AH1206 in the human gut depends on individualized features of the resident microbiome</article-title><source>Cell Host &amp; Microbe</source><volume>20</volume><fpage>515</fpage><lpage>526</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2016.09.001</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Momeni</surname><given-names>B</given-names></name><name><surname>Xie</surname><given-names>L</given-names></name><name><surname>Shou</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Lotka-Volterra pairwise modeling fails to capture diverse pairwise microbial interactions</article-title><source>eLife</source><volume>6</volume><elocation-id>e25051</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.25051</pub-id><pub-id pub-id-type="pmid">28350295</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moss</surname><given-names>SF</given-names></name><name><surname>Blaser</surname><given-names>MJ</given-names></name></person-group><year iso-8601-date="2005">2005</year><article-title>Mechanisms of disease: Inflammation and the origins of cancer</article-title><source>Nature Clinical Practice. Oncology</source><volume>2</volume><fpage>90</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1038/ncponc0081</pub-id><pub-id pub-id-type="pmid">16264881</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mullard</surname><given-names>A</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Leading microbiome-based therapeutic falters in Phase II trial</article-title><source>Nature Reviews Drug Discovery</source><volume>15</volume><elocation-id>595</elocation-id><pub-id pub-id-type="doi">10.1038/nrd.2016.181</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noronha</surname><given-names>A</given-names></name><name><surname>Modamio</surname><given-names>J</given-names></name><name><surname>Jarosz</surname><given-names>Y</given-names></name><name><surname>Guerard</surname><given-names>E</given-names></name><name><surname>Sompairac</surname><given-names>N</given-names></name><name><surname>Preciat</surname><given-names>G</given-names></name><name><surname>Daníelsdóttir</surname><given-names>AD</given-names></name><name><surname>Krecke</surname><given-names>M</given-names></name><name><surname>Merten</surname><given-names>D</given-names></name><name><surname>Haraldsdóttir</surname><given-names>HS</given-names></name><name><surname>Heinken</surname><given-names>A</given-names></name><name><surname>Heirendt</surname><given-names>L</given-names></name><name><surname>Magnúsdóttir</surname><given-names>S</given-names></name><name><surname>Ravcheev</surname><given-names>DA</given-names></name><name><surname>Sahoo</surname><given-names>S</given-names></name><name><surname>Gawron</surname><given-names>P</given-names></name><name><surname>Friscioni</surname><given-names>L</given-names></name><name><surname>Garcia</surname><given-names>B</given-names></name><name><surname>Prendergast</surname><given-names>M</given-names></name><name><surname>Puente</surname><given-names>A</given-names></name><name><surname>Rodrigues</surname><given-names>M</given-names></name><name><surname>Roy</surname><given-names>A</given-names></name><name><surname>Rouquaya</surname><given-names>M</given-names></name><name><surname>Wiltgen</surname><given-names>L</given-names></name><name><surname>Žagare</surname><given-names>A</given-names></name><name><surname>John</surname><given-names>E</given-names></name><name><surname>Krueger</surname><given-names>M</given-names></name><name><surname>Kuperstein</surname><given-names>I</given-names></name><name><surname>Zinovyev</surname><given-names>A</given-names></name><name><surname>Schneider</surname><given-names>R</given-names></name><name><surname>Fleming</surname><given-names>RMT</given-names></name><name><surname>Thiele</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The Virtual Metabolic Human database: integrating human and gut microbiome metabolism with nutrition and disease</article-title><source>Nucleic Acids Research</source><volume>47</volume><fpage>D614</fpage><lpage>D624</lpage><pub-id pub-id-type="doi">10.1093/nar/gky992</pub-id><pub-id pub-id-type="pmid">30371894</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O’Leary</surname><given-names>NA</given-names></name><name><surname>Wright</surname><given-names>MW</given-names></name><name><surname>Brister</surname><given-names>JR</given-names></name><name><surname>Ciufo</surname><given-names>S</given-names></name><name><surname>Haddad</surname><given-names>D</given-names></name><name><surname>McVeigh</surname><given-names>R</given-names></name><name><surname>Rajput</surname><given-names>B</given-names></name><name><surname>Robbertse</surname><given-names>B</given-names></name><name><surname>Smith-White</surname><given-names>B</given-names></name><name><surname>Ako-Adjei</surname><given-names>D</given-names></name><name><surname>Astashyn</surname><given-names>A</given-names></name><name><surname>Badretdin</surname><given-names>A</given-names></name><name><surname>Bao</surname><given-names>Y</given-names></name><name><surname>Blinkova</surname><given-names>O</given-names></name><name><surname>Brover</surname><given-names>V</given-names></name><name><surname>Chetvernin</surname><given-names>V</given-names></name><name><surname>Choi</surname><given-names>J</given-names></name><name><surname>Cox</surname><given-names>E</given-names></name><name><surname>Ermolaeva</surname><given-names>O</given-names></name><name><surname>Farrell</surname><given-names>CM</given-names></name><name><surname>Goldfarb</surname><given-names>T</given-names></name><name><surname>Gupta</surname><given-names>T</given-names></name><name><surname>Haft</surname><given-names>D</given-names></name><name><surname>Hatcher</surname><given-names>E</given-names></name><name><surname>Hlavina</surname><given-names>W</given-names></name><name><surname>Joardar</surname><given-names>VS</given-names></name><name><surname>Kodali</surname><given-names>VK</given-names></name><name><surname>Li</surname><given-names>W</given-names></name><name><surname>Maglott</surname><given-names>D</given-names></name><name><surname>Masterson</surname><given-names>P</given-names></name><name><surname>McGarvey</surname><given-names>KM</given-names></name><name><surname>Murphy</surname><given-names>MR</given-names></name><name><surname>O’Neill</surname><given-names>K</given-names></name><name><surname>Pujar</surname><given-names>S</given-names></name><name><surname>Rangwala</surname><given-names>SH</given-names></name><name><surname>Rausch</surname><given-names>D</given-names></name><name><surname>Riddick</surname><given-names>LD</given-names></name><name><surname>Schoch</surname><given-names>C</given-names></name><name><surname>Shkeda</surname><given-names>A</given-names></name><name><surname>Storz</surname><given-names>SS</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Thibaud-Nissen</surname><given-names>F</given-names></name><name><surname>Tolstoy</surname><given-names>I</given-names></name><name><surname>Tully</surname><given-names>RE</given-names></name><name><surname>Vatsan</surname><given-names>AR</given-names></name><name><surname>Wallin</surname><given-names>C</given-names></name><name><surname>Webb</surname><given-names>D</given-names></name><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Landrum</surname><given-names>MJ</given-names></name><name><surname>Kimchi</surname><given-names>A</given-names></name><name><surname>Tatusova</surname><given-names>T</given-names></name><name><surname>DiCuccio</surname><given-names>M</given-names></name><name><surname>Kitts</surname><given-names>P</given-names></name><name><surname>Murphy</surname><given-names>TD</given-names></name><name><surname>Pruitt</surname><given-names>KD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation</article-title><source>Nucleic Acids Research</source><volume>44</volume><fpage>D733</fpage><lpage>D745</lpage><pub-id pub-id-type="doi">10.1093/nar/gkv1189</pub-id><pub-id pub-id-type="pmid">26553804</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname><given-names>F</given-names></name><name><surname>Varoquaux</surname><given-names>G</given-names></name><name><surname>Gramfort</surname><given-names>A</given-names></name><name><surname>Michel</surname><given-names>V</given-names></name><name><surname>Thirion</surname><given-names>B</given-names></name><name><surname>Grisel</surname><given-names>O</given-names></name><name><surname>Blondel</surname><given-names>M</given-names></name><name><surname>Prettenhofer</surname><given-names>P</given-names></name><name><surname>Weiss</surname><given-names>R</given-names></name><name><surname>Dubourg</surname><given-names>V</given-names></name><name><surname>Vanderplas</surname><given-names>J</given-names></name><name><surname>Passos</surname><given-names>A</given-names></name><name><surname>Cournapeau</surname><given-names>D</given-names></name><name><surname>Brucher</surname><given-names>M</given-names></name><name><surname>Perrot</surname><given-names>M</given-names></name><name><surname>Duchesnay</surname><given-names>E</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: Machine learning in python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib43"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Podlesny</surname><given-names>D</given-names></name><name><surname>Durdevic</surname><given-names>M</given-names></name><name><surname>Paramsothy</surname><given-names>S</given-names></name><name><surname>Kaakoush</surname><given-names>NO</given-names></name><name><surname>Högenauer</surname><given-names>C</given-names></name><name><surname>Gorkiewicz</surname><given-names>G</given-names></name><name><surname>Walter</surname><given-names>J</given-names></name><name><surname>Fricke</surname><given-names>WF</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Intraspecies Strain Exclusion, Antibiotic Pretreatment, and Donor Selection Control Microbiota Engraftment after Fecal Transplantation</article-title><source>medRxiv</source><pub-id pub-id-type="doi">10.1101/2021.08.18.21262200</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pudgar</surname><given-names>P</given-names></name><name><surname>Povšič</surname><given-names>K</given-names></name><name><surname>Čuk</surname><given-names>K</given-names></name><name><surname>Seme</surname><given-names>K</given-names></name><name><surname>Petelin</surname><given-names>M</given-names></name><name><surname>Gašperšič</surname><given-names>R</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Probiotic strains of <italic>Lactobacillus brevis</italic> and <italic>Lactobacillus plantarum</italic> as adjunct to non-surgical periodontal therapy: 3-month results of a randomized controlled clinical trial</article-title><source>Clinical Oral Investigations</source><volume>25</volume><fpage>1411</fpage><lpage>1422</lpage><pub-id pub-id-type="doi">10.1007/s00784-020-03449-4</pub-id><pub-id pub-id-type="pmid">32666349</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Röttjers</surname><given-names>L</given-names></name><name><surname>Vandeputte</surname><given-names>D</given-names></name><name><surname>Raes</surname><given-names>J</given-names></name><name><surname>Faust</surname><given-names>K</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Null-model-based network comparison reveals core associations</article-title><source>ISME Communications</source><volume>1</volume><elocation-id>36</elocation-id><pub-id pub-id-type="doi">10.1038/s43705-021-00036-w</pub-id><pub-id pub-id-type="pmid">37938641</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seaver</surname><given-names>SMD</given-names></name><name><surname>Liu</surname><given-names>F</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Jeffryes</surname><given-names>J</given-names></name><name><surname>Faria</surname><given-names>JP</given-names></name><name><surname>Edirisinghe</surname><given-names>JN</given-names></name><name><surname>Mundy</surname><given-names>M</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name><name><surname>Noor</surname><given-names>E</given-names></name><name><surname>Beber</surname><given-names>ME</given-names></name><name><surname>Best</surname><given-names>AA</given-names></name><name><surname>DeJongh</surname><given-names>M</given-names></name><name><surname>Kimbrel</surname><given-names>JA</given-names></name><name><surname>D’haeseleer</surname><given-names>P</given-names></name><name><surname>McCorkle</surname><given-names>SR</given-names></name><name><surname>Bolton</surname><given-names>JR</given-names></name><name><surname>Pearson</surname><given-names>E</given-names></name><name><surname>Canon</surname><given-names>S</given-names></name><name><surname>Wood-Charlson</surname><given-names>EM</given-names></name><name><surname>Cottingham</surname><given-names>RW</given-names></name><name><surname>Arkin</surname><given-names>AP</given-names></name><name><surname>Henry</surname><given-names>CS</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>The ModelSEED Biochemistry Database for the integration of metabolic annotations and the reconstruction, comparison and analysis of metabolic models for plants, fungi and microbes</article-title><source>Nucleic Acids Research</source><volume>49</volume><fpage>D575</fpage><lpage>D588</lpage><pub-id pub-id-type="doi">10.1093/nar/gkaa746</pub-id><pub-id pub-id-type="pmid">32986834</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Severance</surname><given-names>EG</given-names></name><name><surname>Yolken</surname><given-names>RH</given-names></name><name><surname>Eaton</surname><given-names>WW</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Autoimmune diseases, gastrointestinal disorders and the microbiome in schizophrenia: more than a gut feeling</article-title><source>Schizophrenia Research</source><volume>176</volume><fpage>23</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1016/j.schres.2014.06.027</pub-id><pub-id pub-id-type="pmid">25034760</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smillie</surname><given-names>CS</given-names></name><name><surname>Sauk</surname><given-names>J</given-names></name><name><surname>Gevers</surname><given-names>D</given-names></name><name><surname>Friedman</surname><given-names>J</given-names></name><name><surname>Sung</surname><given-names>J</given-names></name><name><surname>Youngster</surname><given-names>I</given-names></name><name><surname>Hohmann</surname><given-names>EL</given-names></name><name><surname>Staley</surname><given-names>C</given-names></name><name><surname>Khoruts</surname><given-names>A</given-names></name><name><surname>Sadowsky</surname><given-names>MJ</given-names></name><name><surname>Allegretti</surname><given-names>JR</given-names></name><name><surname>Smith</surname><given-names>MB</given-names></name><name><surname>Xavier</surname><given-names>RJ</given-names></name><name><surname>Alm</surname><given-names>EJ</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Strain tracking reveals the determinants of bacterial engraftment in the human gut following fecal microbiota transplantation</article-title><source>Cell Host &amp; Microbe</source><volume>23</volume><fpage>229</fpage><lpage>240</lpage><pub-id pub-id-type="doi">10.1016/j.chom.2018.01.003</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>RR</given-names></name><name><surname>Bucci</surname><given-names>V</given-names></name><name><surname>Toussaint</surname><given-names>NC</given-names></name><name><surname>Buffie</surname><given-names>CG</given-names></name><name><surname>Rätsch</surname><given-names>G</given-names></name><name><surname>Pamer</surname><given-names>EG</given-names></name><name><surname>Sander</surname><given-names>C</given-names></name><name><surname>Xavier</surname><given-names>JB</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title><source>PLOS Computational Biology</source><volume>9</volume><elocation-id>e1003388</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003388</pub-id><pub-id pub-id-type="pmid">24348232</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van den Berg</surname><given-names>NI</given-names></name><name><surname>Machado</surname><given-names>D</given-names></name><name><surname>Santos</surname><given-names>S</given-names></name><name><surname>Rocha</surname><given-names>I</given-names></name><name><surname>Chacón</surname><given-names>J</given-names></name><name><surname>Harcombe</surname><given-names>W</given-names></name><name><surname>Mitri</surname><given-names>S</given-names></name><name><surname>Patil</surname><given-names>KR</given-names></name></person-group><year iso-8601-date="2022">2022</year><article-title>Ecological modelling approaches for predicting emergent properties in microbial communities</article-title><source>Nature Ecology &amp; Evolution</source><volume>6</volume><fpage>855</fpage><lpage>865</lpage><pub-id pub-id-type="doi">10.1038/s41559-022-01746-7</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walter</surname><given-names>J</given-names></name><name><surname>Maldonado-Gómez</surname><given-names>MX</given-names></name><name><surname>Martínez</surname><given-names>I</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>To engraft or not to engraft: an ecological framework for gut microbiome modulation with live microbes</article-title><source>Current Opinion in Biotechnology</source><volume>49</volume><fpage>129</fpage><lpage>139</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2017.08.008</pub-id><pub-id pub-id-type="pmid">28866242</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walther-António</surname><given-names>MRS</given-names></name><name><surname>Chen</surname><given-names>J</given-names></name><name><surname>Multinu</surname><given-names>F</given-names></name><name><surname>Hokenstad</surname><given-names>A</given-names></name><name><surname>Distad</surname><given-names>TJ</given-names></name><name><surname>Cheek</surname><given-names>EH</given-names></name><name><surname>Keeney</surname><given-names>GL</given-names></name><name><surname>Creedon</surname><given-names>DJ</given-names></name><name><surname>Nelson</surname><given-names>H</given-names></name><name><surname>Mariani</surname><given-names>A</given-names></name><name><surname>Chia</surname><given-names>N</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Potential contribution of the uterine microbiome in the development of endometrial cancer</article-title><source>Genome Medicine</source><volume>8</volume><elocation-id>122</elocation-id><pub-id pub-id-type="doi">10.1186/s13073-016-0368-y</pub-id><pub-id pub-id-type="pmid">27884207</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>Q</given-names></name><name><surname>Ren</surname><given-names>Y</given-names></name><name><surname>Ruan</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Effect of probiotic Lactobacillus on lipid profile: A systematic review and meta-analysis of randomized, controlled trials</article-title><source>PLOS ONE</source><volume>12</volume><elocation-id>e0178868</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0178868</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>F</given-names></name><name><surname>Ni</surname><given-names>H</given-names></name><name><surname>Asche</surname><given-names>CV</given-names></name><name><surname>Kim</surname><given-names>M</given-names></name><name><surname>Walayat</surname><given-names>S</given-names></name><name><surname>Ren</surname><given-names>J</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Efficacy of Bifidobacterium infantis 35624 in patients with irritable bowel syndrome: a meta-analysis</article-title><source>Current Medical Research and Opinion</source><volume>33</volume><fpage>1191</fpage><lpage>1197</lpage><pub-id pub-id-type="doi">10.1080/03007995.2017.1292230</pub-id><pub-id pub-id-type="pmid">28166427</pub-id></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>W</given-names></name><name><surname>Peng</surname><given-names>C</given-names></name><name><surname>Sakandar</surname><given-names>HA</given-names></name><name><surname>Kwok</surname><given-names>LY</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Meta-analysis: Randomized trials of <italic>Lactobacillus plantarum</italic> on immune regulation over the last decades</article-title><source>Frontiers in Immunology</source><volume>12</volume><elocation-id>643420</elocation-id><pub-id pub-id-type="doi">10.3389/fimmu.2021.643420</pub-id><pub-id pub-id-type="pmid">33828554</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>XL</given-names></name><name><surname>Tang</surname><given-names>XG</given-names></name><name><surname>Qu</surname><given-names>F</given-names></name><name><surname>Zheng</surname><given-names>Y</given-names></name><name><surname>Zhang</surname><given-names>WH</given-names></name><name><surname>Diao</surname><given-names>YQ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Bifidobacterium may benefit the prevention of necrotizing enterocolitis in preterm infants: A systematic review and meta-analysis</article-title><source>International Journal of Surgery</source><volume>61</volume><fpage>17</fpage><lpage>25</lpage><pub-id pub-id-type="doi">10.1016/j.ijsu.2018.11.026</pub-id><pub-id pub-id-type="pmid">30500473</pub-id></element-citation></ref><ref id="bib57"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zi</surname><given-names>Z</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Sensitivity analysis approaches applied to systems biology models</article-title><source>IET Systems Biology</source><volume>5</volume><elocation-id>336</elocation-id><pub-id pub-id-type="doi">10.1049/iet-syb.2011.0015</pub-id><pub-id pub-id-type="pmid">22129029</pub-id></element-citation></ref><ref id="bib58"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zomorrodi</surname><given-names>AR</given-names></name><name><surname>Maranas</surname><given-names>CD</given-names></name></person-group><year iso-8601-date="2012">2012</year><article-title>OptCom: a multi-level optimization framework for the metabolic modeling and analysis of microbial communities</article-title><source>PLOS Computational Biology</source><volume>8</volume><elocation-id>e1002363</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1002363</pub-id><pub-id pub-id-type="pmid">22319433</pub-id></element-citation></ref></ref-list></back><sub-article article-type="editor-report" id="sa0"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83690.sa0</article-id><title-group><article-title>Editor's evaluation</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Momeni</surname><given-names>Babak</given-names></name><role specific-use="editor">Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02n2fzt79</institution-id><institution>Boston College</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group></front-stub><body><p>This manuscript uses genome-scale metabolic modeling to estimate interspecies interactions and subsequently assess engraftment outcomes. This is an important line of work with potentially broad applications in different fields, including microbiota studies. The authors provide solid evidence to support the usefulness of their proposed approach in engraftment studies.</p></body></sub-article><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83690.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Momeni</surname><given-names>Babak</given-names></name><role>Reviewing Editor</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02n2fzt79</institution-id><institution>Boston College</institution></institution-wrap><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Momeni</surname><given-names>Babak</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02n2fzt79</institution-id><institution>Boston College</institution></institution-wrap><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Garza</surname><given-names>Daniel Rios</given-names></name><role>Reviewer</role><aff><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05f950310</institution-id><institution>KU Leuven</institution></institution-wrap><country>Belgium</country></aff></contrib></contrib-group></front-stub><body><boxed-text id="sa2-box1"><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Metabolic Model-based Ecological Modeling for Probiotic Design&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by 3 peer reviewers, including Babak Momeni as Reviewing Editor and Reviewer #1, and the evaluation has been overseen by a Reviewing Editor and Aleksandra Walczak as the Senior Editor. The following individual involved in the review of your submission has agreed to reveal their identity: Daniel Rios Garza (Reviewer #2).</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Please include the limitations of GSMMs, such as the requirement for high-quality reconstruction and the need to have resolved genomes or a method to assign models to taxa (Figure 1). Please also the assumption of the defined medium used for this manuscript.</p><p>2) Please add an investigation of the impact of the growth media on the predictions to the manuscript.</p><p>3) Please clarify the details of the setup for the results in Figures 3, 4, and 5. How is the training set chosen? How is the test set chosen? For testing each model, what are the conditions explored? What is the justification behind these choices?</p><p>4) Please clarify the importance of Figure 3. It appears all models, even the simplest ones, accurately predict the outcomes in this case. What is unique/different about this example that leads to this situation?</p><p>5) Please add explanations for why the performance in Figures 4 and 5 is rather poor. What is the reason behind the low predictive power? There is also a need for explaining why some models perform better than others. What are the conditions under which you expect each model to do well?</p><p>6) Please include the detailed assumptions of your FBA model, in particular, the effect of the resource allocation threshold. If a fixed threshold is used for research allocation, it may lead to artifacts. Please specify how this threshold affects the AUCs and if a more general approach such as parsimonious FBA would give similar results.</p><p>7) A justification is needed for why log ratios are used to represent interaction coefficients (Equation 2). When does such a representation work well? Does this work well, for example, in a simple case of a community with a few interacting species in dynamic FBA?</p><p>8) The authors need to justify how they chose the species to include in the analysis (&quot;Creating induced sub-graphs&quot;). If the availability of GSMMs is the only criterion, the authors need to add a thorough investigation of how sub-sampling the species present in the community might impact the prediction quality.</p><p>9) Please clarify how exactly the 400 cases used in each case are drawn (by clarifying and expanding the description in &quot;approximate edge swapping&quot;).</p><p>10) Please revise the Discussion section to address the limitations of the approach.</p><p>Additionally, I strongly encourage you to address the comments from individual reviewers (listed in the following) in your revision.</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>The authors in this manuscript use different models to explore if engraftment success can be predicted based on metabolic interactions. They use genome-scale metabolic models to train six different population-level models. They then assess how well these models predict the invasion/engraftment outcomes when compared with existing experimental results. The basic concept behind the work is interesting, relevant, and timely. However, there are issues with the organization of the paper and the clarity of results which make the paper hard to evaluate. Additionally, there are several assumptions made in the paper (e.g. how the interactions are estimated or how instances of communities are built) that need to be better justified. A thorough discussion about the limitations of the approach is also necessary to clarify for the reader the situations in which this approach is likely (or unlikely) to work well.</p><p>1. It is unclear to me what the ensemble used for Figures 3 to 5 is. How is the training set chosen? How is the test set chosen? For testing each model, what are the conditions explored?</p><p>2. Is it fair to consider the results in Figure 3 as trivial? It appears all models, even the simplest ones, accurately predict the outcome. What is unique/different about this example that leads to this situation?</p><p>3. In contrast to Figure 3, the results in Figures 4 and 5 are far from ideal. What is causing this significant drop in predictive power? I would recommend that the authors include the discussions to at least speculate under what conditions the predictive power will drop.</p><p>4. In the organization of the paper, there is a strong emphasis on the six different types of model in the abstract and introduction, but the most informative data comes from the InhibitLV model. I felt the models that are not informative could perhaps be de-emphasized, in favor of models that produce the best predictions and offer more mechanistic investigations.</p><p>5. In my opinion, more details about how FBA is used to find the parameters of the model should be included in the main text.</p><p>6. The authors briefly mention that in some cases one or more models failed because of fitting issues. In my opinion, including the conditions that each model fails as well as a description of why it fails and how the situation can be remedied is necessary. This will be very informative for others to troubleshoot and fix similar issues in other contexts.</p><p>7. If I understand correctly, the authors use log ratios to represent interaction coefficients (Equation 2). In my opinion, the justification for this choice needs to be included in the manuscript. Does this work well, for example, in a simple case of a community with a few interacting species in dynamic FBA?</p><p>8. It appears to me that in choosing what species to include in the analysis (&quot;Creating induced sub-graphs&quot;), species to include are chosen based on whether there is a match for them in the AGORA database, rather than how important they are for the process of engraftment. The potential downside of this choice for accurately representing each system can be large (for example, it may miss the dominant species as an obvious example). The authors need to include a justification of why this choice is justified.</p><p>9. I would like to ask for some clarification on how exactly the 400 cases used in each case are drawn. The procedure is described in lines 423-432 (&quot;approximate edge swapping&quot;), but I think expanding the description (maybe using a simplified visual illustration of the protocol with 4 or 5 species) would be helpful.</p><p>10. The Discussion section of the paper summarizes the advantages of the proposed method (using genome-scale metabolic modeling to make inferences about engraftment outcomes) but does not adequately discuss the limitations of the approach. In my opinion, this is one of the major weaknesses of the paper.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The study presents a promising framework to predict the outcome of colonization experiments, such as the ones that are attempted in probiotic therapy. Previous studies have tackled this problem with both machine learning approaches (ML) and ecological models (based on interspecies interactions) but encountered some major limitations. The ML approaches are context-specific and require a large amount of training data per condition to have predictive power, while the ecologic models require dense time series to reliably find the interspecies interaction parameters.</p><p>The authors propose to solve these limitations by making use of reconstructed genome-scale metabolic models (GSMMs) to predict the strength and direction of species interactions. The main advantage of such an approach is the possibility to fit ecological models to individual samples, without the need for extensive training data or dense time series. But does this approach work?</p><p>To test its strength, the authors predicted the outcome of three colonization experiments and show that the ecological models parameterized with GSMMs outperform ML methods such as random forest and support vector machines.</p><p>While the approach is certainly promising, some careful validations might still be useful before it can be widely used.</p><p>Even if the framework seemingly outperforms the tested ML methods, the predictive values are relatively low and might depend on details of the approach that were not systematically evaluated. High-quality GSMMs are not widely available. Automated and semi-automated reconstructions such as the ones in AGORA contain many errors and might not provide the correct information about species growth and interactions. The study partially tackles this limitation by showing that predictions using the interactions of a null model (i.e. random interactions) are significantly worse than predictions based on the GSMM interactions.</p><p>Of notice, the framework uses a modified version of community FBA which is not accessible in a publicly available tool and relies on the arbitrary definition of a flux threshold. Furthermore, the use of GSMMs requires the formulation of the growth media. Here an artificial formulation (termed the Western diet) was used. It is unclear how much these choices affect the prediction quality and prevent the framework from being widely used.</p><p>How about the ecological models? The authors extensively tested six alternatives divided into two classes: generalized Lotka-Volterra-based models (GLVs) and linear models. Overall, the GLVs outperformed the linear models. Finally, if the approach can be used and makes reliable predictions, then one can perform perturbations to the structure of the model and gain further insights into the ecology of a species' colonization into a community.</p><p>In my opinion, the following additional validations would significantly increase the impact of the study and strengthen its conclusions:</p><p>– Growth media: the manuscript would benefit by showing how much the growth media affects the quality of the predictions;</p><p>– Resource allocation threshold: It's not specified in the methods, but based on the previous study, I assume that a threshold was fixed, which sounds fairly artificial. It would be useful to know how this threshold affects the AUCs and if a more general approach such as parsimonious FBA would give similar results.</p><p>– Induced sub-graphs: what is the consequence of working with only a fraction of the microbiome given the impossibility to map it to a GSMM? For instance, how does down-sampling the community composition impact the prediction quality?</p><p>With these comparisons in hand, one could understand better why the AUCs are so low and what is expected to get reliable predictions.</p><p>Figure 1: could make clear some of the limitations of GSMMs, such as the requirement of high-quality reconstruction and the need to have resolved genomes or a method to assign models to taxa. Also, the assumption of a defined medium.</p><p>Figure 3: why is the null model not centered at 0.5?</p><p><italic>Reviewer #3 (Recommendations for the authors):</italic></p><p>Recent years have shown that despite the strong link between the microbiome and health, the administration of a probiotic is not sufficient to alter the microbiome in a desired, therapeutic, way. Engraftment of the administered microbial species is often limited, with most patients failing to show signs of medium-term or long-term engraftment. This study uses pairwise metabolic modeling to build a network of species-species interactions. Considering three experimental engraftment studies, they assess the likelihood of invader engraftment based on network structure, comparing model predictions to data. Comparing several related models, it is shown that a generalized Lotka-Volterra model is predictive if an invader or probiotic will successfully engraft into an existing microbiota community, potentially revealing which microbe-microbe interactions drive the engraftment. A known weakness of generalized Lotka-Volterra models is the difficulty to parametrize them from experimental data, and the lack of generalizability of the resulting model to new situations. Here, by leveraging metabolic modeling (relying on the AGORA network) the authors claim to parameterize population models in a way that is predictive also of novel environments. Thus, the authors claim to predict the engraftment of an invader into a microbial community.</p><p>Strengths:</p><p>– The question of engraftment is important, and the attempt to tackle it by trying several related models and AGORA is justified and may yet prove fruitful.</p><p>– Figure 2 explained the six models well, clarifying the differences and similarities between them.</p><p>– The code shared on github is good practice. Yet one may improve the code release significantly, e.g.: a readme file, a quick explanation of how to use the code, etc. In its current form, it is not so usable by a third party.</p><p>Weaknesses:</p><p>– The message in Figure 1 is lost on me. The two panels appear quite similar, and I do not understand what the difference between them is supposed to mean.</p><p>– I do not agree that the ecological principle of engraftment is the same between pathogens and probiotics. The pathogen cares only about short-term engraftment as a means to grow and infect further hosts (hence its pathogenic nature, ultimately damaging the host), therefore, the notion of long-term engraftment is ill-defined. Indeed, pathogens may employ strategies to assist in short-term engraftment (e.g. cause the host diarrhea), that probiotics cannot. Probiotics (or commensal species in general) are presumed to form stable long-term associations with the host without damaging the host.</p><p>– I found the exposition of the methods and results lacking. For a start: how precisely is AGORA used? Why do the authors presume the readers are familiar with AGORA? Equation 1 is not properly explained. The Results section shows mostly trivial information instead of a deeper understanding of the modeling results.</p><p>– It is not at all obvious that given the FBA data for a single microbe, one can predict its growth paired with another species. Processes of adaptation and evolution kick in and can change the single-microbe growth profiles significantly. This weakens the foundation of this entire approach. There is much recent literature on this co-culture question (some of it cited in the manuscript) and it simply cannot be brushed off so casually.</p><p>Justification of claims and conclusions:</p><p>The manuscript raises an important question and proposes a solid direction, but I am not convinced by the evidence presented-possibly due to the presentation itself. Though the approach proposed in this manuscript may yet prove useful, it needs much more justification, proper exposition, and experimental validation to be taken truly seriously.</p><p>– Abstract (line 20) &quot;reflect connect&quot; should probably be just &quot;connect&quot;.</p><p>– While I think there is no need to explain the AUROC, I do think that the Kendall-tau correlation should be better motivated, as it is not often used in the microbiome literature.</p><p>– The AGORA database should be better exposed. The authors should not assume the reader is familiar with it.</p><p>– I do not understand why it is useful to show Figure 3a – a bunch of 100% AUROC values (as a bar plot!). The fact that it is easy to predict C.diff. engraftment is stated in the text and the figure frankly just looks a bit silly. Indeed, Figure 3b is even less informative, we know what a 100% AUROC looks like, and it needs no visual assistance. Though Figure 3c contains something for us to learn, it is a weak statement about the role of shuffling the AGORA parameters. Altogether – I would say remove 3a and 3b altogether and change 3c or put it in a supplement.</p><p>– Regarding Figure 4a: the use of bar plots is discouraged, using box plots would be a lot more informative in the same presentation style and space. 4b: why is the AUROC not stated? The classifier seems hardly impressive.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.83690.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Please include the limitations of GSMMs, such as the requirement for high-quality reconstruction and the need to have resolved genomes or a method to assign models to taxa (Figure 1). Please also the assumption of the defined medium used for this manuscript.</p></disp-quote><p>We have added the following regarding the limitations of GSMMs in the introduction (lines 77-88):</p><p>“Genome-scale metabolic models (GSMs) encode the metabolic pathways available in a cell, allowing simulation of cellular metabolism and growth. These tools have been used extensively to understand and engineer microbial mono-cultures, and have recently begun to be used to understand and predict the composition and metabolic function of microbial communities. Community methods using GSMs often suffer from a number of drawbacks. These can include a focus on equilibrium states, high complexity and computational cost, and the difficulty of providing accurate GSMs for each community member. By layering simple, pairwise GSM community modeling with population models, we allow for prediction that includes transient behavior (e.g. how quickly an extinction happens within a community) and reduces computational complexity. The availability of accurate GSMs remains a major difficulty, but we demonstrate that progress can be made using algorithmically generated models from whole genomes”</p><p>And in the discussion (lines 242-249):</p><p>“As a limitation, it is worth noting that all GEM-based methods, including our own, are limited to a large extent by the accuracy of the metabolic model reconstructions. Low-quality reconstructions often omit key reactions, or worse, may include reactions that should not have been included. In all cases, this creates the potential for reaction fluxes or interactions that do not reflect reality. Improving the quality of metabolic model reconstruction is the subject of challenging and nuanced research that includes automated pipelines and hand-curation efforts. These efforts are essential to improve the accuracy of community metabolic modeling, but are beyond the scope of this particular study.”</p><p>We note that this work makes no attempt to correct the inherent limitations and that our results are positive despite these many known limitations. In our opinion, this increases the significance of this work.</p><p>We have also added the following detail about how we now reconstruct models (note that this method is different from our previous practice of simply matching taxa to models in the AGORA database) in the Introduction (lines 92-97):</p><p>“To construct the necessary GSMs, we matched taxa found in the sample to the genomes found in the RefSeq database and used these genomes to build models using ModelSEED. A complete list of the genomes for each data-set used can be found in Supplementary file S1 Data.”</p><p>As well as further details in the Methods section, in the section labeled “Creation of GSMs”.</p><p>The defined medium is also now listed in the supplemental data file S1, sheet labeled “EU_Average_Diet”</p><disp-quote content-type="editor-comment"><p>2) Please add an investigation of the impact of the growth media on the predictions to the manuscript.</p></disp-quote><p>Our original results used a gut media defined by the Theile group and is available as part of the Virtual Metabolic Human database. We highlight that media components were not hand-picked by the authors and there is no risk of “overfitting” by hand as it were. Given we cannot test everything, we offer to reduce this question to two main questions that a reader might have.</p><p>1) Does the model respond appropriate to change in media?</p><p>2) Is the model overly sensitive to small changes in media?</p><p>For the first question, we have replaced the gut media with complete media. This essentially is akin of changing from a media meant to mimic a (micro)aerobic colon environment to an aerobic nutrient-rich laboratory culture.</p><p>For the second question, we have halved and doubled the flux rates (the typical stand in for concentration) of the major carbon and nitrogen sources from the gut media and report the difference.</p><p>We have added both of these results to manuscript in table 1 and figure 2.</p><disp-quote content-type="editor-comment"><p>3) Please clarify the details of the setup for the results in Figures 3, 4, and 5. How is the training set chosen? How is the test set chosen? For testing each model, what are the conditions explored? What is the justification behind these choices?</p></disp-quote><p>We thank the reviewer for these remarks. We have clarified the text. Specifically, we have highlighted that our model is not a “learned” model where there is a training set and a test set, but instead these are models whose parameters come entirely from a database of metabolic models. In fact, the lack of fitting parameters is one of the wonderful things about this model in that makes it potentially more extensible and able to directly incorporate genomic and literature knowledge in the form of genome scale metabolic models! We have added the following to our methods section entitled “Prediction and evaluation” (lines 399-402)</p><p>“We note that our method ``learns&quot; using joint FBA, and so there is no need to split the data into training and testing sets. In fact, the ``learning&quot; procedure does not make use of any known sample classifications, as a traditional machine-learning algorithm would. This allows us to test our predictions on the entire data set, which provides greater confidence in our results.”</p><p>The comparison models, that is, the SVM and RF models, on the other hand, are learned models. We had added the following details for those models (lines 426-433):</p><p>“We compared the performance of our method to the performance of two traditional machine learning approaches, support vector machines and random forest classifiers. We used $1000$-fold cross validation of the predictions made by these tools (i.e. $1000$ independent train/test splits). Each trial consisted of splitting the data randomly into 16 training samples and 6 testing samples, fitting both a support vector machine and a random forest classifier to the training samples using standard python libraries (from scikit-learn v. 0.23.2), and evaluating the model's predictions of the testing samples. This was repeated for both the ``baseline&quot; and ``treatment&quot; sets of samples.”</p><p>Our aim was to use these as a potential estimate of a reasonable upper limit for our model which has far fewer free parameters and which does not learn from data. As is shown in our figures, our approach is comparable or slightly exceeds that of these standard fitting approaches.</p><disp-quote content-type="editor-comment"><p>4) Please clarify the importance of Figure 3. It appears all models, even the simplest ones, accurately predict the outcomes in this case. What is unique/different about this example that leads to this situation?</p></disp-quote><p>We have removed Figure 3 and the corresponding text from the manuscript. This example, while it performs well, could indeed be thought of as a trivial predictor given the easily separable microbiome distributions between susceptible and non-susceptible microbiomes. The original paper shows these are easily visually separated on a PCoA with almost no overlap and little variance per group and is in <xref ref-type="fig" rid="sa2fig1">Author response image 1</xref>.</p><fig id="sa2fig1" position="float"><label>Author response image 1.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-sa2-fig1-v2.tif"/></fig><p>Instead, we now focus on the most complex case in order to provide a better sense of the performance on a case where there is a more reasonable need for an improved mechanistic predictor. This case is one where there is no clean separation. Pasting the figure from the author’s original paper in Author response 2.</p><fig id="sa2fig2" position="float"><label>Author response image 2.</label><graphic mimetype="image" mime-subtype="tiff" xlink:href="elife-83690-sa2-fig2-v2.tif"/></fig><disp-quote content-type="editor-comment"><p>5) Please add explanations for why the performance in Figures 4 and 5 is rather poor. What is the reason behind the low predictive power? There is also a need for explaining why some models perform better than others. What are the conditions under which you expect each model to do well?</p></disp-quote><p>We refer to reviewers to our answer to the previous question for which we added a paragraph discussing the differences between the different experimental scenarios. We also now focus on the results from Figure 4, which allowed us to have the highest model coverage and test the most complex case. (And removed the discussion of Figure 5 in part because of the amount of additional work that was already performed and the extensive amount of time it therefore took us to respond to the reviewer requests regarding the methodology.)</p><disp-quote content-type="editor-comment"><p>6) Please include the detailed assumptions of your FBA model, in particular, the effect of the resource allocation threshold. If a fixed threshold is used for research allocation, it may lead to artifacts. Please specify how this threshold affects the AUCs and if a more general approach such as parsimonious FBA would give similar results.</p></disp-quote><p>We thank the reviewers for this astute comment. We previously performed these experiments and did not include them in the interest of clarity and succinctness. But we are quite happy to bring this work to light as we believe this highlights the strength of our results. We have now provided results using a different RAC or no RAC at all the manuscript (table 1, figure 2). The results show that RACs do not improve performance significantly, although we note that RAC has been shown to improve prediction in pairwise experiments in previous studies.</p><p>We would like to briefly note the following as part of our results and rationale as strengths. As we indicate in our paper on RACs, a fixed threshold is most likely not biologically true. However, we lack the data to validate species-specific RACs which might be more biologically appropriate. By purposefully simplifying our model of RACs to a single fixed threshold, we are avoiding the possibility that these essentially free parameters could be used to fit our data and inflate the goodness of our results. Another way of thinking about this is that we are purposely giving up potential performance in order to convince the reader that the positive results stem from the metabolic models and RACs, and not due to a significantly larger number of extraneous parameters. With more data and more precise parameterization of the RACs, could we do better? Almost definitely. But our purpose is to highlight the power of the models with minimum free parameter fitting. Arguably, the fixed threshold chosen is also not a free parameter as it is chosen on the basis of maximizing overall diversity as discussed in the RAC paper.</p><disp-quote content-type="editor-comment"><p>7) A justification is needed for why log ratios are used to represent interaction coefficients (Equation 2). When does such a representation work well? Does this work well, for example, in a simple case of a community with a few interacting species in dynamic FBA?</p></disp-quote><p>We now include the following explanation in our methods section (lines 363-372):</p><p>“We use the log-ratio of simulated growth in pairs and alone as the implied effect of one microbe on another. That is, if simulated growth of species <italic>i</italic> alone is <italic>x<sub>i</sub></italic> 364 , and growth of species <italic>i</italic> when coupled in a pair with species <italic>j</italic> is <italic>x<sub>ij</sub></italic>, we weight the edge from species <italic>j</italic> to species <italic>i</italic> as</p><p><inline-formula><mml:math id="sa2m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>ij</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math></inline-formula> We use the log-ratio because it is the simplest choice of translating simulated data to interaction that accounts for fold-changes. Of course, the simple difference in simulated biomass is another possible choice, but this will be much more sensitive to absolute scaling in simulation, so, for example, slow growing taxa will be biased towards smaller interactions in the network. Furthermore, our <italic>in-silico</italic> growth experiments only provide simulated biomass values at chemostatic equilibrium, meaning that fitting Lotka-Volterra parameters directly to these data is an underdetermined problem, particularly when pair growth leads to a simulated extinction.”</p><p>We note that dynamic FBA implies a more complicated relationship between taxa that is mediated by available metabolites.</p><disp-quote content-type="editor-comment"><p>8) The authors need to justify how they chose the species to include in the analysis (&quot;Creating induced sub-graphs&quot;). If the availability of GSMMs is the only criterion, the authors need to add a thorough investigation of how sub-sampling the species present in the community might impact the prediction quality.</p></disp-quote><p>This is a good point. Our previous rationale was based on availability of hand-curated AGORA models that were exact matches, and therefore, in part, was limited by accessibility. In our revisions, we have now added ModelSEED reconstructed models, which means we carried out the steps of draft model reconstruction and gap filling on approximately 1000 additional models.</p><p>To the methods, we have added (lines 381-388):</p><p>“In order to carry out our analysis, we needed to construct GSMs for the taxa found in the data. To do this, we matched taxa in the data by NCBI taxa ID to genomes in the NCBI refseq database (O’Leary et al., 2016). We matched taxa to the nearest (by tree distance according to NCBI's taxonomic database) genome that was listed as ‘Chromosome’ or ‘Complete Genome’, or contained at least 1000 genes. On average, this approach allowed us to perform our experiments with ~ 87-88% coverage of each sample. Taxa for which we failed to match a genome were removed from the data, and all analysis was performed on the remaining. For full details on the coverage of each sample, see Supplementary file S1 Data.”</p><p>Our new methodology gives us a higher relative abundance representation of the overall community, taking us to 87-88% coverage per sample in our revised manuscript. This new methodology does not give substantially better performance, but does provide much more complete model coverage.</p><disp-quote content-type="editor-comment"><p>9) Please clarify how exactly the 400 cases used in each case are drawn (by clarifying and expanding the description in &quot;approximate edge swapping&quot;).</p></disp-quote><p>This has been clarified in the methods section with the following text (lines 414-424):</p><p>“We estimated the significance of our predictions against predictions from a null-model created by parameterizing a Lokta-Volterra system from an ‘edge swapped’ full network. The ‘edge-swapped’ network was constructed by drawing edge weights from the original full network, with replacement, as is commonly done to create a null model in network analysis (Röttjers et al., 2021). This approach allows us to create random models that preserve the statistical characteristics of the models that we test on, while changing the specific interactions between taxa. That is, the distribution of the entire set of parameters in the null models <inline-formula><mml:math id="sa2m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:math></inline-formula> will be approximately the same as the distribution of parameters <inline-formula><mml:math id="sa2m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> determined by joint FBA. Using this null model ensures that our conclusions are drawn from the joint FBA parameter learning method, and not simply a result simpler characteristics, e.g. total connectedness of the community.”</p><disp-quote content-type="editor-comment"><p>10) Please revise the Discussion section to address the limitations of the approach.</p></disp-quote><p>In response to points 1 and 4 above, we have added text regarding the limitations of GSMMs in general as well as a discussion of limitations regarding microbial species representation in the database (which are generally intended for human microbiota).</p><disp-quote content-type="editor-comment"><p>Reviewer #1 (Recommendations for the authors):</p><p>The authors in this manuscript use different models to explore if engraftment success can be predicted based on metabolic interactions. They use genome-scale metabolic models to train six different population-level models. They then assess how well these models predict the invasion/engraftment outcomes when compared with existing experimental results. The basic concept behind the work is interesting, relevant, and timely. However, there are issues with the organization of the paper and the clarity of results which make the paper hard to evaluate. Additionally, there are several assumptions made in the paper (e.g. how the interactions are estimated or how instances of communities are built) that need to be better justified. A thorough discussion about the limitations of the approach is also necessary to clarify for the reader the situations in which this approach is likely (or unlikely) to work well.</p></disp-quote><p>We thank Reviewer #1 for these comments, especially for the many pointers to where we can better clarify or expand upon our results to the benefit of the readers.</p><disp-quote content-type="editor-comment"><p>1. It is unclear to me what the ensemble used for Figures 3 to 5 is. How is the training set chosen? How is the test set chosen? For testing each model, what are the conditions explored?</p></disp-quote><p>Thank you. Addressed above in Essential revisions #3.</p><disp-quote content-type="editor-comment"><p>2. Is it fair to consider the results in Figure 3 as trivial? It appears all models, even the simplest ones, accurately predict the outcome. What is unique/different about this example that leads to this situation?</p></disp-quote><p>Thank you. Addressed above in Essential revisions #4.</p><disp-quote content-type="editor-comment"><p>3. In contrast to Figure 3, the results in Figures 4 and 5 are far from ideal. What is causing this significant drop in predictive power? I would recommend that the authors include the discussions to at least speculate under what conditions the predictive power will drop.</p></disp-quote><p>Thank you. Addressed above in Essential revisions #4.</p><disp-quote content-type="editor-comment"><p>4. In the organization of the paper, there is a strong emphasis on the six different types of model in the abstract and introduction, but the most informative data comes from the InhibitLV model. I felt the models that are not informative could perhaps be de-emphasized, in favor of models that produce the best predictions and offer more mechanistic investigations.</p></disp-quote><p>We now de-emphasize the 6 different types of models and note for the reviewer that using the new method of finding models, we no longer have this sensitivity. It is perhaps worth noting that though all the LV models are now roughly equivalent, InhibitLV was faster than the others because it made finite time blow-up less likely. Perhaps another way of putting this is to say the reviewer suggestion to push for higher coverage, though it required fairly large amount of work, improved the model quality, especially in terms of sensitivity (and therefore also adding to the confidence we have in the results).</p><disp-quote content-type="editor-comment"><p>5. In my opinion, more details about how FBA is used to find the parameters of the model should be included in the main text.</p></disp-quote><p>Thank you. We note that the methods used to find parameters are not novel, and were previously introduced in the RAC paper by Minsuk Kim et al. That said, we have now included the following brief recap so that the reader is provided high-level insight on the methodology from our previous work (lines 334-344).</p><p>“To compute growth simulations, we use joint FBA with a set of resource allocation constraints, which have been shown to improve predictions in pairwise experiments (Kim et al., 2022). Briefly, joint FBA with resource allocation constraints solves a linear program defined by the GSMs of the community members. The linear program maximizes total community biomass with the standard FBA constraints as well as the added constraints that each microbe grows a fixed known rate (simulating chemostatic equilibrium), that mass is balanced community wide (with inflow and outflow of nutrients), that there is forced leak of nutrients out of the community (introduced by Kim et al., 2022 to prevent unrealistically efficient cross-feeding) and that each community member’s total internal reaction flux is bounded (the resource-allocation constraint). Our problem set-up is identical to that described in Kim et al., 2022, and we provide python code to carry out the computation in our supplemental repository.”</p><disp-quote content-type="editor-comment"><p>6. The authors briefly mention that in some cases one or more models failed because of fitting issues. In my opinion, including the conditions that each model fails as well as a description of why it fails and how the situation can be remedied is necessary. This will be very informative for others to troubleshoot and fix similar issues in other contexts.</p></disp-quote><p>Our new method of identifying and including models in our analysis provided much better sample coverage, alleviating many of these issues. One issue that remains is the problem of finite-time blow-up in simulation. We now including the following discussion of how the model might fail due to finite-time blow-up (lines 163-175):</p><p>“One consequence of using the generalized Lotka-Volterra model in our method is the possibility of finite-time blow-up in simulation. This happens when one or more taxa approach infinite biomass in finite simulation time. In practice, whenever one or more taxa increases to a level much higher than the initial total biomass of the simulated system, simulation is slowed down and results may be less reliable. There are two simple methods to prevent this from happening. The first is to alter every interaction parameter to be more negative (see Equation 3), making the system uniformly more antagonistic and less likely to show finite-time blow-up. The second is to include negative self-inhibition (e.g. add <inline-formula><mml:math id="sa2m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> parameters [see Equation 4]).</p><p>We tested both of these alterations by implementing them and compuing predictions and the AUC-ROC of those predictions. \Cref{fig:lvshift} shows that these changes did not have a significant impact on the performance of our predictions, as long as only antagonism was considered. When we shifted parameters in the positive direction (simulating commensalism or mutualism), finite-time blow-up was more likely and our results were much less stable.”</p><disp-quote content-type="editor-comment"><p>7. If I understand correctly, the authors use log ratios to represent interaction coefficients (Equation 2). In my opinion, the justification for this choice needs to be included in the manuscript. Does this work well, for example, in a simple case of a community with a few interacting species in dynamic FBA?</p></disp-quote><p>Thank you. Addressed in Essential revisions #7.</p><disp-quote content-type="editor-comment"><p>8. It appears to me that in choosing what species to include in the analysis (&quot;Creating induced sub-graphs&quot;), species to include are chosen based on whether there is a match for them in the AGORA database, rather than how important they are for the process of engraftment. The potential downside of this choice for accurately representing each system can be large (for example, it may miss the dominant species as an obvious example). The authors need to include a justification of why this choice is justified.</p></disp-quote><p>Thank you. Addressed in Essential revisions #8.</p><disp-quote content-type="editor-comment"><p>9. I would like to ask for some clarification on how exactly the 400 cases used in each case are drawn. The procedure is described in lines 423-432 (&quot;approximate edge swapping&quot;), but I think expanding the description (maybe using a simplified visual illustration of the protocol with 4 or 5 species) would be helpful.</p></disp-quote><p>Thank you. Addressed in Essential revisions #9.</p><disp-quote content-type="editor-comment"><p>10. The Discussion section of the paper summarizes the advantages of the proposed method (using genome-scale metabolic modeling to make inferences about engraftment outcomes) but does not adequately discuss the limitations of the approach. In my opinion, this is one of the major weaknesses of the paper.</p></disp-quote><p>Thank you. Addressed in Essential revisions #10. The senior author would like to note that any perceived lessening of the limitations of metabolic modeling was unintentional. The senior author has a reasonably long history working on tools for or related to automated metabolic modeling and it erroneously stopped occurring to him that the limitations and difficulties with metabolic models would be unknown by general readers. On the flip side, the excitement of this working as it does despite those many limitations is potentially very high.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The study presents a promising framework to predict the outcome of colonization experiments, such as the ones that are attempted in probiotic therapy. Previous studies have tackled this problem with both machine learning approaches (ML) and ecological models (based on interspecies interactions) but encountered some major limitations. The ML approaches are context-specific and require a large amount of training data per condition to have predictive power, while the ecologic models require dense time series to reliably find the interspecies interaction parameters.</p><p>The authors propose to solve these limitations by making use of reconstructed genome-scale metabolic models (GSMMs) to predict the strength and direction of species interactions. The main advantage of such an approach is the possibility to fit ecological models to individual samples, without the need for extensive training data or dense time series. But does this approach work?</p><p>To test its strength, the authors predicted the outcome of three colonization experiments and show that the ecological models parameterized with GSMMs outperform ML methods such as random forest and support vector machines.</p><p>While the approach is certainly promising, some careful validations might still be useful before it can be widely used.</p><p>Even if the framework seemingly outperforms the tested ML methods, the predictive values are relatively low and might depend on details of the approach that were not systematically evaluated. High-quality GSMMs are not widely available. Automated and semi-automated reconstructions such as the ones in AGORA contain many errors and might not provide the correct information about species growth and interactions. The study partially tackles this limitation by showing that predictions using the interactions of a null model (i.e. random interactions) are significantly worse than predictions based on the GSMM interactions.</p><p>Of notice, the framework uses a modified version of community FBA which is not accessible in a publicly available tool and relies on the arbitrary definition of a flux threshold. Furthermore, the use of GSMMs requires the formulation of the growth media. Here an artificial formulation (termed the Western diet) was used. It is unclear how much these choices affect the prediction quality and prevent the framework from being widely used.</p><p>How about the ecological models? The authors extensively tested six alternatives divided into two classes: generalized Lotka-Volterra-based models (GLVs) and linear models. Overall, the GLVs outperformed the linear models. Finally, if the approach can be used and makes reliable predictions, then one can perform perturbations to the structure of the model and gain further insights into the ecology of a species' colonization into a community.</p></disp-quote><p>We thank Reviewer #2 for this insightful summary of our work as well as the questions raised. We appreciate these remarks and agree with the overall spirit of them. We briefly address the highlights here. First, the authors agree (without throwing any stones at VMH—whose services we appreciate) that there are many errors in the AGORA models. That being said, a metabolic model can be considered at multiple scales, that is, more reductively on the reaction level or more holistically on the growth level. On the reaction level, one can find many errors of both inclusion and exclusion within AGORA models. For example, the specific electron transport chain reactions might be erroneous. However, on the growth level, anaerobes can grow without oxygen, and aerobes use oxygen, and overall the gross growth characteristics have been mostly preserved. We note this not to agree or disagree with the reviewer on the overall quality of the models, but to point out that our model is at the population level and therefore not very sensitive to the most erroneous aspect of the AGORA models, which occur at the reaction level. Another way of saying this is that most errors in reaction pathways will not have a strong effect on species-species interactions unless they happen to impact a key metabolite.</p><p>We also note, though it is not described in this paper, that the flux threshold for the RAC is not arbitrary, but chosen on the basis of maximizing diversity as discussed in the paper by Minsuk Kim et al. This is something that needed some clarity and we have now provided a brief summary of that work in this paper as addressed in Essential revision #6. We acknowledge that we used a variation of SteadyCom where we added a RAC to calculate the species-species interaction parameters and that there is no specific software package. But this is mostly because the change is very minor and are essentially not worthy of its own software implementation. In lieu of this, we now include this algorithm in our software package containing this method.</p><p>The media file is indeed a good question and one that we address in Essential revision #2. And finally, the excitement of the mechanistic model is that indeed, we can perturb the model and identify the species that most alter engraftment and non-engraftment. This is what we show an example of in Tables 1 and 2. This is a powerful way to generate hypotheses and while the aim of our work was not to explore the biological questions, it is one of the strengths of this modeling paper and a goal for future papers.</p><disp-quote content-type="editor-comment"><p>In my opinion, the following additional validations would significantly increase the impact of the study and strengthen its conclusions:</p><p>– Growth media: the manuscript would benefit by showing how much the growth media affects the quality of the predictions;</p></disp-quote><p>Thank you. Addressed in Essential revisions #5.</p><disp-quote content-type="editor-comment"><p>– Resource allocation threshold: It's not specified in the methods, but based on the previous study, I assume that a threshold was fixed, which sounds fairly artificial. It would be useful to know how this threshold affects the AUCs and if a more general approach such as parsimonious FBA would give similar results.</p></disp-quote><p>Thank you. Addressed in Essential revisions #6.</p><disp-quote content-type="editor-comment"><p>– Induced sub-graphs: what is the consequence of working with only a fraction of the microbiome given the impossibility to map it to a GSMM? For instance, how does downsampling the community composition impact the prediction quality?</p></disp-quote><p>Thank you. Addressed in Essential revisions #8.</p><disp-quote content-type="editor-comment"><p>With these comparisons in hand, one could understand better why the AUCs are so low and what is expected to get reliable predictions.</p><p>Figure 1: could make clear some of the limitations of GSMMs, such as the requirement of high-quality reconstruction and the need to have resolved genomes or a method to assign models to taxa. Also, the assumption of a defined medium.</p></disp-quote><p>We have now made clear the limitations of GSMMs in the Introduction and Discussion in response to Essential revision #1. We had added to the discussion of the defined media in our response to Essential revision #2.</p><disp-quote content-type="editor-comment"><p>Figure 3: why is the null model not centered at 0.5?</p></disp-quote><p>This is because the null model is essentially a bootstrap in the sense that we take the parameters of the real model and shuffle them around. The edge weights are therefore not random and most microbes suppress <italic>C. difficile</italic>. We now remove Figure 3 and the discussion of this simpler case entirely in response to other remarks.</p><disp-quote content-type="editor-comment"><p>Reviewer #3 (Recommendations for the authors):</p><p>Recent years have shown that despite the strong link between the microbiome and health, the administration of a probiotic is not sufficient to alter the microbiome in a desired, therapeutic, way. Engraftment of the administered microbial species is often limited, with most patients failing to show signs of medium-term or long-term engraftment. This study uses pairwise metabolic modeling to build a network of species-species interactions. Considering three experimental engraftment studies, they assess the likelihood of invader engraftment based on network structure, comparing model predictions to data. Comparing several related models, it is shown that a generalized Lotka-Volterra model is predictive if an invader or probiotic will successfully engraft into an existing microbiota community, potentially revealing which microbe-microbe interactions drive the engraftment. A known weakness of generalized Lotka-Volterra models is the difficulty to parametrize them from experimental data, and the lack of generalizability of the resulting model to new situations. Here, by leveraging metabolic modeling (relying on the AGORA network) the authors claim to parameterize population models in a way that is predictive also of novel environments. Thus, the authors claim to predict the engraftment of an invader into a microbial community.</p><p>Strengths:</p><p>– The question of engraftment is important, and the attempt to tackle it by trying several related models and AGORA is justified and may yet prove fruitful.</p></disp-quote><p>We thank the reviewer for this comment.</p><disp-quote content-type="editor-comment"><p>– Figure 2 explained the six models well, clarifying the differences and similarities between them.</p><p>– The code shared on github is good practice. Yet one may improve the code release significantly, e.g.: a readme file, a quick explanation of how to use the code, etc. In its current form, it is not so usable by a third party.</p></disp-quote><p>We have improved the github by adding detailed documentation. It is more of a calculation than software, but hopefully in adding an example we will provide enough information for any future users who may want to do their own calculations.</p><disp-quote content-type="editor-comment"><p>Weaknesses:</p><p>– The message in Figure 1 is lost on me. The two panels appear quite similar, and I do not understand what the difference between them is supposed to mean.</p></disp-quote><p>We have edited the caption for clarity. Our purpose with this figure was to immediately draw attention to the mechanistic nature of the GSM approach, in contrast to standard parameter learning from data.</p><disp-quote content-type="editor-comment"><p>– I do not agree that the ecological principle of engraftment is the same between pathogens and probiotics. The pathogen cares only about short-term engraftment as a means to grow and infect further hosts (hence its pathogenic nature, ultimately damaging the host), therefore, the notion of long-term engraftment is ill-defined. Indeed, pathogens may employ strategies to assist in short-term engraftment (e.g. cause the host diarrhea), that probiotics cannot. Probiotics (or commensal species in general) are presumed to form stable long-term associations with the host without damaging the host.</p></disp-quote><p>This is a very astute point as there are indeed differences between pathogens and probiotics, for example, the role of the immune response and the effect on the motility of the host differs between them in magnitude. We included it initially because there are a limited number of probiotic experiments with corresponding microbiome data publicly available. We have removed the discussion of the <italic>C. difficile</italic> case.</p><disp-quote content-type="editor-comment"><p>– I found the exposition of the methods and results lacking. For a start: how precisely is AGORA used? Why do the authors presume the readers are familiar with AGORA? Equation 1 is not properly explained. The Results section shows mostly trivial information instead of a deeper understanding of the modeling results.</p></disp-quote><p>We thank the reviewer for these remarks. While we did do a lot of work to ensure the quality of our approach, we clearly tried to over-simplify the paper in the interest of clarity and brevity. We have added a lot of our results regarding model variants and parameter modification into the supplemental so that the reader can appropriately understand the underlying models. In addition, we have tried to add additional background in-line where possible to try to limit the reliance on the readers having familiarity with the citations.</p><disp-quote content-type="editor-comment"><p>– It is not at all obvious that given the FBA data for a single microbe, one can predict its growth paired with another species. Processes of adaptation and evolution kick in and can change the single-microbe growth profiles significantly. This weakens the foundation of this entire approach. There is much recent literature on this co-culture question (some of it cited in the manuscript) and it simply cannot be brushed off so casually.</p></disp-quote><p>We thank the reviewer for this astute comment. It was not our intent to brush off the complexity of species-species interactions which, as the reviewer states, are highly nonlinear. It is indeed surprising that despite all the caveats we have acknowledged in our work that this approach yields positive predictive power. It is for this reason, we feel our results are worth highlighting. That is, we are not of the position that this model is the be-all end-all of engraftment studies, but that it is surprisingly effective and this yields both biological insight into the importance of metabolism, the ability of approximate metabolic models to reflect the right properties at a community level, and that we do not need models with large numbers of free parameterized models to capture this information.</p><disp-quote content-type="editor-comment"><p>Justification of claims and conclusions:</p><p>The manuscript raises an important question and proposes a solid direction, but I am not convinced by the evidence presented-possibly due to the presentation itself. Though the approach proposed in this manuscript may yet prove useful, it needs much more justification, proper exposition, and experimental validation to be taken truly seriously.</p></disp-quote><p>We thank the reviewer for this comment and the other reviewers as well who asked for us for this justification and exposition, which we have now hopefully provided. Experimental validation is unfortunately outside the scope of this theoretical work, but we do note that we used 3 datasets and a model with no free parameters.</p><disp-quote content-type="editor-comment"><p>– Abstract (line 20) &quot;reflect connect&quot; should probably be just &quot;connect&quot;.</p><p>– While I think there is no need to explain the AUROC, I do think that the Kendall-tau correlation should be better motivated, as it is not often used in the microbiome literature.</p><p>– The AGORA database should be better exposed. The authors should not assume the reader is familiar with it.</p><p>– I do not understand why it is useful to show Figure 3a – a bunch of 100% AUROC values (as a bar plot!). The fact that it is easy to predict C.diff. engraftment is stated in the text and the figure frankly just looks a bit silly. Indeed, Figure 3b is even less informative, we know what a 100% AUROC looks like, and it needs no visual assistance. Though Figure 3c contains something for us to learn, it is a weak statement about the role of shuffling the AGORA parameters. Altogether – I would say remove 3a and 3b altogether and change 3c or put it in a supplement.</p></disp-quote><p>This was just for consistency of presentation. We have now removed the other cases and simplified the data presented by removing some of the subfigures.</p><disp-quote content-type="editor-comment"><p>– Regarding Figure 4a: the use of bar plots is discouraged, using box plots would be a lot more informative in the same presentation style and space. 4b: why is the AUROC not stated? The classifier seems hardly impressive.</p></disp-quote><p>Done and done.</p></body></sub-article></article>