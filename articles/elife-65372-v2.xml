<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.2" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">65372</article-id><article-id pub-id-type="doi">10.7554/eLife.65372</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Tools and Resources</subject></subj-group><subj-group subj-group-type="heading"><subject>Developmental Biology</subject></subj-group></article-categories><title-group><article-title>Image3C, a multimodal image-based and label-independent integrative method for single-cell analysis</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes" id="author-220859"><name><surname>Accorsi</surname><given-names>Alice</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0606-2977</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund6"/><xref ref-type="other" rid="fund8"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-83251"><name><surname>Box</surname><given-names>Andrew C</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-220860"><name><surname>Peuß</surname><given-names>Robert</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-9716-6650</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="fn" rid="equal-contrib2">‡</xref><xref ref-type="other" rid="fund5"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-174116"><name><surname>Wood</surname><given-names>Christopher</given-names></name><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" corresp="yes" equal-contrib="yes" id="author-1179"><name><surname>Sánchez Alvarado</surname><given-names>Alejandro</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1966-6959</contrib-id><email>asa@stowers.org</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con5"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-44744"><name><surname>Rohner</surname><given-names>Nicolas</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3248-2772</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund9"/><xref ref-type="other" rid="fund4"/><xref ref-type="other" rid="fund7"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con6"/><xref ref-type="fn" rid="conf1"/></contrib><aff id="aff1"><label>1</label><institution>Stowers Institute for Medical Research</institution><addr-line><named-content content-type="city">Kansas City</named-content></addr-line><country>United States</country></aff><aff id="aff2"><label>2</label><institution>Howard Hughes Medical Institute, Stowers Institute for Medical Research</institution><addr-line><named-content content-type="city">Kansas City</named-content></addr-line><country>United States</country></aff><aff id="aff3"><label>3</label><institution>Institute for Evolution and Biodiversity, University of Münster</institution><addr-line><named-content content-type="city">Münster</named-content></addr-line><country>Germany</country></aff><aff id="aff4"><label>4</label><institution>Department of Molecular and Integrative Physiology, KU Medical Center</institution><addr-line><named-content content-type="city">Kansas City</named-content></addr-line><country>United States</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="senior_editor"><name><surname>Stainier</surname><given-names>Didier YR</given-names></name><role>Senior Editor</role><aff><institution>Max Planck Institute for Heart and Lung Research</institution><country>Germany</country></aff></contrib><contrib contrib-type="editor"><name><surname>Zinzen</surname><given-names>Robert P</given-names></name><role>Reviewing Editor</role><aff><institution>Max Delbrück Centre for Molecular Medicine</institution><country>Germany</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn><fn fn-type="con" id="equal-contrib2"><label>‡</label><p>These authors also contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>21</day><month>07</month><year>2021</year></pub-date><pub-date pub-type="collection"><year>2021</year></pub-date><volume>10</volume><elocation-id>e65372</elocation-id><history><date date-type="received" iso-8601-date="2020-12-02"><day>02</day><month>12</month><year>2020</year></date><date date-type="accepted" iso-8601-date="2021-07-20"><day>20</day><month>07</month><year>2021</year></date></history><pub-history><event><event-desc>This manuscript was published as a preprint at bioRxiv.</event-desc><date date-type="preprint" iso-8601-date="2019-04-09"><day>09</day><month>04</month><year>2019</year></date><self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/603035"/></event></pub-history><permissions><copyright-statement>© 2021, Accorsi et al</copyright-statement><copyright-year>2021</copyright-year><copyright-holder>Accorsi et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-65372-v2.pdf"/><abstract><p>Image-based cell classification has become a common tool to identify phenotypic changes in cell populations. However, this methodology is limited to organisms possessing well-characterized species-specific reagents (<italic>e.g.</italic>, antibodies) that allow cell identification, clustering, and convolutional neural network (CNN) training. In the absence of such reagents, the power of image-based classification has remained mostly off-limits to many research organisms. We have developed an image-based classification methodology we named Image3C (Image-Cytometry Cell Classification) that does not require species-specific reagents nor pre-existing knowledge about the sample. Image3C combines image-based flow cytometry with an unbiased, high-throughput cell clustering pipeline and CNN integration. Image3C exploits intrinsic cellular features and non-species-specific dyes to perform <italic>de novo</italic> cell composition analysis and detect changes between different conditions. Therefore, Image3C expands the use of image-based analyses of cell population composition to research organisms in which detailed cellular phenotypes are unknown or for which species-specific reagents are not available.</p></abstract><abstract abstract-type="executive-summary"><title>eLife digest</title><p>Cells are the building blocks of all living organisms. They come in many types, each with a different role. Understanding the composition of cells, <italic>i.e.</italic>, how many cells and which types of cells are present inside an organ can indicate what that organ does. It can also reveal how that organ changes under different conditions, like during an infection or treatment.</p><p>The most powerful methods for studying cells work well for species researchers already know a lot about, such as mice, zebrafish or humans, but not for less studied animals. To change this Accorsi, Box, Peuß et al. created a new tool called Image3C to be used for studying the composition of cells in less researched organisms.</p><p>Instead of using reagents that only work for specific species, the tool uses molecules that work across many species, like dyes that stain the cell nucleus. A cell-sorting machine, known as a flow cytometer, connected to a microscope then takes pictures of hundreds of stained cells each second and Image3C groups them based on their appearance, without the need for any prior knowledge about the cell types. Accorsi et al. then tested Image3C on immune system cells of zebrafish, a well-studied animal, and apple snails, an under-studied animal. For both species, the tool was able to sort cells into groups representing different parts of the immune system.</p><p>Image3C speeds up the grouping process and reduces the need for user intervention and time. This lowers the risk of bias compared to manual counting of cells. It can sort cells even when the types of cells in an organism are unknown and even when specialized reagents for an organism do not exist. This means that it could characterise the cell make-up of new tissues coming from organisms never studied before. Access to this uncharted world of cells stands to reveal previously inaccessible clues about how organs behave and evolve and allow researchers to investigate the impact of environmental changes on these cells.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>Pomacea canaliculata</kwd><kwd>single cell</kwd><kwd>morphology-based cell clustering</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>Zebrafish</kwd><kwd>Other</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id><institution>Howard Hughes Medical Institute</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Sánchez Alvarado</surname><given-names>Alejandro</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id><institution>National Science Foundation</institution></institution-wrap></funding-source><award-id>1923372</award-id><principal-award-recipient><name><surname>Rohner</surname><given-names>Nicolas</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>GM127872</award-id><principal-award-recipient><name><surname>Rohner</surname><given-names>Nicolas</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007795</institution-id><institution>Stowers Institute for Medical Research</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Box</surname><given-names>Andrew C</given-names></name><name><surname>Wood</surname><given-names>Christopher</given-names></name><name><surname>Sánchez Alvarado</surname><given-names>Alejandro</given-names></name><name><surname>Rohner</surname><given-names>Nicolas</given-names></name></principal-award-recipient></award-group><award-group id="fund5"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001659</institution-id><institution>Deutsche Forschungsgemeinschaft</institution></institution-wrap></funding-source><award-id>PE 2807/1-1</award-id><principal-award-recipient><name><surname>Peuß</surname><given-names>Robert</given-names></name></principal-award-recipient></award-group><award-group id="fund6"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100003575</institution-id><institution>American Association of Anatomists</institution></institution-wrap></funding-source><award-id>Postdoctoral fellowship</award-id><principal-award-recipient><name><surname>Accorsi</surname><given-names>Alice</given-names></name></principal-award-recipient></award-group><award-group id="fund7"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id><institution>National Institutes of Health</institution></institution-wrap></funding-source><award-id>DP2AG071466</award-id><principal-award-recipient><name><surname>Rohner</surname><given-names>Nicolas</given-names></name></principal-award-recipient></award-group><award-group id="fund8"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009988</institution-id><institution>Society for Developmental Biology</institution></institution-wrap></funding-source><award-id>Emerging Research Organisms Grant</award-id><principal-award-recipient><name><surname>Accorsi</surname><given-names>Alice</given-names></name></principal-award-recipient></award-group><award-group id="fund9"><funding-source><institution-wrap><institution>Edward Mallinckrodt Foundation</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Rohner</surname><given-names>Nicolas</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Image3C is a new image-based analysis of cell population composition for research organisms in which detailed cellular phenotypes are unknown or for which species-specific reagents are not available.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Single-cell analysis has proven crucial to our understanding of fundamental biological processes such as development, homeostasis, regeneration, aging, and disease (<xref ref-type="bibr" rid="bib13">Goolam et al., 2016</xref>; <xref ref-type="bibr" rid="bib21">Kimmel et al., 2019</xref>; <xref ref-type="bibr" rid="bib38">Pepe-Mooney et al., 2019</xref>; <xref ref-type="bibr" rid="bib40">Philippeos et al., 2018</xref>; <xref ref-type="bibr" rid="bib46">Tirosh et al., 2016</xref>). High-throughput analyses of these and other biological processes at single-cell resolution require technologies capable of describing individual cells and subsequently clustering them based on similarities of features like morphology, cell surface protein expression, or transcriptome profile. Recent advances in image-based cell profiling and single-cell RNA sequencing (scRNA-seq) allow quantification of differences between cell populations and comparisons of cell type composition between samples (<xref ref-type="bibr" rid="bib6">Caicedo et al., 2017</xref>). Single-cell studies that use traditional research organisms (<italic>e.g.</italic>, mouse, rat, or fruit fly) benefit from the availability of genomic platforms and established antibody libraries. However, the same cannot be said for a growing number of important, yet understudied research organisms lacking such reagents and whose biological interrogation would benefit immensely from single-cell analyses. In these cases, classical histochemical methods are often used to identify and characterize specific cells. Yet, the successful identification and enumeration of biologically meaningful cell types in such studies can be harmed by both the limited number and variety of cellular attributes (few features or low dynamic range) available for determination of cell types and by observer bias when using traditional, hand-counting approaches (<italic>e.g.</italic>, hemocytometer and Giemsa stain) (<xref ref-type="bibr" rid="bib48">van der Meer et al., 2004</xref>). These shortcomings, together with the lack of extensive knowledge on cell-specific phenotypes available for training or for <italic>a priori</italic> assumptions, usually result in the underestimation of the complexity of cellular composition or interactions among cell types within tissues.</p><p>Automated classification of cells using convolutional neural networks (CNNs, machine learning [ML] method specialized in image recognition and classification) has become a promising approach for accurate high-throughput cell analysis that is free from observer bias (<xref ref-type="bibr" rid="bib4">Blasi et al., 2016</xref>; <xref ref-type="bibr" rid="bib12">Eulenberg et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Kobayashi et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Lei et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Nassar et al., 2019</xref>; <xref ref-type="bibr" rid="bib45">Suzuki et al., 2019</xref>). To date, CNN-based automated clustering and classification techniques require pre-existing knowledge about the organism or cell type of interest (<italic>e.g.</italic>, cell-specific morphological traits within an image set) or the availability of cell-specific reagents (<italic>e.g.</italic>, antibodies), or genomic sequence (<italic>e.g.</italic>, single-cell sequencing) (<xref ref-type="table" rid="table1">Table 1</xref> shows an overview of the existing methods) (<xref ref-type="bibr" rid="bib3">Baron et al., 2019</xref>; <xref ref-type="bibr" rid="bib4">Blasi et al., 2016</xref>; <xref ref-type="bibr" rid="bib7">Cheng et al., 2021</xref>; <xref ref-type="bibr" rid="bib12">Eulenberg et al., 2017</xref>; <xref ref-type="bibr" rid="bib17">Hennig et al., 2017</xref>; <xref ref-type="bibr" rid="bib23">Kobayashi et al., 2017</xref>; <xref ref-type="bibr" rid="bib26">Lei et al., 2018</xref>; <xref ref-type="bibr" rid="bib31">Nassar et al., 2019</xref>). This means that to make effective use of artificial intelligence (AI) approaches for single-cell analysis, one must have information available to train the algorithm or for ML models, which often arises in the form of information gleaned from the use of reagents like antibodies. Research areas that rely on inter-species comparisons or studies on emerging research organisms would benefit from single-cell-based analyses that do not require pre-existing knowledge of cell types (<italic>i.e.</italic>, which is required for training a CNN for example) and/or availability of antibodies or molecular databases. For example, within the interdisciplinary field of eco-immunology, a growing number of researchers are investigating immune system adaptation to different environments by studying immune cell compositions in diverse animals (<xref ref-type="bibr" rid="bib30">Maizels and Nussey, 2013</xref>). Given the influences of immune cell composition on the immune system response of an organism (<xref ref-type="bibr" rid="bib20">Kaczorowski et al., 2017</xref>), applying modern single-cell analysis in eco-immunological research would substantially increase our knowledge about the plasticity and conservation of immune responses in a variety of different animals and conditions (<xref ref-type="bibr" rid="bib39">Peuß et al., 2020</xref>).</p><table-wrap id="table1" position="float"><label>Table 1.</label><caption><title>Extensive overview on label-free cell clustering tools including a comparison of their main features.</title></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool name</th><th>Was tested on multiple cell types?</th><th>Requires <italic>a priori</italic> knowledge of the sample and/or species-specific reagents for the clustering?</th><th>Uses commercially available hardware?</th><th>Uses free or open source softwares?</th></tr></thead><tbody><tr><td>Image3C <break/>(present work)</td><td>YES <break/>(Zebrafish whole kidney marrow; Apple snail hemolymph)</td><td>NO <break/>Does not require previous knowledge or species-specific reagents to cluster cell images and train the neural network. If available, they can be used/integrated.</td><td>YES <break/>(ImageStream)</td><td>YES <break/>(IDEAS; Vortex; R; Python) <break/>NO <break/>(FCS Express Plus)</td></tr><tr><td>CellProfiler <sup>*</sup></td><td>YES <break/>(Fixed Jurkat cells; Live Jurkat cells; Fission yeast; Human white blood cells)</td><td>YES <break/>Requires annotated datasets to train the machine learning algorithms, either by staining the samples with known markers, or by manually clustering the cells.</td><td>YES <break/>(ImageStream; Microscope)</td><td>YES <break/>(IDEAS; CellProfiler) <break/>NO <break/>(MATLAB)</td></tr><tr><td>CellProfiler Analyst <sup>†</sup></td><td>NO <break/>(Jurkat cells)</td><td>YES <break/>Requires the use of fluorescent markers to annotate the cells and use them as the ground truth to train the machine learning algorithms.</td><td>YES <break/>(ImageStream)</td><td>YES <break/>(IDEAS; CellProfiler/ Phyton)</td></tr><tr><td>Label-free reflectance microscopy <sup>‡</sup></td><td>NO <break/>(Fixed HeLa cells)</td><td>YES <break/>Requires immunofluorescence images with known markers to use as ground truth and for training multiple deep learning models.</td><td>NO <break/>(Custom-built multimodal light-emitting diode (LED) array reflectance microscope)</td><td>YES <break/>(Deep neural networks)</td></tr><tr><td>Optofluidic time-stretch microscopy <sup>§</sup></td><td>NO <break/>(Human breast adenocarcinoma cell line, MCF-7)</td><td>YES <break/>Does not provide cell clustering and single-cell resolution analysis. The changes are analyzed overall in the sample without assigning it to a cell type.</td><td>NO <break/>(Optofluidic time-stretch microscope and microfluidic devices)</td><td>NO <break/>(MATLAB)</td></tr><tr><td>Raman scattering <sup>¶</sup></td><td>YES <break/>(Microalgal cells; Circulating tumor cells in human blood)</td><td>YES <break/>Requires homogenous cell cultures. After different treatments, these samples are used to create databases for training deep learning models.</td><td>NO <break/>(High-speed multicolor stimulated Raman scattering (SRS) microscope and microfluidic platform)</td><td>YES <break/>(Deep learning, neural network structure, VGG-16)</td></tr><tr><td>Fluorescence lifetime imaging <sup>**</sup></td><td>NO <break/>(Human white blood cells)</td><td>YES <break/>Depends on other techniques to identify cell types to compare their autofluorescence signals and fluorescence decay for further analysis.</td><td>YES <break/>(Fluorescence microscopy; FLIM; Flowcytometer)</td><td>YES <break/>(Python)</td></tr></tbody></table><table-wrap-foot><fn><p>* <xref ref-type="bibr" rid="bib4">Blasi et al., 2016</xref>; <xref ref-type="bibr" rid="bib31">Nassar et al., 2019</xref>.</p><p>† <xref ref-type="bibr" rid="bib17">Hennig et al., 2017</xref>.</p></fn><fn><p>‡ <xref ref-type="bibr" rid="bib7">Cheng et al., 2021</xref>.</p><p>§ <xref ref-type="bibr" rid="bib23">Kobayashi et al., 2017</xref>.</p></fn><fn><p>¶ <xref ref-type="bibr" rid="bib45">Suzuki et al., 2019</xref>.</p><p>** <xref ref-type="bibr" rid="bib56">Yakimov et al., 2019</xref>.</p></fn></table-wrap-foot></table-wrap><p>To make sophisticated cellular composition analysis available to any research organism without the need for either pre-existing knowledge about the cell populations or species-specific reagents, we developed Image-Cytometry Cell Classification (Image3C). This method analyzes, visualizes, and quantifies, in a high-throughput and unbiased way, the composition of cell populations by using cell morphological traits and non-species-specific fluorescent probes (<italic>e.g.</italic>, nuclear staining or dyes for metabolic states that function well in a variety of organisms) (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="table" rid="table1">Table 1</xref>). By taking advantage of cell morphology and/or fluorescent dyes related to function or metabolic state, Image3C can analyze single cell suspensions derived from any experimental design, <italic>de novo</italic> cluster cells present in the sample of interest and compare their abundance between each other or among different assays. Once the <italic>de novo</italic> clustering based on cell-intrinsic features is obtained, Image3C employs a CNN that uses these clusters as training sets, avoiding in this way user bias or manual classification (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="table" rid="table1">Table 1</xref>). This produces a CNN-based cell classifier ‘machine’ used to quantify subsequently acquired image-based flow cytometry data and compare cellular composition of samples across multiple experiments in a high-throughput manner without the need for repeating time-consuming steps for <italic>de novo</italic> clustering. The combination of the clustered cell images, the outputs of their functional assays, and the published literature about closely related organisms might allow the identification and description of cell types of interest. In comparison to existing label-free cell clustering methods, Image3C does not require initial antibody staining (<xref ref-type="bibr" rid="bib7">Cheng et al., 2021</xref>; <xref ref-type="bibr" rid="bib17">Hennig et al., 2017</xref>; <xref ref-type="bibr" rid="bib28">Lippeveld et al., 2020</xref>; <xref ref-type="bibr" rid="bib31">Nassar et al., 2019</xref>), pre-existing knowledge of specific cell morphology (<xref ref-type="bibr" rid="bib45">Suzuki et al., 2019</xref>; <xref ref-type="bibr" rid="bib56">Yakimov et al., 2019</xref>), and is not limited to a specific cellular phenotype (<xref ref-type="bibr" rid="bib4">Blasi et al., 2016</xref>) for <italic>a priori</italic> identification of certain cell types (<xref ref-type="table" rid="table1">Table 1</xref>). This makes Image3C extremely versatile and applicable to virtually any research organism and tissue from which dissociated single cells can be obtained. Parallelly to this <italic>de novo</italic> clustering approach, Image3C can take advantage of species-specific reagents and prior knowledge to be combined with transcriptomic dataset and provide a new and complimentary layer of information based on cell morphology and function. In sum, Image3C combines modern high-throughput data acquisition by image-based flow cytometry, advanced and unbiased clustering analysis, statistics to compare cellular compositions across different samples, and a CNN classifier component to easily determine changes in cell composition across multiple experiments.</p><fig-group><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Schematic representation of Image3C workflow, a method for cell clustering based on morphological features.</title><p>(<bold>A</bold>) A single cell suspension is prepared for image-based flow cytometric analyses. The cells can be labeled with any reagent working for the species of interest. The signal can highlight specific cell components (<italic>e.g.</italic>, nuclei), metabolic cell states, or specific cell functions. The samples are run on the ImageStream<sup>X</sup> Mark II, and 10,000 nucleated and focused events are saved for each sample as individual raw images. (<bold>B</bold>) IDEAS software is used to open the raw images, compensate for correcting fluorescent spillover, subtract background, and quantify values for intrinsic morphological and fluorescent features. R (or R studio) is used to calculate the correlation between features to allow to trim the features that are redundant with others. Samples that are outliers among replicates are also removed prior to the final normalization of the fluorescence intensities. (<bold>C</bold>) Images are clustered based on morphological and fluorescent feature values and visualized as a force-directed layout (FDL) graph where each dot represents one event. (<bold>D</bold>) R integration in FCS Express Plus software allows the visualization of cell images by clusters or specifically selected with a gate. This step allows to evaluate the morphological homogeneity of the clusters, determine if the number of clusters is appropriate, and explore the phenotype/function of the cells based on visualization of individual channels. (<bold>E</bold>) Spearman’s correlation plot of feature values by clusters is one of the options available in Image3C for plotting integrated data. This heatmap shows feature similarities and differences between cells belonging to different clusters. (<bold>F</bold>) If new experiments are run and new data needs to be analyzed, two approaches can be taken. (1) If the goal is comparing samples belonging to the same experiment (<italic>e.g.</italic>, treatment vs. control), the steps described so far from (<bold>A</bold>) to (<bold>E</bold>) can be reapplied to the new dataset including a statistical analysis to compare cluster relative abundance. This approach will produce a new set of clusters that will need to be reannotated. Compare sets of clusters coming from multiple experiments and multiple rounds of analysis can be challenging without pre-existing knowledge of cell types, clearly different morphologies or biomarkers that would allow to establish a unique correlation between clusters coming from different FDL graphs. (2) If the goal is integrating experiments and comparing cell type abundance between them, the use of steps (<bold>F</bold>) and (<bold>G</bold>) is suggested. A CNN classifier is trained using the images obtained from homeostasis, naïve or wild-type (WT) cells, and already organized in clusters in an unbiased way through the first part of our method. This will generate a trained classifier with CNN classes based on FDL clusters. (<bold>G</bold>) This classifier is then used for deconvoluting data from new experimental sets and assigning each event to a CNN class with a given probability. This provides high-throughput and unbiased way to compare different experiment sets without the requirement for pre-existing knowledge about the tissue cell types, cell biomarkers, or the need to cross-annotate clusters increasing the probability to introduce errors. The entire pipeline chart and step-by-step technical information, such as software used, time required for processing, and exported file format, are reported in the interactive map <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> that automatically directs to the specific sections of the GitHub.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig1-v2.tif"/></fig><fig id="fig1s1" position="float" specific-use="child-fig"><label>Figure 1—figure supplement 1.</label><caption><title>Interactive map of Image3C pipeline. Once the images are collected, this pipeline can be followed step-by-step.</title><p>Through this interactive map, it is possible to click on the different portions of the pipeline and be automatically directed to the corresponding section of the GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link>), where a detailed step-by-step description of the processing, sample scripts, workflow files, and example datasets are provided. The software used are color-coded throughout the pipeline, and approximation of the time needed to run the individual steps is provided in light gray. The central column and the left side represent the <italic>de novo</italic> clustering portion of the pipeline, while the right side (green arrows) represents the use of the convolutional neural network (CNN), being trained with the clusters defined in an unbiased way from the <italic>de novo</italic> clustering and able to process new samples.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig1-figsupp1-v2.tif"/></fig></fig-group></sec><sec id="s2" sec-type="results|discussion"><title>Results and discussion</title><sec id="s2-1"><title>Image3C</title><p>Image3C is an imaging tool developed to study tissue composition at single-cell resolution in research organisms for which antibodies and pre-existing knowledge about cell types are not readily available (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="table" rid="table1">Table 1</xref>). Image3C allows for high-throughput and unbiased analysis in scenarios where manual counting and observer-based cell identification are currently the only options. Image3C includes all the components required for compensating captured images, quantifying multiple features for each event, clustering the events, visualizing and exploring the data, and training and using the CNN for analyzing subsequent samples and integrating multiple experiments (<xref ref-type="fig" rid="fig1">Figure 1</xref>, <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p><p>Once a single cell suspension is prepared from the organism of interest, the cells are stained with a combination of dyes that are expected to function irrespectively of the species used and which have high affinity for specific cellular organelles such as nuclei or molecules associated with metabolic states such as reactive oxygen species (ROS). We validated reagents experimentally by determining that nuclear dyes stain intracellular material matching expected characteristics of nuclear DNA or by activation of cells with drugs to change their metabolic state. The labeled samples are then run on the ImageStream<sup>X</sup> Mark II (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). ImageStream is a commercially available image-based flow cytometer, whose diffusion in laboratory settings is increasing and that provides highly reproducible images of cells that can be compared across days of acquisitions and experiments. For this approach, no microfluidic devices or custom-made and highly specialized microscopes are required (<xref ref-type="table" rid="table1">Table 1</xref>), and, if desired, the users can test the Image3C pipeline also on images acquired at standard microscopes, remembering to carefully control for batch effects.</p><p>Once images of individual events are collected for each channel of interest, feature values from both morphological and fluorescent data, such as cell size and nuclear size, are extracted from the cell images using IDEAS software (Amnis Millipore, free for download upon creation of Amnis user account) (<xref ref-type="fig" rid="fig1">Figure 1B</xref>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref> and <xref ref-type="supplementary-material" rid="supp2">2</xref> for feature description). Correlation between features is calculated and redundant features are trimmed as well as samples that, among replicates, are outliers (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref> and <xref ref-type="fig" rid="fig2s2">2</xref>). This prevents clustering artifacts potentially caused by having multiple features providing the same information or including samples that are not representative (<xref ref-type="fig" rid="fig1">Figure 1B</xref>). During this step, while the number of features was usually reduced significantly, the correlation between replicates was always high and outliers were rarely observed (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref> and <xref ref-type="fig" rid="fig2s2">2</xref>). Finally, fluorescence intensity features are transformed to improve homogeneity of variance of distributions and, if used, DNA staining is normalized to remove intensity drift between samples and thus align the 2N and 4N DNA content histogram peaks (<xref ref-type="fig" rid="fig1">Figure 1B</xref>, <xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>).</p><p>Exported feature quantifications are used for clustering the events. Dimensionality reduction and visualization of clusters is achieved by generating force-directed layout (FDL) graphs in the VorteX clustering environment (<xref ref-type="fig" rid="fig1">Figure 1C</xref>) (free to install) (<xref ref-type="bibr" rid="bib44">Samusik et al., 2016</xref>). Cell images for events within each cluster can be visualized using FCS Express Plus together with custom R scripts (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). These visualization tools and the cluster feature averages (<italic>i.e.</italic>, the mean value of each feature for each cluster) (<xref ref-type="fig" rid="fig1">Figure 1E</xref>) allow to explore the images of selected groups of events and the features that differ between cells belonging to separate clusters. If control and treatment samples are included, a statistical analysis using negative binomial regression to compare cell counts per cluster between samples is also available in the Image3C pipeline. This high-throughput and unbiased analysis provides a comprehensive understanding of a cell population composition at higher resolution than what is possible with traditional histological methods.</p><p>Once this pipeline is run on a first set of samples (<italic>e.g.</italic>, homeostatic state) and the cell clusters are defined for the tissue of interest, the images and the relative clustering IDs can be used to train a CNN classifier in an unbiased way (<xref ref-type="fig" rid="fig1">Figure 1F</xref>), including the ability to score frequency of ‘new’ cell types that do not match any of the clusters identified at homeostasis. Therefore, future experiments in the same tissue used for training the CNN classifier can be analyzed directly through the CNN (<xref ref-type="fig" rid="fig1">Figure 1G</xref>). This significantly reduces the number of steps and time required to process data collected subsequently. An even greater advantage is represented by the fact that, in the absence of CNN, every time new experimental sets are run it would be necessary to go again through the <italic>de novo</italic> clustering part of the pipeline (<xref ref-type="fig" rid="fig1">Figure 1B–E</xref>) and the new set of clusters would need to be cross-annotated to be compared with cell population composition observed in previous experiments. Manually matching clusters between different experimental sets might be a source of errors, mainly if the user is not familiar with the cell types present in the sample and if specific biomarkers or pre-existing knowledge about cell types and morphology are not available. The CNN splits all the cell images in the classes defined during the training step and allows to compare the abundance of cells with same morphology among different samples without the need to cross-annotate clusters (<xref ref-type="fig" rid="fig1">Figure 1F, G</xref>). The CNN inclusion in Image3C and the reproducibility of image acquisition through image-based flow cytometry allows use of the clusters defined from one experiment (<italic>e.g.</italic>, homeostatic state) to set up a classifier in an unbiased way for later use as a reference in analyzing the effects of experimental manipulations on these cell populations. We conclude from these results that Image3C can perform <italic>de novo</italic> high-throughput characterizations of population composition and define specific cell type changes between homeostatic and experimentally perturbed samples across multiple experiments.</p></sec><sec id="s2-2"><title>Image3C recapitulates cell composition of zebrafish whole kidney marrow (WKM) tissue</title><p>To test whether Image3C could identify homogeneous and biologically meaningful cell populations, we used the research organism <italic>Danio rerio</italic>. We obtained cells from adult female zebrafish WKM (location of the hematopoietic tissue) in homeostasis condition, stained them, and ran on the ImageStream<sup>X</sup> Mark II. We analyzed intrinsic morphological and fluorescent features, such as cell and nuclear size, shape, and darkfield signal (side scatter [SSC]). Feature values were extracted from each cell image and processed through our pipeline (see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for feature description). Clustering by the final set of normalized and non-redundant morphological and fluorescent features produced distinct cell populations (<xref ref-type="fig" rid="fig2">Figure 2A–C</xref>, <xref ref-type="fig" rid="fig2s1">Figure 2—figure supplements 1</xref>–<xref ref-type="fig" rid="fig2s3">3</xref>).</p><fig-group><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Analysis of cell composition of adult zebrafish whole kidney marrow (WKM).</title><p>(<bold>A</bold>) WKM tissue obtained from zebrafish is prepared for image-based flow cytometric analyses and run on the ImageStream<sup>X</sup> Mark II (n = 8). Standard gating of focused and nucleated events and manual outgating of most erythrocytes was performed using IDEAS software. The selected images were processed through the pipeline described in <xref ref-type="fig" rid="fig1">Figure 1</xref> and clustered based only on intrinsic morphological and fluorescent feature values. Force-directed layout (FDL) graph visualizes 16 clusters, and each color represents a unique cell cluster. (<bold>B</bold>) Representative cell images belonging to each cluster are shown to evaluate the homogeneity of the cluster and determine morphology of the cells for cluster annotation. Representative cells for all the identified clusters are shown in <xref ref-type="supplementary-material" rid="supp4">Supplementary file 4</xref>. Merge represents the overlay of brightfield (BF) and Draq5 (nuclear staining) signal. (<bold>C</bold>) Spearman’s correlation plot shows the average feature values of the images in each cluster to highlight morphological similarities and differences between events belonging to different clusters, such as cell size or cytoplasm granularity (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). (<bold>D</bold>) Box plot of relative abundance of events within each cluster follows the same color code used in (<bold>A</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig2-v2.tif"/></fig><fig id="fig2s1" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 1.</label><caption><title>Feature correlation for morphology assay on adult zebrafish whole kidney marrow (WKM).</title><p>An example of feature correlation and feature trimming step is shown. The correlation between feature is calculated (<bold>A</bold>) and the redundant features are removed in order to leave only one representative feature for each group of features with high correlation (<bold>B</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig2-figsupp1-v2.tif"/></fig><fig id="fig2s2" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 2.</label><caption><title>Sample correlation for morphology assay on adult zebrafish whole kidney marrow (WKM).</title><p>Sample correlation and outlier sample removal step performed on samples of adult zebrafish WKM. The correlation between samples is calculated, and samples with clear outlier profile are removed from the subsequent analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig2-figsupp2-v2.tif"/></fig><fig id="fig2s3" position="float" specific-use="child-fig"><label>Figure 2—figure supplement 3.</label><caption><title>DNA normalization for morphology assay on adult zebrafish whole kidney marrow (WKM).</title><p>An example of DNA normalization step is shown. The fluorescent peaks of DNA staining for all the samples of one experiment are shown before (<bold>A</bold>) and after (<bold>B</bold>) normalization that aims to align the 2N and 4N peaks across samples.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig2-figsupp3-v2.tif"/></fig></fig-group><p>Image3C can distinguish between the major classes of cells present in zebrafish WKM (<xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp4">4</xref>) that were described using standard sorting flow cytometry and morphological staining approaches (<xref ref-type="bibr" rid="bib47">Traver et al., 2003</xref>). It is noteworthy that Image3C can clearly identify dead cells and debris (<xref ref-type="fig" rid="fig2">Figure 2A, B</xref>) allowing to optimize experimental protocols in order to minimize cell death and run the subsequent analysis only on the intact, live cells. Image3C can identify cells with outstanding morphological features, such as neutrophils from other myelomonocytes (<xref ref-type="fig" rid="fig2">Figure 2B, C</xref>). Based on zebrafish neutrophil characteristics such as high granularity, high complexity, and low circularity of the nuclei (<xref ref-type="bibr" rid="bib29">Lugo-Villarino et al., 2010</xref>), this type of granulocytes can be easily distinguished. Other types of myelomonocytes, such as monocytes and eosinophils, are here merged in the same cluster since in zebrafish they share many morphological characteristics (<xref ref-type="bibr" rid="bib29">Lugo-Villarino et al., 2010</xref>). Similarly, using only intrinsic morphological features for the clustering, different lymphocytes (B and T-cells) and hematopoietic stem cells cannot be separated from each other, but they can be clearly distinguished from the myelomonocytes (<xref ref-type="fig" rid="fig2">Figure 2A, B</xref>). Within the lymphocytes/progenitors fraction, we find two clusters (<italic>Dr</italic>1 and <italic>Dr</italic>7) that mainly differ in cell diameter (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). Whether this morphological difference has a biological implication needs to be studied in future experiments.</p><p>Image3C also enables the quantification of cell populations (clusters or CNN classes)-relative abundance, an important tool for comparing population composition across different treatment groups under different environmental conditions (<xref ref-type="bibr" rid="bib39">Peuß et al., 2020</xref>). Here, we compared our results with previously published data to validate our method. Although a direct comparison with results from classical approaches (<xref ref-type="bibr" rid="bib47">Traver et al., 2003</xref>) is not possible since we gated out (removed analytically) mature erythrocytes before clustering (Materials and methods), the myelomonocyte to lymphocyte ratio (M/L ratio = 1.59) is similar to the one obtained with classic histological approaches (mean M/L ratio = 1.35) (<xref ref-type="fig" rid="fig2">Figure 2D</xref>; <xref ref-type="bibr" rid="bib47">Traver et al., 2003</xref>).</p></sec><sec id="s2-3"><title>Image3C identifies professional phagocytes in zebrafish WKM tissue</title><p>Next, we sought to determine whether Image3C could be used to characterize and quantify biological processes by identifying a tissue of interest and then comparing cellular composition dynamics, functions, and physiological responses of specific cell types across a range of experimental conditions. Our goal was to detect statistically significant changes in cluster relative abundance between control and treated samples to gain a more detailed understanding of cell population dynamics and individual cell function.</p><p>As proof of concept, we performed a standard phagocytosis assay using WKM tissue from female adult zebrafish. The single cell suspension was incubated with CellTrace Violet labeled <italic>Staphylococcus aureus</italic> (CTV-<italic>S. aureus</italic>) and with dihydrorhodamine-123 (DHR), a ROS indicator that becomes fluorescent if oxidized to report oxidative bursting following phagocytosis. As controls, we inhibited phagocytosis through cytoskeletal impairment with cytochalasin B (CCB) incubation or through incubation with bacteria at lowered temperature by placing culture plates on ice. Events collected on the ImageStream<sup>X</sup> Mark II were analyzed with Image3C and clustered in 26 distinct clusters using quantifications of morphological and fluorescent features (see <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> for feature description), including nuclear staining, phagocytized <italic>S. aureus,</italic> and DHR positivity (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>). Professional phagocytes are defined by their ability to take up <italic>S. aureus</italic> (CTV staining lies within the cell boundary) and induce a ROS response (bright DHR signal) (<xref ref-type="bibr" rid="bib42">Rabinovitch, 1995</xref>). In zebrafish, professional phagocytes are mainly granulocytes and monocytic cells and can be discriminated from each other based on morphological differences, such as cell size, granularity, and nuclear shape (<xref ref-type="bibr" rid="bib55">Wittamer et al., 2011</xref>). To compare samples incubated with CTV-<italic>S. aureus</italic> and the samples where phagocytosis is inhibited (CTV-<italic>S. aureus</italic> + CCB and CTV-<italic>S. aureus</italic> + Ice), we used the statistical analysis included in Image3C based on a negative binomial regression model (<xref ref-type="fig" rid="fig3">Figure 3B, C</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>; <xref ref-type="supplementary-material" rid="supp5">Supplementary files 5</xref> and <xref ref-type="supplementary-material" rid="supp6">6</xref>). Statistical analyses reported clusters with differences in relative abundance between phagocytosis and phagocytosis-inhibited samples. Visualizing these clustered event images (<xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>) while considering the values and intensities of their morphological and fluorescent features (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>) allowed identification of 4 clusters of professional phagocytes: granulocytes within clusters <italic>Dr</italic>4_P, <italic>Dr</italic>12_P, and <italic>Dr</italic>13_P and monocytic cells in cluster <italic>Dr</italic>21_P (<xref ref-type="fig" rid="fig3">Figure 3A, B</xref>). The morphology of cells in cluster <italic>Dr</italic>12_P is characteristic of phagocytic neutrophils (<xref ref-type="fig" rid="fig2">Figure 2B</xref>, <xref ref-type="fig" rid="fig3">Figure 3A</xref>) that become adhesive and produce extracellular traps upon recognition of bacterial antigens (<xref ref-type="bibr" rid="bib36">Palić et al., 2007</xref>). Overall, the relative abundance of professional phagocytes is 5–10% (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), which is in line with previous studies that estimated the number of professional phagocytes in WKM tissue of adult zebrafish using classical morphological approaches (<xref ref-type="bibr" rid="bib55">Wittamer et al., 2011</xref>). It is also noteworthy that in line with other studies (<xref ref-type="bibr" rid="bib35">Page et al., 2013</xref>) we did not observe a cluster of lymphocytes (<italic>e.g.</italic>, B-cells) that actively phagocytize CTV-<italic>S. aureus</italic> bacteria (<xref ref-type="fig" rid="fig2">Figure 2</xref>; <xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>). Compared to the classical morphological approaches, Image3C allows to analyze thousands of events in a high-throughput and unbiased fashion, allowing the study of rare cell morphologies and increasing results confidence and reproducibility. These results show that Image3C can successfully analyze biological processes since we were able to recapitulate the presence, cell type, and frequency of professional phagocytes in adult zebrafish WKM organ.</p><fig-group><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Identification of professional phagocytes in zebrafish whole kidney marrow (WKM).</title><p>(<bold>A</bold>) A phagocytosis assay was performed on a cell suspension obtained from zebrafish WKM tissue and the samples were subsequently run on the ImageStream<sup>X</sup> Mark II (n = 6). Force-directed layout (FDL) graph shows 26 clusters, and each color represents a unique cell cluster. Representative cell images belonging to the 4 clusters containing professional phagocytes are shown. Representative cells for all the identified clusters are shown in <xref ref-type="supplementary-material" rid="supp7">Supplementary file 7</xref>. Merge represents the overlay of dihydrorhodamine-123 (DHR) (reactive oxygen species indicator), CellTrace Violet (CTV) (<italic>S. aureus</italic> labeling), and Draq5 (nuclear staining) channels. <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> reports the features used for this clustering. (<bold>B</bold>) Volcano plot illustrates comparison of cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + CCB). The log fold change (logFC) is plotted in relation to the false discovery rate (FDR)-corrected p-value (-log<sub>10</sub>) of each individual cluster calculated with negative binomial regression model (n = 6) (<xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). Dot color follows the same color code used in (<bold>A</bold>). (<bold>C</bold>) Box plot of relative abundances of events within the 4 clusters containing professional phagocytes in the 3 samples: phagocytosis samples (CTV-<italic>S. aureus</italic>), CCB-inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + CCB), and ice-inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + Ice) (<xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>). Statistically significant differences are calculated using the negative binomial regression model between the phagocytosis and the inhibited phagocytosis samples (<xref ref-type="supplementary-material" rid="supp5">Supplementary files 5</xref> and <xref ref-type="supplementary-material" rid="supp6">6</xref>). ** indicates p≤0.01 and n.s. indicates not significantly different after FDR (n = 6).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig3-v2.tif"/></fig><fig id="fig3s1" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 1.</label><caption><title>Sample correlation for phagocytosis assay on adult zebrafish whole kidney marrow (WKM).</title><p>Sample correlation and outlier sample removal step performed on samples of adult zebrafish WKM after phagocytosis assay. The correlation between samples is calculated, and samples with clear outlier profile are removed from the subsequent analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig3-figsupp1-v2.tif"/></fig><fig id="fig3s2" position="float" specific-use="child-fig"><label>Figure 3—figure supplement 2.</label><caption><title>Phagocytosis assay on adult zebrafish whole kidney marrow (WKM) (ice phagocytosis inhibition).</title><p>Volcano plot illustrates comparison between phagocytosis samples (CellTrace Violet labeled <italic>Staphylococcus aureus</italic> [CTV-<italic>S. aureus</italic>]) and ice-inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + Ice). The log fold change (logFC) is plotted in relation to the false discovery rate (FDR)-corrected p-value (-log<sub>10</sub>) of each individual cluster calculated with negative binomial regression model (n = 6) (<xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>). Dot color follows the same color code used in <xref ref-type="fig" rid="fig3">Figure 3A</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig3-figsupp2-v2.tif"/></fig></fig-group><p>A new aspect that Image3C highlighted is that CCB selectively affects cell viability based on cell identity, introducing artifacts and cell damage, actions not specific to inhibition of phagocytosis (<xref ref-type="fig" rid="fig3">Figure 3B</xref>). All mature erythrocyte-containing clusters had a significantly higher cell count in the CTV-<italic>S. aureus</italic> samples compared to the CTV-<italic>S. aureus</italic> + CCB ones (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp5">5</xref>). Cluster analysis revealed that erythrocytes were almost absent in samples incubated with CCB (<xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>), while there was a significant increase in the relative abundance of clusters containing dead and apoptotic cells (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). Both outcomes are likely due to reduced cell viability of erythrocytes upon CCB incubation. Moreover, we excluded the possibility of higher cell death in the professional phagocytes upon CCB incubation since pseudo-phagocytes (phagocytes with DHR response but no internalized CTV-<italic>S. aureus</italic>) were significantly more abundant in the CTV-<italic>S. aureus</italic> + CCB sample (<xref ref-type="fig" rid="fig3">Figure 3B</xref>; <xref ref-type="supplementary-material" rid="supp5">Supplementary file 5</xref>). These results are remarkable since Image3C allowed us to observe a specific effect of CCB on erythrocytes' viability in zebrafish that, as far as we know, was not described before.</p><p>Image3C analysis also uncovered another important biological observation. When we inhibited phagocytosis by incubating the single cell suspension on ice (CTV-<italic>S. aureus</italic> + Ice) and compared the specificity of inhibition with the CTV-<italic>S. aureus</italic> + CCB sample (<xref ref-type="fig" rid="fig3">Figure 3C</xref>; <xref ref-type="supplementary-material" rid="supp6">Supplementary file 6</xref>), we discovered that the inhibition of phagocytosis through low temperature only affects adhesive neutrophils (cluster <italic>Dr</italic>12_P) (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). This is suspected to occur as ice inhibits adhesion, while CCB effectively blocks phagocytosis in all professional phagocytes in zebrafish WKM tissue by acting on the cytoskeleton. The use of Image3C allowed us to specifically identify cell types that are sensible to low temperature and those that are not, confirming the existence of different phagocytosis mechanisms and providing additional knowledge about pros and cons of different protocols that can be applied to inhibit phagocytosis based on specific goals and needs.</p></sec><sec id="s2-4"><title>Image3C recapitulates cell composition of freshwater snail hemolymph</title><p>Since we aimed to provide a tool that is widely applicable, we tested Image3C versatility on the apple snail <italic>Pomacea canaliculata,</italic> an emerging organism for which molecular and cell biological tools have yet to be fully developed. As such, we repeated the same experiments done in zebrafish on the hemolymph of <italic>P. canaliculata.</italic> For morphological examination of the cellular composition of the hemolymph collected from female adults in homeostasis conditions, we stained the single cell suspensions with Draq5 (DNA dye) and ran on the ImageStream<sup>X</sup> Mark II. We used Image3C to analyze the images of the events and identified 9 cell clusters (<xref ref-type="fig" rid="fig4">Figure 4A</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>). Two of these clusters comprised cell doublets, debris, and dead cells (clusters <italic>Pc</italic>5 and <italic>Pc</italic>8) and the other clusters, based on inspection of cell images, were grouped into two main categories (<xref ref-type="fig" rid="fig4">Figure 4A</xref>; <xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>). The first category includes small blast-like cells (cluster <italic>Pc</italic>4) and intermediate cells (clusters <italic>Pc</italic>2 and <italic>Pc</italic>3) with high nuclear-cytoplasmic (N/C) ratio. These cells morphologically resemble the Group I hemocytes previously described using a classical morphological approach (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). The second category comprised larger cells with lower N/C ratio and abundant membrane protrusions (clusters <italic>Pc</italic>1, <italic>Pc</italic>6, <italic>Pc</italic>7, and <italic>Pc</italic>9). Likely, these cells correspond to the previously described Group II hemocytes that include both granular and agranular cells (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>).</p><fig-group><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Analysis of <italic>P. canaliculata</italic> hemocyte population using only intrinsic morphological features of the cells.</title><p>(<bold>A</bold>) Hemocytes obtained from the apple snail <italic>P. canaliculata</italic> are prepared for image-based flow cytometric analyses and run on the ImageStream<sup>X</sup> Mark II (n = 5). Standard gating of focused and nucleated events was performed using IDEAS software. The selected images were processed through the pipeline described in <xref ref-type="fig" rid="fig1">Figure 1</xref> and clustered based only on intrinsic morphological and fluorescent feature values. Force-directed layout (FDL) graph is used to visualize the 9 identified clusters, and each color represents a unique cell cluster. Representative cell images belonging to each cluster are shown to evaluate the homogeneity of the cluster and determine morphology of the cells for cluster annotation. Additional representative cells for all the identified clusters are shown in <xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>. Merge represents the overlay of brightfield (BF) and Draq5 (nuclear staining) signal. (<bold>B</bold>) Spearman’s correlation plot shows the average feature values of the images in each cluster to highlight morphological similarities and differences between events belonging to different clusters, such as cell size or cytoplasm granularity (<xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref>). Cluster <italic>Pc</italic>6 is the one among large hemocytes with higher values in features describing cytoplasm granularity (<italic>i.e.</italic>, area granularity #2, intensity granularity #18, and signal granularity #11). (<bold>C</bold>) Box plot of relative abundance of events within each cluster following the same color code used in (<bold>A</bold>). Clusters <italic>Pc</italic>5 and <italic>Pc</italic>8, constituted by duplets and dead cells, are those with the lowest number of events, validating the protocol used to prepare these samples.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig4-v2.tif"/></fig><fig id="fig4s1" position="float" specific-use="child-fig"><label>Figure 4—figure supplement 1.</label><caption><title>Sample correlation for morphology assay on <italic>P. canaliculata</italic> hemocytes.</title><p>Sample correlation and outlier sample removal step performed on samples of <italic>P. canaliculata</italic> hemocytes. The correlation between samples is calculated, and samples with clear outlier profile are removed from the subsequent analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig4-figsupp1-v2.tif"/></fig></fig-group><p>To identify which of these clusters were enriched for granular cells, we looked at the heatmap with feature values for each individual cluster (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; see <xref ref-type="supplementary-material" rid="supp1">Supplementary file 1</xref> for feature description). Cluster <italic>Pc</italic>6 had the highest values for the features related to cytoplasm texture and granularity (<italic>i.e.</italic>, area granularity, intensity granularity, and signal granularity) amongst all clusters other than cell doublets (<xref ref-type="fig" rid="fig4">Figure 4B</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp8">8</xref>). Based on these data, we identified cluster <italic>Pc</italic>6 as the one containing the granular hemocytes. The clusters obtained by Image3C were not only homogeneous and biologically meaningful but were also consistent with published <italic>P. canaliculata</italic> hemocyte classification obtained by classical morphological methods (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). Such remarkable consistency was observed both in terms of identified cell morphologies and their relative abundance in the population of circulating hemocytes (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; <xref ref-type="supplementary-material" rid="supp8">Supplementary file 8</xref>). For example, the relative abundance of the previously reported small blast-like cells is 14.0%, a value almost identical to the abundance of the corresponding cluster <italic>Pc</italic>4 (13.8%).</p><p>Similarly, the category of larger hemocytes or Group II hemocytes represents 80.4% of the circulating cells as measured by traditional morphological methods, while clusters <italic>Pc</italic>1, <italic>Pc</italic>6, <italic>Pc</italic>7, and <italic>Pc</italic>9 combined represent 72.4% of the events analyzed with Image3C (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). A subset of these cells are the granular cells (cluster <italic>Pc</italic>6), which correspond to 7.7% of all hemocytes by classical histological methods and 8.9% by Image3C. The intermediate cells (clusters <italic>Pc</italic>2 and <italic>Pc</italic>3) are the least represented in both approaches, with a relative abundance of 5.6% and 10.6% for the manually and Image3C analyzed events, respectively (<xref ref-type="fig" rid="fig4">Figure 4C</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary file 3</xref>). This difference is likely best explained by the remarkable difference in both the number of cells and the number of features that can be considered for analysis by Image3C. Only a few hundred hemocytes were visually analyzed using traditional histological methods based only on cell diameter and N/C ratio (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). In contrast, the automated pipeline used by Image3C facilitated the analysis of 10,000 nucleated events for each sample and considered 25 morphological features for each cell. The significantly higher number of morphological features simultaneously considered by Image3C also explains the higher number of clusters and improved resolution to distinguish cell types compared to the traditional methods. Hence, Image3C not only can properly analyze cells obtained from an emerging research organism generating biologically meaningful and informative clusters but also represents an unprecedented increase in the accuracy of cell type identification over traditional histological methods, while also allowing high-throughput capability.</p></sec><sec id="s2-5"><title>Image3C identifies phagocytosis-competent cells in the hemolymph of a freshwater snail</title><p>As with zebrafish, we also performed a phagocytosis experiment on hemocytes from <italic>P. canaliculata</italic>. Our goal was to test if it is possible with an emerging research organism to successfully discover cell phenotypes and functions and obtain information about specific biological processes of interest by using Image3C to compare cell populations among treated and control samples.</p><p>Here, we setup the phagocytosis assay incubating the cells with CTV-<italic>S. aureus</italic> and DHR at room temperature. The phagocytosis was inhibited, as control, either adding EDTA (CTV-<italic>S. aureus</italic> + EDTA) or using low temperature by incubating samples on ice (CTV-<italic>S. aureus</italic> + Ice). Events collected on the ImageStream<sup>X</sup> Mark II were analyzed with Image3C and clustered in 20 distinct clusters using quantifications of morphological and fluorescent features (see <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> for feature description), including nuclear staining, phagocytized <italic>S. aureus,</italic> and DHR positivity (<xref ref-type="fig" rid="fig5">Figure 5A</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>). We compared the phagocytosis-permissive samples (CTV-<italic>S. aureus</italic>) with samples where phagocytosis was inhibited by EDTA incubation or low temperature using the statistical analysis included in Image3C based on a negative binomial regression model (<xref ref-type="fig" rid="fig5">Figure 5B, C</xref>, <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>; <xref ref-type="supplementary-material" rid="supp9">Supplementary files 9</xref> and <xref ref-type="supplementary-material" rid="supp10">10</xref>). The clusters with relative abundance significantly higher in the phagocytosis samples (<xref ref-type="fig" rid="fig5">Figure 5B</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp11">11</xref>) and with high intensities of both DHR and bacteria signals (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplements 3</xref> and <xref ref-type="fig" rid="fig5s4">4</xref>) are the two clusters that we identify as enriched with professional phagocyte (cluster <italic>Pc</italic>5_P and <italic>Pc</italic>17_P) (<xref ref-type="fig" rid="fig5">Figure 5B</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig5s4">Figure 5—figure supplement 4</xref>; <xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref>). The two clusters show a different DHR signal intensity (ROS response) from one another upon bacteria exposure (cluster <italic>Pc</italic>5_P with high DHR signal, cluster <italic>Pc</italic>17_P with low DHR signal) (<xref ref-type="fig" rid="fig5s3">Figure 5—figure supplement 3</xref>; <xref ref-type="supplementary-material" rid="supp3">Supplementary files 3</xref> and <xref ref-type="supplementary-material" rid="supp11">11</xref>). Both <italic>Pc</italic>5_P and <italic>Pc</italic>17_P relative abundance is significantly higher in the phagocytosis samples compared to the EDTA-treated sample (<xref ref-type="fig" rid="fig5">Figure 5C</xref>; <xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>), showing that EDTA effectively inhibits phagocytosis for both types of professional phagocytes. In the sample where the phagocytosis was inhibited by low temperature, however, only cluster <italic>Pc</italic>17_P had a significantly lower relative abundance compared to the phagocytosis sample (<xref ref-type="fig" rid="fig5">Figure 5C</xref>, <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>; <xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>). We can conclude that similar to CCB inhibition in the zebrafish phagocytosis experiment, EDTA is a more effective and generalized (not cell type-specific) inhibitor of phagocytosis than low temperature. These results show that also in an emerging research organism Image3C allowed discovery of new aspects of this biological process and highlighted differences among professional phagocytes that would have been difficult to detect with other methods.</p><fig-group><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Identification of professional phagocytes among <italic>P. canaliculata</italic> hemocytes.</title><p>(<bold>A</bold>) A phagocytosis assay was performed on a cell suspension obtained from apple snail <italic>P. canaliculata</italic> hemolymph, and the samples were subsequently run on the ImageStream<sup>X</sup> Mark II (n = 5). Force-directed layout (FDL) graph shows 20 clusters, and each color represents a unique cell cluster. Representative cell images belonging to the two clusters containing professional phagocytes are shown. Representative cells for all the identified clusters are shown in <xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref>. Merge represents the overlay of dihydrorhodamine-123 (DHR) (reactive oxygen speciesindicator), CellTrace Violet (CTV) (<italic>S. aureus</italic> labeling), and Draq5 (nuclear staining) channels. <xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref> reports the features used for this clustering. (<bold>B</bold>) Volcano plot illustrates comparison of cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + EDTA). The log fold change (logFC) is plotted in relation to the false discovery rate (FDR)-corrected p-value (-log<sub>10</sub>) of each individual cluster calculated with negative binomial regression model (n = 4) (<xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>). Dot color follows the same color code used in (<bold>A</bold>). (<bold>C</bold>) Box plot of relative abundances of events within the two clusters containing professional phagocytes in the 3 samples: phagocytosis samples (CTV-<italic>S. aureus</italic>), EDTA-inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + EDTA), and ice-inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + Ice) (<xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>). Statistically significant differences are calculated using the negative binomial regression model between the phagocytosis and the inhibited phagocytosis samples (<xref ref-type="supplementary-material" rid="supp9">Supplementary files 9</xref> and <xref ref-type="supplementary-material" rid="supp10">10</xref>). ** indicates p≤0.01 and n.s. indicates not significantly different after FDR (n = 4).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig5-v2.tif"/></fig><fig id="fig5s1" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 1.</label><caption><title>Sample correlation for phagocytosis assay on <italic>P. canaliculata</italic> hemocytes.</title><p>Sample correlation and outlier sample removal step performed on samples of <italic>P. canaliculata</italic> hemocytes after phagocytosis assay. The correlation between samples is calculated, and samples with clear outlier profile are removed from the subsequent analysis.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig5-figsupp1-v2.tif"/></fig><fig id="fig5s2" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 2.</label><caption><title>Phagocytosis assay on <italic>P. canaliculata</italic> hemocytes (ice-inhibited phagocytosis).</title><p>Volcano plot illustrates comparison between phagocytosis samples (CellTrace Violet labeled <italic>Staphylococcus aureus</italic> [﻿CTV-<italic>S. aureus</italic>]) and inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + Ice). The log fold change (logFC) is plotted in relation to the false discovery rate (FDR)-corrected p-value (-log<sub>10</sub>) of each individual cluster calculated with negative binomial regression model (n = 4) (<xref ref-type="supplementary-material" rid="supp10">Supplementary file 10</xref>). Dot color follows the same color code used in <xref ref-type="fig" rid="fig5">Figure 5A</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig5-figsupp2-v2.tif"/></fig><fig id="fig5s3" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 3.</label><caption><title>Feature heatmap after phagocytosis assay on <italic>P. canaliculata</italic> hemocytes.</title><p>Spearman’s correlation plot shows the average feature values of the images in each cluster to highlight morphological similarities and differences between events belonging to different clusters, such as cell size or cytoplasm granularity (<xref ref-type="supplementary-material" rid="supp2">Supplementary file 2</xref>). The clusters with higher dihydrorhodamine-123 (DHR) signal and high bacteria are the one identified as containing professional phagocytes (Pc5_P and Pc17_P). This is also confirmed by the statistical analysis performed between the phagocytosis samples (CellTrace Violet labeled <italic>Staphylococcus aureus</italic> [CTV-<italic>S. aureus]</italic>) and inhibited phagocytosis samples (CTV-<italic>S. aureus</italic> + EDTA) (<xref ref-type="fig" rid="fig5">Figure 5B</xref>; <xref ref-type="supplementary-material" rid="supp9">Supplementary file 9</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig5-figsupp3-v2.tif"/></fig><fig id="fig5s4" position="float" specific-use="child-fig"><label>Figure 5—figure supplement 4.</label><caption><title>Gallery of <italic>P. canaliculata</italic> hemocytes after phagocytosis assay.</title><p>Representative cell images side-by-side of professional phagocytes and non-phagocytic hemocytes from apple snail samples after phagocytosis assay. The signal of the bacteria labeled with CellTrace Violet is showed in yellow, and the value for the signal intensity has been reported on the top of each individual image. These images were obtained using the gallery function of the Amnis IDEAS software and manually gating either events double positive for dihydrorhodamine-123 (DHR) and bacteria or events double negative.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig5-figsupp4-v2.tif"/></fig></fig-group><p>The data analysis with Image3C clearly highlighted that CCB and EDTA, two classical phagocytic inhibitors commonly used in controls for phagocytosis experiments in vertebrates and invertebrates, respectively, result in a drastic change of cell morphology and cell viability. This consequence is not easily detectable by other methods and is therefore often overlooked. In the present work, these changes significantly modified the overall cell cluster number and distribution and indicate that the effects of CCB and EDTA on cell morphology should be taken into consideration in any study of morphological features of cells with phagocytosis properties because artifacts might be significant.</p></sec><sec id="s2-6"><title>CNN allows unbiased comparison between experiments</title><p>When determining differences between control and experimental treatments, Image3C necessarily combines images and data from all samples and then clusters the cells. This must be taken into consideration for experimental planning. Experiments meant to analyze cell composition and morphological diversity in one biological domain (<italic>e.g.</italic>, homeostasis condition) (<xref ref-type="fig" rid="fig2">Figure 2</xref>, <xref ref-type="fig" rid="fig4">Figure 4</xref>) should be carried out separately from those in other domains that are likely to introduce changes in the cell population composition or cell morphologies representing a confounding factor for the <italic>de novo</italic> clustering in homeostasis condition. Image3C clustering works best when used, at the same time, only on samples belonging to a single experimental domain, such as homeostasis or the phagocytosis assay. An issue that emerges when analyzing different experimental sets independently is the increase of time requirement for analytical steps, the likelihood of introducing errors, and the need to repeatedly annotate the clusters in the FDL graph obtained from each experimental set. This last element is required for comparing cell type behaviors among multiple experiments and provide a global understanding of their functions and response to treatments (<italic>i.e.</italic>, cluster #1 from one analytical run cannot be expected to match cell morphologies with cluster #1 from another run since there is a stochastic element to the process).</p><p>This last point is probably the most challenging since mistakes can easily be introduced based on user biases or lack of sufficient pre-existing knowledge about cell morphologies or of cell biomarkers that would allow a confident cross-annotation between multiple FDL graphs. In addition, we observed that the number of clusters drastically increases when including treatments that influence cell morphological properties of the cell. As an example, while we detected 9 unique clusters in naïve hemolymph samples, we detected 20 clusters in the phagocytosis experiment (<xref ref-type="fig" rid="fig3">Figure 3A</xref>, <xref ref-type="fig" rid="fig4">Figure 4A</xref>). This is in part due to the fact that professional phagocytes change their morphology upon detection of pathogens (<xref ref-type="bibr" rid="bib36">Palić et al., 2007</xref>), thus creating new clusters. Similarly, the complexity of the clustering is also increased by treatments, such as CCB and EDTA incubations, that are necessary to ensure identification of professional phagocytes, but have a strong impact on the morphology of the cells making the clustering and annotation steps more challenging and prone to mistakes since treated samples contain aberrant populations not found at homeostasis (<xref ref-type="fig" rid="fig5">Figure 5A</xref>; <xref ref-type="supplementary-material" rid="supp11">Supplementary file 11</xref>).</p><p>To provide an alternative for streamlining the analysis of multiple experimental sets upon initial <italic>de novo</italic> clustering and cell type identification in homeostasis samples, we included in Image3C the possibility to use these initial images and their cluster IDs to train a CNN without manually classifying the images (<xref ref-type="fig" rid="fig1">Figure 1</xref>). This trained classifier can then be used to assign the cell images subsequently collected from additional experimental sets to one of the clusters defined in the homeostasis condition in a high-throughput way. In this way, it will be possible to determine the behavior of a specific cell type through multiple experimental sets without re-clustering whenever new data is acquired. A crucial element that allows this approach is also represented by the ImageStream<sup>X</sup> Mark II system that provides highly reproducible and comparable images of cells coming from different experiments and acquired at different days, introducing much less variability than standard light or electron microscopy.</p><p>For our pipeline, then, a CNN (<xref ref-type="bibr" rid="bib25">LeCun et al., 1989</xref>) based on the architecture of DenseNet (<xref ref-type="bibr" rid="bib18">Huang et al., 2017</xref>) was deployed to (1) use, as training set, images and clusters obtained from a first group of samples (<italic>e.g.</italic>, homeostasis conditions, naïve cells, or WT samples) analyzed in an unbiased way by <italic>de novo</italic> clustering and (2) assign new cell images acquired through ImageStream<sup>X</sup> Mark II system to their respective classes. As proof of concept, we used the clusters identified for <italic>P. canaliculata</italic> hemocytes in homeostasis condition with the first part of the pipeline (<xref ref-type="fig" rid="fig4">Figure 4A</xref>) for training and setting up the CNN classifier. This approach would define the classes based on the unbiased <italic>de novo</italic> clustering of thousands of cells with no need for formal annotation or previous knowledge about cell types and tissue composition. To prepare a dataset for training the classifier, we first combined clusters that strongly overlapped with one another in terms of morphological characteristics (<italic>e.g.</italic>, doublets and dead cells) to increase accuracy of the classifier (<xref ref-type="fig" rid="fig6">Figure 6A</xref>). We used 80% of the cells obtained in the original <italic>P. canaliculata</italic> dataset together with their cluster IDs to train the classifier through over 25,000 iterations. After each iteration, we tested the training with 10% of the original dataset and determined the relative accuracy by scoring numbers of cells whose cluster ID assigned by the classifier matched the original cluster ID (<xref ref-type="fig" rid="fig6">Figure 6B, C</xref>). The remaining 10% of the original dataset was used to calculate the precision of the trained classifier. Clusters with higher support numbers obtained higher precision scores. The weighted average precision score (f1-score, precision average score across clusters controlling for support numbers) of 0.75 is relatively high considering the complexity of the phenotype (brightfield [BF], darkfield, and Draq5 images) (<xref ref-type="fig" rid="fig6">Figure 6D</xref>) and comparable to other studies using ML for cell classification (<xref ref-type="bibr" rid="bib4">Blasi et al., 2016</xref>). The true probability match for each individual cell (probability for each cell that the class assigned by the classifier would match the original cluster ID) demonstrated that lower true probability matches occurred where clusters strongly overlapped or where cell phenotypes are intermediate between clusters, providing an additional layer of information about our dataset (<xref ref-type="fig" rid="fig6">Figure 6D</xref>).</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Classifier training and use of convolutional neural network (CNN) for integrating multiple experiments.</title><p>(<bold>A</bold>) The CNN portion of Image3C allows the integration of multiple experiments and the analysis of additional samples assigning new events to already defined and annotated clusters without manual and potentially biased matching of clusters by the user. Images of cells obtained from homeostasis, naïve, or WT samples and already <italic>de novo</italic> clustered in an unbiased way by Image3C are exported as TIFF files together with their cluster IDs. <italic>P. canaliculata</italic> hemocytes in homeostasis condition obtained from female apple snails (35,000 images) is the dataset used for training the CNN classifier. Before the training, clusters with cells with strongly overlapping morphology were merged (<italic>Pc</italic>1 was merged with <italic>Pc</italic>9 and named <italic>Pc</italic>1_CT; <italic>Pc</italic>5 was merged with <italic>Pc</italic>8 and named <italic>Pc</italic>5_CT). CT: classifier training. (<bold>B</bold>) The training was performed on 80% of the exported images, and the testing during the training was performed on 10% of the exported images. Relative accuracy was recorded every 100 iterations for 25,000 iterations total. (<bold>C</bold>) Loss calculation was recorded every 100 iterations for 25,000 iterations total and indicates that the training set is not memorized. (<bold>D</bold>) The True match probability (probability that trained classifier-assigned cluster matches original cluster ID) is given for each cell of the remaining 10% of the original exported images. The detailed precision score for each cluster together with the weighted average (correcting for support) is reported in the table. (<bold>E</bold>) The CNN classifier allows for integrating experiments, such as phagocytosis assay and morphological assay, with minimal probability of introducing errors because of lack of biomarkers. The plot shows the distribution of the cells belonging to the snail professional phagocytes clusters (<italic>Pc</italic>5_P and <italic>Pc</italic>17_P from <xref ref-type="fig" rid="fig5">Figure 5</xref>, phagocytosis assay) among the clusters defined by morphological features using homeostasis conditions. (<bold>F</bold>) The CNN classifier allows also for the analysis of new samples obtained from the same species and the same tissue used for the training. The new events obtained running male <italic>P. canaliculata</italic> hemocytes are assigned to clusters defined by the <italic>de novo</italic> clustering step, allowing for comparison between samples (females vs. males) and statistical analysis for cluster relative abundance differences. The box plot shows the comparison of the hemocyte population composition between females and males (n = 5). *** are clusters with abundances robustly significantly different between female and male animals. * are clusters with p-value lower than 0.05, but whose abundances are no more significantly different after the correction for multiple testing (false discovery rate [FDR]). (<bold>G</bold>) Representative cell images for each cluster belonging to female and male hemocytes dataset allow to visually compare the cells used to train the classifier (female) with cells assigned by the classifier and coming from a new set of samples (males). Brightfield (BF), side scatter signal (SSC), and Draq5 (nuclear staining) signal are shown in individual channels.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-65372-fig6-v2.tif"/></fig><p>To test the efficiency of this pipeline, we extracted all the images belonging to the two clusters identified in the phagocytosis assay as cluster-containing phagocytes and determined to which naïve cell type they correspond using the CNN classifier and only the BF, SSC, and Draq5 channels (<italic>i.e.</italic>, DHR and labeled bacteria signals were not used). We found that 59.4, 6.2, and 9.2% of the phagocytes belonged to cluster <italic>Pc</italic>1_CT, <italic>Pc</italic>6_CT, and <italic>Pc</italic>7_CT, respectively (<xref ref-type="fig" rid="fig6">Figure 6E</xref>), where CT stands for classifier training. These results confirmed a previously published result that used classical morphological staining and manual annotation to conclude that the hemocytes able to phagocytize were primarily Group II hemocytes (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). Only 8% of the phagocytes were clustered in the Group I hemocytes, here represented by clusters <italic>Pc</italic>2_CT, <italic>Pc</italic>3_CT, and <italic>Pc</italic>4_CT, while the remaining 17.2% were assigned by the CNN to the cluster <italic>Pc</italic>5_CT, constituted by doublets and dead cells (<xref ref-type="fig" rid="fig6">Figure 6E</xref>). This result can be explained by the fact that <italic>in vitro</italic> phagocytosis triggers microaggregate formation (hemocyte-hemocyte adhesion) in invertebrate hemocytes that resembles the nodule formation observed <italic>in vivo</italic> (<xref ref-type="bibr" rid="bib50">Walters, 1970</xref>). It is important to observe how this analysis allowed us to assign phagocytes to cell types using the annotation already performed in <xref ref-type="fig" rid="fig4">Figure 4A</xref> (<italic>de novo</italic> clustering of hemocytes in homeostasis condition) without the need to reannotate the FDL obtained during the phagocytosis assay (<xref ref-type="fig" rid="fig5">Figure 5A</xref>).</p><p>To test the adaptability of the trained CNN to new datasets, we collected hemocytes from male apple snail specimens, stained the cells with Draq5, and recorded BF, SSC, and nuclei images from 10,000 cells on the ImageStream<sup>X</sup> Mark II as previously described. We extracted the images of the cells and used the trained CNN classifier to determine the relative abundance of hemocytes collected from male snails in the seven classes of the classifier (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). First, we visually compared the female hemocytes clustered by the <italic>de novo</italic> clustering with the male hemocytes that were run on the ImageStream<sup>X</sup> Mark II and were assigned to a class by the classifier (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). This comparison shows that the female and male hemocytes belonging to the same cluster are morphologically extremely similar and different from the hemocytes assigned to other clusters (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). This demonstrates that the CNN classifier can be trained with a first group of samples and then it can successfully analyze new datasets acquired later on. The comparison between female and male hemocyte compositions revealed that the clusters significantly different in terms of relative abundance are <italic>Pc</italic>1_CT and <italic>Pc</italic>7_CT (Group II agranular large hemocytes) and <italic>Pc</italic>6_CT (Group II granular large hemocytes) (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). Significantly, prior studies detected no differences between females and males hemocytes composition through manual classification and counting using a classical morphological approach (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). The reduced user bias and high-throughput analysis presented here, in contrast, allowed us to determine that one of the two subpopulations of agranular large hemocytes was significantly more abundant in the female animals (<italic>Pc</italic>1_CT: 53 and 38% in females and males, respectively) while the other agranular (<italic>Pc</italic>7_CT) as well as the granular large hemocytes (<italic>Pc</italic>6_CT) was significantly more abundant in the male animals (<italic>Pc</italic>7_CT: 14 and 20% in females and males, respectively; <italic>Pc</italic>6_CT: 6 and 10% in females and males, respectively) (<xref ref-type="fig" rid="fig6">Figure 6F</xref>).</p><p>While the biological significance of this observation is not going to be further investigated in this paper, the discovery highlights the power of Image3C analysis compared to traditional methods for determining and quantifying the composition of cell populations. These experiments demonstrate that Image3C, in combination with the presented convolutional classifier, can analyze large experimental datasets and identify significances with small effect sizes. Importantly, Image3C analysis is independent of observer biases and does not require prior knowledge about expected tissue composition or the expected effect of treatment on cell morphology.</p></sec><sec id="s2-7"><title>Conclusion</title><p>We have developed a powerful new method to analyze at single-cell resolution the composition of any cell population obtained from research organisms for which species-specific reagents (such as fluorescently tagged antibodies), biomarkers, single-cell atlases, or a high-quality genome for a scRNA-seq approach are not available. We demonstrated that Image3C can identify different cell populations based on morphology and/or function through <italic>de novo</italic> clustering and highlight important changes in cell type abundance and cell population composition caused by experimental or natural perturbation (sex, treatment, experimental protocol). Image3C does not require, at any point, prior knowledge about the tissue composition or cell type-specific markers, although, if available, they can be included and used. Furthermore, in combination with the CNN classifier trained on these clusters, we demonstrate that Image3C is capable of bias-free and high-throughput analysis of large experimental datasets making it possible to compare a specific cell type behavior or population composition across multiple experiments. Image3C is extremely versatile and can be applied to any tissue or cell population of interest and is adaptable to a variety of experimental designs. Although Image3C was developed in response to the need of analyzing cell composition of tissues in emerging research organisms, the Image3C tool could be potentially used also to add to transcriptomic dataset an additional and complementary layer of information based on cell morphology. Given the recent advancement in image-based flow cytometry that enables image capturing together with cell sorting (<xref ref-type="bibr" rid="bib32">Nitta et al., 2018</xref>), a scRNA-seq approach in combination with the Image3C pipeline would enable simultaneous analysis of both the morphological/phenotypic and genetic properties of a cell population at single-cell resolution.</p></sec></sec><sec id="s3" sec-type="materials|methods"><title>Materials and methods</title><table-wrap id="keyresource" position="anchor"><label>Key resources table</label><table frame="hsides" rules="groups"><thead><tr><th>Reagent type <break/>(species) <break/>or resource</th><th>Designation</th><th>Source or <break/>reference</th><th>Identifiers</th><th>Additional <break/>information</th></tr></thead><tbody><tr><td valign="top">Strain, strain background (<italic>Staphylococcus aureus</italic>)</td><td valign="top">Wood strain without protein A</td><td valign="top">Thermo Fisher Scientific</td><td valign="top">S2859</td><td valign="top"/></tr><tr><td valign="top">Biological sample (<italic>Danio rerio</italic>)</td><td valign="top">Whole kidney marrow</td><td valign="top">Stowers Institute for Medical Research</td><td valign="top">Wild type, adult females</td><td valign="top">Freshly isolated from <italic>Danio rerio</italic></td></tr><tr><td valign="top">Biological sample (<italic>Pomacea canaliculata</italic>)</td><td valign="top">Hemolymph</td><td valign="top">Stowers Institute for MedicalResearch</td><td valign="top">Wild type,adult females and males</td><td valign="top">Freshly isolated from<italic>Pomacea canaliculata</italic></td></tr><tr><td valign="top">Chemical compound, drug</td><td valign="top">Dihydrorhodamine-123 (DHR)</td><td valign="top">Thermo Fisher Scientific</td><td valign="top">D23806</td><td valign="top">5 µM</td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">IDEAS</td><td valign="top">Amnis Millipore Sigma</td><td valign="top">Version 6.2</td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">R code</td><td valign="top">This paper</td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link> (<xref ref-type="bibr" rid="bib5">Box, 2021</xref>)</td></tr><tr><td valign="top">Software, algorithm</td><td valign="top">VorteX clustering environment</td><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/nolanlab/vortex/releases">https://github.com/nolanlab/vortex/releases</ext-link></td><td valign="top"/><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">FSC Express</td><td valign="top">De Novo Software</td><td valign="top">Image or Plus configurations - Version 7</td><td valign="top"/></tr><tr><td valign="top">Software, algorithm</td><td valign="top">Python script</td><td valign="top">This paper</td><td valign="top"/><td valign="top"><ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link></td></tr><tr><td valign="top">Other</td><td valign="top">Draq5</td><td valign="top">Thermo Fisher Scientific</td><td valign="top">62251</td><td valign="top">5 µM</td></tr><tr><td valign="top">Other</td><td valign="top">CellTrace Violet (CTV)</td><td valign="top">Thermo Fisher Scientific</td><td valign="top">C34571</td><td valign="top">5 µM</td></tr></tbody></table></table-wrap><sec id="s3-1"><title>Collection of zebrafish WKM</title><p>Twelve-month-old, wild type, female, adult zebrafish were euthanized with cold 500 mg/L MS-222 solution for 5 min. WKM was dissected as previously described (<xref ref-type="bibr" rid="bib47">Traver et al., 2003</xref>) and transferred to 40 µm cell strainer with 1 mL of L-15 media containing 10% water, 10 mM HEPES, and 20 U/mL Heparin (L-90). Cells were gently forced through the cell strainer with the plunger of a 3 mL disposable syringe. The strainer was washed once with 1 mL of L-90 and the resulting single cell suspension was centrifuged at 500 rcf at 4 °C for 5 min. The supernatant was discarded, and the cells were resuspended in 1 mL of L-90 containing 5% fetal calf serum (FCS), 4 mM L-glutamine, and 10,000 U of both penicillin and streptomycin (L-90 media). The cells were counted in a 1:20 dilution on the EC-800 flow cytometer (Sony) using scatter properties.</p></sec><sec id="s3-2"><title>Collection of apple snail hemocytes</title><p>Specimens of the apple snail <italic>P</italic>. <italic>canaliculata</italic> (Mollusca, Gastropoda, Ampullariidae) were maintained and bred in captivity, in a water recirculation system filled with artificial freshwater (2.7 mM CaCl<sub>2</sub>, 0.8 mM MgSO<sub>4</sub>, 1.8 mM NaHCO<sub>3</sub>, 1:5000 Remineralize Balanced Minerals in Liquid Form [Brightwell Aquatics]). The snails were fed twice a week and kept in a 10:14 light:dark cycle. Wild-type adult snails, 7–9 months old and with a shell size of 45–60 mm, were starved for 5 days before the hemolymph collection (<xref ref-type="bibr" rid="bib2">Accorsi et al., 2013</xref>). If not differently specified, female snails were used for the experiments. The withdrawal was performed by applying a pressure on the operculum and dropping the hemolymph directly into an ice-cold tube. The hemolymph collected from different animals was not pooled together. The hemolymph was immediately diluted 1:4 in Bge medium + 10% fetal bovine serum (FBS) and then centrifuged at 500 rcf for 5 min. The pellet of cells was resuspended in 100 µL of Bge medium + 10% FBS. The Bge medium (also known as <italic>Biomphalaria glabrata</italic> embryonic cell line medium) is constituted by 22% (v/v) Schneider’s <italic>Drosophila</italic> Medium, 4.5 g/L lactalbumin hydrolysate, 1.3 g/L galactose, 0.02 g/L gentamycin in MilliQ water, pH 7.0.</p></sec><sec id="s3-3"><title>Experiment 1: morphology assay in homeostasis conditions</title><p>WKM cells from zebrafish were isolated as described before and plated at 4 × 10<sup>5</sup> cells/well in a 96-well plate in 200 µL of L-90 media and incubated for 3 h at room temperature. Cells were stained with 5 µM Draq5 (Thermo Fisher Scientific) for 10 min and subsequently run on the ImageStream<sup>X</sup> Mark II (Amnis Millipore Sigma), where 10,000 nucleated and focused events were recorded for each sample (n = 8). Erythrocytes were outgated to enrich for immune-relevant cells and prevent overclustering in the subsequent analysis. The latter is due to the fact that fish erythrocytes are nucleated and their biconcave shape results in different morphological feature values only depending on their orientation during image acquisition.</p><p>The <italic>P. canaliculata</italic> hemocytes were stained with 5 µM Draq5 for 10 min, moved to ice, and subsequently run on the ImageStream<sup>X</sup> Mark II, where 10,000 nucleated and focused events were imaged for each sample (n = 5).</p></sec><sec id="s3-4"><title>Experiment 2: phagocytosis assay</title><p><italic>Staphylococcus aureus</italic> (Thermo Fisher Scientific) were resuspended in PBS at the final concentration of 100 mg/mL and incubated with 5 µM CTV (Thermo Fisher Scientific) for 20 min. Labeled bacteria were centrifuged and resuspended in PBS for three times to remove unbound dye and then stored at −20 °C as single-use aliquots. Cells, obtained from fish WKM or snail hemolymph and in a single cell suspension, were plated in a 96-well plate at a concentration of 4 × 10<sup>5</sup> cells/well in 200 µL of medium and incubated with 2 × 10<sup>7</sup> CTV-coupled <italic>S. aureus</italic>/well for 3 h at room temperature. As control, the phagocytosis was inhibited incubating the cells + CTV-<italic>S. aureus</italic> mix either on ice (for both species) or with 0.08 mg/mL CCB for zebrafish cells or with 30 mM EDTA and 10 mM HEPES for apple snail cells (<xref ref-type="bibr" rid="bib9">Cueto et al., 2015</xref>; <xref ref-type="bibr" rid="bib27">Li et al., 2006</xref>). After 2 h and 30 min, we added 5 µM DHR (Thermo Fisher Scientific) to the cell suspension to stain cells positive for ROS production. To control for this treatment with DHR, we incubated one aliquot of cells with 10 ng/mL phorbol 12-myristate 13-acetate (PMA) to induce ROS production. At 2 h and 50 min since the beginning of incubation with CTV-<italic>S. aureus</italic>, all the samples were stained with 5 µM Draq5 for 10 min. After 3 h incubation with bacteria, cells were moved and stored on ice and subsequently run on the ImageStream<sup>X</sup> Mark II, where 10,000 nucleated and focused events were imaged for each sample (at least n = 4 snail and n = 6 fish) at a speed of 1,000 images/s.</p></sec><sec id="s3-5"><title>Data collection on ImageStream<sup>X </sup>Mark II</title><p>Following cell preparation, data were acquired from each sample on the ImageStream<sup>X</sup> Mark II at 60× magnification, slow/sensitive flow speed (1,000 images/s), using 633, 488, and 405 nm laser excitation. BF was acquired on channels 1 and 9, DHR (488 nm excitation) on channel 2, CTV-<italic>S. aureus</italic> (405 nm excitation) on channel 7, Draq5 (633 nm excitation) on channel 11, and SSC was acquired on channel 6. Single-color controls were also acquired for each fluorescent channel to allow for fluorescence spillover correction.</p></sec><sec id="s3-6"><title>Data analysis and <italic>de novo</italic> cluster identification</title><p>An interactive map representing the pipeline, the software used, the format of the exported files, and an approximation of time required for running the individual steps is provided in <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>. Raw images from the ImageStream<sup>X</sup> Mark II system (RIF files, a type of modified 16-bit TIFF file) were compensated (spillover and other corrections applied), background was subtracted, and features were calculated using IDEAS 6.2 software (Amnis Millipore, free for download once an Amnis user account is created). The resulting compensated image files (CIF files) were used to quantify features for all cells and samples. <xref ref-type="supplementary-material" rid="supp1">Supplementary files 1</xref> and <xref ref-type="supplementary-material" rid="supp2">2</xref> report the list of features used for each organism and for each experiment and their description. These per-object feature matrices (DAF files) were then exported from IDEAS into FCS files. Exported FCS files were processed in R (<xref ref-type="bibr" rid="bib41">R Development Core Team, 2014</xref>). In order to trim redundant features that contribute noise but little new information, Spearman’s correlation values for each pair of features were calculated using all events of a representative sample and one of the features of the pair was trimmed when correlation between the two was ≥0.85 (<xref ref-type="fig" rid="fig2s1">Figure 2—figure supplement 1</xref>; <xref ref-type="bibr" rid="bib6">Caicedo et al., 2017</xref>). The Spearman’s correlation of the mean values of remaining features per each sample was then used to identify outliers among sample replicates. Samples with correlation of mean feature values below 0.85 with the set were discarded (<xref ref-type="fig" rid="fig2s2">Figure 2—figure supplement 2</xref>, <xref ref-type="fig" rid="fig3s1">Figure 3—figure supplement 1</xref>, <xref ref-type="fig" rid="fig4s1">Figure 4—figure supplement 1</xref>, <xref ref-type="fig" rid="fig5s1">Figure 5—figure supplement 1</xref>), although in general the replicates were consistent. Also, while morphological features did not require any transformation or normalization, fluorescence intensity features were transformed using the estimateLogicle() and transform() functions from the R flowCore package (<xref ref-type="bibr" rid="bib11">Ellis et al., 2018</xref>; <xref ref-type="bibr" rid="bib14">Hahne et al., 2009</xref>) to improve homoscedasticity (homogeneity of variance) of distributions. DNA intensity features were also normalized to align all 2N and 4N peak positions and remove intensity drift between samples (<xref ref-type="fig" rid="fig2s3">Figure 2—figure supplement 3</xref>) using the gaussNorm() function from flowStats package (<xref ref-type="bibr" rid="bib15">Hahne et al., 2018</xref>). The processed data was exported from R (<xref ref-type="bibr" rid="bib41">R Development Core Team, 2014</xref>) using writeflowSet() function in flowCore package (<xref ref-type="bibr" rid="bib11">Ellis et al., 2018</xref>; <xref ref-type="bibr" rid="bib14">Hahne et al., 2009</xref>) as CSV or FCS files, depending on downstream needs for the file output.</p><p>These processed data files were then imported into the VorteX clustering environment for X-Shift k-nearest-neighbor clustering (free to install) (<xref ref-type="bibr" rid="bib44">Samusik et al., 2016</xref>). X-Shift was selected as a clustering method for Image3C based on a previously published analysis and comparison of clustering methods (<xref ref-type="bibr" rid="bib51">Weber and Robinson, 2016</xref>). From that work, we determined that X-shift represents an optimal trade-off: identifying low-frequency populations, accurately identifying ‘true’ clusters (<italic>i.e.</italic>, F1 scores), not requiring for <italic>a priori</italic> knowledge of the number of clusters (populations) and having reasonable runtimes (due to hardware CPU requirements). We also did an early comparison of X-shift with K-means (data not shown) and determined that K-means was insufficient for our purposes as known cell populations were not well represented by clusters, and we did not want to specify the number of expected clusters into the method’s input parameters since this would not be known in experimental use. During the import into VorteX, all features were scaled to 1 SD to equalize the contribution of features towards clustering. Clustering was performed in VorteX testing a range of k values (typically from 5 to 150), choosing a final k value using the ‘find elbow point for cluster number’ function in VorteX and confirming visually that over- or underclustering did not occur. FDL graphs of a subset of cells obtained from each set of samples were also generated in VorteX, and cell coordinates in the resultant 2D space were exported along with graphML representation of the FDL graph. Finally, tabular data (CSV files) was exported from VorteX including a master table of every cell event with its cluster assignment and original sample ID, as well as a table of the average feature values for each cluster and counts of cells per cluster and per sample.</p><p>Clustering results were further analyzed and plotted in R (<xref ref-type="bibr" rid="bib41">R Development Core Team, 2014</xref>) by merging all cell events and feature values with cluster assignments and X/Y coordinates for FDL graph. Using this merged data and the graphML file exported from VorteX, new FDL graphs were created for each treatment condition using the igraph package (<xref ref-type="bibr" rid="bib8">Csardi and Nepusz, 2006</xref>) in R (<xref ref-type="bibr" rid="bib41">R Development Core Team, 2014</xref>). Statistical analysis of differences in cell counts per cluster by condition was performed using negative binomial regression of cell counts per cluster, plots of statistic results and other results were generated, and CSV files containing cell ID, sample ID, feature values, and X/Y coordinates in FDL graph were exported for each sample. The subsequent use of FCS Express Plus version 6 (DeNovo software, free alternative are mentioned later in the text) allowed visualization of cell images using DAF/CIF files by cluster and customized subsets of the FDL graphs.</p><p>DAF files were opened in FCS Express Plus software, and the ‘R add parameters’ transformation feature with a custom script was used to merge the clustering data saved in the CSV files generated above with both DAF and CIF files (feature values and image sets, respectively). FCS Express Plus was utilized at this stage of work because it is the only platform currently available that works with Amnis DAF and CIF files while also running transformation processes driven by R scripting. ImageJ Bio-Formats allows reading images from DAF and CIF files, but we got pixels with a value much higher than expected, probably due to a bug that has not been fixed yet. This allowed to visualize image galleries of cells within each cluster and gate by features of interest on 2D plots (more traditional flow cytometry analysis) for exploring the clustering results and identifying clusters and populations of interest. FCS Express Plus is a proprietary software, but similar results can be obtained with IDEAS software where a text file with cluster IDs for each image event can be imported and the cluster information can be matched to the event images.</p><p>The full complement of R packages used includes flowCore (<xref ref-type="bibr" rid="bib11">Ellis et al., 2018</xref>; <xref ref-type="bibr" rid="bib14">Hahne et al., 2009</xref>), flowStats (<xref ref-type="bibr" rid="bib15">Hahne et al., 2018</xref>), igraph (<xref ref-type="bibr" rid="bib8">Csardi and Nepusz, 2006</xref>), ggcyto (<xref ref-type="bibr" rid="bib19">Jiang, 2015</xref>), ggridges (<xref ref-type="bibr" rid="bib54">Wilke, 2018</xref>), ggplot2 (<xref ref-type="bibr" rid="bib53">Wickham, 2016</xref>), stringr (<xref ref-type="bibr" rid="bib52">Wickham, 2010</xref>), hmisc (<xref ref-type="bibr" rid="bib16">Harrell and Dupont, 2019</xref>), and caret (<xref ref-type="bibr" rid="bib24">Kuhn, 2008</xref>). <xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref> can be used as an interactive map of Image3C pipeline, where, upon clicking on the different portions of the pipeline, the users will be automatically directed to the corresponding sections of our GitHub repository. The GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link> reports a detailed description of all these processing steps and includes sample scripts, workflow files, and example datasets and tutorials.</p></sec><sec id="s3-7"><title>Setup and use of a CNN classifier</title><p>Once the clusters were defined with the previously described <italic>de novo</italic> clustering analysis, we used a CNN (<xref ref-type="bibr" rid="bib25">LeCun et al., 1989</xref>) based on the architecture of DenseNet (<xref ref-type="bibr" rid="bib18">Huang et al., 2017</xref>) for image classification. Out of all the events captured with the ImageStream<sup>X</sup> Mark II system, we selected only single nucleated objects applying gates on area vs. aspect ratio plot and Draq5 intensity plot to achieve this selection, respectively. For these objects, we exported 16-bit TIFF images (one channel per fluorescence/BF image ‘color’) using IDEAS 6.2 software.</p><p>Because images from the ImageStream<sup>X</sup> Mark II system have nonuniform sizes, each image was cropped or padded to 32 × 32 pixels using NumPy indexing (<xref ref-type="bibr" rid="bib49">van der Walt et al., 2011</xref>) in a Python script. The CNN consists of three dense blocks that transition from three-channel image input of 32 × 32 × 3 to a final size of 4 × 4 × 87 with 87 feature maps. A dense block includes three convolution layers, each followed by leaky ReLU activation. The last step of the block is a strided convolution used to down-sample the width and height of the feature maps by a factor of 2. The final layer of the CNN flattens the 4 × 4 × 87 array into a 1D vector of length 1392 and is fully connected to the output layer, that is, a 1D vector with a length of the number of classes for prediction. The CNN used softmax cross-entropy for the loss function with L2 regularization, and the Adam optimizer (<xref ref-type="bibr" rid="bib22">Kingma and Ba, 2014</xref>) was used to minimize the loss function. The CNN was implemented in Python using the TensorFlow platform (<xref ref-type="bibr" rid="bib1">Abadi et al., 2015</xref>) and the SciPy ecosystem (<xref ref-type="bibr" rid="bib33">Oliphant, 2006</xref>; <xref ref-type="bibr" rid="bib34">Oliphant, 2007</xref>; <xref ref-type="bibr" rid="bib37">Pedregosa et al., 2011</xref>).</p><p>The CNN was used to train a classifier using over 35,000 images of <italic>P. canaliculata</italic> hemolymph cell types in homeostasis condition acquired with the ImageStream<sup>X</sup> Mark II system. The event images were randomly split in 80% for training, 10% for testing during training, and 10% for final validation. The first 80% of the images were used together with their cluster IDs obtained by the <italic>de novo</italic> clustering to train the classifier. The learning rate for the Adam optimizer was set to 0.0006 with a decaying learning rate starting at 0.001 and decreasing by 1% each step. The training proceeded for 25,000 iterations with a size of 256 randomly selected images for each iteration. After each iteration, 10% of the cells of the original <italic>P. canaliculata</italic> dataset was used to test the classifier. The loss and accuracy of the CNN were recorded after every 100 iterations to monitor the performance. The CNN loss was defined by the softmax of the cross-entropy (<xref ref-type="bibr" rid="bib10">Dahal, 2017</xref>) between the final output and the one-hot-encoded image labels. To avoid the CNN memorizing the training set, L2 regularization was applied to the weights. The training and test sets follow the same accuracy and loss trends over all iterations, indicating the training set is not memorized and can generalize to predict the test set.</p><p>The finally trained classifier was tested on the remaining 10% of images that were completely new for the CNN. The trained model was saved for future use, so new images can be inferred by the network to predict cell types. The inference is very fast because only one forward pass is made through the network and no backpropagation occurs. The result of the inference is a vector with length equal to the number of cell type classes. Each element of the vector will be the probability of the cell belonging to the corresponding class; the sum of the vector must be 1. Inferring a complete experiment will provide a probability vector for each image; the list of probability vectors can be saved as CSV file. For new images, the inference results will need to be examined to ensure the predictions are reliable. A large majority of the probability vectors should have a maximum greater than 0.5, and a subset of the images should be visually inspected to verify proper class assignment.</p><p>The interactive map of Image3C pipeline (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>) includes also the training and the use of the CNN. The GitHub repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link> reports a detailed description of all these processing steps, includes sample scripts, workflow files, and example datasets and tutorials and can be easily accessed by clicking on the right side of the Image3C interactive map (<xref ref-type="fig" rid="fig1s1">Figure 1—figure supplement 1</xref>).</p></sec><sec id="s3-8"><title>Statistical analysis</title><p>Negative binomial regression was performed on tables of cell counts per cluster and per sample and plots were generated using R (<xref ref-type="bibr" rid="bib41">R Development Core Team, 2014</xref>) with the edgeR package (<xref ref-type="bibr" rid="bib43">Robinson et al., 2010</xref>), which was developed for RNA-seq analysis, but includes generally applicable and user-friendly wrappers for regression, modeling analysis, and plotting of results. For the comparison of cellular hemolymph composition between females and males of <italic>P. canaliculata,</italic> a one-way ANOVA with subsequent FDR (Benjamini–Hochberg, correction for multiple testing) was used.</p></sec></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We acknowledge Hua Li for her assistance on the statistical analysis and also thank the Laboratory Animal Services and the Aquatics Facility at the Stowers Institute for Medical Research for animal husbandry. We would like to thank Blair Benham-Pyle, Carolyn Brewster, Viraj Doddihal, Julia Peloggia de Castro, and Barbara Milutinović for their critical comments on an earlier version of this manuscript. This work was supported by institutional funding to ACB, CW, ASA, and NR. ASA is a Howard Hughes Medical Institute Investigator. NR is further supported by the Edward Mallinckrodt Foundation, NIH Grant R01 GM127872, DP2AG071466, and NSF EDGE award 1923372. AA was supported by the Emerging Models grant from the Society for Developmental Biology (SDB) and the postdoctoral fellowship from the American Association of Anatomists (AAA). RP was supported by a grant from the Deutsche Forschungsgemeinschaft (PE 2807/1-1).</p></ack><sec id="s4" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Conceptualization, Data curation, Formal analysis, Supervision, Funding acquisition, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con2"><p>Conceptualization, Data curation, Formal analysis, Investigation, Visualization, Methodology, Writing - review and editing</p></fn><fn fn-type="con" id="con3"><p>Conceptualization, Data curation, Formal analysis, Supervision, Funding acquisition, Visualization, Methodology, Writing - original draft, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con4"><p>Software, Formal analysis, Methodology</p></fn><fn fn-type="con" id="con5"><p>Conceptualization, Supervision, Funding acquisition, Project administration, Writing - review and editing</p></fn><fn fn-type="con" id="con6"><p>Conceptualization, Supervision, Funding acquisition, Project administration, Writing - review and editing</p></fn></fn-group><fn-group content-type="ethics-information"><title>Ethics</title><fn fn-type="other" id="fn1"><p>Animal experimentation: Research and animal care were approved by the Institutional Animal Care and Use Committee (IACUC) of the Stowers Institute for Medical Research. protocol (#2018-0187 and #2019-080).</p></fn></fn-group></sec><sec id="s5" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="supp1"><label>Supplementary file 1.</label><caption><title>Features used for the morphology assay.</title><p>Names and descriptions of the features quantified by IDEAS software and used for clustering events based on cell morphology in the homeostasis cell composition experiment. BF: brightfield; CI: cell intrinsic; CF: cell function.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp1-v2.docx"/></supplementary-material><supplementary-material id="supp2"><label>Supplementary file 2.</label><caption><title>Features used for the phagocytosis assay.</title><p>Names and descriptions of the features quantified by IDEAS software and used for clustering events based on cell morphology and function in the phagocytosis experiment. BF: brightfield; CI: cell intrinsic; CF: cell function.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp2-v2.docx"/></supplementary-material><supplementary-material id="supp3"><label>Supplementary file 3.</label><caption><title>Cell cluster properties.</title><p>Cell cluster properties (<italic>e.g.</italic>, cell numbers per cluster, cell features used for clustering, feature values for each cluster) for zebrafish whole kidney marrow (WKM) morphology and phagocytosis assay and for <italic>P. canaliculata</italic> hemocyte morphology and phagocytosis assay.</p></caption><media mime-subtype="xlsx" mimetype="application" xlink:href="elife-65372-supp3-v2.xlsx"/></supplementary-material><supplementary-material id="supp4"><label>Supplementary file 4.</label><caption><title>Cell gallery for zebrafish whole kidney marrow (WKM) in homeostasis condition.</title><p>Representative cell images belonging to each individual cluster identified by Image3C for zebrafish WKM in homeostasis condition are shown. BF: brightfield; SSC: side scatter signal; Draq5: nuclear staining. Merge represents the overlay of BF, SSC, and Draq5.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-65372-supp4-v2.pdf"/></supplementary-material><supplementary-material id="supp5"><label>Supplementary file 5.</label><caption><title>Phagocytosis vs. phagocytosis inhibited with CCB on zebrafish whole kidney marrow (WKM).</title><p>Results of negative binomial regression analysis comparing cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and phagocytosis inhibited with CCB samples (CTV-<italic>S. aureus</italic> + CCB) in the zebrafish phagocytosis experiment. FC: fold change; CPM: count per million; LR: likelihood ratio; FDR: false discovery rate. Relative graph is reported in <xref ref-type="fig" rid="fig3">Figure 3B</xref>.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp5-v2.docx"/></supplementary-material><supplementary-material id="supp6"><label>Supplementary file 6.</label><caption><title>Phagocytosis vs. phagocytosis inhibited with ice on zebrafish whole kidney marrow (WKM).</title><p>Results of negative binomial regression analysis comparing cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and phagocytosis inhibited with ice samples (CTV-<italic>S. aureus</italic> + Ice) in the zebrafish phagocytosis experiment. FC: fold change; CPM: count per million; LR: likelihood ratio; FDR: false discovery rate. Relative graph is reported in <xref ref-type="fig" rid="fig3s2">Figure 3—figure supplement 2</xref>.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp6-v2.docx"/></supplementary-material><supplementary-material id="supp7"><label>Supplementary file 7.</label><caption><title>Cell gallery for zebrafish whole kidney marrow (WKM) after phagocytosis assay.</title><p>Representative cell images belonging to each individual cluster identified by Image3C for zebrafish WKM after phagocytosis assay are shown. BF: brightfield; DHR: fluorescent reactive oxygen species indicator; SSC: side scatter signal; Bac: CTV signal (<italic>S. aureus</italic> labeling); Draq5: nuclear staining. Merge represents the overlay of DHR, Bac, and Draq5.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-65372-supp7-v2.pdf"/></supplementary-material><supplementary-material id="supp8"><label>Supplementary file 8.</label><caption><title>Cell gallery for <italic>P. canaliculata</italic> hemocytes in homeostasis condition.</title><p>Representative cell images belonging to each individual cluster identified by Image3C for snail hemocytes in homeostasis condition are shown. Ch01 is brightfield, Ch06 is side scatter signal, and Ch11 is Draq5 (nuclear staining). Merge represents the overlay of Ch01, Ch06, and Ch11.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-65372-supp8-v2.pdf"/></supplementary-material><supplementary-material id="supp9"><label>Supplementary file 9.</label><caption><title>Phagocytosis vs. phagocytosis inhibited with EDTA on <italic>P. canaliculata</italic> hemocytes.</title><p>Results of negative binomial regression analysis comparing cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and phagocytosis inhibited with EDTA samples (CTV-<italic>S. aureus</italic> + EDTA) in the apple snail <italic>P. canaliculata</italic> phagocytosis experiment. FC: fold change; CPM: count per million; LR: likelihood ratio; FDR: false discovery rate. Relative graph is reported in <xref ref-type="fig" rid="fig5">Figure 5B</xref>.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp9-v2.docx"/></supplementary-material><supplementary-material id="supp10"><label>Supplementary file 10.</label><caption><title>Phagocytosis vs. phagocytosis inhibited with ice on <italic>P. canaliculata</italic> hemocytes.</title><p>Results of negative binomial regression analysis comparing cluster relative abundance between phagocytosis samples (CTV-<italic>S. aureus</italic>) and phagocytosis inhibited with ice samples (CTV-<italic>S. aureus</italic> + Ice) in the apple snail <italic>P. canaliculata</italic> phagocytosis experiment. FC: fold change; CPM: count per million; LR: likelihood ratio; FDR: false discovery rate. Relative graph is reported in <xref ref-type="fig" rid="fig5s2">Figure 5—figure supplement 2</xref>.</p></caption><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-supp10-v2.docx"/></supplementary-material><supplementary-material id="supp11"><label>Supplementary file 11.</label><caption><title>Cell gallery for <italic>P. canaliculata</italic> hemocytes after phagocytosis assay.</title><p>Representative cell images belonging to each individual cluster identified by Image3C for snail hemocytes after phagocytosis assay are shown. Ch01 is brightfield, Ch02 is DHR signal (reactive oxygen species indicator), Ch06 is side scatter signal, Ch07 is CTV signal (<italic>S. aureus</italic> labeling), and Ch11 is Draq5 (nuclear staining). Merge represents the overlay of Ch02, Ch06, Ch07, and Ch11.</p></caption><media mime-subtype="pdf" mimetype="application" xlink:href="elife-65372-supp11-v2.pdf"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="docx" mimetype="application" xlink:href="elife-65372-transrepform-v2.docx"/></supplementary-material></sec><sec id="s6" sec-type="data-availability"><title>Data availability</title><p>All original data underlying this manuscript can be accessed from the Stowers Original Data Repository at <ext-link ext-link-type="uri" xlink:href="http://www.stowers.org/research/publications/libpb-1390">http://www.stowers.org/research/publications/libpb-1390</ext-link>. Image3C code and description are freely available at the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link>.</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Abadi</surname> <given-names>M</given-names></name><name><surname>Agarwal</surname> <given-names>A</given-names></name><name><surname>Barham</surname> <given-names>P</given-names></name><name><surname>Brevdo</surname> <given-names>E</given-names></name><name><surname>Chen</surname> <given-names>Z</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Tensorflow: large-scale machine learning on heterogeneous distributed systems</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1603.04467">https://arxiv.org/abs/1603.04467</ext-link></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Accorsi</surname> <given-names>A</given-names></name><name><surname>Bucci</surname> <given-names>L</given-names></name><name><surname>de Eguileor</surname> <given-names>M</given-names></name><name><surname>Ottaviani</surname> <given-names>E</given-names></name><name><surname>Malagoli</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Comparative analysis of circulating hemocytes of the freshwater snail Pomacea canaliculata</article-title><source>Fish &amp; Shellfish Immunology</source><volume>34</volume><fpage>1260</fpage><lpage>1268</lpage><pub-id pub-id-type="doi">10.1016/j.fsi.2013.02.008</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baron</surname> <given-names>CS</given-names></name><name><surname>Barve</surname> <given-names>A</given-names></name><name><surname>Muraro</surname> <given-names>MJ</given-names></name><name><surname>van der Linden</surname> <given-names>R</given-names></name><name><surname>Dharmadhikari</surname> <given-names>G</given-names></name><name><surname>Lyubimova</surname> <given-names>A</given-names></name><name><surname>de Koning</surname> <given-names>EJP</given-names></name><name><surname>van Oudenaarden</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Cell Type Purification by Single-Cell Transcriptome-Trained Sorting</article-title><source>Cell</source><volume>179</volume><fpage>527</fpage><lpage>542</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2019.08.006</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blasi</surname> <given-names>T</given-names></name><name><surname>Hennig</surname> <given-names>H</given-names></name><name><surname>Summers</surname> <given-names>HD</given-names></name><name><surname>Theis</surname> <given-names>FJ</given-names></name><name><surname>Cerveira</surname> <given-names>J</given-names></name><name><surname>Patterson</surname> <given-names>JO</given-names></name><name><surname>Davies</surname> <given-names>D</given-names></name><name><surname>Filby</surname> <given-names>A</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name><name><surname>Rees</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Label-free cell cycle analysis for high-throughput imaging flow cytometry</article-title><source>Nature Communications</source><volume>7</volume><elocation-id>10256</elocation-id><pub-id pub-id-type="doi">10.1038/ncomms10256</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Box</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2021">2021</year><data-title>Step-by-step instructions for running Image3C analysis</data-title><source>GitHub</source><version designator="637074e">637074e</version><ext-link ext-link-type="uri" xlink:href="https://github.com/stowersinstitute/LIBPB-1390-Image3C">https://github.com/stowersinstitute/LIBPB-1390-Image3C</ext-link></element-citation></ref><ref id="bib6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caicedo</surname> <given-names>JC</given-names></name><name><surname>Cooper</surname> <given-names>S</given-names></name><name><surname>Heigwer</surname> <given-names>F</given-names></name><name><surname>Warchal</surname> <given-names>S</given-names></name><name><surname>Qiu</surname> <given-names>P</given-names></name><name><surname>Molnar</surname> <given-names>C</given-names></name><name><surname>Vasilevich</surname> <given-names>AS</given-names></name><name><surname>Barry</surname> <given-names>JD</given-names></name><name><surname>Bansal</surname> <given-names>HS</given-names></name><name><surname>Kraus</surname> <given-names>O</given-names></name><name><surname>Wawer</surname> <given-names>M</given-names></name><name><surname>Paavolainen</surname> <given-names>L</given-names></name><name><surname>Herrmann</surname> <given-names>MD</given-names></name><name><surname>Rohban</surname> <given-names>M</given-names></name><name><surname>Hung</surname> <given-names>J</given-names></name><name><surname>Hennig</surname> <given-names>H</given-names></name><name><surname>Concannon</surname> <given-names>J</given-names></name><name><surname>Smith</surname> <given-names>I</given-names></name><name><surname>Clemons</surname> <given-names>PA</given-names></name><name><surname>Singh</surname> <given-names>S</given-names></name><name><surname>Rees</surname> <given-names>P</given-names></name><name><surname>Horvath</surname> <given-names>P</given-names></name><name><surname>Linington</surname> <given-names>RG</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Data-analysis strategies for image-based cell profiling</article-title><source>Nature Methods</source><volume>14</volume><fpage>849</fpage><lpage>863</lpage><pub-id pub-id-type="doi">10.1038/nmeth.4397</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname> <given-names>S</given-names></name><name><surname>Fu</surname> <given-names>S</given-names></name><name><surname>Kim</surname> <given-names>YM</given-names></name><name><surname>Song</surname> <given-names>W</given-names></name><name><surname>Li</surname> <given-names>Y</given-names></name><name><surname>Xue</surname> <given-names>Y</given-names></name><name><surname>Yi</surname> <given-names>J</given-names></name><name><surname>Tian</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="2021">2021</year><article-title>Single-cell cytometry via multiplexed fluorescence prediction by label-free reflectance microscopy</article-title><source>Science Advances</source><volume>7</volume><elocation-id>eabe0431</elocation-id><pub-id pub-id-type="doi">10.1126/sciadv.abe0431</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Csardi</surname> <given-names>G</given-names></name><name><surname>Nepusz</surname> <given-names>T</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>The igraph software package for complex network research</article-title><source>InterJournal, Complex Systems</source><volume>1695</volume><fpage>1</fpage><lpage>9</lpage></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cueto</surname> <given-names>JA</given-names></name><name><surname>Rodriguez</surname> <given-names>C</given-names></name><name><surname>Vega</surname> <given-names>IA</given-names></name><name><surname>Castro-Vazquez</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Immune defenses of the invasive apple snail Pomacea canaliculata (Caenogastropoda, Ampullariidae): Phagocytic hemocytes in the circulation and the kidney</article-title><source>PLOS ONE</source><volume>10</volume><elocation-id>e0123964</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0123964</pub-id><pub-id pub-id-type="pmid">25893243</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Dahal</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><data-title>Softmax cross entropy</data-title><source>Deepnotes</source><ext-link ext-link-type="uri" xlink:href="https://deepnotes.io/softmax-crossentropy">https://deepnotes.io/softmax-crossentropy</ext-link></element-citation></ref><ref id="bib11"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Ellis</surname> <given-names>B</given-names></name><name><surname>Haaland</surname> <given-names>P</given-names></name><name><surname>Hahne</surname> <given-names>F</given-names></name><name><surname>Le Meur</surname> <given-names>N</given-names></name><name><surname>Gopalakrishnan</surname> <given-names>N</given-names></name><name><surname>Spidlen</surname> <given-names>J</given-names></name><name><surname>Jiang</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>flowCore: flowCore: Basic structures for flow cytometry data</data-title><version designator="1.46.1">1.46.1</version><publisher-name>R package</publisher-name><ext-link ext-link-type="uri" xlink:href="https://rdrr.io/bioc/flowCore/">https://rdrr.io/bioc/flowCore/</ext-link></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eulenberg</surname> <given-names>P</given-names></name><name><surname>Köhler</surname> <given-names>N</given-names></name><name><surname>Blasi</surname> <given-names>T</given-names></name><name><surname>Filby</surname> <given-names>A</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name><name><surname>Rees</surname> <given-names>P</given-names></name><name><surname>Theis</surname> <given-names>FJ</given-names></name><name><surname>Wolf</surname> <given-names>FA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Reconstructing cell cycle and disease progression using deep learning</article-title><source>Nature Communications</source><volume>8</volume><elocation-id>463</elocation-id><pub-id pub-id-type="doi">10.1038/s41467-017-00623-3</pub-id><pub-id pub-id-type="pmid">28878212</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goolam</surname> <given-names>M</given-names></name><name><surname>Scialdone</surname> <given-names>A</given-names></name><name><surname>Graham</surname> <given-names>SJL</given-names></name><name><surname>Macaulay</surname> <given-names>IC</given-names></name><name><surname>Jedrusik</surname> <given-names>A</given-names></name><name><surname>Hupalowska</surname> <given-names>A</given-names></name><name><surname>Voet</surname> <given-names>T</given-names></name><name><surname>Marioni</surname> <given-names>JC</given-names></name><name><surname>Zernicka-Goetz</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-Cell mouse embryos</article-title><source>Cell</source><volume>165</volume><fpage>61</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2016.01.047</pub-id><pub-id pub-id-type="pmid">27015307</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hahne</surname> <given-names>F</given-names></name><name><surname>LeMeur</surname> <given-names>N</given-names></name><name><surname>Brinkman</surname> <given-names>RR</given-names></name><name><surname>Ellis</surname> <given-names>B</given-names></name><name><surname>Haaland</surname> <given-names>P</given-names></name><name><surname>Sarkar</surname> <given-names>D</given-names></name><name><surname>Spidlen</surname> <given-names>J</given-names></name><name><surname>Strain</surname> <given-names>E</given-names></name><name><surname>Gentleman</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>flowCore: a bioconductor package for high throughput flow cytometry</article-title><source>BMC Bioinformatics</source><volume>10</volume><elocation-id>106</elocation-id><pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id><pub-id pub-id-type="pmid">19358741</pub-id></element-citation></ref><ref id="bib15"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Hahne</surname> <given-names>F</given-names></name><name><surname>Gopalakrishnan</surname> <given-names>N</given-names></name><name><surname>Khodabakhshi</surname> <given-names>AH</given-names></name><name><surname>Wong</surname> <given-names>C</given-names></name><name><surname>Lee</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>flowStats: Statistical methods for the analysis of flow cytometry data</data-title><version designator="3.38.0">3.38.0</version><publisher-name>R package</publisher-name><ext-link ext-link-type="uri" xlink:href="https://rdrr.io/bioc/flowStats/">https://rdrr.io/bioc/flowStats/</ext-link></element-citation></ref><ref id="bib16"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Harrell</surname> <given-names>FE</given-names></name><name><surname>Dupont</surname> <given-names>C</given-names></name></person-group><year iso-8601-date="2019">2019</year><data-title>Hmisc: Harrell Miscellaneous</data-title><source>Github</source><version designator="4.5-0">4.5-0</version><ext-link ext-link-type="uri" xlink:href="https://github.com/harrelfe/Hmisc/">https://github.com/harrelfe/Hmisc/</ext-link></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hennig</surname> <given-names>H</given-names></name><name><surname>Rees</surname> <given-names>P</given-names></name><name><surname>Blasi</surname> <given-names>T</given-names></name><name><surname>Kamentsky</surname> <given-names>L</given-names></name><name><surname>Hung</surname> <given-names>J</given-names></name><name><surname>Dao</surname> <given-names>D</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name><name><surname>Filby</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An open-source solution for advanced imaging flow cytometry data analysis using machine learning</article-title><source>Methods</source><volume>112</volume><fpage>201</fpage><lpage>210</lpage><pub-id pub-id-type="doi">10.1016/j.ymeth.2016.08.018</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Huang</surname> <given-names>G</given-names></name><name><surname>Liu</surname> <given-names>Z</given-names></name><name><surname>Maaten</surname> <given-names>L</given-names></name><name><surname>Weinberger</surname> <given-names>KQ</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Densely connected convolutional networks</article-title><conf-name>Paper Presented at the 2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</conf-name><fpage>21</fpage><lpage>26</lpage></element-citation></ref><ref id="bib19"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Jiang</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2015">2015</year><data-title>ggcyto: Visualize Cytometry data with ggplot</data-title><source>Github</source><version designator="1.8.0">1.8.0</version><ext-link ext-link-type="uri" xlink:href="https://github.com/RGLab/ggcyto">https://github.com/RGLab/ggcyto</ext-link></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kaczorowski</surname> <given-names>KJ</given-names></name><name><surname>Shekhar</surname> <given-names>K</given-names></name><name><surname>Nkulikiyimfura</surname> <given-names>D</given-names></name><name><surname>Dekker</surname> <given-names>CL</given-names></name><name><surname>Maecker</surname> <given-names>H</given-names></name><name><surname>Davis</surname> <given-names>MM</given-names></name><name><surname>Chakraborty</surname> <given-names>AK</given-names></name><name><surname>Brodin</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Continuous immunotypes describe human immune variation and predict diverse responses</article-title><source>PNAS</source><volume>114</volume><fpage>E6097</fpage><lpage>E6106</lpage><pub-id pub-id-type="doi">10.1073/pnas.1705065114</pub-id><pub-id pub-id-type="pmid">28696306</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimmel</surname> <given-names>JC</given-names></name><name><surname>Penland</surname> <given-names>L</given-names></name><name><surname>Rubinstein</surname> <given-names>ND</given-names></name><name><surname>Hendrickson</surname> <given-names>DG</given-names></name><name><surname>Kelley</surname> <given-names>DR</given-names></name><name><surname>Rosenthal</surname> <given-names>AZ</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Murine single-cell RNA-seq reveals cell-identity- and tissue-specific trajectories of aging</article-title><source>Genome Research</source><volume>29</volume><fpage>2088</fpage><lpage>2103</lpage><pub-id pub-id-type="doi">10.1101/gr.253880.119</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Kingma</surname> <given-names>DP</given-names></name><name><surname>Ba</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Adam: a method for stochastic optimization</article-title><source>arXiv</source><ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1412.6980">https://arxiv.org/abs/1412.6980</ext-link></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kobayashi</surname> <given-names>H</given-names></name><name><surname>Lei</surname> <given-names>C</given-names></name><name><surname>Wu</surname> <given-names>Y</given-names></name><name><surname>Mao</surname> <given-names>A</given-names></name><name><surname>Jiang</surname> <given-names>Y</given-names></name><name><surname>Guo</surname> <given-names>B</given-names></name><name><surname>Ozeki</surname> <given-names>Y</given-names></name><name><surname>Goda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Label-free detection of cellular drug responses by high-throughput bright-field imaging and machine learning</article-title><source>Scientific Reports</source><volume>7</volume><elocation-id>12454</elocation-id><pub-id pub-id-type="doi">10.1038/s41598-017-12378-4</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhn</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2008">2008</year><article-title>Building predictive models in <italic>R</italic> using the caret package</article-title><source>Journal of Statistical Software</source><volume>28</volume><fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="doi">10.18637/jss.v028.i05</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeCun</surname> <given-names>Y</given-names></name><name><surname>Boser</surname> <given-names>B</given-names></name><name><surname>Denker</surname> <given-names>JS</given-names></name><name><surname>Henderson</surname> <given-names>D</given-names></name><name><surname>Howard</surname> <given-names>RE</given-names></name><name><surname>Hubbard</surname> <given-names>W</given-names></name><name><surname>Jackel</surname> <given-names>LD</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Backpropagation applied to handwritten zip code recognition</article-title><source>Neural Computation</source><volume>1</volume><fpage>541</fpage><lpage>551</lpage><pub-id pub-id-type="doi">10.1162/neco.1989.1.4.541</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lei</surname> <given-names>C</given-names></name><name><surname>Kobayashi</surname> <given-names>H</given-names></name><name><surname>Wu</surname> <given-names>Y</given-names></name><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Isozaki</surname> <given-names>A</given-names></name><name><surname>Yasumoto</surname> <given-names>A</given-names></name><name><surname>Mikami</surname> <given-names>H</given-names></name><name><surname>Ito</surname> <given-names>T</given-names></name><name><surname>Nitta</surname> <given-names>N</given-names></name><name><surname>Sugimura</surname> <given-names>T</given-names></name><name><surname>Yamada</surname> <given-names>M</given-names></name><name><surname>Yatomi</surname> <given-names>Y</given-names></name><name><surname>Di Carlo</surname> <given-names>D</given-names></name><name><surname>Ozeki</surname> <given-names>Y</given-names></name><name><surname>Goda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>High-throughput imaging flow cytometry by optofluidic time-stretch microscopy</article-title><source>Nature Protocols</source><volume>13</volume><fpage>1603</fpage><lpage>1631</lpage><pub-id pub-id-type="doi">10.1038/s41596-018-0008-7</pub-id><pub-id pub-id-type="pmid">29976951</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname> <given-names>J</given-names></name><name><surname>Barreda</surname> <given-names>DR</given-names></name><name><surname>Zhang</surname> <given-names>YA</given-names></name><name><surname>Boshra</surname> <given-names>H</given-names></name><name><surname>Gelman</surname> <given-names>AE</given-names></name><name><surname>Lapatra</surname> <given-names>S</given-names></name><name><surname>Tort</surname> <given-names>L</given-names></name><name><surname>Sunyer</surname> <given-names>JO</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>B lymphocytes from early vertebrates have potent phagocytic and microbicidal abilities</article-title><source>Nature Immunology</source><volume>7</volume><fpage>1116</fpage><lpage>1124</lpage><pub-id pub-id-type="doi">10.1038/ni1389</pub-id><pub-id pub-id-type="pmid">16980980</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippeveld</surname> <given-names>M</given-names></name><name><surname>Knill</surname> <given-names>C</given-names></name><name><surname>Ladlow</surname> <given-names>E</given-names></name><name><surname>Fuller</surname> <given-names>A</given-names></name><name><surname>Michaelis</surname> <given-names>LJ</given-names></name><name><surname>Saeys</surname> <given-names>Y</given-names></name><name><surname>Filby</surname> <given-names>A</given-names></name><name><surname>Peralta</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Classification of human white blood cells using machine learning for stain‐free imaging flow cytometry</article-title><source>Cytometry Part A</source><volume>97</volume><fpage>308</fpage><lpage>319</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.23920</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lugo-Villarino</surname> <given-names>G</given-names></name><name><surname>Balla</surname> <given-names>KM</given-names></name><name><surname>Stachura</surname> <given-names>DL</given-names></name><name><surname>Bañuelos</surname> <given-names>K</given-names></name><name><surname>Werneck</surname> <given-names>MB</given-names></name><name><surname>Traver</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>Identification of dendritic antigen-presenting cells in the zebrafish</article-title><source>PNAS</source><volume>107</volume><fpage>15850</fpage><lpage>15855</lpage><pub-id pub-id-type="doi">10.1073/pnas.1000494107</pub-id><pub-id pub-id-type="pmid">20733076</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maizels</surname> <given-names>RM</given-names></name><name><surname>Nussey</surname> <given-names>DH</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>Into the wild: digging at immunology's evolutionary roots</article-title><source>Nature Immunology</source><volume>14</volume><fpage>879</fpage><lpage>883</lpage><pub-id pub-id-type="doi">10.1038/ni.2643</pub-id><pub-id pub-id-type="pmid">23959175</pub-id></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nassar</surname> <given-names>M</given-names></name><name><surname>Doan</surname> <given-names>M</given-names></name><name><surname>Filby</surname> <given-names>A</given-names></name><name><surname>Wolkenhauer</surname> <given-names>O</given-names></name><name><surname>Fogg</surname> <given-names>DK</given-names></name><name><surname>Piasecka</surname> <given-names>J</given-names></name><name><surname>Thornton</surname> <given-names>CA</given-names></name><name><surname>Carpenter</surname> <given-names>AE</given-names></name><name><surname>Summers</surname> <given-names>HD</given-names></name><name><surname>Rees</surname> <given-names>P</given-names></name><name><surname>Hennig</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Label‐free identification of white blood cells using machine learning</article-title><source>Cytometry Part A</source><volume>95</volume><fpage>836</fpage><lpage>842</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.23794</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nitta</surname> <given-names>N</given-names></name><name><surname>Sugimura</surname> <given-names>T</given-names></name><name><surname>Isozaki</surname> <given-names>A</given-names></name><name><surname>Mikami</surname> <given-names>H</given-names></name><name><surname>Hiraki</surname> <given-names>K</given-names></name><name><surname>Sakuma</surname> <given-names>S</given-names></name><name><surname>Iino</surname> <given-names>T</given-names></name><name><surname>Arai</surname> <given-names>F</given-names></name><name><surname>Endo</surname> <given-names>T</given-names></name><name><surname>Fujiwaki</surname> <given-names>Y</given-names></name><name><surname>Fukuzawa</surname> <given-names>H</given-names></name><name><surname>Hase</surname> <given-names>M</given-names></name><name><surname>Hayakawa</surname> <given-names>T</given-names></name><name><surname>Hiramatsu</surname> <given-names>K</given-names></name><name><surname>Hoshino</surname> <given-names>Y</given-names></name><name><surname>Inaba</surname> <given-names>M</given-names></name><name><surname>Ito</surname> <given-names>T</given-names></name><name><surname>Karakawa</surname> <given-names>H</given-names></name><name><surname>Kasai</surname> <given-names>Y</given-names></name><name><surname>Koizumi</surname> <given-names>K</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Lei</surname> <given-names>C</given-names></name><name><surname>Li</surname> <given-names>M</given-names></name><name><surname>Maeno</surname> <given-names>T</given-names></name><name><surname>Matsusaka</surname> <given-names>S</given-names></name><name><surname>Murakami</surname> <given-names>D</given-names></name><name><surname>Nakagawa</surname> <given-names>A</given-names></name><name><surname>Oguchi</surname> <given-names>Y</given-names></name><name><surname>Oikawa</surname> <given-names>M</given-names></name><name><surname>Ota</surname> <given-names>T</given-names></name><name><surname>Shiba</surname> <given-names>K</given-names></name><name><surname>Shintaku</surname> <given-names>H</given-names></name><name><surname>Shirasaki</surname> <given-names>Y</given-names></name><name><surname>Suga</surname> <given-names>K</given-names></name><name><surname>Suzuki</surname> <given-names>Y</given-names></name><name><surname>Suzuki</surname> <given-names>N</given-names></name><name><surname>Tanaka</surname> <given-names>Y</given-names></name><name><surname>Tezuka</surname> <given-names>H</given-names></name><name><surname>Toyokawa</surname> <given-names>C</given-names></name><name><surname>Yalikun</surname> <given-names>Y</given-names></name><name><surname>Yamada</surname> <given-names>M</given-names></name><name><surname>Yamagishi</surname> <given-names>M</given-names></name><name><surname>Yamano</surname> <given-names>T</given-names></name><name><surname>Yasumoto</surname> <given-names>A</given-names></name><name><surname>Yatomi</surname> <given-names>Y</given-names></name><name><surname>Yazawa</surname> <given-names>M</given-names></name><name><surname>Di Carlo</surname> <given-names>D</given-names></name><name><surname>Hosokawa</surname> <given-names>Y</given-names></name><name><surname>Uemura</surname> <given-names>S</given-names></name><name><surname>Ozeki</surname> <given-names>Y</given-names></name><name><surname>Goda</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Intelligent Image-Activated cell sorting</article-title><source>Cell</source><volume>175</volume><fpage>266</fpage><lpage>276</lpage><pub-id pub-id-type="doi">10.1016/j.cell.2018.08.028</pub-id><pub-id pub-id-type="pmid">30166209</pub-id></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Oliphant</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2006">2006</year><source>Guide to NumPy</source><publisher-name>Massachusetts Institute of Technology</publisher-name></element-citation></ref><ref id="bib34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliphant</surname> <given-names>TE</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Python for scientific computing</article-title><source>Computing in Science &amp; Engineering</source><volume>9</volume><fpage>10</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1109/MCSE.2007.58</pub-id></element-citation></ref><ref id="bib35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Page</surname> <given-names>DM</given-names></name><name><surname>Wittamer</surname> <given-names>V</given-names></name><name><surname>Bertrand</surname> <given-names>JY</given-names></name><name><surname>Lewis</surname> <given-names>KL</given-names></name><name><surname>Pratt</surname> <given-names>DN</given-names></name><name><surname>Delgado</surname> <given-names>N</given-names></name><name><surname>Schale</surname> <given-names>SE</given-names></name><name><surname>McGue</surname> <given-names>C</given-names></name><name><surname>Jacobsen</surname> <given-names>BH</given-names></name><name><surname>Doty</surname> <given-names>A</given-names></name><name><surname>Pao</surname> <given-names>Y</given-names></name><name><surname>Yang</surname> <given-names>H</given-names></name><name><surname>Chi</surname> <given-names>NC</given-names></name><name><surname>Magor</surname> <given-names>BG</given-names></name><name><surname>Traver</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2013">2013</year><article-title>An evolutionarily conserved program of B-cell development and activation in zebrafish</article-title><source>Blood</source><volume>122</volume><fpage>e1</fpage><lpage>e11</lpage><pub-id pub-id-type="doi">10.1182/blood-2012-12-471029</pub-id><pub-id pub-id-type="pmid">23861249</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Palić</surname> <given-names>D</given-names></name><name><surname>Andreasen</surname> <given-names>CB</given-names></name><name><surname>Ostojić</surname> <given-names>J</given-names></name><name><surname>Tell</surname> <given-names>RM</given-names></name><name><surname>Roth</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Zebrafish (<italic>Danio rerio</italic>) whole kidney assays to measure neutrophil extracellular trap release and degranulation of primary granules</article-title><source>Journal of Immunological Methods</source><volume>319</volume><fpage>87</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1016/j.jim.2006.11.003</pub-id><pub-id pub-id-type="pmid">17208252</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pedregosa</surname> <given-names>F</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name><name><surname>Gramfort</surname> <given-names>A</given-names></name><name><surname>Michel</surname> <given-names>V</given-names></name><name><surname>Thirion</surname> <given-names>B</given-names></name><name><surname>Grisel</surname> <given-names>O</given-names></name><name><surname>Blondel</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Scikit-learn: machine learning in Python</article-title><source>Journal of Machine Learning Research</source><volume>12</volume><fpage>2825</fpage><lpage>2830</lpage></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pepe-Mooney</surname> <given-names>BJ</given-names></name><name><surname>Dill</surname> <given-names>MT</given-names></name><name><surname>Alemany</surname> <given-names>A</given-names></name><name><surname>Ordovas-Montanes</surname> <given-names>J</given-names></name><name><surname>Matsushita</surname> <given-names>Y</given-names></name><name><surname>Rao</surname> <given-names>A</given-names></name><name><surname>Sen</surname> <given-names>A</given-names></name><name><surname>Miyazaki</surname> <given-names>M</given-names></name><name><surname>Anakk</surname> <given-names>S</given-names></name><name><surname>Dawson</surname> <given-names>PA</given-names></name><name><surname>Ono</surname> <given-names>N</given-names></name><name><surname>Shalek</surname> <given-names>AK</given-names></name><name><surname>van Oudenaarden</surname> <given-names>A</given-names></name><name><surname>Camargo</surname> <given-names>FD</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Single-Cell analysis of the liver epithelium reveals dynamic heterogeneity and an essential role for YAP in homeostasis and regeneration</article-title><source>Cell Stem Cell</source><volume>25</volume><fpage>23</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1016/j.stem.2019.04.004</pub-id><pub-id pub-id-type="pmid">31080134</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peuß</surname> <given-names>R</given-names></name><name><surname>Box</surname> <given-names>AC</given-names></name><name><surname>Chen</surname> <given-names>S</given-names></name><name><surname>Wang</surname> <given-names>Y</given-names></name><name><surname>Tsuchiya</surname> <given-names>D</given-names></name><name><surname>Persons</surname> <given-names>JL</given-names></name><name><surname>Kenzior</surname> <given-names>A</given-names></name><name><surname>Maldonado</surname> <given-names>E</given-names></name><name><surname>Krishnan</surname> <given-names>J</given-names></name><name><surname>Scharsack</surname> <given-names>JP</given-names></name><name><surname>Slaughter</surname> <given-names>BD</given-names></name><name><surname>Rohner</surname> <given-names>N</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Adaptation to low parasite abundance affects immune investment and immunopathological responses of cavefish</article-title><source>Nature Ecology &amp; Evolution</source><volume>4</volume><fpage>1416</fpage><lpage>1430</lpage><pub-id pub-id-type="doi">10.1038/s41559-020-1234-2</pub-id><pub-id pub-id-type="pmid">32690906</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Philippeos</surname> <given-names>C</given-names></name><name><surname>Telerman</surname> <given-names>SB</given-names></name><name><surname>Oulès</surname> <given-names>B</given-names></name><name><surname>Pisco</surname> <given-names>AO</given-names></name><name><surname>Shaw</surname> <given-names>TJ</given-names></name><name><surname>Elgueta</surname> <given-names>R</given-names></name><name><surname>Lombardi</surname> <given-names>G</given-names></name><name><surname>Driskell</surname> <given-names>RR</given-names></name><name><surname>Soldin</surname> <given-names>M</given-names></name><name><surname>Lynch</surname> <given-names>MD</given-names></name><name><surname>Watt</surname> <given-names>FM</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Spatial and Single-Cell transcriptional profiling identifies functionally distinct human dermal fibroblast subpopulations</article-title><source>Journal of Investigative Dermatology</source><volume>138</volume><fpage>811</fpage><lpage>825</lpage><pub-id pub-id-type="doi">10.1016/j.jid.2018.01.016</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="software"><person-group person-group-type="author"><collab>R Development Core Team</collab></person-group><year iso-8601-date="2014">2014</year><data-title>R: A language and environment for statistical computing</data-title><version designator="2.6.2">2.6.2</version><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name><ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabinovitch</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>Professional and non-professional phagocytes: an introduction</article-title><source>Trends in Cell Biology</source><volume>5</volume><fpage>85</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1016/S0962-8924(00)88955-2</pub-id><pub-id pub-id-type="pmid">14732160</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname> <given-names>MD</given-names></name><name><surname>McCarthy</surname> <given-names>DJ</given-names></name><name><surname>Smyth</surname> <given-names>GK</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><volume>26</volume><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Samusik</surname> <given-names>N</given-names></name><name><surname>Good</surname> <given-names>Z</given-names></name><name><surname>Spitzer</surname> <given-names>MH</given-names></name><name><surname>Davis</surname> <given-names>KL</given-names></name><name><surname>Nolan</surname> <given-names>GP</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Automated mapping of phenotype space with single-cell data</article-title><source>Nature Methods</source><volume>13</volume><fpage>493</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/nmeth.3863</pub-id><pub-id pub-id-type="pmid">27183440</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suzuki</surname> <given-names>Y</given-names></name><name><surname>Kobayashi</surname> <given-names>K</given-names></name><name><surname>Wakisaka</surname> <given-names>Y</given-names></name><name><surname>Deng</surname> <given-names>D</given-names></name><name><surname>Tanaka</surname> <given-names>S</given-names></name><name><surname>Huang</surname> <given-names>CJ</given-names></name><name><surname>Lei</surname> <given-names>C</given-names></name><name><surname>Sun</surname> <given-names>CW</given-names></name><name><surname>Liu</surname> <given-names>H</given-names></name><name><surname>Fujiwaki</surname> <given-names>Y</given-names></name><name><surname>Lee</surname> <given-names>S</given-names></name><name><surname>Isozaki</surname> <given-names>A</given-names></name><name><surname>Kasai</surname> <given-names>Y</given-names></name><name><surname>Hayakawa</surname> <given-names>T</given-names></name><name><surname>Sakuma</surname> <given-names>S</given-names></name><name><surname>Arai</surname> <given-names>F</given-names></name><name><surname>Koizumi</surname> <given-names>K</given-names></name><name><surname>Tezuka</surname> <given-names>H</given-names></name><name><surname>Inaba</surname> <given-names>M</given-names></name><name><surname>Hiraki</surname> <given-names>K</given-names></name><name><surname>Ito</surname> <given-names>T</given-names></name><name><surname>Hase</surname> <given-names>M</given-names></name><name><surname>Matsusaka</surname> <given-names>S</given-names></name><name><surname>Shiba</surname> <given-names>K</given-names></name><name><surname>Suga</surname> <given-names>K</given-names></name><name><surname>Nishikawa</surname> <given-names>M</given-names></name><name><surname>Jona</surname> <given-names>M</given-names></name><name><surname>Yatomi</surname> <given-names>Y</given-names></name><name><surname>Yalikun</surname> <given-names>Y</given-names></name><name><surname>Tanaka</surname> <given-names>Y</given-names></name><name><surname>Sugimura</surname> <given-names>T</given-names></name><name><surname>Nitta</surname> <given-names>N</given-names></name><name><surname>Goda</surname> <given-names>K</given-names></name><name><surname>Ozeki</surname> <given-names>Y</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Label-free chemical imaging flow cytometry by high-speed multicolor stimulated raman scattering</article-title><source>PNAS</source><volume>116</volume><fpage>15842</fpage><lpage>15848</lpage><pub-id pub-id-type="doi">10.1073/pnas.1902322116</pub-id><pub-id pub-id-type="pmid">31324741</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tirosh</surname> <given-names>I</given-names></name><name><surname>Izar</surname> <given-names>B</given-names></name><name><surname>Prakadan</surname> <given-names>SM</given-names></name><name><surname>Wadsworth</surname> <given-names>MH</given-names></name><name><surname>Treacy</surname> <given-names>D</given-names></name><name><surname>Trombetta</surname> <given-names>JJ</given-names></name><name><surname>Rotem</surname> <given-names>A</given-names></name><name><surname>Rodman</surname> <given-names>C</given-names></name><name><surname>Lian</surname> <given-names>C</given-names></name><name><surname>Murphy</surname> <given-names>G</given-names></name><name><surname>Fallahi-Sichani</surname> <given-names>M</given-names></name><name><surname>Dutton-Regester</surname> <given-names>K</given-names></name><name><surname>Lin</surname> <given-names>JR</given-names></name><name><surname>Cohen</surname> <given-names>O</given-names></name><name><surname>Shah</surname> <given-names>P</given-names></name><name><surname>Lu</surname> <given-names>D</given-names></name><name><surname>Genshaft</surname> <given-names>AS</given-names></name><name><surname>Hughes</surname> <given-names>TK</given-names></name><name><surname>Ziegler</surname> <given-names>CG</given-names></name><name><surname>Kazer</surname> <given-names>SW</given-names></name><name><surname>Gaillard</surname> <given-names>A</given-names></name><name><surname>Kolb</surname> <given-names>KE</given-names></name><name><surname>Villani</surname> <given-names>AC</given-names></name><name><surname>Johannessen</surname> <given-names>CM</given-names></name><name><surname>Andreev</surname> <given-names>AY</given-names></name><name><surname>Van Allen</surname> <given-names>EM</given-names></name><name><surname>Bertagnolli</surname> <given-names>M</given-names></name><name><surname>Sorger</surname> <given-names>PK</given-names></name><name><surname>Sullivan</surname> <given-names>RJ</given-names></name><name><surname>Flaherty</surname> <given-names>KT</given-names></name><name><surname>Frederick</surname> <given-names>DT</given-names></name><name><surname>Jané-Valbuena</surname> <given-names>J</given-names></name><name><surname>Yoon</surname> <given-names>CH</given-names></name><name><surname>Rozenblatt-Rosen</surname> <given-names>O</given-names></name><name><surname>Shalek</surname> <given-names>AK</given-names></name><name><surname>Regev</surname> <given-names>A</given-names></name><name><surname>Garraway</surname> <given-names>LA</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title><source>Science</source><volume>352</volume><fpage>189</fpage><lpage>196</lpage><pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id><pub-id pub-id-type="pmid">27124452</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Traver</surname> <given-names>D</given-names></name><name><surname>Paw</surname> <given-names>BH</given-names></name><name><surname>Poss</surname> <given-names>KD</given-names></name><name><surname>Penberthy</surname> <given-names>WT</given-names></name><name><surname>Lin</surname> <given-names>S</given-names></name><name><surname>Zon</surname> <given-names>LI</given-names></name></person-group><year iso-8601-date="2003">2003</year><article-title>Transplantation and in vivo imaging of multilineage engraftment in zebrafish bloodless mutants</article-title><source>Nature Immunology</source><volume>4</volume><fpage>1238</fpage><lpage>1246</lpage><pub-id pub-id-type="doi">10.1038/ni1007</pub-id><pub-id pub-id-type="pmid">14608381</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Meer</surname> <given-names>W</given-names></name><name><surname>Scott</surname> <given-names>CS</given-names></name><name><surname>de Keijzer</surname> <given-names>MH</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>Automated flagging influences the inconsistency and Bias of band cell and atypical lymphocyte morphological differentials</article-title><source>Clinical Chemistry and Laboratory Medicine</source><volume>42</volume><fpage>371</fpage><lpage>377</lpage><pub-id pub-id-type="doi">10.1515/CCLM.2004.066</pub-id><pub-id pub-id-type="pmid">15147145</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Walt</surname> <given-names>S</given-names></name><name><surname>Colbert</surname> <given-names>SC</given-names></name><name><surname>Varoquaux</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>The NumPy array: a structure for efficient numerical computation</article-title><source>Computing in Science &amp; Engineering</source><volume>13</volume><fpage>22</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walters</surname> <given-names>DR</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>Hemocytes of saturniid silkworms: their behaviorin vivo andin vitro in response to diapause, development, and injury</article-title><source>Journal of Experimental Zoology</source><volume>174</volume><fpage>441</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1002/jez.1401740407</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weber</surname> <given-names>LM</given-names></name><name><surname>Robinson</surname> <given-names>MD</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Comparison of clustering methods for high-dimensional single-cell flow and mass cytometry data</article-title><source>Cytometry Part A</source><volume>89</volume><fpage>1084</fpage><lpage>1096</lpage><pub-id pub-id-type="doi">10.1002/cyto.a.23030</pub-id></element-citation></ref><ref id="bib52"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wickham</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2010">2010</year><article-title>stringr: modern, consistent string processing</article-title><source>The R Journal</source><volume>2</volume><fpage>38</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.32614/RJ-2010-012</pub-id></element-citation></ref><ref id="bib53"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wickham</surname> <given-names>H</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Ggplot2: Elegant Graphics for Data Analysis</source><publisher-name>Springer-Verlag</publisher-name><pub-id pub-id-type="doi">10.1007/978-0-387-98141-3</pub-id></element-citation></ref><ref id="bib54"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Wilke</surname> <given-names>CO</given-names></name></person-group><year iso-8601-date="2018">2018</year><data-title>ggridges, Ridgeline Plots in 'ggplot2'</data-title><source>Github</source><version designator="0.5.1">0.5.1</version><ext-link ext-link-type="uri" xlink:href="https://github.com/clauswilke/ggridges">https://github.com/clauswilke/ggridges</ext-link></element-citation></ref><ref id="bib55"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wittamer</surname> <given-names>V</given-names></name><name><surname>Bertrand</surname> <given-names>JY</given-names></name><name><surname>Gutschow</surname> <given-names>PW</given-names></name><name><surname>Traver</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Characterization of the mononuclear phagocyte system in zebrafish</article-title><source>Blood</source><volume>117</volume><fpage>7126</fpage><lpage>7135</lpage><pub-id pub-id-type="doi">10.1182/blood-2010-11-321448</pub-id><pub-id pub-id-type="pmid">21406720</pub-id></element-citation></ref><ref id="bib56"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yakimov</surname> <given-names>BP</given-names></name><name><surname>Gogoleva</surname> <given-names>MA</given-names></name><name><surname>Semenov</surname> <given-names>AN</given-names></name><name><surname>Rodionov</surname> <given-names>SA</given-names></name><name><surname>Novoselova</surname> <given-names>MV</given-names></name><name><surname>Gayer</surname> <given-names>AV</given-names></name><name><surname>Kovalev</surname> <given-names>AV</given-names></name><name><surname>Bernakevich</surname> <given-names>AI</given-names></name><name><surname>Fadeev</surname> <given-names>VV</given-names></name><name><surname>Armaganov</surname> <given-names>AG</given-names></name><name><surname>Drachev</surname> <given-names>VP</given-names></name><name><surname>Gorin</surname> <given-names>DA</given-names></name><name><surname>Darvin</surname> <given-names>ME</given-names></name><name><surname>Shcheslavskiy</surname> <given-names>VI</given-names></name><name><surname>Budylin</surname> <given-names>GS</given-names></name><name><surname>Priezzhev</surname> <given-names>AV</given-names></name><name><surname>Shirshin</surname> <given-names>EA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Label-free characterization of white blood cells using fluorescence lifetime imaging and flow-cytometry: molecular heterogeneity and erythrophagocytosis [Invited]</article-title><source>Biomedical Optics Express</source><volume>10</volume><fpage>4220</fpage><lpage>4236</lpage><pub-id pub-id-type="doi">10.1364/BOE.10.004220</pub-id><pub-id pub-id-type="pmid">31453006</pub-id></element-citation></ref></ref-list></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65372.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Zinzen</surname><given-names>Robert P</given-names></name><role>Reviewing Editor</role><aff><institution>Max Delbrück Centre for Molecular Medicine</institution><country>Germany</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Ho</surname><given-names>Joshua WK</given-names></name><role>Reviewer</role><aff><institution>Victor Chang Cardiac Research Institute</institution><country>Australia</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>Our editorial process produces two outputs: i) <ext-link ext-link-type="uri" xlink:href="https://sciety.org/articles/activity/10.1101/603035">public reviews</ext-link> designed to be posted alongside <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/603035v4">the preprint</ext-link> for the benefit of readers; ii) feedback on the manuscript for the authors, including requests for revisions, shown below. We also include an acceptance summary that explains what the editors found interesting or important about the work.</p></boxed-text><p>Thank you for submitting your article &quot;Image3C: a multimodal image-based and label independent integrative method for single-cell analysis&quot; for consideration by <italic>eLife</italic>…. Your article has been reviewed by 2 peer reviewers, one of whom is a member of our Board of Reviewing Editors, and the evaluation has been overseen by Didier Stainier as the Senior Editor.</p><p>Both reviewers have agreed that your submitted manuscript is a valuable contribution to the field of label-free assessment of complex cellular mixtures and should be published given some crucial revisions.</p><p>The reviewers have discussed their reviews with one another, and the Reviewing Editor has drafted this to help you prepare a revised submission.</p><p>Essential revisions:</p><p>1) Compare and contrast Image3C with other label-free phenotyping approaches, an issue raised by all reviewers.</p><p>2) The software should be made more accessible for the general user.</p><p>3) Please address the concerns regarding the assignment post CNN being &quot;unsupervised&quot;, which was raised by both reviewers.</p><p>4) Address other options for Image3C workflow tasks (e.g. feature extraction, image processing, clustering, etc.). – At a minimum, explain the choices more critically</p><p>Also, please address further comments below and correct/clarify figures as appropriate (see comments)</p><p><italic>Reviewer #1 (Recommendations for the authors):</italic></p><p>– Given this is a tool and resource paper, I think more attention should be placed in making the software accessible to the general users. In the github page, there are multiple mentions of 'If on site at SIMR' (which I assume refer to the Stower Institute for Medical Research), which did not inspire confidence that this tool is designed for use by a wide audience.</p><p>– Can the authors compare and clarify the contribution of Image3C against other label-free single cell image-based phenotyping systems?</p><p>– Since there are many choice of algorithms in each step of the pipeline, such as feature extraction, image processing, clustering, etc. Have the authors performed a comparison of several sensible methods to show that their choice is the most suitable? At the minimum, the authors should explain their choice more critically.</p><p><italic>Reviewer #2 (Recommendations for the authors):</italic></p><p>The authors present a convincing argument for the use of imaging flow cytometer data in profiling and comparing complex cell mixtures, such as dissociated tissues. I especially appreciated the application of Image3C to separate datasets from fish (<italic>D. rerio</italic> WKM) and a non-model system (Hemolymph from the apple snail): Not only do they present consistent clustering, but also the emergence of phagocytes upon infection. I can appreciate that Image3C is not only applicable without a host of established reagents, but that it might add an additional layer based on cell morphology, rather than pure transcriptomics (or genome accessibility) – these layers of information may be complimentary, which I suggest the authors make a point of.</p><p>The code is largely available (except the steps using proprietary software), which is good. However, I believe the code is currently too disjointed to be useful to a non-expert. The workflow currently involves steps using the Amnis IDEAS package, followed by custom scripts in R, followed by VorteX (I believe in Java) followed by more scripts in R, followed by optional classification using CNNs in python, with a side branch of operations using commercial flow cytometry software (FCSexpress). I think it would be advisable to somehow package this assemblage of scripts into a more accessible and user-friendly package. For example, open source packages like FlowCore might be integratable.</p><p>Along the same lines, are there any alternatives for depending on the specific instrument (Amnis ImageStream Mark2) and the proprietary IDEAS software?</p><p>As is, I was unable to test the packages for lack of instrument-specific data, software.</p><p>Sample data should be provided together with a testable, streamlined software package as well.</p><p>The authors have not sufficiently contextualized published work on label-free extraction of informative image features. Nor have they compared Image3C performance !</p><p>The authors should highlight and illustrate the reproducibility of the data across independent data sets (assuming this is true) – After going through the Materials and methods, I realized that several replicates were generated for each data set. Supplemental figures attest to that.</p><p>I am still not clear on how exactly cell type identities were assigned to the FDL clusters. It is my understanding that a lot of prior knowledge (and corresponding studies) was (were) necessary for assignment. As such, analysis using Image3C may be less useful for assessing cell type complexity, but rather for changes therein. The claim of &quot;cell types are identified by de novo clustering&quot; should then be toned down.</p><p>Furthermore, the statement that</p><p>&quot;…this produces a CNN-based cell classifier 'machine' used to quantify subsequently acquired image-based flow cytometry data and to compare cellular composition of samples across multiple experiments, in a high-throughput and unsupervised manner…„</p><p>is utterly bewildering to me. The CNN utilized cluster features as assignment guides. I believe that this is supervised by definition.&quot;</p><p>I was unable to sufficiently evaluate some of the figures, in particular the imaged cell arrays in various channels. In many cases the levels are such that signal I have to assume to be there is not visible. This is particularly true for the Phagocytosis assay, where DHR and CTV signal should be visible. Also, in these cases a direct comparison with sister cluster cells should be shown.</p><p>Check labels (especially in supplemental figures) for clarity (e.g. &quot;Single and Nuc&quot; in S3?)</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.65372.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Compare and contrast Image3C with other label-free phenotyping approaches, an issue raised by all reviewers.</p></disp-quote><p>We included in the manuscript a new table (Table 1) where we compare label-free phenotyping and cell clustering approaches. We took into consideration on which samples the tool was tested, the need of prior knowledge of the sample and/or species-specific reagents at any point of the process, and the hardware and software required. We also further discussed these aspects in the main text.</p><disp-quote content-type="editor-comment"><p>2) The software should be made more accessible for the general user.</p></disp-quote><p>To make our tool more accessible, we have: (1) thoroughly revised the readme document in the GitHub page making it clearer and more detailed; (2) added tutorial videos to the GitHub page to show how to use some of the mentioned software; (3) saved the R code as a markdown page to make it more user friendly; (4) renamed the example files that can be used to test our pipeline to make them more self-explanatory; (5) saved the Python code in the more user friendly Jupyter Notebooks; and (6) transformed Figure 1—figure supplement 1 in an interactive map where it is possible to click on the different steps of the Image3C pipeline and be automatically directed to the corresponding section of our GitHub repository page.</p><disp-quote content-type="editor-comment"><p>3) Please address the concerns regarding the assignment post CNN being &quot;unsupervised&quot;, which was raised by both reviewers.</p></disp-quote><p>We thank both reviewers for pointing this out and we apologize for the mistake. In the text, we rephrased all the sentences in which the CNN was mistakenly defined as “unsupervised”.</p><disp-quote content-type="editor-comment"><p>4) Address other options for Image3C workflow tasks (e.g. feature extraction, image processing, clustering, etc.). – At a minimum, explain the choices more critically.</p></disp-quote><p>We thank the reviewers for this comment. We did not perform a side-by-side comparison between several methods for each step of the pipeline, but we chose the algorithms and software based on published literature, pilots we performed, and availability of options based on the task. We now include in the Material and Methods a more detailed explanation the criteria used for our choices and we now mention an alternative to FCS Express that is the only software used that is not free or open source.</p><disp-quote content-type="editor-comment"><p>Also, please address further comments below and correct/clarify figures as appropriate (see comments).</p><p>Reviewer #1 (Recommendations for the authors):</p><p>– Given this is a tool and resource paper, I think more attention should be placed in making the software accessible to the general users. In the github page, there are multiple mentions of 'If on site at SIMR' (which I assume refer to the Stower Institute for Medical Research), which did not inspire confidence that this tool is designed for use by a wide audience.</p></disp-quote><p>We completely agree with this comment and we apologize for the oversights. We removed all the references to SIMR and we included a number of changes aimed at making the pipeline more accessible. We have: (1) thoroughly revised the readme document in the GitHub page making it clearer and more detailed; (2) added tutorial videos to the GitHub page to show how to use some of the key software mentioned in the manuscript; (3) saved the R code as a markdown page to make it more user friendly; (4) renamed the example files that can be used to test our pipeline to make them more self-explanatory; (5) saved the Python code in the more user friendly Jupyter Notebooks; (6) transformed Figure 1-supplement figure 1 in an interactive map where it is possible to click on the different steps of the Image3C pipeline and be automatically directed to the corresponding section of our GitHub repository page.</p><disp-quote content-type="editor-comment"><p>– Can the authors compare and clarify the contribution of Image3C against other label-free single cell image-based phenotyping systems?</p></disp-quote><p>We included in the manuscript a new table (Table 1) where we compare label-free phenotyping and cell-clustering approaches. We took into consideration on which samples the tool was tested, the need for prior knowledge of the sample and/or species-specific reagents at any point of the process, and the hardware and software required. We also further discuss these aspects in the main text.</p><disp-quote content-type="editor-comment"><p>– Since there are many choice of algorithms in each step of the pipeline, such as feature extraction, image processing, clustering, etc. Have the authors performed a comparison of several sensible methods to show that their choice is the most suitable? At the minimum, the authors should explain their choice more critically.</p></disp-quote><p>We did not perform a side-by-side comparison between several methods for each step of the pipeline, but we chose the algorithms and software based on published literature, pilots we performed and availability of options based on the task. We now include in the Material and Methods a more detailed explanation for our choices and we mention an alternative to FCS Express which is the only software used that is not free or open source.</p><disp-quote content-type="editor-comment"><p>Reviewer #2 (Recommendations for the authors):</p><p>The authors present a convincing argument for the use of imaging flow cytometer data in profiling and comparing complex cell mixtures, such as dissociated tissues. I especially appreciated the application of Image3C to separate datasets from fish (<italic>D. rerio</italic> WKM) and a non-model system (Hemolymph from the apple snail): Not only do they present consistent clustering, but also the emergence of phagocytes upon infection. I can appreciate that Image3C is not only applicable without a host of established reagents, but that it might add an additional layer based on cell morphology, rather than pure transcriptomics (or genome accessibility) – these layers of information may be complimentary, which I suggest the authors make a point of.</p></disp-quote><p>We thank the reviewer for this comment. We highlighted this point in the Introduction and in the Discussion, broadening up the scenarios where Image3C can be a valuable resource.</p><disp-quote content-type="editor-comment"><p>The code is largely available (except the steps using proprietary software), which is good. However, I believe the code is currently too disjointed to be useful to a non-expert. The workflow currently involves steps using the Amnis IDEAS package, followed by custom scripts in R, followed by VorteX (I believe in Java) followed by more scripts in R, followed by optional classification using CNNs in python, with a side branch of operations using commercial flow cytometry software (FCSexpress). I think it would be advisable to somehow package this assemblage of scripts into a more accessible and user-friendly package. For example, open source packages like FlowCore might be integratable.</p></disp-quote><p>To make our tool more accessible, we have: (1) thoroughly revised the readme document in the GitHub page making it clearer and more detailed; (2) added tutorial videos to the GitHub page to show how to use some of the mentioned software; (3) saved the R code as a markdown page to make it more user friendly; (4) renamed the example files that can be used to test our pipeline to make them more self-explanatory; (5) saved the Python code in the more user friendly Jupyter Notebooks; and (6) transformed Figure 1-supplement figure 1 in an interactive map where it is possible to click on the different steps of the Image3C pipeline and be automatically directed to the corresponding section of our GitHub repository page. We now include in the Material and Methods an explanation for our choices of software/algorithms and we mention an alternative to FCS Express that is the only software used that is not free or open source.</p><disp-quote content-type="editor-comment"><p>Along the same lines, are there any alternatives for depending on the specific instrument (Amnis ImageStream Mark2) and the proprietary IDEAS software? As is, I was unable to test the packages for lack of instrument-specific data, software. Sample data should be provided together with a testable, streamlined software package as well.</p></disp-quote><p>We thank the reviewer for this comment. We uploaded in the GitHub an example dataset for users to test the pipeline without having to collect data themselves. We also uploaded files saved at intermediate steps of analysis so the users can test the steps following the IDEAS software. Once the users are ready to perform the experiments and they have an Imagestream available, then the IDEAS software can be freely downloaded.</p><disp-quote content-type="editor-comment"><p>The authors have not sufficiently contextualized published work on label-free extraction of informative image features. Nor have they compared Image3C performance!</p></disp-quote><p>We have now included in the manuscript a new table (Table 1) where we compare label-free phenotyping and cell clustering approaches. We took into consideration on which samples the tool was tested, the need for prior knowledge of the sample and/or species-specific reagents at any point of the process, and the hardware and software required. We also further discuss these aspects in the main text.</p><p>Concerning the comparison of performance, Image3C was developed because of the lack of published tools able to perform de novo clustering without the use of specific cell-type markers. We also included, in the Material and Methods, the rationale for selecting these specific algorithms as part of the pipeline and, in the Discussion, we now mention that the true positive rate we obtain after CNN training is comparable to the rate reported in other trained neural networks.</p><disp-quote content-type="editor-comment"><p>The authors should highlight and illustrate the reproducibility of the data across independent data sets (assuming this is true) – After going through the Materials and methods, I realized that several replicates were generated for each data set. Supplemental figures attest to that.</p></disp-quote><p>We thank the reviewer for mentioning the replicates aspects. The number of replicates per datasets are reported in the figure legends and in the Material and Methods. We now include comments about the reproducibility between replicates in the Results and we include 3 new supplementary figures, that, together with Figure 2—figure supplement 2, illustrate the correlation between samples and potential outliers (Figure 3—figure supplement 1, Figure 4—figure supplement 1, and Figure 5—figure supplement 1).</p><disp-quote content-type="editor-comment"><p>I am still not clear on how exactly cell type identities were assigned to the FDL clusters. It is my understanding that a lot of prior knowledge (and corresponding studies) was (were) necessary for assignment. As such, analysis using Image3C may be less useful for assessing cell type complexity, but rather for changes therein. The claim of &quot;cell types are identified by de novo clustering&quot; should then be toned down.</p></disp-quote><p>We thank the reviewer for pointing this out. We completely agree that assigning cell types is a long-term goal and that additional experiments (such as functional assays) and examination of published literature will be necessary for achieving that. In the text, we toned down our statements, highlighting the possibility of comparing cluster abundance while making it clear that only a combination of cell morphologies, cell functions and comparison with data published in closely related organisms will allow for definitive cell type identification.</p><disp-quote content-type="editor-comment"><p>Furthermore, the statement that</p><p>&quot;…this produces a CNN-based cell classifier 'machine' used to quantify subsequently acquired image-based flow cytometry data and to compare cellular composition of samples across multiple experiments, in a high-throughput and unsupervised manner…„</p><p>is utterly bewildering to me. The CNN utilized cluster features as assignment guides. I believe that this is supervised by definition.&quot;</p></disp-quote><p>We thank the reviewer for pointing this out. We completely agree and have removed the word “unsupervised” from the mentioned sentence.</p><disp-quote content-type="editor-comment"><p>I was unable to sufficiently evaluate some of the figures, in particular the imaged cell arrays in various channels. In many cases the levels are such that signal I have to assume to be there is not visible. This is particularly true for the Phagocytosis assay, where DHR and CTV signal should be visible. Also, in these cases a direct comparison with sister cluster cells should be shown.</p></disp-quote><p>We thank the reviewer and we apologize for the difficulties encountered in evaluating the signal in the cell images. Unfortunately, FCS Express, the software that we used to combine cell images and their cluster IDs and produce the cell galleries (Supplementary Files 4, 7, 8 and 11) uses the information obtained from IDEAS and does not allow display adjustments (intensity/brightness/color) of the images. We agree that the color used for the bacterial signal is not giving the best contrast against the background and we apologize for the limited possibilities in adjusting the image features using FCS Express. As suggested from the reviewer, we included in the manuscript a new Supplementary Figure (Figure 5—figure supplement 4) showing in yellow the signal of the bacteria labelled with cell-trace-violett and comparing side-by-side professional phagocytes and non-phagocytic hemocytes from the apple snail. These images were obtained using the Gallery function of the Amnis IDEAS software and the value for the signal intensity is reported on top of each individual image. In addition, we now highlight in the legends of Figures 2, 3, 4 and 5 that a representation of cells belonging to each cluster has been shown in the Supplementary Files, where there is no space limitation.</p><disp-quote content-type="editor-comment"><p>Check labels (especially in supplemental figures) for clarity (e.g. &quot;Single and Nuc&quot; in S3 ?)</p></disp-quote><p>We checked all the labels in the Figures, Supplementary Files and we modified those that could be unclear to readers and users, such as labels in Figure 2—figure supplement 2 (previous Figure S3) and Supplementary File 3.</p></body></sub-article></article>