<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN"  "JATS-archivearticle1.dtd"><article article-type="research-article" dtd-version="1.1" xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink"><front><journal-meta><journal-id journal-id-type="nlm-ta">elife</journal-id><journal-id journal-id-type="publisher-id">eLife</journal-id><journal-title-group><journal-title>eLife</journal-title></journal-title-group><issn pub-type="epub" publication-format="electronic">2050-084X</issn><publisher><publisher-name>eLife Sciences Publications, Ltd</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">53433</article-id><article-id pub-id-type="doi">10.7554/eLife.53433</article-id><article-categories><subj-group subj-group-type="display-channel"><subject>Research Article</subject></subj-group><subj-group subj-group-type="heading"><subject>Ecology</subject></subj-group><subj-group subj-group-type="heading"><subject>Evolutionary Biology</subject></subj-group></article-categories><title-group><article-title>Eco-evolutionary dynamics of nested Darwinian populations and the emergence of community-level heredity</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes" id="author-34069"><name><surname>Doulcier</surname><given-names>Guilhem</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3720-9089</contrib-id><email>guilhem.doulcier@ens.fr</email><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="other" rid="fund1"/><xref ref-type="fn" rid="con1"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" id="author-96724"><name><surname>Lambert</surname><given-names>Amaury</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7248-9955</contrib-id><xref ref-type="aff" rid="aff3">3</xref><xref ref-type="aff" rid="aff4">4</xref><xref ref-type="fn" rid="con2"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-34070"><name><surname>De Monte</surname><given-names>Silvia</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-7953-5494</contrib-id><xref ref-type="aff" rid="aff2">2</xref><xref ref-type="aff" rid="aff5">5</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund2"/><xref ref-type="other" rid="fund3"/><xref ref-type="fn" rid="con3"/><xref ref-type="fn" rid="conf1"/></contrib><contrib contrib-type="author" equal-contrib="yes" id="author-3163"><name><surname>Rainey</surname><given-names>Paul B</given-names></name><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-0879-5795</contrib-id><xref ref-type="aff" rid="aff1">1</xref><xref ref-type="aff" rid="aff6">6</xref><xref ref-type="fn" rid="equal-contrib1">†</xref><xref ref-type="other" rid="fund1"/><xref ref-type="other" rid="fund4"/><xref ref-type="fn" rid="con4"/><xref ref-type="fn" rid="conf2"/></contrib><aff id="aff1"><label>1</label><institution>Laboratoire de Génétique de l'Evolution, Chimie Biologie et Innovation, Université PSL</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff2"><label>2</label><institution>Institut de Biologie de l’École Normale Supérieure (IBENS), École Normale Supérieure, Université PSL</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff3"><label>3</label><institution>Laboratoire de Probabilités, Statistique et Modélisation (LPSM), Sorbonne Université, CNRS</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff4"><label>4</label><institution>Center for Interdisciplinary Research in Biology (CIRB), Collège de France, Université PSL, CNRS, INSERM</institution><addr-line><named-content content-type="city">Paris</named-content></addr-line><country>France</country></aff><aff id="aff5"><label>5</label><institution>Department of Evolutionary Theory, Max Planck Institute for Evolutionary Biology</institution><addr-line><named-content content-type="city">Plön</named-content></addr-line><country>Germany</country></aff><aff id="aff6"><label>6</label><institution>Department of Microbial Population Biology, Max Planck Institute for Evolutionary Biology</institution><addr-line><named-content content-type="city">Plön</named-content></addr-line><country>Germany</country></aff></contrib-group><contrib-group content-type="section"><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="senior_editor"><name><surname>Wittkopp</surname><given-names>Patricia J</given-names></name><role>Senior Editor</role><aff><institution>University of Michigan</institution><country>United States</country></aff></contrib></contrib-group><author-notes><fn fn-type="con" id="equal-contrib1"><label>†</label><p>These authors contributed equally to this work</p></fn></author-notes><pub-date date-type="publication" publication-format="electronic"><day>07</day><month>07</month><year>2020</year></pub-date><pub-date pub-type="collection"><year>2020</year></pub-date><volume>9</volume><elocation-id>e53433</elocation-id><history><date date-type="received" iso-8601-date="2019-11-07"><day>07</day><month>11</month><year>2019</year></date><date date-type="accepted" iso-8601-date="2020-06-12"><day>12</day><month>06</month><year>2020</year></date></history><permissions><copyright-statement>© 2020, Doulcier et al</copyright-statement><copyright-year>2020</copyright-year><copyright-holder>Doulcier et al</copyright-holder><ali:free_to_read/><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><ali:license_ref>http://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="elife-53433-v2.pdf"/><abstract><p>Interactions among microbial cells can generate new chemistries and functions, but exploitation requires establishment of communities that reliably recapitulate community-level phenotypes. Using mechanistic mathematical models, we show how simple manipulations to population structure can exogenously impose Darwinian-like properties on communities. Such scaffolding causes communities to participate directly in the process of evolution by natural selection and drives the evolution of cell-level interactions to the point where, despite underlying stochasticity, derived communities give rise to offspring communities that faithfully re-establish parental phenotype. The mechanism is akin to a developmental process (<italic>developmental correction</italic>) that arises from density-dependent interactions among cells. Knowledge of ecological factors affecting evolution of developmental correction has implications for understanding the evolutionary origin of major egalitarian transitions, symbioses, and for top-down engineering of microbial communities.</p></abstract><kwd-group kwd-group-type="author-keywords"><kwd>artificial community selection</kwd><kwd>major evolutionary transitions</kwd><kwd>multi-level selection</kwd><kwd>experimental evolution</kwd><kwd>darwinian properties</kwd></kwd-group><kwd-group kwd-group-type="research-organism"><title>Research organism</title><kwd>None</kwd></kwd-group><funding-group><award-group id="fund1"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-10-IDEX-001-02</award-id><principal-award-recipient><name><surname>Doulcier</surname><given-names>Guilhem</given-names></name><name><surname>Rainey</surname><given-names>Paul B</given-names></name></principal-award-recipient></award-group><award-group id="fund2"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-10-LABX-54</award-id><principal-award-recipient><name><surname>De Monte</surname><given-names>Silvia</given-names></name></principal-award-recipient></award-group><award-group id="fund3"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001665</institution-id><institution>Agence Nationale de la Recherche</institution></institution-wrap></funding-source><award-id>ANR-11-IDEX-0001-02</award-id><principal-award-recipient><name><surname>De Monte</surname><given-names>Silvia</given-names></name></principal-award-recipient></award-group><award-group id="fund4"><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004189</institution-id><institution>Max-Planck-Gesellschaft</institution></institution-wrap></funding-source><principal-award-recipient><name><surname>Rainey</surname><given-names>Paul B</given-names></name></principal-award-recipient></award-group><funding-statement>The funders had no role in study design, data collection and interpretation, or the decision to submit the work for publication.</funding-statement></funding-group><custom-meta-group><custom-meta specific-use="meta-only"><meta-name>Author impact statement</meta-name><meta-value>Artificial selection on communities drives the evolution of interactions and establishes community-level inheritance.</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1" sec-type="intro"><title>Introduction</title><p>Thirty years ago, in an article arguing the importance of the ‘superorganism’, Wilson and Sober expressed surprise that biologists had not recognised that communities — in the laboratory — ‘<italic>could be treated as entities with heritable variation and selected accordingly</italic>’ (<xref ref-type="bibr" rid="bib48">Wilson and Sober, 1989</xref>). That they might be treated as such, stemmed from recognition that the eukaryotic cell is a tight-knit community of two once free-living microbes (<xref ref-type="bibr" rid="bib30">Margulis, 1970</xref>), but also from observations in nature of social insect colonies (<xref ref-type="bibr" rid="bib46">Wilson, 1985</xref>), cellular slime molds (<xref ref-type="bibr" rid="bib5">Bonner, 1982</xref>; <xref ref-type="bibr" rid="bib7">Buss, 1982</xref>), and especially of phoretic insect communities (<xref ref-type="bibr" rid="bib47">Wilson and Knollenberg, 1987</xref>).</p><p>Phoretic insect communities comprise a focal organism — often an insect such as a beetle — that moves between patchily distributed ephemeral resources carrying with it a myriad of associated organisms, including mites, nematodes and microbes. Communities associated with each insect differ by virtue of the composite members, with the conceivable possibility that some associations may harm the carrier insect, while others may bring benefit. Given that the role of dispersal is loosely analogous to a community-level reproduction event, Wilson and Sober argued that selection at the level of insect communities was likely to trump within-community selection leading to communities ‘<italic>becoming organised into an elaborate mutualistic network that protects the insect from its natural enemies, gathers food, and so on</italic>’.</p><p>If this might happen in nature, then why might this not be realised even more potently in the laboratory? Indeed, the logic of Darwinism says it should. Provided there exists heritable variance in fitness at the level of communities, then communities will participate as units (in their own right) in the process of evolution by natural selection (<xref ref-type="bibr" rid="bib29">Lewontin, 1970</xref>; <xref ref-type="bibr" rid="bib18">Godfrey-Smith, 2009</xref>). In nature, the necessary conditions are likely rare (<xref ref-type="bibr" rid="bib20">Goodnight and Stevens, 1997</xref>), but ecological circumstances can sometimes conspire to ensure that variation among communities is discrete, that communities replicate and that offspring communities show some resemblance to parental communities. Phoretic insect communities are a plausible case in point. In the laboratory, however, the experimenter can readily construct conditions that ensure communities (or any collective of cells) are units of selection (<xref ref-type="bibr" rid="bib26">Johnson and Boerlijst, 2002</xref>; <xref ref-type="bibr" rid="bib11">Day et al., 2011</xref>; <xref ref-type="bibr" rid="bib50">Xie and Shou, 2018</xref>; <xref ref-type="bibr" rid="bib49">Xie et al., 2019</xref>). A critical requirement is a birth-death process operating over a time scale longer than the doubling time of individual cells (<xref ref-type="bibr" rid="bib23">Hammerschmidt et al., 2014</xref>; <xref ref-type="bibr" rid="bib36">Rainey et al., 2017</xref>; <xref ref-type="bibr" rid="bib4">Black et al., 2020</xref>).</p><p>Empirical support for the prediction that selection really can shape communities was provided by Swenson and colleagues who performed two studies in which artificial selection was imposed on microbial communities from soil (<xref ref-type="bibr" rid="bib40">Swenson et al., 2000a</xref>; <xref ref-type="bibr" rid="bib41">Swenson et al., 2000b</xref>). In the first, they selected communities that affected plant growth. In the second, they selected communities for ability to degrade the environmental pollutant 3-chloroaniline. In both instances, communities at extreme values of community function were repeatedly propagated. In both studies, a significant response was measured at the level of the community.</p><p>Although the finding was a surprise (<xref ref-type="bibr" rid="bib19">Goodnight, 2000</xref>), it is consistent with expectations that communities of entities — no matter their identity — will participate in the process of evolution by natural selection provided communities are discrete, they replicate, and that offspring communities resemble parental communities (<xref ref-type="bibr" rid="bib18">Godfrey-Smith, 2009</xref>). Discreteness is conferred by simply compartmentalising communities via their placement in independent vessels. Replication is achieved by taking a sample of the selected communities with transfer to a new vessel. Heredity, however, is less tangible, especially in the Swenson experiments, where the selected communities were pooled before redistribution into fresh vessels. Nonetheless, intuition says that heredity becomes established through interactions (<xref ref-type="bibr" rid="bib48">Wilson and Sober, 1989</xref>; <xref ref-type="bibr" rid="bib19">Goodnight, 2000</xref>). Understanding the mechanistic bases of community-level heredity and its emergence motivates our study.</p><p>We begin by posing a thought experiment realisable via ever improving capacity to manipulate small volumes of liquid (<xref ref-type="bibr" rid="bib2">Baraban et al., 2011</xref>; <xref ref-type="bibr" rid="bib37">Sackmann et al., 2014</xref>; <xref ref-type="bibr" rid="bib10">Cottinet et al., 2016</xref>). Consider a millifluidic device that controls the composition of emulsions. Consider thousands of microlitre-sized droplets each harbouring communities comprised of two types of microbes that differ solely in the colour of a fluorescent protein: one type encodes a red fluorescent protein and the other a blue fluorescent protein. Interest is in the evolution of communities that are of the colour purple (an equal ratio of red-to-blue cells). Within each droplet, red and blue microbes replicate with growth rate and interaction rates being subject to evolutionary change. In the mean time, the experimenter, via lasers installed on the device, has determined the precise colour of each droplet and a priori decided that half of the droplets with composition furthest from an equal ratio of red-to-blue will be eliminated, whilst the fraction whose colour is closest to purple will be allowed to replicate. Replication involves a dilution step during which an aliquot of cells are sampled and nutrients replenished. A further round of growth then ensues along with a further round of droplet-level selection. The protocol continues thereafter with selection taking place at the level of communities via a birth-death process. In essence the schema, outlined in <xref ref-type="fig" rid="fig1">Figure 1</xref> and inherent in the work of Swenson and colleagues, involves exogenous imposition of ecological conditions sufficient to cause droplets to function as units of selection. The concept, elaborated in detail elsewhere, is referred to as ‘ecological scaffolding’ (<xref ref-type="bibr" rid="bib4">Black et al., 2020</xref>).</p><fig id="fig1" position="float"><label>Figure 1.</label><caption><title>Nested model of evolution.</title><p>Collectives (large circles) follow a birth-death process (grey) with non-overlapping generations. Collectives are composed of particles (small spheres) that also follow a birth-death process (<italic>growth</italic>, represented by thick green arrows). Offspring collectives are founded by sampling particles from parent collectives (<italic>dilution</italic>, represented by thin green arrows, first and third rows). Survival of collectives depends on colour. Collectives that contain too many blue (second row) or red (fourth row) particles are marked for extinction. The number of collectives is kept constant. Mutation affects particle traits (see main text for details).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig1-v2.tif"/></fig><p>Under this scaffolded-regime, communities within droplets are endowed with Darwinian-like properties (we use this term to convey the fact that removal of the scaffold leads, at least initially, to complete loss of community-level individuality). Collective-level variation is discretised by virtue of the bounds provided by the immiscibility of oil and water (communities are thus confined to droplets). Additionally, the device ensures that droplets engage in a birth-death process: droplets furthest from the collective-level trait are extinguished, whereas those closest to the colour purple are diluted and split, thus effecting collective-level reproduction. Not determined by the device however is the relationship between parent and offspring droplets. Because the trait of the parent community depends on properties of the cellular constituents, there is — in the absence of interactions between red and blue cells — little chance that purple-coloured communities will reliably give rise to purple-coloured offspring. This is in part due to the stochastic nature of the dilution phase (a droplet with an equal ratio of red to blue is unlikely to give rise to offspring droplets founded with the same equal ratio of types) but also to within-droplet selection favouring fast growing types. Purple-coloured droplets can be maintained, as envisioned by the ‘stochastic corrector’ model (<xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>; <xref ref-type="bibr" rid="bib21">Grey et al., 1995</xref>; <xref ref-type="bibr" rid="bib27">Johnston and Jones, 2015</xref>), provided only those communities with the correct colour are propagated. However, within-droplet selection favours rapidly growing cells resulting in successive reduction of the number of viable droplets.</p><p>Here, we show that when cellular interactions are also allowed to evolve, selection imposed at the collective level, leads to evolution of a developmental-like process, which ensures that offspring communities resemble parental communities, irrespective of the initial phenotype at the moment of birth. We illustrate the evolutionary process by means of stochastic simulations for nested populations of cells (particles) and communities (collectives) undergoing a death-birth process. In order to generalise our findings we derive a deterministic approximation, which we then use to show how selection on community phenotype drives the evolution of ecological interactions that are the basis of community-level heredity.</p></sec><sec id="s2" sec-type="results"><title>Results</title><sec id="s2-1"><title>A nested model of collective evolution</title><p>As described above and depicted in <xref ref-type="fig" rid="fig1">Figure 1</xref>, we consider a nested model in which particles are discretised into a population of collectives. Each collective is comprised of two kinds of self-replicating particle (red and blue) that together determine collective colour. Colour is important because it is the phenotype upon which collectives succeed or fail. Collectives that are too far from an optimal colour face extinction, whereas those within acceptable bounds persist with the possibility of reproduction. Birth-death at the level of collectives affects the eco-evolutionary dynamics of particles as particle-level traits that give rise to unfit collectives are eliminated.</p><p>We firstly present numerical simulations where particles undergo a stochastic birth-death process (<xref ref-type="bibr" rid="bib9">Champagnat et al., 2006</xref>; <xref ref-type="bibr" rid="bib13">Doebeli et al., 2017</xref>) and collectives are selected based on colour. The details of the model are described in Appendix 1, but we introduce the main assumptions and underlying principles here. Each particle of type <inline-formula><mml:math id="inf1"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is characterised by four traits (hereafter <italic>particle traits</italic>): colour (<inline-formula><mml:math id="inf2"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, red or blue), net maximum growth rate <inline-formula><mml:math id="inf3"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and two competition parameters (<inline-formula><mml:math id="inf4"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>intra</mml:mtext></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="inf5"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>inter</mml:mtext></mml:msubsup></mml:math></inline-formula>). At any particular instant particles either reproduce or die. Particles of type <italic>i</italic> reproduce with a constant birth rate <inline-formula><mml:math id="inf6"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> and die as a consequence of competition. The rate of death is density-dependent such that each particle of type increases the death rate of <inline-formula><mml:math id="inf7"><mml:mi>i</mml:mi></mml:math></inline-formula>-type particles by <inline-formula><mml:math id="inf8"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mtext>intra</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> if they share the same colour (<inline-formula><mml:math id="inf9"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>), or by <inline-formula><mml:math id="inf10"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mtext>inter</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> when colours are different (<inline-formula><mml:math id="inf11"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). All transition rates can be found in Appendix 1, paragraph 'particle-level ecology'. Competition rates are referred to as ‘interaction’ traits or parameters. We expand on more general types of interaction — from exploitative to mutualistic — in the Discussion and in Appendix 3.</p><p>Mutations are introduced at the level of particles. Mutation affects either particle maximum growth rate (<inline-formula><mml:math id="inf12"><mml:mi>r</mml:mi></mml:math></inline-formula>) or the inter-colour competition parameter (<inline-formula><mml:math id="inf13"><mml:msup><mml:mi>a</mml:mi><mml:mtext>inter</mml:mtext></mml:msup></mml:math></inline-formula>) by a small random quantity. In the spirit of adaptive dynamics (<xref ref-type="bibr" rid="bib15">Geritz et al., 1998</xref>), the particle type carrying the new set of traits is referred to as a mutant, and the existing type is designated the resident. Within every collective and at any time, there are four populations composed of resident and mutant types of the two colours. Mutations are assumed to be rare. In order to accelerate numerical simulations, one mutant individual is introduced every time one population of a given colour goes extinct in one of the collectives. The newly added type has the the same colour as the extinct type.</p><p>Collectives also undergo a birth-death process. The number of collectives <inline-formula><mml:math id="inf14"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is constant and collective generations are discrete and non-overlapping. Each collective generation begins at time <inline-formula><mml:math id="inf15"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> with offspring collectives containing <inline-formula><mml:math id="inf16"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> founding particles. Particles replicate, interact and evolve according to the particle traits. After duration <inline-formula><mml:math id="inf17"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, collectives attain ‘adult’ stage, and a fixed proportion of collectives <inline-formula><mml:math id="inf18"><mml:mi>ρ</mml:mi></mml:math></inline-formula> is marked for extinction. This allows the possibility of selection on collectives based on their properties (the <italic>collective phenotype</italic>), which is derived from the composing particles. Our focus is collective colour, which is defined as the proportion <inline-formula><mml:math id="inf19"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> of red particles.</p><p>Initially, collectives contain red and blue particles in uniformly distributed ratios. Collectives are subject to evolution under two contrasting regimes: one neutral and the other selective. Under the neutral regime, the pool of collectives marked for extinction is sampled at random, whereas under the selective regime, collectives marked for extinction are those whose adult colour departs most from an arbitrarily fixed optimal colour <inline-formula><mml:math id="inf20"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. Extinguished collectives are replaced by offspring from uniformly sampled extant collectives (<xref ref-type="fig" rid="fig1">Figure 1</xref>). All other collectives are replaced by their own offspring. Reproduction involves uniformly sampling <inline-formula><mml:math id="inf21"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> particles from the parent collective. Particles from one collective never mix with particles from any other. This establishes an unambiguous parent-offspring relationship (<xref ref-type="bibr" rid="bib12">De Monte and Rainey, 2014</xref>). The adult colour of offspring collectives depends on the founding frequencies of particles (whose variance is negatively related to bottleneck size <inline-formula><mml:math id="inf22"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>), and on ensuing particle-level population dynamics.</p></sec><sec id="s2-2"><title>Selection on collectives drives the evolution of particle traits</title><p>In the absence of collective-level selection (neutral regime), collectives converge to a monochromatic phenotype (<xref ref-type="fig" rid="fig2">Figure 2A</xref>). Once collectives are composed of either all-red or all-blue particles, the contrasting colour cannot be rescued (colour change by mutation or migration is not possible). The distribution of collective colour becomes biased toward faster-growing particle types, with selection driving a gradual increase in particle growth rate (<xref ref-type="fig" rid="fig2">Figure 2C</xref>). The inter-colour competition trait (<xref ref-type="fig" rid="fig2">Figure 2E</xref>) is irrelevant once collectives become monochromatic (evolution is then governed by drift).</p><fig id="fig2" position="float"><label>Figure 2.</label><caption><title>Evolutionary dynamics of collectives and particles.</title><p>A population of <inline-formula><mml:math id="inf23"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1000 D collectives was allowed to evolve for <inline-formula><mml:math id="inf24"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 10,000 generations under the stochastic birth-death model described in the main text (see Appendix 1 for details on the algorithm used for the numerical simulations). Initially, each collective was composed of <inline-formula><mml:math id="inf25"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> particles of two types: red (<inline-formula><mml:math id="inf26"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.8</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.15</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mtext>red</mml:mtext></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>) and blue (<inline-formula><mml:math id="inf27"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.3</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.15</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mtext>blue</mml:mtext></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>), with <inline-formula><mml:math id="inf28"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1500. The proportions at generation 0 were randomly drawn from a uniform distribution. At the beginning of every successive collective generation, each offspring collective was seeded with founding particles sampled from its parent. Particles were then grown for a duration of <inline-formula><mml:math id="inf29"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> = 1. When the adult stage was attained, 200 collectives (<inline-formula><mml:math id="inf30"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) were extinguished, allowing opportunity for extant collectives to reproduce. Collectives were marked for extinction either uniformly at random (<italic>neutral regime</italic>, panels <italic>A, C, E</italic>, as well as <xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1A</xref> and <xref ref-type="fig" rid="app1fig4">4A</xref>), or based on departure of the adult colour from the optimal purple colour (<inline-formula><mml:math id="inf31"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>) (<italic>selective regime</italic>, panels <italic>B, D, F</italic>, as well as <xref ref-type="fig" rid="app1fig1">Appendix 1—figures 1B</xref> and <xref ref-type="fig" rid="app1fig4">4B</xref>). Panels A and B, respectively, show how the distribution of the collective phenotype changes in the absence and presence of selection on collective colour. The first 30 collective generations (before the grey line) are magnified in order to make apparent early rapid changes. In the absence of collective-level selection purple collectives are lost in fewer than 10 generations leaving only red collectives (<bold>A</bold>) whereas purple collectives are maintained in the selective regime (<bold>B</bold>). Panels C-F illustrate time-resolved variation in the distribution of underlying particle traits. A diversity of traits is maintained in the population because every lineage harbours two sets of traits for every colour (see Appendix 1). Selection for purple-coloured collectives drives evolutionary increase in particle growth rate (<bold>D</bold>) compared to the neutral regime (<bold>C</bold>). In the neutral regime, inter-colour evolution of competition traits is driven by drift (<bold>E</bold>), whereas with collective-level selection density-dependent interaction rates between particles of different colours rapidly achieve evolutionarily stable values, with one colour loosing its density-dependence on the other (<bold>F</bold>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig2-v2.tif"/></fig><p>The dynamic is very different once selection is imposed at the level of collectives. By rewarding collectives closest to the colour purple (a fixed <inline-formula><mml:math id="inf32"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> ratio of red to blue particles), it is possible to prevent fixation of either colour (<xref ref-type="fig" rid="fig2">Figure 2B</xref>). Starting, as above, from collectives containing red and blue particles in uniformly distributed ratios, mean collective colour shifts toward red. The time scale is, as in the neutral case, a consequence of the faster initial growth rate of red particles. For a few tens of generations, the population of collectives remains strongly biased towards red. The optimal phenotype is maintained by selection for the least worse collective colour precisely as envisaged by the stochastic corrector model (<xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>; <xref ref-type="fig" rid="app1fig5">Appendix 1—figure 5</xref>). Subsequently, however, the trend reverses and mean collective colour progressively approaches purple. From generation 1000, variance in the distribution of colour decreases, as a consequence of improvement in the ability of purple-parent collectives to give rise to offspring collectives that at adult age resemble parental types. This is associated with escalating particle growth rate (<xref ref-type="fig" rid="fig2">Figure 2D</xref>) and a saturating increase in between-colour competition (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). The latter reflects directional selection that moves the average phenotype in the population of collectives towards the optimal colour <inline-formula><mml:math id="inf33"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> (reached by generation 7000).</p><p>By affecting particle traits, selection on colour also modifies dynamics within collectives. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows variation of colour within a single collective growth phase at generation 3 and generation 9000. Prior to selection shaping particle traits, both red and blue particle types follow approximately exponential growth (<xref ref-type="fig" rid="fig3">Figure 3C</xref>). The resulting adult collective colour is thus biased towards the faster-growing red type (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). In contrast, at generation 9000 (<xref ref-type="fig" rid="fig3">Figure 3B</xref>), both particle types reach a saturating steady state that ensures that adult colour is purple. Initial departures from a 1:1 ratio — caused by the stochasticity of collective reproduction and/or particle growth dynamics — are compensated for during the growth phase (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). Compensation is a consequence of the evolution of inter-colour competition traits (<xref ref-type="fig" rid="fig2">Figure 2F</xref>). Population expansion is in turn dependent upon earlier increases in particle growth rate (<xref ref-type="fig" rid="fig2">Figure 2D</xref>). Moreover, selection favours competition trait values for which blue types have no effect on red types: <inline-formula><mml:math id="inf34"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> of blue types is close to zero by generation 5000 (<xref ref-type="fig" rid="fig2">Figure 2F</xref>).</p><fig id="fig3" position="float"><label>Figure 3.</label><caption><title>Ecological dynamics of particles.</title><p>A sample of 300 (from a total of 1000) collectives were taken from each of generations 3 (<bold>A,C</bold>) and 9000 (<bold>B,D</bold>) in the evolutionary trajectory of <xref ref-type="fig" rid="fig2">Figure 2</xref>. The dynamic of particles was simulated through a single collective generation (<inline-formula><mml:math id="inf35"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>), based on the particle traits of each collective. Each grey line denotes a single collective. The frequency distribution of adult collective colour (the fraction of red particles at time <inline-formula><mml:math id="inf36"><mml:mi>T</mml:mi></mml:math></inline-formula>), is represented in the panel to the right. The grey area indicates the fraction <inline-formula><mml:math id="inf37"><mml:mi>ρ</mml:mi></mml:math></inline-formula> of collectives whose adult colour is furthest from <inline-formula><mml:math id="inf38"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, that will be eliminated in the following collective generation. Single orange lines indicate collectives whose growth dynamic — number of individual particles — is shown in C and D, respectively. Dotted lines show the deterministic approximation of the particle numbers during growth (Appendix 2 <xref ref-type="disp-formula" rid="equ8">Equation 1</xref>). Initial trait values result in exponential growth of particles (<bold>C</bold>), leading to a systematic bias in collective colour towards fast growing types (<bold>A</bold>). Derived trait values after selection yield a saturating growth toward an equilibrium (<bold>B</bold>) leading to the re-establishment of the purple colour by the end of the generation, despite initial departure (<bold>A</bold>). This is associated to the transition from a skewed distribution of collective colour, where almost all collectives are equally bad, to a narrow distribution centered on the target colour.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig3-v2.tif"/></fig><p>Key features of the evolutionary trajectory discussed so far are representative of replicate realisations of the stochastic individual-based nested model. In the section ‘Variability of the derived particle traits’ of Appendix 1 we show that in repeated simulations, the average adult collective colour always falls within a few percentage of the target colour. Moreover, collective-level selection applies more stringently to interaction parameters than to growth rates, with the latter showing a broader distribution of derived values. These conclusions also hold when the target colour <inline-formula><mml:math id="inf39"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> is different from 0.5, with broader variation from one realisation to the other and slower convergence to the target as colour ratios become more extreme (see Appendix 1, paragraph ‘Different target colours’).</p><p>Ability of offspring collectives to correct departures from the optimal colour during the course of growth is akin to a developmental, or canalising process: irrespective of the phenotype of the newborn (which will likely be different to that of the adult) the child — as it grows to adulthood — develops a phenotype that closely resembles that of the parent. Evidence of this apparent canalising process can be seen upon removal of collective-level selection (<xref ref-type="fig" rid="fig4">Figure 4</xref>). Collectives founded by particles with ancestral traits become composed of a single (red or blue) colour in less than 10 generations (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). In contrast, derived collectives are comprised of particles whose traits ensure that collectives continue to express phenotypes narrowly distributed around the optimal (purple) phenotype (as long as there is no mutation [<xref ref-type="fig" rid="fig4">Figure 4B</xref>]). Even when mutation is allowed to drive within- and between-collective dynamics, stability of phenoytpe holds for more than 200 generations (<xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref>).</p><fig id="fig4" position="float"><label>Figure 4.</label><caption><title>Dynamics of ancestral and derived collectives in the neutral regime.</title><p>Comparison of the dynamics of the colour distribution after removing selection (neutral regime). The population of 1000 collectives is initially composed of collectives with a colour distribution identical to that at generation 10,000 in <xref ref-type="fig" rid="fig2">Figure 2B</xref>. Particle traits are: (<bold>A</bold>) as in generation 1 of <xref ref-type="fig" rid="fig2">Figure 2</xref>; (<bold>B</bold>) derived after 10,000 generations of collective-level selection for purple. In both instances, particle mutation was turned off in order to focus on ecological dynamics, otherwise parameters are the same as in <xref ref-type="fig" rid="fig2">Figure 2A</xref>. <xref ref-type="fig" rid="app1fig6">Appendix 1—figure 6</xref> shows the outcome with particle mutation turned on. The first 10 collective generations are magnified in order to make apparent the initial rapid changes. The particle traits derived after evolution are such that the majority of collectives maintains a composition close to the optimum <inline-formula><mml:math id="inf40"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> even when the selective pressure is removed. This feature is instead rapidly lost in populations of collectives with the same initial colour, but with particle traits not tuned by evolution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig4-v2.tif"/></fig></sec><sec id="s2-3"><title>From particle ecology to collective phenotype</title><p>To understand the mechanistic basis of the canalising process, particle traits must be linked to the evolutionary emergence of collective-level inheritance, which we define as the capacity of collectives to re-establish the parental collective colour. <xref ref-type="fig" rid="fig5">Figure 5</xref> shows the relationship between the initial colour of collectives at the moment of birth (the moment immediately following dilution, <inline-formula><mml:math id="inf41"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> [the newborn colour]), and collective colour after a single particle growth cycle (the moment immediately preceding dilution, <inline-formula><mml:math id="inf42"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> [the adult colour]). <xref ref-type="fig" rid="fig5">Figure 5A</xref> shows this relationship at generation 3 while <xref ref-type="fig" rid="fig5">Figure 5B</xref> shows this relationship at generation 9000.</p><fig id="fig5" position="float"><label>Figure 5.</label><caption><title>Effect of collective-level selection on newborn-to-adult colour.</title><p>The adult colour of collectives as a function of their newborn colour is displayed for collectives of uniformly distributed initial colour. Stochastic simulations are realized by using particle traits representative of: (A) generation 3 and (B) generation 9000 (as in <xref ref-type="fig" rid="fig3">Figure 3</xref>). Dots indicate the mean adult colour from 50 simulations and its standard deviation. The orange line depicts the growth function <inline-formula><mml:math id="inf43"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> for the corresponding deterministic approximation (see main text and Appendix 2). The dashed line traces the discrete-time deterministic dynamics of the collective colour, starting from <inline-formula><mml:math id="inf44"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, and across cycles of growth and noise-less dilution. For ancestral particle traits (<bold>A</bold>), collective colour converges towards the red monochromatic fixed point. After selection for collective colour (<bold>B</bold>), the growth function is such that the optimum colour (<inline-formula><mml:math id="inf45"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>) is reliably produced within a single generation for virtually the whole range of possible founding colour ratios. The latter mechanism ensures efficient correction of alea occurring at birth and during development.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig5-v2.tif"/></fig><p>At generation 3, the proportion of red particles increases (within a collective generation), irrespective of the initial proportion. This is because red particles grow faster than blue and the primary determinant of particle success is growth rate (interactions are negligible in exponential growth). Thus, the only way that purple collectives can be maintained is if the collective phenotype is sufficiently noisy, to ensure that some collectives happen by chance to be purple, due to, for example, stochastic effects at dilution. Even if offspring collectives do not resemble their parents, purple colour is maintained via strong purifying selection that purges collectives that are either too red or too blue. The mechanism is stochastic correction (<xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>; <xref ref-type="bibr" rid="bib21">Grey et al., 1995</xref>; <xref ref-type="bibr" rid="bib27">Johnston and Jones, 2015</xref>).</p><p>This is in marked contrast to the situation at generation 9000. After a single growth cycle, the proportion of red particles increases when the initial proportion is below, and decreases when it is above, the optimal proportion 0.5. Thus, at generation 9000, irrespective of initial conditions, the adult colour of any given collective will be closer to <inline-formula><mml:math id="inf46"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> than it was on founding. Accordingly, extreme purifying selection is no longer required to maintain the parent-offspring relationship. Indeed, offspring collectives return to the parent phenotype even when the phenotype at birth departs significantly from the parent (adult) phenotype. ‘‘Correction’’ stems from the ecological dynamics of the particles and resembles a developmental process. Hereafter we refer to this correction process as the <italic>developmental corrector.</italic></p><p>The relationship between newborn and adult colour of collectives shown in <xref ref-type="fig" rid="fig5">Figure 5</xref> can be used to follow the fate of collectives over several cycles of growth and reproduction, provided the stochastic effects associated with the dilution phase are momentarily ignored. The iteration using particle trait values from generation 3 is shown by the dotted line in <xref ref-type="fig" rid="fig5">Figure 5A</xref> (the adult colour of a collective is the newborn colour for the next cycle, following a 'staircase' geometric procedure). Because red particles grow faster than blue, it takes just six collective generations for red particles to fix within collectives. Conversely, after particle trait evolution (<xref ref-type="fig" rid="fig5">Figure 5B</xref>), the same staircase approach applied to newborn collectives of any colour shows rapid convergence to the colour purple (0.5) irrespective of the starting point. The difference in the relationship between initial and final colour at generation 3 and 9000 is evidence of the emergence of a mechanism for developmental correction.</p><p>In order to systematically explore the possible newborn-to-adult colour map and to understand how it changes through the evolution of particle traits, we use a deterministic approximation (orange line in <xref ref-type="fig" rid="fig5">Figure 5</xref>). This approximation is denoted <inline-formula><mml:math id="inf47"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> or <italic>growth function</italic> (Appendix 2, Definition 2) and stems from an ordinary differential equation model often referred to as the competitive Lotka-Volterra system (Appendix 2, <xref ref-type="disp-formula" rid="equ8">Equation 1</xref>). This model is the limit for vanishing noise of the stochastic particle ecology, and provides a good approximation of the simulations (Dotted lines in <xref ref-type="fig" rid="fig3">Figure 3C–D</xref>). The growth function <inline-formula><mml:math id="inf48"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> captures the outcome of the ecological dynamics (i.e. the fraction of red particles) after founding populations are allowed to grow for a finite time interval <inline-formula><mml:math id="inf49"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. We note similarity between the <inline-formula><mml:math id="inf50"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function and the recently proposed ‘community-function landscape’ (<xref ref-type="bibr" rid="bib50">Xie and Shou, 2018</xref>). The shape of <inline-formula><mml:math id="inf51"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> depends on the value of particle traits <inline-formula><mml:math id="inf52"><mml:mi>θ</mml:mi></mml:math></inline-formula> (growth rates <inline-formula><mml:math id="inf53"><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf54"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, and competition parameters <inline-formula><mml:math id="inf55"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>0</mml:mtext><mml:mtext>intra</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf56"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>0</mml:mtext><mml:mtext>inter</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf57"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>1</mml:mtext><mml:mtext>inter</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf58"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mtext>1</mml:mtext><mml:mtext>intra</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>), but also on the bottleneck size at dilution <inline-formula><mml:math id="inf59"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and the collective generation duration <inline-formula><mml:math id="inf60"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. The fixed points of <inline-formula><mml:math id="inf61"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="inf62"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> such that <inline-formula><mml:math id="inf63"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></inline-formula>) are of particular interest: in the deterministic model, these represent colours that are left unchanged during a generation. Such a fixed point is stable if the colours of collectives starting in its neighbourhood all converge to it (<inline-formula><mml:math id="inf64"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig5">Figure 5A</xref>, <inline-formula><mml:math id="inf65"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig5">Figure 5B</xref>), and unstable otherwise (<inline-formula><mml:math id="inf66"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig5">Figure 5A</xref>, <inline-formula><mml:math id="inf67"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf68"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in <xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p><p>Under collective-level selection for colour, <inline-formula><mml:math id="inf69"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf70"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are constant and particle traits evolve so that <inline-formula><mml:math id="inf71"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> eventually has a stable fixed point, corresponding to the target colour <inline-formula><mml:math id="inf72"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. Progressive change in shape of the <inline-formula><mml:math id="inf73"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function across collective generations in a simulated lineage (<xref ref-type="fig" rid="fig2">Figure 2B</xref>) is illustrated in <xref ref-type="fig" rid="fig6">Figure 6</xref>. Note that these changes are continuous: small mutations in particle traits reflect as small changes in the shape of <inline-formula><mml:math id="inf74"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p><fig id="fig6" position="float"><label>Figure 6.</label><caption><title>Evolutionary variation of the growth function under collective selection.</title><p>function associated with the resident types for a single lineage of collectives from the simulation of <xref ref-type="fig" rid="fig2">Figure 2B</xref>, plotted every 20 collective generations from 0 to 9000. The result of iterations of <inline-formula><mml:math id="inf75"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> gradually changes from fixation of the fast growing particle (<xref ref-type="fig" rid="fig5">Figure 5A</xref>) to convergence toward the colour purple (<xref ref-type="fig" rid="fig5">Figure 5B</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig6-v2.tif"/></fig><p>The evolutionary trajectory of <xref ref-type="fig" rid="fig2">Figure 2B</xref> can now be understood in terms of the progressive evolution of particle traits (see Appendix 2 for a detailed description). At the beginning, particles compete mostly during exponential phase, so that adult colour is biased towards the fast-growing type. Initial improvement in transmission of colour from parent to offspring arises as exponential growth rates <inline-formula><mml:math id="inf76"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula> of the particles align. Correspondingly, the <inline-formula><mml:math id="inf77"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function approaches linearity. A successive increase in maximal growth rate separates particle and collective time scales, allowing particles to experience density-dependent interactions. Eventually, such interactions evolve towards a regime where the <inline-formula><mml:math id="inf78"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function is nonlinear and fluctuations are readily compensated, thus developmental correction ensures a reliable colour inheritance.</p><p>The <inline-formula><mml:math id="inf79"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function, which allows characterisation of particle ecology, can now be used as a guide to optimise the ‘life cycle’ of growth and dilution that acts as a scaffold for the evolutionary process. In a typical experiment of community-level evolution, collective generation duration <inline-formula><mml:math id="inf80"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and bottleneck size <inline-formula><mml:math id="inf81"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are fixed. Some choices of these collective-level parameters are however likely to lead to collective phenotypes that are so far from the optimum that collective lineages go extinct. For instance, if in the first-generation competitive exclusion occurs rapidly, then distinguishing collectives based on collective colour may be impossible. Intuition suggests that the closer the fixed point of the <inline-formula><mml:math id="inf82"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function is to the target colour, the more efficient collective-level selection will be, and the faster the evolutionary dynamic. It is thus possible to use the distance between the fixed point of <inline-formula><mml:math id="inf83"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and the target composition <inline-formula><mml:math id="inf84"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> as a proxy for the probability that collective lineages will go extinct before attaining the desired colour. Below, we examine how the position of the fixed point of <inline-formula><mml:math id="inf85"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> changes as a function of collective generation duration <inline-formula><mml:math id="inf86"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and bottleneck size <inline-formula><mml:math id="inf87"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></sec><sec id="s2-4"><title>Effect of collective generation duration and bottleneck size</title><p>The growth function <inline-formula><mml:math id="inf88"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> is readily computed from the particle traits and collective parameters even though it has in general no analytic expression (but see Appendix 2 for limit cases of exponential and saturating particle growth). There are four possible qualitative shapes of <inline-formula><mml:math id="inf89"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, that differ in the position and stability of the fixed points (illustrated in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3-1 to 3-4</xref>).</p><p>The qualitative dependence of <inline-formula><mml:math id="inf90"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and its fixed points on collective-level parameters varies with the underpinning particle ecology, making it easier for some communities to be starting points for the successful evolution of inheritance. Particle traits can be classified in four broad classes, based of the nature of the corresponding ecological equilibrium. For each of these classes, and when red particles grow faster than blue <inline-formula><mml:math id="inf91"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, the fixed points of <inline-formula><mml:math id="inf92"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are illustrated in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3-A to 3-D</xref> as a function of the collective-level parameters <inline-formula><mml:math id="inf93"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf94"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. <xref ref-type="fig" rid="fig7">Figure 7</xref> refers to the situation where inter-colour interaction traits are smaller than intra-colour interaction traits. Here, particle populations converge in the long term to a coexistence equilibrium, where collective colour is <inline-formula><mml:math id="inf95"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> (in general, different from the optimum). This equilibrium can be approached within a single collective generation if <inline-formula><mml:math id="inf96"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf97"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are large (top right corner). On the other hand, when <inline-formula><mml:math id="inf98"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf99"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> are small (red region), the only stable fixed point invovles collectives composed solely of fast-growing particles. This corresponds to cases where individual and collective time scales (quantified by <inline-formula><mml:math id="inf100"><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="inf101"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>, respectively) are insufficiently separated, or newborn size is too small, so that particle demography is essentially exponential and interactions cannot provide sufficient correction. For rapid evolution of collective colour, the most favourable starting position is one where the fixed point is closest to the optimal colour (for <inline-formula><mml:math id="inf102"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> this occurs for intermediate collective generation duration and bottleneck size for the trait values in <xref ref-type="fig" rid="fig7">Figure 7</xref>). Knowledge of the exact values requires, however, some preliminary measure of the ecological dynamics. Even in the absence of such information, the diagram in <xref ref-type="fig" rid="fig7">Figure 7</xref> can be used to optimise experimental design by revealing intrinsic trade-offs. A decrease in generation time, necessary for practical reasons, may for instance, be compensated by an increase in bottleneck size, without affecting the average collective phenotype.</p><fig id="fig7" position="float"><label>Figure 7.</label><caption><title>Stable fixed point of <inline-formula><mml:math id="inf103"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> as a function of collective-level parameters.</title><p>Classification of the qualitative shape of the growth function and dependence on collective parameters <italic>B</italic> (bottleneck size) and <italic>T</italic> (growth phase duration). Considered here are particle traits that allow coexistence (<inline-formula><mml:math id="inf104"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf105"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf106"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, see <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref> for the other possible parameter regions). The black line represents the limit of the region of stability of the fixed point of <italic>G</italic>, separating the two qualitatively different scenarios illustrated in the inset (see Appendix 2, Proposition 4 for its analytic derivation): for short collective generations and small bottleneck size, the faster growing red type competitively excludes the blue type over multiple collective generations. In order for particle types to coexist over the long term, growth rate and the initial number of particles must both be large enough for density-dependent effects to manifest at the time that selection is applied.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig7-v2.tif"/></fig><p>Even when collective-level parameters are optimised so that the attractor of the <inline-formula><mml:math id="inf107"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function is initially close to the target colour, collective-level selection will keep acting on the particle traits, and affect phenotypic variability within the population of collectives. As stability of the fixed point increases, so to does fidelity of phenotype transmission from parent to offspring collectives. Once collective-level processes are set as to minimise the probability of collective extinction, the main obstacles to evolving higher inheritance come from constrains acting on particle traits, which may limit the range of attainable <inline-formula><mml:math id="inf108"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> functions. Trade-offs on particle ecology may prevent the <inline-formula><mml:math id="inf109"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function to attain an internal fixed point. We discuss two examples on constrained evolution in the following paragraph.</p></sec><sec id="s2-5"><title>Constrained trajectories</title><p>Thus far, we have considered evolution within a four-dimensional parameter space defined by maximum growth rates and inter-colour competition parameters. In real systems, however, constrains and trade-offs may limit the range of achievable variations in particle traits. For instance, even though faster growing particles will always experience positive selection, cell replication rate cannot increase boundlessly. Here, we consider two instances of constrained evolution, where only a subset of particle traits are allowed to mutate.</p><p>First, we consider the case where competition parameters are vanishingly small, so that <inline-formula><mml:math id="inf110"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> has no internal fixed point. Under such conditions, particle growth rates evolve to be identical (<xref ref-type="fig" rid="fig8">Figure 8A</xref>). In the absence of interactions, this is the only available solution to maintain collectives with an equal number of red and blue type particles. Under these circumstances, <inline-formula><mml:math id="inf111"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> converges to the identity function. In the deterministic approximation, collective composition remains constant in time, but stochastic fluctuations that cause colour to deviate from the optimum are amplified across collective generations. These deviations are nonetheless corrected in the collective population by propagating only those collectives whose colour is closest to the optimum. Such stochastic correction (<xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>), however, has a high risk of failure if selection is strong and collective population size is small.</p><fig id="fig8" position="float"><label>Figure 8.</label><caption><title>Constrained evolutionary trajectories.</title><p>Dynamics through time of resident particle traits (black dots, whose size measures their abundance in the collective population) along simulated evolutionary trajectories of 300 generations, when particle-level traits are constrained. For both panels <inline-formula><mml:math id="inf112"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf113"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo lspace="0pt" rspace="3.5pt">%</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf114"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="inf115"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The trajectory of the average resident traits is shown in white. The heatmap represents the value of <inline-formula><mml:math id="inf116"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> as a function of the evolvable traits, and the white dotted line indicates where collective colour is optimum. (<bold>A</bold>) Particle growth rates evolve and particles do not compete (<inline-formula><mml:math id="inf117"><mml:mrow><mml:msup><mml:mi>a</mml:mi><mml:mtext>inter</mml:mtext></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). The evolutionary dynamics leads to alignment of growth rates (<inline-formula><mml:math id="inf118"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). (<bold>B</bold>) Inter-colour competition traits evolve and particle growth rates are constant (<inline-formula><mml:math id="inf119"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>25</mml:mn></mml:mrow></mml:math></inline-formula>). The evolutionary dynamics first converge toward the optimality line. In a second step, asymmetric competition evolves: <inline-formula><mml:math id="inf120"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf121"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo>→</mml:mo><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. This results in a flatter <inline-formula><mml:math id="inf122"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function around the fixed point, providing a faster convergence to optimum colour across collective generations (<xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>). Similar results are obtained for non-identical, but sufficiently high, growth rates.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-fig8-v2.tif"/></fig><p>Second, we consider the case when mutations only affect the two inter-type competition parameters, while growth rates are held constant (to sufficiently high values, so that particles experience density-dependent effects in the growth phase). The evolutionary trajectory can be visualised in the plane of competition parameters <inline-formula><mml:math id="inf123"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="fig8">Figure 8B</xref> shows the result of a stochastic simulation superimposed to the value of <inline-formula><mml:math id="inf124"><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Independent of the initial values of the interaction parameters, evolution draws the system to the manifold associated with the optimal proportion <inline-formula><mml:math id="inf125"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> (white dashed line). Evolution within this manifold is neutral in the deterministic approximation, but the presence of stochastic fluctuations drives further improvement of the fitness landscape. Correction is indeed more efficient and the distribution of collective phenotypic diversity narrower when the gradient of <inline-formula><mml:math id="inf126"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> in the fixed point is smaller. The condition on particle traits for the latter to vanish only depends on the carrying capacities of the two particle types, and corresponds to the type with smallest carrying capacity having zero interaction rate (see Appendix 2). A similar outcome is observed when, along an evolutionary trajectory, growth rates no longer influence adult colour (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Developmental correction thus selects for maximal asymmetry in interactions, whereby one particle type drives the ecological dynamics of the other type, but is itself only affected by its own type (this is fully elaborated in Appendix 2).</p></sec></sec><sec id="s3" sec-type="discussion"><title>Discussion</title><p>In nature, communities rarely ever qualify as units of selection in the traditional sense (<xref ref-type="bibr" rid="bib29">Lewontin, 1970</xref>; <xref ref-type="bibr" rid="bib18">Godfrey-Smith, 2009</xref>), because communities in nature rarely manifest heritable variance in fitness. In the laboratory, however, experimenters can exogenously impose (scaffold) Darwinian-like properties on communities such that they have no choice, but to become units of selection (<xref ref-type="bibr" rid="bib48">Wilson and Sober, 1989</xref>; <xref ref-type="bibr" rid="bib49">Xie et al., 2019</xref>; <xref ref-type="bibr" rid="bib4">Black et al., 2020</xref>). This typically involves placement of communities in some kind of container (pot, test-tube, flask, droplet, etc.) so they are bounded and variation at the community level is thus discrete. Communities are then allowed time for individual members to replicate and interact. At the end of the 'growth' period, community function is assessed based on pre-determined criteria. The experimenter then effects replication of successful communities while discarding those that under-perform. Replication typically involves transferring a sample of individuals from a successful community to a new container replete with a fresh supply of nutrients.</p><p>Experimental and theoretical studies indicate that artificial selection on microbial communities results in rapid functional improvement (<xref ref-type="bibr" rid="bib40">Swenson et al., 2000a</xref>; <xref ref-type="bibr" rid="bib41">Swenson et al., 2000b</xref>; <xref ref-type="bibr" rid="bib19">Goodnight, 2000</xref>; <xref ref-type="bibr" rid="bib44">Wade, 2016</xref>; <xref ref-type="bibr" rid="bib49">Xie et al., 2019</xref>). This is not unexpected given that experimental manipulations ensure that communities engage directly in the process of evolution by (artificial) selection as units in their own right. However, for such effects to manifest there must exist a mechanism of community-level inheritance.</p><p>Consideration of both the effectiveness of artificial selection and the problem of heredity has led to recognition that the answer likely lies in interactions (<xref ref-type="bibr" rid="bib48">Wilson and Sober, 1989</xref>; <xref ref-type="bibr" rid="bib40">Swenson et al., 2000a</xref>; <xref ref-type="bibr" rid="bib41">Swenson et al., 2000b</xref>; <xref ref-type="bibr" rid="bib19">Goodnight, 2000</xref>; <xref ref-type="bibr" rid="bib36">Rainey et al., 2017</xref>). The intuition stems from the fact that in the absence of interactions, communities selected to reproduce because of their beneficial phenotype will likely fail to produce offspring communities with similar functionality. If so, then these communities will be eliminated at the next round. Consider, however, an optimal community in which interactions emerge among individuals that increase the chance that offspring communities resemble the parental type. Such an offspring community will then likely avoid extinction at the next round: selection at the level of communities is thus expected to favour the evolution of interactions because inheritance of phenotype is now the primary determinant of the success (at the community level). Indeed, simulations of multi-species assemblages have shown that evolution of interaction rates not only improves diversity-dependent fitness, but also increases collective ‘heritability’, defined as the capacity of randomly seeded offspring communities to reach the same dynamical state as their parents (<xref ref-type="bibr" rid="bib24">Ikegami and Hashimoto, 2002</xref>; <xref ref-type="bibr" rid="bib33">Penn, 2003</xref>). Further studies have stressed the role of the extracellular environment and of specific interaction networks, pointing out that microscopic constrains can affect the capacity of communities to participate in evolutionary dynamics at the higher level (<xref ref-type="bibr" rid="bib45">Williams and Lenton, 2007</xref>; <xref ref-type="bibr" rid="bib50">Xie and Shou, 2018</xref>; <xref ref-type="bibr" rid="bib49">Xie et al., 2019</xref>).</p><p>Here, inspired by advances in millifluidics, we have developed a minimal mechanistic model containing essential ingredients of multi-scale evolution and within-community competition. We considered collectives composed of two types of particles (red and blue) that interact by density-dependent competition. By explicitly modelling demographic processes at two levels of organisation, we have obtained mechanistic understanding of how selection on collective character affects evolution of composing particle traits. Between-collective selection fuels changes in particle-level traits that feedback to affect collective phenotype. Selection at the level of communities thus drives the evolution of interactions among particles to the point where derived communities, despite stochastic effects associated with sampling at the moment of birth, give rise to offspring communities that reliably recapitulate the parental community phenotype. Such is the basis of community-level inheritance. Significantly, it has arisen from the simplest of ingredients and marks an important initial step in the endogenisation of Darwinian properties: properties externally imposed stand to become endogenous features of the evolving system (<xref ref-type="bibr" rid="bib4">Black et al., 2020</xref>).</p><p>The mechanism by which particles interact to establish community phenotype is reminiscent of a development process. We have refered to this as the ‘developmental corrector’. In essence, it is akin to canalisation, a central feature of development in complex living systems (<xref ref-type="bibr" rid="bib8">Buss, 1987</xref>), and the basis of inheritance (<xref ref-type="bibr" rid="bib22">Griesemer, 2002</xref>). Developmental correction solves the problem of implementing specific protocols for mitigating non-heritable variations in community function (<xref ref-type="bibr" rid="bib49">Xie et al., 2019</xref>).</p><p>Developmental correction can be viewed as an evolutionary refinement of the stochastic corrector mechanism (<xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>; <xref ref-type="bibr" rid="bib21">Grey et al., 1995</xref>; <xref ref-type="bibr" rid="bib27">Johnston and Jones, 2015</xref>). Both stochastic and developmental correctors solve the problem of producing enough well-formed collectives at each successive generation to prevent community-level extinction. The stochastic corrector mechanism relies on a low-fidelity reproduction process coupled to high population sizes. Deviations from successful collective states are corrected by purging collectives that depart significantly from the optimal collective phenotype. However, in the absence of strong collective-level selection the optimal community phenotype is rapidly lost. In contrast, the developmental corrector mechanism ensures that the optimal community phenotype is maintained without need for hard selection. Regardless of perturbations introduced by demography or low initial particle number, most collectives reliably reach a successful adult state. In our simulations, we show that community phenotype is maintained even in the absence of community-level selection, although ultimately mutational processes affecting particle dynamics result in eventual loss of the developmental corrector mechanism.</p><p>An operationally relevant question concerns the conditions (the initial state of the population, the nature of the scaffold and of particle-level interactions) for selection on a collective character to result in evolution of developmental correction. While we did not detail the probability of collective lineage extinction, it is possible that collectives become monochromatic before evolution has had time to act on particle traits. In such cases, which are more likely if particle-level traits are far from the region of coexistence, and if time-scales of particle and collective generations are not well separated, then collective-level evolution will grind to a halt. In all other cases, provided there are no other evolutionary constraints, selection will eventually lead the system toward regions of particle trait-space where the collective phenotype becomes reliably re-established. The efficiency of this selective process and its transient behaviour depend on collective-level parameters that control growth and reproduction.</p><p>From our individual-based simulations and ensuing deterministic approximation, it is clear that once density-dependent interactions govern the adult state, then collective-level selection for colour is promptly effected. This happens provided the intra-collective ecology lasts long enough for nonlinear effects to curb particle growth. When this is not the case, for example when the bottleneck at birth is small, or collective-level generation time is too short, evolution of developmental correction will be impeded. The latter favours rapidly growing particles (<xref ref-type="bibr" rid="bib1">Abreu et al., 2019</xref>) and offers little possibility for the evolution of developmental correction. When the ecological attractor within collectives leads to the extinction of one of the two types, long collective-level generation times are incompatible with the maintenance of diversity (<xref ref-type="bibr" rid="bib43">van Vliet and Doebeli, 2019</xref>). However, in our model, particle-level evolution changes the nature of the attractor from extinction of one of two types to stable coexistence, and concomitantly particle and collective time-scales become separated. Even before developmental correction becomes established, evolution can transiently rely on stochastic correction to ensure the maintenance of particle co-existence.</p><p>There are two aspects to heredity: resemblance — the extent to which reproduction and development maintain the average offspring phenotype — and fidelity (or determination) — a measure of phenotypic variance (<xref ref-type="bibr" rid="bib25">Jacquard, 1983</xref>; <xref ref-type="bibr" rid="bib6">Bourrat, 2017</xref>). In our model, resemblance is established once density-dependent interactions counter the bias toward fast replicating particles: when the <inline-formula><mml:math id="inf127"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function has an internal fixed point in <inline-formula><mml:math id="inf128"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, systematic drift of average collective colour is prevented. The increase in resemblance is associated with progressive divergence of particle and collective demographic time scales. As a consequence, the collective phenotype is placed under the control of particle traits rather than demographic stochasticity. On a longer time scale, fidelity improves by subsequent changes in interaction parameters under the constraint that they do not affect average adult colour. The variance of the phenotype around the optimum is reduced by increasing canalisation (flattening of the <inline-formula><mml:math id="inf129"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> function). This is best achieved by a strong asymmetry in the competition traits, whereby one type has a logistic, uncoupled, dynamic, and the second type adjusts its growth to the former’s density. Interestingly, it is always the type with the lower carrying capacity, regardless of its relative growth rate, that acts as the driver.</p><p>The relationship between parameters on very long time scales, when the adult colour is essentially dependent on interaction rates, depends critically on the space of possible values particle traits can assume. For instance, our analysis took into account only competitive intractions between colours. Extension of the deterministic approximation to cases when ecological interactions between colours are exploitative or mutualistic indicates that selection for collective coulour can drive changes in the very nature of the interactions so as to make them progress towards less and less reciprocally harmful coexistence (for full elaboration see Appendix 3).</p><p>Our goal has been to produce a simple, tractable scenario for studying the effects of artificial selection on collectives, which while theoretical, is firmly connected to plausible biological experiments. The model could be extended in multiple ways in order to analyse the effects of additional factors, including impact of non-overlapping generations and variation in the timing of reproduction (which would introduce an element of bet-hedging), of migration and mixing between collectives (which could be akin to gamete production and zygote formation), and inclusion of more than two kinds of particle types. More complex selective regimes can also be envisaged, such as those that reward collectives based on absolute population size of particle types, which would allow less abstract collective functions to be considered. However, regardless of these refinements, we suspect that our core conclusion will stand firm: collective-level selection favours particle dynamics that improve collective-level heredity. The ability to reliably re-establish successful adult states of past-generations from simpler and potentially noisy initial conditions is adaptive at the collective level.</p><p>The mechanism of developmental correction is broadly relevant and extends beyond cells and communities to particles of any kind that happen to be nested within higher-level self-replicating structures. As such, the mechanism of developmental correction may be relevant to the early stages in each of the major (egalitarian) evolutionary transitions in individuality (<xref ref-type="bibr" rid="bib35">Queller, 1997</xref>; <xref ref-type="bibr" rid="bib32">Maynard Smith and Szathmary, 1995</xref>), where maintenance of particle types in optimal proportions was likely an essential requirement. For example, it is hard to see how protocells cells evolved from lower level components (<xref ref-type="bibr" rid="bib42">Takeuchi and Hogeweg, 2009</xref>; <xref ref-type="bibr" rid="bib3">Baum and Vetsigian, 2017</xref>), chromosomes from genes (<xref ref-type="bibr" rid="bib38">Smith and Szathmáry, 1993</xref>), and the eukaryotic cell from independent bacterial entities (<xref ref-type="bibr" rid="bib31">Martin and Müller, 1998</xref>) without some kind of self-correcting mechanism acting at the collective level.</p><p>Beyond these fundamental considerations, the mechanism of developmental correction and the ecological factors underpinning its evolution have important implications for top-down engineering of microbial communities for discovery of new chemistries, new functions, and even new organisms. The minimal recipe involves partitioning communities into discrete packages, provision of a period of time for cell growth, selective criteria that lead to purging of sub-optimal collectives and reproduction of optimal collectives to establish the next generation of collectives. These manipulations are readily achieved using millifluidic devices that can be engineered to operate in a Turing-like manner allowing artificial selection on community-level traits across thousands of independent communities. As mentioned above, critical tuneable parameters beyond number of communities, mode of selection and population size, are duration of collective generation time and bottleneck size at the moment of birth.</p><p>The extent to which the conclusions based on our simple abstract model are generally applicable to the evolution of more complex associations, such as symbioses leading to new forms of life, will require future exploration of a broader range of particle-level ecologies. Possibilities to make community dynamics more realistic by complexifying mathematical descriptions of particle-level processes are plentiful (<xref ref-type="bibr" rid="bib45">Williams and Lenton, 2007</xref>; <xref ref-type="bibr" rid="bib51">Zomorrodi and Segrè, 2016</xref>). Of particular interest for the evolution of efficient developmental correction are cases when community ecology has multiple attractors (<xref ref-type="bibr" rid="bib34">Penn and Harvey, 2004</xref>), is highly sensitive to initial conditions (<xref ref-type="bibr" rid="bib41">Swenson et al., 2000b</xref>), or presents finite-effect mutations sustaining ‘eco-evolutionary tunnelling’ (<xref ref-type="bibr" rid="bib28">Kotil and Vetsigian, 2018</xref>). Besides enlarging the spectrum of possible within-collective interactions, future relevant extensions might explore the role of physical coupling among particles and of horizontal transmission between collectives (<xref ref-type="bibr" rid="bib43">van Vliet and Doebeli, 2019</xref>) in enhancing or hampering efficient inheritance of collective-level characters.</p></sec><sec id="s4" sec-type="methods"><title>Methods</title><p>Methods are described in Appendix 1, 2 and 3, interspersed with more technical descriptions of the results presented in the main text.</p></sec></body><back><ack id="ack"><title>Acknowledgements</title><p>We thank Wenying Shou, Sara Mitri and Alvaro Sanchez for review of the manuscript and valuable comments. We also thank Benjamin Kerr, Will Ratcliff, Eric Libby, Michael Doebeli, Pierrick Bourrat and Philippe Nghe as well as the members of our respective teams for their feedback. GD was funded by the <italic>Origines et Conditions d’Apparition de la Vie (OCAV)</italic> programme, PSL University (ANR-10-IDEX-001–02), awarded to PBR, SDM and AL; SDM was supported by the French Government under the program Investissements d’Avenir (ANR-10-LABX-54 MEMOLIFE and ANR-11-IDEX-0001-02PSL), AL thanks the Center for Interdisciplinary Research in Biology (CIRB) for funding.</p></ack><sec id="s5" sec-type="additional-information"><title>Additional information</title><fn-group content-type="competing-interest"><title>Competing interests</title><fn fn-type="COI-statement" id="conf2"><p>Reviewing editor, <italic>eLife</italic> and founding member of MilliDrop</p></fn><fn fn-type="COI-statement" id="conf1"><p>No competing interests declared</p></fn></fn-group><fn-group content-type="author-contribution"><title>Author contributions</title><fn fn-type="con" id="con1"><p>Software, Formal analysis, Visualization, Methodology</p></fn><fn fn-type="con" id="con2"><p>Formal analysis, Supervision, Methodology</p></fn><fn fn-type="con" id="con3"><p>Resources, Formal analysis, Supervision, Methodology</p></fn><fn fn-type="con" id="con4"><p>Conceptualization, Resources, Supervision, Funding acquisition</p></fn></fn-group></sec><sec id="s6" sec-type="supplementary-material"><title>Additional files</title><supplementary-material id="scode1"><label>Source code 1.</label><caption><title>Source code for simulation and figure generation.</title><p>Also available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ecoevomath/estaudel">https://gitlab.com/ecoevomath/estaudel</ext-link>.</p></caption><media mime-subtype="zip" mimetype="application" xlink:href="elife-53433-code1-v2.zip"/></supplementary-material><supplementary-material id="transrepform"><label>Transparent reporting form</label><media mime-subtype="pdf" mimetype="application" xlink:href="elife-53433-transrepform-v2.pdf"/></supplementary-material></sec><sec id="s7" sec-type="data-availability"><title>Data availability</title><p>The source code for all simulations and figures in the manuscript is available as a zip file uploaded with the manuscript and in a public git repository (<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ecoevomath/estaudel">https://gitlab.com/ecoevomath/estaudel</ext-link>; copy archived at <ext-link ext-link-type="uri" xlink:href="https://github.com/elifesciences-publications/estaudel">https://github.com/elifesciences-publications/estaudel</ext-link>).</p></sec><ref-list><title>References</title><ref id="bib1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abreu</surname> <given-names>CI</given-names></name><name><surname>Friedman</surname> <given-names>J</given-names></name><name><surname>Andersen Woltz</surname> <given-names>VL</given-names></name><name><surname>Gore</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Mortality causes universal changes in microbial community composition</article-title><source>Nature Communications</source><volume>10</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1038/s41467-019-09925-0</pub-id><pub-id pub-id-type="pmid">31073166</pub-id></element-citation></ref><ref id="bib2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baraban</surname> <given-names>L</given-names></name><name><surname>Bertholle</surname> <given-names>F</given-names></name><name><surname>Salverda</surname> <given-names>ML</given-names></name><name><surname>Bremond</surname> <given-names>N</given-names></name><name><surname>Panizza</surname> <given-names>P</given-names></name><name><surname>Baudry</surname> <given-names>J</given-names></name><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Bibette</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Millifluidic droplet analyser for microbiology</article-title><source>Lab on a Chip</source><volume>11</volume><fpage>4057</fpage><lpage>4062</lpage><pub-id pub-id-type="doi">10.1039/c1lc20545e</pub-id><pub-id pub-id-type="pmid">22012599</pub-id></element-citation></ref><ref id="bib3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baum</surname> <given-names>DA</given-names></name><name><surname>Vetsigian</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>An experimental framework for generating evolvable chemical systems in the laboratory</article-title><source>Origins of Life and Evolution of Biospheres</source><volume>47</volume><fpage>481</fpage><lpage>497</lpage><pub-id pub-id-type="doi">10.1007/s11084-016-9526-x</pub-id><pub-id pub-id-type="pmid">27864699</pub-id></element-citation></ref><ref id="bib4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Black</surname> <given-names>AJ</given-names></name><name><surname>Bourrat</surname> <given-names>P</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2020">2020</year><article-title>Ecological scaffolding and the evolution of individuality</article-title><source>Nature Ecology &amp; Evolution</source><volume>4</volume><fpage>426</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1038/s41559-019-1086-9</pub-id><pub-id pub-id-type="pmid">32042121</pub-id></element-citation></ref><ref id="bib5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonner</surname> <given-names>JT</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Evolutionary strategies and developmental constraints in the cellular slime molds</article-title><source>The American Naturalist</source><volume>119</volume><fpage>530</fpage><lpage>552</lpage><pub-id pub-id-type="doi">10.1086/283930</pub-id></element-citation></ref><ref id="bib6"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Bourrat</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Evolutionary transitions in heritability and individuality</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/192443</pub-id></element-citation></ref><ref id="bib7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Buss</surname> <given-names>LW</given-names></name></person-group><year iso-8601-date="1982">1982</year><article-title>Somatic cell parasitism and the evolution of somatic tissue compatibility</article-title><source>PNAS</source><volume>79</volume><fpage>5337</fpage><lpage>5341</lpage><pub-id pub-id-type="doi">10.1073/pnas.79.17.5337</pub-id><pub-id pub-id-type="pmid">6957867</pub-id></element-citation></ref><ref id="bib8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Buss</surname> <given-names>LW</given-names></name></person-group><year iso-8601-date="1987">1987</year><source>The Evolution of Individuality</source><publisher-loc>Princeton</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation></ref><ref id="bib9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Champagnat</surname> <given-names>N</given-names></name><name><surname>Ferrière</surname> <given-names>R</given-names></name><name><surname>Méléard</surname> <given-names>S</given-names></name></person-group><year iso-8601-date="2006">2006</year><article-title>Unifying evolutionary dynamics: from individual stochastic processes to macroscopic models</article-title><source>Theoretical Population Biology</source><volume>69</volume><fpage>297</fpage><lpage>321</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2005.10.004</pub-id><pub-id pub-id-type="pmid">16460772</pub-id></element-citation></ref><ref id="bib10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cottinet</surname> <given-names>D</given-names></name><name><surname>Condamine</surname> <given-names>F</given-names></name><name><surname>Bremond</surname> <given-names>N</given-names></name><name><surname>Griffiths</surname> <given-names>AD</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name><name><surname>de Visser</surname> <given-names>JA</given-names></name><name><surname>Baudry</surname> <given-names>J</given-names></name><name><surname>Bibette</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Lineage tracking for probing heritable phenotypes at Single-Cell resolution</article-title><source>PLOS ONE</source><volume>11</volume><elocation-id>e0152395</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pone.0152395</pub-id><pub-id pub-id-type="pmid">27077662</pub-id></element-citation></ref><ref id="bib11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Day</surname> <given-names>MD</given-names></name><name><surname>Beck</surname> <given-names>D</given-names></name><name><surname>Foster</surname> <given-names>JA</given-names></name></person-group><year iso-8601-date="2011">2011</year><article-title>Microbial communities as experimental units</article-title><source>BioScience</source><volume>61</volume><fpage>398</fpage><lpage>406</lpage><pub-id pub-id-type="doi">10.1525/bio.2011.61.5.9</pub-id><pub-id pub-id-type="pmid">21731083</pub-id></element-citation></ref><ref id="bib12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Monte</surname> <given-names>S</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Nascent multicellular life and the emergence of individuality</article-title><source>Journal of Biosciences</source><volume>39</volume><fpage>237</fpage><lpage>300</lpage><pub-id pub-id-type="doi">10.1007/s12038-014-9420-5</pub-id><pub-id pub-id-type="pmid">24736157</pub-id></element-citation></ref><ref id="bib13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doebeli</surname> <given-names>M</given-names></name><name><surname>Ispolatov</surname> <given-names>Y</given-names></name><name><surname>Simon</surname> <given-names>B</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Towards a mechanistic foundation of evolutionary theory</article-title><source>eLife</source><volume>6</volume><elocation-id>e23804</elocation-id><pub-id pub-id-type="doi">10.7554/eLife.23804</pub-id><pub-id pub-id-type="pmid">28198700</pub-id></element-citation></ref><ref id="bib14"><element-citation publication-type="software"><person-group person-group-type="author"><name><surname>Doulcier</surname> <given-names>G</given-names></name></person-group><year iso-8601-date="2020">2020</year><data-title>estaudel</data-title><source>GitLab</source><version designator="b3cd2904">b3cd2904</version><ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ecoevomath/estaudel">https://gitlab.com/ecoevomath/estaudel</ext-link></element-citation></ref><ref id="bib15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geritz</surname> <given-names>SAH</given-names></name><name><surname>Kisdi</surname> <given-names>É.</given-names></name><name><surname>Meszéna</surname> <given-names>G</given-names></name><name><surname>Metz</surname> <given-names>JAJ</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>Evolutionarily singular strategies and the adaptive growth and branching of the evolutionary tree</article-title><source>Evolutionary Ecology</source><volume>12</volume><fpage>35</fpage><lpage>57</lpage><pub-id pub-id-type="doi">10.1023/A:1006554906681</pub-id></element-citation></ref><ref id="bib16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname> <given-names>DT</given-names></name></person-group><year iso-8601-date="1976">1976</year><article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title><source>Journal of Computational Physics</source><volume>22</volume><fpage>403</fpage><lpage>434</lpage><pub-id pub-id-type="doi">10.1016/0021-9991(76)90041-3</pub-id></element-citation></ref><ref id="bib17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname> <given-names>DT</given-names></name></person-group><year iso-8601-date="2001">2001</year><article-title>Approximate accelerated stochastic simulation of chemically reacting systems</article-title><source>The Journal of Chemical Physics</source><volume>115</volume><fpage>1716</fpage><lpage>1733</lpage><pub-id pub-id-type="doi">10.1063/1.1378322</pub-id></element-citation></ref><ref id="bib18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Godfrey-Smith</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><source>Darwinian Populations and Natural Selection</source><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford university Press</publisher-name><pub-id pub-id-type="doi">10.1086/656856</pub-id></element-citation></ref><ref id="bib19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodnight</surname> <given-names>CJ</given-names></name></person-group><year iso-8601-date="2000">2000</year><article-title>Heritability at the ecosystem level</article-title><source>PNAS</source><volume>97</volume><fpage>9365</fpage><lpage>9366</lpage><pub-id pub-id-type="doi">10.1073/pnas.97.17.9365</pub-id><pub-id pub-id-type="pmid">10944208</pub-id></element-citation></ref><ref id="bib20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goodnight</surname> <given-names>CJ</given-names></name><name><surname>Stevens</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1997">1997</year><article-title>Experimental studies of group selection: what do they tell Us about group selection in nature?</article-title><source>The American Naturalist</source><volume>150 Suppl 1</volume><fpage>S59</fpage><lpage>S79</lpage><pub-id pub-id-type="doi">10.1086/286050</pub-id><pub-id pub-id-type="pmid">18811313</pub-id></element-citation></ref><ref id="bib21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grey</surname> <given-names>D</given-names></name><name><surname>Hutson</surname> <given-names>V</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1995">1995</year><article-title>A re-examination of the stochastic corrector model</article-title><source>Proceedings of the Royal Society B: Biological Sciences</source><volume>262</volume><fpage>29</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1098/rspb.1995.0172</pub-id></element-citation></ref><ref id="bib22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griesemer</surname> <given-names>J</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>What is &quot;epi&quot; about epigenetics?</article-title><source>Annals of the New York Academy of Sciences</source><volume>981</volume><fpage>97</fpage><lpage>110</lpage><pub-id pub-id-type="doi">10.1111/j.1749-6632.2002.tb04914.x</pub-id><pub-id pub-id-type="pmid">12547676</pub-id></element-citation></ref><ref id="bib23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hammerschmidt</surname> <given-names>K</given-names></name><name><surname>Rose</surname> <given-names>CJ</given-names></name><name><surname>Kerr</surname> <given-names>B</given-names></name><name><surname>Rainey</surname> <given-names>PB</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>Life cycles, fitness decoupling and the evolution of multicellularity</article-title><source>Nature</source><volume>515</volume><fpage>75</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1038/nature13884</pub-id><pub-id pub-id-type="pmid">25373677</pub-id></element-citation></ref><ref id="bib24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ikegami</surname> <given-names>T</given-names></name><name><surname>Hashimoto</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Dynamical systems approach to Higher-level heritability</article-title><source>Journal of Biological Physics</source><volume>28</volume><fpage>799</fpage><lpage>804</lpage><pub-id pub-id-type="doi">10.1023/A:1021215511897</pub-id><pub-id pub-id-type="pmid">23345815</pub-id></element-citation></ref><ref id="bib25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jacquard</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="1983">1983</year><article-title>Heritability: one word, three concepts</article-title><source>Biometrics</source><volume>39</volume><fpage>465</fpage><lpage>477</lpage><pub-id pub-id-type="doi">10.2307/2531017</pub-id><pub-id pub-id-type="pmid">6626665</pub-id></element-citation></ref><ref id="bib26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname> <given-names>CR</given-names></name><name><surname>Boerlijst</surname> <given-names>MC</given-names></name></person-group><year iso-8601-date="2002">2002</year><article-title>Selection at the level of the community: the importance of spatial structure</article-title><source>Trends in Ecology &amp; Evolution</source><volume>17</volume><fpage>83</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1016/S0169-5347(01)02385-0</pub-id></element-citation></ref><ref id="bib27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnston</surname> <given-names>IG</given-names></name><name><surname>Jones</surname> <given-names>NS</given-names></name></person-group><year iso-8601-date="2015">2015</year><article-title>Closed-form stochastic solutions for non-equilibrium dynamics and inheritance of cellular components over many cell divisions</article-title><source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source><volume>471</volume><elocation-id>20150050</elocation-id><pub-id pub-id-type="doi">10.1098/rspa.2015.0050</pub-id></element-citation></ref><ref id="bib28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kotil</surname> <given-names>SE</given-names></name><name><surname>Vetsigian</surname> <given-names>K</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Emergence of evolutionarily stable communities through eco-evolutionary tunnelling</article-title><source>Nature Ecology &amp; Evolution</source><volume>2</volume><fpage>1644</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1038/s41559-018-0655-7</pub-id><pub-id pub-id-type="pmid">30242295</pub-id></element-citation></ref><ref id="bib29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lewontin</surname> <given-names>RC</given-names></name></person-group><year iso-8601-date="1970">1970</year><article-title>The units of selection</article-title><source>Annual Review of Ecology and Systematics</source><volume>1</volume><fpage>1</fpage><lpage>18</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.01.110170.000245</pub-id></element-citation></ref><ref id="bib30"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Margulis</surname> <given-names>L</given-names></name></person-group><year iso-8601-date="1970">1970</year><source>Origin of Eukaryotic Cells: Evidence and Research Implications for a Theory of the Origin and Evolution of Microbial, Plant, and Animal Cells on the Precambrian Earth</source><publisher-loc>New Haven, USA</publisher-loc><publisher-name>Yale University Press</publisher-name></element-citation></ref><ref id="bib31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Martin</surname> <given-names>W</given-names></name><name><surname>Müller</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="1998">1998</year><article-title>The hydrogen hypothesis for the first eukaryote</article-title><source>Nature</source><volume>392</volume><fpage>37</fpage><lpage>41</lpage><pub-id pub-id-type="doi">10.1038/32096</pub-id><pub-id pub-id-type="pmid">9510246</pub-id></element-citation></ref><ref id="bib32"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maynard Smith</surname> <given-names>J</given-names></name><name><surname>Szathmary</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1995">1995</year><source>The Major Transitions in Evolution</source><publisher-loc>Oxford</publisher-loc><publisher-name>Freeman</publisher-name></element-citation></ref><ref id="bib33"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Penn</surname> <given-names>A</given-names></name></person-group><year iso-8601-date="2003">2003</year><chapter-title>Modelling artificial ecosystem selection: A preliminary investigation</chapter-title><person-group person-group-type="editor"><name><surname>Banzhaf</surname> <given-names>W</given-names></name><name><surname>Ziegler</surname> <given-names>J</given-names></name><name><surname>Christaller</surname> <given-names>T</given-names></name><name><surname>Dittrich</surname> <given-names>P</given-names></name><name><surname>Kim</surname> <given-names>J. T</given-names></name></person-group><source>European Conference on Artificial Life</source><publisher-name>Springer</publisher-name><fpage>659</fpage><lpage>666</lpage><pub-id pub-id-type="doi">10.1007/978-3-540-39432-7_71</pub-id></element-citation></ref><ref id="bib34"><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Penn</surname> <given-names>A</given-names></name><name><surname>Harvey</surname> <given-names>I</given-names></name></person-group><year iso-8601-date="2004">2004</year><article-title>The role of non-genetic change in the heritability, variation, and response to selection of artificially selected ecosystems</article-title><conf-name>Artificial Life IX: Proceedings of the Ninth International Conference on theSimulation and Synthesis of Artificial Life</conf-name></element-citation></ref><ref id="bib35"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Queller</surname> <given-names>DC</given-names></name></person-group><year iso-8601-date="1997">1997</year><source>Cooperators Since Life Began</source><publisher-name>University of Chicago Press</publisher-name><pub-id pub-id-type="doi">10.1086/419766</pub-id></element-citation></ref><ref id="bib36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rainey</surname> <given-names>PB</given-names></name><name><surname>Remigi</surname> <given-names>P</given-names></name><name><surname>Farr</surname> <given-names>AD</given-names></name><name><surname>Lind</surname> <given-names>PA</given-names></name></person-group><year iso-8601-date="2017">2017</year><article-title>Darwin was right: where now for experimental evolution?</article-title><source>Current Opinion in Genetics &amp; Development</source><volume>47</volume><fpage>102</fpage><lpage>109</lpage><pub-id pub-id-type="doi">10.1016/j.gde.2017.09.003</pub-id><pub-id pub-id-type="pmid">29059583</pub-id></element-citation></ref><ref id="bib37"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sackmann</surname> <given-names>EK</given-names></name><name><surname>Fulton</surname> <given-names>AL</given-names></name><name><surname>Beebe</surname> <given-names>DJ</given-names></name></person-group><year iso-8601-date="2014">2014</year><article-title>The present and future role of microfluidics in biomedical research</article-title><source>Nature</source><volume>507</volume><fpage>181</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1038/nature13118</pub-id><pub-id pub-id-type="pmid">24622198</pub-id></element-citation></ref><ref id="bib38"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname> <given-names>JM</given-names></name><name><surname>Szathmáry</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1993">1993</year><article-title>The origin of chromosomes. I. selection for linkage</article-title><source>Journal of Theoretical Biology</source><volume>164</volume><fpage>437</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1006/jtbi.1993.1165</pub-id><pub-id pub-id-type="pmid">8264246</pub-id></element-citation></ref><ref id="bib39"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sørensen</surname> <given-names>MES</given-names></name><name><surname>Lowe</surname> <given-names>CD</given-names></name><name><surname>Minter</surname> <given-names>EJA</given-names></name><name><surname>Wood</surname> <given-names>AJ</given-names></name><name><surname>Cameron</surname> <given-names>DD</given-names></name><name><surname>Brockhurst</surname> <given-names>MA</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The role of exploitation in the establishment of mutualistic microbial symbioses</article-title><source>FEMS Microbiology Letters</source><volume>366</volume><elocation-id>fnz148</elocation-id><pub-id pub-id-type="doi">10.1093/femsle/fnz148</pub-id><pub-id pub-id-type="pmid">31271421</pub-id></element-citation></ref><ref id="bib40"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swenson</surname> <given-names>W</given-names></name><name><surname>Arendt</surname> <given-names>J</given-names></name><name><surname>Wilson</surname> <given-names>DS</given-names></name></person-group><year iso-8601-date="2000">2000a</year><article-title>Artificial selection of microbial ecosystems for 3-chloroaniline biodegradation</article-title><source>Environmental Microbiology</source><volume>2</volume><fpage>564</fpage><lpage>571</lpage><pub-id pub-id-type="doi">10.1046/j.1462-2920.2000.00140.x</pub-id><pub-id pub-id-type="pmid">11233164</pub-id></element-citation></ref><ref id="bib41"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Swenson</surname> <given-names>W</given-names></name><name><surname>Wilson</surname> <given-names>DS</given-names></name><name><surname>Elias</surname> <given-names>R</given-names></name></person-group><year iso-8601-date="2000">2000b</year><article-title>Artificial ecosystem selection</article-title><source>PNAS</source><volume>97</volume><fpage>9110</fpage><lpage>9114</lpage><pub-id pub-id-type="doi">10.1073/pnas.150237597</pub-id><pub-id pub-id-type="pmid">10890915</pub-id></element-citation></ref><ref id="bib42"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Takeuchi</surname> <given-names>N</given-names></name><name><surname>Hogeweg</surname> <given-names>P</given-names></name></person-group><year iso-8601-date="2009">2009</year><article-title>Multilevel selection in models of prebiotic evolution II: a direct comparison of compartmentalization and spatial self-organization</article-title><source>PLOS Computational Biology</source><volume>5</volume><elocation-id>e1000542</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000542</pub-id><pub-id pub-id-type="pmid">19834556</pub-id></element-citation></ref><ref id="bib43"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Vliet</surname> <given-names>S</given-names></name><name><surname>Doebeli</surname> <given-names>M</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>The role of multilevel selection in host microbiome evolution</article-title><source>PNAS</source><volume>116</volume><fpage>20591</fpage><lpage>20597</lpage><pub-id pub-id-type="doi">10.1073/pnas.1909790116</pub-id><pub-id pub-id-type="pmid">31548380</pub-id></element-citation></ref><ref id="bib44"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Wade</surname> <given-names>MJ</given-names></name></person-group><year iso-8601-date="2016">2016</year><source>Adaptation in Metapopulations</source><publisher-loc>Chicago</publisher-loc><publisher-name>University of Chicago Press</publisher-name><pub-id pub-id-type="doi">10.7208/chicago/9780226129877.001.0001</pub-id></element-citation></ref><ref id="bib45"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Williams</surname> <given-names>HT</given-names></name><name><surname>Lenton</surname> <given-names>TM</given-names></name></person-group><year iso-8601-date="2007">2007</year><article-title>Artificial selection of simulated microbial ecosystems</article-title><source>PNAS</source><volume>104</volume><fpage>8918</fpage><lpage>8923</lpage><pub-id pub-id-type="doi">10.1073/pnas.0610038104</pub-id><pub-id pub-id-type="pmid">17517642</pub-id></element-citation></ref><ref id="bib46"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>EO</given-names></name></person-group><year iso-8601-date="1985">1985</year><article-title>The sociogenesis of insect colonies</article-title><source>Science</source><volume>228</volume><fpage>1489</fpage><lpage>1495</lpage><pub-id pub-id-type="doi">10.1126/science.228.4707.1489</pub-id><pub-id pub-id-type="pmid">17831241</pub-id></element-citation></ref><ref id="bib47"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DS</given-names></name><name><surname>Knollenberg</surname> <given-names>WG</given-names></name></person-group><year iso-8601-date="1987">1987</year><article-title>Adaptive indirect effects: the fitness of burying beetles with and without their phoretic mites</article-title><source>Evolutionary Ecology</source><volume>1</volume><fpage>139</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1007/BF02067397</pub-id></element-citation></ref><ref id="bib48"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilson</surname> <given-names>DS</given-names></name><name><surname>Sober</surname> <given-names>E</given-names></name></person-group><year iso-8601-date="1989">1989</year><article-title>Reviving the superorganism</article-title><source>Journal of Theoretical Biology</source><volume>136</volume><fpage>337</fpage><lpage>356</lpage><pub-id pub-id-type="doi">10.1016/S0022-5193(89)80169-9</pub-id><pub-id pub-id-type="pmid">2811397</pub-id></element-citation></ref><ref id="bib49"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>L</given-names></name><name><surname>Yuan</surname> <given-names>AE</given-names></name><name><surname>Shou</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2019">2019</year><article-title>Simulations reveal challenges to artificial community selection and possible strategies for success</article-title><source>PLOS Biology</source><volume>17</volume><elocation-id>e3000295</elocation-id><pub-id pub-id-type="doi">10.1371/journal.pbio.3000295</pub-id><pub-id pub-id-type="pmid">31237866</pub-id></element-citation></ref><ref id="bib50"><element-citation publication-type="preprint"><person-group person-group-type="author"><name><surname>Xie</surname> <given-names>L</given-names></name><name><surname>Shou</surname> <given-names>W</given-names></name></person-group><year iso-8601-date="2018">2018</year><article-title>Community function landscape and steady state species ratio shape the eco-evolutionary dynamics of artificial community selection</article-title><source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/264697</pub-id></element-citation></ref><ref id="bib51"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zomorrodi</surname> <given-names>AR</given-names></name><name><surname>Segrè</surname> <given-names>D</given-names></name></person-group><year iso-8601-date="2016">2016</year><article-title>Synthetic ecology of microbes: mathematical models and applications</article-title><source>Journal of Molecular Biology</source><volume>428</volume><fpage>837</fpage><lpage>861</lpage><pub-id pub-id-type="doi">10.1016/j.jmb.2015.10.019</pub-id><pub-id pub-id-type="pmid">26522937</pub-id></element-citation></ref></ref-list><app-group><app id="appendix-1"><title>Appendix 1</title><boxed-text><sec id="s8" sec-type="appendix"><title>Stochastic model</title><p>This appendix presents an outline for the approximated stochastic simulation of nested population dynamics described in the main text. We first attend to the case where particle populations are monomorphic without mutation and then move to consider the role of particle-level mutation. Full implementation of the model is available as <xref ref-type="supplementary-material" rid="scode1">Source code 1</xref> and at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ecoevomath/estaudel">https://gitlab.com/ecoevomath/estaudel</ext-link> (<xref ref-type="bibr" rid="bib14">Doulcier, 2020</xref>).</p><sec id="s8-1"><title>Parameters</title><p>First, we list the parameters of the numerical model introduced in the main text. The collective selection regime is specified by a set of collective-level parameters that are kept constant along the evolutionary trajectory.<disp-formula id="equ1"><mml:math id="m1"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mtext> </mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>D</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>1000</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>B</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>15</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">k</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">z</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>T</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>1.0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">←</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>ρ</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mn>0.2</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mn>0.5</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Collectives are comprised of two kinds of self-replicating particle (red and blue) that carry a different set of traits. Traits can mutate (see the mutation section below), and are represented as global variables.<disp-formula id="equ2"><mml:math id="m2"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mtext mathvariant="bold"> </mml:mtext><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>The state variables (<inline-formula><mml:math id="inf130"><mml:mrow><mml:mi>D</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> matrices) store the adult state of collectives along a trajectory.<disp-formula id="equ3"><mml:math id="m3"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mtext mathvariant="bold"> </mml:mtext><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">a</mml:mi><mml:mi mathvariant="bold">b</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mtext> </mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi mathvariant="bold">N</mml:mi><mml:mn mathvariant="bold">0</mml:mn></mml:msub><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mtext mathvariant="bold"> </mml:mtext><mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:msub><mml:mi mathvariant="bold">N</mml:mi><mml:mn mathvariant="bold">1</mml:mn></mml:msub><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi mathvariant="bold">Φ</mml:mi><mml:mtext mathvariant="bold"> </mml:mtext><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold">/</mml:mo></mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s8-2"><title>Initial conditions</title><p>Initial conditions consist in defining the number of red and blue particles in each collective at the beginning of generation 0.<disp-formula id="equ4"><mml:math id="m4"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">C</mml:mi><mml:mrow><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext>-</mml:mtext><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s8-3"><title>Outline of the main loop</title><p>The main loop of the algorithm applies the sequence growth-selection-reproduction for each generation.<disp-formula id="equ5"><mml:math id="m5"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">N</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>M</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">D</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mo stretchy="false">←</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mi mathvariant="normal">_</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">B</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>parents</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>B</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">N</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p></sec><sec id="s8-4"><title>Particle-level ecology</title><p>The ecological dynamics of particles is expressed by a multi-type birth-death process with a linear birth rate and a linearly density-dependent death rate. Each type of particle <inline-formula><mml:math id="inf131"><mml:mi>i</mml:mi></mml:math></inline-formula> is characterised by four traits: colour (<inline-formula><mml:math id="inf132"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, red or blue), maximum growth rate <inline-formula><mml:math id="inf133"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, and two density-dependent interaction parameters. Particles of the same colour interact according to <inline-formula><mml:math id="inf134"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>intra</mml:mtext></mml:msubsup></mml:math></inline-formula>, whereas particles of different colour interact according to <inline-formula><mml:math id="inf135"><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mtext>inter</mml:mtext></mml:msubsup></mml:math></inline-formula>. Interaction terms are in the order of 0.1 and scaled by a carrying capacity term <inline-formula><mml:math id="inf136"><mml:mi>K</mml:mi></mml:math></inline-formula>. The dynamic is modelled by a continuous-time Markov jump process with rates:</p><p><table-wrap id="inlinetable1" position="anchor"><table frame="hsides" rules="groups"><tbody><tr><th>Each particle of type i . . .</th><th>With rate. . .</th></tr><tr><td>Reproduces (add a particle of type i) <break/>Dies (remove a particle of type i)</td><td><inline-formula><mml:math id="inf137"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <break/><inline-formula><mml:math id="inf138"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msubsup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula></td></tr></tbody></table></table-wrap></p><p><inline-formula><mml:math id="inf139"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf140"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> or 0 if <inline-formula><mml:math id="inf141"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>. Additionally <inline-formula><mml:math id="inf142"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf143"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> or 0 if <inline-formula><mml:math id="inf144"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>The stochastic trajectory of the system is simulated using a Poissonian approximation used in the basic <inline-formula><mml:math id="inf145"><mml:mrow><mml:mi>τ</mml:mi><mml:mo>⁢</mml:mo><mml:mtext>-leap</mml:mtext></mml:mrow></mml:math></inline-formula> algorithm (<xref ref-type="bibr" rid="bib17">Gillespie, 2001</xref>), <inline-formula><mml:math id="inf146"><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> is chosen to be small enough so that population size never becomes negative.<disp-formula id="equ6"><mml:math id="m6"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">G</mml:mi><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">H</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mi mathvariant="bold">h</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">←</mml:mo><mml:mrow><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>inter</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mn>1</mml:mn><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">←</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mi>t</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Early tests using an exact stochastic simulation algorithm (Doob-Gillespie SSA, <xref ref-type="bibr" rid="bib16">Gillespie, 1976</xref>) did not exhibit qualitative changes in the trajectory, but greatly increased the computation duration.</p></sec><sec id="s8-5"><title>Collective-level selection</title><p>The collective-level selection phase consists in associating each of the <italic>D</italic> new collectives from generation <inline-formula><mml:math id="inf147"><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> with a single parent at generation <italic>m</italic>. In the main text we contrast two regimes: colour-neutral and colour-selective. In both cases, a fixed proportion <inline-formula><mml:math id="inf148"><mml:mi>ρ</mml:mi></mml:math></inline-formula> of the collective population at generation <inline-formula><mml:math id="inf149"><mml:mi>m</mml:mi></mml:math></inline-formula> is marked for extinction. In the neutral regime, collectives to be eliminated are selected uniformly at random (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 1A</xref>), whereas in the selective regime they are those that rank the highest in their distance to the optimal colour <inline-formula><mml:math id="inf150"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> (<xref ref-type="fig" rid="app1fig5">Appendix 1—figure 1B</xref>). Each surviving collective produces offspring. Moreover, the remaining collectives from generation <inline-formula><mml:math id="inf151"><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are generated by a parent chosen uniformly at random from the set of surviving collectives.</p><fig id="app1fig1" position="float"><label>Appendix 1—figure 1.</label><caption><title>Collective-level selection regimes.</title><p>Each ring represents a collective. The blue section of the ring represents the proportion of blue particles at the adult stage of the collective. Parent and offspring are linked by a black line. (<bold>A</bold>) One generation of the neutral regime. (<bold>B</bold>) One generation of the selective regime. In both cases <inline-formula><mml:math id="inf152"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig1-v2.tif"/></fig><p><disp-formula id="equ7"><mml:math id="m7"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">n</mml:mi><mml:mi mathvariant="bold">c</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mstyle mathsize="0.75em"><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">_</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">O</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">V</mml:mi><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mspace width="thickmathspace"/><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">y</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">h</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mspace width="thickmathspace"/><mml:mrow><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext></mml:mrow><mml:mi>D</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mover><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>&lt;</mml:mo><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">h</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">l</mml:mi><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mtext mathvariant="bold"> </mml:mtext><mml:mi mathvariant="bold">i</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">h</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">W</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">l</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1...</mml:mn><mml:mi mathvariant="normal">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">n</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">f</mml:mi><mml:mi mathvariant="bold">o</mml:mi><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">D</mml:mi><mml:mtext>-</mml:mtext><mml:mi mathvariant="normal">L</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mrow><mml:mi mathvariant="bold">d</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="2em"/><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">R</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mtext> </mml:mtext><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mtext> </mml:mtext><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mo stretchy="false">←</mml:mo><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mspace width="1em"/><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold">e</mml:mi><mml:mi mathvariant="bold">t</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mi mathvariant="bold">r</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:mi mathvariant="normal">p</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Other selection procedures can be implemented, such as randomly sampling <inline-formula><mml:math id="inf153"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>⁢</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> collectives with weight based on the colour-deviation to the optimal colour. A non-exhaustive exploration of other selection rules indicates that the qualitative results of the model are robust to changes in the selective regime, as long as collectives with an optimal colour are favoured and the collective population does not go extinct.</p><p>Collective reproduction is implemented by seeding an offspring collective with a sample of <italic>B</italic> particles drawn according to the proportion of the parent collective. We assume that the final particle population sizes are big enough so that each reproduction event can be modelled as an independent binomial sample. Smaller population sizes might require simultaneous multinomial sampling of all offspring.</p></sec><sec id="s8-6"><title>Mutation of particle traits</title><p>The complete model adds the possibility for particle trait (<inline-formula><mml:math id="inf154"><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) to mutate. Each collective contains two variants of each colour. Whenever a variant goes extinct, the remaining type is called the ‘resident’, and a mutant type is created as follows. First, traits of the resident are copied in one newborn particle, then one of the mutable traits — either the growth rate (<inline-formula><mml:math id="inf155"><mml:mi>r</mml:mi></mml:math></inline-formula>) or the inter-colour competition trait (<inline-formula><mml:math id="inf156"><mml:msub><mml:mi>a</mml:mi><mml:mtext>inter</mml:mtext></mml:msub></mml:math></inline-formula>) — is chosen at random, and finally a random value is added that is taken from a uniform distribution over <inline-formula><mml:math id="inf157"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (in <xref ref-type="fig" rid="fig2">Figure 2</xref>, <inline-formula><mml:math id="inf158"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>). Traits are kept positive by taking the absolute value of the result. This process is in the spirit of adaptive dynamics in which invasion of a single new mutant is repeatedly assessed in a monomorphic population.</p><p>We checked that relaxing this assumption (i.e. allowing more than two types of each colour in each collective), or waiting for rare mutations to appear did not change the qualitative results. The pseudo-code outlined above was modified in order to track the trait value of both resident and mutant types in each collective, rather than having the trait values as global variables.</p></sec></sec><sec id="s9" sec-type="appendix"><title>Variability of the derived particle traits</title><p>The single trajectory of the stochastic model discussed in the main text (<xref ref-type="fig" rid="fig2">Figure 2</xref>) is obtained by setting initial conditions for both collective composition (fraction of red and blue particles in each collective at the beginning of the first collective generation) and for the value of particle-level parameters that are subjected to mutations. We used this specific trajectory to illustrate key features of the evolutionary outcome, that are then explained by the deterministic approximation (Appendix 2). Such approximation, discussed below, allows exhaustive exploration of parameter space, that would otherwise prove impossible because of computation demands. However, it provides only indirect insight on the expected variance of the corresponding particle-based stochastic process. Here, we address variability of the evolutionary outcome of stochastic simulations in a few relevant cases.</p><fig id="app1fig2" position="float"><label>Appendix 1—figure 2.</label><caption><title>Distribution of average mutable traits values across several simulations.</title><p>Three parameters sets are represented in which red and blue types have respectively equal carrying capacity (<inline-formula><mml:math id="inf159"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mn>1</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mn>0.7</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), red types have a higher carrying capacity (<inline-formula><mml:math id="inf160"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>) and lower carrying capacity (<inline-formula><mml:math id="inf161"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mn>0</mml:mn><mml:mtext>intra</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>). The results of 20 independent simulations for each of the parameters sets are shown. For each simulation, <inline-formula><mml:math id="inf162"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> collectives, <inline-formula><mml:math id="inf163"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> generations, <inline-formula><mml:math id="inf164"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> particles, the optimal collective colour is <inline-formula><mml:math id="inf165"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> and initial particle traits are <inline-formula><mml:math id="inf166"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext> inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf167"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig2-v2.tif"/></fig><p><xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2</xref> illustrates the distribution of average colour in a population of collectives (A) and of the average associated traits (interaction rates [B]; growth rates [C]) after <inline-formula><mml:math id="inf168"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula> collective generations for three different values of the red type’s carrying capacity. For each set of parameters, 20 trajectories where simulated. In none of the 60 simulations do populations became entirely monochromatic.</p><p>The evolutionary outcome of the stochastic model is highly reproducible, with only a small percentage variation in the average collective colour achieved in different realizations of the stochastic process. Apart from a small systematic bias toward the type with the higher carrying capacity (i.e. the lower <inline-formula><mml:math id="inf169"><mml:msup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>n</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>), changing the carrying capacity does not affect the ability of selection to achieve the target colour (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2A</xref>).</p><p>The effects of collective selection on particle traits instead change depending on the role of such traits in determining the collective colour. <xref ref-type="fig" rid="fig2">Figure 2</xref> of the main text illustrates the convergence, over one single evolutionary trajectory, of the inter-colour interaction parameters to specific values. Correspondingly, the average of these parameters in the population also changes little across multiple realizations of the stochastic evolutionary process (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2B</xref>). As expected, the values depend on the parameters that do not evolve, that in the cases illustrated here, are the carrying capacities. However, one can notice that as long as interaction rates are bounded to be positive, one interaction (in the specific case where carrying capacities are equal) will in the long run vanish, indicating that one of the types drives the intra-collective dynamics. This corresponds to predictions, as discussed in Appendix 2 and 3.</p><p>Maximal growth rates, that were observed to change within one single realization of the evolutionary trajectory, also vary considerably across realizations (<xref ref-type="fig" rid="app1fig2">Appendix 1—figure 2C</xref>). This is a consequence of their quasi-neutrality with respect to collective selection: once the particle population approaches a steady-state within any collective generation, the speed at which it grows at low density is less important.</p></sec><sec id="s10" sec-type="appendix"><title>Different target colours</title><p>In the main text, we have considered that the target of selection was a situation when collectives are composed of half red and half blue particles. Here, we repeated the numerical simulations for different target proportions of the two types and discuss how the choice of <inline-formula><mml:math id="inf170"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> affects the outcome of the evolutionary trajectory. We performed ten independent simulations for 10,000 collective generations, starting from the same initial conditions and parameter values, but varying the target of selection.</p><p><xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3A</xref> shows that different target colours, that is, compositions of the collectives, can be selected with an overall accuracy of a few percent. However, the variability among simulations is larger when the target is strongly skewed toward one or another monochromatic state. This reflects an increased variability in the selected particle traits, which manifests when the derived interaction rates are considered (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3B</xref>) and maximal growth rate (<xref ref-type="fig" rid="app1fig3">Appendix 1—figure 3B</xref>). While maintaining the previously observed lower variability in interaction rates than in growth rates, all derived traits change more from run to run when the target is extreme. This is likely the consequence of a lower effectiveness in the action of collective-level selection, as a considerable part of the population ends up being monochromatic just because of sampling at birth. As a consequence, convergence towards the target is also considerably slower.</p><fig id="app1fig3" position="float"><label>Appendix 1—figure 3.</label><caption><title>Distribution of the final traits across several experiments for different optimal colours.</title><p>Ten independent simulations are performed for each value of <inline-formula><mml:math id="inf171"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math></inline-formula>. In all simulations, <inline-formula><mml:math id="inf172"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> collectives, <inline-formula><mml:math id="inf173"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> 10,000 generations, <inline-formula><mml:math id="inf174"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> particles, and initial particle traits are <inline-formula><mml:math id="inf175"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext> inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>, with <inline-formula><mml:math id="inf176"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig3-v2.tif"/></fig><fig id="app1fig4" position="float"><label>Appendix 1—figure 4.</label><caption><title>Example of collective genealogy (Supplement of <xref ref-type="fig" rid="fig2">Figure 2</xref>).</title><p>Symbols and colours are as in <xref ref-type="fig" rid="app1fig1">Appendix 1—figure 1</xref> and extinct lineages are marked transparent. Collective-level parameters in this simulation are <inline-formula><mml:math id="inf177"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:mo rspace="5.3pt">,</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. <italic>A.</italic> Neutral regime: at the final generation, collectives are monochromatic and most likely composed of the faster-growing type. <italic>B.</italic> Selective regime: at the final generation, collectives contain both red and blue particles.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig4-v2.tif"/></fig><fig id="app1fig5" position="float"><label>Appendix 1—figure 5.</label><caption><title>The stochastic-corrector mechanism can maintain both types of particles in the absence of mutations (Supplement of <xref ref-type="fig" rid="fig2">Figure 2</xref>).</title><p>Collective phenotype distribution through time in the selective regime with ancestral particle traits and no mutations. Without collective-level mutation, the only mechanism maintaining both types within the population is the stochastic corrector, whereby a fraction of the collectives with colour closer to the target are propagated to the next collective generation. This means that at every generation the distribution of collective phenotypes is skewed towards the colour that has higher maximal growth rate, and the target colour is realized, in a small fraction of collective population, thanks to stochastic fluctuations in the composition at birth. Parameters are <inline-formula><mml:math id="inf178"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf179"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>, <inline-formula><mml:math id="inf180"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf181"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> and initial traits <inline-formula><mml:math id="inf182"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>red</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for red particles and <inline-formula><mml:math id="inf183"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>blue</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> for blue particles, with <inline-formula><mml:math id="inf184"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1500</mml:mn></mml:mrow></mml:mstyle></mml:math></inline-formula>. The initial proportions at generation 0 were randomly drawn from a uniform distribution.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig5-v2.tif"/></fig><fig id="app1fig6" position="float"><label>Appendix 1—figure 6.</label><caption><title>Particle trait mutations lead to slow loss of optimal collective colour after removal of collective-level selection (Supplement of <xref ref-type="fig" rid="fig4">Figure 4</xref>).</title><p>Modification of the collective phenotype distribution when particle traits mutate and no selection for colour is applied, starting from the particle traits after 10,000 generations of selection for purple colour (as in <xref ref-type="fig" rid="fig4">Figure 4B</xref>). Collectives continue to produce purple offspring for more than 200 generations, before drift of particle traits erodes developmental correction. In contrast, for the ancestral particle traits, lineages become monochromatic in less than 10 generations (<xref ref-type="fig" rid="fig4">Figure 4A</xref>).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app1-fig6-v2.tif"/></fig></sec></boxed-text></app><app id="appendix-2"><title>Appendix 2</title><boxed-text><sec id="s11" sec-type="appendix"><title>Lotka-Volterra deterministic particle ecology</title><sec id="s11-1"><title>Model for intra-collective dynamics</title><p>The stochastic ecological dynamics of red (<inline-formula><mml:math id="inf185"><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></inline-formula>) and blue (<inline-formula><mml:math id="inf186"><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>) particles within a collective simulated by the algorithm described in Appendix 1 is approximated (see <xref ref-type="fig" rid="fig3">Figure 3</xref>) by the deterministic competitive Lotka-Volterra Ordinary Differential Equation:<disp-formula id="equ8"><label>(1)</label><mml:math id="m8"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mi>K</mml:mi></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="inf187"><mml:mrow><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the pair of maximal growth rates for red and blue particles. Since the system is symmetric, we consider only the case where red particles grow faster than blue particles (<inline-formula><mml:math id="inf188"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>). The effect of pairwise competitive interactions between cells are encoded in the matrix <inline-formula><mml:math id="inf189"><mml:mrow><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. All competitive interactions are considered harmful or neutral (<inline-formula><mml:math id="inf190"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⁢</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) (see Appendix 3 for more general types of interactions). Here and in the main text, we consider that the four free parameters can evolve at the same time. In the last section of the Results in the main text we explore cases when their variation is constrained by trade-offs.</p><p>So as to explore the space of all possible interaction intensities, no specific mechanism of interaction is assumed, and thus qualitatively different ecological dynamics of the particle populations. Evolutionary trajectories constrained by particle traits are briefly discussed in the last section of the Results (main text).</p><p>The carrying capacity of a monochromatic collective is <inline-formula><mml:math id="inf191"><mml:mfrac><mml:mi>K</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mfrac></mml:math></inline-formula> for red particles and <inline-formula><mml:math id="inf192"><mml:mfrac><mml:mi>K</mml:mi><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mfrac></mml:math></inline-formula> for blue particles. <inline-formula><mml:math id="inf193"><mml:mi>K</mml:mi></mml:math></inline-formula> is a scaling factor for the intensity of pairwise interactions that can be used to rescale the deterministic system to match the stochastic trajectories. Without loss of generality, we thus assume that <inline-formula><mml:math id="inf194"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>A natural set of alternate coordinates for the system in <xref ref-type="disp-formula" rid="equ8">Equation 1</xref> are total population size <inline-formula><mml:math id="inf195"><mml:mrow><mml:mi>N</mml:mi><mml:mo>:=</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and collective colour, defined as the frequency of red individuals <inline-formula><mml:math id="inf196"><mml:mrow><mml:mi>x</mml:mi><mml:mo>:=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>. In these coordinates, the deterministic dynamics are the solution to the following ODE.<disp-formula id="equ9"><label>(2)</label><mml:math id="m9"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The functions <inline-formula><mml:math id="inf197"><mml:mi>g</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf198"><mml:mi>h</mml:mi></mml:math></inline-formula> are polynomials in <inline-formula><mml:math id="inf199"><mml:mi>x</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf200"><mml:mi>N</mml:mi></mml:math></inline-formula>, of coefficients:</p><p><table-wrap id="inlinetable2" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Monomial</th><th>Coefficient in <inline-formula><mml:math id="inf201"><mml:mi>h</mml:mi></mml:math></inline-formula></th><th>Monomial</th><th>Coefficient in <inline-formula><mml:math id="inf202"><mml:mi>g</mml:mi></mml:math></inline-formula></th></tr></thead><tbody><tr><td>1</td><td><inline-formula><mml:math id="inf203"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td>1</td><td><inline-formula><mml:math id="inf204"><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf205"><mml:mi>N</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf206"><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf207"><mml:mi>N</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf208"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td><inline-formula><mml:math id="inf209"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf210"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf211"><mml:mi>x</mml:mi></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf212"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td></tr><tr><td/><td/><td><inline-formula><mml:math id="inf213"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf214"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td/><td/><td><inline-formula><mml:math id="inf215"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf216"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap></p><p><xref ref-type="fig" rid="app2fig1">Appendix 2—figure 1</xref> shows an example of the ODE flow in both coordinate systems. Two unstable trivial equilibria and a stable coexistence equilibrium are located at the intersection of the isoclines. Within one collective generation, the dynamics follow such flows for duration <inline-formula><mml:math id="inf217"><mml:mi>T</mml:mi></mml:math></inline-formula>, starting from initial conditions on the line <inline-formula><mml:math id="inf218"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (that is, <inline-formula><mml:math id="inf219"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>).</p><fig id="app2fig1" position="float"><label>Appendix 2—figure 1.</label><caption><title>Left: A Lotka-Volterra flow (<xref ref-type="disp-formula" rid="equ8">Equation 1</xref> ) in <inline-formula><mml:math id="inf220"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> coordinates.</title><p>Right: The same flow in <inline-formula><mml:math id="inf221"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> coordinates. Coloured lines are the null isoclines. Empty (resp. filled) circles mark unstable (resp. stable) equilibria.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig1-v2.tif"/></fig><p>Even though <xref ref-type="disp-formula" rid="equ8">Equation 1</xref> is more directly related to the individual-based stochastic simulation, the dynamics of collective colour are understood more easily using <xref ref-type="disp-formula" rid="equ9">Equation 2</xref>. Therefore, in the following we will use the latter formulation.</p><p>The dynamics of particle types across collective generations are modelled as a piecewise continuous time change (<xref ref-type="fig" rid="app2fig2">Appendix 2—figure 2</xref>), where <inline-formula><mml:math id="inf222"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the fraction of red particles at time <inline-formula><mml:math id="inf223"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> during collective generation <inline-formula><mml:math id="inf224"><mml:mi>m</mml:mi></mml:math></inline-formula>.</p><fig id="app2fig2" position="float"><label>Appendix 2—figure 2.</label><caption><title>Piecewise continuous trajectory.</title><p>Iterating the deterministic model yields a piecewise continuous trajectory in the <inline-formula><mml:math id="inf225"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> space. The growth phase (continuous lines) alternates with the dilution (dotted lines). In (<bold>A, B</bold>) traits are taken from generation 3 and in (<bold>C,D</bold>) from generation 9000 of the main simulation with selection (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Successive adult states can be computed using the <inline-formula><mml:math id="inf226"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function as a recurrence map (see <xref ref-type="fig" rid="fig5">Figure 5</xref> in the main text).</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig2-v2.tif"/></fig><p>We focus in particular on the succession <inline-formula><mml:math id="inf227"><mml:mrow><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of collective ‘‘adult’’ states at the end of each successive generation <inline-formula><mml:math id="inf228"><mml:mi>m</mml:mi></mml:math></inline-formula>. In the following we note <inline-formula><mml:math id="inf229"><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, which is the adult colour of the collective at the end of the growth phase. At the beginning of each collective generation, we impose that, regardless of the number of cells in the parent, every collective contains the same number of cells <inline-formula><mml:math id="inf230"><mml:mrow><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi>ℝ</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>∀</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. In contrast, the newborn collective colour <inline-formula><mml:math id="inf231"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the colour of the parent. In this deterministic model, we consider that there is no stochastic variation or bias due to sampling at birth, so the collective colour of the newborn is equal to that of its parent: <inline-formula><mml:math id="inf232"><mml:mrow><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. In the first generation (<inline-formula><mml:math id="inf233"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>), the population size is <italic>B</italic> in every collective and the fraction of red particles is chosen uniformly at random between 0 and 1.</p><p>The proportion of red particles at adult stage <inline-formula><mml:math id="inf234"><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula> is obtained from these initial conditions <inline-formula><mml:math id="inf235"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by integrating <xref ref-type="disp-formula" rid="equ9">Equation 2</xref>. Since these equations are not explicitly solvable, there is no analytic expression for the result of the transient dynamics. However, having constrained the initial conditions to a single dimension, the adult colour is a single-valued function of the initial composition of the collective, defined as follows.</p></sec><sec id="s11-2"><title>Definition (Growth function)</title><p>Given the set of particle traits <inline-formula><mml:math id="inf236"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>:=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">𝐀</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>:=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, the bottleneck size <inline-formula><mml:math id="inf237"><mml:mrow><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the duration of the growth phase <inline-formula><mml:math id="inf238"><mml:mrow><mml:mi>T</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, the growth function <inline-formula><mml:math id="inf239"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is defined as the application that maps an initial proportion of red particles <inline-formula><mml:math id="inf240"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> to the proportion of red particles after duration <inline-formula><mml:math id="inf241"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. Thus, <inline-formula><mml:math id="inf242"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf243"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the unique solution to the following Cauchy problem:<disp-formula id="equ10"><label>(3)</label><mml:math id="m10"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi/><mml:mo>=</mml:mo><mml:mi>ϕ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>To simplify notations in the main text, we set <inline-formula><mml:math id="inf244"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s11-3"><title>Relation with the stochastic evolutionary model</title><p>As explained in the main text, the growth function <inline-formula><mml:math id="inf245"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> defines the recurrence relation between the colour of the newborn offspring and its colour at adulthood. If the reproduction process entails no stochasticity, the latter also defines the composition of collectives at the next generation. As a consequence, the iterative application of <inline-formula><mml:math id="inf246"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> approximates the change in time of the adult colour when a population with a given, fixed, set of parameters and traits is transferred across collective generations.</p><p>The fixed points of this discrete-time system allow understanding and classifcation of behaviours observed along stochastic evolutionary trajectories. When mutation rate of particle traits is sufficiently small and growth rates are not vanishing, collectives approach such fixed points in a few collective generations by iteration of the <inline-formula><mml:math id="inf247"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function (<xref ref-type="fig" rid="fig5">Figure 5</xref>). The evolutionary trajectory can thus be seen as a succession of fixed points of <inline-formula><mml:math id="inf248"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>. The surface of the fixed points of <inline-formula><mml:math id="inf249"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> as a function of the particle parameters can be computed numerically, as well as its dependence on the collective generation duration <inline-formula><mml:math id="inf250"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and bottleneck size <inline-formula><mml:math id="inf251"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. A small number of qualitatively different configurations are possible for the fixed points (illustrated in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3 1-4</xref>). In particular, the case in which <inline-formula><mml:math id="inf252"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> possesses an internal, stable fixed point (<xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>) constitutes the optimal solution to constant selection for collective colour, in that it ensures the highest degree of colour reproducibility, on average, across collective generations.</p><fig id="app2fig3" position="float"><label>Appendix 2—figure 3.</label><caption><title>Qualitative behaviours of the growth function <inline-formula><mml:math id="inf253"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>.</title><p>Panels 1–4 represent the possible qualitative shapes, differing in the position and stability of the fixed points, of the growth function <inline-formula><mml:math id="inf254"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> that approximates the within-collective particle dynamics (orange line in <xref ref-type="fig" rid="fig5">Figure 5</xref>). (1) <inline-formula><mml:math id="inf255"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is the only stable fixed point (<xref ref-type="fig" rid="fig5">Figure 5A</xref>), and iteration of the red <inline-formula><mml:math id="inf256"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function leads to fixation of red particles. (2) <inline-formula><mml:math id="inf257"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is the only stable fixed point, and iteration of the blue <inline-formula><mml:math id="inf258"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function leads to fixation of blue particles. (3) <inline-formula><mml:math id="inf259"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf260"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are two stable fixed points, and iteration of the grey <inline-formula><mml:math id="inf261"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function leads to fixation of either red or blue particles depending on initial conditions. (4) <inline-formula><mml:math id="inf262"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf263"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are unstable and there is a stable fixed point between 0 and 1. Iteration of the grey <inline-formula><mml:math id="inf264"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function leads to coexistence of both particle types. Panels (<bold>A-D</bold>) show that when red particles are the fast growing types (<inline-formula><mml:math id="inf265"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the shape of <inline-formula><mml:math id="inf266"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> and the position of its fixed points depend on the collective-level parameters <inline-formula><mml:math id="inf267"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> (bottleneck size) and <inline-formula><mml:math id="inf268"><mml:mi>T</mml:mi></mml:math></inline-formula> (growth phase duration). Particle interaction traits generically belong to one of the four intervals (A) <inline-formula><mml:math id="inf269"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf270"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; (B) <inline-formula><mml:math id="inf271"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf272"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; (C) <inline-formula><mml:math id="inf273"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf274"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> ; (D) <inline-formula><mml:math id="inf275"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf276"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (qualitative nature of the corresponding ecological equilibria is indicated in the titles of the panels, see also Appendix 2). Lines represent the limit of the region of stability of the fixed point of <inline-formula><mml:math id="inf277"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>, as derived by Proposition 4: blue lines for the ‘all blue’ state <inline-formula><mml:math id="inf278"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and red lines for the ‘all red’ state <inline-formula><mml:math id="inf279"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig3-v2.tif"/></fig><p>The parameter values that separate regions with qualitatively different fixed points correspond to transcritical bifurcations, where one of the monochromatic fixed points changes its stability. These lines are analytically computed below, thus allowing generalisation of the conclusions drawn from analysing the representative trajectory of <xref ref-type="fig" rid="fig2">Figure 2</xref>. In the following, we detail analysis of how the fixed points of the <inline-formula><mml:math id="inf280"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function depend on particle- and collective-level parameters.</p><p>It is worth stressing here that the deterministic model provides a good quantitative approximation of the system with particle-level and collective-level stochasticity provided that fluctuations at both levels are small. This is the case if populations of particles are large (as for instance in the case of bacterial populations) and if mutations of particle traits are rare and of small magnitude. However, in the numerical simulations we performed, the conclusions drawn from ensuing analysis held qualitatively also in the case of large fluctuations.</p></sec></sec><sec id="s12" sec-type="appendix"><title>Fixed Points of the <inline-formula><mml:math id="inf281"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function and their stability</title><p>In this paragraph, we list the key properties of the <inline-formula><mml:math id="inf282"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function, that determine how the asymptotic collective colour depends on particle and collective parameters. Proofs of the propositions are provided in the following paragraph.</p><sec id="s12-1"><title>Proposition 1 (Fixed points of <inline-formula><mml:math id="inf283"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>)</title><p><italic>Let</italic> <inline-formula><mml:math id="inf284"><mml:mrow><mml:mi>θ</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> <italic>be a set of particle traits</italic>, <inline-formula><mml:math id="inf285"><mml:mrow><mml:mi>T</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <italic>the duration of the growth phase and</italic> <inline-formula><mml:math id="inf286"><mml:mrow><mml:mi>B</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi mathvariant="normal">∞</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> <italic>the bottleneck size</italic>.</p><p><italic>Then</italic>, <inline-formula><mml:math id="inf287"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi>T</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>B</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>and</italic> <inline-formula><mml:math id="inf288"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mn mathvariant="normal">1</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mi>T</mml:mi><mml:mo mathvariant="normal">,</mml:mo><mml:mi>B</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>hence</italic> <inline-formula><mml:math id="inf289"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula><italic> and</italic> <inline-formula><mml:math id="inf290"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula><italic> are fixed points of</italic> <inline-formula><mml:math id="inf291"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> <inline-formula><mml:math id="inf292"><mml:mrow><mml:mo mathvariant="normal">∀</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p><italic>Moreover, if the stability with respect to</italic> <inline-formula><mml:math id="inf293"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> <italic>of 0 and</italic> 1 <italic>is the same, then</italic> <inline-formula><mml:math id="inf294"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> <italic>has at least one fixed point</italic> <inline-formula><mml:math id="inf295"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">∈</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mn mathvariant="normal">0</mml:mn><mml:mo mathvariant="normal">,</mml:mo><mml:mn mathvariant="normal">1</mml:mn><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>The stability of the monochromatic fixed points with respect to the fraction <inline-formula><mml:math id="inf296"><mml:mi>ϕ</mml:mi></mml:math></inline-formula> can be numerically assessed. The number and stability of the fixed points as a function of collective-level parameters <italic>B</italic> and <italic>T</italic> are illustrated in <xref ref-type="fig" rid="app2fig3">Appendix 2—figure 3</xref>. Four different cases are considered, corresponding to the four qualitatively different outcomes of particle-level ecology (competitive exclusion by one or the other type, bistability, coexistence).</p><p>The fixed points can be analytically calculated in certain limit cases, corresponding to parameter values when within-collective particle dynamics are exponential or saturating.</p></sec><sec id="s12-2"><title>Proposition 2 (Quasi-exponential growth)</title><p><italic>When T is close to 0 and</italic> <inline-formula><mml:math id="inf297"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>𝑚𝑎𝑥</mml:mtext></mml:msub></mml:mrow><mml:mo mathvariant="normal">≪</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula> <italic>with</italic> <inline-formula><mml:math id="inf298"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mspace width="thinmathspace"/><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula> <italic>the highest element of the competition matrix</italic> <inline-formula><mml:math id="inf299"><mml:mi mathvariant="normal">A</mml:mi></mml:math></inline-formula>, <italic>then</italic> <inline-formula><mml:math id="inf300"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> <italic>has only two fixed points</italic> <inline-formula><mml:math id="inf301"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula> <italic>and</italic> <inline-formula><mml:math id="inf302"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p><italic>Moreover, the monochromatic fixed point</italic> <inline-formula><mml:math id="inf303"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">1</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>corresponding to a population completely composed of the (faster) red type of particle, is stable, whereas the fixed point</italic> <inline-formula><mml:math id="inf304"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">=</mml:mo><mml:mn mathvariant="normal">0</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>corresponding to a population composed of the slow growing type of particle, is unstable</italic>.</p></sec><sec id="s12-3"><title>Proposition 3 (Saturating growth)</title><p><italic>As</italic> <inline-formula><mml:math id="inf305"><mml:mrow><mml:mi>T</mml:mi><mml:mo mathvariant="normal">→</mml:mo><mml:mi mathvariant="normal">∞</mml:mi></mml:mrow></mml:math></inline-formula><italic> the fixed points</italic> <inline-formula><mml:math id="inf306"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msup></mml:math></inline-formula><italic>of</italic> <inline-formula><mml:math id="inf307"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math></inline-formula><italic> and their stability correspond to the equilibria</italic> <inline-formula><mml:math id="inf308"><mml:msup><mml:mi>x</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msup></mml:math></inline-formula><italic>of</italic> <xref ref-type="disp-formula" rid="equ8">Equation 1</xref>. <italic>These equilibria and their stability range are listed below.</italic></p><p><table-wrap id="inlinetable3" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th/><th>Red alone</th><th>Blue alone</th><th>Coexistence</th></tr></thead><tbody><tr><td>Equilibrium <inline-formula><mml:math id="inf309"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula></td><td>1</td><td>0</td><td><inline-formula><mml:math id="inf310"><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula></td></tr><tr><td>Stability range</td><td><inline-formula><mml:math id="inf311"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf312"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf313"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> <italic>and</italic> <inline-formula><mml:math id="inf314"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td></tr></tbody></table></table-wrap></p><p><italic>Here</italic> <inline-formula><mml:math id="inf315"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">:=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn mathvariant="normal">00</mml:mn></mml:msub><mml:mo mathvariant="normal">+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn mathvariant="normal">11</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> <italic>is the sum of the diagonal (or trace) of</italic> <inline-formula><mml:math id="inf316"><mml:mi mathvariant="normal">A</mml:mi></mml:math></inline-formula>, <italic>and</italic> <inline-formula><mml:math id="inf317"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>o</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>T</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mi>r</mml:mi><mml:mo mathvariant="italic">⁢</mml:mo><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:mi mathvariant="normal">A</mml:mi><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo mathvariant="normal">:=</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn mathvariant="normal">10</mml:mn></mml:msub><mml:mo mathvariant="normal">+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn mathvariant="normal">01</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> <italic>denotes the sum of the anti-diagonal elements of</italic> <inline-formula><mml:math id="inf318"><mml:mi mathvariant="normal">A</mml:mi></mml:math></inline-formula>.</p><p>By linearising the system in proximity of the fixed points, it is possible to find exactly the bifurcation parameters where one equilibrium changes stability, thus the limit of the region where there exists an interior fixed point <inline-formula><mml:math id="inf319"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>. The bifurcation values in the space of the collective parameters <inline-formula><mml:math id="inf320"><mml:mi>T</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf321"><mml:mi>B</mml:mi></mml:math></inline-formula> delimit the region in <xref ref-type="fig" rid="fig7">Figure 7</xref> where the <inline-formula><mml:math id="inf322"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function has an internal fixed point.</p><p>Even when the fixed point is different from the optimal value <inline-formula><mml:math id="inf323"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>, it can nonetheless provide a starting point for evolution to optimise collective colour. Extinction of one of the two colours of particles happens instead very rapidly in the region when the monochromatic fixed points are stable, so that collectives have a higher risk of being extinct before inheritance-increasing mutations appear.</p></sec><sec id="s12-4"><title>Proposition 4 (Bifurcations of the monochromatic fixed points of <inline-formula><mml:math id="inf324"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>)</title><p><italic>The stability of 0 changes at</italic> <inline-formula><mml:math id="inf325"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msubsup><mml:mo mathvariant="normal">,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msubsup><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>and the stability of</italic> 1 <italic>at</italic> <inline-formula><mml:math id="inf326"><mml:mrow><mml:mo mathvariant="normal" stretchy="false">(</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msubsup><mml:mo mathvariant="normal">,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>R</mml:mi><mml:mo mathvariant="normal">*</mml:mo></mml:msubsup><mml:mo mathvariant="normal" stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic>such that</italic>:<disp-formula id="equ11"><mml:math id="m11"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>B</mml:mi><mml:mi>R</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>00</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>B</mml:mi><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msubsup><mml:mi>T</mml:mi><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi></mml:mrow><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>These results allow understanding of the interplay between time scales of particle-level ecology and collective reproduction, whose relationship changes along an evolutionary trajectory. <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> illustrates the change of the fixed point of <inline-formula><mml:math id="inf327"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> with the collective generation duration <italic>T</italic> for typical particle traits corresponding to the four qualitative classes of asymptotic equilibria for particle ecology. Of particular relevance for understanding the stochastic trajectory illustrated in <xref ref-type="fig" rid="fig2">Figure 2</xref> is panel D.</p><fig id="app2fig4" position="float"><label>Appendix 2—figure 4.</label><caption><title>Bifurcation diagrams showing the position and stability of the fixed points of <inline-formula><mml:math id="inf328"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> as a function of the duration of the collective generation <italic>T</italic>.</title><p>(<bold>A-D</bold>) Particle traits are representative of the scenarios illustrated in <xref ref-type="fig" rid="fig7">Figure 7A–D</xref>. Of particular interest is the case illustrated in panel <italic>D</italic>, where the <inline-formula><mml:math id="inf329"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function acquires — for a sufficiently large separation between the particle maximum division time and the collective generation time — a stable internal fixed point.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig4-v2.tif"/></fig><p>When the time scale of exponential particle growth is comparable to <italic>T</italic>, (such as at the beginning of the evolutionary trajectory displayed in <xref ref-type="fig" rid="fig2">Figure 2</xref>) Proposition 2 indicates that the system is expected to converge to an all-red solution (<inline-formula><mml:math id="inf330"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is the only stable equilibrium). However, at the same time as this fast dynamic occurs, the growth rates change by mutation. Selection during the exponential phase generally favours fast growing mutants, which means that particle populations achieve high-density conditions in a shorter time. The system then effectively behaves as if <italic>T</italic> had increased, thus leading selection to ’see’ interaction traits.</p><p>When the time scale of collective reproduction is sufficiently slow with respect to the intra-collective dynamics, the system crosses the bifurcation point <inline-formula><mml:math id="inf331"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></inline-formula> (Proposition 4), so that the function <inline-formula><mml:math id="inf332"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> now has an internal fixed point (<xref ref-type="fig" rid="fig6">Figure 6</xref>). In the stochastic simulations, this means that more collectives are reproducibly found close to the optimal colour. It takes a relatively short time to adjust the particle traits so that the fixed point is close to the optimum <inline-formula><mml:math id="inf333"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. In this case, the deterministic approximation produces a close to perfect inheritance of the collective colour. However, fluctuations in particle numbers and in composition at birth still result in a large variance of colours among collectives in the stochastic system.</p><fig id="app2fig5" position="float"><label>Appendix 2—figure 5.</label><caption><title>Stable equilibria of the particle ecology as a function of inter-colour competition traits.</title><p>These equilibria correspond to the limit of the fixed points of the <inline-formula><mml:math id="inf334"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function when particle-level and collective-level time scales are well separated ( <inline-formula><mml:math id="inf335"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>), derived in proposition 3. Other interaction parameters are <inline-formula><mml:math id="inf336"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf337"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, and the result is independent of growth rates. The grey area indicates bistability.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig5-v2.tif"/></fig><p>Here, starts the last and slowest phase of the evolutionary trajectory, which results in colour variance reduction through improvement of the ability of particles to correct variations in colour. This is achieved by attaining faster the particle ecological equilibrium, so that fluctuations are more efficiently dampened by demographic dynamics. As a consequence, the conditions described by Proposition 3 will be met. This allows identification of a surface in parameter space, where the fixed point of the <inline-formula><mml:math id="inf338"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function <inline-formula><mml:math id="inf339"><mml:msup><mml:mi>ϕ</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> identifies with the ecological equilibrium <inline-formula><mml:math id="inf340"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, that contains evolutionary equilibria. The ecological equilibrium is displayed in <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> as a function of the cross-colour interaction parameters <inline-formula><mml:math id="inf341"><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf342"><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula>. In the regime where particle and collective time scales are well separated (<inline-formula><mml:math id="inf343"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>), then interaction parameters that correspond to the optimal colour satisfy the following relationship:<disp-formula id="equ12"><label>(4)</label><mml:math id="m12"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This relation identifies the white dotted line in <xref ref-type="fig" rid="app2fig4">Appendix 2—figure 4</xref> (and in <xref ref-type="fig" rid="fig8">Figure 8B</xref>). Once it is attained, mutations cause the deterministic system to move neutrally on this surface. As the stochastic simulation shows, particle parameters keep evolving directionally so as to reduce phenotypic variance. This is achieved by making <inline-formula><mml:math id="inf344"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> increasingly flatter in the vicinity of the fixed point, so that the target colour is not only more stable, but it is reached in fewer collective generations.</p><p>Successive events of mutation and substitution progressively lead to a growing asymmetry in the ecological relationship between the two types of particles: that with smaller carrying capacity becomes insensitive to the other colour; the latter instead experiences competition, so that its growth is curbed and optimal proportion of colours is eventually realized (see <xref ref-type="fig" rid="fig3">Figure 3D</xref>). As illustrated by <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref>, this conclusion is independent of what is the maximum growth rate, that only affects the advantage of one type at initial stages of growth. Indeed, the position on the intercept between the optimality line and the y axis in <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref> and <xref ref-type="fig" rid="app2fig6">Appendix 2—figure 6</xref> only depends on the difference between intra-type competition parameters. A consequence of this is that fast-growing types systematically display, when they are also those with a larger carrying capacity, a population overshoot.</p><fig id="app2fig6" position="float"><label>Appendix 2—figure 6.</label><caption><title>Asymmetric interaction ensures fastest convergence toward the ecological equilibrium.</title><p>Particle population dynamics are illustrated for increasingly asymmetric values of <inline-formula><mml:math id="inf345"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, keeping the ecological equilibrium fix at <inline-formula><mml:math id="inf346"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> (along white manifold, in the direction of the arrow). The top panels correspond to cases when the faster-growing particles have a higher carrying capacity (<inline-formula><mml:math id="inf347"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.7</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), the bottom panels to the opposite (<inline-formula><mml:math id="inf348"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). In both cases <inline-formula><mml:math id="inf349"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf350"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>40</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf351"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf352"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app2-fig6-v2.tif"/></fig></sec></sec><sec id="s13" sec-type="appendix"><title>Proofs</title><p>In this section, we present the proof of propositions 2–4 above.</p><sec id="s13-1"><title>Proof of Proposition 1</title><p>In the <inline-formula><mml:math id="inf353"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> coordinates we have seen that <inline-formula><mml:math id="inf354"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>f</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>N</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and that <inline-formula><mml:math id="inf355"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf356"><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> are trivial roots of the polynomial <inline-formula><mml:math id="inf357"><mml:mi>g</mml:mi></mml:math></inline-formula> (<xref ref-type="disp-formula" rid="equ9">Equation 2</xref>). Hence 0 and 1 are always fixed points of <inline-formula><mml:math id="inf358"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula>.</p><p>Since <inline-formula><mml:math id="inf359"><mml:mi>g</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="inf360"><mml:mi>h</mml:mi></mml:math></inline-formula> (from <xref ref-type="disp-formula" rid="equ9">Equation 2</xref>) are polynomials of <inline-formula><mml:math id="inf361"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, they are smooth (of differentiability class <inline-formula><mml:math id="inf362"><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">∞</mml:mi></mml:msub></mml:math></inline-formula>) on <inline-formula><mml:math id="inf363"><mml:msup><mml:mi>ℝ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula>. Thus, the global flow corresponding to the Cauchy problem is also smooth on <inline-formula><mml:math id="inf364"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:math></inline-formula> is the partial application of the global flow to the case where <inline-formula><mml:math id="inf365"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula>. Therefore, <inline-formula><mml:math id="inf366"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is continuous on <inline-formula><mml:math id="inf367"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p><p>Moreover, let us suppose that 0 and 1 are both unstable. Then <inline-formula><mml:math id="inf368"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf369"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="inf370"><mml:msubsup><mml:mi>G</mml:mi><mml:mi>θ</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:math></inline-formula> the derivative of <inline-formula><mml:math id="inf371"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> with respect to its first variable. As a consequence there is an <inline-formula><mml:math id="inf372"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf373"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf374"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Since <inline-formula><mml:math id="inf375"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> is continuous, there is at least one <inline-formula><mml:math id="inf376"><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="inf377"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> by virtue of the intermediate value theorem.</p><p>In practice, we never encountered cases when more than one internal fixed point was present. However multistability is expected to occur if the equations describing particle ecology had higher-order nonlinearities.</p></sec><sec id="s13-2"><title>Proof of Proposition 2</title><p>Since the nonlinear terms in <xref ref-type="disp-formula" rid="equ10">Equation 3</xref> are smaller than <inline-formula><mml:math id="inf378"><mml:mrow><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>max</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>, and this is negligible with respect to 1, particle ecology is approximated by its linearization as long as the population size remains close to the bottleneck value. Around <inline-formula><mml:math id="inf379"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, the Cauchy problem can be written as:<disp-formula id="equ13"><mml:math id="m13"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="false"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd/></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>In the <inline-formula><mml:math id="inf380"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> coordinates, the total population size grows exponentially and is decoupled from the colour. On the other hand, <inline-formula><mml:math id="inf381"><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> follows the logistic differential equation:<disp-formula id="equ14"><label>(5)</label><mml:math id="m14"><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>⁢</mml:mo><mml:mstyle displaystyle="true"><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>which can be integrated.</p><p>For <italic>T</italic> sufficiently small for the population to be in exponential growth phase, the growth map <inline-formula><mml:math id="inf382"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> can be approximated by the solution <inline-formula><mml:math id="inf383"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> of <xref ref-type="disp-formula" rid="equ14">Equation 5</xref>:<disp-formula id="equ15"><mml:math id="m15"><mml:mrow><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>≈</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>x</mml:mi></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac><mml:mo>:=</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>θ</mml:mi></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>This function is strictly convex (or concave) on (0, 1) depending on the sign of <inline-formula><mml:math id="inf384"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>:<disp-formula id="equ16"><mml:math id="m16"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⁢</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>-</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Since <inline-formula><mml:math id="inf385"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf386"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf387"><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>⁡</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>θ</mml:mi></mml:msub></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mo>⁡</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> is of the same sign as <inline-formula><mml:math id="inf388"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, that is strictly positive if <inline-formula><mml:math id="inf389"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, or strictly negative if <inline-formula><mml:math id="inf390"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>Thus, <inline-formula><mml:math id="inf391"><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> is strictly convex on <inline-formula><mml:math id="inf392"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf393"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and strictly concave on <inline-formula><mml:math id="inf394"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> if <inline-formula><mml:math id="inf395"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In the first case, red colour <inline-formula><mml:math id="inf396"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is an unstable equilibrium and blue colour <inline-formula><mml:math id="inf397"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> a stable one, and vice-versa in the second case. Note that the segment <inline-formula><mml:math id="inf398"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a chord of <inline-formula><mml:math id="inf399"><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>. Therefore, the strictly convex (resp. concave) <inline-formula><mml:math id="inf400"><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> do not intersect <inline-formula><mml:math id="inf401"><mml:mi>s</mml:mi></mml:math></inline-formula> except in <inline-formula><mml:math id="inf402"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf403"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="s13-3"><title>Proof of Proposition 3</title><p>When the collective generation time <italic>T</italic> is much longer than the demographic time scale, the populations within droplets at the adult stage are well approximated by the equilibrium solution of the Lotka-Volterra <xref ref-type="disp-formula" rid="equ8">Equation 1</xref>. Solving simultaneously equations <inline-formula><mml:math id="inf404"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf405"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (or equivalently <inline-formula><mml:math id="inf406"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf407"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) yields the four equilibria listed below in both coordinate systems. Linear stability analysis allows one to determine the parameter intervals where these are stable, listed below.</p><p><table-wrap id="inlinetable4" position="anchor"><table frame="hsides" rules="groups"><thead><tr><th>Name</th><th>Red alone</th><th>Blue alone</th><th>Coexistence</th><th>Extinction</th></tr></thead><tbody><tr><td>Position in <inline-formula><mml:math id="inf408"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf409"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf410"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf411"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td>[0,0]</td></tr><tr><td>Position in <inline-formula><mml:math id="inf412"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf413"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf414"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf415"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>e</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></td><td>Undefined</td></tr><tr><td>Condition for stability</td><td><inline-formula><mml:math id="inf416"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf417"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td><inline-formula><mml:math id="inf418"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf419"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula></td><td>Never</td></tr></tbody></table></table-wrap></p></sec><sec id="s13-4"><title>Proof of Proposition 4</title><p>We consider the case when the fixed point 0 changes stability. The stability of the fixed point 1 can be studied analogously.</p><p>We aim at identifying the values of the collective parameters <inline-formula><mml:math id="inf420"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where a fixed point with <inline-formula><mml:math id="inf421"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> changes stability through a transcritical bifurcation. The difficulty lies in the fact that one needs to estimate the dynamics of the second variable <inline-formula><mml:math id="inf422"><mml:mi>N</mml:mi></mml:math></inline-formula> in order to study the stability of the 2-D system. Luckily, this can be done in the limit when the collective contains almost exclusively particles of one single colour (in this case, blue).</p><p>Total population size is in this case decoupled from colour and <xref ref-type="disp-formula" rid="equ9">Equation 2</xref> can be integrated with initial condition <inline-formula><mml:math id="inf423"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, yielding the following trajectory:<disp-formula id="equ17"><mml:math id="m17"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>As long as <inline-formula><mml:math id="inf424"><mml:mi>x</mml:mi></mml:math></inline-formula> is small, the time derivative is approximated by the non-autonomous system:<disp-formula id="equ18"><mml:math id="m18"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>⁢</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>≈</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>⁢</mml:mo><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>with <inline-formula><mml:math id="inf425"><mml:mi>h</mml:mi></mml:math></inline-formula> as defined in <xref ref-type="disp-formula" rid="equ9">Equation 2</xref>:<disp-formula id="equ19"><mml:math id="m19"><mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Solving this equation allows computation of the adult colour as a function of the parameters <inline-formula><mml:math id="inf426"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula> and <inline-formula><mml:math id="inf427"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mstyle></mml:math></inline-formula>. At the bifurcation point <inline-formula><mml:math id="inf428"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where stability of the 0 fixed point changes, the newborn colour is the same as the adult colour: <inline-formula><mml:math id="inf429"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula>. <inline-formula><mml:math id="inf430"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:math></inline-formula> are then solutions of the integral equation:<disp-formula id="equ20"><mml:math id="m20"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mstyle></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mrow><mml:mover><mml:mi>N</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="true" scriptlevel="0"><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>T</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mstyle></mml:math></disp-formula></p><p>Solving for <inline-formula><mml:math id="inf431"><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> we get:<disp-formula id="equ21"><mml:math id="m21"><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>⁢</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>With <inline-formula><mml:math id="inf432"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula></p><p><xref ref-type="fig" rid="fig7">Figure 7</xref> shows that this approximation retrieves accurately the numerically computed bifurcation lines.</p></sec></sec></boxed-text></app><app id="appendix-3"><title>Appendix 3</title><boxed-text><sec id="s14" sec-type="appendix"><title>Beyond competitive interactions</title><p>In the main text, the model is limited to deleterious (competitive) interactions, whereby the inter-colour interactions are such that one colour always has a negative density-dependent effect on the growth of the other colour. This choice reflects the expectation that, as in the example of the droplet experiment, competition would be the main driver of interactions among two previously unconnected bacterial species growing on a common resource.</p><p>However, it is interesting to consider what happens if interactions of other types are taken into account. This section presents two additional interaction classes: exploitative (e.g. predator-prey or parasitic) interactions (<inline-formula><mml:math id="inf433"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf434"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), and mutualism (<inline-formula><mml:math id="inf435"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf436"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). Note that exploitative interactions correspond to non-obligate predation (or parasitism): the predator (or the parasite) can sustain a non-null population density even in the absence of the prey (or host). Obligate interactions can be modelled in the limit where the carrying capacity of the exploiters tends to zero. Similarly, unless the carrying capacities of both types tend to zero, mutualism is also not obligate.</p><p>The deterministic model (Appendix 2 <xref ref-type="disp-formula" rid="equ8">Equation 1</xref>) can be straightforwardly extended to these larger parameter ranges, allowing prediction of the outcome of the evolutionary dynamics. <xref ref-type="fig" rid="app2fig5">Appendix 2—figure 5</xref> presents the position of the stable fixed point of <inline-formula><mml:math id="inf437"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> for negative inter-colour interaction parameters when the time scale of collective reproduction is sufficiently slow with respect to the intra-collective dynamic <inline-formula><mml:math id="inf438"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref> represents the same fixed point for extended values of the interaction parameters. Each quadrant corresponds to a different kind of ecological interaction (competition, exploitation and mutualism). While competition is discussed in the main text, other kinds of interactions are discussed below.</p><p>Whenever evolution leads to separation in time-scales between particle and collective dynamics (typically by increasing particle growth rates), the evolutionary dynamic within each quadrant will be akin to the competition case: first, successive invasions of mutants bring the system on the manifold of interaction parameters where the equilibrium colour <inline-formula><mml:math id="inf439"><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> corresponds to the selected colour <inline-formula><mml:math id="inf440"><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> (Appendix 2 <xref ref-type="disp-formula" rid="equ12">Equation 4</xref>); second, the system evolves on this manifold toward regions of faster ecological convergence.</p><fig id="app3fig1" position="float"><label>Appendix 3—figure 1.</label><caption><title>Asymptotic colour of the particle ecology as a function of inter-colour competition traits.</title><p>These equilibria correspond to the limit of the fixed points of the <inline-formula><mml:math id="inf441"><mml:msub><mml:mi>G</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math></inline-formula> function when particle-level and collective-level time scales are well separated ( <inline-formula><mml:math id="inf442"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≫</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> ), derived in proposition 3. Other interaction parameters are <inline-formula><mml:math id="inf443"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf444"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, and the result is independent of growth rates. The grey area indicates bistability. This figure extends <xref ref-type="fig" rid="app1fig5">Appendix 2—figure 5</xref>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app3-fig1-v2.tif"/></fig></sec><sec id="s15" sec-type="appendix"><title>Exploitative interactions</title><p>Consider first that <inline-formula><mml:math id="inf445"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, so that red individuals (type 0) are the exploiters (predators or parasites) and blue individuals (type 1) are the exploited (prey or hosts). This corresponds to the bottom-right quadrant of <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>.</p><p>When the exploiter competes with the exploited more than with other exploiters (<inline-formula><mml:math id="inf446"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the stable equilibrium for Appendix 2 <xref ref-type="disp-formula" rid="equ8">Equation 1</xref> is monochromatic red (see Appendix 2 Proposition 3). However, when the the competitive interaction is stronger among exploiters (<inline-formula><mml:math id="inf447"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the coexistence equilibrium is stable and correspond to a colour of <inline-formula><mml:math id="inf448"><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>⁢</mml:mo><mml:mi>o</mml:mi><mml:mo>⁢</mml:mo><mml:mi>T</mml:mi><mml:mo>⁢</mml:mo><mml:mi>r</mml:mi><mml:mo>⁢</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:math></inline-formula> (see Appendix 2 Proposition 3). In the coexistence region of the bottom-left quadrant, the collective colour can take up values in the range <inline-formula><mml:math id="inf449"><mml:mrow><mml:mo>[</mml:mo><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> bounded on one side by the extinction of the exploited type, and on the other side by the ratio of carrying capacity obtained when there is no competitive interactions. This range does not contain the target colour <inline-formula><mml:math id="inf450"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in the example illustrated in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref> because the exploiter has a higher carrying capacity than the exploited <inline-formula><mml:math id="inf451"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. It is thus impossible to achieve the target colour <inline-formula><mml:math id="inf452"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in the lower right quadrant. Unless the nature of ecological interactions changes, over evolutionary times the population of collectives will move towards the absence of interactions. Here, collectives of colour close to the optimum can still manifest in the stochastic individual-based model as the effect of sampling at dilution and fluctuations during growth, but the average colour will remain off target.</p><p>In the upper left quadrant, where <inline-formula><mml:math id="inf453"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, blue individuals (type 0) are the exploiters (predators or parasites) and red individuals are the exploited (prey or hosts). In the coexistence region (i.e., when the competition is stronger among exploiters than between exploiters and exploited <inline-formula><mml:math id="inf454"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), the collective colour can take up values in the range <inline-formula><mml:math id="inf455"><mml:mrow><mml:mo>[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>, that contains the target <inline-formula><mml:math id="inf456"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> in the example illustrated in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref> because the exploiter has a lower carrying capacity than the exploited <inline-formula><mml:math id="inf457"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. Within the boundaries of this quadrant, long-term evolution will tend to reduce the (positive) interaction <inline-formula><mml:math id="inf458"><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math></inline-formula>, thus mitigating exploitation, while at the same time making the (negative) interaction term <inline-formula><mml:math id="inf459"><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> smaller, that is increasing the advantage provided by the exploited to the exploiter. Again, if the nature of ecological interactions does not change, the system will evolve towards a case where one particle type (in this case, the exploiter, that also has smaller carrying capacity), gets decoupled from the demography of the other type.</p></sec><sec id="s16" sec-type="appendix"><title>Mutualistic interactions</title><p>Consider now that red and blue individuals have non-obligate, mutualistic interactions. This corresponds to both inter-colour competition traits <inline-formula><mml:math id="inf460"><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="inf461"><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:math></inline-formula> being negative, and can be visualised in the bottom-left quadrant of <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>.</p><p>When interactions are mutualistic, the equilibria of Appendix 2 <xref ref-type="disp-formula" rid="equ8">Equation 1</xref> resulting from the extinction of one type or the other are never stable (<inline-formula><mml:math id="inf462"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="inf463"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are never fulfilled since <inline-formula><mml:math id="inf464"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="inf465"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> respectively, see Appendix 2 Proposition 3) and the solution is always coexistence.</p><p>Depending on the sign of the determinant of the interaction matrix <inline-formula><mml:math id="inf466"><mml:mi mathvariant="bold">𝐀</mml:mi></mml:math></inline-formula>, the dynamics within a collective generation can have two qualitatively different behaviours. When mutualistic interactions have small intensity, the intra-collective dynamics attains an equilibrium, even though the population size of one of the two particle types is larger than their respective carrying capacities (because of the positive contribution of the other type). However, when <inline-formula><mml:math id="inf467"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>⁢</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (white line in <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref>), the populations would undergo unbounded growth if they were not embedded in collectives of finite lifetime.</p><p>This unrealistic feature of simplified Lotka-Volterra models, that makes them not well fit to describe mutualistic interactions, is not particularly problematic in our case, since the fraction <inline-formula><mml:math id="inf468"><mml:mi>x</mml:mi></mml:math></inline-formula> of red particles converges to its equilibrium value even though the population size <inline-formula><mml:math id="inf469"><mml:mi>N</mml:mi></mml:math></inline-formula> diverges. <xref ref-type="fig" rid="app3fig1">Appendix 3—figure 1</xref> illustrates how the within-collective particle dynamics changes along an evolutionary trajectory towards increasingly strong mutualistic interactions. If no physical or biological constraint keeps parameters in the region of bounded growth, then adherence of the model predictions from reality would need to be tested by studying their robustness to inclusion of other sources of co-limitation, such as, for instance, nutrient exhaustion.</p><fig id="app3fig2" position="float"><label>Appendix 3—figure 2.</label><caption><title>Mutualistic interaction can lead to non-saturating population growth.</title><p>Particle population dynamics are illustrated for increasingly mutualistic values of <inline-formula><mml:math id="inf470"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, keeping the ecological equilibrium fixed at <inline-formula><mml:math id="inf471"><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula> (moving along the white manifold, in the direction of the arrow). When the determinant of <inline-formula><mml:math id="inf472"><mml:mi mathvariant="bold">𝐀</mml:mi></mml:math></inline-formula> is negative, population growth is unbounded in the limit of infinitely long duration of the collective generation. As long as <inline-formula><mml:math id="inf473"><mml:mi>T</mml:mi></mml:math></inline-formula> is finite, however, the adult proportion of red and blue particles can be reached even though both populations grow exponentially (with growth rates that depend on the interaction parameters). The top panels correspond to cases when the faster growing particles have a higher carrying capacity (<inline-formula><mml:math id="inf474"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>0.8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), the bottom panels is the opposite (<inline-formula><mml:math id="inf475"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>00</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>). In both cases <inline-formula><mml:math id="inf476"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf477"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf478"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="inf479"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p></caption><graphic mime-subtype="tiff" mimetype="image" xlink:href="elife-53433-app3-fig2-v2.tif"/></fig></sec><sec id="s17" sec-type="appendix"><title>Transition between classes of ecological interactions</title><p>So far, we have examined different ecological interactions separately, as they are usually considered to belong to separate categories. It is, however, conceivable that mutations induce a competitive interaction to become exploitative, or an exploitative interaction to become mutualistic (<xref ref-type="bibr" rid="bib39">Sørensen et al., 2019</xref>), which in our case would be the consequence of the inter-colour interaction parameters changing sign. In this case, the prediction of the deterministic model is that, as long as there are no constraints that limit the variation of the interaction parameters, selection at the collective level should lead particles to become more and more benign towards each other, and eventually reach a regime where their exchanges are mutualistic.</p></sec></boxed-text></app></app-group></back><sub-article article-type="decision-letter" id="sa1"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53433.sa1</article-id><title-group><article-title>Decision letter</article-title></title-group><contrib-group><contrib contrib-type="editor"><name><surname>Shou</surname><given-names>Wenying</given-names></name><role>Reviewing Editor</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="reviewer"><name><surname>Shou</surname><given-names>Wenying</given-names> </name><role>Reviewer</role><aff><institution>Fred Hutchinson Cancer Research Center</institution><country>United States</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Mitri</surname><given-names>Sara</given-names> </name><role>Reviewer</role><aff><institution>University of Lausanne</institution><country>Switzerland</country></aff></contrib><contrib contrib-type="reviewer"><name><surname>Sanchez</surname><given-names>Alvaro</given-names> </name><role>Reviewer</role><aff><institution>Yale University</institution><country>United States</country></aff></contrib></contrib-group></front-stub><body><boxed-text><p>In the interests of transparency, eLife publishes the most substantive revision requests and the accompanying author responses.</p></boxed-text><p><bold>Acceptance summary:</bold></p><p>Doulcier et al. tackled multi-level community selection: selection at the level of individual cells for fast growth and at the level of whole communities for a desired community property. The authors showed that when selecting communities based on species ratios, the growth rates and the inter-species competition effects can evolve such that a desired species ratio (here 1:1) can be achieved. This work contributes to a growing interest in using multi-level selection to achieve desired community properties.</p><p><bold>Decision letter after peer review:</bold></p><p>Thank you for submitting your article &quot;Eco-evolutionary dynamics of nested Darwinian populations and the emergence of community-level heredity&quot; for consideration by <italic>eLife</italic>. Your article has been reviewed by three peer reviewers, including Wenying Shou as the Reviewing Editor and Reviewer #1, and the evaluation has been overseen by Patricia Wittkopp as the Senior Editor. The following individuals involved in review of your submission have agreed to reveal their identity:); Sara Mitri (Reviewer #2); Alvaro Sanchez (Reviewer #3).</p><p>The reviewers have discussed the reviews with one another and the Reviewing Editor has drafted this decision to help you prepare a revised submission.</p><p>Summary:</p><p>Doulcier et al. tackled multi-level community selection: selection at the level of individual cells for fast growth and at the level of whole communities for a desired community property. The authors showed that when selecting communities based on species ratios, the growth rates and the inter-species competition effects can evolve such that a desired species ratio (here 1:1) can be achieved. The evolved mechanism is rather intuitive: species Blue grows faster than species Red, but species Blue is subject to competitive inhibition by species Red. This allows the species ratio to be 1:1. Consistent with intuition, when possibilities for competition coefficients are eliminated, growth rates of the two species evolved to be equal. When basal grow rates were not allowed to evolve, asymmetric competition arose to achieve equal post-competition growth rates. All three reviewers are positive about this work.</p><p>Essential revisions:</p><p>1) Allowing ecological interactions to evolve to be positive.</p><p>2) Statistics of simulation repeats.</p><p>3) What happens if selecting for uneven ratios when noise is present?</p><p>4) What does &quot;rapidly&quot; really mean?</p><p>To help you revise, the original reviews are attached.</p><p><italic>Reviewer 1:</italic></p><p>1) Define &quot;interactions&quot;.</p><p>2) &quot;Developmental correction&quot; is a biologist's way of saying &quot;steady-state species ratio&quot; or &quot;attractor/fixed point&quot;. There are multiple ways of achieving steady-state species ratios. The authors had limited species interactions to competition (non-positive coefficients). If they allow interactions to change signs, then commensal or mutually beneficial interactions can arise to stabilize strain ratios. &quot;Developmental correction thus selects for maximal asymmetry in interactions&quot; may no longer hold for positive interactions. This needs to be checked.</p><p><italic>Reviewer #2:</italic></p><p>In this manuscript, the authors set out to explore whether it's possible to select for phenotypes at the community level, that arise in spite of competition between community members at the individual level. Using a computational model, they show that this is indeed possible, but relies on communities being properly enclosed and only passing on their individuals to their own offspring communities. They also analyse the strategy allowing for the evolution of community phenotypes. They show that community members evolve individual phenotypes that allow them to robustly converge to the community property under selection, independently of the initial community state. They posit that a similar mechanism might explain major evolutionary transitions, allowing lower level entities to be selected as whole entities.</p><p>Overall, we like the manuscript. It makes, in our opinion, a major contribution in understanding how competition between individual community members can be overcome – or even used – to allow for selection of the community phenotype. The idea that selection can favor individual-level parameters that have a functional form that increases resemblance between parent and offspring and robustness to initial conditions is very interesting and overcomes some of the issues with community selection observed in previous studies (Xie et al). The authors also nicely show that once this strategy has evolved, it is ecologically stable, and they explore how the evolutionary trajectory depends on starting conditions.</p><p>We have some general thoughts that we think are worth discussing further in the manuscript.</p><p>First, what we find was missing were statistics on what happens on different runs of the simulation. As far as we could tell, all data shown is based on individual &quot;example&quot; runs. The authors claim that these are general, but there is no data to support that. Please add statistics on the repeatability of the results. A related point: is the outcome always qualitatively similar? Specifically that a) the faster grower becomes less competitive with respect to growth rate, and b) that the emerging population regulation consists of the slower grower suppressing the faster grower while c) the faster grower does not affect the slower. It was not clear to us why, and we believe this is important to understanding the conclusion of the paper.</p><p>Second, we believe the authors could elaborate more on the specificity of their system and how their findings depend on them. It is not clear to what extent the same result would be observed in a different system that (1) has more than 2 types, (2) where selection acts on total abundance rather than ratios of two colors, (3) where the selective regime is different (the authors say &quot;A non-exhaustive exploration of other selection rules indicates that the qualitative results of the model are robust to changes in the selective regime, as long as collectives with an optimal colour are favoured and the collective population does not go extinct.&quot; It would be worth expanding on this in the supplement); and finally, (4) where the phenotype being selected for is not intermediate. Would this work equally well if the phenotype selected is almost blue or almost red? In short, under what general conditions do you expect to see the same?</p><p>From the ecological literature, it is known that coexistence between two competing types requires some limiting force for the strongest grower (e.g. predator). Is that simply what you are selecting for? It may be good to make a link to this literature.</p><p>We are also unsure about the parallels made to developmental processes and think this would merit some clarification. Does one see this strategy where a slower-growing type limits the growth of a faster-growing one? Or are the authors hypothesizing that this might explain how smooth developmental processes occur?</p><p>Finally, Figure 2 is lacking in visual clarity (color scheme). The selection method should also be better explained in the main text.</p><p>Please note that we did not work through all the math nor run the code.</p><p><italic>Reviewer #3:</italic></p><p>I very much enjoyed this paper. I do not have any significant concerns.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><p>Thank you for re-submitting your article &quot;Eco-evolutionary dynamics of nested Darwinian populations and the emergence of community-level heredity&quot; for consideration by <italic>eLife</italic>. Your article has been re-reviewed by two of the three original reviewers, and the evaluation has been overseen by a Reviewing Editor and Patricia Wittkopp as the Senior Editor.</p><p>We would like to draw your attention to changes in our revision policy that we have made in response to COVID-19 (https://elifesciences.org/articles/57162). Specifically, we are asking editors to accept without delay manuscripts, like yours, that they judge can stand as <italic>eLife</italic> papers without additional data, even if they feel that they would make the manuscript stronger. Thus the revisions requested below only address clarity and presentation.</p><p>The only thing that we believe is still missing is a paragraph in the Discussion on the generality of these findings. We understand that adding more than 2 types, trying different selection regimes or selecting on total abundance is beyond the scope of the current manuscript, but we still believe these questions may remain for a reader of the paper, so it is worth bringing them up in the Discussion as future directions.</p></body></sub-article><sub-article article-type="reply" id="sa2"><front-stub><article-id pub-id-type="doi">10.7554/eLife.53433.sa2</article-id><title-group><article-title>Author response</article-title></title-group></front-stub><body><disp-quote content-type="editor-comment"><p>Essential revisions:</p><p>1) Allowing ecological interactions to evolve to be positive.</p></disp-quote><p>We have performed further analyses in which interactions evolve to be positive. This is included in a new supplementary document (Appendix 3) and mentioned in the text.</p><p>Since the deterministic approximation for the intra-collective particle population dynamics is not dependent on the sign of the interaction rates, we were able to use the steady-state of the G function to study how colour can reach its target value by evolution of particle traits. In Appendix 3 we report the existence (or not) of evolutionary solutions for three additional classes of ecological interaction: exploitation of the type that has larger or smaller carrying capacity (interaction parameters of opposite sign), and mutualism (positive interaction parameters).</p><p>We firstly considered the four classes of interaction separately, but show that if interaction parameters are free to change sign, maximal asymmetry of competitive interactions will be replaced by exploitative interactions first, then by mutualism of increasing strength, as correctly intuited by reviewer 1.</p><p>We believe that in these cases, even more than for competitive interactions, constrains on particle-level parameters should play a fundamental role in determining the solutions that are actually achievable. For instance, increasing mutualism would lead to the urrealistic situation – typical of Lotka-Volterra models – where mutual benefits are so high that the two evolved types would, in the absence of the imposed collective life cycle, grow indefinitely.</p><p>We have commented on this point in the Discussion, where we refer to the new Appendix 3, and introduced earlier the concept that different types of ecological interactions can be conceived (Results subsection “A nested model of collective evolution”).</p><disp-quote content-type="editor-comment"><p>2) Statistics of simulation repeats.</p></disp-quote><p>We perfectly agree with the reviewers that the extent to which our reference simulation is representative of other realizations of the same stochastic process needed to be quantified. As mentioned above, the computational demands associated with such simulations limits the possibility of obtaining this information systematically for any parameter value. We thus realized multiple (20) simulations by fixing the non-evolving carrying capacities to values that illustrate different regions in the space of ecological interactions.</p><p>We have expanded Appendix 1 so as to include statistics of the variation of the target colour at the end of the simulations, together with the corresponding variation of the underlying inter-colour interaction and maximal growth parameters for the two particle types of different colour. As already observed when discussing the persistence of the evolutionary trajectory, at the evolutionary equilibrium growth rate becomes largely irrelevant (as long as it is large enough), and therefore is more variable than inter-colour interaction parameters.</p><p>We have expanded the first section of the Results in order to include this information and refer to the new paragraph “Variability of the derived particle traits” within Appendix 1.</p><disp-quote content-type="editor-comment"><p>3) What happens if selecting for uneven ratios when noise is present?</p></disp-quote><p>By looking at the deterministic model (Appendix 2—figure 5), it is clear that in the absence of individual-level stochasticity the target colour influences the relative values of the evolving traits and also the resilience of the fixed point to fluctuations (given by the gradient of the fixed point position). However, we expect that fluctuations associated notably with sampling might have major effects on the evolutionary trajectory.</p><p>In order to test the effect of the stochastic individual-based process, we ran multiple (10) simulations for different levels of the target colour and expanded Appendix 1 accordingly (paragraph “Different target colours”). As shown in the new Appendix 1—figure 3, the target colour is always successfully achieved, with variation among independent simulations being slightly larger for more extreme colours. However, the variation in the corresponding particle traits is broader, and increases for more extreme target values, together with the time scale associated to reaching the evolutionary equilibrium. These additional observations have been mentioned in the main text, subsection “Selection on collectives drives the evolution of particle traits”, where we refer to the new paragraph “Different target colours” within Appendix 1.</p><disp-quote content-type="editor-comment"><p>4) What does &quot;rapidly&quot; really mean?</p></disp-quote><p>We realise that this term may appear uninformative when addressing the neutral collective selection regime. This was mostly a consequence of mention of issues pertaining to timescales, prior to the later more complete elaboration. Consequently we have removed this early mention and added later that the time scale of early colour variation under collective selection, driven by differences in growth rate, is comparable to that observed in the neutral regime.</p><p>We have also added a term of comparison with the stochastic corrector mechanism, that acts on constant particle traits, therefore in conditions where ecological dynamics are dominated by differences in maximal growth rate (Appendix 1—figure 5). The evolutionary dynamics in this case explains the transient regime on short time scales, when the average colour is still very different from the target.</p><p>Taking also into account some of the detailed comments, we have expanded the description of the numerical simulation in subsection “Selection on collectives drives the evolution of particle traits”.</p><disp-quote content-type="editor-comment"><p>To help you revise, the original reviews are attached.</p><p>Reviewer 1:</p><p>1) Define &quot;interactions&quot;.</p></disp-quote><p>We now define interactions in the second paragraph of the Results, where we also mention the possibility of having different kinds of ecological interactions other than competition.</p><disp-quote content-type="editor-comment"><p>2) &quot;Developmental correction&quot; is a biologist's way of saying &quot;steady-state species ratio&quot; or &quot;attractor/fixed point&quot;. There are multiple ways of achieving steady-state species ratios.</p></disp-quote><p>The steady state of the growth function corresponds to a trajectory connecting the state of a collective at birth to that at adult stage, and its value does not necessarily correspond to the equilibrium of the particle population dynamics (rather, it captures some property of the transient). We therefore consider that it has many analogies to developmental processes. Moreover, we contrast it with stochastic correction, where correction is not determined by particle ecology that primes, but by fluctuations due to the sampling. We feel therefore that the metaphor is useful to convey our message.</p><disp-quote content-type="editor-comment"><p>The authors had limited species interactions to competition (non-positive coefficients). If they allow interactions to change signs, then commensal or mutually beneficial interactions can arise to stabilize strain ratios. &quot;Developmental correction thus selects for maximal asymmetry in interactions&quot; may no longer hold for positive interactions. This needs to be checked.</p></disp-quote><p>See Essential revision #1.</p><disp-quote content-type="editor-comment"><p>Reviewer #2:</p><p>[…]</p><p>First, what we find was missing were statistics on what happens on different runs of the simulation. As far as we could tell, all data shown is based on individual &quot;example&quot; runs. The authors claim that these are general, but there is no data to support that. Please add statistics on the repeatability of the results. A related point: is the outcome always qualitatively similar? Specifically that a) the faster grower becomes less competitive with respect to growth rate, and b) that the emerging population regulation consists of the slower grower suppressing the faster grower while c) the faster grower does not affect the slower. It was not clear to us why, and we believe this is important to understanding the conclusion of the paper.</p></disp-quote><p>See Essential revision #2.</p><disp-quote content-type="editor-comment"><p>Second, we believe the authors could elaborate more on the specificity of their system and how their findings depend on them. It is not clear to what extent the same result would be observed in a different system that (1) has more than 2 types, (2) where selection acts on total abundance rather than ratios of two colors, (3) where the selective regime is different (the authors say &quot;A non-exhaustive exploration of other selection rules indicates that the qualitative results of the model are robust to changes in the selective regime, as long as collectives with an optimal colour are favoured and the collective population does not go extinct.&quot; It would be worth expanding on this in the supplement); and finally, (4) where the phenotype being selected for is not intermediate. Would this work equally well if the phenotype selected is almost blue or almost red? In short, under what general conditions do you expect to see the same?</p></disp-quote><p>There are many interesting possible extensions of this model, and we have explored just a few, maintaining the basic assumptions that only two colours are present in the population and that optimal collective function requires both colours to be represented (whereas yield maximization can also be obtained by one type alone).</p><p>After having tried different selection schemes and realized that they yielded similar results (as long as the collective population did not go extinct), we chose a selection rule that was simple to implement, both in the individual-based numerical model and in possible applications. A systematic exploration of how different selection rules affect the probability of reaching the target colour within a finite time would however demand a much larger study that goes beyond the scope of this work.</p><p>However, as noted in response to Essential revisions #1 and #3, we have investigated the effects of changes in interaction rate and target colour.</p><disp-quote content-type="editor-comment"><p>From the ecological literature, it is known that coexistence between two competing types requires some limiting force for the strongest grower (e.g. predator). Is that simply what you are selecting for? It may be good to make a link to this literature.</p></disp-quote><p>The competitive Lotka-Volterra equations are indeed widely used in ecology. They are so widespread that we decided that no reference to specific literature was warranted.</p><p>If the “strongest grower” is defined based on its exponential growth rate r, then it is important to note that in the derived population not this parameter, but the interaction traits, are the chief determinants of the adult colour. See our response to Essential revision #2.</p><disp-quote content-type="editor-comment"><p>We are also unsure about the parallels made to developmental processes and think this would merit some clarification. Does one see this strategy where a slower-growing type limits the growth of a faster-growing one? Or are the authors hypothesizing that this might explain how smooth developmental processes occur?</p></disp-quote><p>Selection of the optimal colour, acting on adult collectives, changes the continuous dynamics that link, within collectives, the newborn to the adult state. In particular, this dynamic is increasingly “canalized”, as illustrated in Figure 3. We have improved Figure 3 in order to make this concept clearer.</p><disp-quote content-type="editor-comment"><p>Finally, Figure 2 is lacking in visual clarity (color scheme). The selection method should also be better explained in the main text.</p></disp-quote><p>We have improved presentation of the model in the main text (following the detailed comments) and the colour contrast of Figure 2. However, we refer the reader to Appendix 1 for all the details on implementation of the selective process. On the basis of the deterministic system and on non-exhaustive exploration of alternative selection schemes, we believe that those details are not essential to understand the key messages of this study.</p><p>[Editors' note: further revisions were suggested prior to acceptance, as described below.]</p><disp-quote content-type="editor-comment"><p>The only thing that we believe is still missing is a paragraph in the Discussion on the generality of these findings. We understand that adding more than 2 types, trying different selection regimes or selecting on total abundance is beyond the scope of the current manuscript, but we still believe these questions may remain for a reader of the paper, so it is worth bringing them up in the discussion as future directions.</p></disp-quote><p>As requested we have added a single new paragraph to the Discussion that reads as follows:</p><p>“Our goal has been to produce a simple, tractable scenario for studying the effects of artificial selection on collectives, which while theoretical, is firmly connected to plausible biological experiments. The model could be extended in multiple ways in order to analyse the effects of additional factors, including impact of non-overlapping generations and variation in the timing of reproduction (which would introduce an element of bet-hedging), of migration and mixing between collectives (which could be akin to gamete production and zygote formation), and inclusion of more than two kinds of particle types. More complex selective regimes can also be envisaged, such as those that reward collectives based on absolute population size of particle types, which would allow less abstract collective function to be considered. However, regardless of these refinements, we suspect that our core conclusion will stand firm: collective-level selection favours particle dynamics that improve collective-level heredity. The ability to reliably re-establish successful adult states of past-generations from simpler and potentially noisy initial conditions is adaptive at the collective level.”</p></body></sub-article></article>